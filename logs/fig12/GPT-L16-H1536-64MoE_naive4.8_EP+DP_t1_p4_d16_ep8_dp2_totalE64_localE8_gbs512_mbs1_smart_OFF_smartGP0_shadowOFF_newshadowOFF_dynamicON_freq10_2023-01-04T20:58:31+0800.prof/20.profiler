{"type":"time", "iteration": -1, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 7118.02, "avg": 7118.02, "max": 7118.02, "min": 7118.02, "cnt": 1}, "train/valid/test-data-iterators-setup":{"total": 13494.12, "avg": 13494.12, "max": 13494.12, "min": 13494.12, "cnt": 1}}}
{"type":"time", "iteration": 1, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.68, "avg": 0.68, "max": 0.68, "min": 0.68, "cnt": 1}, "forward-recv":{"total": 4034.65, "avg": 1344.88, "max": 0.85, "min": 4032.59, "cnt": 3}, "forward-compute":{"total": 4326.52, "avg": 135.20, "max": 56.28, "min": 1581.56, "cnt": 32}, "fwd-compute":{"total": 4322.36, "avg": 135.07, "max": 56.19, "min": 1581.32, "cnt": 32}, "batch-generator":{"total": 65.06, "avg": 2.03, "max": 0.92, "min": 8.23, "cnt": 32}, "fwd-embedding":{"total": 0.62, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 4240.84, "avg": 132.53, "max": 54.68, "min": 1571.31, "cnt": 32}, "fwd-layernorm":{"total": 11.24, "avg": 0.09, "max": 0.06, "min": 0.42, "cnt": 128}, "fwd-attn":{"total": 659.11, "avg": 5.15, "max": 0.74, "min": 502.02, "cnt": 128}, "fwd-misc":{"total": 505.29, "avg": 3.95, "max": 0.11, "min": 483.26, "cnt": 128}, "fwd-MLP":{"total": 3039.27, "avg": 23.74, "max": 11.11, "min": 516.55, "cnt": 128}, "MoE_L0_fwd":{"total": 1791.54, "avg": 55.99, "max": 11.88, "min": 516.36, "cnt": 32}, "MoEMLP":{"total": 3020.78, "avg": 23.60, "max": 11.01, "min": 516.29, "cnt": 128}, "MoE_L1_fwd":{"total": 429.14, "avg": 13.41, "max": 11.30, "min": 24.11, "cnt": 32}, "MoE_L2_fwd":{"total": 406.04, "avg": 12.69, "max": 11.13, "min": 19.46, "cnt": 32}, "MoE_L3_fwd":{"total": 400.53, "avg": 12.52, "max": 11.04, "min": 18.82, "cnt": 32}, "fwd-pooler":{"total": 0.37, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.64, "avg": 0.02, "max": 0.02, "min": 0.04, "cnt": 32}, "forward-send":{"total": 1589.17, "avg": 794.58, "max": 90.95, "min": 1498.22, "cnt": 2}, "forward-send-backward-recv":{"total": 3132.89, "avg": 104.43, "max": 1.31, "min": 2944.07, "cnt": 30}, "backward-compute":{"total": 1997.71, "avg": 62.43, "max": 46.31, "min": 437.80, "cnt": 32}, "MoE_L3_bwd":{"total": 436.08, "avg": 13.63, "max": 11.47, "min": 30.94, "cnt": 32}, "MoE_L2_bwd":{"total": 380.43, "avg": 11.89, "max": 9.93, "min": 33.82, "cnt": 32}, "MoE_L1_bwd":{"total": 309.42, "avg": 9.67, "max": 8.87, "min": 11.60, "cnt": 32}, "MoE_L0_bwd":{"total": 303.07, "avg": 9.47, "max": 8.71, "min": 10.54, "cnt": 32}, "backward-send-forward-recv":{"total": 7802.00, "avg": 269.03, "max": 1.93, "min": 974.65, "cnt": 29}, "backward-send":{"total": 2.25, "avg": 0.75, "max": 0.51, "min": 1.00, "cnt": 3}, "backward-recv":{"total": 647.90, "avg": 323.95, "max": 70.82, "min": 577.08, "cnt": 2}, "backward-params-all-reduce":{"total": 812.74, "avg": 812.74, "max": 812.74, "min": 812.74, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 573.41, "avg": 573.41, "max": 573.41, "min": 573.41, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 335.67, "avg": 335.67, "max": 335.67, "min": 335.67, "cnt": 1}, "optimizer-clip-main-grad":{"total": 7.97, "avg": 7.97, "max": 7.97, "min": 7.97, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.82, "avg": 3.82, "max": 3.82, "min": 3.82, "cnt": 1}}}
{"type":"time", "iteration": 2, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.13, "avg": 0.13, "max": 0.13, "min": 0.13, "cnt": 1}, "forward-recv":{"total": 81.74, "avg": 27.25, "max": 1.08, "min": 74.66, "cnt": 3}, "forward-compute":{"total": 2524.02, "avg": 78.88, "max": 52.31, "min": 297.64, "cnt": 32}, "fwd-compute":{"total": 2520.26, "avg": 78.76, "max": 52.22, "min": 297.54, "cnt": 32}, "batch-generator":{"total": 143.16, "avg": 4.47, "max": 0.81, "min": 96.47, "cnt": 32}, "fwd-embedding":{"total": 0.68, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 2363.40, "avg": 73.86, "max": 50.40, "min": 200.56, "cnt": 32}, "fwd-layernorm":{"total": 10.70, "avg": 0.08, "max": 0.06, "min": 0.22, "cnt": 128}, "fwd-attn":{"total": 111.53, "avg": 0.87, "max": 0.74, "min": 1.65, "cnt": 128}, "fwd-misc":{"total": 22.94, "avg": 0.18, "max": 0.12, "min": 0.58, "cnt": 128}, "fwd-MLP":{"total": 2196.08, "avg": 17.16, "max": 10.40, "min": 156.78, "cnt": 128}, "MoE_L0_fwd":{"total": 1030.31, "avg": 32.20, "max": 12.20, "min": 156.63, "cnt": 32}, "MoEMLP":{"total": 2177.98, "avg": 17.02, "max": 10.29, "min": 156.55, "cnt": 128}, "MoE_L1_fwd":{"total": 393.35, "avg": 12.29, "max": 10.83, "min": 18.40, "cnt": 32}, "MoE_L2_fwd":{"total": 354.60, "avg": 11.08, "max": 10.33, "min": 13.56, "cnt": 32}, "MoE_L3_fwd":{"total": 406.27, "avg": 12.70, "max": 11.88, "min": 15.84, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 2.13, "avg": 1.07, "max": 0.99, "min": 1.15, "cnt": 2}, "forward-send-backward-recv":{"total": 3090.53, "avg": 103.02, "max": 1.16, "min": 403.97, "cnt": 30}, "backward-compute":{"total": 1768.02, "avg": 55.25, "max": 52.69, "min": 62.65, "cnt": 32}, "MoE_L3_bwd":{"total": 463.25, "avg": 14.48, "max": 12.76, "min": 22.27, "cnt": 32}, "MoE_L2_bwd":{"total": 361.57, "avg": 11.30, "max": 10.15, "min": 15.17, "cnt": 32}, "MoE_L1_bwd":{"total": 358.89, "avg": 11.22, "max": 10.49, "min": 13.93, "cnt": 32}, "MoE_L0_bwd":{"total": 371.18, "avg": 11.60, "max": 11.24, "min": 12.55, "cnt": 32}, "backward-send-forward-recv":{"total": 5948.35, "avg": 205.12, "max": 1.84, "min": 1058.15, "cnt": 29}, "backward-send":{"total": 8.00, "avg": 2.67, "max": 1.04, "min": 5.91, "cnt": 3}, "backward-recv":{"total": 696.64, "avg": 348.32, "max": 58.05, "min": 638.59, "cnt": 2}, "backward-params-all-reduce":{"total": 492.51, "avg": 492.51, "max": 492.51, "min": 492.51, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 254.70, "avg": 254.70, "max": 254.70, "min": 254.70, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.41, "avg": 3.41, "max": 3.41, "min": 3.41, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 209.27, "avg": 209.27, "max": 209.27, "min": 209.27, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.88, "avg": 6.88, "max": 6.88, "min": 6.88, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.47, "avg": 3.47, "max": 3.47, "min": 3.47, "cnt": 1}}}
{"type":"time", "iteration": 3, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.10, "avg": 0.10, "max": 0.10, "min": 0.10, "cnt": 1}, "forward-recv":{"total": 64.10, "avg": 21.37, "max": 1.18, "min": 61.27, "cnt": 3}, "forward-compute":{"total": 2423.06, "avg": 75.72, "max": 56.64, "min": 244.47, "cnt": 32}, "fwd-compute":{"total": 2419.80, "avg": 75.62, "max": 56.56, "min": 244.40, "cnt": 32}, "batch-generator":{"total": 43.21, "avg": 1.35, "max": 0.73, "min": 3.36, "cnt": 32}, "fwd-embedding":{"total": 0.57, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 2364.19, "avg": 73.88, "max": 55.40, "min": 243.09, "cnt": 32}, "fwd-layernorm":{"total": 9.70, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 109.44, "avg": 0.86, "max": 0.74, "min": 2.76, "cnt": 128}, "fwd-misc":{"total": 21.31, "avg": 0.17, "max": 0.12, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 2202.48, "avg": 17.21, "max": 11.52, "min": 199.60, "cnt": 128}, "MoE_L0_fwd":{"total": 967.81, "avg": 30.24, "max": 13.04, "min": 199.52, "cnt": 32}, "MoEMLP":{"total": 2185.27, "avg": 17.07, "max": 11.41, "min": 199.47, "cnt": 128}, "MoE_L1_fwd":{"total": 443.77, "avg": 13.87, "max": 12.81, "min": 15.19, "cnt": 32}, "MoE_L2_fwd":{"total": 381.47, "avg": 11.92, "max": 11.45, "min": 13.37, "cnt": 32}, "MoE_L3_fwd":{"total": 398.35, "avg": 12.45, "max": 11.89, "min": 13.19, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.45, "avg": 0.72, "max": 0.71, "min": 0.73, "cnt": 2}, "forward-send-backward-recv":{"total": 189.47, "avg": 6.32, "max": 1.41, "min": 117.86, "cnt": 30}, "backward-compute":{"total": 1896.37, "avg": 59.26, "max": 54.95, "min": 61.58, "cnt": 32}, "MoE_L3_bwd":{"total": 441.26, "avg": 13.79, "max": 12.04, "min": 14.85, "cnt": 32}, "MoE_L2_bwd":{"total": 413.23, "avg": 12.91, "max": 11.95, "min": 13.90, "cnt": 32}, "MoE_L1_bwd":{"total": 452.84, "avg": 14.15, "max": 13.68, "min": 14.54, "cnt": 32}, "MoE_L0_bwd":{"total": 374.79, "avg": 11.71, "max": 10.92, "min": 13.01, "cnt": 32}, "backward-send-forward-recv":{"total": 9088.91, "avg": 313.41, "max": 1.87, "min": 1177.97, "cnt": 29}, "backward-send":{"total": 2.61, "avg": 0.87, "max": 0.75, "min": 0.93, "cnt": 3}, "backward-recv":{"total": 377.76, "avg": 188.88, "max": 56.49, "min": 321.28, "cnt": 2}, "backward-params-all-reduce":{"total": 492.91, "avg": 492.91, "max": 492.91, "min": 492.91, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 258.14, "avg": 258.14, "max": 258.14, "min": 258.14, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 212.66, "avg": 212.66, "max": 212.66, "min": 212.66, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.98, "avg": 6.98, "max": 6.98, "min": 6.98, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.52, "avg": 3.52, "max": 3.52, "min": 3.52, "cnt": 1}}}
{"type":"time", "iteration": 4, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.10, "avg": 0.10, "max": 0.10, "min": 0.10, "cnt": 1}, "forward-recv":{"total": 70.31, "avg": 23.44, "max": 0.72, "min": 68.52, "cnt": 3}, "forward-compute":{"total": 2449.76, "avg": 76.56, "max": 54.12, "min": 257.59, "cnt": 32}, "fwd-compute":{"total": 2446.25, "avg": 76.45, "max": 54.05, "min": 257.40, "cnt": 32}, "batch-generator":{"total": 112.68, "avg": 3.52, "max": 0.69, "min": 38.65, "cnt": 32}, "fwd-embedding":{"total": 0.71, "avg": 0.02, "max": 0.01, "min": 0.07, "cnt": 32}, "fwd-encoder":{"total": 2320.50, "avg": 72.52, "max": 53.05, "min": 254.99, "cnt": 32}, "fwd-layernorm":{"total": 10.77, "avg": 0.08, "max": 0.05, "min": 0.33, "cnt": 128}, "fwd-attn":{"total": 113.97, "avg": 0.89, "max": 0.74, "min": 2.55, "cnt": 128}, "fwd-misc":{"total": 22.75, "avg": 0.18, "max": 0.11, "min": 0.50, "cnt": 128}, "fwd-MLP":{"total": 2150.74, "avg": 16.80, "max": 11.52, "min": 210.40, "cnt": 128}, "MoE_L0_fwd":{"total": 928.14, "avg": 29.00, "max": 12.46, "min": 210.28, "cnt": 32}, "MoEMLP":{"total": 2132.55, "avg": 16.66, "max": 11.42, "min": 210.23, "cnt": 128}, "MoE_L1_fwd":{"total": 415.11, "avg": 12.97, "max": 11.87, "min": 16.91, "cnt": 32}, "MoE_L2_fwd":{"total": 404.53, "avg": 12.64, "max": 12.11, "min": 13.58, "cnt": 32}, "MoE_L3_fwd":{"total": 391.26, "avg": 12.23, "max": 11.46, "min": 16.01, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 7.44, "avg": 3.72, "max": 0.71, "min": 6.74, "cnt": 2}, "forward-send-backward-recv":{"total": 232.92, "avg": 7.76, "max": 1.61, "min": 125.61, "cnt": 30}, "backward-compute":{"total": 1766.66, "avg": 55.21, "max": 53.18, "min": 58.21, "cnt": 32}, "MoE_L3_bwd":{"total": 424.56, "avg": 13.27, "max": 12.11, "min": 15.31, "cnt": 32}, "MoE_L2_bwd":{"total": 390.57, "avg": 12.21, "max": 11.65, "min": 15.94, "cnt": 32}, "MoE_L1_bwd":{"total": 353.33, "avg": 11.04, "max": 10.67, "min": 11.36, "cnt": 32}, "MoE_L0_bwd":{"total": 383.17, "avg": 11.97, "max": 11.14, "min": 14.42, "cnt": 32}, "backward-send-forward-recv":{"total": 7799.93, "avg": 268.96, "max": 1.86, "min": 1124.01, "cnt": 29}, "backward-send":{"total": 3.00, "avg": 1.00, "max": 0.83, "min": 1.16, "cnt": 3}, "backward-recv":{"total": 287.94, "avg": 143.97, "max": 73.40, "min": 214.54, "cnt": 2}, "backward-params-all-reduce":{"total": 492.24, "avg": 492.24, "max": 492.24, "min": 492.24, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 253.68, "avg": 253.68, "max": 253.68, "min": 253.68, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.40, "avg": 3.40, "max": 3.40, "min": 3.40, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 209.23, "avg": 209.23, "max": 209.23, "min": 209.23, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.87, "avg": 6.87, "max": 6.87, "min": 6.87, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.54, "avg": 3.54, "max": 3.54, "min": 3.54, "cnt": 1}}}
{"type":"time", "iteration": 5, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.10, "avg": 0.10, "max": 0.10, "min": 0.10, "cnt": 1}, "forward-recv":{"total": 77.84, "avg": 25.95, "max": 0.99, "min": 71.85, "cnt": 3}, "forward-compute":{"total": 2041.41, "avg": 63.79, "max": 53.83, "min": 86.30, "cnt": 32}, "fwd-compute":{"total": 2038.08, "avg": 63.69, "max": 53.76, "min": 86.21, "cnt": 32}, "batch-generator":{"total": 78.35, "avg": 2.45, "max": 0.66, "min": 19.20, "cnt": 32}, "fwd-embedding":{"total": 0.69, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1946.82, "avg": 60.84, "max": 52.68, "min": 67.68, "cnt": 32}, "fwd-layernorm":{"total": 10.63, "avg": 0.08, "max": 0.06, "min": 0.22, "cnt": 128}, "fwd-attn":{"total": 113.02, "avg": 0.88, "max": 0.74, "min": 2.70, "cnt": 128}, "fwd-misc":{"total": 22.29, "avg": 0.17, "max": 0.11, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1779.16, "avg": 13.90, "max": 11.01, "min": 25.85, "cnt": 128}, "MoE_L0_fwd":{"total": 557.37, "avg": 17.42, "max": 11.58, "min": 25.77, "cnt": 32}, "MoEMLP":{"total": 1761.44, "avg": 13.76, "max": 10.90, "min": 25.73, "cnt": 128}, "MoE_L1_fwd":{"total": 442.93, "avg": 13.84, "max": 12.44, "min": 18.41, "cnt": 32}, "MoE_L2_fwd":{"total": 402.77, "avg": 12.59, "max": 11.81, "min": 14.38, "cnt": 32}, "MoE_L3_fwd":{"total": 364.85, "avg": 11.40, "max": 10.95, "min": 15.12, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.64, "avg": 0.82, "max": 0.77, "min": 0.87, "cnt": 2}, "forward-send-backward-recv":{"total": 256.98, "avg": 8.57, "max": 1.77, "min": 126.93, "cnt": 30}, "backward-compute":{"total": 1785.44, "avg": 55.80, "max": 53.87, "min": 57.57, "cnt": 32}, "MoE_L3_bwd":{"total": 403.70, "avg": 12.62, "max": 11.89, "min": 14.60, "cnt": 32}, "MoE_L2_bwd":{"total": 401.14, "avg": 12.54, "max": 11.81, "min": 13.06, "cnt": 32}, "MoE_L1_bwd":{"total": 400.93, "avg": 12.53, "max": 12.09, "min": 12.95, "cnt": 32}, "MoE_L0_bwd":{"total": 366.93, "avg": 11.47, "max": 10.87, "min": 12.92, "cnt": 32}, "backward-send-forward-recv":{"total": 8927.86, "avg": 307.86, "max": 1.75, "min": 1539.97, "cnt": 29}, "backward-send":{"total": 2.32, "avg": 0.77, "max": 0.50, "min": 1.12, "cnt": 3}, "backward-recv":{"total": 145.32, "avg": 72.66, "max": 71.15, "min": 74.18, "cnt": 2}, "backward-params-all-reduce":{"total": 487.89, "avg": 487.89, "max": 487.89, "min": 487.89, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 259.33, "avg": 259.33, "max": 259.33, "min": 259.33, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 214.73, "avg": 214.73, "max": 214.73, "min": 214.73, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.99, "avg": 6.99, "max": 6.99, "min": 6.99, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.52, "avg": 3.52, "max": 3.52, "min": 3.52, "cnt": 1}}}
{"type":"time", "iteration": 6, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 79.67, "avg": 26.56, "max": 1.09, "min": 70.12, "cnt": 3}, "forward-compute":{"total": 2175.26, "avg": 67.98, "max": 55.97, "min": 197.96, "cnt": 32}, "fwd-compute":{"total": 2172.39, "avg": 67.89, "max": 55.90, "min": 197.88, "cnt": 32}, "batch-generator":{"total": 46.34, "avg": 1.45, "max": 0.69, "min": 3.51, "cnt": 32}, "fwd-embedding":{"total": 0.50, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 2114.09, "avg": 66.07, "max": 54.90, "min": 195.66, "cnt": 32}, "fwd-layernorm":{"total": 9.37, "avg": 0.07, "max": 0.06, "min": 0.29, "cnt": 128}, "fwd-attn":{"total": 104.65, "avg": 0.82, "max": 0.74, "min": 2.31, "cnt": 128}, "fwd-misc":{"total": 20.46, "avg": 0.16, "max": 0.11, "min": 0.45, "cnt": 128}, "fwd-MLP":{"total": 1959.42, "avg": 15.31, "max": 11.01, "min": 152.18, "cnt": 128}, "MoE_L0_fwd":{"total": 734.93, "avg": 22.97, "max": 13.81, "min": 152.03, "cnt": 32}, "MoEMLP":{"total": 1942.78, "avg": 15.18, "max": 10.90, "min": 151.96, "cnt": 128}, "MoE_L1_fwd":{"total": 447.53, "avg": 13.99, "max": 12.88, "min": 17.86, "cnt": 32}, "MoE_L2_fwd":{"total": 389.69, "avg": 12.18, "max": 11.49, "min": 18.02, "cnt": 32}, "MoE_L3_fwd":{"total": 376.61, "avg": 11.77, "max": 10.94, "min": 12.79, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 3.17, "avg": 1.58, "max": 0.88, "min": 2.29, "cnt": 2}, "forward-send-backward-recv":{"total": 195.05, "avg": 6.50, "max": 1.39, "min": 128.94, "cnt": 30}, "backward-compute":{"total": 1888.90, "avg": 59.03, "max": 55.92, "min": 60.38, "cnt": 32}, "MoE_L3_bwd":{"total": 406.96, "avg": 12.72, "max": 11.52, "min": 14.05, "cnt": 32}, "MoE_L2_bwd":{"total": 362.21, "avg": 11.32, "max": 10.58, "min": 12.12, "cnt": 32}, "MoE_L1_bwd":{"total": 427.45, "avg": 13.36, "max": 12.72, "min": 14.53, "cnt": 32}, "MoE_L0_bwd":{"total": 478.93, "avg": 14.97, "max": 14.43, "min": 15.77, "cnt": 32}, "backward-send-forward-recv":{"total": 7536.02, "avg": 259.86, "max": 2.42, "min": 768.28, "cnt": 29}, "backward-send":{"total": 3.18, "avg": 1.06, "max": 0.91, "min": 1.15, "cnt": 3}, "backward-recv":{"total": 126.67, "avg": 63.33, "max": 62.50, "min": 64.17, "cnt": 2}, "backward-params-all-reduce":{"total": 493.59, "avg": 493.59, "max": 493.59, "min": 493.59, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 273.73, "avg": 273.73, "max": 273.73, "min": 273.73, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.41, "avg": 3.41, "max": 3.41, "min": 3.41, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 229.43, "avg": 229.43, "max": 229.43, "min": 229.43, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.85, "avg": 6.85, "max": 6.85, "min": 6.85, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 7, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.12, "avg": 0.12, "max": 0.12, "min": 0.12, "cnt": 1}, "forward-recv":{"total": 72.90, "avg": 24.30, "max": 1.00, "min": 70.80, "cnt": 3}, "forward-compute":{"total": 3014.24, "avg": 94.19, "max": 59.18, "min": 959.78, "cnt": 32}, "fwd-compute":{"total": 3011.21, "avg": 94.10, "max": 59.09, "min": 959.68, "cnt": 32}, "batch-generator":{"total": 51.26, "avg": 1.60, "max": 0.71, "min": 3.85, "cnt": 32}, "fwd-embedding":{"total": 0.54, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 2948.21, "avg": 92.13, "max": 57.83, "min": 958.51, "cnt": 32}, "fwd-layernorm":{"total": 9.55, "avg": 0.07, "max": 0.06, "min": 0.24, "cnt": 128}, "fwd-attn":{"total": 104.70, "avg": 0.82, "max": 0.74, "min": 1.45, "cnt": 128}, "fwd-misc":{"total": 20.77, "avg": 0.16, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 2793.10, "avg": 21.82, "max": 11.19, "min": 912.66, "cnt": 128}, "MoE_L0_fwd":{"total": 1480.73, "avg": 46.27, "max": 14.26, "min": 912.50, "cnt": 32}, "MoEMLP":{"total": 2776.27, "avg": 21.69, "max": 11.07, "min": 912.45, "cnt": 128}, "MoE_L1_fwd":{"total": 397.65, "avg": 12.43, "max": 11.11, "min": 15.14, "cnt": 32}, "MoE_L2_fwd":{"total": 474.72, "avg": 14.83, "max": 13.81, "min": 21.99, "cnt": 32}, "MoE_L3_fwd":{"total": 429.25, "avg": 13.41, "max": 12.79, "min": 15.99, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 3.81, "avg": 1.90, "max": 0.89, "min": 2.91, "cnt": 2}, "forward-send-backward-recv":{"total": 1156.31, "avg": 38.54, "max": 1.30, "min": 200.49, "cnt": 30}, "backward-compute":{"total": 2072.54, "avg": 64.77, "max": 63.19, "min": 68.74, "cnt": 32}, "MoE_L3_bwd":{"total": 486.68, "avg": 15.21, "max": 14.49, "min": 18.82, "cnt": 32}, "MoE_L2_bwd":{"total": 517.82, "avg": 16.18, "max": 15.25, "min": 17.34, "cnt": 32}, "MoE_L1_bwd":{"total": 345.23, "avg": 10.79, "max": 10.01, "min": 12.69, "cnt": 32}, "MoE_L0_bwd":{"total": 511.66, "avg": 15.99, "max": 15.16, "min": 18.27, "cnt": 32}, "backward-send-forward-recv":{"total": 5059.09, "avg": 174.45, "max": 1.89, "min": 675.51, "cnt": 29}, "backward-send":{"total": 2.20, "avg": 0.73, "max": 0.59, "min": 0.83, "cnt": 3}, "backward-recv":{"total": 884.37, "avg": 442.18, "max": 163.91, "min": 720.46, "cnt": 2}, "backward-params-all-reduce":{"total": 488.85, "avg": 488.85, "max": 488.85, "min": 488.85, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 269.30, "avg": 269.30, "max": 269.30, "min": 269.30, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 224.67, "avg": 224.67, "max": 224.67, "min": 224.67, "cnt": 1}, "optimizer-clip-main-grad":{"total": 7.02, "avg": 7.02, "max": 7.02, "min": 7.02, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.59, "avg": 3.59, "max": 3.59, "min": 3.59, "cnt": 1}}}
{"type":"time", "iteration": 8, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 60.69, "avg": 20.23, "max": 0.75, "min": 58.90, "cnt": 3}, "forward-compute":{"total": 2147.63, "avg": 67.11, "max": 57.40, "min": 161.28, "cnt": 32}, "fwd-compute":{"total": 2144.46, "avg": 67.01, "max": 57.32, "min": 161.16, "cnt": 32}, "batch-generator":{"total": 70.63, "avg": 2.21, "max": 0.74, "min": 8.46, "cnt": 32}, "fwd-embedding":{"total": 0.61, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 2061.50, "avg": 64.42, "max": 55.52, "min": 159.59, "cnt": 32}, "fwd-layernorm":{"total": 9.96, "avg": 0.08, "max": 0.06, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 108.97, "avg": 0.85, "max": 0.74, "min": 1.49, "cnt": 128}, "fwd-misc":{"total": 21.74, "avg": 0.17, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1899.64, "avg": 14.84, "max": 10.98, "min": 112.86, "cnt": 128}, "MoE_L0_fwd":{"total": 590.56, "avg": 18.46, "max": 10.90, "min": 112.75, "cnt": 32}, "MoEMLP":{"total": 1882.43, "avg": 14.71, "max": 10.85, "min": 112.70, "cnt": 128}, "MoE_L1_fwd":{"total": 405.73, "avg": 12.68, "max": 11.40, "min": 14.68, "cnt": 32}, "MoE_L2_fwd":{"total": 468.07, "avg": 14.63, "max": 13.78, "min": 18.78, "cnt": 32}, "MoE_L3_fwd":{"total": 424.29, "avg": 13.26, "max": 12.47, "min": 17.11, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 5.70, "avg": 2.85, "max": 0.83, "min": 4.87, "cnt": 2}, "forward-send-backward-recv":{"total": 212.55, "avg": 7.09, "max": 1.42, "min": 118.89, "cnt": 30}, "backward-compute":{"total": 1875.18, "avg": 58.60, "max": 54.44, "min": 61.88, "cnt": 32}, "MoE_L3_bwd":{"total": 444.34, "avg": 13.89, "max": 12.31, "min": 15.12, "cnt": 32}, "MoE_L2_bwd":{"total": 494.65, "avg": 15.46, "max": 14.78, "min": 17.18, "cnt": 32}, "MoE_L1_bwd":{"total": 379.40, "avg": 11.86, "max": 11.29, "min": 12.29, "cnt": 32}, "MoE_L0_bwd":{"total": 345.55, "avg": 10.80, "max": 9.77, "min": 11.29, "cnt": 32}, "backward-send-forward-recv":{"total": 6943.72, "avg": 239.44, "max": 1.88, "min": 950.98, "cnt": 29}, "backward-send":{"total": 2.96, "avg": 0.99, "max": 0.90, "min": 1.08, "cnt": 3}, "backward-recv":{"total": 133.65, "avg": 66.83, "max": 65.61, "min": 68.04, "cnt": 2}, "backward-params-all-reduce":{"total": 490.37, "avg": 490.37, "max": 490.37, "min": 490.37, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 263.25, "avg": 263.25, "max": 263.25, "min": 263.25, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 218.84, "avg": 218.84, "max": 218.84, "min": 218.84, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.93, "avg": 6.93, "max": 6.93, "min": 6.93, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.47, "avg": 3.47, "max": 3.47, "min": 3.47, "cnt": 1}}}
{"type":"time", "iteration": 9, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 80.62, "avg": 26.87, "max": 2.44, "min": 70.31, "cnt": 3}, "forward-compute":{"total": 1974.85, "avg": 61.71, "max": 55.39, "min": 68.78, "cnt": 32}, "fwd-compute":{"total": 1971.57, "avg": 61.61, "max": 55.32, "min": 68.69, "cnt": 32}, "batch-generator":{"total": 47.17, "avg": 1.47, "max": 0.67, "min": 3.23, "cnt": 32}, "fwd-embedding":{"total": 0.69, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1911.38, "avg": 59.73, "max": 54.20, "min": 66.71, "cnt": 32}, "fwd-layernorm":{"total": 10.22, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 110.65, "avg": 0.86, "max": 0.74, "min": 1.54, "cnt": 128}, "fwd-misc":{"total": 21.50, "avg": 0.17, "max": 0.11, "min": 0.42, "cnt": 128}, "fwd-MLP":{"total": 1747.75, "avg": 13.65, "max": 11.30, "min": 23.43, "cnt": 128}, "MoE_L0_fwd":{"total": 545.62, "avg": 17.05, "max": 12.74, "min": 23.35, "cnt": 32}, "MoEMLP":{"total": 1730.52, "avg": 13.52, "max": 11.20, "min": 23.30, "cnt": 128}, "MoE_L1_fwd":{"total": 396.34, "avg": 12.39, "max": 11.24, "min": 13.29, "cnt": 32}, "MoE_L2_fwd":{"total": 399.43, "avg": 12.48, "max": 11.82, "min": 13.83, "cnt": 32}, "MoE_L3_fwd":{"total": 395.40, "avg": 12.36, "max": 11.82, "min": 14.06, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.61, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.19, "avg": 0.60, "max": 0.55, "min": 0.64, "cnt": 2}, "forward-send-backward-recv":{"total": 204.06, "avg": 6.80, "max": 1.19, "min": 100.79, "cnt": 30}, "backward-compute":{"total": 1695.79, "avg": 52.99, "max": 48.53, "min": 56.03, "cnt": 32}, "MoE_L3_bwd":{"total": 431.05, "avg": 13.47, "max": 12.48, "min": 15.12, "cnt": 32}, "MoE_L2_bwd":{"total": 372.83, "avg": 11.65, "max": 10.15, "min": 13.53, "cnt": 32}, "MoE_L1_bwd":{"total": 332.27, "avg": 10.38, "max": 9.72, "min": 11.24, "cnt": 32}, "MoE_L0_bwd":{"total": 347.46, "avg": 10.86, "max": 10.13, "min": 12.95, "cnt": 32}, "backward-send-forward-recv":{"total": 6003.92, "avg": 207.03, "max": 2.17, "min": 873.25, "cnt": 29}, "backward-send":{"total": 2.27, "avg": 0.76, "max": 0.63, "min": 0.92, "cnt": 3}, "backward-recv":{"total": 141.81, "avg": 70.90, "max": 68.74, "min": 73.07, "cnt": 2}, "backward-params-all-reduce":{"total": 495.93, "avg": 495.93, "max": 495.93, "min": 495.93, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 222.67, "avg": 222.67, "max": 222.67, "min": 222.67, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 212.19, "avg": 212.19, "max": 212.19, "min": 212.19, "cnt": 1}, "optimizer-clip-main-grad":{"total": 7.02, "avg": 7.02, "max": 7.02, "min": 7.02, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}}}
{"type":"time", "iteration": 10, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 103.87, "avg": 34.62, "max": 1.04, "min": 101.73, "cnt": 3}, "forward-compute":{"total": 3581.96, "avg": 111.94, "max": 49.33, "min": 1846.58, "cnt": 32}, "fwd-compute":{"total": 3578.86, "avg": 111.84, "max": 49.26, "min": 1846.49, "cnt": 32}, "batch-generator":{"total": 41.85, "avg": 1.31, "max": 0.75, "min": 2.56, "cnt": 32}, "fwd-embedding":{"total": 0.58, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 3524.74, "avg": 110.15, "max": 47.69, "min": 1845.26, "cnt": 32}, "fwd-layernorm":{"total": 10.01, "avg": 0.08, "max": 0.06, "min": 0.24, "cnt": 128}, "fwd-attn":{"total": 109.47, "avg": 0.86, "max": 0.74, "min": 1.80, "cnt": 128}, "fwd-misc":{"total": 21.04, "avg": 0.16, "max": 0.11, "min": 0.45, "cnt": 128}, "fwd-MLP":{"total": 3362.82, "avg": 26.27, "max": 9.68, "min": 1144.82, "cnt": 128}, "MoE_L0_fwd":{"total": 528.34, "avg": 16.51, "max": 12.56, "min": 20.73, "cnt": 32}, "MoEMLP":{"total": 3345.57, "avg": 26.14, "max": 9.56, "min": 1144.70, "cnt": 128}, "MoE_L1_fwd":{"total": 1484.24, "avg": 46.38, "max": 9.64, "min": 1144.74, "cnt": 32}, "MoE_L2_fwd":{"total": 836.35, "avg": 26.14, "max": 10.29, "min": 500.67, "cnt": 32}, "MoE_L3_fwd":{"total": 502.89, "avg": 15.72, "max": 9.60, "min": 177.12, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1641.37, "avg": 820.69, "max": 0.76, "min": 1640.61, "cnt": 2}, "forward-send-backward-recv":{"total": 309.80, "avg": 10.33, "max": 1.77, "min": 144.08, "cnt": 30}, "backward-compute":{"total": 1479.97, "avg": 46.25, "max": 43.63, "min": 50.72, "cnt": 32}, "MoE_L3_bwd":{"total": 338.50, "avg": 10.58, "max": 9.06, "min": 11.30, "cnt": 32}, "MoE_L2_bwd":{"total": 312.01, "avg": 9.75, "max": 9.31, "min": 10.31, "cnt": 32}, "MoE_L1_bwd":{"total": 267.19, "avg": 8.35, "max": 7.52, "min": 9.65, "cnt": 32}, "MoE_L0_bwd":{"total": 342.66, "avg": 10.71, "max": 9.91, "min": 13.69, "cnt": 32}, "backward-send-forward-recv":{"total": 5275.57, "avg": 181.92, "max": 1.68, "min": 514.00, "cnt": 29}, "backward-send":{"total": 3.28, "avg": 1.09, "max": 1.04, "min": 1.15, "cnt": 3}, "backward-recv":{"total": 169.44, "avg": 84.72, "max": 81.05, "min": 88.39, "cnt": 2}, "backward-params-all-reduce":{"total": 491.71, "avg": 491.71, "max": 491.71, "min": 491.71, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 240.79, "avg": 240.79, "max": 240.79, "min": 240.79, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 216.63, "avg": 216.63, "max": 216.63, "min": 216.63, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.83, "avg": 6.83, "max": 6.83, "min": 6.83, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}}}
{"type":"time", "iteration": 11, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.06, "avg": 0.06, "max": 0.06, "min": 0.06, "cnt": 1}, "forward-recv":{"total": 112.41, "avg": 37.47, "max": 6.02, "min": 95.37, "cnt": 3}, "forward-compute":{"total": 1829.40, "avg": 57.17, "max": 49.85, "min": 65.21, "cnt": 32}, "fwd-compute":{"total": 1826.61, "avg": 57.08, "max": 49.78, "min": 65.10, "cnt": 32}, "batch-generator":{"total": 65.02, "avg": 2.03, "max": 0.71, "min": 6.10, "cnt": 32}, "fwd-embedding":{"total": 0.53, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1749.81, "avg": 54.68, "max": 48.69, "min": 62.54, "cnt": 32}, "fwd-layernorm":{"total": 9.25, "avg": 0.07, "max": 0.06, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 102.37, "avg": 0.80, "max": 0.74, "min": 1.59, "cnt": 128}, "fwd-misc":{"total": 20.17, "avg": 0.16, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1598.21, "avg": 12.49, "max": 9.85, "min": 20.51, "cnt": 128}, "MoE_L0_fwd":{"total": 513.40, "avg": 16.04, "max": 12.26, "min": 20.42, "cnt": 32}, "MoEMLP":{"total": 1581.90, "avg": 12.36, "max": 9.73, "min": 20.38, "cnt": 128}, "MoE_L1_fwd":{"total": 366.62, "avg": 11.46, "max": 9.87, "min": 15.67, "cnt": 32}, "MoE_L2_fwd":{"total": 356.73, "avg": 11.15, "max": 10.38, "min": 15.55, "cnt": 32}, "MoE_L3_fwd":{"total": 351.12, "avg": 10.97, "max": 9.78, "min": 13.41, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.84, "avg": 0.92, "max": 0.92, "min": 0.93, "cnt": 2}, "forward-send-backward-recv":{"total": 214.22, "avg": 7.14, "max": 1.51, "min": 115.59, "cnt": 30}, "backward-compute":{"total": 1480.60, "avg": 46.27, "max": 43.03, "min": 49.14, "cnt": 32}, "MoE_L3_bwd":{"total": 344.01, "avg": 10.75, "max": 9.64, "min": 14.02, "cnt": 32}, "MoE_L2_bwd":{"total": 309.32, "avg": 9.67, "max": 8.81, "min": 10.34, "cnt": 32}, "MoE_L1_bwd":{"total": 270.47, "avg": 8.45, "max": 7.43, "min": 9.70, "cnt": 32}, "MoE_L0_bwd":{"total": 340.27, "avg": 10.63, "max": 9.77, "min": 12.05, "cnt": 32}, "backward-send-forward-recv":{"total": 6920.49, "avg": 238.64, "max": 2.37, "min": 764.13, "cnt": 29}, "backward-send":{"total": 2.50, "avg": 0.83, "max": 0.54, "min": 1.05, "cnt": 3}, "backward-recv":{"total": 154.44, "avg": 77.22, "max": 71.74, "min": 82.71, "cnt": 2}, "backward-params-all-reduce":{"total": 488.41, "avg": 488.41, "max": 488.41, "min": 488.41, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 228.65, "avg": 228.65, "max": 228.65, "min": 228.65, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 217.94, "avg": 217.94, "max": 217.94, "min": 217.94, "cnt": 1}, "optimizer-clip-main-grad":{"total": 7.16, "avg": 7.16, "max": 7.16, "min": 7.16, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}}}
{"type":"time", "iteration": 12, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.06, "avg": 0.06, "max": 0.06, "min": 0.06, "cnt": 1}, "forward-recv":{"total": 119.77, "avg": 39.92, "max": 7.06, "min": 100.97, "cnt": 3}, "forward-compute":{"total": 1844.07, "avg": 57.63, "max": 49.84, "min": 74.82, "cnt": 32}, "fwd-compute":{"total": 1841.32, "avg": 57.54, "max": 49.77, "min": 74.72, "cnt": 32}, "batch-generator":{"total": 40.92, "avg": 1.28, "max": 0.66, "min": 2.69, "cnt": 32}, "fwd-embedding":{"total": 0.56, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1788.47, "avg": 55.89, "max": 48.20, "min": 72.42, "cnt": 32}, "fwd-layernorm":{"total": 9.53, "avg": 0.07, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 107.02, "avg": 0.84, "max": 0.74, "min": 1.56, "cnt": 128}, "fwd-misc":{"total": 21.20, "avg": 0.17, "max": 0.11, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1630.11, "avg": 12.74, "max": 9.74, "min": 30.05, "cnt": 128}, "MoE_L0_fwd":{"total": 572.05, "avg": 17.88, "max": 12.31, "min": 29.96, "cnt": 32}, "MoEMLP":{"total": 1612.96, "avg": 12.60, "max": 9.63, "min": 29.91, "cnt": 128}, "MoE_L1_fwd":{"total": 352.38, "avg": 11.01, "max": 9.67, "min": 15.53, "cnt": 32}, "MoE_L2_fwd":{"total": 351.15, "avg": 10.97, "max": 10.45, "min": 13.23, "cnt": 32}, "MoE_L3_fwd":{"total": 343.42, "avg": 10.73, "max": 10.15, "min": 13.18, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.76, "avg": 0.88, "max": 0.80, "min": 0.97, "cnt": 2}, "forward-send-backward-recv":{"total": 191.01, "avg": 6.37, "max": 1.62, "min": 106.22, "cnt": 30}, "backward-compute":{"total": 1481.89, "avg": 46.31, "max": 44.28, "min": 48.25, "cnt": 32}, "MoE_L3_bwd":{"total": 343.43, "avg": 10.73, "max": 10.15, "min": 12.64, "cnt": 32}, "MoE_L2_bwd":{"total": 312.00, "avg": 9.75, "max": 9.06, "min": 10.59, "cnt": 32}, "MoE_L1_bwd":{"total": 268.30, "avg": 8.38, "max": 7.80, "min": 9.99, "cnt": 32}, "MoE_L0_bwd":{"total": 341.22, "avg": 10.66, "max": 10.19, "min": 11.28, "cnt": 32}, "backward-send-forward-recv":{"total": 6398.97, "avg": 220.65, "max": 2.10, "min": 793.27, "cnt": 29}, "backward-send":{"total": 2.65, "avg": 0.88, "max": 0.74, "min": 0.98, "cnt": 3}, "backward-recv":{"total": 138.83, "avg": 69.42, "max": 60.07, "min": 78.77, "cnt": 2}, "backward-params-all-reduce":{"total": 486.39, "avg": 486.39, "max": 486.39, "min": 486.39, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 225.93, "avg": 225.93, "max": 225.93, "min": 225.93, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 215.44, "avg": 215.44, "max": 215.44, "min": 215.44, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.99, "avg": 6.99, "max": 6.99, "min": 6.99, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}}}
{"type":"time", "iteration": 13, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 75.36, "avg": 25.12, "max": 1.05, "min": 66.38, "cnt": 3}, "forward-compute":{"total": 1817.78, "avg": 56.81, "max": 49.46, "min": 67.74, "cnt": 32}, "fwd-compute":{"total": 1814.84, "avg": 56.71, "max": 49.37, "min": 67.65, "cnt": 32}, "batch-generator":{"total": 55.41, "avg": 1.73, "max": 0.70, "min": 3.60, "cnt": 32}, "fwd-embedding":{"total": 0.50, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1748.00, "avg": 54.63, "max": 48.05, "min": 64.97, "cnt": 32}, "fwd-layernorm":{"total": 8.82, "avg": 0.07, "max": 0.05, "min": 0.17, "cnt": 128}, "fwd-attn":{"total": 101.38, "avg": 0.79, "max": 0.74, "min": 1.42, "cnt": 128}, "fwd-misc":{"total": 19.59, "avg": 0.15, "max": 0.11, "min": 0.33, "cnt": 128}, "fwd-MLP":{"total": 1599.18, "avg": 12.49, "max": 9.82, "min": 24.58, "cnt": 128}, "MoE_L0_fwd":{"total": 538.39, "avg": 16.82, "max": 12.25, "min": 24.49, "cnt": 32}, "MoEMLP":{"total": 1583.61, "avg": 12.37, "max": 9.71, "min": 24.45, "cnt": 128}, "MoE_L1_fwd":{"total": 355.89, "avg": 11.12, "max": 9.75, "min": 14.94, "cnt": 32}, "MoE_L2_fwd":{"total": 352.60, "avg": 11.02, "max": 10.46, "min": 14.53, "cnt": 32}, "MoE_L3_fwd":{"total": 342.49, "avg": 10.70, "max": 9.89, "min": 13.10, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.75, "avg": 0.88, "max": 0.82, "min": 0.93, "cnt": 2}, "forward-send-backward-recv":{"total": 204.93, "avg": 6.83, "max": 1.74, "min": 112.25, "cnt": 30}, "backward-compute":{"total": 1485.09, "avg": 46.41, "max": 44.17, "min": 49.37, "cnt": 32}, "MoE_L3_bwd":{"total": 342.58, "avg": 10.71, "max": 9.85, "min": 11.73, "cnt": 32}, "MoE_L2_bwd":{"total": 315.39, "avg": 9.86, "max": 9.07, "min": 13.55, "cnt": 32}, "MoE_L1_bwd":{"total": 267.78, "avg": 8.37, "max": 7.96, "min": 8.91, "cnt": 32}, "MoE_L0_bwd":{"total": 340.23, "avg": 10.63, "max": 10.20, "min": 11.49, "cnt": 32}, "backward-send-forward-recv":{"total": 7263.31, "avg": 250.46, "max": 2.05, "min": 1893.87, "cnt": 29}, "backward-send":{"total": 2.66, "avg": 0.89, "max": 0.62, "min": 1.06, "cnt": 3}, "backward-recv":{"total": 175.16, "avg": 87.58, "max": 86.44, "min": 88.72, "cnt": 2}, "backward-params-all-reduce":{"total": 495.16, "avg": 495.16, "max": 495.16, "min": 495.16, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.04, "avg": 0.04, "max": 0.04, "min": 0.04, "cnt": 1}, "optimizer":{"total": 257.91, "avg": 257.91, "max": 257.91, "min": 257.91, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 213.60, "avg": 213.60, "max": 213.60, "min": 213.60, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.96, "avg": 6.96, "max": 6.96, "min": 6.96, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.51, "avg": 3.51, "max": 3.51, "min": 3.51, "cnt": 1}}}
{"type":"time", "iteration": 14, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.11, "avg": 0.11, "max": 0.11, "min": 0.11, "cnt": 1}, "forward-recv":{"total": 65.22, "avg": 21.74, "max": 0.81, "min": 63.45, "cnt": 3}, "forward-compute":{"total": 1832.26, "avg": 57.26, "max": 50.53, "min": 64.57, "cnt": 32}, "fwd-compute":{"total": 1829.24, "avg": 57.16, "max": 50.46, "min": 64.40, "cnt": 32}, "batch-generator":{"total": 56.92, "avg": 1.78, "max": 0.67, "min": 3.82, "cnt": 32}, "fwd-embedding":{"total": 0.58, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1759.88, "avg": 55.00, "max": 49.47, "min": 61.16, "cnt": 32}, "fwd-layernorm":{"total": 9.63, "avg": 0.08, "max": 0.05, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 106.35, "avg": 0.83, "max": 0.74, "min": 1.57, "cnt": 128}, "fwd-misc":{"total": 20.73, "avg": 0.16, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1602.73, "avg": 12.52, "max": 9.46, "min": 18.79, "cnt": 128}, "MoE_L0_fwd":{"total": 474.87, "avg": 14.84, "max": 11.48, "min": 18.63, "cnt": 32}, "MoEMLP":{"total": 1586.01, "avg": 12.39, "max": 9.36, "min": 18.55, "cnt": 128}, "MoE_L1_fwd":{"total": 392.32, "avg": 12.26, "max": 11.33, "min": 15.15, "cnt": 32}, "MoE_L2_fwd":{"total": 336.65, "avg": 10.52, "max": 9.39, "min": 16.51, "cnt": 32}, "MoE_L3_fwd":{"total": 388.28, "avg": 12.13, "max": 10.97, "min": 15.08, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 14.01, "avg": 7.01, "max": 0.66, "min": 13.35, "cnt": 2}, "forward-send-backward-recv":{"total": 226.73, "avg": 7.56, "max": 1.45, "min": 124.48, "cnt": 30}, "backward-compute":{"total": 1720.95, "avg": 53.78, "max": 50.81, "min": 55.34, "cnt": 32}, "MoE_L3_bwd":{"total": 397.96, "avg": 12.44, "max": 10.98, "min": 14.34, "cnt": 32}, "MoE_L2_bwd":{"total": 330.31, "avg": 10.32, "max": 9.88, "min": 10.92, "cnt": 32}, "MoE_L1_bwd":{"total": 412.03, "avg": 12.88, "max": 12.15, "min": 13.26, "cnt": 32}, "MoE_L0_bwd":{"total": 367.31, "avg": 11.48, "max": 10.86, "min": 11.85, "cnt": 32}, "backward-send-forward-recv":{"total": 5925.75, "avg": 204.34, "max": 2.17, "min": 819.86, "cnt": 29}, "backward-send":{"total": 2.79, "avg": 0.93, "max": 0.85, "min": 1.02, "cnt": 3}, "backward-recv":{"total": 422.77, "avg": 211.38, "max": 58.27, "min": 364.50, "cnt": 2}, "backward-params-all-reduce":{"total": 486.64, "avg": 486.64, "max": 486.64, "min": 486.64, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 260.19, "avg": 260.19, "max": 260.19, "min": 260.19, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 216.03, "avg": 216.03, "max": 216.03, "min": 216.03, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.81, "avg": 6.81, "max": 6.81, "min": 6.81, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.49, "avg": 3.49, "max": 3.49, "min": 3.49, "cnt": 1}}}
{"type":"time", "iteration": 15, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 61.74, "avg": 20.58, "max": 0.73, "min": 60.09, "cnt": 3}, "forward-compute":{"total": 1849.42, "avg": 57.79, "max": 51.86, "min": 64.09, "cnt": 32}, "fwd-compute":{"total": 1846.39, "avg": 57.70, "max": 51.78, "min": 64.00, "cnt": 32}, "batch-generator":{"total": 44.05, "avg": 1.38, "max": 0.70, "min": 2.94, "cnt": 32}, "fwd-embedding":{"total": 0.57, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1789.94, "avg": 55.94, "max": 50.79, "min": 62.42, "cnt": 32}, "fwd-layernorm":{"total": 9.54, "avg": 0.07, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 107.18, "avg": 0.84, "max": 0.74, "min": 1.67, "cnt": 128}, "fwd-misc":{"total": 21.04, "avg": 0.16, "max": 0.11, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1631.14, "avg": 12.74, "max": 9.63, "min": 20.69, "cnt": 128}, "MoE_L0_fwd":{"total": 487.63, "avg": 15.24, "max": 12.43, "min": 20.61, "cnt": 32}, "MoEMLP":{"total": 1614.17, "avg": 12.61, "max": 9.51, "min": 20.57, "cnt": 128}, "MoE_L1_fwd":{"total": 397.16, "avg": 12.41, "max": 11.26, "min": 15.05, "cnt": 32}, "MoE_L2_fwd":{"total": 325.26, "avg": 10.16, "max": 9.55, "min": 14.05, "cnt": 32}, "MoE_L3_fwd":{"total": 410.30, "avg": 12.82, "max": 12.21, "min": 17.17, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 6.39, "avg": 3.20, "max": 0.50, "min": 5.89, "cnt": 2}, "forward-send-backward-recv":{"total": 227.89, "avg": 7.60, "max": 1.24, "min": 130.29, "cnt": 30}, "backward-compute":{"total": 1750.78, "avg": 54.71, "max": 52.19, "min": 55.99, "cnt": 32}, "MoE_L3_bwd":{"total": 431.77, "avg": 13.49, "max": 12.20, "min": 14.54, "cnt": 32}, "MoE_L2_bwd":{"total": 336.82, "avg": 10.53, "max": 9.69, "min": 11.25, "cnt": 32}, "MoE_L1_bwd":{"total": 399.41, "avg": 12.48, "max": 11.93, "min": 13.14, "cnt": 32}, "MoE_L0_bwd":{"total": 369.63, "avg": 11.55, "max": 10.84, "min": 12.43, "cnt": 32}, "backward-send-forward-recv":{"total": 5322.37, "avg": 183.53, "max": 2.14, "min": 804.92, "cnt": 29}, "backward-send":{"total": 2.65, "avg": 0.88, "max": 0.85, "min": 0.92, "cnt": 3}, "backward-recv":{"total": 142.90, "avg": 71.45, "max": 66.66, "min": 76.24, "cnt": 2}, "backward-params-all-reduce":{"total": 491.71, "avg": 491.71, "max": 491.71, "min": 491.71, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 259.44, "avg": 259.44, "max": 259.44, "min": 259.44, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 215.27, "avg": 215.27, "max": 215.27, "min": 215.27, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.78, "avg": 6.78, "max": 6.78, "min": 6.78, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.47, "avg": 3.47, "max": 3.47, "min": 3.47, "cnt": 1}}}
{"type":"time", "iteration": 16, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.06, "avg": 0.06, "max": 0.06, "min": 0.06, "cnt": 1}, "forward-recv":{"total": 74.37, "avg": 24.79, "max": 0.77, "min": 68.89, "cnt": 3}, "forward-compute":{"total": 1845.15, "avg": 57.66, "max": 51.75, "min": 66.15, "cnt": 32}, "fwd-compute":{"total": 1842.11, "avg": 57.57, "max": 51.69, "min": 66.05, "cnt": 32}, "batch-generator":{"total": 44.70, "avg": 1.40, "max": 0.63, "min": 3.41, "cnt": 32}, "fwd-embedding":{"total": 0.54, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1785.27, "avg": 55.79, "max": 50.61, "min": 64.58, "cnt": 32}, "fwd-layernorm":{"total": 9.22, "avg": 0.07, "max": 0.05, "min": 0.18, "cnt": 128}, "fwd-attn":{"total": 103.84, "avg": 0.81, "max": 0.74, "min": 1.46, "cnt": 128}, "fwd-misc":{"total": 20.03, "avg": 0.16, "max": 0.11, "min": 0.34, "cnt": 128}, "fwd-MLP":{"total": 1631.57, "avg": 12.75, "max": 9.65, "min": 19.78, "cnt": 128}, "MoE_L0_fwd":{"total": 481.36, "avg": 15.04, "max": 11.80, "min": 19.70, "cnt": 32}, "MoEMLP":{"total": 1615.41, "avg": 12.62, "max": 9.55, "min": 19.65, "cnt": 128}, "MoE_L1_fwd":{"total": 387.59, "avg": 12.11, "max": 11.10, "min": 14.89, "cnt": 32}, "MoE_L2_fwd":{"total": 326.74, "avg": 10.21, "max": 9.58, "min": 14.20, "cnt": 32}, "MoE_L3_fwd":{"total": 425.69, "avg": 13.30, "max": 12.40, "min": 18.22, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 4.05, "avg": 2.03, "max": 0.72, "min": 3.33, "cnt": 2}, "forward-send-backward-recv":{"total": 368.52, "avg": 12.28, "max": 1.40, "min": 126.07, "cnt": 30}, "backward-compute":{"total": 1731.71, "avg": 54.12, "max": 51.88, "min": 55.42, "cnt": 32}, "MoE_L3_bwd":{"total": 424.85, "avg": 13.28, "max": 12.26, "min": 14.28, "cnt": 32}, "MoE_L2_bwd":{"total": 329.98, "avg": 10.31, "max": 9.69, "min": 11.18, "cnt": 32}, "MoE_L1_bwd":{"total": 398.18, "avg": 12.44, "max": 11.57, "min": 13.03, "cnt": 32}, "MoE_L0_bwd":{"total": 364.29, "avg": 11.38, "max": 10.81, "min": 11.81, "cnt": 32}, "backward-send-forward-recv":{"total": 6088.47, "avg": 209.95, "max": 2.08, "min": 1132.90, "cnt": 29}, "backward-send":{"total": 2.74, "avg": 0.91, "max": 0.78, "min": 1.01, "cnt": 3}, "backward-recv":{"total": 426.53, "avg": 213.26, "max": 68.56, "min": 357.97, "cnt": 2}, "backward-params-all-reduce":{"total": 485.70, "avg": 485.70, "max": 485.70, "min": 485.70, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 262.17, "avg": 262.17, "max": 262.17, "min": 262.17, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 217.95, "avg": 217.95, "max": 217.95, "min": 217.95, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.88, "avg": 6.88, "max": 6.88, "min": 6.88, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 17, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.06, "avg": 0.06, "max": 0.06, "min": 0.06, "cnt": 1}, "forward-recv":{"total": 65.49, "avg": 21.83, "max": 0.65, "min": 62.84, "cnt": 3}, "forward-compute":{"total": 1818.75, "avg": 56.84, "max": 50.13, "min": 65.88, "cnt": 32}, "fwd-compute":{"total": 1815.94, "avg": 56.75, "max": 50.05, "min": 65.80, "cnt": 32}, "batch-generator":{"total": 41.42, "avg": 1.29, "max": 0.66, "min": 3.06, "cnt": 32}, "fwd-embedding":{"total": 0.52, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1762.59, "avg": 55.08, "max": 49.06, "min": 63.50, "cnt": 32}, "fwd-layernorm":{"total": 9.09, "avg": 0.07, "max": 0.05, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 103.94, "avg": 0.81, "max": 0.74, "min": 1.51, "cnt": 128}, "fwd-misc":{"total": 20.42, "avg": 0.16, "max": 0.11, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1609.27, "avg": 12.57, "max": 9.48, "min": 20.29, "cnt": 128}, "MoE_L0_fwd":{"total": 469.71, "avg": 14.68, "max": 10.92, "min": 20.21, "cnt": 32}, "MoEMLP":{"total": 1593.03, "avg": 12.45, "max": 9.38, "min": 20.16, "cnt": 128}, "MoE_L1_fwd":{"total": 394.73, "avg": 12.34, "max": 11.35, "min": 13.90, "cnt": 32}, "MoE_L2_fwd":{"total": 319.99, "avg": 10.00, "max": 9.42, "min": 10.73, "cnt": 32}, "MoE_L3_fwd":{"total": 414.49, "avg": 12.95, "max": 11.75, "min": 19.92, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 8.87, "avg": 4.43, "max": 0.72, "min": 8.15, "cnt": 2}, "forward-send-backward-recv":{"total": 204.45, "avg": 6.81, "max": 1.26, "min": 119.57, "cnt": 30}, "backward-compute":{"total": 1738.76, "avg": 54.34, "max": 51.12, "min": 57.90, "cnt": 32}, "MoE_L3_bwd":{"total": 436.38, "avg": 13.64, "max": 12.53, "min": 17.14, "cnt": 32}, "MoE_L2_bwd":{"total": 335.97, "avg": 10.50, "max": 9.73, "min": 11.35, "cnt": 32}, "MoE_L1_bwd":{"total": 407.74, "avg": 12.74, "max": 11.25, "min": 13.14, "cnt": 32}, "MoE_L0_bwd":{"total": 346.38, "avg": 10.82, "max": 10.09, "min": 11.25, "cnt": 32}, "backward-send-forward-recv":{"total": 6633.41, "avg": 228.74, "max": 2.44, "min": 863.57, "cnt": 29}, "backward-send":{"total": 2.77, "avg": 0.92, "max": 0.89, "min": 0.96, "cnt": 3}, "backward-recv":{"total": 136.42, "avg": 68.21, "max": 68.17, "min": 68.25, "cnt": 2}, "backward-params-all-reduce":{"total": 490.66, "avg": 490.66, "max": 490.66, "min": 490.66, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 259.35, "avg": 259.35, "max": 259.35, "min": 259.35, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 215.16, "avg": 215.16, "max": 215.16, "min": 215.16, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.86, "avg": 6.86, "max": 6.86, "min": 6.86, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 18, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 69.07, "avg": 23.02, "max": 0.73, "min": 67.42, "cnt": 3}, "forward-compute":{"total": 1837.91, "avg": 57.43, "max": 50.58, "min": 64.44, "cnt": 32}, "fwd-compute":{"total": 1834.70, "avg": 57.33, "max": 50.52, "min": 64.36, "cnt": 32}, "batch-generator":{"total": 55.85, "avg": 1.75, "max": 0.70, "min": 3.37, "cnt": 32}, "fwd-embedding":{"total": 0.63, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1766.54, "avg": 55.20, "max": 49.48, "min": 62.81, "cnt": 32}, "fwd-layernorm":{"total": 9.93, "avg": 0.08, "max": 0.05, "min": 0.18, "cnt": 128}, "fwd-attn":{"total": 106.91, "avg": 0.84, "max": 0.74, "min": 1.46, "cnt": 128}, "fwd-misc":{"total": 21.32, "avg": 0.17, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1607.42, "avg": 12.56, "max": 9.76, "min": 21.05, "cnt": 128}, "MoE_L0_fwd":{"total": 459.87, "avg": 14.37, "max": 10.96, "min": 20.96, "cnt": 32}, "MoEMLP":{"total": 1590.54, "avg": 12.43, "max": 9.64, "min": 20.91, "cnt": 128}, "MoE_L1_fwd":{"total": 388.09, "avg": 12.13, "max": 10.73, "min": 14.88, "cnt": 32}, "MoE_L2_fwd":{"total": 339.71, "avg": 10.62, "max": 9.69, "min": 15.19, "cnt": 32}, "MoE_L3_fwd":{"total": 409.09, "avg": 12.78, "max": 12.11, "min": 15.23, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 7.88, "avg": 3.94, "max": 0.60, "min": 7.27, "cnt": 2}, "forward-send-backward-recv":{"total": 204.73, "avg": 6.82, "max": 1.38, "min": 120.59, "cnt": 30}, "backward-compute":{"total": 1744.63, "avg": 54.52, "max": 51.92, "min": 55.75, "cnt": 32}, "MoE_L3_bwd":{"total": 432.16, "avg": 13.51, "max": 12.83, "min": 14.17, "cnt": 32}, "MoE_L2_bwd":{"total": 337.00, "avg": 10.53, "max": 10.11, "min": 11.27, "cnt": 32}, "MoE_L1_bwd":{"total": 397.60, "avg": 12.42, "max": 11.71, "min": 13.17, "cnt": 32}, "MoE_L0_bwd":{"total": 366.05, "avg": 11.44, "max": 10.91, "min": 11.87, "cnt": 32}, "backward-send-forward-recv":{"total": 7129.60, "avg": 245.85, "max": 2.32, "min": 962.93, "cnt": 29}, "backward-send":{"total": 2.00, "avg": 0.67, "max": 0.58, "min": 0.72, "cnt": 3}, "backward-recv":{"total": 405.12, "avg": 202.56, "max": 121.85, "min": 283.27, "cnt": 2}, "backward-params-all-reduce":{"total": 489.23, "avg": 489.23, "max": 489.23, "min": 489.23, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 266.22, "avg": 266.22, "max": 266.22, "min": 266.22, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 221.89, "avg": 221.89, "max": 221.89, "min": 221.89, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.87, "avg": 6.87, "max": 6.87, "min": 6.87, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.52, "avg": 3.52, "max": 3.52, "min": 3.52, "cnt": 1}}}
{"type":"time", "iteration": 19, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 67.56, "avg": 22.52, "max": 0.97, "min": 63.35, "cnt": 3}, "forward-compute":{"total": 1806.19, "avg": 56.44, "max": 50.88, "min": 64.15, "cnt": 32}, "fwd-compute":{"total": 1803.46, "avg": 56.36, "max": 50.82, "min": 64.07, "cnt": 32}, "batch-generator":{"total": 50.10, "avg": 1.57, "max": 0.65, "min": 3.35, "cnt": 32}, "fwd-embedding":{"total": 0.44, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1742.21, "avg": 54.44, "max": 49.88, "min": 62.06, "cnt": 32}, "fwd-layernorm":{"total": 8.57, "avg": 0.07, "max": 0.05, "min": 0.17, "cnt": 128}, "fwd-attn":{"total": 100.66, "avg": 0.79, "max": 0.74, "min": 1.38, "cnt": 128}, "fwd-misc":{"total": 18.85, "avg": 0.15, "max": 0.11, "min": 0.34, "cnt": 128}, "fwd-MLP":{"total": 1595.34, "avg": 12.46, "max": 9.60, "min": 21.36, "cnt": 128}, "MoE_L0_fwd":{"total": 450.82, "avg": 14.09, "max": 11.13, "min": 21.28, "cnt": 32}, "MoEMLP":{"total": 1579.97, "avg": 12.34, "max": 9.50, "min": 21.24, "cnt": 128}, "MoE_L1_fwd":{"total": 380.73, "avg": 11.90, "max": 10.89, "min": 15.54, "cnt": 32}, "MoE_L2_fwd":{"total": 338.46, "avg": 10.58, "max": 9.54, "min": 12.63, "cnt": 32}, "MoE_L3_fwd":{"total": 415.64, "avg": 12.99, "max": 12.33, "min": 15.51, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 9.45, "avg": 4.72, "max": 0.74, "min": 8.71, "cnt": 2}, "forward-send-backward-recv":{"total": 528.82, "avg": 17.63, "max": 1.30, "min": 176.36, "cnt": 30}, "backward-compute":{"total": 1741.34, "avg": 54.42, "max": 51.41, "min": 56.92, "cnt": 32}, "MoE_L3_bwd":{"total": 429.83, "avg": 13.43, "max": 12.37, "min": 16.22, "cnt": 32}, "MoE_L2_bwd":{"total": 336.93, "avg": 10.53, "max": 9.86, "min": 12.38, "cnt": 32}, "MoE_L1_bwd":{"total": 394.93, "avg": 12.34, "max": 11.82, "min": 12.62, "cnt": 32}, "MoE_L0_bwd":{"total": 367.43, "avg": 11.48, "max": 10.78, "min": 12.12, "cnt": 32}, "backward-send-forward-recv":{"total": 5064.77, "avg": 174.65, "max": 1.74, "min": 715.18, "cnt": 29}, "backward-send":{"total": 3.23, "avg": 1.08, "max": 1.04, "min": 1.11, "cnt": 3}, "backward-recv":{"total": 235.22, "avg": 117.61, "max": 55.89, "min": 179.33, "cnt": 2}, "backward-params-all-reduce":{"total": 487.20, "avg": 487.20, "max": 487.20, "min": 487.20, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 260.03, "avg": 260.03, "max": 260.03, "min": 260.03, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 215.91, "avg": 215.91, "max": 215.91, "min": 215.91, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.81, "avg": 6.81, "max": 6.81, "min": 6.81, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.48, "avg": 3.48, "max": 3.48, "min": 3.48, "cnt": 1}}}
{"type":"time", "iteration": 20, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 1072.08, "avg": 357.36, "max": 0.84, "min": 1070.14, "cnt": 3}, "forward-compute":{"total": 1914.31, "avg": 59.82, "max": 51.30, "min": 65.53, "cnt": 32}, "fwd-compute":{"total": 1911.10, "avg": 59.72, "max": 51.23, "min": 65.44, "cnt": 32}, "batch-generator":{"total": 51.21, "avg": 1.60, "max": 0.68, "min": 4.10, "cnt": 32}, "fwd-embedding":{"total": 0.68, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1846.68, "avg": 57.71, "max": 50.03, "min": 64.17, "cnt": 32}, "fwd-layernorm":{"total": 10.39, "avg": 0.08, "max": 0.05, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 109.87, "avg": 0.86, "max": 0.74, "min": 1.54, "cnt": 128}, "fwd-misc":{"total": 22.22, "avg": 0.17, "max": 0.11, "min": 0.56, "cnt": 128}, "fwd-MLP":{"total": 1682.38, "avg": 13.14, "max": 9.97, "min": 20.78, "cnt": 128}, "MoE_L0_fwd":{"total": 504.16, "avg": 15.75, "max": 10.79, "min": 20.70, "cnt": 32}, "MoEMLP":{"total": 1664.59, "avg": 13.00, "max": 9.88, "min": 20.66, "cnt": 128}, "MoE_L1_fwd":{"total": 395.76, "avg": 12.37, "max": 11.04, "min": 17.91, "cnt": 32}, "MoE_L2_fwd":{"total": 348.91, "avg": 10.90, "max": 9.91, "min": 13.43, "cnt": 32}, "MoE_L3_fwd":{"total": 422.21, "avg": 13.19, "max": 12.16, "min": 15.37, "cnt": 32}, "fwd-pooler":{"total": 0.36, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 24.72, "avg": 12.36, "max": 0.59, "min": 24.13, "cnt": 2}, "forward-send-backward-recv":{"total": 511.85, "avg": 17.06, "max": 1.34, "min": 195.23, "cnt": 30}, "backward-compute":{"total": 1755.35, "avg": 54.85, "max": 52.20, "min": 58.18, "cnt": 32}, "MoE_L3_bwd":{"total": 446.61, "avg": 13.96, "max": 13.13, "min": 15.34, "cnt": 32}, "MoE_L2_bwd":{"total": 334.30, "avg": 10.45, "max": 9.77, "min": 11.17, "cnt": 32}, "MoE_L1_bwd":{"total": 395.92, "avg": 12.37, "max": 11.51, "min": 15.31, "cnt": 32}, "MoE_L0_bwd":{"total": 366.21, "avg": 11.44, "max": 10.84, "min": 12.18, "cnt": 32}, "backward-send-forward-recv":{"total": 5980.45, "avg": 206.22, "max": 1.68, "min": 848.83, "cnt": 29}, "backward-send":{"total": 2.93, "avg": 0.98, "max": 0.88, "min": 1.07, "cnt": 3}, "backward-recv":{"total": 475.54, "avg": 237.77, "max": 65.30, "min": 410.24, "cnt": 2}, "backward-params-all-reduce":{"total": 482.36, "avg": 482.36, "max": 482.36, "min": 482.36, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.04, "avg": 0.04, "max": 0.04, "min": 0.04, "cnt": 1}, "optimizer":{"total": 260.73, "avg": 260.73, "max": 260.73, "min": 260.73, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 216.59, "avg": 216.59, "max": 216.59, "min": 216.59, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.82, "avg": 6.82, "max": 6.82, "min": 6.82, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.48, "avg": 3.48, "max": 3.48, "min": 3.48, "cnt": 1}}}
{"type":"time", "iteration": 21, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 62.81, "avg": 20.94, "max": 0.72, "min": 61.20, "cnt": 3}, "forward-compute":{"total": 1827.65, "avg": 57.11, "max": 49.77, "min": 62.98, "cnt": 32}, "fwd-compute":{"total": 1824.48, "avg": 57.02, "max": 49.70, "min": 62.90, "cnt": 32}, "batch-generator":{"total": 53.13, "avg": 1.66, "max": 0.65, "min": 3.00, "cnt": 32}, "fwd-embedding":{"total": 0.61, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1759.34, "avg": 54.98, "max": 48.76, "min": 60.96, "cnt": 32}, "fwd-layernorm":{"total": 9.71, "avg": 0.08, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 107.20, "avg": 0.84, "max": 0.74, "min": 1.48, "cnt": 128}, "fwd-misc":{"total": 20.72, "avg": 0.16, "max": 0.11, "min": 0.38, "cnt": 128}, "fwd-MLP":{"total": 1601.36, "avg": 12.51, "max": 9.58, "min": 20.14, "cnt": 128}, "MoE_L0_fwd":{"total": 461.01, "avg": 14.41, "max": 10.37, "min": 20.06, "cnt": 32}, "MoEMLP":{"total": 1584.91, "avg": 12.38, "max": 9.48, "min": 20.02, "cnt": 128}, "MoE_L1_fwd":{"total": 393.63, "avg": 12.30, "max": 11.06, "min": 14.86, "cnt": 32}, "MoE_L2_fwd":{"total": 328.26, "avg": 10.26, "max": 9.52, "min": 11.54, "cnt": 32}, "MoE_L3_fwd":{"total": 408.10, "avg": 12.75, "max": 11.46, "min": 14.60, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.56, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 7.76, "avg": 3.88, "max": 0.70, "min": 7.06, "cnt": 2}, "forward-send-backward-recv":{"total": 202.04, "avg": 6.73, "max": 1.46, "min": 118.36, "cnt": 30}, "backward-compute":{"total": 1721.49, "avg": 53.80, "max": 50.59, "min": 56.89, "cnt": 32}, "MoE_L3_bwd":{"total": 419.96, "avg": 13.12, "max": 12.39, "min": 14.00, "cnt": 32}, "MoE_L2_bwd":{"total": 334.40, "avg": 10.45, "max": 9.39, "min": 13.30, "cnt": 32}, "MoE_L1_bwd":{"total": 402.70, "avg": 12.58, "max": 11.98, "min": 13.15, "cnt": 32}, "MoE_L0_bwd":{"total": 351.21, "avg": 10.98, "max": 10.11, "min": 11.74, "cnt": 32}, "backward-send-forward-recv":{"total": 4433.87, "avg": 152.89, "max": 2.26, "min": 386.40, "cnt": 29}, "backward-send":{"total": 2.34, "avg": 0.78, "max": 0.56, "min": 0.99, "cnt": 3}, "backward-recv":{"total": 135.62, "avg": 67.81, "max": 65.68, "min": 69.94, "cnt": 2}, "backward-params-all-reduce":{"total": 490.15, "avg": 490.15, "max": 490.15, "min": 490.15, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 258.70, "avg": 258.70, "max": 258.70, "min": 258.70, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 212.91, "avg": 212.91, "max": 212.91, "min": 212.91, "cnt": 1}, "optimizer-clip-main-grad":{"total": 8.46, "avg": 8.46, "max": 8.46, "min": 8.46, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}}}
{"type":"time", "iteration": 22, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 63.45, "avg": 21.15, "max": 0.97, "min": 59.55, "cnt": 3}, "forward-compute":{"total": 1875.42, "avg": 58.61, "max": 50.64, "min": 70.95, "cnt": 32}, "fwd-compute":{"total": 1872.09, "avg": 58.50, "max": 50.58, "min": 70.88, "cnt": 32}, "batch-generator":{"total": 44.00, "avg": 1.38, "max": 0.63, "min": 3.48, "cnt": 32}, "fwd-embedding":{"total": 0.63, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1814.60, "avg": 56.71, "max": 49.65, "min": 68.99, "cnt": 32}, "fwd-layernorm":{"total": 10.36, "avg": 0.08, "max": 0.05, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 110.50, "avg": 0.86, "max": 0.74, "min": 1.55, "cnt": 128}, "fwd-misc":{"total": 21.96, "avg": 0.17, "max": 0.11, "min": 0.39, "cnt": 128}, "fwd-MLP":{"total": 1649.28, "avg": 12.89, "max": 9.62, "min": 21.28, "cnt": 128}, "MoE_L0_fwd":{"total": 479.69, "avg": 14.99, "max": 11.06, "min": 21.20, "cnt": 32}, "MoEMLP":{"total": 1631.09, "avg": 12.74, "max": 9.52, "min": 21.15, "cnt": 128}, "MoE_L1_fwd":{"total": 392.08, "avg": 12.25, "max": 10.94, "min": 14.32, "cnt": 32}, "MoE_L2_fwd":{"total": 330.78, "avg": 10.34, "max": 9.56, "min": 15.49, "cnt": 32}, "MoE_L3_fwd":{"total": 435.14, "avg": 13.60, "max": 12.98, "min": 15.68, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 2.08, "avg": 1.04, "max": 0.53, "min": 1.55, "cnt": 2}, "forward-send-backward-recv":{"total": 803.05, "avg": 26.77, "max": 1.22, "min": 127.50, "cnt": 30}, "backward-compute":{"total": 1818.44, "avg": 56.83, "max": 52.32, "min": 92.38, "cnt": 32}, "MoE_L3_bwd":{"total": 509.96, "avg": 15.94, "max": 13.21, "min": 51.45, "cnt": 32}, "MoE_L2_bwd":{"total": 336.86, "avg": 10.53, "max": 9.91, "min": 11.15, "cnt": 32}, "MoE_L1_bwd":{"total": 401.84, "avg": 12.56, "max": 11.50, "min": 13.33, "cnt": 32}, "MoE_L0_bwd":{"total": 356.41, "avg": 11.14, "max": 10.54, "min": 12.25, "cnt": 32}, "backward-send-forward-recv":{"total": 4565.48, "avg": 157.43, "max": 2.23, "min": 742.79, "cnt": 29}, "backward-send":{"total": 2.80, "avg": 0.93, "max": 0.69, "min": 1.05, "cnt": 3}, "backward-recv":{"total": 369.77, "avg": 184.88, "max": 70.43, "min": 299.34, "cnt": 2}, "backward-params-all-reduce":{"total": 485.50, "avg": 485.50, "max": 485.50, "min": 485.50, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 256.79, "avg": 256.79, "max": 256.79, "min": 256.79, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 210.70, "avg": 210.70, "max": 210.70, "min": 210.70, "cnt": 1}, "optimizer-clip-main-grad":{"total": 8.72, "avg": 8.72, "max": 8.72, "min": 8.72, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 23, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 59.39, "avg": 19.80, "max": 0.87, "min": 57.63, "cnt": 3}, "forward-compute":{"total": 1932.24, "avg": 60.38, "max": 52.83, "min": 89.83, "cnt": 32}, "fwd-compute":{"total": 1929.08, "avg": 60.28, "max": 52.76, "min": 89.76, "cnt": 32}, "batch-generator":{"total": 59.63, "avg": 1.86, "max": 0.71, "min": 10.66, "cnt": 32}, "fwd-embedding":{"total": 0.64, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1856.97, "avg": 58.03, "max": 50.68, "min": 88.70, "cnt": 32}, "fwd-layernorm":{"total": 10.12, "avg": 0.08, "max": 0.05, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 109.53, "avg": 0.86, "max": 0.74, "min": 1.48, "cnt": 128}, "fwd-misc":{"total": 21.70, "avg": 0.17, "max": 0.11, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1694.38, "avg": 13.24, "max": 9.63, "min": 47.39, "cnt": 128}, "MoE_L0_fwd":{"total": 501.80, "avg": 15.68, "max": 10.74, "min": 47.32, "cnt": 32}, "MoEMLP":{"total": 1676.91, "avg": 13.10, "max": 9.53, "min": 47.27, "cnt": 128}, "MoE_L1_fwd":{"total": 394.52, "avg": 12.33, "max": 11.01, "min": 14.44, "cnt": 32}, "MoE_L2_fwd":{"total": 330.32, "avg": 10.32, "max": 9.57, "min": 11.35, "cnt": 32}, "MoE_L3_fwd":{"total": 456.63, "avg": 14.27, "max": 13.61, "min": 16.82, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.65, "avg": 0.02, "max": 0.02, "min": 0.05, "cnt": 32}, "forward-send":{"total": 0.97, "avg": 0.49, "max": 0.48, "min": 0.50, "cnt": 2}, "forward-send-backward-recv":{"total": 416.41, "avg": 13.88, "max": 1.19, "min": 129.50, "cnt": 30}, "backward-compute":{"total": 1829.55, "avg": 57.17, "max": 53.06, "min": 59.32, "cnt": 32}, "MoE_L3_bwd":{"total": 527.43, "avg": 16.48, "max": 14.98, "min": 18.79, "cnt": 32}, "MoE_L2_bwd":{"total": 336.49, "avg": 10.52, "max": 9.40, "min": 11.10, "cnt": 32}, "MoE_L1_bwd":{"total": 404.41, "avg": 12.64, "max": 11.81, "min": 13.27, "cnt": 32}, "MoE_L0_bwd":{"total": 354.20, "avg": 11.07, "max": 10.65, "min": 11.43, "cnt": 32}, "backward-send-forward-recv":{"total": 4061.17, "avg": 140.04, "max": 2.14, "min": 473.95, "cnt": 29}, "backward-send":{"total": 3.39, "avg": 1.13, "max": 1.08, "min": 1.20, "cnt": 3}, "backward-recv":{"total": 126.82, "avg": 63.41, "max": 60.90, "min": 65.92, "cnt": 2}, "backward-params-all-reduce":{"total": 487.15, "avg": 487.15, "max": 487.15, "min": 487.15, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 264.65, "avg": 264.65, "max": 264.65, "min": 264.65, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 220.48, "avg": 220.48, "max": 220.48, "min": 220.48, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.82, "avg": 6.82, "max": 6.82, "min": 6.82, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.49, "avg": 3.49, "max": 3.49, "min": 3.49, "cnt": 1}}}
{"type":"time", "iteration": 24, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 59.48, "avg": 19.83, "max": 1.05, "min": 57.14, "cnt": 3}, "forward-compute":{"total": 1928.51, "avg": 60.27, "max": 54.30, "min": 66.26, "cnt": 32}, "fwd-compute":{"total": 1925.28, "avg": 60.16, "max": 54.22, "min": 66.18, "cnt": 32}, "batch-generator":{"total": 47.10, "avg": 1.47, "max": 0.66, "min": 2.65, "cnt": 32}, "fwd-embedding":{"total": 0.68, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1864.91, "avg": 58.28, "max": 53.25, "min": 64.65, "cnt": 32}, "fwd-layernorm":{"total": 10.82, "avg": 0.08, "max": 0.05, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 113.94, "avg": 0.89, "max": 0.74, "min": 2.09, "cnt": 128}, "fwd-misc":{"total": 23.02, "avg": 0.18, "max": 0.11, "min": 0.39, "cnt": 128}, "fwd-MLP":{"total": 1694.08, "avg": 13.23, "max": 9.60, "min": 21.21, "cnt": 128}, "MoE_L0_fwd":{"total": 470.87, "avg": 14.71, "max": 11.74, "min": 21.02, "cnt": 32}, "MoEMLP":{"total": 1675.17, "avg": 13.09, "max": 9.48, "min": 21.09, "cnt": 128}, "MoE_L1_fwd":{"total": 404.69, "avg": 12.65, "max": 10.97, "min": 15.08, "cnt": 32}, "MoE_L2_fwd":{"total": 326.90, "avg": 10.22, "max": 9.53, "min": 11.62, "cnt": 32}, "MoE_L3_fwd":{"total": 479.51, "avg": 14.98, "max": 13.66, "min": 21.14, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 8.88, "avg": 4.44, "max": 0.45, "min": 8.43, "cnt": 2}, "forward-send-backward-recv":{"total": 173.90, "avg": 5.80, "max": 1.22, "min": 117.97, "cnt": 30}, "backward-compute":{"total": 1870.79, "avg": 58.46, "max": 54.31, "min": 61.30, "cnt": 32}, "MoE_L3_bwd":{"total": 566.05, "avg": 17.69, "max": 16.03, "min": 20.57, "cnt": 32}, "MoE_L2_bwd":{"total": 333.99, "avg": 10.44, "max": 9.88, "min": 11.32, "cnt": 32}, "MoE_L1_bwd":{"total": 404.14, "avg": 12.63, "max": 12.01, "min": 13.35, "cnt": 32}, "MoE_L0_bwd":{"total": 357.15, "avg": 11.16, "max": 10.13, "min": 11.64, "cnt": 32}, "backward-send-forward-recv":{"total": 4390.92, "avg": 151.41, "max": 2.17, "min": 463.98, "cnt": 29}, "backward-send":{"total": 3.15, "avg": 1.05, "max": 0.94, "min": 1.22, "cnt": 3}, "backward-recv":{"total": 133.57, "avg": 66.78, "max": 65.22, "min": 68.34, "cnt": 2}, "backward-params-all-reduce":{"total": 496.85, "avg": 496.85, "max": 496.85, "min": 496.85, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 249.87, "avg": 249.87, "max": 249.87, "min": 249.87, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 205.50, "avg": 205.50, "max": 205.50, "min": 205.50, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.94, "avg": 6.94, "max": 6.94, "min": 6.94, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.50, "avg": 3.50, "max": 3.50, "min": 3.50, "cnt": 1}}}
{"type":"time", "iteration": 25, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 71.46, "avg": 23.82, "max": 3.41, "min": 62.19, "cnt": 3}, "forward-compute":{"total": 1969.78, "avg": 61.56, "max": 53.77, "min": 71.16, "cnt": 32}, "fwd-compute":{"total": 1966.52, "avg": 61.45, "max": 53.69, "min": 71.06, "cnt": 32}, "batch-generator":{"total": 69.86, "avg": 2.18, "max": 0.67, "min": 4.28, "cnt": 32}, "fwd-embedding":{"total": 0.73, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1884.00, "avg": 58.87, "max": 52.66, "min": 67.36, "cnt": 32}, "fwd-layernorm":{"total": 10.60, "avg": 0.08, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 110.51, "avg": 0.86, "max": 0.74, "min": 1.50, "cnt": 128}, "fwd-misc":{"total": 22.21, "avg": 0.17, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1719.15, "avg": 13.43, "max": 9.66, "min": 20.78, "cnt": 128}, "MoE_L0_fwd":{"total": 486.39, "avg": 15.20, "max": 11.32, "min": 20.26, "cnt": 32}, "MoEMLP":{"total": 1701.46, "avg": 13.29, "max": 9.55, "min": 20.67, "cnt": 128}, "MoE_L1_fwd":{"total": 405.40, "avg": 12.67, "max": 11.22, "min": 15.17, "cnt": 32}, "MoE_L2_fwd":{"total": 332.91, "avg": 10.40, "max": 9.59, "min": 12.53, "cnt": 32}, "MoE_L3_fwd":{"total": 483.30, "avg": 15.10, "max": 14.02, "min": 20.71, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.56, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 0.86, "avg": 0.43, "max": 0.42, "min": 0.44, "cnt": 2}, "forward-send-backward-recv":{"total": 206.99, "avg": 6.90, "max": 1.22, "min": 109.49, "cnt": 30}, "backward-compute":{"total": 1884.90, "avg": 58.90, "max": 57.59, "min": 60.55, "cnt": 32}, "MoE_L3_bwd":{"total": 575.81, "avg": 17.99, "max": 16.32, "min": 19.47, "cnt": 32}, "MoE_L2_bwd":{"total": 336.01, "avg": 10.50, "max": 9.93, "min": 13.93, "cnt": 32}, "MoE_L1_bwd":{"total": 407.65, "avg": 12.74, "max": 12.11, "min": 13.19, "cnt": 32}, "MoE_L0_bwd":{"total": 358.38, "avg": 11.20, "max": 10.68, "min": 12.65, "cnt": 32}, "backward-send-forward-recv":{"total": 5163.05, "avg": 178.04, "max": 2.00, "min": 1264.31, "cnt": 29}, "backward-send":{"total": 2.77, "avg": 0.92, "max": 0.68, "min": 1.12, "cnt": 3}, "backward-recv":{"total": 182.26, "avg": 91.13, "max": 66.26, "min": 115.99, "cnt": 2}, "backward-params-all-reduce":{"total": 489.99, "avg": 489.99, "max": 489.99, "min": 489.99, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 258.39, "avg": 258.39, "max": 258.39, "min": 258.39, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.47, "avg": 3.47, "max": 3.47, "min": 3.47, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 214.06, "avg": 214.06, "max": 214.06, "min": 214.06, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.81, "avg": 6.81, "max": 6.81, "min": 6.81, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.49, "avg": 3.49, "max": 3.49, "min": 3.49, "cnt": 1}}}
{"type":"time", "iteration": 26, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 58.81, "avg": 19.60, "max": 0.89, "min": 57.01, "cnt": 3}, "forward-compute":{"total": 1872.24, "avg": 58.51, "max": 52.28, "min": 64.10, "cnt": 32}, "fwd-compute":{"total": 1869.18, "avg": 58.41, "max": 52.22, "min": 64.01, "cnt": 32}, "batch-generator":{"total": 41.68, "avg": 1.30, "max": 0.64, "min": 3.20, "cnt": 32}, "fwd-embedding":{"total": 0.55, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1815.62, "avg": 56.74, "max": 51.30, "min": 62.15, "cnt": 32}, "fwd-layernorm":{"total": 9.38, "avg": 0.07, "max": 0.05, "min": 0.18, "cnt": 128}, "fwd-attn":{"total": 104.67, "avg": 0.82, "max": 0.74, "min": 1.42, "cnt": 128}, "fwd-misc":{"total": 20.34, "avg": 0.16, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1660.62, "avg": 12.97, "max": 9.49, "min": 18.70, "cnt": 128}, "MoE_L0_fwd":{"total": 458.40, "avg": 14.32, "max": 10.58, "min": 18.62, "cnt": 32}, "MoEMLP":{"total": 1643.99, "avg": 12.84, "max": 9.40, "min": 18.57, "cnt": 128}, "MoE_L1_fwd":{"total": 398.13, "avg": 12.44, "max": 11.32, "min": 13.87, "cnt": 32}, "MoE_L2_fwd":{"total": 316.49, "avg": 9.89, "max": 9.43, "min": 10.86, "cnt": 32}, "MoE_L3_fwd":{"total": 476.99, "avg": 14.91, "max": 14.57, "min": 15.72, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.09, "avg": 0.55, "max": 0.52, "min": 0.57, "cnt": 2}, "forward-send-backward-recv":{"total": 301.66, "avg": 10.06, "max": 1.37, "min": 130.60, "cnt": 30}, "backward-compute":{"total": 1859.91, "avg": 58.12, "max": 56.18, "min": 59.96, "cnt": 32}, "MoE_L3_bwd":{"total": 573.29, "avg": 17.92, "max": 16.86, "min": 18.68, "cnt": 32}, "MoE_L2_bwd":{"total": 333.61, "avg": 10.43, "max": 9.69, "min": 10.84, "cnt": 32}, "MoE_L1_bwd":{"total": 399.74, "avg": 12.49, "max": 11.70, "min": 13.01, "cnt": 32}, "MoE_L0_bwd":{"total": 346.18, "avg": 10.82, "max": 10.37, "min": 11.71, "cnt": 32}, "backward-send-forward-recv":{"total": 6105.75, "avg": 210.54, "max": 1.60, "min": 1253.92, "cnt": 29}, "backward-send":{"total": 2.54, "avg": 0.85, "max": 0.55, "min": 0.99, "cnt": 3}, "backward-recv":{"total": 232.15, "avg": 116.07, "max": 112.69, "min": 119.46, "cnt": 2}, "backward-params-all-reduce":{"total": 487.74, "avg": 487.74, "max": 487.74, "min": 487.74, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 302.19, "avg": 302.19, "max": 302.19, "min": 302.19, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 257.99, "avg": 257.99, "max": 257.99, "min": 257.99, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.87, "avg": 6.87, "max": 6.87, "min": 6.87, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.51, "avg": 3.51, "max": 3.51, "min": 3.51, "cnt": 1}}}
{"type":"time", "iteration": 27, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 57.41, "avg": 19.14, "max": 0.88, "min": 55.18, "cnt": 3}, "forward-compute":{"total": 1920.36, "avg": 60.01, "max": 54.41, "min": 68.87, "cnt": 32}, "fwd-compute":{"total": 1917.12, "avg": 59.91, "max": 54.33, "min": 68.80, "cnt": 32}, "batch-generator":{"total": 51.28, "avg": 1.60, "max": 0.63, "min": 3.25, "cnt": 32}, "fwd-embedding":{"total": 0.61, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1853.23, "avg": 57.91, "max": 51.91, "min": 67.88, "cnt": 32}, "fwd-layernorm":{"total": 9.98, "avg": 0.08, "max": 0.05, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 107.14, "avg": 0.84, "max": 0.74, "min": 1.53, "cnt": 128}, "fwd-misc":{"total": 21.08, "avg": 0.16, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1693.87, "avg": 13.23, "max": 9.60, "min": 27.11, "cnt": 128}, "MoE_L0_fwd":{"total": 482.09, "avg": 15.07, "max": 10.36, "min": 27.04, "cnt": 32}, "MoEMLP":{"total": 1676.41, "avg": 13.10, "max": 9.49, "min": 27.00, "cnt": 128}, "MoE_L1_fwd":{"total": 403.61, "avg": 12.61, "max": 11.57, "min": 15.46, "cnt": 32}, "MoE_L2_fwd":{"total": 320.26, "avg": 10.01, "max": 9.53, "min": 10.82, "cnt": 32}, "MoE_L3_fwd":{"total": 476.82, "avg": 14.90, "max": 13.77, "min": 15.52, "cnt": 32}, "fwd-pooler":{"total": 0.36, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.05, "cnt": 32}, "forward-send":{"total": 4.37, "avg": 2.18, "max": 0.58, "min": 3.79, "cnt": 2}, "forward-send-backward-recv":{"total": 188.84, "avg": 6.29, "max": 1.12, "min": 129.53, "cnt": 30}, "backward-compute":{"total": 1862.70, "avg": 58.21, "max": 55.49, "min": 61.19, "cnt": 32}, "MoE_L3_bwd":{"total": 569.05, "avg": 17.78, "max": 15.88, "min": 20.21, "cnt": 32}, "MoE_L2_bwd":{"total": 331.45, "avg": 10.36, "max": 9.67, "min": 11.53, "cnt": 32}, "MoE_L1_bwd":{"total": 410.19, "avg": 12.82, "max": 12.07, "min": 13.13, "cnt": 32}, "MoE_L0_bwd":{"total": 342.32, "avg": 10.70, "max": 9.84, "min": 11.45, "cnt": 32}, "backward-send-forward-recv":{"total": 4238.55, "avg": 146.16, "max": 1.66, "min": 496.57, "cnt": 29}, "backward-send":{"total": 2.81, "avg": 0.94, "max": 0.46, "min": 1.20, "cnt": 3}, "backward-recv":{"total": 170.01, "avg": 85.00, "max": 65.95, "min": 104.06, "cnt": 2}, "backward-params-all-reduce":{"total": 487.50, "avg": 487.50, "max": 487.50, "min": 487.50, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 256.96, "avg": 256.96, "max": 256.96, "min": 256.96, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 211.15, "avg": 211.15, "max": 211.15, "min": 211.15, "cnt": 1}, "optimizer-clip-main-grad":{"total": 8.31, "avg": 8.31, "max": 8.31, "min": 8.31, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.49, "avg": 3.49, "max": 3.49, "min": 3.49, "cnt": 1}}}
{"type":"time", "iteration": 28, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 57.83, "avg": 19.28, "max": 0.66, "min": 56.22, "cnt": 3}, "forward-compute":{"total": 1918.21, "avg": 59.94, "max": 53.92, "min": 64.20, "cnt": 32}, "fwd-compute":{"total": 1915.14, "avg": 59.85, "max": 53.85, "min": 64.06, "cnt": 32}, "batch-generator":{"total": 56.32, "avg": 1.76, "max": 0.63, "min": 4.09, "cnt": 32}, "fwd-embedding":{"total": 0.63, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1846.78, "avg": 57.71, "max": 52.25, "min": 61.96, "cnt": 32}, "fwd-layernorm":{"total": 9.84, "avg": 0.08, "max": 0.05, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 106.95, "avg": 0.84, "max": 0.74, "min": 1.47, "cnt": 128}, "fwd-misc":{"total": 21.00, "avg": 0.16, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1688.11, "avg": 13.19, "max": 9.69, "min": 18.06, "cnt": 128}, "MoE_L0_fwd":{"total": 465.72, "avg": 14.55, "max": 10.63, "min": 17.95, "cnt": 32}, "MoEMLP":{"total": 1671.04, "avg": 13.05, "max": 9.58, "min": 17.89, "cnt": 128}, "MoE_L1_fwd":{"total": 405.54, "avg": 12.67, "max": 11.61, "min": 14.32, "cnt": 32}, "MoE_L2_fwd":{"total": 320.19, "avg": 10.01, "max": 9.62, "min": 11.14, "cnt": 32}, "MoE_L3_fwd":{"total": 485.88, "avg": 15.18, "max": 14.65, "min": 17.28, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 12.39, "avg": 6.20, "max": 0.48, "min": 11.92, "cnt": 2}, "forward-send-backward-recv":{"total": 184.87, "avg": 6.16, "max": 1.22, "min": 123.58, "cnt": 30}, "backward-compute":{"total": 1870.71, "avg": 58.46, "max": 55.90, "min": 59.84, "cnt": 32}, "MoE_L3_bwd":{"total": 570.65, "avg": 17.83, "max": 16.21, "min": 19.50, "cnt": 32}, "MoE_L2_bwd":{"total": 332.02, "avg": 10.38, "max": 9.80, "min": 10.62, "cnt": 32}, "MoE_L1_bwd":{"total": 413.57, "avg": 12.92, "max": 12.17, "min": 14.38, "cnt": 32}, "MoE_L0_bwd":{"total": 346.97, "avg": 10.84, "max": 10.44, "min": 11.35, "cnt": 32}, "backward-send-forward-recv":{"total": 5131.53, "avg": 176.95, "max": 1.91, "min": 750.59, "cnt": 29}, "backward-send":{"total": 2.72, "avg": 0.91, "max": 0.74, "min": 1.09, "cnt": 3}, "backward-recv":{"total": 129.04, "avg": 64.52, "max": 63.08, "min": 65.96, "cnt": 2}, "backward-params-all-reduce":{"total": 487.86, "avg": 487.86, "max": 487.86, "min": 487.86, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 253.95, "avg": 253.95, "max": 253.95, "min": 253.95, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.47, "avg": 3.47, "max": 3.47, "min": 3.47, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 209.77, "avg": 209.77, "max": 209.77, "min": 209.77, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.78, "avg": 6.78, "max": 6.78, "min": 6.78, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.48, "avg": 3.48, "max": 3.48, "min": 3.48, "cnt": 1}}}
{"type":"time", "iteration": 29, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 70.95, "avg": 23.65, "max": 1.07, "min": 68.59, "cnt": 3}, "forward-compute":{"total": 1900.36, "avg": 59.39, "max": 52.42, "min": 67.82, "cnt": 32}, "fwd-compute":{"total": 1897.38, "avg": 59.29, "max": 52.36, "min": 67.73, "cnt": 32}, "batch-generator":{"total": 39.28, "avg": 1.23, "max": 0.69, "min": 2.56, "cnt": 32}, "fwd-embedding":{"total": 0.59, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1845.77, "avg": 57.68, "max": 51.38, "min": 66.09, "cnt": 32}, "fwd-layernorm":{"total": 9.57, "avg": 0.07, "max": 0.05, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 108.70, "avg": 0.85, "max": 0.74, "min": 1.57, "cnt": 128}, "fwd-misc":{"total": 20.48, "avg": 0.16, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1686.08, "avg": 13.17, "max": 9.69, "min": 19.85, "cnt": 128}, "MoE_L0_fwd":{"total": 468.20, "avg": 14.63, "max": 11.04, "min": 19.68, "cnt": 32}, "MoEMLP":{"total": 1668.96, "avg": 13.04, "max": 9.58, "min": 19.59, "cnt": 128}, "MoE_L1_fwd":{"total": 409.02, "avg": 12.78, "max": 11.44, "min": 15.51, "cnt": 32}, "MoE_L2_fwd":{"total": 323.72, "avg": 10.12, "max": 9.62, "min": 12.75, "cnt": 32}, "MoE_L3_fwd":{"total": 474.16, "avg": 14.82, "max": 14.08, "min": 16.47, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.62, "avg": 0.02, "max": 0.02, "min": 0.05, "cnt": 32}, "forward-send":{"total": 4.89, "avg": 2.45, "max": 0.53, "min": 4.36, "cnt": 2}, "forward-send-backward-recv":{"total": 803.27, "avg": 26.78, "max": 1.24, "min": 129.00, "cnt": 30}, "backward-compute":{"total": 1845.48, "avg": 57.67, "max": 55.05, "min": 59.72, "cnt": 32}, "MoE_L3_bwd":{"total": 546.95, "avg": 17.09, "max": 15.81, "min": 18.91, "cnt": 32}, "MoE_L2_bwd":{"total": 332.35, "avg": 10.39, "max": 9.78, "min": 12.15, "cnt": 32}, "MoE_L1_bwd":{"total": 411.51, "avg": 12.86, "max": 12.16, "min": 13.82, "cnt": 32}, "MoE_L0_bwd":{"total": 345.56, "avg": 10.80, "max": 10.46, "min": 11.34, "cnt": 32}, "backward-send-forward-recv":{"total": 2959.52, "avg": 102.05, "max": 1.51, "min": 440.19, "cnt": 29}, "backward-send":{"total": 2.85, "avg": 0.95, "max": 0.92, "min": 1.00, "cnt": 3}, "backward-recv":{"total": 408.64, "avg": 204.32, "max": 102.50, "min": 306.14, "cnt": 2}, "backward-params-all-reduce":{"total": 486.05, "avg": 486.05, "max": 486.05, "min": 486.05, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 256.79, "avg": 256.79, "max": 256.79, "min": 256.79, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 212.60, "avg": 212.60, "max": 212.60, "min": 212.60, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.82, "avg": 6.82, "max": 6.82, "min": 6.82, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.48, "avg": 3.48, "max": 3.48, "min": 3.48, "cnt": 1}}}
{"type":"time", "iteration": 30, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 455.43, "avg": 151.81, "max": 0.74, "min": 453.69, "cnt": 3}, "forward-compute":{"total": 2036.54, "avg": 63.64, "max": 50.93, "min": 184.28, "cnt": 32}, "fwd-compute":{"total": 2033.25, "avg": 63.54, "max": 50.86, "min": 184.18, "cnt": 32}, "batch-generator":{"total": 47.92, "avg": 1.50, "max": 0.74, "min": 6.11, "cnt": 32}, "fwd-embedding":{"total": 0.66, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1972.81, "avg": 61.65, "max": 49.82, "min": 182.90, "cnt": 32}, "fwd-layernorm":{"total": 10.14, "avg": 0.08, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 110.15, "avg": 0.86, "max": 0.74, "min": 1.53, "cnt": 128}, "fwd-misc":{"total": 22.47, "avg": 0.18, "max": 0.11, "min": 0.62, "cnt": 128}, "fwd-MLP":{"total": 1808.66, "avg": 14.13, "max": 9.53, "min": 135.99, "cnt": 128}, "MoE_L0_fwd":{"total": 543.74, "avg": 16.99, "max": 11.26, "min": 56.02, "cnt": 32}, "MoEMLP":{"total": 1790.70, "avg": 13.99, "max": 9.41, "min": 135.88, "cnt": 128}, "MoE_L1_fwd":{"total": 408.53, "avg": 12.77, "max": 11.49, "min": 14.24, "cnt": 32}, "MoE_L2_fwd":{"total": 325.27, "avg": 10.16, "max": 9.46, "min": 13.06, "cnt": 32}, "MoE_L3_fwd":{"total": 519.58, "avg": 16.24, "max": 11.66, "min": 135.92, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.61, "avg": 0.02, "max": 0.02, "min": 0.04, "cnt": 32}, "forward-send":{"total": 5.15, "avg": 2.58, "max": 0.64, "min": 4.51, "cnt": 2}, "forward-send-backward-recv":{"total": 277.74, "avg": 9.26, "max": 1.21, "min": 134.64, "cnt": 30}, "backward-compute":{"total": 1678.58, "avg": 52.46, "max": 50.34, "min": 53.95, "cnt": 32}, "MoE_L3_bwd":{"total": 387.13, "avg": 12.10, "max": 10.63, "min": 13.92, "cnt": 32}, "MoE_L2_bwd":{"total": 329.56, "avg": 10.30, "max": 9.62, "min": 10.93, "cnt": 32}, "MoE_L1_bwd":{"total": 397.25, "avg": 12.41, "max": 11.72, "min": 13.19, "cnt": 32}, "MoE_L0_bwd":{"total": 351.69, "avg": 10.99, "max": 10.31, "min": 12.26, "cnt": 32}, "backward-send-forward-recv":{"total": 4464.55, "avg": 153.95, "max": 1.48, "min": 538.99, "cnt": 29}, "backward-send":{"total": 2.30, "avg": 0.77, "max": 0.67, "min": 0.95, "cnt": 3}, "backward-recv":{"total": 140.91, "avg": 70.46, "max": 67.58, "min": 73.34, "cnt": 2}, "backward-params-all-reduce":{"total": 491.39, "avg": 491.39, "max": 491.39, "min": 491.39, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 258.69, "avg": 258.69, "max": 258.69, "min": 258.69, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 214.20, "avg": 214.20, "max": 214.20, "min": 214.20, "cnt": 1}, "optimizer-clip-main-grad":{"total": 7.02, "avg": 7.02, "max": 7.02, "min": 7.02, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.48, "avg": 3.48, "max": 3.48, "min": 3.48, "cnt": 1}}}
{"type":"time", "iteration": 31, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.06, "avg": 0.06, "max": 0.06, "min": 0.06, "cnt": 1}, "forward-recv":{"total": 61.29, "avg": 20.43, "max": 0.91, "min": 59.43, "cnt": 3}, "forward-compute":{"total": 1806.29, "avg": 56.45, "max": 49.80, "min": 61.35, "cnt": 32}, "fwd-compute":{"total": 1802.97, "avg": 56.34, "max": 49.73, "min": 61.26, "cnt": 32}, "batch-generator":{"total": 43.73, "avg": 1.37, "max": 0.67, "min": 2.63, "cnt": 32}, "fwd-embedding":{"total": 0.66, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1746.43, "avg": 54.58, "max": 48.76, "min": 58.51, "cnt": 32}, "fwd-layernorm":{"total": 10.07, "avg": 0.08, "max": 0.05, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 109.91, "avg": 0.86, "max": 0.74, "min": 1.58, "cnt": 128}, "fwd-misc":{"total": 21.45, "avg": 0.17, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1583.86, "avg": 12.37, "max": 9.59, "min": 19.16, "cnt": 128}, "MoE_L0_fwd":{"total": 484.97, "avg": 15.16, "max": 11.65, "min": 19.07, "cnt": 32}, "MoEMLP":{"total": 1566.52, "avg": 12.24, "max": 9.48, "min": 19.03, "cnt": 128}, "MoE_L1_fwd":{"total": 394.83, "avg": 12.34, "max": 11.54, "min": 13.75, "cnt": 32}, "MoE_L2_fwd":{"total": 322.25, "avg": 10.07, "max": 9.52, "min": 11.01, "cnt": 32}, "MoE_L3_fwd":{"total": 370.83, "avg": 11.59, "max": 10.58, "min": 12.60, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 6.18, "avg": 3.09, "max": 0.56, "min": 5.61, "cnt": 2}, "forward-send-backward-recv":{"total": 822.06, "avg": 27.40, "max": 1.31, "min": 194.97, "cnt": 30}, "backward-compute":{"total": 1694.97, "avg": 52.97, "max": 49.83, "min": 54.85, "cnt": 32}, "MoE_L3_bwd":{"total": 369.27, "avg": 11.54, "max": 10.17, "min": 12.79, "cnt": 32}, "MoE_L2_bwd":{"total": 339.76, "avg": 10.62, "max": 9.76, "min": 11.35, "cnt": 32}, "MoE_L1_bwd":{"total": 407.53, "avg": 12.74, "max": 11.48, "min": 13.29, "cnt": 32}, "MoE_L0_bwd":{"total": 363.84, "avg": 11.37, "max": 10.74, "min": 12.65, "cnt": 32}, "backward-send-forward-recv":{"total": 3498.40, "avg": 120.63, "max": 1.73, "min": 334.40, "cnt": 29}, "backward-send":{"total": 2.07, "avg": 0.69, "max": 0.53, "min": 0.85, "cnt": 3}, "backward-recv":{"total": 402.18, "avg": 201.09, "max": 81.21, "min": 320.97, "cnt": 2}, "backward-params-all-reduce":{"total": 485.68, "avg": 485.68, "max": 485.68, "min": 485.68, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 255.82, "avg": 255.82, "max": 255.82, "min": 255.82, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 211.61, "avg": 211.61, "max": 211.61, "min": 211.61, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.93, "avg": 6.93, "max": 6.93, "min": 6.93, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.48, "avg": 3.48, "max": 3.48, "min": 3.48, "cnt": 1}}}
{"type":"time", "iteration": 32, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 57.93, "avg": 19.31, "max": 0.67, "min": 56.47, "cnt": 3}, "forward-compute":{"total": 1832.04, "avg": 57.25, "max": 48.81, "min": 65.85, "cnt": 32}, "fwd-compute":{"total": 1828.74, "avg": 57.15, "max": 48.74, "min": 65.72, "cnt": 32}, "batch-generator":{"total": 46.19, "avg": 1.44, "max": 0.68, "min": 2.09, "cnt": 32}, "fwd-embedding":{"total": 0.66, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1769.90, "avg": 55.31, "max": 47.78, "min": 63.51, "cnt": 32}, "fwd-layernorm":{"total": 10.32, "avg": 0.08, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 111.85, "avg": 0.87, "max": 0.74, "min": 1.56, "cnt": 128}, "fwd-misc":{"total": 22.19, "avg": 0.17, "max": 0.11, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1603.82, "avg": 12.53, "max": 9.58, "min": 21.70, "cnt": 128}, "MoE_L0_fwd":{"total": 493.86, "avg": 15.43, "max": 10.80, "min": 21.61, "cnt": 32}, "MoEMLP":{"total": 1586.24, "avg": 12.39, "max": 9.47, "min": 21.56, "cnt": 128}, "MoE_L1_fwd":{"total": 389.55, "avg": 12.17, "max": 11.02, "min": 15.44, "cnt": 32}, "MoE_L2_fwd":{"total": 337.80, "avg": 10.56, "max": 9.51, "min": 14.88, "cnt": 32}, "MoE_L3_fwd":{"total": 371.43, "avg": 11.61, "max": 10.71, "min": 13.46, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 5.56, "avg": 2.78, "max": 0.63, "min": 4.93, "cnt": 2}, "forward-send-backward-recv":{"total": 244.54, "avg": 8.15, "max": 1.10, "min": 132.35, "cnt": 30}, "backward-compute":{"total": 1712.03, "avg": 53.50, "max": 49.45, "min": 56.96, "cnt": 32}, "MoE_L3_bwd":{"total": 378.47, "avg": 11.83, "max": 10.75, "min": 13.18, "cnt": 32}, "MoE_L2_bwd":{"total": 353.98, "avg": 11.06, "max": 10.18, "min": 13.09, "cnt": 32}, "MoE_L1_bwd":{"total": 391.28, "avg": 12.23, "max": 10.73, "min": 13.05, "cnt": 32}, "MoE_L0_bwd":{"total": 366.03, "avg": 11.44, "max": 10.82, "min": 12.41, "cnt": 32}, "backward-send-forward-recv":{"total": 4440.28, "avg": 153.11, "max": 2.16, "min": 585.20, "cnt": 29}, "backward-send":{"total": 2.51, "avg": 0.84, "max": 0.68, "min": 0.97, "cnt": 3}, "backward-recv":{"total": 148.73, "avg": 74.36, "max": 71.00, "min": 77.73, "cnt": 2}, "backward-params-all-reduce":{"total": 487.06, "avg": 487.06, "max": 487.06, "min": 487.06, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 252.09, "avg": 252.09, "max": 252.09, "min": 252.09, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 207.99, "avg": 207.99, "max": 207.99, "min": 207.99, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.80, "avg": 6.80, "max": 6.80, "min": 6.80, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.48, "avg": 3.48, "max": 3.48, "min": 3.48, "cnt": 1}}}
{"type":"time", "iteration": 33, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 60.99, "avg": 20.33, "max": 0.79, "min": 59.37, "cnt": 3}, "forward-compute":{"total": 1873.22, "avg": 58.54, "max": 51.65, "min": 63.64, "cnt": 32}, "fwd-compute":{"total": 1870.03, "avg": 58.44, "max": 51.58, "min": 63.56, "cnt": 32}, "batch-generator":{"total": 44.95, "avg": 1.40, "max": 0.75, "min": 2.57, "cnt": 32}, "fwd-embedding":{"total": 0.66, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1812.51, "avg": 56.64, "max": 50.37, "min": 62.26, "cnt": 32}, "fwd-layernorm":{"total": 10.05, "avg": 0.08, "max": 0.05, "min": 0.18, "cnt": 128}, "fwd-attn":{"total": 109.02, "avg": 0.85, "max": 0.74, "min": 1.48, "cnt": 128}, "fwd-misc":{"total": 21.50, "avg": 0.17, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1650.46, "avg": 12.89, "max": 9.97, "min": 21.38, "cnt": 128}, "MoE_L0_fwd":{"total": 542.18, "avg": 16.94, "max": 12.61, "min": 21.22, "cnt": 32}, "MoEMLP":{"total": 1632.80, "avg": 12.76, "max": 9.87, "min": 21.12, "cnt": 128}, "MoE_L1_fwd":{"total": 393.38, "avg": 12.29, "max": 10.91, "min": 14.43, "cnt": 32}, "MoE_L2_fwd":{"total": 369.86, "avg": 11.56, "max": 9.90, "min": 13.46, "cnt": 32}, "MoE_L3_fwd":{"total": 333.70, "avg": 10.43, "max": 9.92, "min": 12.15, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.61, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.46, "avg": 0.73, "max": 0.67, "min": 0.79, "cnt": 2}, "forward-send-backward-recv":{"total": 203.80, "avg": 6.79, "max": 1.12, "min": 130.64, "cnt": 30}, "backward-compute":{"total": 1742.86, "avg": 54.46, "max": 51.38, "min": 55.89, "cnt": 32}, "MoE_L3_bwd":{"total": 392.93, "avg": 12.28, "max": 10.77, "min": 13.10, "cnt": 32}, "MoE_L2_bwd":{"total": 384.01, "avg": 12.00, "max": 10.64, "min": 12.80, "cnt": 32}, "MoE_L1_bwd":{"total": 357.84, "avg": 11.18, "max": 10.64, "min": 12.17, "cnt": 32}, "MoE_L0_bwd":{"total": 388.99, "avg": 12.16, "max": 11.47, "min": 13.17, "cnt": 32}, "backward-send-forward-recv":{"total": 4254.48, "avg": 146.71, "max": 1.89, "min": 588.17, "cnt": 29}, "backward-send":{"total": 2.97, "avg": 0.99, "max": 0.72, "min": 1.17, "cnt": 3}, "backward-recv":{"total": 134.90, "avg": 67.45, "max": 63.04, "min": 71.86, "cnt": 2}, "backward-params-all-reduce":{"total": 492.22, "avg": 492.22, "max": 492.22, "min": 492.22, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 257.32, "avg": 257.32, "max": 257.32, "min": 257.32, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 213.26, "avg": 213.26, "max": 213.26, "min": 213.26, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.78, "avg": 6.78, "max": 6.78, "min": 6.78, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.47, "avg": 3.47, "max": 3.47, "min": 3.47, "cnt": 1}}}
{"type":"time", "iteration": 34, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 62.98, "avg": 20.99, "max": 0.78, "min": 61.41, "cnt": 3}, "forward-compute":{"total": 1819.15, "avg": 56.85, "max": 51.36, "min": 65.72, "cnt": 32}, "fwd-compute":{"total": 1816.14, "avg": 56.75, "max": 51.29, "min": 65.59, "cnt": 32}, "batch-generator":{"total": 44.48, "avg": 1.39, "max": 0.69, "min": 4.23, "cnt": 32}, "fwd-embedding":{"total": 0.54, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1759.85, "avg": 55.00, "max": 49.17, "min": 63.52, "cnt": 32}, "fwd-layernorm":{"total": 9.37, "avg": 0.07, "max": 0.05, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 106.18, "avg": 0.83, "max": 0.74, "min": 1.54, "cnt": 128}, "fwd-misc":{"total": 19.99, "avg": 0.16, "max": 0.11, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1603.86, "avg": 12.53, "max": 10.07, "min": 21.17, "cnt": 128}, "MoE_L0_fwd":{"total": 488.87, "avg": 15.28, "max": 11.45, "min": 21.09, "cnt": 32}, "MoEMLP":{"total": 1587.25, "avg": 12.40, "max": 9.96, "min": 21.05, "cnt": 128}, "MoE_L1_fwd":{"total": 386.32, "avg": 12.07, "max": 10.87, "min": 14.88, "cnt": 32}, "MoE_L2_fwd":{"total": 377.16, "avg": 11.79, "max": 11.26, "min": 14.88, "cnt": 32}, "MoE_L3_fwd":{"total": 340.91, "avg": 10.65, "max": 10.00, "min": 14.75, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.61, "avg": 0.02, "max": 0.02, "min": 0.04, "cnt": 32}, "forward-send":{"total": 1.35, "avg": 0.68, "max": 0.67, "min": 0.68, "cnt": 2}, "forward-send-backward-recv":{"total": 431.02, "avg": 14.37, "max": 1.14, "min": 126.48, "cnt": 30}, "backward-compute":{"total": 1742.26, "avg": 54.45, "max": 50.28, "min": 56.21, "cnt": 32}, "MoE_L3_bwd":{"total": 398.52, "avg": 12.45, "max": 10.99, "min": 13.50, "cnt": 32}, "MoE_L2_bwd":{"total": 381.61, "avg": 11.93, "max": 10.75, "min": 12.37, "cnt": 32}, "MoE_L1_bwd":{"total": 358.31, "avg": 11.20, "max": 10.80, "min": 11.63, "cnt": 32}, "MoE_L0_bwd":{"total": 388.34, "avg": 12.14, "max": 11.29, "min": 13.18, "cnt": 32}, "backward-send-forward-recv":{"total": 3527.89, "avg": 121.65, "max": 2.34, "min": 344.64, "cnt": 29}, "backward-send":{"total": 2.27, "avg": 0.76, "max": 0.56, "min": 0.95, "cnt": 3}, "backward-recv":{"total": 140.93, "avg": 70.47, "max": 65.72, "min": 75.21, "cnt": 2}, "backward-params-all-reduce":{"total": 491.68, "avg": 491.68, "max": 491.68, "min": 491.68, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 251.85, "avg": 251.85, "max": 251.85, "min": 251.85, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 207.60, "avg": 207.60, "max": 207.60, "min": 207.60, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.89, "avg": 6.89, "max": 6.89, "min": 6.89, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 35, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.10, "avg": 0.10, "max": 0.10, "min": 0.10, "cnt": 1}, "forward-recv":{"total": 70.25, "avg": 23.42, "max": 3.78, "min": 55.29, "cnt": 3}, "forward-compute":{"total": 1796.25, "avg": 56.13, "max": 49.80, "min": 64.35, "cnt": 32}, "fwd-compute":{"total": 1793.31, "avg": 56.04, "max": 49.73, "min": 64.25, "cnt": 32}, "batch-generator":{"total": 41.13, "avg": 1.29, "max": 0.72, "min": 3.78, "cnt": 32}, "fwd-embedding":{"total": 0.49, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1740.06, "avg": 54.38, "max": 48.63, "min": 63.02, "cnt": 32}, "fwd-layernorm":{"total": 8.96, "avg": 0.07, "max": 0.05, "min": 0.18, "cnt": 128}, "fwd-attn":{"total": 104.79, "avg": 0.82, "max": 0.74, "min": 1.40, "cnt": 128}, "fwd-misc":{"total": 19.87, "avg": 0.16, "max": 0.11, "min": 0.34, "cnt": 128}, "fwd-MLP":{"total": 1586.28, "avg": 12.39, "max": 9.96, "min": 19.75, "cnt": 128}, "MoE_L0_fwd":{"total": 478.42, "avg": 14.95, "max": 11.60, "min": 19.68, "cnt": 32}, "MoEMLP":{"total": 1569.85, "avg": 12.26, "max": 9.85, "min": 19.63, "cnt": 128}, "MoE_L1_fwd":{"total": 391.73, "avg": 12.24, "max": 10.81, "min": 17.38, "cnt": 32}, "MoE_L2_fwd":{"total": 371.43, "avg": 11.61, "max": 11.07, "min": 12.42, "cnt": 32}, "MoE_L3_fwd":{"total": 334.20, "avg": 10.44, "max": 9.89, "min": 13.95, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.61, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.43, "avg": 0.71, "max": 0.69, "min": 0.74, "cnt": 2}, "forward-send-backward-recv":{"total": 297.68, "avg": 9.92, "max": 1.12, "min": 118.07, "cnt": 30}, "backward-compute":{"total": 1758.51, "avg": 54.95, "max": 50.84, "min": 60.65, "cnt": 32}, "MoE_L3_bwd":{"total": 409.56, "avg": 12.80, "max": 10.47, "min": 19.26, "cnt": 32}, "MoE_L2_bwd":{"total": 387.78, "avg": 12.12, "max": 11.25, "min": 12.74, "cnt": 32}, "MoE_L1_bwd":{"total": 361.94, "avg": 11.31, "max": 10.99, "min": 12.30, "cnt": 32}, "MoE_L0_bwd":{"total": 386.98, "avg": 12.09, "max": 11.47, "min": 12.98, "cnt": 32}, "backward-send-forward-recv":{"total": 4691.12, "avg": 161.76, "max": 2.35, "min": 580.63, "cnt": 29}, "backward-send":{"total": 2.03, "avg": 0.68, "max": 0.54, "min": 0.80, "cnt": 3}, "backward-recv":{"total": 148.65, "avg": 74.32, "max": 57.23, "min": 91.42, "cnt": 2}, "backward-params-all-reduce":{"total": 493.29, "avg": 493.29, "max": 493.29, "min": 493.29, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 252.88, "avg": 252.88, "max": 252.88, "min": 252.88, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 208.62, "avg": 208.62, "max": 208.62, "min": 208.62, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.83, "avg": 6.83, "max": 6.83, "min": 6.83, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.47, "avg": 3.47, "max": 3.47, "min": 3.47, "cnt": 1}}}
{"type":"time", "iteration": 36, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.11, "avg": 0.11, "max": 0.11, "min": 0.11, "cnt": 1}, "forward-recv":{"total": 68.70, "avg": 22.90, "max": 2.62, "min": 63.39, "cnt": 3}, "forward-compute":{"total": 1824.20, "avg": 57.01, "max": 50.02, "min": 61.84, "cnt": 32}, "fwd-compute":{"total": 1821.13, "avg": 56.91, "max": 49.95, "min": 61.77, "cnt": 32}, "batch-generator":{"total": 59.16, "avg": 1.85, "max": 0.70, "min": 4.99, "cnt": 32}, "fwd-embedding":{"total": 0.64, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1749.27, "avg": 54.66, "max": 48.91, "min": 58.33, "cnt": 32}, "fwd-layernorm":{"total": 10.11, "avg": 0.08, "max": 0.05, "min": 0.22, "cnt": 128}, "fwd-attn":{"total": 108.30, "avg": 0.85, "max": 0.74, "min": 2.00, "cnt": 128}, "fwd-misc":{"total": 21.41, "avg": 0.17, "max": 0.11, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1588.46, "avg": 12.41, "max": 9.89, "min": 17.80, "cnt": 128}, "MoE_L0_fwd":{"total": 478.24, "avg": 14.95, "max": 11.38, "min": 17.65, "cnt": 32}, "MoEMLP":{"total": 1571.34, "avg": 12.28, "max": 9.77, "min": 17.56, "cnt": 128}, "MoE_L1_fwd":{"total": 400.34, "avg": 12.51, "max": 11.16, "min": 15.53, "cnt": 32}, "MoE_L2_fwd":{"total": 364.40, "avg": 11.39, "max": 11.00, "min": 12.11, "cnt": 32}, "MoE_L3_fwd":{"total": 334.56, "avg": 10.45, "max": 9.81, "min": 11.65, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.61, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 4.34, "avg": 2.17, "max": 0.73, "min": 3.61, "cnt": 2}, "forward-send-backward-recv":{"total": 175.57, "avg": 5.85, "max": 1.15, "min": 116.36, "cnt": 30}, "backward-compute":{"total": 1751.61, "avg": 54.74, "max": 49.91, "min": 56.81, "cnt": 32}, "MoE_L3_bwd":{"total": 405.00, "avg": 12.66, "max": 10.78, "min": 15.03, "cnt": 32}, "MoE_L2_bwd":{"total": 385.92, "avg": 12.06, "max": 10.35, "min": 13.77, "cnt": 32}, "MoE_L1_bwd":{"total": 363.00, "avg": 11.34, "max": 10.12, "min": 13.06, "cnt": 32}, "MoE_L0_bwd":{"total": 378.17, "avg": 11.82, "max": 10.88, "min": 13.61, "cnt": 32}, "backward-send-forward-recv":{"total": 4353.22, "avg": 150.11, "max": 2.25, "min": 649.34, "cnt": 29}, "backward-send":{"total": 3.04, "avg": 1.01, "max": 0.89, "min": 1.10, "cnt": 3}, "backward-recv":{"total": 133.42, "avg": 66.71, "max": 56.70, "min": 76.72, "cnt": 2}, "backward-params-all-reduce":{"total": 485.22, "avg": 485.22, "max": 485.22, "min": 485.22, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 266.45, "avg": 266.45, "max": 266.45, "min": 266.45, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 222.09, "avg": 222.09, "max": 222.09, "min": 222.09, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.74, "avg": 6.74, "max": 6.74, "min": 6.74, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.51, "avg": 3.51, "max": 3.51, "min": 3.51, "cnt": 1}}}
{"type":"time", "iteration": 37, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 62.56, "avg": 20.85, "max": 1.23, "min": 58.37, "cnt": 3}, "forward-compute":{"total": 1806.10, "avg": 56.44, "max": 50.26, "min": 60.65, "cnt": 32}, "fwd-compute":{"total": 1802.86, "avg": 56.34, "max": 50.19, "min": 60.57, "cnt": 32}, "batch-generator":{"total": 51.71, "avg": 1.62, "max": 0.65, "min": 3.13, "cnt": 32}, "fwd-embedding":{"total": 0.62, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1738.59, "avg": 54.33, "max": 49.23, "min": 57.64, "cnt": 32}, "fwd-layernorm":{"total": 9.73, "avg": 0.08, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 106.84, "avg": 0.83, "max": 0.74, "min": 1.45, "cnt": 128}, "fwd-misc":{"total": 20.52, "avg": 0.16, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1581.12, "avg": 12.35, "max": 9.97, "min": 18.38, "cnt": 128}, "MoE_L0_fwd":{"total": 478.14, "avg": 14.94, "max": 11.69, "min": 18.30, "cnt": 32}, "MoEMLP":{"total": 1564.66, "avg": 12.22, "max": 9.85, "min": 18.26, "cnt": 128}, "MoE_L1_fwd":{"total": 398.85, "avg": 12.46, "max": 11.55, "min": 14.00, "cnt": 32}, "MoE_L2_fwd":{"total": 361.96, "avg": 11.31, "max": 10.19, "min": 13.63, "cnt": 32}, "MoE_L3_fwd":{"total": 331.69, "avg": 10.37, "max": 9.89, "min": 11.70, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.50, "avg": 0.75, "max": 0.66, "min": 0.84, "cnt": 2}, "forward-send-backward-recv":{"total": 181.38, "avg": 6.05, "max": 1.16, "min": 119.54, "cnt": 30}, "backward-compute":{"total": 1771.58, "avg": 55.36, "max": 50.82, "min": 60.47, "cnt": 32}, "MoE_L3_bwd":{"total": 406.52, "avg": 12.70, "max": 10.45, "min": 14.51, "cnt": 32}, "MoE_L2_bwd":{"total": 391.05, "avg": 12.22, "max": 11.34, "min": 14.37, "cnt": 32}, "MoE_L1_bwd":{"total": 380.58, "avg": 11.89, "max": 11.35, "min": 12.75, "cnt": 32}, "MoE_L0_bwd":{"total": 379.47, "avg": 11.86, "max": 11.18, "min": 13.92, "cnt": 32}, "backward-send-forward-recv":{"total": 4292.93, "avg": 148.03, "max": 2.48, "min": 845.45, "cnt": 29}, "backward-send":{"total": 3.21, "avg": 1.07, "max": 0.55, "min": 1.67, "cnt": 3}, "backward-recv":{"total": 138.56, "avg": 69.28, "max": 65.27, "min": 73.29, "cnt": 2}, "backward-params-all-reduce":{"total": 484.45, "avg": 484.45, "max": 484.45, "min": 484.45, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 263.19, "avg": 263.19, "max": 263.19, "min": 263.19, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 218.95, "avg": 218.95, "max": 218.95, "min": 218.95, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.80, "avg": 6.80, "max": 6.80, "min": 6.80, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.50, "avg": 3.50, "max": 3.50, "min": 3.50, "cnt": 1}}}
{"type":"time", "iteration": 38, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 74.49, "avg": 24.83, "max": 0.82, "min": 72.74, "cnt": 3}, "forward-compute":{"total": 1762.17, "avg": 55.07, "max": 49.85, "min": 61.02, "cnt": 32}, "fwd-compute":{"total": 1759.35, "avg": 54.98, "max": 49.77, "min": 60.89, "cnt": 32}, "batch-generator":{"total": 41.07, "avg": 1.28, "max": 0.76, "min": 2.65, "cnt": 32}, "fwd-embedding":{"total": 0.44, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1707.05, "avg": 53.35, "max": 48.61, "min": 58.90, "cnt": 32}, "fwd-layernorm":{"total": 8.95, "avg": 0.07, "max": 0.05, "min": 0.18, "cnt": 128}, "fwd-attn":{"total": 104.23, "avg": 0.81, "max": 0.74, "min": 1.73, "cnt": 128}, "fwd-misc":{"total": 19.67, "avg": 0.15, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1554.68, "avg": 12.15, "max": 9.90, "min": 19.75, "cnt": 128}, "MoE_L0_fwd":{"total": 458.87, "avg": 14.34, "max": 11.57, "min": 19.67, "cnt": 32}, "MoEMLP":{"total": 1538.41, "avg": 12.02, "max": 9.80, "min": 19.63, "cnt": 128}, "MoE_L1_fwd":{"total": 385.63, "avg": 12.05, "max": 10.87, "min": 14.55, "cnt": 32}, "MoE_L2_fwd":{"total": 367.26, "avg": 11.48, "max": 10.94, "min": 12.69, "cnt": 32}, "MoE_L3_fwd":{"total": 332.55, "avg": 10.39, "max": 9.84, "min": 11.82, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 4.85, "avg": 2.42, "max": 0.59, "min": 4.26, "cnt": 2}, "forward-send-backward-recv":{"total": 246.73, "avg": 8.22, "max": 1.18, "min": 118.10, "cnt": 30}, "backward-compute":{"total": 1755.08, "avg": 54.85, "max": 52.62, "min": 57.26, "cnt": 32}, "MoE_L3_bwd":{"total": 412.46, "avg": 12.89, "max": 10.58, "min": 15.07, "cnt": 32}, "MoE_L2_bwd":{"total": 383.79, "avg": 11.99, "max": 11.04, "min": 12.63, "cnt": 32}, "MoE_L1_bwd":{"total": 361.67, "avg": 11.30, "max": 10.52, "min": 12.77, "cnt": 32}, "MoE_L0_bwd":{"total": 383.28, "avg": 11.98, "max": 11.48, "min": 14.77, "cnt": 32}, "backward-send-forward-recv":{"total": 3710.14, "avg": 127.94, "max": 2.30, "min": 319.94, "cnt": 29}, "backward-send":{"total": 3.56, "avg": 1.19, "max": 1.15, "min": 1.22, "cnt": 3}, "backward-recv":{"total": 122.86, "avg": 61.43, "max": 56.40, "min": 66.47, "cnt": 2}, "backward-params-all-reduce":{"total": 489.08, "avg": 489.08, "max": 489.08, "min": 489.08, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 328.11, "avg": 328.11, "max": 328.11, "min": 328.11, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 283.91, "avg": 283.91, "max": 283.91, "min": 283.91, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.76, "avg": 6.76, "max": 6.76, "min": 6.76, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.51, "avg": 3.51, "max": 3.51, "min": 3.51, "cnt": 1}}}
{"type":"time", "iteration": 39, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.11, "avg": 0.11, "max": 0.11, "min": 0.11, "cnt": 1}, "forward-recv":{"total": 68.93, "avg": 22.98, "max": 1.07, "min": 62.73, "cnt": 3}, "forward-compute":{"total": 1818.07, "avg": 56.81, "max": 50.63, "min": 67.61, "cnt": 32}, "fwd-compute":{"total": 1814.93, "avg": 56.72, "max": 50.55, "min": 67.51, "cnt": 32}, "batch-generator":{"total": 37.65, "avg": 1.18, "max": 0.67, "min": 3.27, "cnt": 32}, "fwd-embedding":{"total": 0.54, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1765.28, "avg": 55.16, "max": 49.41, "min": 65.84, "cnt": 32}, "fwd-layernorm":{"total": 9.42, "avg": 0.07, "max": 0.06, "min": 0.24, "cnt": 128}, "fwd-attn":{"total": 106.23, "avg": 0.83, "max": 0.74, "min": 1.97, "cnt": 128}, "fwd-misc":{"total": 20.82, "avg": 0.16, "max": 0.11, "min": 0.43, "cnt": 128}, "fwd-MLP":{"total": 1608.24, "avg": 12.56, "max": 9.91, "min": 21.55, "cnt": 128}, "MoE_L0_fwd":{"total": 504.64, "avg": 15.77, "max": 12.18, "min": 21.45, "cnt": 32}, "MoEMLP":{"total": 1591.26, "avg": 12.43, "max": 9.81, "min": 21.40, "cnt": 128}, "MoE_L1_fwd":{"total": 384.89, "avg": 12.03, "max": 11.03, "min": 15.79, "cnt": 32}, "MoE_L2_fwd":{"total": 370.26, "avg": 11.57, "max": 10.95, "min": 14.36, "cnt": 32}, "MoE_L3_fwd":{"total": 337.45, "avg": 10.55, "max": 9.85, "min": 13.12, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 6.73, "avg": 3.37, "max": 0.82, "min": 5.91, "cnt": 2}, "forward-send-backward-recv":{"total": 176.16, "avg": 5.87, "max": 1.09, "min": 121.00, "cnt": 30}, "backward-compute":{"total": 1756.25, "avg": 54.88, "max": 50.36, "min": 59.06, "cnt": 32}, "MoE_L3_bwd":{"total": 413.51, "avg": 12.92, "max": 11.26, "min": 15.22, "cnt": 32}, "MoE_L2_bwd":{"total": 386.58, "avg": 12.08, "max": 10.94, "min": 12.86, "cnt": 32}, "MoE_L1_bwd":{"total": 353.75, "avg": 11.05, "max": 10.29, "min": 11.99, "cnt": 32}, "MoE_L0_bwd":{"total": 387.40, "avg": 12.11, "max": 11.46, "min": 14.23, "cnt": 32}, "backward-send-forward-recv":{"total": 5175.57, "avg": 178.47, "max": 2.29, "min": 1081.97, "cnt": 29}, "backward-send":{"total": 3.06, "avg": 1.02, "max": 0.96, "min": 1.13, "cnt": 3}, "backward-recv":{"total": 127.71, "avg": 63.85, "max": 59.95, "min": 67.76, "cnt": 2}, "backward-params-all-reduce":{"total": 490.43, "avg": 490.43, "max": 490.43, "min": 490.43, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 258.33, "avg": 258.33, "max": 258.33, "min": 258.33, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 213.69, "avg": 213.69, "max": 213.69, "min": 213.69, "cnt": 1}, "optimizer-clip-main-grad":{"total": 7.26, "avg": 7.26, "max": 7.26, "min": 7.26, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.47, "avg": 3.47, "max": 3.47, "min": 3.47, "cnt": 1}}}
{"type":"time", "iteration": 40, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 375.71, "avg": 125.24, "max": 0.78, "min": 374.14, "cnt": 3}, "forward-compute":{"total": 1907.51, "avg": 59.61, "max": 51.63, "min": 94.78, "cnt": 32}, "fwd-compute":{"total": 1904.49, "avg": 59.52, "max": 51.55, "min": 94.71, "cnt": 32}, "batch-generator":{"total": 44.66, "avg": 1.40, "max": 0.74, "min": 3.76, "cnt": 32}, "fwd-embedding":{"total": 0.60, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1847.39, "avg": 57.73, "max": 50.15, "min": 93.54, "cnt": 32}, "fwd-layernorm":{"total": 9.66, "avg": 0.08, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 106.03, "avg": 0.83, "max": 0.74, "min": 1.46, "cnt": 128}, "fwd-misc":{"total": 20.83, "avg": 0.16, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1690.48, "avg": 13.21, "max": 9.94, "min": 54.95, "cnt": 128}, "MoE_L0_fwd":{"total": 570.41, "avg": 17.83, "max": 12.43, "min": 54.87, "cnt": 32}, "MoEMLP":{"total": 1673.77, "avg": 13.08, "max": 9.83, "min": 54.82, "cnt": 128}, "MoE_L1_fwd":{"total": 397.20, "avg": 12.41, "max": 11.19, "min": 15.36, "cnt": 32}, "MoE_L2_fwd":{"total": 380.81, "avg": 11.90, "max": 11.41, "min": 13.29, "cnt": 32}, "MoE_L3_fwd":{"total": 331.57, "avg": 10.36, "max": 9.87, "min": 11.09, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 11.87, "avg": 5.94, "max": 0.75, "min": 11.13, "cnt": 2}, "forward-send-backward-recv":{"total": 214.82, "avg": 7.16, "max": 1.11, "min": 148.96, "cnt": 30}, "backward-compute":{"total": 1769.12, "avg": 55.29, "max": 51.28, "min": 57.81, "cnt": 32}, "MoE_L3_bwd":{"total": 404.50, "avg": 12.64, "max": 11.01, "min": 13.59, "cnt": 32}, "MoE_L2_bwd":{"total": 416.21, "avg": 13.01, "max": 11.95, "min": 14.09, "cnt": 32}, "MoE_L1_bwd":{"total": 352.41, "avg": 11.01, "max": 10.33, "min": 11.59, "cnt": 32}, "MoE_L0_bwd":{"total": 382.72, "avg": 11.96, "max": 11.19, "min": 14.67, "cnt": 32}, "backward-send-forward-recv":{"total": 6152.04, "avg": 212.14, "max": 1.47, "min": 685.44, "cnt": 29}, "backward-send":{"total": 2.92, "avg": 0.97, "max": 0.90, "min": 1.08, "cnt": 3}, "backward-recv":{"total": 140.45, "avg": 70.23, "max": 64.03, "min": 76.42, "cnt": 2}, "backward-params-all-reduce":{"total": 485.23, "avg": 485.23, "max": 485.23, "min": 485.23, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 258.04, "avg": 258.04, "max": 258.04, "min": 258.04, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 213.86, "avg": 213.86, "max": 213.86, "min": 213.86, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.73, "avg": 6.73, "max": 6.73, "min": 6.73, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.51, "avg": 3.51, "max": 3.51, "min": 3.51, "cnt": 1}}}
{"type":"time", "iteration": 41, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.06, "avg": 0.06, "max": 0.06, "min": 0.06, "cnt": 1}, "forward-recv":{"total": 64.61, "avg": 21.54, "max": 0.78, "min": 63.00, "cnt": 3}, "forward-compute":{"total": 1921.43, "avg": 60.04, "max": 52.95, "min": 67.07, "cnt": 32}, "fwd-compute":{"total": 1917.99, "avg": 59.94, "max": 52.89, "min": 66.99, "cnt": 32}, "batch-generator":{"total": 48.28, "avg": 1.51, "max": 0.66, "min": 2.75, "cnt": 32}, "fwd-embedding":{"total": 0.70, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1856.97, "avg": 58.03, "max": 51.94, "min": 64.51, "cnt": 32}, "fwd-layernorm":{"total": 10.43, "avg": 0.08, "max": 0.05, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 111.47, "avg": 0.87, "max": 0.74, "min": 1.50, "cnt": 128}, "fwd-misc":{"total": 22.18, "avg": 0.17, "max": 0.11, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1691.21, "avg": 13.21, "max": 9.96, "min": 23.25, "cnt": 128}, "MoE_L0_fwd":{"total": 523.57, "avg": 16.36, "max": 13.15, "min": 23.17, "cnt": 32}, "MoEMLP":{"total": 1673.69, "avg": 13.08, "max": 9.86, "min": 23.12, "cnt": 128}, "MoE_L1_fwd":{"total": 421.00, "avg": 13.16, "max": 11.94, "min": 18.84, "cnt": 32}, "MoE_L2_fwd":{"total": 393.28, "avg": 12.29, "max": 11.73, "min": 14.64, "cnt": 32}, "MoE_L3_fwd":{"total": 342.27, "avg": 10.70, "max": 9.89, "min": 12.87, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.62, "avg": 0.02, "max": 0.02, "min": 0.04, "cnt": 32}, "forward-send":{"total": 1.14, "avg": 0.57, "max": 0.54, "min": 0.60, "cnt": 2}, "forward-send-backward-recv":{"total": 235.08, "avg": 7.84, "max": 1.20, "min": 113.63, "cnt": 30}, "backward-compute":{"total": 1837.39, "avg": 57.42, "max": 52.97, "min": 59.63, "cnt": 32}, "MoE_L3_bwd":{"total": 405.14, "avg": 12.66, "max": 10.85, "min": 14.62, "cnt": 32}, "MoE_L2_bwd":{"total": 435.01, "avg": 13.59, "max": 11.57, "min": 14.53, "cnt": 32}, "MoE_L1_bwd":{"total": 399.17, "avg": 12.47, "max": 11.51, "min": 13.81, "cnt": 32}, "MoE_L0_bwd":{"total": 382.67, "avg": 11.96, "max": 11.44, "min": 13.42, "cnt": 32}, "backward-send-forward-recv":{"total": 4106.73, "avg": 141.61, "max": 1.91, "min": 498.24, "cnt": 29}, "backward-send":{"total": 3.10, "avg": 1.03, "max": 0.80, "min": 1.21, "cnt": 3}, "backward-recv":{"total": 137.79, "avg": 68.90, "max": 67.37, "min": 70.43, "cnt": 2}, "backward-params-all-reduce":{"total": 487.78, "avg": 487.78, "max": 487.78, "min": 487.78, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 251.65, "avg": 251.65, "max": 251.65, "min": 251.65, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 207.36, "avg": 207.36, "max": 207.36, "min": 207.36, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.90, "avg": 6.90, "max": 6.90, "min": 6.90, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.49, "avg": 3.49, "max": 3.49, "min": 3.49, "cnt": 1}}}
{"type":"time", "iteration": 42, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 57.85, "avg": 19.28, "max": 0.79, "min": 56.25, "cnt": 3}, "forward-compute":{"total": 1930.79, "avg": 60.34, "max": 54.00, "min": 66.78, "cnt": 32}, "fwd-compute":{"total": 1927.61, "avg": 60.24, "max": 53.93, "min": 66.70, "cnt": 32}, "batch-generator":{"total": 45.94, "avg": 1.44, "max": 0.67, "min": 2.76, "cnt": 32}, "fwd-embedding":{"total": 0.61, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1869.57, "avg": 58.42, "max": 52.26, "min": 64.49, "cnt": 32}, "fwd-layernorm":{"total": 9.89, "avg": 0.08, "max": 0.05, "min": 0.24, "cnt": 128}, "fwd-attn":{"total": 108.68, "avg": 0.85, "max": 0.74, "min": 1.88, "cnt": 128}, "fwd-misc":{"total": 21.24, "avg": 0.17, "max": 0.11, "min": 0.39, "cnt": 128}, "fwd-MLP":{"total": 1708.95, "avg": 13.35, "max": 9.93, "min": 20.08, "cnt": 128}, "MoE_L0_fwd":{"total": 511.79, "avg": 15.99, "max": 11.84, "min": 20.00, "cnt": 32}, "MoEMLP":{"total": 1691.87, "avg": 13.22, "max": 9.83, "min": 19.95, "cnt": 128}, "MoE_L1_fwd":{"total": 474.94, "avg": 14.84, "max": 13.50, "min": 18.21, "cnt": 32}, "MoE_L2_fwd":{"total": 374.09, "avg": 11.69, "max": 10.75, "min": 17.48, "cnt": 32}, "MoE_L3_fwd":{"total": 337.31, "avg": 10.54, "max": 9.87, "min": 12.37, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.53, "avg": 0.76, "max": 0.76, "min": 0.77, "cnt": 2}, "forward-send-backward-recv":{"total": 232.71, "avg": 7.76, "max": 1.04, "min": 114.04, "cnt": 30}, "backward-compute":{"total": 1869.80, "avg": 58.43, "max": 54.16, "min": 60.67, "cnt": 32}, "MoE_L3_bwd":{"total": 403.79, "avg": 12.62, "max": 10.68, "min": 14.45, "cnt": 32}, "MoE_L2_bwd":{"total": 402.59, "avg": 12.58, "max": 11.74, "min": 13.55, "cnt": 32}, "MoE_L1_bwd":{"total": 475.14, "avg": 14.85, "max": 13.64, "min": 15.43, "cnt": 32}, "MoE_L0_bwd":{"total": 375.55, "avg": 11.74, "max": 11.12, "min": 12.18, "cnt": 32}, "backward-send-forward-recv":{"total": 4776.21, "avg": 164.70, "max": 2.08, "min": 833.94, "cnt": 29}, "backward-send":{"total": 3.39, "avg": 1.13, "max": 1.00, "min": 1.28, "cnt": 3}, "backward-recv":{"total": 124.22, "avg": 62.11, "max": 58.51, "min": 65.71, "cnt": 2}, "backward-params-all-reduce":{"total": 486.67, "avg": 486.67, "max": 486.67, "min": 486.67, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 253.16, "avg": 253.16, "max": 253.16, "min": 253.16, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 208.40, "avg": 208.40, "max": 208.40, "min": 208.40, "cnt": 1}, "optimizer-clip-main-grad":{"total": 7.29, "avg": 7.29, "max": 7.29, "min": 7.29, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.49, "avg": 3.49, "max": 3.49, "min": 3.49, "cnt": 1}}}
{"type":"time", "iteration": 43, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 55.86, "avg": 18.62, "max": 0.69, "min": 54.28, "cnt": 3}, "forward-compute":{"total": 1882.38, "avg": 58.82, "max": 52.23, "min": 74.97, "cnt": 32}, "fwd-compute":{"total": 1879.66, "avg": 58.74, "max": 52.16, "min": 74.89, "cnt": 32}, "batch-generator":{"total": 51.78, "avg": 1.62, "max": 0.62, "min": 3.73, "cnt": 32}, "fwd-embedding":{"total": 0.53, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1816.26, "avg": 56.76, "max": 51.25, "min": 70.54, "cnt": 32}, "fwd-layernorm":{"total": 9.01, "avg": 0.07, "max": 0.05, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 101.79, "avg": 0.80, "max": 0.74, "min": 1.66, "cnt": 128}, "fwd-misc":{"total": 19.53, "avg": 0.15, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1666.40, "avg": 13.02, "max": 9.95, "min": 20.99, "cnt": 128}, "MoE_L0_fwd":{"total": 468.87, "avg": 14.65, "max": 11.65, "min": 20.89, "cnt": 32}, "MoEMLP":{"total": 1650.42, "avg": 12.89, "max": 9.84, "min": 20.84, "cnt": 128}, "MoE_L1_fwd":{"total": 493.33, "avg": 15.42, "max": 14.25, "min": 17.38, "cnt": 32}, "MoE_L2_fwd":{"total": 357.68, "avg": 11.18, "max": 10.49, "min": 16.46, "cnt": 32}, "MoE_L3_fwd":{"total": 336.39, "avg": 10.51, "max": 9.88, "min": 12.37, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 3.87, "avg": 1.94, "max": 0.52, "min": 3.36, "cnt": 2}, "forward-send-backward-recv":{"total": 204.46, "avg": 6.82, "max": 1.15, "min": 126.97, "cnt": 30}, "backward-compute":{"total": 1901.72, "avg": 59.43, "max": 55.53, "min": 61.78, "cnt": 32}, "MoE_L3_bwd":{"total": 408.80, "avg": 12.78, "max": 11.06, "min": 14.89, "cnt": 32}, "MoE_L2_bwd":{"total": 379.99, "avg": 11.87, "max": 10.80, "min": 12.60, "cnt": 32}, "MoE_L1_bwd":{"total": 527.81, "avg": 16.49, "max": 16.02, "min": 17.26, "cnt": 32}, "MoE_L0_bwd":{"total": 372.95, "avg": 11.65, "max": 11.27, "min": 11.95, "cnt": 32}, "backward-send-forward-recv":{"total": 4072.46, "avg": 140.43, "max": 2.29, "min": 457.16, "cnt": 29}, "backward-send":{"total": 2.46, "avg": 0.82, "max": 0.51, "min": 0.99, "cnt": 3}, "backward-recv":{"total": 115.79, "avg": 57.89, "max": 54.56, "min": 61.23, "cnt": 2}, "backward-params-all-reduce":{"total": 485.02, "avg": 485.02, "max": 485.02, "min": 485.02, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 260.50, "avg": 260.50, "max": 260.50, "min": 260.50, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 216.31, "avg": 216.31, "max": 216.31, "min": 216.31, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.78, "avg": 6.78, "max": 6.78, "min": 6.78, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.52, "avg": 3.52, "max": 3.52, "min": 3.52, "cnt": 1}}}
{"type":"time", "iteration": 44, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 64.22, "avg": 21.41, "max": 0.83, "min": 60.54, "cnt": 3}, "forward-compute":{"total": 1937.55, "avg": 60.55, "max": 54.13, "min": 68.58, "cnt": 32}, "fwd-compute":{"total": 1934.63, "avg": 60.46, "max": 54.06, "min": 68.49, "cnt": 32}, "batch-generator":{"total": 44.27, "avg": 1.38, "max": 0.71, "min": 2.68, "cnt": 32}, "fwd-embedding":{"total": 0.56, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1878.31, "avg": 58.70, "max": 53.02, "min": 67.19, "cnt": 32}, "fwd-layernorm":{"total": 9.47, "avg": 0.07, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 107.96, "avg": 0.84, "max": 0.74, "min": 2.04, "cnt": 128}, "fwd-misc":{"total": 20.78, "avg": 0.16, "max": 0.11, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1719.70, "avg": 13.44, "max": 10.21, "min": 18.70, "cnt": 128}, "MoE_L0_fwd":{"total": 476.33, "avg": 14.89, "max": 11.71, "min": 18.53, "cnt": 32}, "MoEMLP":{"total": 1702.94, "avg": 13.30, "max": 10.10, "min": 18.43, "cnt": 128}, "MoE_L1_fwd":{"total": 497.42, "avg": 15.54, "max": 14.33, "min": 17.35, "cnt": 32}, "MoE_L2_fwd":{"total": 394.14, "avg": 12.32, "max": 11.53, "min": 15.56, "cnt": 32}, "MoE_L3_fwd":{"total": 341.19, "avg": 10.66, "max": 10.15, "min": 12.60, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.25, "avg": 0.63, "max": 0.57, "min": 0.68, "cnt": 2}, "forward-send-backward-recv":{"total": 152.13, "avg": 5.07, "max": 1.08, "min": 114.51, "cnt": 30}, "backward-compute":{"total": 1976.37, "avg": 61.76, "max": 58.11, "min": 64.23, "cnt": 32}, "MoE_L3_bwd":{"total": 404.99, "avg": 12.66, "max": 11.12, "min": 14.27, "cnt": 32}, "MoE_L2_bwd":{"total": 431.69, "avg": 13.49, "max": 12.67, "min": 14.82, "cnt": 32}, "MoE_L1_bwd":{"total": 550.60, "avg": 17.21, "max": 16.67, "min": 18.30, "cnt": 32}, "MoE_L0_bwd":{"total": 378.85, "avg": 11.84, "max": 11.03, "min": 12.58, "cnt": 32}, "backward-send-forward-recv":{"total": 4406.85, "avg": 151.96, "max": 1.86, "min": 861.82, "cnt": 29}, "backward-send":{"total": 2.59, "avg": 0.86, "max": 0.57, "min": 1.07, "cnt": 3}, "backward-recv":{"total": 322.01, "avg": 161.01, "max": 59.89, "min": 262.12, "cnt": 2}, "backward-params-all-reduce":{"total": 488.89, "avg": 488.89, "max": 488.89, "min": 488.89, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 253.09, "avg": 253.09, "max": 253.09, "min": 253.09, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 208.99, "avg": 208.99, "max": 208.99, "min": 208.99, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.72, "avg": 6.72, "max": 6.72, "min": 6.72, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.52, "avg": 3.52, "max": 3.52, "min": 3.52, "cnt": 1}}}
{"type":"time", "iteration": 45, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 64.44, "avg": 21.48, "max": 0.80, "min": 62.66, "cnt": 3}, "forward-compute":{"total": 2004.80, "avg": 62.65, "max": 55.86, "min": 70.16, "cnt": 32}, "fwd-compute":{"total": 2001.74, "avg": 62.55, "max": 55.77, "min": 70.08, "cnt": 32}, "batch-generator":{"total": 46.27, "avg": 1.45, "max": 0.63, "min": 3.56, "cnt": 32}, "fwd-embedding":{"total": 0.62, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1943.41, "avg": 60.73, "max": 54.55, "min": 67.08, "cnt": 32}, "fwd-layernorm":{"total": 10.08, "avg": 0.08, "max": 0.05, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 109.87, "avg": 0.86, "max": 0.74, "min": 2.05, "cnt": 128}, "fwd-misc":{"total": 21.09, "avg": 0.16, "max": 0.11, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1781.73, "avg": 13.92, "max": 10.02, "min": 20.31, "cnt": 128}, "MoE_L0_fwd":{"total": 530.74, "avg": 16.59, "max": 12.85, "min": 20.23, "cnt": 32}, "MoEMLP":{"total": 1764.75, "avg": 13.79, "max": 9.90, "min": 20.18, "cnt": 128}, "MoE_L1_fwd":{"total": 472.26, "avg": 14.76, "max": 13.51, "min": 16.35, "cnt": 32}, "MoE_L2_fwd":{"total": 397.07, "avg": 12.41, "max": 11.33, "min": 15.05, "cnt": 32}, "MoE_L3_fwd":{"total": 370.87, "avg": 11.59, "max": 9.94, "min": 13.10, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.23, "avg": 0.62, "max": 0.61, "min": 0.62, "cnt": 2}, "forward-send-backward-recv":{"total": 258.57, "avg": 8.62, "max": 1.09, "min": 111.12, "cnt": 30}, "backward-compute":{"total": 1907.99, "avg": 59.62, "max": 56.24, "min": 65.06, "cnt": 32}, "MoE_L3_bwd":{"total": 414.06, "avg": 12.94, "max": 10.82, "min": 15.06, "cnt": 32}, "MoE_L2_bwd":{"total": 407.51, "avg": 12.73, "max": 11.52, "min": 14.26, "cnt": 32}, "MoE_L1_bwd":{"total": 486.13, "avg": 15.19, "max": 13.21, "min": 16.92, "cnt": 32}, "MoE_L0_bwd":{"total": 388.12, "avg": 12.13, "max": 11.22, "min": 13.40, "cnt": 32}, "backward-send-forward-recv":{"total": 4837.13, "avg": 166.80, "max": 2.02, "min": 640.99, "cnt": 29}, "backward-send":{"total": 2.48, "avg": 0.83, "max": 0.56, "min": 1.09, "cnt": 3}, "backward-recv":{"total": 138.20, "avg": 69.10, "max": 59.76, "min": 78.44, "cnt": 2}, "backward-params-all-reduce":{"total": 488.60, "avg": 488.60, "max": 488.60, "min": 488.60, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 259.64, "avg": 259.64, "max": 259.64, "min": 259.64, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.40, "avg": 3.40, "max": 3.40, "min": 3.40, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 215.49, "avg": 215.49, "max": 215.49, "min": 215.49, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.80, "avg": 6.80, "max": 6.80, "min": 6.80, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 46, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.06, "avg": 0.06, "max": 0.06, "min": 0.06, "cnt": 1}, "forward-recv":{"total": 57.77, "avg": 19.26, "max": 0.97, "min": 52.30, "cnt": 3}, "forward-compute":{"total": 1913.40, "avg": 59.79, "max": 54.66, "min": 66.17, "cnt": 32}, "fwd-compute":{"total": 1910.60, "avg": 59.71, "max": 54.59, "min": 66.10, "cnt": 32}, "batch-generator":{"total": 39.07, "avg": 1.22, "max": 0.67, "min": 2.25, "cnt": 32}, "fwd-embedding":{"total": 0.48, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1859.86, "avg": 58.12, "max": 53.50, "min": 63.97, "cnt": 32}, "fwd-layernorm":{"total": 8.80, "avg": 0.07, "max": 0.05, "min": 0.18, "cnt": 128}, "fwd-attn":{"total": 102.96, "avg": 0.80, "max": 0.74, "min": 1.70, "cnt": 128}, "fwd-misc":{"total": 19.67, "avg": 0.15, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1708.98, "avg": 13.35, "max": 9.75, "min": 19.20, "cnt": 128}, "MoE_L0_fwd":{"total": 483.25, "avg": 15.10, "max": 11.96, "min": 19.12, "cnt": 32}, "MoEMLP":{"total": 1692.85, "avg": 13.23, "max": 9.65, "min": 19.08, "cnt": 128}, "MoE_L1_fwd":{"total": 506.54, "avg": 15.83, "max": 14.94, "min": 19.04, "cnt": 32}, "MoE_L2_fwd":{"total": 379.96, "avg": 11.87, "max": 11.30, "min": 12.90, "cnt": 32}, "MoE_L3_fwd":{"total": 329.00, "avg": 10.28, "max": 9.69, "min": 11.39, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.63, "avg": 0.02, "max": 0.02, "min": 0.05, "cnt": 32}, "forward-send":{"total": 1.25, "avg": 0.62, "max": 0.55, "min": 0.70, "cnt": 2}, "forward-send-backward-recv":{"total": 151.68, "avg": 5.06, "max": 1.05, "min": 111.40, "cnt": 30}, "backward-compute":{"total": 1992.97, "avg": 62.28, "max": 57.66, "min": 104.74, "cnt": 32}, "MoE_L3_bwd":{"total": 432.19, "avg": 13.51, "max": 10.53, "min": 56.76, "cnt": 32}, "MoE_L2_bwd":{"total": 417.63, "avg": 13.05, "max": 12.14, "min": 13.54, "cnt": 32}, "MoE_L1_bwd":{"total": 556.76, "avg": 17.40, "max": 16.60, "min": 19.42, "cnt": 32}, "MoE_L0_bwd":{"total": 373.72, "avg": 11.68, "max": 10.88, "min": 12.10, "cnt": 32}, "backward-send-forward-recv":{"total": 3723.42, "avg": 128.39, "max": 1.63, "min": 358.88, "cnt": 29}, "backward-send":{"total": 3.20, "avg": 1.07, "max": 1.00, "min": 1.18, "cnt": 3}, "backward-recv":{"total": 105.99, "avg": 53.00, "max": 50.28, "min": 55.72, "cnt": 2}, "backward-params-all-reduce":{"total": 487.48, "avg": 487.48, "max": 487.48, "min": 487.48, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 250.94, "avg": 250.94, "max": 250.94, "min": 250.94, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 206.85, "avg": 206.85, "max": 206.85, "min": 206.85, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.81, "avg": 6.81, "max": 6.81, "min": 6.81, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 47, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.06, "avg": 0.06, "max": 0.06, "min": 0.06, "cnt": 1}, "forward-recv":{"total": 65.47, "avg": 21.82, "max": 1.03, "min": 57.54, "cnt": 3}, "forward-compute":{"total": 1965.08, "avg": 61.41, "max": 53.60, "min": 70.09, "cnt": 32}, "fwd-compute":{"total": 1962.00, "avg": 61.31, "max": 53.52, "min": 70.00, "cnt": 32}, "batch-generator":{"total": 53.19, "avg": 1.66, "max": 0.66, "min": 3.08, "cnt": 32}, "fwd-embedding":{"total": 0.60, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1896.36, "avg": 59.26, "max": 52.58, "min": 66.74, "cnt": 32}, "fwd-layernorm":{"total": 9.81, "avg": 0.08, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 108.65, "avg": 0.85, "max": 0.74, "min": 2.25, "cnt": 128}, "fwd-misc":{"total": 21.27, "avg": 0.17, "max": 0.11, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1736.09, "avg": 13.56, "max": 10.30, "min": 19.14, "cnt": 128}, "MoE_L0_fwd":{"total": 503.58, "avg": 15.74, "max": 12.58, "min": 18.97, "cnt": 32}, "MoEMLP":{"total": 1719.14, "avg": 13.43, "max": 10.20, "min": 18.88, "cnt": 128}, "MoE_L1_fwd":{"total": 493.52, "avg": 15.42, "max": 13.66, "min": 18.88, "cnt": 32}, "MoE_L2_fwd":{"total": 382.59, "avg": 11.96, "max": 10.74, "min": 16.79, "cnt": 32}, "MoE_L3_fwd":{"total": 345.62, "avg": 10.80, "max": 10.24, "min": 12.62, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 0.98, "avg": 0.49, "max": 0.43, "min": 0.55, "cnt": 2}, "forward-send-backward-recv":{"total": 423.82, "avg": 14.13, "max": 1.31, "min": 134.09, "cnt": 30}, "backward-compute":{"total": 1837.97, "avg": 57.44, "max": 53.78, "min": 59.82, "cnt": 32}, "MoE_L3_bwd":{"total": 386.66, "avg": 12.08, "max": 11.13, "min": 14.20, "cnt": 32}, "MoE_L2_bwd":{"total": 364.15, "avg": 11.38, "max": 10.51, "min": 11.91, "cnt": 32}, "MoE_L1_bwd":{"total": 495.43, "avg": 15.48, "max": 14.55, "min": 16.50, "cnt": 32}, "MoE_L0_bwd":{"total": 378.41, "avg": 11.83, "max": 11.14, "min": 12.45, "cnt": 32}, "backward-send-forward-recv":{"total": 4530.36, "avg": 156.22, "max": 2.14, "min": 453.34, "cnt": 29}, "backward-send":{"total": 2.44, "avg": 0.81, "max": 0.65, "min": 1.08, "cnt": 3}, "backward-recv":{"total": 131.48, "avg": 65.74, "max": 60.60, "min": 70.87, "cnt": 2}, "backward-params-all-reduce":{"total": 488.69, "avg": 488.69, "max": 488.69, "min": 488.69, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 253.18, "avg": 253.18, "max": 253.18, "min": 253.18, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 209.07, "avg": 209.07, "max": 209.07, "min": 209.07, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.77, "avg": 6.77, "max": 6.77, "min": 6.77, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 48, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.06, "avg": 0.06, "max": 0.06, "min": 0.06, "cnt": 1}, "forward-recv":{"total": 57.14, "avg": 19.05, "max": 0.74, "min": 55.34, "cnt": 3}, "forward-compute":{"total": 2011.74, "avg": 62.87, "max": 54.30, "min": 116.78, "cnt": 32}, "fwd-compute":{"total": 2008.50, "avg": 62.77, "max": 54.23, "min": 116.70, "cnt": 32}, "batch-generator":{"total": 51.23, "avg": 1.60, "max": 0.69, "min": 2.86, "cnt": 32}, "fwd-embedding":{"total": 0.67, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1944.12, "avg": 60.75, "max": 52.23, "min": 115.58, "cnt": 32}, "fwd-layernorm":{"total": 10.25, "avg": 0.08, "max": 0.05, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 108.92, "avg": 0.85, "max": 0.74, "min": 1.59, "cnt": 128}, "fwd-misc":{"total": 21.72, "avg": 0.17, "max": 0.12, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1781.39, "avg": 13.92, "max": 10.07, "min": 65.38, "cnt": 128}, "MoE_L0_fwd":{"total": 532.15, "avg": 16.63, "max": 11.69, "min": 25.76, "cnt": 32}, "MoEMLP":{"total": 1763.78, "avg": 13.78, "max": 9.96, "min": 65.27, "cnt": 128}, "MoE_L1_fwd":{"total": 466.18, "avg": 14.57, "max": 13.33, "min": 17.45, "cnt": 32}, "MoE_L2_fwd":{"total": 369.62, "avg": 11.55, "max": 10.96, "min": 13.01, "cnt": 32}, "MoE_L3_fwd":{"total": 402.13, "avg": 12.57, "max": 10.00, "min": 65.30, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 3.70, "avg": 1.85, "max": 0.92, "min": 2.77, "cnt": 2}, "forward-send-backward-recv":{"total": 215.79, "avg": 7.19, "max": 1.36, "min": 118.23, "cnt": 30}, "backward-compute":{"total": 1736.15, "avg": 54.25, "max": 49.95, "min": 56.72, "cnt": 32}, "MoE_L3_bwd":{"total": 354.14, "avg": 11.07, "max": 8.64, "min": 12.50, "cnt": 32}, "MoE_L2_bwd":{"total": 343.81, "avg": 10.74, "max": 9.51, "min": 11.42, "cnt": 32}, "MoE_L1_bwd":{"total": 430.44, "avg": 13.45, "max": 12.88, "min": 13.99, "cnt": 32}, "MoE_L0_bwd":{"total": 386.81, "avg": 12.09, "max": 11.29, "min": 15.36, "cnt": 32}, "backward-send-forward-recv":{"total": 4985.24, "avg": 171.90, "max": 2.08, "min": 808.05, "cnt": 29}, "backward-send":{"total": 2.25, "avg": 0.75, "max": 0.61, "min": 0.88, "cnt": 3}, "backward-recv":{"total": 126.66, "avg": 63.33, "max": 59.05, "min": 67.61, "cnt": 2}, "backward-params-all-reduce":{"total": 490.61, "avg": 490.61, "max": 490.61, "min": 490.61, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 249.36, "avg": 249.36, "max": 249.36, "min": 249.36, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 209.37, "avg": 209.37, "max": 209.37, "min": 209.37, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.49, "avg": 3.49, "max": 3.49, "min": 3.49, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 49, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 55.46, "avg": 18.49, "max": 0.92, "min": 53.24, "cnt": 3}, "forward-compute":{"total": 1920.67, "avg": 60.02, "max": 52.47, "min": 68.31, "cnt": 32}, "fwd-compute":{"total": 1917.54, "avg": 59.92, "max": 52.40, "min": 68.24, "cnt": 32}, "batch-generator":{"total": 66.01, "avg": 2.06, "max": 0.67, "min": 9.04, "cnt": 32}, "fwd-embedding":{"total": 0.64, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1839.65, "avg": 57.49, "max": 51.39, "min": 64.75, "cnt": 32}, "fwd-layernorm":{"total": 10.03, "avg": 0.08, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 107.90, "avg": 0.84, "max": 0.74, "min": 1.53, "cnt": 128}, "fwd-misc":{"total": 20.91, "avg": 0.16, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1680.01, "avg": 13.13, "max": 10.50, "min": 18.99, "cnt": 128}, "MoE_L0_fwd":{"total": 478.81, "avg": 14.96, "max": 11.24, "min": 17.42, "cnt": 32}, "MoEMLP":{"total": 1663.07, "avg": 12.99, "max": 10.39, "min": 18.88, "cnt": 128}, "MoE_L1_fwd":{"total": 450.24, "avg": 14.07, "max": 12.54, "min": 18.92, "cnt": 32}, "MoE_L2_fwd":{"total": 382.60, "avg": 11.96, "max": 11.00, "min": 15.48, "cnt": 32}, "MoE_L3_fwd":{"total": 357.64, "avg": 11.18, "max": 10.43, "min": 14.49, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.56, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 3.50, "avg": 1.75, "max": 0.92, "min": 2.57, "cnt": 2}, "forward-send-backward-recv":{"total": 387.43, "avg": 12.91, "max": 1.31, "min": 122.98, "cnt": 30}, "backward-compute":{"total": 1708.28, "avg": 53.38, "max": 49.60, "min": 57.73, "cnt": 32}, "MoE_L3_bwd":{"total": 383.21, "avg": 11.98, "max": 10.22, "min": 16.85, "cnt": 32}, "MoE_L2_bwd":{"total": 344.23, "avg": 10.76, "max": 10.35, "min": 11.87, "cnt": 32}, "MoE_L1_bwd":{"total": 404.10, "avg": 12.63, "max": 11.62, "min": 14.98, "cnt": 32}, "MoE_L0_bwd":{"total": 357.32, "avg": 11.17, "max": 10.79, "min": 11.74, "cnt": 32}, "backward-send-forward-recv":{"total": 3857.63, "avg": 133.02, "max": 1.71, "min": 483.03, "cnt": 29}, "backward-send":{"total": 2.45, "avg": 0.82, "max": 0.62, "min": 1.03, "cnt": 3}, "backward-recv":{"total": 143.67, "avg": 71.84, "max": 68.53, "min": 75.14, "cnt": 2}, "backward-params-all-reduce":{"total": 489.47, "avg": 489.47, "max": 489.47, "min": 489.47, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 247.50, "avg": 247.50, "max": 247.50, "min": 247.50, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.53, "avg": 3.53, "max": 3.53, "min": 3.53, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 207.26, "avg": 207.26, "max": 207.26, "min": 207.26, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.51, "avg": 3.51, "max": 3.51, "min": 3.51, "cnt": 1}}}
{"type":"time", "iteration": 50, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.06, "avg": 0.06, "max": 0.06, "min": 0.06, "cnt": 1}, "forward-recv":{"total": 335.17, "avg": 111.72, "max": 0.96, "min": 333.17, "cnt": 3}, "forward-compute":{"total": 2044.20, "avg": 63.88, "max": 48.46, "min": 312.77, "cnt": 32}, "fwd-compute":{"total": 2041.09, "avg": 63.78, "max": 48.39, "min": 312.67, "cnt": 32}, "batch-generator":{"total": 50.42, "avg": 1.58, "max": 0.70, "min": 3.50, "cnt": 32}, "fwd-embedding":{"total": 0.66, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1978.21, "avg": 61.82, "max": 47.26, "min": 311.55, "cnt": 32}, "fwd-layernorm":{"total": 10.42, "avg": 0.08, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 111.80, "avg": 0.87, "max": 0.74, "min": 1.70, "cnt": 128}, "fwd-misc":{"total": 22.44, "avg": 0.18, "max": 0.11, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1811.15, "avg": 14.15, "max": 9.94, "min": 144.32, "cnt": 128}, "MoE_L0_fwd":{"total": 570.82, "avg": 17.84, "max": 10.02, "min": 144.23, "cnt": 32}, "MoEMLP":{"total": 1792.83, "avg": 14.01, "max": 9.84, "min": 144.19, "cnt": 128}, "MoE_L1_fwd":{"total": 515.84, "avg": 16.12, "max": 10.49, "min": 140.02, "cnt": 32}, "MoE_L2_fwd":{"total": 376.61, "avg": 11.77, "max": 10.93, "min": 13.24, "cnt": 32}, "MoE_L3_fwd":{"total": 336.08, "avg": 10.50, "max": 9.87, "min": 13.38, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 13.89, "avg": 6.95, "max": 0.90, "min": 12.99, "cnt": 2}, "forward-send-backward-recv":{"total": 321.93, "avg": 10.73, "max": 1.61, "min": 130.75, "cnt": 30}, "backward-compute":{"total": 1461.78, "avg": 45.68, "max": 44.03, "min": 50.76, "cnt": 32}, "MoE_L3_bwd":{"total": 339.29, "avg": 10.60, "max": 9.81, "min": 12.08, "cnt": 32}, "MoE_L2_bwd":{"total": 343.26, "avg": 10.73, "max": 9.52, "min": 12.98, "cnt": 32}, "MoE_L1_bwd":{"total": 295.38, "avg": 9.23, "max": 8.79, "min": 10.64, "cnt": 32}, "MoE_L0_bwd":{"total": 261.82, "avg": 8.18, "max": 7.76, "min": 8.56, "cnt": 32}, "backward-send-forward-recv":{"total": 3753.44, "avg": 129.43, "max": 2.16, "min": 513.41, "cnt": 29}, "backward-send":{"total": 2.75, "avg": 0.92, "max": 0.59, "min": 1.09, "cnt": 3}, "backward-recv":{"total": 232.84, "avg": 116.42, "max": 64.99, "min": 167.85, "cnt": 2}, "backward-params-all-reduce":{"total": 487.71, "avg": 487.71, "max": 487.71, "min": 487.71, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 257.64, "avg": 257.64, "max": 257.64, "min": 257.64, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 217.62, "avg": 217.62, "max": 217.62, "min": 217.62, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.52, "avg": 3.52, "max": 3.52, "min": 3.52, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 51, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 59.81, "avg": 19.94, "max": 1.26, "min": 57.05, "cnt": 3}, "forward-compute":{"total": 1804.40, "avg": 56.39, "max": 51.32, "min": 63.97, "cnt": 32}, "fwd-compute":{"total": 1801.43, "avg": 56.29, "max": 51.24, "min": 63.83, "cnt": 32}, "batch-generator":{"total": 41.08, "avg": 1.28, "max": 0.71, "min": 2.56, "cnt": 32}, "fwd-embedding":{"total": 0.54, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1748.31, "avg": 54.63, "max": 49.09, "min": 61.74, "cnt": 32}, "fwd-layernorm":{"total": 9.83, "avg": 0.08, "max": 0.05, "min": 0.31, "cnt": 128}, "fwd-attn":{"total": 109.23, "avg": 0.85, "max": 0.74, "min": 1.64, "cnt": 128}, "fwd-misc":{"total": 20.89, "avg": 0.16, "max": 0.11, "min": 0.39, "cnt": 128}, "fwd-MLP":{"total": 1586.87, "avg": 12.40, "max": 10.14, "min": 19.55, "cnt": 128}, "MoE_L0_fwd":{"total": 447.01, "avg": 13.97, "max": 10.24, "min": 19.42, "cnt": 32}, "MoEMLP":{"total": 1569.60, "avg": 12.26, "max": 10.01, "min": 19.34, "cnt": 128}, "MoE_L1_fwd":{"total": 403.52, "avg": 12.61, "max": 11.12, "min": 16.88, "cnt": 32}, "MoE_L2_fwd":{"total": 383.29, "avg": 11.98, "max": 10.90, "min": 16.20, "cnt": 32}, "MoE_L3_fwd":{"total": 342.04, "avg": 10.69, "max": 10.05, "min": 11.53, "cnt": 32}, "fwd-pooler":{"total": 0.36, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.62, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.79, "avg": 0.89, "max": 0.86, "min": 0.93, "cnt": 2}, "forward-send-backward-recv":{"total": 219.30, "avg": 7.31, "max": 1.26, "min": 110.32, "cnt": 30}, "backward-compute":{"total": 1509.53, "avg": 47.17, "max": 45.36, "min": 49.25, "cnt": 32}, "MoE_L3_bwd":{"total": 344.26, "avg": 10.76, "max": 9.94, "min": 12.71, "cnt": 32}, "MoE_L2_bwd":{"total": 342.81, "avg": 10.71, "max": 9.83, "min": 11.79, "cnt": 32}, "MoE_L1_bwd":{"total": 322.29, "avg": 10.07, "max": 9.38, "min": 11.47, "cnt": 32}, "MoE_L0_bwd":{"total": 281.61, "avg": 8.80, "max": 8.18, "min": 9.56, "cnt": 32}, "backward-send-forward-recv":{"total": 3653.30, "avg": 125.98, "max": 2.27, "min": 353.02, "cnt": 29}, "backward-send":{"total": 2.40, "avg": 0.80, "max": 0.48, "min": 1.01, "cnt": 3}, "backward-recv":{"total": 146.07, "avg": 73.03, "max": 69.11, "min": 76.96, "cnt": 2}, "backward-params-all-reduce":{"total": 488.96, "avg": 488.96, "max": 488.96, "min": 488.96, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 251.93, "avg": 251.93, "max": 251.93, "min": 251.93, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 212.01, "avg": 212.01, "max": 212.01, "min": 212.01, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.28, "avg": 3.28, "max": 3.28, "min": 3.28, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.48, "avg": 3.48, "max": 3.48, "min": 3.48, "cnt": 1}}}
{"type":"time", "iteration": 52, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.10, "avg": 0.10, "max": 0.10, "min": 0.10, "cnt": 1}, "forward-recv":{"total": 60.22, "avg": 20.07, "max": 2.02, "min": 54.94, "cnt": 3}, "forward-compute":{"total": 1809.84, "avg": 56.56, "max": 49.43, "min": 65.12, "cnt": 32}, "fwd-compute":{"total": 1806.80, "avg": 56.46, "max": 49.36, "min": 64.96, "cnt": 32}, "batch-generator":{"total": 43.63, "avg": 1.36, "max": 0.64, "min": 3.31, "cnt": 32}, "fwd-embedding":{"total": 0.55, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1751.45, "avg": 54.73, "max": 48.44, "min": 62.79, "cnt": 32}, "fwd-layernorm":{"total": 9.40, "avg": 0.07, "max": 0.05, "min": 0.17, "cnt": 128}, "fwd-attn":{"total": 106.55, "avg": 0.83, "max": 0.74, "min": 1.44, "cnt": 128}, "fwd-misc":{"total": 20.29, "avg": 0.16, "max": 0.11, "min": 0.38, "cnt": 128}, "fwd-MLP":{"total": 1595.03, "avg": 12.46, "max": 10.31, "min": 23.15, "cnt": 128}, "MoE_L0_fwd":{"total": 476.13, "avg": 14.88, "max": 10.48, "min": 23.02, "cnt": 32}, "MoEMLP":{"total": 1578.46, "avg": 12.33, "max": 10.20, "min": 22.97, "cnt": 128}, "MoE_L1_fwd":{"total": 392.73, "avg": 12.27, "max": 11.06, "min": 16.35, "cnt": 32}, "MoE_L2_fwd":{"total": 366.39, "avg": 11.45, "max": 10.64, "min": 12.82, "cnt": 32}, "MoE_L3_fwd":{"total": 349.32, "avg": 10.92, "max": 10.24, "min": 12.54, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.56, "avg": 0.78, "max": 0.65, "min": 0.90, "cnt": 2}, "forward-send-backward-recv":{"total": 223.15, "avg": 7.44, "max": 1.23, "min": 108.35, "cnt": 30}, "backward-compute":{"total": 1535.28, "avg": 47.98, "max": 44.56, "min": 51.63, "cnt": 32}, "MoE_L3_bwd":{"total": 360.24, "avg": 11.26, "max": 10.03, "min": 14.83, "cnt": 32}, "MoE_L2_bwd":{"total": 345.03, "avg": 10.78, "max": 10.01, "min": 11.93, "cnt": 32}, "MoE_L1_bwd":{"total": 323.12, "avg": 10.10, "max": 9.57, "min": 10.96, "cnt": 32}, "MoE_L0_bwd":{"total": 291.24, "avg": 9.10, "max": 8.38, "min": 9.87, "cnt": 32}, "backward-send-forward-recv":{"total": 5507.30, "avg": 189.91, "max": 2.18, "min": 1038.25, "cnt": 29}, "backward-send":{"total": 1.90, "avg": 0.63, "max": 0.44, "min": 0.78, "cnt": 3}, "backward-recv":{"total": 137.28, "avg": 68.64, "max": 66.04, "min": 71.24, "cnt": 2}, "backward-params-all-reduce":{"total": 490.28, "avg": 490.28, "max": 490.28, "min": 490.28, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 251.65, "avg": 251.65, "max": 251.65, "min": 251.65, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 211.45, "avg": 211.45, "max": 211.45, "min": 211.45, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.61, "avg": 3.61, "max": 3.61, "min": 3.61, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 53, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 66.43, "avg": 22.14, "max": 0.93, "min": 64.50, "cnt": 3}, "forward-compute":{"total": 1852.08, "avg": 57.88, "max": 49.20, "min": 64.02, "cnt": 32}, "fwd-compute":{"total": 1848.66, "avg": 57.77, "max": 49.13, "min": 63.92, "cnt": 32}, "batch-generator":{"total": 44.22, "avg": 1.38, "max": 0.66, "min": 2.69, "cnt": 32}, "fwd-embedding":{"total": 0.67, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1790.86, "avg": 55.96, "max": 48.17, "min": 61.54, "cnt": 32}, "fwd-layernorm":{"total": 10.15, "avg": 0.08, "max": 0.06, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 110.68, "avg": 0.86, "max": 0.74, "min": 1.66, "cnt": 128}, "fwd-misc":{"total": 21.69, "avg": 0.17, "max": 0.11, "min": 0.41, "cnt": 128}, "fwd-MLP":{"total": 1627.07, "avg": 12.71, "max": 10.60, "min": 19.20, "cnt": 128}, "MoE_L0_fwd":{"total": 474.82, "avg": 14.84, "max": 10.60, "min": 19.12, "cnt": 32}, "MoEMLP":{"total": 1609.79, "avg": 12.58, "max": 10.50, "min": 19.08, "cnt": 128}, "MoE_L1_fwd":{"total": 396.27, "avg": 12.38, "max": 11.22, "min": 14.11, "cnt": 32}, "MoE_L2_fwd":{"total": 378.43, "avg": 11.83, "max": 11.02, "min": 14.33, "cnt": 32}, "MoE_L3_fwd":{"total": 366.54, "avg": 11.45, "max": 10.54, "min": 14.65, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.61, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 4.70, "avg": 2.35, "max": 0.71, "min": 3.99, "cnt": 2}, "forward-send-backward-recv":{"total": 198.94, "avg": 6.63, "max": 1.21, "min": 113.34, "cnt": 30}, "backward-compute":{"total": 1536.37, "avg": 48.01, "max": 45.08, "min": 49.00, "cnt": 32}, "MoE_L3_bwd":{"total": 365.23, "avg": 11.41, "max": 10.41, "min": 12.36, "cnt": 32}, "MoE_L2_bwd":{"total": 343.02, "avg": 10.72, "max": 10.33, "min": 11.44, "cnt": 32}, "MoE_L1_bwd":{"total": 314.97, "avg": 9.84, "max": 9.17, "min": 10.25, "cnt": 32}, "MoE_L0_bwd":{"total": 296.80, "avg": 9.27, "max": 8.79, "min": 9.53, "cnt": 32}, "backward-send-forward-recv":{"total": 4276.32, "avg": 147.46, "max": 2.33, "min": 621.83, "cnt": 29}, "backward-send":{"total": 2.37, "avg": 0.79, "max": 0.57, "min": 1.09, "cnt": 3}, "backward-recv":{"total": 137.45, "avg": 68.73, "max": 67.63, "min": 69.82, "cnt": 2}, "backward-params-all-reduce":{"total": 490.44, "avg": 490.44, "max": 490.44, "min": 490.44, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 249.02, "avg": 249.02, "max": 249.02, "min": 249.02, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 209.20, "avg": 209.20, "max": 209.20, "min": 209.20, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.29, "avg": 3.29, "max": 3.29, "min": 3.29, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.47, "avg": 3.47, "max": 3.47, "min": 3.47, "cnt": 1}}}
{"type":"time", "iteration": 54, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.06, "avg": 0.06, "max": 0.06, "min": 0.06, "cnt": 1}, "forward-recv":{"total": 61.31, "avg": 20.44, "max": 0.94, "min": 57.91, "cnt": 3}, "forward-compute":{"total": 1812.49, "avg": 56.64, "max": 49.44, "min": 62.04, "cnt": 32}, "fwd-compute":{"total": 1809.42, "avg": 56.54, "max": 49.36, "min": 61.94, "cnt": 32}, "batch-generator":{"total": 43.45, "avg": 1.36, "max": 0.68, "min": 4.12, "cnt": 32}, "fwd-embedding":{"total": 0.63, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1753.03, "avg": 54.78, "max": 48.31, "min": 60.31, "cnt": 32}, "fwd-layernorm":{"total": 9.93, "avg": 0.08, "max": 0.05, "min": 0.18, "cnt": 128}, "fwd-attn":{"total": 107.85, "avg": 0.84, "max": 0.74, "min": 1.49, "cnt": 128}, "fwd-misc":{"total": 21.07, "avg": 0.16, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1592.85, "avg": 12.44, "max": 10.25, "min": 19.35, "cnt": 128}, "MoE_L0_fwd":{"total": 446.83, "avg": 13.96, "max": 10.91, "min": 16.98, "cnt": 32}, "MoEMLP":{"total": 1575.40, "avg": 12.31, "max": 10.15, "min": 19.23, "cnt": 128}, "MoE_L1_fwd":{"total": 402.14, "avg": 12.57, "max": 11.03, "min": 17.66, "cnt": 32}, "MoE_L2_fwd":{"total": 379.42, "avg": 11.86, "max": 10.87, "min": 19.27, "cnt": 32}, "MoE_L3_fwd":{"total": 353.29, "avg": 11.04, "max": 10.18, "min": 15.81, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.23, "avg": 0.62, "max": 0.46, "min": 0.78, "cnt": 2}, "forward-send-backward-recv":{"total": 1659.11, "avg": 55.30, "max": 1.47, "min": 302.21, "cnt": 30}, "backward-compute":{"total": 1529.88, "avg": 47.81, "max": 45.71, "min": 50.90, "cnt": 32}, "MoE_L3_bwd":{"total": 351.38, "avg": 10.98, "max": 10.16, "min": 13.08, "cnt": 32}, "MoE_L2_bwd":{"total": 342.24, "avg": 10.69, "max": 10.07, "min": 11.39, "cnt": 32}, "MoE_L1_bwd":{"total": 324.03, "avg": 10.13, "max": 9.45, "min": 12.67, "cnt": 32}, "MoE_L0_bwd":{"total": 295.54, "avg": 9.24, "max": 8.55, "min": 11.09, "cnt": 32}, "backward-send-forward-recv":{"total": 2366.54, "avg": 81.60, "max": 2.09, "min": 357.02, "cnt": 29}, "backward-send":{"total": 3.28, "avg": 1.09, "max": 0.89, "min": 1.20, "cnt": 3}, "backward-recv":{"total": 282.93, "avg": 141.47, "max": 109.76, "min": 173.18, "cnt": 2}, "backward-params-all-reduce":{"total": 484.29, "avg": 484.29, "max": 484.29, "min": 484.29, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 252.00, "avg": 252.00, "max": 252.00, "min": 252.00, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 212.08, "avg": 212.08, "max": 212.08, "min": 212.08, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.40, "avg": 3.40, "max": 3.40, "min": 3.40, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 55, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 77.36, "avg": 25.79, "max": 0.93, "min": 69.25, "cnt": 3}, "forward-compute":{"total": 1802.41, "avg": 56.33, "max": 49.02, "min": 65.97, "cnt": 32}, "fwd-compute":{"total": 1799.41, "avg": 56.23, "max": 48.95, "min": 65.85, "cnt": 32}, "batch-generator":{"total": 45.12, "avg": 1.41, "max": 0.66, "min": 2.54, "cnt": 32}, "fwd-embedding":{"total": 0.65, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1742.02, "avg": 54.44, "max": 47.75, "min": 63.86, "cnt": 32}, "fwd-layernorm":{"total": 10.10, "avg": 0.08, "max": 0.05, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 110.39, "avg": 0.86, "max": 0.74, "min": 1.61, "cnt": 128}, "fwd-misc":{"total": 21.30, "avg": 0.17, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1578.91, "avg": 12.34, "max": 10.24, "min": 19.12, "cnt": 128}, "MoE_L0_fwd":{"total": 450.18, "avg": 14.07, "max": 10.20, "min": 19.00, "cnt": 32}, "MoEMLP":{"total": 1561.85, "avg": 12.20, "max": 10.12, "min": 18.96, "cnt": 128}, "MoE_L1_fwd":{"total": 392.61, "avg": 12.27, "max": 10.98, "min": 16.52, "cnt": 32}, "MoE_L2_fwd":{"total": 369.86, "avg": 11.56, "max": 10.69, "min": 14.13, "cnt": 32}, "MoE_L3_fwd":{"total": 355.45, "avg": 11.11, "max": 10.18, "min": 15.37, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.21, "avg": 0.61, "max": 0.56, "min": 0.66, "cnt": 2}, "forward-send-backward-recv":{"total": 193.45, "avg": 6.45, "max": 1.23, "min": 100.44, "cnt": 30}, "backward-compute":{"total": 1503.37, "avg": 46.98, "max": 44.47, "min": 47.89, "cnt": 32}, "MoE_L3_bwd":{"total": 344.83, "avg": 10.78, "max": 9.87, "min": 11.44, "cnt": 32}, "MoE_L2_bwd":{"total": 336.57, "avg": 10.52, "max": 10.02, "min": 11.31, "cnt": 32}, "MoE_L1_bwd":{"total": 312.19, "avg": 9.76, "max": 9.13, "min": 10.20, "cnt": 32}, "MoE_L0_bwd":{"total": 291.36, "avg": 9.11, "max": 8.46, "min": 9.38, "cnt": 32}, "backward-send-forward-recv":{"total": 3698.52, "avg": 127.54, "max": 2.27, "min": 340.72, "cnt": 29}, "backward-send":{"total": 2.47, "avg": 0.82, "max": 0.69, "min": 1.05, "cnt": 3}, "backward-recv":{"total": 139.65, "avg": 69.83, "max": 58.32, "min": 81.34, "cnt": 2}, "backward-params-all-reduce":{"total": 540.19, "avg": 540.19, "max": 540.19, "min": 540.19, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 194.76, "avg": 194.76, "max": 194.76, "min": 194.76, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 154.86, "avg": 154.86, "max": 154.86, "min": 154.86, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.33, "avg": 3.33, "max": 3.33, "min": 3.33, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.47, "avg": 3.47, "max": 3.47, "min": 3.47, "cnt": 1}}}
{"type":"time", "iteration": 56, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.06, "avg": 0.06, "max": 0.06, "min": 0.06, "cnt": 1}, "forward-recv":{"total": 68.15, "avg": 22.72, "max": 0.79, "min": 59.66, "cnt": 3}, "forward-compute":{"total": 1777.73, "avg": 55.55, "max": 49.09, "min": 65.39, "cnt": 32}, "fwd-compute":{"total": 1774.69, "avg": 55.46, "max": 49.02, "min": 65.30, "cnt": 32}, "batch-generator":{"total": 45.96, "avg": 1.44, "max": 0.64, "min": 3.32, "cnt": 32}, "fwd-embedding":{"total": 0.55, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1716.17, "avg": 53.63, "max": 48.09, "min": 63.90, "cnt": 32}, "fwd-layernorm":{"total": 9.55, "avg": 0.07, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 105.86, "avg": 0.83, "max": 0.74, "min": 1.52, "cnt": 128}, "fwd-misc":{"total": 20.84, "avg": 0.16, "max": 0.11, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1559.34, "avg": 12.18, "max": 10.44, "min": 18.77, "cnt": 128}, "MoE_L0_fwd":{"total": 441.45, "avg": 13.80, "max": 10.69, "min": 18.68, "cnt": 32}, "MoEMLP":{"total": 1542.53, "avg": 12.05, "max": 10.33, "min": 18.64, "cnt": 128}, "MoE_L1_fwd":{"total": 386.83, "avg": 12.09, "max": 10.87, "min": 17.20, "cnt": 32}, "MoE_L2_fwd":{"total": 364.61, "avg": 11.39, "max": 10.85, "min": 12.16, "cnt": 32}, "MoE_L3_fwd":{"total": 355.71, "avg": 11.12, "max": 10.37, "min": 15.57, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 3.48, "avg": 1.74, "max": 0.74, "min": 2.74, "cnt": 2}, "forward-send-backward-recv":{"total": 226.56, "avg": 7.55, "max": 1.36, "min": 124.65, "cnt": 30}, "backward-compute":{"total": 1532.12, "avg": 47.88, "max": 46.46, "min": 50.39, "cnt": 32}, "MoE_L3_bwd":{"total": 360.31, "avg": 11.26, "max": 10.27, "min": 14.07, "cnt": 32}, "MoE_L2_bwd":{"total": 335.43, "avg": 10.48, "max": 9.96, "min": 11.01, "cnt": 32}, "MoE_L1_bwd":{"total": 317.53, "avg": 9.92, "max": 9.52, "min": 10.91, "cnt": 32}, "MoE_L0_bwd":{"total": 298.31, "avg": 9.32, "max": 8.79, "min": 9.73, "cnt": 32}, "backward-send-forward-recv":{"total": 4294.38, "avg": 148.08, "max": 2.37, "min": 744.63, "cnt": 29}, "backward-send":{"total": 3.26, "avg": 1.09, "max": 0.98, "min": 1.14, "cnt": 3}, "backward-recv":{"total": 129.11, "avg": 64.55, "max": 58.24, "min": 70.86, "cnt": 2}, "backward-params-all-reduce":{"total": 490.38, "avg": 490.38, "max": 490.38, "min": 490.38, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 248.28, "avg": 248.28, "max": 248.28, "min": 248.28, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 208.38, "avg": 208.38, "max": 208.38, "min": 208.38, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.31, "avg": 3.31, "max": 3.31, "min": 3.31, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.47, "avg": 3.47, "max": 3.47, "min": 3.47, "cnt": 1}}}
{"type":"time", "iteration": 57, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 61.41, "avg": 20.47, "max": 0.98, "min": 59.37, "cnt": 3}, "forward-compute":{"total": 1844.15, "avg": 57.63, "max": 50.90, "min": 66.51, "cnt": 32}, "fwd-compute":{"total": 1841.24, "avg": 57.54, "max": 50.82, "min": 66.44, "cnt": 32}, "batch-generator":{"total": 45.14, "avg": 1.41, "max": 0.67, "min": 2.91, "cnt": 32}, "fwd-embedding":{"total": 0.58, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1784.39, "avg": 55.76, "max": 49.82, "min": 64.03, "cnt": 32}, "fwd-layernorm":{"total": 9.48, "avg": 0.07, "max": 0.05, "min": 0.18, "cnt": 128}, "fwd-attn":{"total": 107.62, "avg": 0.84, "max": 0.74, "min": 1.89, "cnt": 128}, "fwd-misc":{"total": 20.99, "avg": 0.16, "max": 0.11, "min": 0.54, "cnt": 128}, "fwd-MLP":{"total": 1625.94, "avg": 12.70, "max": 10.74, "min": 20.29, "cnt": 128}, "MoE_L0_fwd":{"total": 469.50, "avg": 14.67, "max": 11.08, "min": 20.18, "cnt": 32}, "MoEMLP":{"total": 1609.25, "avg": 12.57, "max": 10.63, "min": 20.12, "cnt": 128}, "MoE_L1_fwd":{"total": 403.29, "avg": 12.60, "max": 10.93, "min": 17.20, "cnt": 32}, "MoE_L2_fwd":{"total": 382.85, "avg": 11.96, "max": 11.07, "min": 13.72, "cnt": 32}, "MoE_L3_fwd":{"total": 359.66, "avg": 11.24, "max": 10.67, "min": 11.74, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 7.60, "avg": 3.80, "max": 0.67, "min": 6.93, "cnt": 2}, "forward-send-backward-recv":{"total": 474.98, "avg": 15.83, "max": 1.61, "min": 191.53, "cnt": 30}, "backward-compute":{"total": 1566.50, "avg": 48.95, "max": 46.74, "min": 50.23, "cnt": 32}, "MoE_L3_bwd":{"total": 379.82, "avg": 11.87, "max": 11.36, "min": 13.18, "cnt": 32}, "MoE_L2_bwd":{"total": 353.04, "avg": 11.03, "max": 10.47, "min": 12.09, "cnt": 32}, "MoE_L1_bwd":{"total": 312.46, "avg": 9.76, "max": 9.29, "min": 10.66, "cnt": 32}, "MoE_L0_bwd":{"total": 302.82, "avg": 9.46, "max": 8.97, "min": 10.15, "cnt": 32}, "backward-send-forward-recv":{"total": 4555.03, "avg": 157.07, "max": 2.28, "min": 788.08, "cnt": 29}, "backward-send":{"total": 2.82, "avg": 0.94, "max": 0.74, "min": 1.18, "cnt": 3}, "backward-recv":{"total": 182.16, "avg": 91.08, "max": 78.48, "min": 103.69, "cnt": 2}, "backward-params-all-reduce":{"total": 484.35, "avg": 484.35, "max": 484.35, "min": 484.35, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 255.70, "avg": 255.70, "max": 255.70, "min": 255.70, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 215.68, "avg": 215.68, "max": 215.68, "min": 215.68, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.47, "avg": 3.47, "max": 3.47, "min": 3.47, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.47, "avg": 3.47, "max": 3.47, "min": 3.47, "cnt": 1}}}
{"type":"time", "iteration": 58, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.06, "avg": 0.06, "max": 0.06, "min": 0.06, "cnt": 1}, "forward-recv":{"total": 58.09, "avg": 19.36, "max": 1.21, "min": 54.48, "cnt": 3}, "forward-compute":{"total": 1866.22, "avg": 58.32, "max": 51.29, "min": 66.31, "cnt": 32}, "fwd-compute":{"total": 1863.32, "avg": 58.23, "max": 51.21, "min": 66.19, "cnt": 32}, "batch-generator":{"total": 40.60, "avg": 1.27, "max": 0.64, "min": 3.28, "cnt": 32}, "fwd-embedding":{"total": 0.57, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1810.69, "avg": 56.58, "max": 49.89, "min": 64.03, "cnt": 32}, "fwd-layernorm":{"total": 9.53, "avg": 0.07, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 108.48, "avg": 0.85, "max": 0.74, "min": 1.53, "cnt": 128}, "fwd-misc":{"total": 21.35, "avg": 0.17, "max": 0.11, "min": 0.39, "cnt": 128}, "fwd-MLP":{"total": 1650.39, "avg": 12.89, "max": 10.83, "min": 17.87, "cnt": 128}, "MoE_L0_fwd":{"total": 461.21, "avg": 14.41, "max": 10.75, "min": 17.77, "cnt": 32}, "MoEMLP":{"total": 1633.10, "avg": 12.76, "max": 10.71, "min": 17.73, "cnt": 128}, "MoE_L1_fwd":{"total": 414.04, "avg": 12.94, "max": 11.31, "min": 15.97, "cnt": 32}, "MoE_L2_fwd":{"total": 381.67, "avg": 11.93, "max": 10.93, "min": 15.33, "cnt": 32}, "MoE_L3_fwd":{"total": 382.31, "avg": 11.95, "max": 11.21, "min": 17.44, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.84, "avg": 0.92, "max": 0.86, "min": 0.98, "cnt": 2}, "forward-send-backward-recv":{"total": 479.54, "avg": 15.98, "max": 1.34, "min": 110.32, "cnt": 30}, "backward-compute":{"total": 1581.60, "avg": 49.42, "max": 47.29, "min": 51.66, "cnt": 32}, "MoE_L3_bwd":{"total": 393.92, "avg": 12.31, "max": 11.15, "min": 14.32, "cnt": 32}, "MoE_L2_bwd":{"total": 347.05, "avg": 10.85, "max": 10.20, "min": 11.68, "cnt": 32}, "MoE_L1_bwd":{"total": 318.22, "avg": 9.94, "max": 9.52, "min": 10.29, "cnt": 32}, "MoE_L0_bwd":{"total": 306.57, "avg": 9.58, "max": 8.91, "min": 9.95, "cnt": 32}, "backward-send-forward-recv":{"total": 5009.74, "avg": 172.75, "max": 2.42, "min": 1191.45, "cnt": 29}, "backward-send":{"total": 2.59, "avg": 0.86, "max": 0.67, "min": 1.04, "cnt": 3}, "backward-recv":{"total": 140.55, "avg": 70.27, "max": 63.90, "min": 76.64, "cnt": 2}, "backward-params-all-reduce":{"total": 486.95, "avg": 486.95, "max": 486.95, "min": 486.95, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 249.98, "avg": 249.98, "max": 249.98, "min": 249.98, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 210.09, "avg": 210.09, "max": 210.09, "min": 210.09, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.31, "avg": 3.31, "max": 3.31, "min": 3.31, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 59, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 59.52, "avg": 19.84, "max": 0.94, "min": 57.54, "cnt": 3}, "forward-compute":{"total": 1919.46, "avg": 59.98, "max": 50.93, "min": 74.22, "cnt": 32}, "fwd-compute":{"total": 1916.28, "avg": 59.88, "max": 50.86, "min": 74.15, "cnt": 32}, "batch-generator":{"total": 50.62, "avg": 1.58, "max": 0.65, "min": 3.34, "cnt": 32}, "fwd-embedding":{"total": 0.70, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1853.12, "avg": 57.91, "max": 49.91, "min": 72.11, "cnt": 32}, "fwd-layernorm":{"total": 10.62, "avg": 0.08, "max": 0.05, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 113.51, "avg": 0.89, "max": 0.75, "min": 1.71, "cnt": 128}, "fwd-misc":{"total": 22.49, "avg": 0.18, "max": 0.11, "min": 0.42, "cnt": 128}, "fwd-MLP":{"total": 1684.66, "avg": 13.16, "max": 10.97, "min": 20.14, "cnt": 128}, "MoE_L0_fwd":{"total": 490.68, "avg": 15.33, "max": 11.10, "min": 20.07, "cnt": 32}, "MoEMLP":{"total": 1666.99, "avg": 13.02, "max": 10.86, "min": 20.01, "cnt": 128}, "MoE_L1_fwd":{"total": 413.98, "avg": 12.94, "max": 11.77, "min": 15.63, "cnt": 32}, "MoE_L2_fwd":{"total": 386.85, "avg": 12.09, "max": 10.90, "min": 17.50, "cnt": 32}, "MoE_L3_fwd":{"total": 381.94, "avg": 11.94, "max": 11.24, "min": 15.05, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.56, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 10.91, "avg": 5.46, "max": 0.87, "min": 10.04, "cnt": 2}, "forward-send-backward-recv":{"total": 274.83, "avg": 9.16, "max": 1.32, "min": 122.96, "cnt": 30}, "backward-compute":{"total": 1634.93, "avg": 51.09, "max": 49.94, "min": 52.94, "cnt": 32}, "MoE_L3_bwd":{"total": 409.24, "avg": 12.79, "max": 11.97, "min": 14.31, "cnt": 32}, "MoE_L2_bwd":{"total": 346.03, "avg": 10.81, "max": 10.09, "min": 11.73, "cnt": 32}, "MoE_L1_bwd":{"total": 350.93, "avg": 10.97, "max": 10.49, "min": 11.42, "cnt": 32}, "MoE_L0_bwd":{"total": 316.71, "avg": 9.90, "max": 9.32, "min": 10.15, "cnt": 32}, "backward-send-forward-recv":{"total": 4994.91, "avg": 172.24, "max": 1.96, "min": 612.19, "cnt": 29}, "backward-send":{"total": 2.88, "avg": 0.96, "max": 0.92, "min": 0.98, "cnt": 3}, "backward-recv":{"total": 152.87, "avg": 76.43, "max": 76.36, "min": 76.51, "cnt": 2}, "backward-params-all-reduce":{"total": 485.25, "avg": 485.25, "max": 485.25, "min": 485.25, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 253.45, "avg": 253.45, "max": 253.45, "min": 253.45, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 213.44, "avg": 213.44, "max": 213.44, "min": 213.44, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.41, "avg": 3.41, "max": 3.41, "min": 3.41, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.47, "avg": 3.47, "max": 3.47, "min": 3.47, "cnt": 1}}}
{"type":"time", "iteration": 60, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 68.00, "avg": 22.67, "max": 0.96, "min": 65.41, "cnt": 3}, "forward-compute":{"total": 2124.35, "avg": 66.39, "max": 51.71, "min": 353.54, "cnt": 32}, "fwd-compute":{"total": 2121.15, "avg": 66.29, "max": 51.64, "min": 353.46, "cnt": 32}, "batch-generator":{"total": 47.17, "avg": 1.47, "max": 0.75, "min": 2.86, "cnt": 32}, "fwd-embedding":{"total": 0.63, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 2061.52, "avg": 64.42, "max": 49.86, "min": 352.37, "cnt": 32}, "fwd-layernorm":{"total": 10.15, "avg": 0.08, "max": 0.05, "min": 0.18, "cnt": 128}, "fwd-attn":{"total": 109.47, "avg": 0.86, "max": 0.74, "min": 1.52, "cnt": 128}, "fwd-misc":{"total": 21.31, "avg": 0.17, "max": 0.11, "min": 0.34, "cnt": 128}, "fwd-MLP":{"total": 1899.53, "avg": 14.84, "max": 10.62, "min": 163.25, "cnt": 128}, "MoE_L0_fwd":{"total": 600.26, "avg": 18.76, "max": 10.55, "min": 160.32, "cnt": 32}, "MoEMLP":{"total": 1882.49, "avg": 14.71, "max": 10.50, "min": 163.13, "cnt": 128}, "MoE_L1_fwd":{"total": 530.54, "avg": 16.58, "max": 10.55, "min": 163.17, "cnt": 32}, "MoE_L2_fwd":{"total": 377.73, "avg": 11.80, "max": 11.07, "min": 18.56, "cnt": 32}, "MoE_L3_fwd":{"total": 380.24, "avg": 11.88, "max": 11.48, "min": 12.86, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 265.84, "avg": 132.92, "max": 0.71, "min": 265.14, "cnt": 2}, "forward-send-backward-recv":{"total": 4100.02, "avg": 136.67, "max": 1.88, "min": 1406.24, "cnt": 30}, "backward-compute":{"total": 1536.30, "avg": 48.01, "max": 45.91, "min": 51.93, "cnt": 32}, "MoE_L3_bwd":{"total": 414.03, "avg": 12.94, "max": 11.33, "min": 16.19, "cnt": 32}, "MoE_L2_bwd":{"total": 347.51, "avg": 10.86, "max": 10.16, "min": 11.89, "cnt": 32}, "MoE_L1_bwd":{"total": 285.50, "avg": 8.92, "max": 8.29, "min": 10.94, "cnt": 32}, "MoE_L0_bwd":{"total": 276.50, "avg": 8.64, "max": 8.02, "min": 9.17, "cnt": 32}, "backward-send-forward-recv":{"total": 2252.38, "avg": 77.67, "max": 1.65, "min": 495.52, "cnt": 29}, "backward-send":{"total": 2.13, "avg": 0.71, "max": 0.55, "min": 0.79, "cnt": 3}, "backward-recv":{"total": 393.29, "avg": 196.64, "max": 75.86, "min": 317.43, "cnt": 2}, "backward-params-all-reduce":{"total": 490.95, "avg": 490.95, "max": 490.95, "min": 490.95, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 252.26, "avg": 252.26, "max": 252.26, "min": 252.26, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 212.55, "avg": 212.55, "max": 212.55, "min": 212.55, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.29, "avg": 3.29, "max": 3.29, "min": 3.29, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 61, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 65.83, "avg": 21.94, "max": 1.36, "min": 55.67, "cnt": 3}, "forward-compute":{"total": 1851.53, "avg": 57.86, "max": 50.28, "min": 62.97, "cnt": 32}, "fwd-compute":{"total": 1848.27, "avg": 57.76, "max": 50.22, "min": 62.84, "cnt": 32}, "batch-generator":{"total": 43.69, "avg": 1.37, "max": 0.64, "min": 1.99, "cnt": 32}, "fwd-embedding":{"total": 0.66, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1790.77, "avg": 55.96, "max": 49.30, "min": 60.66, "cnt": 32}, "fwd-layernorm":{"total": 10.30, "avg": 0.08, "max": 0.05, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 111.66, "avg": 0.87, "max": 0.74, "min": 1.91, "cnt": 128}, "fwd-misc":{"total": 21.86, "avg": 0.17, "max": 0.11, "min": 0.38, "cnt": 128}, "fwd-MLP":{"total": 1625.09, "avg": 12.70, "max": 10.59, "min": 17.55, "cnt": 128}, "MoE_L0_fwd":{"total": 464.11, "avg": 14.50, "max": 10.81, "min": 17.48, "cnt": 32}, "MoEMLP":{"total": 1607.19, "avg": 12.56, "max": 10.49, "min": 17.44, "cnt": 128}, "MoE_L1_fwd":{"total": 379.32, "avg": 11.85, "max": 10.53, "min": 14.05, "cnt": 32}, "MoE_L2_fwd":{"total": 391.14, "avg": 12.22, "max": 11.33, "min": 15.56, "cnt": 32}, "MoE_L3_fwd":{"total": 379.06, "avg": 11.85, "max": 11.08, "min": 13.70, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.63, "avg": 0.02, "max": 0.02, "min": 0.06, "cnt": 32}, "forward-send":{"total": 1.19, "avg": 0.59, "max": 0.54, "min": 0.64, "cnt": 2}, "forward-send-backward-recv":{"total": 269.90, "avg": 9.00, "max": 1.42, "min": 109.21, "cnt": 30}, "backward-compute":{"total": 1555.19, "avg": 48.60, "max": 46.62, "min": 52.12, "cnt": 32}, "MoE_L3_bwd":{"total": 411.56, "avg": 12.86, "max": 10.94, "min": 14.47, "cnt": 32}, "MoE_L2_bwd":{"total": 362.83, "avg": 11.34, "max": 10.46, "min": 13.88, "cnt": 32}, "MoE_L1_bwd":{"total": 285.27, "avg": 8.91, "max": 8.60, "min": 9.54, "cnt": 32}, "MoE_L0_bwd":{"total": 280.69, "avg": 8.77, "max": 8.39, "min": 9.01, "cnt": 32}, "backward-send-forward-recv":{"total": 3562.44, "avg": 122.84, "max": 2.40, "min": 544.54, "cnt": 29}, "backward-send":{"total": 3.34, "avg": 1.11, "max": 0.93, "min": 1.33, "cnt": 3}, "backward-recv":{"total": 132.57, "avg": 66.28, "max": 56.83, "min": 75.74, "cnt": 2}, "backward-params-all-reduce":{"total": 489.45, "avg": 489.45, "max": 489.45, "min": 489.45, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.04, "avg": 0.04, "max": 0.04, "min": 0.04, "cnt": 1}, "optimizer":{"total": 259.07, "avg": 259.07, "max": 259.07, "min": 259.07, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 219.14, "avg": 219.14, "max": 219.14, "min": 219.14, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.29, "avg": 3.29, "max": 3.29, "min": 3.29, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.48, "avg": 3.48, "max": 3.48, "min": 3.48, "cnt": 1}}}
{"type":"time", "iteration": 62, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 58.42, "avg": 19.47, "max": 0.98, "min": 55.15, "cnt": 3}, "forward-compute":{"total": 1851.79, "avg": 57.87, "max": 50.71, "min": 69.57, "cnt": 32}, "fwd-compute":{"total": 1848.58, "avg": 57.77, "max": 50.63, "min": 69.49, "cnt": 32}, "batch-generator":{"total": 43.62, "avg": 1.36, "max": 0.70, "min": 2.71, "cnt": 32}, "fwd-embedding":{"total": 0.68, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1791.99, "avg": 56.00, "max": 49.62, "min": 67.66, "cnt": 32}, "fwd-layernorm":{"total": 10.15, "avg": 0.08, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 109.84, "avg": 0.86, "max": 0.74, "min": 1.59, "cnt": 128}, "fwd-misc":{"total": 21.05, "avg": 0.16, "max": 0.11, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1629.92, "avg": 12.73, "max": 10.86, "min": 20.95, "cnt": 128}, "MoE_L0_fwd":{"total": 457.67, "avg": 14.30, "max": 10.77, "min": 18.84, "cnt": 32}, "MoEMLP":{"total": 1612.89, "avg": 12.60, "max": 10.73, "min": 20.85, "cnt": 128}, "MoE_L1_fwd":{"total": 374.85, "avg": 11.71, "max": 10.85, "min": 14.32, "cnt": 32}, "MoE_L2_fwd":{"total": 393.89, "avg": 12.31, "max": 11.39, "min": 18.20, "cnt": 32}, "MoE_L3_fwd":{"total": 392.68, "avg": 12.27, "max": 11.41, "min": 20.88, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.54, "avg": 0.77, "max": 0.68, "min": 0.85, "cnt": 2}, "forward-send-backward-recv":{"total": 188.83, "avg": 6.29, "max": 1.31, "min": 122.44, "cnt": 30}, "backward-compute":{"total": 1589.91, "avg": 49.68, "max": 46.33, "min": 52.52, "cnt": 32}, "MoE_L3_bwd":{"total": 427.64, "avg": 13.36, "max": 11.78, "min": 15.48, "cnt": 32}, "MoE_L2_bwd":{"total": 378.18, "avg": 11.82, "max": 11.07, "min": 12.83, "cnt": 32}, "MoE_L1_bwd":{"total": 285.18, "avg": 8.91, "max": 8.46, "min": 9.70, "cnt": 32}, "MoE_L0_bwd":{"total": 284.29, "avg": 8.88, "max": 8.02, "min": 9.61, "cnt": 32}, "backward-send-forward-recv":{"total": 4256.29, "avg": 146.77, "max": 1.74, "min": 545.05, "cnt": 29}, "backward-send":{"total": 2.08, "avg": 0.69, "max": 0.53, "min": 0.80, "cnt": 3}, "backward-recv":{"total": 136.65, "avg": 68.32, "max": 59.45, "min": 77.20, "cnt": 2}, "backward-params-all-reduce":{"total": 487.99, "avg": 487.99, "max": 487.99, "min": 487.99, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 251.70, "avg": 251.70, "max": 251.70, "min": 251.70, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 211.52, "avg": 211.52, "max": 211.52, "min": 211.52, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.61, "avg": 3.61, "max": 3.61, "min": 3.61, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 63, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 102.65, "avg": 34.22, "max": 0.87, "min": 100.43, "cnt": 3}, "forward-compute":{"total": 1844.12, "avg": 57.63, "max": 50.28, "min": 62.58, "cnt": 32}, "fwd-compute":{"total": 1841.02, "avg": 57.53, "max": 50.22, "min": 62.48, "cnt": 32}, "batch-generator":{"total": 43.04, "avg": 1.35, "max": 0.63, "min": 2.65, "cnt": 32}, "fwd-embedding":{"total": 0.60, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1786.00, "avg": 55.81, "max": 49.31, "min": 60.83, "cnt": 32}, "fwd-layernorm":{"total": 9.58, "avg": 0.07, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 108.60, "avg": 0.85, "max": 0.74, "min": 1.48, "cnt": 128}, "fwd-misc":{"total": 20.49, "avg": 0.16, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1627.04, "avg": 12.71, "max": 10.79, "min": 18.95, "cnt": 128}, "MoE_L0_fwd":{"total": 457.84, "avg": 14.31, "max": 10.78, "min": 18.85, "cnt": 32}, "MoEMLP":{"total": 1610.63, "avg": 12.58, "max": 10.67, "min": 18.80, "cnt": 128}, "MoE_L1_fwd":{"total": 370.58, "avg": 11.58, "max": 10.71, "min": 13.01, "cnt": 32}, "MoE_L2_fwd":{"total": 395.36, "avg": 12.36, "max": 11.61, "min": 13.14, "cnt": 32}, "MoE_L3_fwd":{"total": 392.82, "avg": 12.28, "max": 11.55, "min": 15.64, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.56, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.65, "avg": 0.83, "max": 0.74, "min": 0.91, "cnt": 2}, "forward-send-backward-recv":{"total": 389.23, "avg": 12.97, "max": 1.23, "min": 122.06, "cnt": 30}, "backward-compute":{"total": 1594.67, "avg": 49.83, "max": 47.00, "min": 51.67, "cnt": 32}, "MoE_L3_bwd":{"total": 427.77, "avg": 13.37, "max": 11.84, "min": 15.08, "cnt": 32}, "MoE_L2_bwd":{"total": 381.19, "avg": 11.91, "max": 11.25, "min": 12.49, "cnt": 32}, "MoE_L1_bwd":{"total": 294.82, "avg": 9.21, "max": 8.52, "min": 9.73, "cnt": 32}, "MoE_L0_bwd":{"total": 278.51, "avg": 8.70, "max": 8.17, "min": 9.32, "cnt": 32}, "backward-send-forward-recv":{"total": 5489.95, "avg": 189.31, "max": 2.27, "min": 512.59, "cnt": 29}, "backward-send":{"total": 2.86, "avg": 0.95, "max": 0.90, "min": 1.06, "cnt": 3}, "backward-recv":{"total": 132.11, "avg": 66.05, "max": 60.35, "min": 71.76, "cnt": 2}, "backward-params-all-reduce":{"total": 490.99, "avg": 490.99, "max": 490.99, "min": 490.99, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 257.18, "avg": 257.18, "max": 257.18, "min": 257.18, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 217.20, "avg": 217.20, "max": 217.20, "min": 217.20, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.47, "avg": 3.47, "max": 3.47, "min": 3.47, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 64, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 70.86, "avg": 23.62, "max": 0.72, "min": 62.11, "cnt": 3}, "forward-compute":{"total": 1816.05, "avg": 56.75, "max": 49.58, "min": 64.61, "cnt": 32}, "fwd-compute":{"total": 1813.02, "avg": 56.66, "max": 49.51, "min": 64.52, "cnt": 32}, "batch-generator":{"total": 48.18, "avg": 1.51, "max": 0.65, "min": 3.88, "cnt": 32}, "fwd-embedding":{"total": 0.57, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1752.80, "avg": 54.78, "max": 48.58, "min": 63.00, "cnt": 32}, "fwd-layernorm":{"total": 9.63, "avg": 0.08, "max": 0.05, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 106.68, "avg": 0.83, "max": 0.74, "min": 1.47, "cnt": 128}, "fwd-misc":{"total": 20.70, "avg": 0.16, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1595.13, "avg": 12.46, "max": 9.98, "min": 17.70, "cnt": 128}, "MoE_L0_fwd":{"total": 432.81, "avg": 13.53, "max": 9.91, "min": 17.62, "cnt": 32}, "MoEMLP":{"total": 1578.47, "avg": 12.33, "max": 9.87, "min": 17.57, "cnt": 128}, "MoE_L1_fwd":{"total": 370.53, "avg": 11.58, "max": 10.36, "min": 15.05, "cnt": 32}, "MoE_L2_fwd":{"total": 383.70, "avg": 11.99, "max": 11.49, "min": 13.73, "cnt": 32}, "MoE_L3_fwd":{"total": 397.48, "avg": 12.42, "max": 11.56, "min": 17.41, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 5.25, "avg": 2.62, "max": 0.72, "min": 4.52, "cnt": 2}, "forward-send-backward-recv":{"total": 174.76, "avg": 5.83, "max": 1.29, "min": 107.80, "cnt": 30}, "backward-compute":{"total": 1583.30, "avg": 49.48, "max": 45.63, "min": 51.93, "cnt": 32}, "MoE_L3_bwd":{"total": 429.21, "avg": 13.41, "max": 11.81, "min": 15.35, "cnt": 32}, "MoE_L2_bwd":{"total": 366.69, "avg": 11.46, "max": 10.83, "min": 12.24, "cnt": 32}, "MoE_L1_bwd":{"total": 297.66, "avg": 9.30, "max": 8.44, "min": 10.39, "cnt": 32}, "MoE_L0_bwd":{"total": 276.71, "avg": 8.65, "max": 8.05, "min": 9.07, "cnt": 32}, "backward-send-forward-recv":{"total": 4827.81, "avg": 166.48, "max": 2.20, "min": 609.15, "cnt": 29}, "backward-send":{"total": 2.67, "avg": 0.89, "max": 0.65, "min": 1.07, "cnt": 3}, "backward-recv":{"total": 116.78, "avg": 58.39, "max": 46.62, "min": 70.17, "cnt": 2}, "backward-params-all-reduce":{"total": 490.68, "avg": 490.68, "max": 490.68, "min": 490.68, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 250.64, "avg": 250.64, "max": 250.64, "min": 250.64, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 210.61, "avg": 210.61, "max": 210.61, "min": 210.61, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.56, "avg": 3.56, "max": 3.56, "min": 3.56, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.48, "avg": 3.48, "max": 3.48, "min": 3.48, "cnt": 1}}}
{"type":"time", "iteration": 65, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 59.95, "avg": 19.98, "max": 0.75, "min": 58.04, "cnt": 3}, "forward-compute":{"total": 1813.49, "avg": 56.67, "max": 49.32, "min": 64.37, "cnt": 32}, "fwd-compute":{"total": 1810.67, "avg": 56.58, "max": 49.26, "min": 64.30, "cnt": 32}, "batch-generator":{"total": 39.18, "avg": 1.22, "max": 0.65, "min": 2.61, "cnt": 32}, "fwd-embedding":{"total": 0.52, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1760.01, "avg": 55.00, "max": 48.31, "min": 62.20, "cnt": 32}, "fwd-layernorm":{"total": 9.25, "avg": 0.07, "max": 0.06, "min": 0.18, "cnt": 128}, "fwd-attn":{"total": 106.59, "avg": 0.83, "max": 0.75, "min": 1.52, "cnt": 128}, "fwd-misc":{"total": 20.07, "avg": 0.16, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1604.14, "avg": 12.53, "max": 9.73, "min": 19.75, "cnt": 128}, "MoE_L0_fwd":{"total": 442.19, "avg": 13.82, "max": 9.65, "min": 19.66, "cnt": 32}, "MoEMLP":{"total": 1587.46, "avg": 12.40, "max": 9.61, "min": 19.62, "cnt": 128}, "MoE_L1_fwd":{"total": 365.36, "avg": 11.42, "max": 10.10, "min": 15.14, "cnt": 32}, "MoE_L2_fwd":{"total": 401.16, "avg": 12.54, "max": 11.98, "min": 13.93, "cnt": 32}, "MoE_L3_fwd":{"total": 384.72, "avg": 12.02, "max": 11.48, "min": 14.10, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 6.66, "avg": 3.33, "max": 0.90, "min": 5.75, "cnt": 2}, "forward-send-backward-recv":{"total": 215.39, "avg": 7.18, "max": 1.58, "min": 149.13, "cnt": 30}, "backward-compute":{"total": 1607.22, "avg": 50.23, "max": 47.57, "min": 52.88, "cnt": 32}, "MoE_L3_bwd":{"total": 425.21, "avg": 13.29, "max": 11.88, "min": 15.36, "cnt": 32}, "MoE_L2_bwd":{"total": 395.24, "avg": 12.35, "max": 11.74, "min": 14.23, "cnt": 32}, "MoE_L1_bwd":{"total": 292.53, "avg": 9.14, "max": 8.69, "min": 9.58, "cnt": 32}, "MoE_L0_bwd":{"total": 281.26, "avg": 8.79, "max": 8.54, "min": 9.09, "cnt": 32}, "backward-send-forward-recv":{"total": 4001.77, "avg": 137.99, "max": 1.78, "min": 742.73, "cnt": 29}, "backward-send":{"total": 3.32, "avg": 1.11, "max": 1.07, "min": 1.15, "cnt": 3}, "backward-recv":{"total": 122.87, "avg": 61.44, "max": 57.63, "min": 65.24, "cnt": 2}, "backward-params-all-reduce":{"total": 515.36, "avg": 515.36, "max": 515.36, "min": 515.36, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 252.46, "avg": 252.46, "max": 252.46, "min": 252.46, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.36, "avg": 3.36, "max": 3.36, "min": 3.36, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 212.78, "avg": 212.78, "max": 212.78, "min": 212.78, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.29, "avg": 3.29, "max": 3.29, "min": 3.29, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 66, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.06, "avg": 0.06, "max": 0.06, "min": 0.06, "cnt": 1}, "forward-recv":{"total": 67.01, "avg": 22.34, "max": 0.90, "min": 62.58, "cnt": 3}, "forward-compute":{"total": 1864.08, "avg": 58.25, "max": 51.37, "min": 66.64, "cnt": 32}, "fwd-compute":{"total": 1860.99, "avg": 58.16, "max": 51.29, "min": 66.54, "cnt": 32}, "batch-generator":{"total": 38.93, "avg": 1.22, "max": 0.66, "min": 1.90, "cnt": 32}, "fwd-embedding":{"total": 0.59, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1809.88, "avg": 56.56, "max": 50.17, "min": 65.09, "cnt": 32}, "fwd-layernorm":{"total": 9.77, "avg": 0.08, "max": 0.05, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 106.50, "avg": 0.83, "max": 0.74, "min": 1.96, "cnt": 128}, "fwd-misc":{"total": 20.78, "avg": 0.16, "max": 0.11, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1652.49, "avg": 12.91, "max": 10.19, "min": 18.17, "cnt": 128}, "MoE_L0_fwd":{"total": 461.72, "avg": 14.43, "max": 10.37, "min": 18.10, "cnt": 32}, "MoEMLP":{"total": 1635.50, "avg": 12.78, "max": 10.08, "min": 18.05, "cnt": 128}, "MoE_L1_fwd":{"total": 372.10, "avg": 11.63, "max": 10.12, "min": 13.69, "cnt": 32}, "MoE_L2_fwd":{"total": 412.77, "avg": 12.90, "max": 12.34, "min": 13.60, "cnt": 32}, "MoE_L3_fwd":{"total": 395.07, "avg": 12.35, "max": 11.82, "min": 16.10, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 2.38, "avg": 1.19, "max": 0.99, "min": 1.39, "cnt": 2}, "forward-send-backward-recv":{"total": 675.63, "avg": 22.52, "max": 1.63, "min": 189.78, "cnt": 30}, "backward-compute":{"total": 1639.59, "avg": 51.24, "max": 49.23, "min": 53.85, "cnt": 32}, "MoE_L3_bwd":{"total": 421.34, "avg": 13.17, "max": 12.14, "min": 15.67, "cnt": 32}, "MoE_L2_bwd":{"total": 424.44, "avg": 13.26, "max": 12.66, "min": 15.27, "cnt": 32}, "MoE_L1_bwd":{"total": 289.73, "avg": 9.05, "max": 8.16, "min": 9.55, "cnt": 32}, "MoE_L0_bwd":{"total": 283.25, "avg": 8.85, "max": 7.99, "min": 9.30, "cnt": 32}, "backward-send-forward-recv":{"total": 2553.16, "avg": 88.04, "max": 2.08, "min": 300.15, "cnt": 29}, "backward-send":{"total": 2.75, "avg": 0.92, "max": 0.79, "min": 1.06, "cnt": 3}, "backward-recv":{"total": 284.65, "avg": 142.33, "max": 85.27, "min": 199.38, "cnt": 2}, "backward-params-all-reduce":{"total": 482.96, "avg": 482.96, "max": 482.96, "min": 482.96, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 256.46, "avg": 256.46, "max": 256.46, "min": 256.46, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 216.65, "avg": 216.65, "max": 216.65, "min": 216.65, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.34, "avg": 3.34, "max": 3.34, "min": 3.34, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 67, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 64.09, "avg": 21.36, "max": 1.14, "min": 61.73, "cnt": 3}, "forward-compute":{"total": 1895.98, "avg": 59.25, "max": 52.32, "min": 68.84, "cnt": 32}, "fwd-compute":{"total": 1893.12, "avg": 59.16, "max": 52.24, "min": 68.77, "cnt": 32}, "batch-generator":{"total": 37.93, "avg": 1.19, "max": 0.69, "min": 2.78, "cnt": 32}, "fwd-embedding":{"total": 0.52, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1843.35, "avg": 57.60, "max": 50.46, "min": 67.19, "cnt": 32}, "fwd-layernorm":{"total": 9.01, "avg": 0.07, "max": 0.06, "min": 0.18, "cnt": 128}, "fwd-attn":{"total": 104.75, "avg": 0.82, "max": 0.74, "min": 1.51, "cnt": 128}, "fwd-misc":{"total": 19.68, "avg": 0.15, "max": 0.11, "min": 0.34, "cnt": 128}, "fwd-MLP":{"total": 1690.19, "avg": 13.20, "max": 10.21, "min": 22.99, "cnt": 128}, "MoE_L0_fwd":{"total": 458.30, "avg": 14.32, "max": 10.45, "min": 22.91, "cnt": 32}, "MoEMLP":{"total": 1673.19, "avg": 13.07, "max": 10.10, "min": 22.87, "cnt": 128}, "MoE_L1_fwd":{"total": 375.64, "avg": 11.74, "max": 10.14, "min": 15.74, "cnt": 32}, "MoE_L2_fwd":{"total": 428.84, "avg": 13.40, "max": 12.34, "min": 17.53, "cnt": 32}, "MoE_L3_fwd":{"total": 416.37, "avg": 13.01, "max": 12.14, "min": 16.78, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.67, "avg": 0.84, "max": 0.68, "min": 0.99, "cnt": 2}, "forward-send-backward-recv":{"total": 150.09, "avg": 5.00, "max": 1.35, "min": 91.08, "cnt": 30}, "backward-compute":{"total": 1638.42, "avg": 51.20, "max": 48.14, "min": 52.91, "cnt": 32}, "MoE_L3_bwd":{"total": 431.11, "avg": 13.47, "max": 12.26, "min": 16.11, "cnt": 32}, "MoE_L2_bwd":{"total": 419.69, "avg": 13.12, "max": 12.28, "min": 14.04, "cnt": 32}, "MoE_L1_bwd":{"total": 292.87, "avg": 9.15, "max": 8.35, "min": 9.64, "cnt": 32}, "MoE_L0_bwd":{"total": 282.86, "avg": 8.84, "max": 8.26, "min": 9.32, "cnt": 32}, "backward-send-forward-recv":{"total": 2845.00, "avg": 98.10, "max": 1.63, "min": 439.77, "cnt": 29}, "backward-send":{"total": 3.03, "avg": 1.01, "max": 0.99, "min": 1.02, "cnt": 3}, "backward-recv":{"total": 129.92, "avg": 64.96, "max": 58.66, "min": 71.26, "cnt": 2}, "backward-params-all-reduce":{"total": 490.85, "avg": 490.85, "max": 490.85, "min": 490.85, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 254.08, "avg": 254.08, "max": 254.08, "min": 254.08, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 214.05, "avg": 214.05, "max": 214.05, "min": 214.05, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.51, "avg": 3.51, "max": 3.51, "min": 3.51, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 68, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.06, "avg": 0.06, "max": 0.06, "min": 0.06, "cnt": 1}, "forward-recv":{"total": 64.47, "avg": 21.49, "max": 0.83, "min": 62.46, "cnt": 3}, "forward-compute":{"total": 1833.50, "avg": 57.30, "max": 51.20, "min": 67.73, "cnt": 32}, "fwd-compute":{"total": 1830.89, "avg": 57.22, "max": 51.14, "min": 67.64, "cnt": 32}, "batch-generator":{"total": 37.83, "avg": 1.18, "max": 0.65, "min": 3.11, "cnt": 32}, "fwd-embedding":{"total": 0.49, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1781.63, "avg": 55.68, "max": 50.22, "min": 64.05, "cnt": 32}, "fwd-layernorm":{"total": 8.78, "avg": 0.07, "max": 0.05, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 103.24, "avg": 0.81, "max": 0.74, "min": 1.55, "cnt": 128}, "fwd-misc":{"total": 18.90, "avg": 0.15, "max": 0.11, "min": 0.38, "cnt": 128}, "fwd-MLP":{"total": 1631.71, "avg": 12.75, "max": 10.09, "min": 18.25, "cnt": 128}, "MoE_L0_fwd":{"total": 428.48, "avg": 13.39, "max": 10.46, "min": 18.16, "cnt": 32}, "MoEMLP":{"total": 1616.26, "avg": 12.63, "max": 9.99, "min": 18.11, "cnt": 128}, "MoE_L1_fwd":{"total": 362.97, "avg": 11.34, "max": 10.03, "min": 14.87, "cnt": 32}, "MoE_L2_fwd":{"total": 410.88, "avg": 12.84, "max": 12.07, "min": 17.48, "cnt": 32}, "MoE_L3_fwd":{"total": 419.68, "avg": 13.11, "max": 12.29, "min": 15.73, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 8.57, "avg": 4.29, "max": 0.97, "min": 7.60, "cnt": 2}, "forward-send-backward-recv":{"total": 414.01, "avg": 13.80, "max": 1.71, "min": 120.09, "cnt": 30}, "backward-compute":{"total": 1633.23, "avg": 51.04, "max": 47.78, "min": 52.84, "cnt": 32}, "MoE_L3_bwd":{"total": 437.38, "avg": 13.67, "max": 12.06, "min": 15.45, "cnt": 32}, "MoE_L2_bwd":{"total": 408.65, "avg": 12.77, "max": 12.37, "min": 13.56, "cnt": 32}, "MoE_L1_bwd":{"total": 292.01, "avg": 9.13, "max": 8.37, "min": 9.52, "cnt": 32}, "MoE_L0_bwd":{"total": 282.69, "avg": 8.83, "max": 8.13, "min": 9.31, "cnt": 32}, "backward-send-forward-recv":{"total": 3674.13, "avg": 126.69, "max": 2.56, "min": 701.40, "cnt": 29}, "backward-send":{"total": 1.94, "avg": 0.65, "max": 0.50, "min": 0.73, "cnt": 3}, "backward-recv":{"total": 219.05, "avg": 109.53, "max": 58.19, "min": 160.86, "cnt": 2}, "backward-params-all-reduce":{"total": 486.22, "avg": 486.22, "max": 486.22, "min": 486.22, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 254.15, "avg": 254.15, "max": 254.15, "min": 254.15, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 214.35, "avg": 214.35, "max": 214.35, "min": 214.35, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.32, "avg": 3.32, "max": 3.32, "min": 3.32, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 69, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 66.00, "avg": 22.00, "max": 0.94, "min": 63.96, "cnt": 3}, "forward-compute":{"total": 1844.93, "avg": 57.65, "max": 52.52, "min": 65.71, "cnt": 32}, "fwd-compute":{"total": 1842.02, "avg": 57.56, "max": 52.43, "min": 65.64, "cnt": 32}, "batch-generator":{"total": 39.54, "avg": 1.24, "max": 0.71, "min": 2.49, "cnt": 32}, "fwd-embedding":{"total": 0.52, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1790.84, "avg": 55.96, "max": 51.17, "min": 64.56, "cnt": 32}, "fwd-layernorm":{"total": 9.19, "avg": 0.07, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 105.46, "avg": 0.82, "max": 0.74, "min": 1.50, "cnt": 128}, "fwd-misc":{"total": 19.90, "avg": 0.16, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1636.47, "avg": 12.78, "max": 10.42, "min": 21.71, "cnt": 128}, "MoE_L0_fwd":{"total": 437.44, "avg": 13.67, "max": 10.55, "min": 21.64, "cnt": 32}, "MoEMLP":{"total": 1620.14, "avg": 12.66, "max": 10.31, "min": 21.59, "cnt": 128}, "MoE_L1_fwd":{"total": 371.30, "avg": 11.60, "max": 10.35, "min": 14.55, "cnt": 32}, "MoE_L2_fwd":{"total": 403.22, "avg": 12.60, "max": 11.94, "min": 13.81, "cnt": 32}, "MoE_L3_fwd":{"total": 414.12, "avg": 12.94, "max": 12.25, "min": 16.29, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.52, "avg": 0.76, "max": 0.69, "min": 0.84, "cnt": 2}, "forward-send-backward-recv":{"total": 686.42, "avg": 22.88, "max": 1.27, "min": 152.60, "cnt": 30}, "backward-compute":{"total": 1635.73, "avg": 51.12, "max": 49.07, "min": 53.75, "cnt": 32}, "MoE_L3_bwd":{"total": 438.92, "avg": 13.72, "max": 12.37, "min": 15.36, "cnt": 32}, "MoE_L2_bwd":{"total": 407.75, "avg": 12.74, "max": 11.92, "min": 14.46, "cnt": 32}, "MoE_L1_bwd":{"total": 291.85, "avg": 9.12, "max": 8.81, "min": 9.73, "cnt": 32}, "MoE_L0_bwd":{"total": 282.41, "avg": 8.83, "max": 8.32, "min": 9.13, "cnt": 32}, "backward-send-forward-recv":{"total": 3113.88, "avg": 107.38, "max": 1.49, "min": 285.62, "cnt": 29}, "backward-send":{"total": 2.39, "avg": 0.80, "max": 0.53, "min": 1.05, "cnt": 3}, "backward-recv":{"total": 356.93, "avg": 178.46, "max": 68.27, "min": 288.66, "cnt": 2}, "backward-params-all-reduce":{"total": 488.44, "avg": 488.44, "max": 488.44, "min": 488.44, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 253.37, "avg": 253.37, "max": 253.37, "min": 253.37, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 213.37, "avg": 213.37, "max": 213.37, "min": 213.37, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 70, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.06, "avg": 0.06, "max": 0.06, "min": 0.06, "cnt": 1}, "forward-recv":{"total": 343.90, "avg": 114.63, "max": 0.92, "min": 341.79, "cnt": 3}, "forward-compute":{"total": 1974.20, "avg": 61.69, "max": 50.71, "min": 199.43, "cnt": 32}, "fwd-compute":{"total": 1971.15, "avg": 61.60, "max": 50.63, "min": 199.35, "cnt": 32}, "batch-generator":{"total": 40.27, "avg": 1.26, "max": 0.71, "min": 2.00, "cnt": 32}, "fwd-embedding":{"total": 0.60, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1918.82, "avg": 59.96, "max": 49.30, "min": 198.24, "cnt": 32}, "fwd-layernorm":{"total": 9.84, "avg": 0.08, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 108.46, "avg": 0.85, "max": 0.74, "min": 1.52, "cnt": 128}, "fwd-misc":{"total": 21.00, "avg": 0.16, "max": 0.11, "min": 0.34, "cnt": 128}, "fwd-MLP":{"total": 1758.48, "avg": 13.74, "max": 10.26, "min": 137.31, "cnt": 128}, "MoE_L0_fwd":{"total": 469.39, "avg": 14.67, "max": 10.99, "min": 18.09, "cnt": 32}, "MoEMLP":{"total": 1741.38, "avg": 13.60, "max": 10.15, "min": 137.20, "cnt": 128}, "MoE_L1_fwd":{"total": 373.79, "avg": 11.68, "max": 10.19, "min": 14.88, "cnt": 32}, "MoE_L2_fwd":{"total": 476.98, "avg": 14.91, "max": 10.36, "min": 137.24, "cnt": 32}, "MoE_L3_fwd":{"total": 427.42, "avg": 13.36, "max": 12.44, "min": 27.36, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 159.02, "avg": 79.51, "max": 0.67, "min": 158.34, "cnt": 2}, "forward-send-backward-recv":{"total": 242.44, "avg": 8.08, "max": 1.80, "min": 115.60, "cnt": 30}, "backward-compute":{"total": 1539.58, "avg": 48.11, "max": 44.88, "min": 51.47, "cnt": 32}, "MoE_L3_bwd":{"total": 446.57, "avg": 13.96, "max": 12.61, "min": 17.74, "cnt": 32}, "MoE_L2_bwd":{"total": 303.20, "avg": 9.47, "max": 8.52, "min": 11.50, "cnt": 32}, "MoE_L1_bwd":{"total": 293.17, "avg": 9.16, "max": 8.73, "min": 10.43, "cnt": 32}, "MoE_L0_bwd":{"total": 285.39, "avg": 8.92, "max": 8.30, "min": 9.20, "cnt": 32}, "backward-send-forward-recv":{"total": 3010.33, "avg": 103.80, "max": 1.78, "min": 329.58, "cnt": 29}, "backward-send":{"total": 3.19, "avg": 1.06, "max": 0.99, "min": 1.13, "cnt": 3}, "backward-recv":{"total": 358.05, "avg": 179.02, "max": 75.94, "min": 282.11, "cnt": 2}, "backward-params-all-reduce":{"total": 483.09, "avg": 483.09, "max": 483.09, "min": 483.09, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 248.44, "avg": 248.44, "max": 248.44, "min": 248.44, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 208.65, "avg": 208.65, "max": 208.65, "min": 208.65, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.33, "avg": 3.33, "max": 3.33, "min": 3.33, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.47, "avg": 3.47, "max": 3.47, "min": 3.47, "cnt": 1}}}
{"type":"time", "iteration": 71, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.06, "avg": 0.06, "max": 0.06, "min": 0.06, "cnt": 1}, "forward-recv":{"total": 69.81, "avg": 23.27, "max": 0.96, "min": 63.25, "cnt": 3}, "forward-compute":{"total": 1836.84, "avg": 57.40, "max": 50.48, "min": 63.52, "cnt": 32}, "fwd-compute":{"total": 1833.73, "avg": 57.30, "max": 50.41, "min": 63.40, "cnt": 32}, "batch-generator":{"total": 53.96, "avg": 1.69, "max": 0.62, "min": 3.99, "cnt": 32}, "fwd-embedding":{"total": 0.69, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1767.26, "avg": 55.23, "max": 49.51, "min": 61.43, "cnt": 32}, "fwd-layernorm":{"total": 10.31, "avg": 0.08, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 111.04, "avg": 0.87, "max": 0.74, "min": 2.30, "cnt": 128}, "fwd-misc":{"total": 21.74, "avg": 0.17, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1602.71, "avg": 12.52, "max": 10.25, "min": 19.11, "cnt": 128}, "MoE_L0_fwd":{"total": 449.04, "avg": 14.03, "max": 10.74, "min": 19.03, "cnt": 32}, "MoEMLP":{"total": 1585.17, "avg": 12.38, "max": 10.14, "min": 18.99, "cnt": 128}, "MoE_L1_fwd":{"total": 367.28, "avg": 11.48, "max": 10.18, "min": 13.22, "cnt": 32}, "MoE_L2_fwd":{"total": 363.79, "avg": 11.37, "max": 10.68, "min": 13.48, "cnt": 32}, "MoE_L3_fwd":{"total": 411.48, "avg": 12.86, "max": 12.30, "min": 14.68, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.56, "avg": 0.78, "max": 0.65, "min": 0.90, "cnt": 2}, "forward-send-backward-recv":{"total": 182.19, "avg": 6.07, "max": 1.39, "min": 95.28, "cnt": 30}, "backward-compute":{"total": 1560.00, "avg": 48.75, "max": 46.20, "min": 51.70, "cnt": 32}, "MoE_L3_bwd":{"total": 440.30, "avg": 13.76, "max": 12.89, "min": 15.95, "cnt": 32}, "MoE_L2_bwd":{"total": 327.10, "avg": 10.22, "max": 9.26, "min": 11.22, "cnt": 32}, "MoE_L1_bwd":{"total": 289.82, "avg": 9.06, "max": 8.52, "min": 10.87, "cnt": 32}, "MoE_L0_bwd":{"total": 289.41, "avg": 9.04, "max": 8.57, "min": 10.44, "cnt": 32}, "backward-send-forward-recv":{"total": 2985.71, "avg": 102.96, "max": 2.31, "min": 304.16, "cnt": 29}, "backward-send":{"total": 2.62, "avg": 0.87, "max": 0.57, "min": 1.08, "cnt": 3}, "backward-recv":{"total": 191.86, "avg": 95.93, "max": 72.57, "min": 119.29, "cnt": 2}, "backward-params-all-reduce":{"total": 487.52, "avg": 487.52, "max": 487.52, "min": 487.52, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 246.17, "avg": 246.17, "max": 246.17, "min": 246.17, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 206.25, "avg": 206.25, "max": 206.25, "min": 206.25, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 72, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 63.62, "avg": 21.21, "max": 1.04, "min": 61.26, "cnt": 3}, "forward-compute":{"total": 1818.08, "avg": 56.82, "max": 50.21, "min": 61.75, "cnt": 32}, "fwd-compute":{"total": 1814.94, "avg": 56.72, "max": 50.13, "min": 61.67, "cnt": 32}, "batch-generator":{"total": 40.68, "avg": 1.27, "max": 0.72, "min": 2.13, "cnt": 32}, "fwd-embedding":{"total": 0.60, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1762.03, "avg": 55.06, "max": 49.08, "min": 59.97, "cnt": 32}, "fwd-layernorm":{"total": 9.94, "avg": 0.08, "max": 0.05, "min": 0.18, "cnt": 128}, "fwd-attn":{"total": 109.25, "avg": 0.85, "max": 0.74, "min": 1.44, "cnt": 128}, "fwd-misc":{"total": 21.24, "avg": 0.17, "max": 0.11, "min": 0.34, "cnt": 128}, "fwd-MLP":{"total": 1599.85, "avg": 12.50, "max": 10.05, "min": 18.16, "cnt": 128}, "MoE_L0_fwd":{"total": 450.87, "avg": 14.09, "max": 10.76, "min": 18.06, "cnt": 32}, "MoEMLP":{"total": 1582.21, "avg": 12.36, "max": 9.93, "min": 18.02, "cnt": 128}, "MoE_L1_fwd":{"total": 361.53, "avg": 11.30, "max": 9.98, "min": 13.52, "cnt": 32}, "MoE_L2_fwd":{"total": 364.14, "avg": 11.38, "max": 10.68, "min": 13.34, "cnt": 32}, "MoE_L3_fwd":{"total": 411.97, "avg": 12.87, "max": 12.13, "min": 14.96, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.62, "avg": 0.02, "max": 0.02, "min": 0.05, "cnt": 32}, "forward-send":{"total": 7.58, "avg": 3.79, "max": 0.89, "min": 6.69, "cnt": 2}, "forward-send-backward-recv":{"total": 182.12, "avg": 6.07, "max": 1.52, "min": 113.34, "cnt": 30}, "backward-compute":{"total": 1544.93, "avg": 48.28, "max": 45.62, "min": 50.77, "cnt": 32}, "MoE_L3_bwd":{"total": 439.98, "avg": 13.75, "max": 12.62, "min": 14.41, "cnt": 32}, "MoE_L2_bwd":{"total": 319.90, "avg": 10.00, "max": 9.33, "min": 12.03, "cnt": 32}, "MoE_L1_bwd":{"total": 285.63, "avg": 8.93, "max": 8.57, "min": 9.92, "cnt": 32}, "MoE_L0_bwd":{"total": 286.35, "avg": 8.95, "max": 8.22, "min": 9.28, "cnt": 32}, "backward-send-forward-recv":{"total": 3234.17, "avg": 111.52, "max": 2.15, "min": 384.08, "cnt": 29}, "backward-send":{"total": 2.49, "avg": 0.83, "max": 0.64, "min": 0.98, "cnt": 3}, "backward-recv":{"total": 127.50, "avg": 63.75, "max": 58.93, "min": 68.57, "cnt": 2}, "backward-params-all-reduce":{"total": 489.79, "avg": 489.79, "max": 489.79, "min": 489.79, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 246.92, "avg": 246.92, "max": 246.92, "min": 246.92, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 207.05, "avg": 207.05, "max": 207.05, "min": 207.05, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.25, "avg": 3.25, "max": 3.25, "min": 3.25, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.50, "avg": 3.50, "max": 3.50, "min": 3.50, "cnt": 1}}}
{"type":"time", "iteration": 73, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 62.44, "avg": 20.81, "max": 0.95, "min": 56.25, "cnt": 3}, "forward-compute":{"total": 1852.38, "avg": 57.89, "max": 50.11, "min": 66.31, "cnt": 32}, "fwd-compute":{"total": 1849.23, "avg": 57.79, "max": 50.04, "min": 66.23, "cnt": 32}, "batch-generator":{"total": 47.74, "avg": 1.49, "max": 0.67, "min": 2.69, "cnt": 32}, "fwd-embedding":{"total": 0.65, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1788.52, "avg": 55.89, "max": 49.06, "min": 64.15, "cnt": 32}, "fwd-layernorm":{"total": 10.03, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 110.70, "avg": 0.86, "max": 0.74, "min": 2.00, "cnt": 128}, "fwd-misc":{"total": 21.03, "avg": 0.16, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1625.74, "avg": 12.70, "max": 10.37, "min": 21.86, "cnt": 128}, "MoE_L0_fwd":{"total": 467.21, "avg": 14.60, "max": 10.55, "min": 21.78, "cnt": 32}, "MoEMLP":{"total": 1608.71, "avg": 12.57, "max": 10.25, "min": 21.73, "cnt": 128}, "MoE_L1_fwd":{"total": 372.03, "avg": 11.63, "max": 10.29, "min": 16.20, "cnt": 32}, "MoE_L2_fwd":{"total": 358.38, "avg": 11.20, "max": 10.62, "min": 12.35, "cnt": 32}, "MoE_L3_fwd":{"total": 417.33, "avg": 13.04, "max": 12.35, "min": 15.89, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.87, "avg": 0.93, "max": 0.86, "min": 1.00, "cnt": 2}, "forward-send-backward-recv":{"total": 169.85, "avg": 5.66, "max": 1.31, "min": 103.58, "cnt": 30}, "backward-compute":{"total": 1541.34, "avg": 48.17, "max": 45.88, "min": 49.64, "cnt": 32}, "MoE_L3_bwd":{"total": 452.90, "avg": 14.15, "max": 12.55, "min": 15.22, "cnt": 32}, "MoE_L2_bwd":{"total": 313.23, "avg": 9.79, "max": 9.18, "min": 11.33, "cnt": 32}, "MoE_L1_bwd":{"total": 282.25, "avg": 8.82, "max": 8.42, "min": 9.48, "cnt": 32}, "MoE_L0_bwd":{"total": 281.12, "avg": 8.79, "max": 8.39, "min": 9.14, "cnt": 32}, "backward-send-forward-recv":{"total": 4619.75, "avg": 159.30, "max": 1.87, "min": 856.61, "cnt": 29}, "backward-send":{"total": 2.21, "avg": 0.74, "max": 0.55, "min": 0.94, "cnt": 3}, "backward-recv":{"total": 126.00, "avg": 63.00, "max": 61.62, "min": 64.38, "cnt": 2}, "backward-params-all-reduce":{"total": 487.40, "avg": 487.40, "max": 487.40, "min": 487.40, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 244.26, "avg": 244.26, "max": 244.26, "min": 244.26, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 202.34, "avg": 202.34, "max": 202.34, "min": 202.34, "cnt": 1}, "optimizer-clip-main-grad":{"total": 5.44, "avg": 5.44, "max": 5.44, "min": 5.44, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 74, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 53.42, "avg": 17.81, "max": 0.81, "min": 51.51, "cnt": 3}, "forward-compute":{"total": 1898.05, "avg": 59.31, "max": 51.09, "min": 66.51, "cnt": 32}, "fwd-compute":{"total": 1894.66, "avg": 59.21, "max": 51.02, "min": 66.31, "cnt": 32}, "batch-generator":{"total": 44.15, "avg": 1.38, "max": 0.67, "min": 2.08, "cnt": 32}, "fwd-embedding":{"total": 0.70, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1837.21, "avg": 57.41, "max": 49.97, "min": 64.79, "cnt": 32}, "fwd-layernorm":{"total": 10.89, "avg": 0.09, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 115.64, "avg": 0.90, "max": 0.74, "min": 1.94, "cnt": 128}, "fwd-misc":{"total": 23.19, "avg": 0.18, "max": 0.11, "min": 0.69, "cnt": 128}, "fwd-MLP":{"total": 1664.51, "avg": 13.00, "max": 10.29, "min": 22.11, "cnt": 128}, "MoE_L0_fwd":{"total": 497.87, "avg": 15.56, "max": 11.44, "min": 22.00, "cnt": 32}, "MoEMLP":{"total": 1645.93, "avg": 12.86, "max": 10.18, "min": 21.95, "cnt": 128}, "MoE_L1_fwd":{"total": 371.15, "avg": 11.60, "max": 10.23, "min": 13.76, "cnt": 32}, "MoE_L2_fwd":{"total": 362.46, "avg": 11.33, "max": 10.63, "min": 12.07, "cnt": 32}, "MoE_L3_fwd":{"total": 421.21, "avg": 13.16, "max": 12.32, "min": 15.02, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 8.89, "avg": 4.45, "max": 0.91, "min": 7.99, "cnt": 2}, "forward-send-backward-recv":{"total": 166.22, "avg": 5.54, "max": 1.34, "min": 99.65, "cnt": 30}, "backward-compute":{"total": 1557.06, "avg": 48.66, "max": 45.97, "min": 50.77, "cnt": 32}, "MoE_L3_bwd":{"total": 455.34, "avg": 14.23, "max": 13.02, "min": 17.05, "cnt": 32}, "MoE_L2_bwd":{"total": 320.59, "avg": 10.02, "max": 8.90, "min": 12.02, "cnt": 32}, "MoE_L1_bwd":{"total": 283.26, "avg": 8.85, "max": 8.28, "min": 9.45, "cnt": 32}, "MoE_L0_bwd":{"total": 284.94, "avg": 8.90, "max": 8.39, "min": 11.56, "cnt": 32}, "backward-send-forward-recv":{"total": 3615.37, "avg": 124.67, "max": 2.11, "min": 472.05, "cnt": 29}, "backward-send":{"total": 3.27, "avg": 1.09, "max": 0.99, "min": 1.16, "cnt": 3}, "backward-recv":{"total": 147.16, "avg": 73.58, "max": 72.82, "min": 74.34, "cnt": 2}, "backward-params-all-reduce":{"total": 486.23, "avg": 486.23, "max": 486.23, "min": 486.23, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 245.74, "avg": 245.74, "max": 245.74, "min": 245.74, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 205.50, "avg": 205.50, "max": 205.50, "min": 205.50, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.67, "avg": 3.67, "max": 3.67, "min": 3.67, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.48, "avg": 3.48, "max": 3.48, "min": 3.48, "cnt": 1}}}
{"type":"time", "iteration": 75, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 58.29, "avg": 19.43, "max": 0.87, "min": 56.34, "cnt": 3}, "forward-compute":{"total": 1902.87, "avg": 59.46, "max": 51.93, "min": 111.03, "cnt": 32}, "fwd-compute":{"total": 1899.39, "avg": 59.36, "max": 51.84, "min": 110.94, "cnt": 32}, "batch-generator":{"total": 42.92, "avg": 1.34, "max": 0.75, "min": 2.38, "cnt": 32}, "fwd-embedding":{"total": 0.70, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1843.39, "avg": 57.61, "max": 50.64, "min": 109.54, "cnt": 32}, "fwd-layernorm":{"total": 10.55, "avg": 0.08, "max": 0.05, "min": 0.22, "cnt": 128}, "fwd-attn":{"total": 111.96, "avg": 0.87, "max": 0.74, "min": 1.62, "cnt": 128}, "fwd-misc":{"total": 22.04, "avg": 0.17, "max": 0.12, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1676.37, "avg": 13.10, "max": 10.18, "min": 69.93, "cnt": 128}, "MoE_L0_fwd":{"total": 504.19, "avg": 15.76, "max": 10.32, "min": 69.83, "cnt": 32}, "MoEMLP":{"total": 1658.43, "avg": 12.96, "max": 10.08, "min": 69.78, "cnt": 128}, "MoE_L1_fwd":{"total": 363.72, "avg": 11.37, "max": 10.12, "min": 13.71, "cnt": 32}, "MoE_L2_fwd":{"total": 369.18, "avg": 11.54, "max": 10.80, "min": 15.51, "cnt": 32}, "MoE_L3_fwd":{"total": 427.73, "avg": 13.37, "max": 12.31, "min": 16.76, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 3.98, "avg": 1.99, "max": 1.12, "min": 2.86, "cnt": 2}, "forward-send-backward-recv":{"total": 656.15, "avg": 21.87, "max": 1.48, "min": 246.45, "cnt": 30}, "backward-compute":{"total": 1554.00, "avg": 48.56, "max": 46.45, "min": 50.64, "cnt": 32}, "MoE_L3_bwd":{"total": 449.93, "avg": 14.06, "max": 12.66, "min": 15.28, "cnt": 32}, "MoE_L2_bwd":{"total": 320.65, "avg": 10.02, "max": 8.95, "min": 10.85, "cnt": 32}, "MoE_L1_bwd":{"total": 286.39, "avg": 8.95, "max": 8.37, "min": 10.45, "cnt": 32}, "MoE_L0_bwd":{"total": 283.52, "avg": 8.86, "max": 7.95, "min": 9.27, "cnt": 32}, "backward-send-forward-recv":{"total": 2907.55, "avg": 100.26, "max": 2.24, "min": 274.18, "cnt": 29}, "backward-send":{"total": 2.22, "avg": 0.74, "max": 0.55, "min": 0.85, "cnt": 3}, "backward-recv":{"total": 147.38, "avg": 73.69, "max": 72.95, "min": 74.43, "cnt": 2}, "backward-params-all-reduce":{"total": 487.25, "avg": 487.25, "max": 487.25, "min": 487.25, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 245.01, "avg": 245.01, "max": 245.01, "min": 245.01, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 205.02, "avg": 205.02, "max": 205.02, "min": 205.02, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.55, "avg": 3.55, "max": 3.55, "min": 3.55, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 76, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 67.30, "avg": 22.43, "max": 1.25, "min": 57.67, "cnt": 3}, "forward-compute":{"total": 1857.56, "avg": 58.05, "max": 50.53, "min": 64.63, "cnt": 32}, "fwd-compute":{"total": 1854.49, "avg": 57.95, "max": 50.44, "min": 64.54, "cnt": 32}, "batch-generator":{"total": 48.64, "avg": 1.52, "max": 0.68, "min": 3.41, "cnt": 32}, "fwd-embedding":{"total": 0.62, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1793.55, "avg": 56.05, "max": 49.27, "min": 62.72, "cnt": 32}, "fwd-layernorm":{"total": 9.74, "avg": 0.08, "max": 0.05, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 109.95, "avg": 0.86, "max": 0.74, "min": 1.61, "cnt": 128}, "fwd-misc":{"total": 20.98, "avg": 0.16, "max": 0.11, "min": 0.39, "cnt": 128}, "fwd-MLP":{"total": 1632.42, "avg": 12.75, "max": 10.11, "min": 18.03, "cnt": 128}, "MoE_L0_fwd":{"total": 473.78, "avg": 14.81, "max": 10.53, "min": 17.95, "cnt": 32}, "MoEMLP":{"total": 1615.50, "avg": 12.62, "max": 10.01, "min": 17.90, "cnt": 128}, "MoE_L1_fwd":{"total": 370.19, "avg": 11.57, "max": 10.05, "min": 16.52, "cnt": 32}, "MoE_L2_fwd":{"total": 359.50, "avg": 11.23, "max": 10.71, "min": 12.50, "cnt": 32}, "MoE_L3_fwd":{"total": 418.18, "avg": 13.07, "max": 12.26, "min": 16.17, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.95, "avg": 0.97, "max": 0.97, "min": 0.98, "cnt": 2}, "forward-send-backward-recv":{"total": 389.16, "avg": 12.97, "max": 1.32, "min": 127.98, "cnt": 30}, "backward-compute":{"total": 1557.59, "avg": 48.67, "max": 45.39, "min": 51.59, "cnt": 32}, "MoE_L3_bwd":{"total": 451.89, "avg": 14.12, "max": 13.04, "min": 15.76, "cnt": 32}, "MoE_L2_bwd":{"total": 324.40, "avg": 10.14, "max": 9.28, "min": 14.14, "cnt": 32}, "MoE_L1_bwd":{"total": 281.79, "avg": 8.81, "max": 8.00, "min": 11.24, "cnt": 32}, "MoE_L0_bwd":{"total": 286.28, "avg": 8.95, "max": 8.27, "min": 9.55, "cnt": 32}, "backward-send-forward-recv":{"total": 3554.68, "avg": 122.58, "max": 1.73, "min": 382.68, "cnt": 29}, "backward-send":{"total": 2.54, "avg": 0.85, "max": 0.68, "min": 1.12, "cnt": 3}, "backward-recv":{"total": 128.73, "avg": 64.36, "max": 60.87, "min": 67.86, "cnt": 2}, "backward-params-all-reduce":{"total": 484.28, "avg": 484.28, "max": 484.28, "min": 484.28, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 252.11, "avg": 252.11, "max": 252.11, "min": 252.11, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 212.31, "avg": 212.31, "max": 212.31, "min": 212.31, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 77, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 57.53, "avg": 19.18, "max": 1.29, "min": 54.86, "cnt": 3}, "forward-compute":{"total": 1816.18, "avg": 56.76, "max": 49.65, "min": 63.28, "cnt": 32}, "fwd-compute":{"total": 1812.96, "avg": 56.65, "max": 49.58, "min": 63.20, "cnt": 32}, "batch-generator":{"total": 45.68, "avg": 1.43, "max": 0.72, "min": 3.17, "cnt": 32}, "fwd-embedding":{"total": 0.68, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1754.70, "avg": 54.83, "max": 48.56, "min": 61.64, "cnt": 32}, "fwd-layernorm":{"total": 10.52, "avg": 0.08, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 112.06, "avg": 0.88, "max": 0.74, "min": 1.51, "cnt": 128}, "fwd-misc":{"total": 22.00, "avg": 0.17, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1588.44, "avg": 12.41, "max": 10.26, "min": 17.82, "cnt": 128}, "MoE_L0_fwd":{"total": 445.30, "avg": 13.92, "max": 10.18, "min": 17.75, "cnt": 32}, "MoEMLP":{"total": 1570.68, "avg": 12.27, "max": 10.13, "min": 17.70, "cnt": 128}, "MoE_L1_fwd":{"total": 361.02, "avg": 11.28, "max": 10.23, "min": 12.90, "cnt": 32}, "MoE_L2_fwd":{"total": 355.48, "avg": 11.11, "max": 10.60, "min": 11.78, "cnt": 32}, "MoE_L3_fwd":{"total": 415.32, "avg": 12.98, "max": 12.30, "min": 14.09, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 17.88, "avg": 8.94, "max": 0.94, "min": 16.94, "cnt": 2}, "forward-send-backward-recv":{"total": 1215.87, "avg": 40.53, "max": 1.76, "min": 207.79, "cnt": 30}, "backward-compute":{"total": 1555.78, "avg": 48.62, "max": 46.18, "min": 51.74, "cnt": 32}, "MoE_L3_bwd":{"total": 461.91, "avg": 14.43, "max": 13.51, "min": 17.75, "cnt": 32}, "MoE_L2_bwd":{"total": 315.55, "avg": 9.86, "max": 9.46, "min": 10.39, "cnt": 32}, "MoE_L1_bwd":{"total": 284.07, "avg": 8.88, "max": 8.44, "min": 9.24, "cnt": 32}, "MoE_L0_bwd":{"total": 281.57, "avg": 8.80, "max": 8.06, "min": 9.23, "cnt": 32}, "backward-send-forward-recv":{"total": 4010.18, "avg": 138.28, "max": 2.24, "min": 910.49, "cnt": 29}, "backward-send":{"total": 3.20, "avg": 1.07, "max": 0.65, "min": 1.38, "cnt": 3}, "backward-recv":{"total": 287.45, "avg": 143.72, "max": 121.95, "min": 165.49, "cnt": 2}, "backward-params-all-reduce":{"total": 485.07, "avg": 485.07, "max": 485.07, "min": 485.07, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 246.15, "avg": 246.15, "max": 246.15, "min": 246.15, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 206.28, "avg": 206.28, "max": 206.28, "min": 206.28, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.31, "avg": 3.31, "max": 3.31, "min": 3.31, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.49, "avg": 3.49, "max": 3.49, "min": 3.49, "cnt": 1}}}
{"type":"time", "iteration": 78, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 57.49, "avg": 19.16, "max": 0.92, "min": 55.56, "cnt": 3}, "forward-compute":{"total": 1869.56, "avg": 58.42, "max": 50.53, "min": 65.36, "cnt": 32}, "fwd-compute":{"total": 1866.54, "avg": 58.33, "max": 50.46, "min": 65.27, "cnt": 32}, "batch-generator":{"total": 58.05, "avg": 1.81, "max": 0.64, "min": 3.80, "cnt": 32}, "fwd-embedding":{"total": 0.64, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1796.01, "avg": 56.13, "max": 49.54, "min": 62.28, "cnt": 32}, "fwd-layernorm":{"total": 10.28, "avg": 0.08, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 109.60, "avg": 0.86, "max": 0.74, "min": 1.48, "cnt": 128}, "fwd-misc":{"total": 21.93, "avg": 0.17, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1632.71, "avg": 12.76, "max": 10.34, "min": 18.06, "cnt": 128}, "MoE_L0_fwd":{"total": 470.07, "avg": 14.69, "max": 10.40, "min": 17.95, "cnt": 32}, "MoEMLP":{"total": 1615.14, "avg": 12.62, "max": 10.23, "min": 17.88, "cnt": 128}, "MoE_L1_fwd":{"total": 373.65, "avg": 11.68, "max": 10.27, "min": 14.50, "cnt": 32}, "MoE_L2_fwd":{"total": 361.89, "avg": 11.31, "max": 10.53, "min": 14.39, "cnt": 32}, "MoE_L3_fwd":{"total": 415.91, "avg": 13.00, "max": 11.98, "min": 16.95, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.67, "avg": 0.84, "max": 0.77, "min": 0.91, "cnt": 2}, "forward-send-backward-recv":{"total": 189.21, "avg": 6.31, "max": 1.23, "min": 121.00, "cnt": 30}, "backward-compute":{"total": 1545.93, "avg": 48.31, "max": 45.73, "min": 50.00, "cnt": 32}, "MoE_L3_bwd":{"total": 448.93, "avg": 14.03, "max": 12.86, "min": 15.37, "cnt": 32}, "MoE_L2_bwd":{"total": 317.41, "avg": 9.92, "max": 9.30, "min": 10.90, "cnt": 32}, "MoE_L1_bwd":{"total": 283.28, "avg": 8.85, "max": 8.33, "min": 10.05, "cnt": 32}, "MoE_L0_bwd":{"total": 281.70, "avg": 8.80, "max": 7.99, "min": 10.26, "cnt": 32}, "backward-send-forward-recv":{"total": 3439.57, "avg": 118.61, "max": 1.79, "min": 399.03, "cnt": 29}, "backward-send":{"total": 2.50, "avg": 0.83, "max": 0.62, "min": 1.13, "cnt": 3}, "backward-recv":{"total": 149.42, "avg": 74.71, "max": 68.95, "min": 80.48, "cnt": 2}, "backward-params-all-reduce":{"total": 485.44, "avg": 485.44, "max": 485.44, "min": 485.44, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 249.03, "avg": 249.03, "max": 249.03, "min": 249.03, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 208.69, "avg": 208.69, "max": 208.69, "min": 208.69, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.65, "avg": 3.65, "max": 3.65, "min": 3.65, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.47, "avg": 3.47, "max": 3.47, "min": 3.47, "cnt": 1}}}
{"type":"time", "iteration": 79, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 64.34, "avg": 21.45, "max": 0.88, "min": 62.36, "cnt": 3}, "forward-compute":{"total": 1801.60, "avg": 56.30, "max": 49.47, "min": 64.99, "cnt": 32}, "fwd-compute":{"total": 1798.77, "avg": 56.21, "max": 49.41, "min": 64.90, "cnt": 32}, "batch-generator":{"total": 35.97, "avg": 1.12, "max": 0.68, "min": 2.14, "cnt": 32}, "fwd-embedding":{"total": 0.52, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1751.51, "avg": 54.73, "max": 48.43, "min": 63.37, "cnt": 32}, "fwd-layernorm":{"total": 8.97, "avg": 0.07, "max": 0.06, "min": 0.18, "cnt": 128}, "fwd-attn":{"total": 104.77, "avg": 0.82, "max": 0.74, "min": 1.46, "cnt": 128}, "fwd-misc":{"total": 19.83, "avg": 0.15, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1598.23, "avg": 12.49, "max": 10.38, "min": 20.81, "cnt": 128}, "MoE_L0_fwd":{"total": 460.50, "avg": 14.39, "max": 10.50, "min": 20.72, "cnt": 32}, "MoEMLP":{"total": 1582.47, "avg": 12.36, "max": 10.26, "min": 20.67, "cnt": 128}, "MoE_L1_fwd":{"total": 366.69, "avg": 11.46, "max": 10.30, "min": 15.51, "cnt": 32}, "MoE_L2_fwd":{"total": 356.45, "avg": 11.14, "max": 10.55, "min": 13.50, "cnt": 32}, "MoE_L3_fwd":{"total": 404.56, "avg": 12.64, "max": 11.73, "min": 14.60, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 6.83, "avg": 3.41, "max": 1.01, "min": 5.82, "cnt": 2}, "forward-send-backward-recv":{"total": 182.96, "avg": 6.10, "max": 1.31, "min": 109.13, "cnt": 30}, "backward-compute":{"total": 1548.76, "avg": 48.40, "max": 46.21, "min": 50.06, "cnt": 32}, "MoE_L3_bwd":{"total": 443.60, "avg": 13.86, "max": 12.03, "min": 15.84, "cnt": 32}, "MoE_L2_bwd":{"total": 316.63, "avg": 9.89, "max": 9.30, "min": 10.50, "cnt": 32}, "MoE_L1_bwd":{"total": 284.71, "avg": 8.90, "max": 8.38, "min": 10.33, "cnt": 32}, "MoE_L0_bwd":{"total": 289.40, "avg": 9.04, "max": 8.68, "min": 9.43, "cnt": 32}, "backward-send-forward-recv":{"total": 3161.93, "avg": 109.03, "max": 2.19, "min": 538.12, "cnt": 29}, "backward-send":{"total": 2.97, "avg": 0.99, "max": 0.89, "min": 1.07, "cnt": 3}, "backward-recv":{"total": 133.93, "avg": 66.97, "max": 59.10, "min": 74.83, "cnt": 2}, "backward-params-all-reduce":{"total": 487.55, "avg": 487.55, "max": 487.55, "min": 487.55, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 418.44, "avg": 418.44, "max": 418.44, "min": 418.44, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.40, "avg": 3.40, "max": 3.40, "min": 3.40, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 356.69, "avg": 356.69, "max": 356.69, "min": 356.69, "cnt": 1}, "optimizer-clip-main-grad":{"total": 25.22, "avg": 25.22, "max": 25.22, "min": 25.22, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 80, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 61.21, "avg": 20.40, "max": 0.90, "min": 59.36, "cnt": 3}, "forward-compute":{"total": 1949.02, "avg": 60.91, "max": 49.14, "min": 199.69, "cnt": 32}, "fwd-compute":{"total": 1945.87, "avg": 60.81, "max": 49.06, "min": 199.60, "cnt": 32}, "batch-generator":{"total": 41.98, "avg": 1.31, "max": 0.72, "min": 2.76, "cnt": 32}, "fwd-embedding":{"total": 0.63, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1890.30, "avg": 59.07, "max": 47.98, "min": 198.44, "cnt": 32}, "fwd-layernorm":{"total": 10.27, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 111.85, "avg": 0.87, "max": 0.74, "min": 2.57, "cnt": 128}, "fwd-misc":{"total": 21.80, "avg": 0.17, "max": 0.11, "min": 0.39, "cnt": 128}, "fwd-MLP":{"total": 1724.09, "avg": 13.47, "max": 10.05, "min": 158.54, "cnt": 128}, "MoE_L0_fwd":{"total": 594.57, "avg": 18.58, "max": 9.94, "min": 158.45, "cnt": 32}, "MoEMLP":{"total": 1706.09, "avg": 13.33, "max": 9.89, "min": 158.41, "cnt": 128}, "MoE_L1_fwd":{"total": 373.18, "avg": 11.66, "max": 10.16, "min": 16.02, "cnt": 32}, "MoE_L2_fwd":{"total": 367.77, "avg": 11.49, "max": 10.78, "min": 16.15, "cnt": 32}, "MoE_L3_fwd":{"total": 377.08, "avg": 11.78, "max": 10.51, "min": 15.32, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 2.16, "avg": 1.08, "max": 1.06, "min": 1.10, "cnt": 2}, "forward-send-backward-recv":{"total": 619.75, "avg": 20.66, "max": 1.37, "min": 518.49, "cnt": 30}, "backward-compute":{"total": 1484.51, "avg": 46.39, "max": 44.33, "min": 51.18, "cnt": 32}, "MoE_L3_bwd":{"total": 403.49, "avg": 12.61, "max": 11.04, "min": 17.02, "cnt": 32}, "MoE_L2_bwd":{"total": 322.31, "avg": 10.07, "max": 8.96, "min": 10.91, "cnt": 32}, "MoE_L1_bwd":{"total": 286.43, "avg": 8.95, "max": 8.29, "min": 9.95, "cnt": 32}, "MoE_L0_bwd":{"total": 253.99, "avg": 7.94, "max": 7.09, "min": 8.32, "cnt": 32}, "backward-send-forward-recv":{"total": 2373.21, "avg": 81.83, "max": 2.19, "min": 337.02, "cnt": 29}, "backward-send":{"total": 2.79, "avg": 0.93, "max": 0.84, "min": 1.00, "cnt": 3}, "backward-recv":{"total": 209.58, "avg": 104.79, "max": 62.21, "min": 147.36, "cnt": 2}, "backward-params-all-reduce":{"total": 487.86, "avg": 487.86, "max": 487.86, "min": 487.86, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 242.58, "avg": 242.58, "max": 242.58, "min": 242.58, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 202.66, "avg": 202.66, "max": 202.66, "min": 202.66, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.33, "avg": 3.33, "max": 3.33, "min": 3.33, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.47, "avg": 3.47, "max": 3.47, "min": 3.47, "cnt": 1}}}
{"type":"time", "iteration": 81, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 62.46, "avg": 20.82, "max": 1.25, "min": 54.17, "cnt": 3}, "forward-compute":{"total": 1752.04, "avg": 54.75, "max": 48.21, "min": 63.72, "cnt": 32}, "fwd-compute":{"total": 1749.12, "avg": 54.66, "max": 48.15, "min": 63.57, "cnt": 32}, "batch-generator":{"total": 41.88, "avg": 1.31, "max": 0.63, "min": 2.45, "cnt": 32}, "fwd-embedding":{"total": 0.55, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1695.42, "avg": 52.98, "max": 47.22, "min": 60.80, "cnt": 32}, "fwd-layernorm":{"total": 9.31, "avg": 0.07, "max": 0.05, "min": 0.22, "cnt": 128}, "fwd-attn":{"total": 107.25, "avg": 0.84, "max": 0.74, "min": 1.70, "cnt": 128}, "fwd-misc":{"total": 20.09, "avg": 0.16, "max": 0.11, "min": 0.40, "cnt": 128}, "fwd-MLP":{"total": 1538.59, "avg": 12.02, "max": 10.29, "min": 18.96, "cnt": 128}, "MoE_L0_fwd":{"total": 443.96, "avg": 13.87, "max": 10.37, "min": 18.87, "cnt": 32}, "MoEMLP":{"total": 1522.26, "avg": 11.89, "max": 10.18, "min": 18.82, "cnt": 128}, "MoE_L1_fwd":{"total": 368.13, "avg": 11.50, "max": 10.39, "min": 14.87, "cnt": 32}, "MoE_L2_fwd":{"total": 356.20, "avg": 11.13, "max": 10.63, "min": 12.34, "cnt": 32}, "MoE_L3_fwd":{"total": 359.96, "avg": 11.25, "max": 10.22, "min": 16.54, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.94, "avg": 0.97, "max": 0.94, "min": 1.01, "cnt": 2}, "forward-send-backward-recv":{"total": 187.93, "avg": 6.26, "max": 1.30, "min": 113.14, "cnt": 30}, "backward-compute":{"total": 1485.51, "avg": 46.42, "max": 44.74, "min": 48.78, "cnt": 32}, "MoE_L3_bwd":{"total": 382.42, "avg": 11.95, "max": 11.02, "min": 13.47, "cnt": 32}, "MoE_L2_bwd":{"total": 325.88, "avg": 10.18, "max": 9.28, "min": 11.11, "cnt": 32}, "MoE_L1_bwd":{"total": 291.00, "avg": 9.09, "max": 8.44, "min": 10.60, "cnt": 32}, "MoE_L0_bwd":{"total": 267.21, "avg": 8.35, "max": 7.74, "min": 8.87, "cnt": 32}, "backward-send-forward-recv":{"total": 5373.95, "avg": 185.31, "max": 1.92, "min": 735.31, "cnt": 29}, "backward-send":{"total": 1.57, "avg": 0.52, "max": 0.49, "min": 0.56, "cnt": 3}, "backward-recv":{"total": 230.33, "avg": 115.17, "max": 58.32, "min": 172.02, "cnt": 2}, "backward-params-all-reduce":{"total": 487.47, "avg": 487.47, "max": 487.47, "min": 487.47, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 251.67, "avg": 251.67, "max": 251.67, "min": 251.67, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 4.30, "avg": 4.30, "max": 4.30, "min": 4.30, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 210.81, "avg": 210.81, "max": 210.81, "min": 210.81, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.48, "avg": 3.48, "max": 3.48, "min": 3.48, "cnt": 1}}}
{"type":"time", "iteration": 82, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 67.57, "avg": 22.52, "max": 1.00, "min": 65.41, "cnt": 3}, "forward-compute":{"total": 1754.24, "avg": 54.82, "max": 48.26, "min": 62.12, "cnt": 32}, "fwd-compute":{"total": 1751.56, "avg": 54.74, "max": 48.17, "min": 62.05, "cnt": 32}, "batch-generator":{"total": 43.63, "avg": 1.36, "max": 0.62, "min": 3.64, "cnt": 32}, "fwd-embedding":{"total": 0.47, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1696.50, "avg": 53.02, "max": 47.01, "min": 59.26, "cnt": 32}, "fwd-layernorm":{"total": 9.07, "avg": 0.07, "max": 0.05, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 103.45, "avg": 0.81, "max": 0.74, "min": 1.60, "cnt": 128}, "fwd-misc":{"total": 19.76, "avg": 0.15, "max": 0.11, "min": 0.38, "cnt": 128}, "fwd-MLP":{"total": 1544.80, "avg": 12.07, "max": 10.37, "min": 18.99, "cnt": 128}, "MoE_L0_fwd":{"total": 446.82, "avg": 13.96, "max": 10.28, "min": 18.89, "cnt": 32}, "MoEMLP":{"total": 1529.17, "avg": 11.95, "max": 10.24, "min": 18.83, "cnt": 128}, "MoE_L1_fwd":{"total": 384.32, "avg": 12.01, "max": 10.43, "min": 14.40, "cnt": 32}, "MoE_L2_fwd":{"total": 347.15, "avg": 10.85, "max": 10.42, "min": 11.56, "cnt": 32}, "MoE_L3_fwd":{"total": 356.63, "avg": 11.14, "max": 10.54, "min": 12.93, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 11.33, "avg": 5.67, "max": 0.57, "min": 10.76, "cnt": 2}, "forward-send-backward-recv":{"total": 172.57, "avg": 5.75, "max": 1.27, "min": 110.55, "cnt": 30}, "backward-compute":{"total": 1510.95, "avg": 47.22, "max": 44.68, "min": 48.61, "cnt": 32}, "MoE_L3_bwd":{"total": 390.70, "avg": 12.21, "max": 10.52, "min": 13.74, "cnt": 32}, "MoE_L2_bwd":{"total": 326.34, "avg": 10.20, "max": 9.55, "min": 10.85, "cnt": 32}, "MoE_L1_bwd":{"total": 301.51, "avg": 9.42, "max": 8.89, "min": 9.97, "cnt": 32}, "MoE_L0_bwd":{"total": 271.52, "avg": 8.49, "max": 7.76, "min": 8.93, "cnt": 32}, "backward-send-forward-recv":{"total": 12983.34, "avg": 447.70, "max": 2.37, "min": 2181.71, "cnt": 29}, "backward-send":{"total": 2.25, "avg": 0.75, "max": 0.53, "min": 1.02, "cnt": 3}, "backward-recv":{"total": 127.51, "avg": 63.76, "max": 63.26, "min": 64.25, "cnt": 2}, "backward-params-all-reduce":{"total": 492.49, "avg": 492.49, "max": 492.49, "min": 492.49, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 246.75, "avg": 246.75, "max": 246.75, "min": 246.75, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 206.76, "avg": 206.76, "max": 206.76, "min": 206.76, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.36, "avg": 3.36, "max": 3.36, "min": 3.36, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.48, "avg": 3.48, "max": 3.48, "min": 3.48, "cnt": 1}}}
{"type":"time", "iteration": 83, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.18, "avg": 0.18, "max": 0.18, "min": 0.18, "cnt": 1}, "forward-recv":{"total": 107.87, "avg": 35.96, "max": 1.00, "min": 58.37, "cnt": 3}, "forward-compute":{"total": 1786.47, "avg": 55.83, "max": 48.59, "min": 64.38, "cnt": 32}, "fwd-compute":{"total": 1783.66, "avg": 55.74, "max": 48.52, "min": 64.30, "cnt": 32}, "batch-generator":{"total": 61.22, "avg": 1.91, "max": 0.69, "min": 3.20, "cnt": 32}, "fwd-embedding":{"total": 0.44, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1711.34, "avg": 53.48, "max": 47.50, "min": 61.69, "cnt": 32}, "fwd-layernorm":{"total": 8.73, "avg": 0.07, "max": 0.06, "min": 0.17, "cnt": 128}, "fwd-attn":{"total": 101.06, "avg": 0.79, "max": 0.74, "min": 1.41, "cnt": 128}, "fwd-misc":{"total": 18.79, "avg": 0.15, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1563.95, "avg": 12.22, "max": 10.43, "min": 18.14, "cnt": 128}, "MoE_L0_fwd":{"total": 448.15, "avg": 14.00, "max": 10.36, "min": 16.67, "cnt": 32}, "MoEMLP":{"total": 1548.77, "avg": 12.10, "max": 10.33, "min": 18.05, "cnt": 128}, "MoE_L1_fwd":{"total": 379.41, "avg": 11.86, "max": 10.42, "min": 15.25, "cnt": 32}, "MoE_L2_fwd":{"total": 348.82, "avg": 10.90, "max": 10.38, "min": 11.83, "cnt": 32}, "MoE_L3_fwd":{"total": 377.96, "avg": 11.81, "max": 10.61, "min": 18.08, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.56, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.61, "avg": 0.81, "max": 0.75, "min": 0.87, "cnt": 2}, "forward-send-backward-recv":{"total": 143.61, "avg": 4.79, "max": 1.40, "min": 67.80, "cnt": 30}, "backward-compute":{"total": 1475.20, "avg": 46.10, "max": 43.14, "min": 47.72, "cnt": 32}, "MoE_L3_bwd":{"total": 394.39, "avg": 12.32, "max": 10.70, "min": 14.35, "cnt": 32}, "MoE_L2_bwd":{"total": 307.51, "avg": 9.61, "max": 8.90, "min": 10.33, "cnt": 32}, "MoE_L1_bwd":{"total": 290.30, "avg": 9.07, "max": 8.61, "min": 10.43, "cnt": 32}, "MoE_L0_bwd":{"total": 265.36, "avg": 8.29, "max": 7.39, "min": 8.78, "cnt": 32}, "backward-send-forward-recv":{"total": 12824.84, "avg": 442.24, "max": 2.02, "min": 1897.06, "cnt": 29}, "backward-send":{"total": 3.19, "avg": 1.06, "max": 0.97, "min": 1.12, "cnt": 3}, "backward-recv":{"total": 435.92, "avg": 217.96, "max": 70.22, "min": 365.70, "cnt": 2}, "backward-params-all-reduce":{"total": 485.61, "avg": 485.61, "max": 485.61, "min": 485.61, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 245.54, "avg": 245.54, "max": 245.54, "min": 245.54, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 205.73, "avg": 205.73, "max": 205.73, "min": 205.73, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.27, "avg": 3.27, "max": 3.27, "min": 3.27, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 84, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.06, "avg": 0.06, "max": 0.06, "min": 0.06, "cnt": 1}, "forward-recv":{"total": 71.08, "avg": 23.69, "max": 1.00, "min": 59.49, "cnt": 3}, "forward-compute":{"total": 1752.93, "avg": 54.78, "max": 48.12, "min": 65.05, "cnt": 32}, "fwd-compute":{"total": 1750.22, "avg": 54.69, "max": 48.05, "min": 64.98, "cnt": 32}, "batch-generator":{"total": 45.06, "avg": 1.41, "max": 0.63, "min": 3.75, "cnt": 32}, "fwd-embedding":{"total": 0.51, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1693.88, "avg": 52.93, "max": 46.77, "min": 63.63, "cnt": 32}, "fwd-layernorm":{"total": 8.98, "avg": 0.07, "max": 0.05, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 104.30, "avg": 0.81, "max": 0.74, "min": 2.28, "cnt": 128}, "fwd-misc":{"total": 19.10, "avg": 0.15, "max": 0.11, "min": 0.39, "cnt": 128}, "fwd-MLP":{"total": 1542.04, "avg": 12.05, "max": 9.94, "min": 20.86, "cnt": 128}, "MoE_L0_fwd":{"total": 441.66, "avg": 13.80, "max": 10.11, "min": 20.78, "cnt": 32}, "MoEMLP":{"total": 1526.33, "avg": 11.92, "max": 9.84, "min": 20.73, "cnt": 128}, "MoE_L1_fwd":{"total": 382.38, "avg": 11.95, "max": 10.39, "min": 19.21, "cnt": 32}, "MoE_L2_fwd":{"total": 361.38, "avg": 11.29, "max": 10.73, "min": 14.19, "cnt": 32}, "MoE_L3_fwd":{"total": 346.63, "avg": 10.83, "max": 9.88, "min": 16.71, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 2.10, "avg": 1.05, "max": 1.02, "min": 1.08, "cnt": 2}, "forward-send-backward-recv":{"total": 243.56, "avg": 8.12, "max": 1.68, "min": 99.29, "cnt": 30}, "backward-compute":{"total": 1474.91, "avg": 46.09, "max": 42.60, "min": 48.68, "cnt": 32}, "MoE_L3_bwd":{"total": 368.26, "avg": 11.51, "max": 9.03, "min": 14.01, "cnt": 32}, "MoE_L2_bwd":{"total": 333.28, "avg": 10.42, "max": 9.58, "min": 11.70, "cnt": 32}, "MoE_L1_bwd":{"total": 292.14, "avg": 9.13, "max": 8.55, "min": 9.67, "cnt": 32}, "MoE_L0_bwd":{"total": 263.37, "avg": 8.23, "max": 7.66, "min": 8.58, "cnt": 32}, "backward-send-forward-recv":{"total": 8377.60, "avg": 288.88, "max": 2.41, "min": 1194.79, "cnt": 29}, "backward-send":{"total": 2.41, "avg": 0.80, "max": 0.65, "min": 1.06, "cnt": 3}, "backward-recv":{"total": 127.67, "avg": 63.83, "max": 55.01, "min": 72.65, "cnt": 2}, "backward-params-all-reduce":{"total": 484.42, "avg": 484.42, "max": 484.42, "min": 484.42, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 247.14, "avg": 247.14, "max": 247.14, "min": 247.14, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 207.25, "avg": 207.25, "max": 207.25, "min": 207.25, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.35, "avg": 3.35, "max": 3.35, "min": 3.35, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.47, "avg": 3.47, "max": 3.47, "min": 3.47, "cnt": 1}}}
{"type":"time", "iteration": 85, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 54.46, "avg": 18.15, "max": 0.88, "min": 52.70, "cnt": 3}, "forward-compute":{"total": 1842.23, "avg": 57.57, "max": 51.57, "min": 63.83, "cnt": 32}, "fwd-compute":{"total": 1839.25, "avg": 57.48, "max": 51.51, "min": 63.75, "cnt": 32}, "batch-generator":{"total": 40.03, "avg": 1.25, "max": 0.66, "min": 2.21, "cnt": 32}, "fwd-embedding":{"total": 0.61, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1787.09, "avg": 55.85, "max": 50.05, "min": 61.93, "cnt": 32}, "fwd-layernorm":{"total": 10.04, "avg": 0.08, "max": 0.05, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 110.84, "avg": 0.87, "max": 0.74, "min": 3.51, "cnt": 128}, "fwd-misc":{"total": 20.77, "avg": 0.16, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1624.70, "avg": 12.69, "max": 10.26, "min": 22.10, "cnt": 128}, "MoE_L0_fwd":{"total": 495.55, "avg": 15.49, "max": 10.47, "min": 22.02, "cnt": 32}, "MoEMLP":{"total": 1607.76, "avg": 12.56, "max": 10.15, "min": 21.97, "cnt": 128}, "MoE_L1_fwd":{"total": 399.21, "avg": 12.48, "max": 10.70, "min": 18.22, "cnt": 32}, "MoE_L2_fwd":{"total": 363.14, "avg": 11.35, "max": 10.62, "min": 13.12, "cnt": 32}, "MoE_L3_fwd":{"total": 355.98, "avg": 11.12, "max": 10.19, "min": 13.35, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.56, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.34, "avg": 0.67, "max": 0.63, "min": 0.71, "cnt": 2}, "forward-send-backward-recv":{"total": 1545.49, "avg": 51.52, "max": 1.45, "min": 261.07, "cnt": 30}, "backward-compute":{"total": 1473.34, "avg": 46.04, "max": 43.12, "min": 47.48, "cnt": 32}, "MoE_L3_bwd":{"total": 358.59, "avg": 11.21, "max": 8.84, "min": 13.07, "cnt": 32}, "MoE_L2_bwd":{"total": 324.50, "avg": 10.14, "max": 9.54, "min": 11.08, "cnt": 32}, "MoE_L1_bwd":{"total": 299.78, "avg": 9.37, "max": 8.88, "min": 10.42, "cnt": 32}, "MoE_L0_bwd":{"total": 271.94, "avg": 8.50, "max": 7.97, "min": 8.83, "cnt": 32}, "backward-send-forward-recv":{"total": 1712.07, "avg": 59.04, "max": 1.69, "min": 253.82, "cnt": 29}, "backward-send":{"total": 2.12, "avg": 0.71, "max": 0.68, "min": 0.73, "cnt": 3}, "backward-recv":{"total": 142.67, "avg": 71.33, "max": 67.49, "min": 75.18, "cnt": 2}, "backward-params-all-reduce":{"total": 486.56, "avg": 486.56, "max": 486.56, "min": 486.56, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 246.02, "avg": 246.02, "max": 246.02, "min": 246.02, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 206.12, "avg": 206.12, "max": 206.12, "min": 206.12, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.34, "avg": 3.34, "max": 3.34, "min": 3.34, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.47, "avg": 3.47, "max": 3.47, "min": 3.47, "cnt": 1}}}
{"type":"time", "iteration": 86, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.06, "avg": 0.06, "max": 0.06, "min": 0.06, "cnt": 1}, "forward-recv":{"total": 592.64, "avg": 197.55, "max": 2.51, "min": 531.42, "cnt": 3}, "forward-compute":{"total": 1781.94, "avg": 55.69, "max": 48.22, "min": 62.36, "cnt": 32}, "fwd-compute":{"total": 1778.70, "avg": 55.58, "max": 48.16, "min": 62.24, "cnt": 32}, "batch-generator":{"total": 49.46, "avg": 1.55, "max": 0.65, "min": 3.43, "cnt": 32}, "fwd-embedding":{"total": 0.71, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1716.98, "avg": 53.66, "max": 47.22, "min": 60.12, "cnt": 32}, "fwd-layernorm":{"total": 10.26, "avg": 0.08, "max": 0.05, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 110.73, "avg": 0.87, "max": 0.74, "min": 1.52, "cnt": 128}, "fwd-misc":{"total": 21.47, "avg": 0.17, "max": 0.11, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1553.49, "avg": 12.14, "max": 10.19, "min": 18.37, "cnt": 128}, "MoE_L0_fwd":{"total": 438.31, "avg": 13.70, "max": 10.54, "min": 18.29, "cnt": 32}, "MoEMLP":{"total": 1536.12, "avg": 12.00, "max": 10.08, "min": 18.24, "cnt": 128}, "MoE_L1_fwd":{"total": 377.16, "avg": 11.79, "max": 10.40, "min": 15.34, "cnt": 32}, "MoE_L2_fwd":{"total": 383.28, "avg": 11.98, "max": 11.23, "min": 15.46, "cnt": 32}, "MoE_L3_fwd":{"total": 343.68, "avg": 10.74, "max": 10.12, "min": 11.98, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 10.11, "avg": 5.05, "max": 0.80, "min": 9.31, "cnt": 2}, "forward-send-backward-recv":{"total": 913.54, "avg": 30.45, "max": 1.28, "min": 251.74, "cnt": 30}, "backward-compute":{"total": 1509.53, "avg": 47.17, "max": 44.16, "min": 49.56, "cnt": 32}, "MoE_L3_bwd":{"total": 370.08, "avg": 11.56, "max": 9.95, "min": 14.51, "cnt": 32}, "MoE_L2_bwd":{"total": 353.07, "avg": 11.03, "max": 10.23, "min": 11.84, "cnt": 32}, "MoE_L1_bwd":{"total": 296.60, "avg": 9.27, "max": 8.85, "min": 10.37, "cnt": 32}, "MoE_L0_bwd":{"total": 271.69, "avg": 8.49, "max": 7.78, "min": 9.09, "cnt": 32}, "backward-send-forward-recv":{"total": 2805.45, "avg": 96.74, "max": 2.31, "min": 519.92, "cnt": 29}, "backward-send":{"total": 3.13, "avg": 1.04, "max": 0.84, "min": 1.22, "cnt": 3}, "backward-recv":{"total": 198.29, "avg": 99.15, "max": 66.48, "min": 131.81, "cnt": 2}, "backward-params-all-reduce":{"total": 486.24, "avg": 486.24, "max": 486.24, "min": 486.24, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 247.10, "avg": 247.10, "max": 247.10, "min": 247.10, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 207.36, "avg": 207.36, "max": 207.36, "min": 207.36, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.27, "avg": 3.27, "max": 3.27, "min": 3.27, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 87, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 53.23, "avg": 17.74, "max": 0.97, "min": 51.19, "cnt": 3}, "forward-compute":{"total": 1801.31, "avg": 56.29, "max": 49.78, "min": 64.94, "cnt": 32}, "fwd-compute":{"total": 1798.35, "avg": 56.20, "max": 49.71, "min": 64.82, "cnt": 32}, "batch-generator":{"total": 38.01, "avg": 1.19, "max": 0.63, "min": 1.67, "cnt": 32}, "fwd-embedding":{"total": 0.60, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1748.20, "avg": 54.63, "max": 48.61, "min": 62.77, "cnt": 32}, "fwd-layernorm":{"total": 9.30, "avg": 0.07, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 107.78, "avg": 0.84, "max": 0.75, "min": 1.49, "cnt": 128}, "fwd-misc":{"total": 20.07, "avg": 0.16, "max": 0.11, "min": 0.34, "cnt": 128}, "fwd-MLP":{"total": 1590.73, "avg": 12.43, "max": 10.39, "min": 18.25, "cnt": 128}, "MoE_L0_fwd":{"total": 454.04, "avg": 14.19, "max": 10.32, "min": 18.16, "cnt": 32}, "MoEMLP":{"total": 1574.26, "avg": 12.30, "max": 10.28, "min": 18.10, "cnt": 128}, "MoE_L1_fwd":{"total": 374.01, "avg": 11.69, "max": 10.52, "min": 14.96, "cnt": 32}, "MoE_L2_fwd":{"total": 383.48, "avg": 11.98, "max": 11.43, "min": 13.36, "cnt": 32}, "MoE_L3_fwd":{"total": 368.77, "avg": 11.52, "max": 10.77, "min": 17.04, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.53, "avg": 0.76, "max": 0.66, "min": 0.87, "cnt": 2}, "forward-send-backward-recv":{"total": 218.50, "avg": 7.28, "max": 1.35, "min": 101.92, "cnt": 30}, "backward-compute":{"total": 1509.89, "avg": 47.18, "max": 43.92, "min": 48.63, "cnt": 32}, "MoE_L3_bwd":{"total": 385.15, "avg": 12.04, "max": 9.19, "min": 13.55, "cnt": 32}, "MoE_L2_bwd":{"total": 346.32, "avg": 10.82, "max": 9.97, "min": 11.38, "cnt": 32}, "MoE_L1_bwd":{"total": 290.00, "avg": 9.06, "max": 8.71, "min": 9.42, "cnt": 32}, "MoE_L0_bwd":{"total": 271.82, "avg": 8.49, "max": 7.75, "min": 8.81, "cnt": 32}, "backward-send-forward-recv":{"total": 2541.89, "avg": 87.65, "max": 1.55, "min": 271.34, "cnt": 29}, "backward-send":{"total": 2.13, "avg": 0.71, "max": 0.57, "min": 0.84, "cnt": 3}, "backward-recv":{"total": 279.19, "avg": 139.60, "max": 65.20, "min": 213.99, "cnt": 2}, "backward-params-all-reduce":{"total": 488.55, "avg": 488.55, "max": 488.55, "min": 488.55, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 244.42, "avg": 244.42, "max": 244.42, "min": 244.42, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 204.59, "avg": 204.59, "max": 204.59, "min": 204.59, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.30, "avg": 3.30, "max": 3.30, "min": 3.30, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.47, "avg": 3.47, "max": 3.47, "min": 3.47, "cnt": 1}}}
{"type":"time", "iteration": 88, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 57.56, "avg": 19.19, "max": 0.96, "min": 55.21, "cnt": 3}, "forward-compute":{"total": 1842.02, "avg": 57.56, "max": 49.75, "min": 65.49, "cnt": 32}, "fwd-compute":{"total": 1839.02, "avg": 57.47, "max": 49.68, "min": 65.37, "cnt": 32}, "batch-generator":{"total": 45.80, "avg": 1.43, "max": 0.64, "min": 3.23, "cnt": 32}, "fwd-embedding":{"total": 0.60, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1781.54, "avg": 55.67, "max": 48.76, "min": 63.36, "cnt": 32}, "fwd-layernorm":{"total": 9.64, "avg": 0.08, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 109.18, "avg": 0.85, "max": 0.74, "min": 1.43, "cnt": 128}, "fwd-misc":{"total": 20.89, "avg": 0.16, "max": 0.11, "min": 0.39, "cnt": 128}, "fwd-MLP":{"total": 1621.76, "avg": 12.67, "max": 10.28, "min": 21.54, "cnt": 128}, "MoE_L0_fwd":{"total": 473.71, "avg": 14.80, "max": 10.75, "min": 21.47, "cnt": 32}, "MoEMLP":{"total": 1605.29, "avg": 12.54, "max": 10.18, "min": 21.42, "cnt": 128}, "MoE_L1_fwd":{"total": 379.47, "avg": 11.86, "max": 10.22, "min": 14.99, "cnt": 32}, "MoE_L2_fwd":{"total": 390.09, "avg": 12.19, "max": 11.58, "min": 15.20, "cnt": 32}, "MoE_L3_fwd":{"total": 368.07, "avg": 11.50, "max": 10.63, "min": 14.61, "cnt": 32}, "fwd-pooler":{"total": 0.31, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.56, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 5.48, "avg": 2.74, "max": 1.02, "min": 4.46, "cnt": 2}, "forward-send-backward-recv":{"total": 189.08, "avg": 6.30, "max": 1.84, "min": 108.41, "cnt": 30}, "backward-compute":{"total": 1523.79, "avg": 47.62, "max": 45.37, "min": 51.88, "cnt": 32}, "MoE_L3_bwd":{"total": 377.50, "avg": 11.80, "max": 10.68, "min": 13.53, "cnt": 32}, "MoE_L2_bwd":{"total": 365.12, "avg": 11.41, "max": 10.28, "min": 14.66, "cnt": 32}, "MoE_L1_bwd":{"total": 291.68, "avg": 9.11, "max": 8.44, "min": 11.65, "cnt": 32}, "MoE_L0_bwd":{"total": 277.72, "avg": 8.68, "max": 8.11, "min": 9.79, "cnt": 32}, "backward-send-forward-recv":{"total": 4004.22, "avg": 138.08, "max": 2.22, "min": 690.05, "cnt": 29}, "backward-send":{"total": 2.47, "avg": 0.82, "max": 0.57, "min": 0.99, "cnt": 3}, "backward-recv":{"total": 133.10, "avg": 66.55, "max": 64.12, "min": 68.98, "cnt": 2}, "backward-params-all-reduce":{"total": 489.89, "avg": 489.89, "max": 489.89, "min": 489.89, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 247.44, "avg": 247.44, "max": 247.44, "min": 247.44, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 207.66, "avg": 207.66, "max": 207.66, "min": 207.66, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.29, "avg": 3.29, "max": 3.29, "min": 3.29, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.48, "avg": 3.48, "max": 3.48, "min": 3.48, "cnt": 1}}}
{"type":"time", "iteration": 89, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.17, "avg": 0.17, "max": 0.17, "min": 0.17, "cnt": 1}, "forward-recv":{"total": 52.96, "avg": 17.65, "max": 1.13, "min": 50.68, "cnt": 3}, "forward-compute":{"total": 1812.66, "avg": 56.65, "max": 49.90, "min": 63.16, "cnt": 32}, "fwd-compute":{"total": 1809.41, "avg": 56.54, "max": 49.83, "min": 63.06, "cnt": 32}, "batch-generator":{"total": 44.17, "avg": 1.38, "max": 0.66, "min": 2.68, "cnt": 32}, "fwd-embedding":{"total": 0.65, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1752.53, "avg": 54.77, "max": 48.61, "min": 60.22, "cnt": 32}, "fwd-layernorm":{"total": 10.07, "avg": 0.08, "max": 0.05, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 111.12, "avg": 0.87, "max": 0.74, "min": 2.24, "cnt": 128}, "fwd-misc":{"total": 21.87, "avg": 0.17, "max": 0.11, "min": 0.79, "cnt": 128}, "fwd-MLP":{"total": 1588.03, "avg": 12.41, "max": 10.65, "min": 18.18, "cnt": 128}, "MoE_L0_fwd":{"total": 454.05, "avg": 14.19, "max": 10.59, "min": 18.08, "cnt": 32}, "MoEMLP":{"total": 1570.69, "avg": 12.27, "max": 10.55, "min": 18.03, "cnt": 128}, "MoE_L1_fwd":{"total": 375.05, "avg": 11.72, "max": 10.64, "min": 13.33, "cnt": 32}, "MoE_L2_fwd":{"total": 377.79, "avg": 11.81, "max": 11.33, "min": 12.71, "cnt": 32}, "MoE_L3_fwd":{"total": 370.15, "avg": 11.57, "max": 10.71, "min": 14.73, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.77, "avg": 0.88, "max": 0.87, "min": 0.90, "cnt": 2}, "forward-send-backward-recv":{"total": 179.63, "avg": 5.99, "max": 1.42, "min": 111.63, "cnt": 30}, "backward-compute":{"total": 1538.95, "avg": 48.09, "max": 45.05, "min": 50.68, "cnt": 32}, "MoE_L3_bwd":{"total": 392.60, "avg": 12.27, "max": 10.71, "min": 13.15, "cnt": 32}, "MoE_L2_bwd":{"total": 350.16, "avg": 10.94, "max": 10.31, "min": 12.74, "cnt": 32}, "MoE_L1_bwd":{"total": 300.72, "avg": 9.40, "max": 8.98, "min": 9.97, "cnt": 32}, "MoE_L0_bwd":{"total": 283.31, "avg": 8.85, "max": 8.26, "min": 10.11, "cnt": 32}, "backward-send-forward-recv":{"total": 4575.42, "avg": 157.77, "max": 2.32, "min": 710.08, "cnt": 29}, "backward-send":{"total": 3.15, "avg": 1.05, "max": 0.98, "min": 1.16, "cnt": 3}, "backward-recv":{"total": 140.91, "avg": 70.46, "max": 59.78, "min": 81.13, "cnt": 2}, "backward-params-all-reduce":{"total": 486.02, "avg": 486.02, "max": 486.02, "min": 486.02, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.05, "avg": 0.05, "max": 0.05, "min": 0.05, "cnt": 1}, "optimizer":{"total": 251.81, "avg": 251.81, "max": 251.81, "min": 251.81, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.40, "avg": 3.40, "max": 3.40, "min": 3.40, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 210.48, "avg": 210.48, "max": 210.48, "min": 210.48, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.34, "avg": 3.34, "max": 3.34, "min": 3.34, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.89, "avg": 3.89, "max": 3.89, "min": 3.89, "cnt": 1}}}
{"type":"time", "iteration": 90, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.06, "avg": 0.06, "max": 0.06, "min": 0.06, "cnt": 1}, "forward-recv":{"total": 68.91, "avg": 22.97, "max": 0.96, "min": 66.68, "cnt": 3}, "forward-compute":{"total": 1908.24, "avg": 59.63, "max": 49.07, "min": 179.78, "cnt": 32}, "fwd-compute":{"total": 1904.96, "avg": 59.53, "max": 49.00, "min": 179.69, "cnt": 32}, "batch-generator":{"total": 41.77, "avg": 1.31, "max": 0.68, "min": 2.59, "cnt": 32}, "fwd-embedding":{"total": 0.69, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1850.53, "avg": 57.83, "max": 47.85, "min": 178.34, "cnt": 32}, "fwd-layernorm":{"total": 10.38, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 112.72, "avg": 0.88, "max": 0.75, "min": 1.51, "cnt": 128}, "fwd-misc":{"total": 21.66, "avg": 0.17, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1684.21, "avg": 13.16, "max": 9.37, "min": 136.98, "cnt": 128}, "MoE_L0_fwd":{"total": 463.77, "avg": 14.49, "max": 10.59, "min": 19.90, "cnt": 32}, "MoEMLP":{"total": 1666.61, "avg": 13.02, "max": 9.26, "min": 136.86, "cnt": 128}, "MoE_L1_fwd":{"total": 384.83, "avg": 12.03, "max": 10.53, "min": 13.60, "cnt": 32}, "MoE_L2_fwd":{"total": 370.36, "avg": 11.57, "max": 11.03, "min": 14.42, "cnt": 32}, "MoE_L3_fwd":{"total": 454.08, "avg": 14.19, "max": 9.30, "min": 136.91, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 6.35, "avg": 3.18, "max": 0.96, "min": 5.40, "cnt": 2}, "forward-send-backward-recv":{"total": 1716.60, "avg": 57.22, "max": 1.86, "min": 277.40, "cnt": 30}, "backward-compute":{"total": 1475.38, "avg": 46.11, "max": 43.88, "min": 48.45, "cnt": 32}, "MoE_L3_bwd":{"total": 317.84, "avg": 9.93, "max": 9.06, "min": 11.69, "cnt": 32}, "MoE_L2_bwd":{"total": 348.76, "avg": 10.90, "max": 10.25, "min": 12.15, "cnt": 32}, "MoE_L1_bwd":{"total": 305.04, "avg": 9.53, "max": 9.12, "min": 10.74, "cnt": 32}, "MoE_L0_bwd":{"total": 284.26, "avg": 8.88, "max": 8.27, "min": 9.20, "cnt": 32}, "backward-send-forward-recv":{"total": 1764.98, "avg": 60.86, "max": 1.49, "min": 327.56, "cnt": 29}, "backward-send":{"total": 2.32, "avg": 0.77, "max": 0.68, "min": 0.84, "cnt": 3}, "backward-recv":{"total": 370.41, "avg": 185.20, "max": 61.21, "min": 309.20, "cnt": 2}, "backward-params-all-reduce":{"total": 485.80, "avg": 485.80, "max": 485.80, "min": 485.80, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 247.69, "avg": 247.69, "max": 247.69, "min": 247.69, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 207.88, "avg": 207.88, "max": 207.88, "min": 207.88, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.27, "avg": 3.27, "max": 3.27, "min": 3.27, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.47, "avg": 3.47, "max": 3.47, "min": 3.47, "cnt": 1}}}
{"type":"time", "iteration": 91, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 72.40, "avg": 24.13, "max": 0.96, "min": 70.29, "cnt": 3}, "forward-compute":{"total": 2039.04, "avg": 63.72, "max": 49.44, "min": 301.70, "cnt": 32}, "fwd-compute":{"total": 2035.87, "avg": 63.62, "max": 49.37, "min": 301.56, "cnt": 32}, "batch-generator":{"total": 46.21, "avg": 1.44, "max": 0.63, "min": 3.40, "cnt": 32}, "fwd-embedding":{"total": 0.67, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1977.10, "avg": 61.78, "max": 47.79, "min": 299.34, "cnt": 32}, "fwd-layernorm":{"total": 9.91, "avg": 0.08, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 109.39, "avg": 0.85, "max": 0.74, "min": 1.48, "cnt": 128}, "fwd-misc":{"total": 20.72, "avg": 0.16, "max": 0.11, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1816.40, "avg": 14.19, "max": 9.34, "min": 260.05, "cnt": 128}, "MoE_L0_fwd":{"total": 722.44, "avg": 22.58, "max": 10.46, "min": 259.94, "cnt": 32}, "MoEMLP":{"total": 1799.67, "avg": 14.06, "max": 9.24, "min": 259.87, "cnt": 128}, "MoE_L1_fwd":{"total": 393.30, "avg": 12.29, "max": 10.89, "min": 14.58, "cnt": 32}, "MoE_L2_fwd":{"total": 373.35, "avg": 11.67, "max": 10.97, "min": 15.48, "cnt": 32}, "MoE_L3_fwd":{"total": 316.69, "avg": 9.90, "max": 9.28, "min": 11.45, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.52, "avg": 0.76, "max": 0.72, "min": 0.81, "cnt": 2}, "forward-send-backward-recv":{"total": 197.13, "avg": 6.57, "max": 1.30, "min": 108.02, "cnt": 30}, "backward-compute":{"total": 1469.60, "avg": 45.93, "max": 44.74, "min": 48.25, "cnt": 32}, "MoE_L3_bwd":{"total": 322.05, "avg": 10.06, "max": 9.49, "min": 11.17, "cnt": 32}, "MoE_L2_bwd":{"total": 343.17, "avg": 10.72, "max": 10.15, "min": 12.17, "cnt": 32}, "MoE_L1_bwd":{"total": 302.48, "avg": 9.45, "max": 9.11, "min": 10.11, "cnt": 32}, "MoE_L0_bwd":{"total": 282.97, "avg": 8.84, "max": 8.28, "min": 9.21, "cnt": 32}, "backward-send-forward-recv":{"total": 4117.26, "avg": 141.97, "max": 2.11, "min": 957.81, "cnt": 29}, "backward-send":{"total": 2.61, "avg": 0.87, "max": 0.67, "min": 1.08, "cnt": 3}, "backward-recv":{"total": 125.63, "avg": 62.82, "max": 62.36, "min": 63.28, "cnt": 2}, "backward-params-all-reduce":{"total": 487.14, "avg": 487.14, "max": 487.14, "min": 487.14, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.04, "avg": 0.04, "max": 0.04, "min": 0.04, "cnt": 1}, "optimizer":{"total": 245.82, "avg": 245.82, "max": 245.82, "min": 245.82, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 205.98, "avg": 205.98, "max": 205.98, "min": 205.98, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 92, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.06, "avg": 0.06, "max": 0.06, "min": 0.06, "cnt": 1}, "forward-recv":{"total": 417.13, "avg": 139.04, "max": 1.05, "min": 351.92, "cnt": 3}, "forward-compute":{"total": 1770.16, "avg": 55.32, "max": 48.96, "min": 62.84, "cnt": 32}, "fwd-compute":{"total": 1767.09, "avg": 55.22, "max": 48.88, "min": 62.75, "cnt": 32}, "batch-generator":{"total": 43.75, "avg": 1.37, "max": 0.64, "min": 2.61, "cnt": 32}, "fwd-embedding":{"total": 0.58, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1711.68, "avg": 53.49, "max": 47.73, "min": 61.27, "cnt": 32}, "fwd-layernorm":{"total": 9.60, "avg": 0.07, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 107.92, "avg": 0.84, "max": 0.75, "min": 1.48, "cnt": 128}, "fwd-misc":{"total": 20.82, "avg": 0.16, "max": 0.11, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1553.20, "avg": 12.13, "max": 9.41, "min": 20.84, "cnt": 128}, "MoE_L0_fwd":{"total": 457.44, "avg": 14.29, "max": 10.05, "min": 20.75, "cnt": 32}, "MoEMLP":{"total": 1536.55, "avg": 12.00, "max": 9.31, "min": 20.70, "cnt": 128}, "MoE_L1_fwd":{"total": 388.64, "avg": 12.14, "max": 10.80, "min": 14.94, "cnt": 32}, "MoE_L2_fwd":{"total": 376.78, "avg": 11.77, "max": 11.27, "min": 12.90, "cnt": 32}, "MoE_L3_fwd":{"total": 319.75, "avg": 9.99, "max": 9.35, "min": 11.12, "cnt": 32}, "fwd-pooler":{"total": 0.31, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.55, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 2.89, "avg": 1.45, "max": 0.90, "min": 2.00, "cnt": 2}, "forward-send-backward-recv":{"total": 78.26, "avg": 2.61, "max": 1.29, "min": 8.30, "cnt": 30}, "backward-compute":{"total": 1481.43, "avg": 46.29, "max": 42.97, "min": 49.46, "cnt": 32}, "MoE_L3_bwd":{"total": 328.66, "avg": 10.27, "max": 9.34, "min": 13.55, "cnt": 32}, "MoE_L2_bwd":{"total": 356.85, "avg": 11.15, "max": 10.16, "min": 11.65, "cnt": 32}, "MoE_L1_bwd":{"total": 303.70, "avg": 9.49, "max": 9.05, "min": 10.33, "cnt": 32}, "MoE_L0_bwd":{"total": 275.36, "avg": 8.61, "max": 8.08, "min": 8.93, "cnt": 32}, "backward-send-forward-recv":{"total": 4270.01, "avg": 147.24, "max": 1.93, "min": 584.68, "cnt": 29}, "backward-send":{"total": 2.23, "avg": 0.74, "max": 0.62, "min": 0.98, "cnt": 3}, "backward-recv":{"total": 133.28, "avg": 66.64, "max": 63.95, "min": 69.33, "cnt": 2}, "backward-params-all-reduce":{"total": 485.85, "avg": 485.85, "max": 485.85, "min": 485.85, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 247.53, "avg": 247.53, "max": 247.53, "min": 247.53, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 207.61, "avg": 207.61, "max": 207.61, "min": 207.61, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.52, "avg": 3.52, "max": 3.52, "min": 3.52, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 93, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.06, "avg": 0.06, "max": 0.06, "min": 0.06, "cnt": 1}, "forward-recv":{"total": 66.53, "avg": 22.18, "max": 0.90, "min": 61.73, "cnt": 3}, "forward-compute":{"total": 1802.38, "avg": 56.32, "max": 48.18, "min": 66.17, "cnt": 32}, "fwd-compute":{"total": 1799.45, "avg": 56.23, "max": 48.12, "min": 66.08, "cnt": 32}, "batch-generator":{"total": 45.73, "avg": 1.43, "max": 0.61, "min": 3.16, "cnt": 32}, "fwd-embedding":{"total": 0.60, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1741.37, "avg": 54.42, "max": 47.24, "min": 64.19, "cnt": 32}, "fwd-layernorm":{"total": 9.46, "avg": 0.07, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 107.51, "avg": 0.84, "max": 0.74, "min": 2.25, "cnt": 128}, "fwd-misc":{"total": 20.51, "avg": 0.16, "max": 0.11, "min": 0.51, "cnt": 128}, "fwd-MLP":{"total": 1583.53, "avg": 12.37, "max": 9.71, "min": 18.33, "cnt": 128}, "MoE_L0_fwd":{"total": 453.41, "avg": 14.17, "max": 10.33, "min": 18.21, "cnt": 32}, "MoEMLP":{"total": 1566.65, "avg": 12.24, "max": 9.61, "min": 18.16, "cnt": 128}, "MoE_L1_fwd":{"total": 390.24, "avg": 12.20, "max": 10.66, "min": 17.34, "cnt": 32}, "MoE_L2_fwd":{"total": 389.81, "avg": 12.18, "max": 11.49, "min": 15.00, "cnt": 32}, "MoE_L3_fwd":{"total": 339.27, "avg": 10.60, "max": 9.65, "min": 14.48, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.61, "avg": 0.02, "max": 0.02, "min": 0.06, "cnt": 32}, "forward-send":{"total": 4.66, "avg": 2.33, "max": 0.75, "min": 3.90, "cnt": 2}, "forward-send-backward-recv":{"total": 183.97, "avg": 6.13, "max": 1.42, "min": 101.77, "cnt": 30}, "backward-compute":{"total": 1490.99, "avg": 46.59, "max": 44.11, "min": 48.13, "cnt": 32}, "MoE_L3_bwd":{"total": 329.04, "avg": 10.28, "max": 8.76, "min": 12.14, "cnt": 32}, "MoE_L2_bwd":{"total": 358.86, "avg": 11.21, "max": 10.70, "min": 11.89, "cnt": 32}, "MoE_L1_bwd":{"total": 312.38, "avg": 9.76, "max": 9.19, "min": 10.40, "cnt": 32}, "MoE_L0_bwd":{"total": 273.01, "avg": 8.53, "max": 7.93, "min": 8.93, "cnt": 32}, "backward-send-forward-recv":{"total": 2807.68, "avg": 96.82, "max": 1.97, "min": 301.93, "cnt": 29}, "backward-send":{"total": 2.16, "avg": 0.72, "max": 0.52, "min": 1.00, "cnt": 3}, "backward-recv":{"total": 119.31, "avg": 59.66, "max": 57.34, "min": 61.97, "cnt": 2}, "backward-params-all-reduce":{"total": 488.44, "avg": 488.44, "max": 488.44, "min": 488.44, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 245.76, "avg": 245.76, "max": 245.76, "min": 245.76, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 205.96, "avg": 205.96, "max": 205.96, "min": 205.96, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.28, "avg": 3.28, "max": 3.28, "min": 3.28, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 94, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 59.13, "avg": 19.71, "max": 0.65, "min": 57.13, "cnt": 3}, "forward-compute":{"total": 1803.09, "avg": 56.35, "max": 51.02, "min": 66.48, "cnt": 32}, "fwd-compute":{"total": 1800.23, "avg": 56.26, "max": 50.95, "min": 66.41, "cnt": 32}, "batch-generator":{"total": 37.90, "avg": 1.18, "max": 0.61, "min": 2.20, "cnt": 32}, "fwd-embedding":{"total": 0.60, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1751.06, "avg": 54.72, "max": 49.88, "min": 64.99, "cnt": 32}, "fwd-layernorm":{"total": 9.16, "avg": 0.07, "max": 0.06, "min": 0.18, "cnt": 128}, "fwd-attn":{"total": 107.15, "avg": 0.84, "max": 0.74, "min": 1.95, "cnt": 128}, "fwd-misc":{"total": 19.91, "avg": 0.16, "max": 0.11, "min": 0.41, "cnt": 128}, "fwd-MLP":{"total": 1595.05, "avg": 12.46, "max": 9.67, "min": 19.95, "cnt": 128}, "MoE_L0_fwd":{"total": 469.15, "avg": 14.66, "max": 10.71, "min": 19.86, "cnt": 32}, "MoEMLP":{"total": 1578.58, "avg": 12.33, "max": 9.55, "min": 19.81, "cnt": 128}, "MoE_L1_fwd":{"total": 383.72, "avg": 11.99, "max": 11.09, "min": 14.09, "cnt": 32}, "MoE_L2_fwd":{"total": 392.92, "avg": 12.28, "max": 11.47, "min": 16.71, "cnt": 32}, "MoE_L3_fwd":{"total": 338.80, "avg": 10.59, "max": 9.61, "min": 14.68, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.56, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 5.89, "avg": 2.94, "max": 0.71, "min": 5.18, "cnt": 2}, "forward-send-backward-recv":{"total": 179.10, "avg": 5.97, "max": 1.35, "min": 91.92, "cnt": 30}, "backward-compute":{"total": 1501.00, "avg": 46.91, "max": 45.49, "min": 48.32, "cnt": 32}, "MoE_L3_bwd":{"total": 329.15, "avg": 10.29, "max": 8.17, "min": 11.81, "cnt": 32}, "MoE_L2_bwd":{"total": 360.61, "avg": 11.27, "max": 10.45, "min": 11.83, "cnt": 32}, "MoE_L1_bwd":{"total": 318.69, "avg": 9.96, "max": 9.59, "min": 11.19, "cnt": 32}, "MoE_L0_bwd":{"total": 274.47, "avg": 8.58, "max": 8.03, "min": 9.14, "cnt": 32}, "backward-send-forward-recv":{"total": 2652.03, "avg": 91.45, "max": 1.98, "min": 402.07, "cnt": 29}, "backward-send":{"total": 3.22, "avg": 1.07, "max": 0.99, "min": 1.14, "cnt": 3}, "backward-recv":{"total": 137.02, "avg": 68.51, "max": 61.81, "min": 75.21, "cnt": 2}, "backward-params-all-reduce":{"total": 482.50, "avg": 482.50, "max": 482.50, "min": 482.50, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 260.69, "avg": 260.69, "max": 260.69, "min": 260.69, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 220.87, "avg": 220.87, "max": 220.87, "min": 220.87, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.29, "avg": 3.29, "max": 3.29, "min": 3.29, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 95, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 67.48, "avg": 22.49, "max": 1.32, "min": 63.20, "cnt": 3}, "forward-compute":{"total": 1791.84, "avg": 56.00, "max": 50.85, "min": 60.16, "cnt": 32}, "fwd-compute":{"total": 1788.66, "avg": 55.90, "max": 50.78, "min": 60.03, "cnt": 32}, "batch-generator":{"total": 50.21, "avg": 1.57, "max": 0.70, "min": 3.25, "cnt": 32}, "fwd-embedding":{"total": 0.68, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1725.78, "avg": 53.93, "max": 49.80, "min": 58.19, "cnt": 32}, "fwd-layernorm":{"total": 9.84, "avg": 0.08, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 109.22, "avg": 0.85, "max": 0.75, "min": 1.52, "cnt": 128}, "fwd-misc":{"total": 20.87, "avg": 0.16, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1565.17, "avg": 12.23, "max": 9.96, "min": 18.12, "cnt": 128}, "MoE_L0_fwd":{"total": 444.73, "avg": 13.90, "max": 10.77, "min": 18.02, "cnt": 32}, "MoEMLP":{"total": 1548.36, "avg": 12.10, "max": 9.83, "min": 17.98, "cnt": 128}, "MoE_L1_fwd":{"total": 391.07, "avg": 12.22, "max": 11.17, "min": 15.70, "cnt": 32}, "MoE_L2_fwd":{"total": 383.42, "avg": 11.98, "max": 11.35, "min": 12.82, "cnt": 32}, "MoE_L3_fwd":{"total": 335.35, "avg": 10.48, "max": 9.89, "min": 11.30, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.52, "avg": 0.76, "max": 0.75, "min": 0.77, "cnt": 2}, "forward-send-backward-recv":{"total": 459.36, "avg": 15.31, "max": 1.60, "min": 125.93, "cnt": 30}, "backward-compute":{"total": 1498.14, "avg": 46.82, "max": 44.84, "min": 49.28, "cnt": 32}, "MoE_L3_bwd":{"total": 329.28, "avg": 10.29, "max": 8.18, "min": 11.19, "cnt": 32}, "MoE_L2_bwd":{"total": 341.58, "avg": 10.67, "max": 9.64, "min": 11.31, "cnt": 32}, "MoE_L1_bwd":{"total": 331.48, "avg": 10.36, "max": 9.94, "min": 11.38, "cnt": 32}, "MoE_L0_bwd":{"total": 276.46, "avg": 8.64, "max": 8.14, "min": 9.05, "cnt": 32}, "backward-send-forward-recv":{"total": 2297.63, "avg": 79.23, "max": 2.30, "min": 318.12, "cnt": 29}, "backward-send":{"total": 2.58, "avg": 0.86, "max": 0.64, "min": 1.09, "cnt": 3}, "backward-recv":{"total": 125.87, "avg": 62.93, "max": 59.55, "min": 66.31, "cnt": 2}, "backward-params-all-reduce":{"total": 488.77, "avg": 488.77, "max": 488.77, "min": 488.77, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 247.86, "avg": 247.86, "max": 247.86, "min": 247.86, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 207.78, "avg": 207.78, "max": 207.78, "min": 207.78, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.53, "avg": 3.53, "max": 3.53, "min": 3.53, "cnt": 1}}}
{"type":"time", "iteration": 96, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.06, "avg": 0.06, "max": 0.06, "min": 0.06, "cnt": 1}, "forward-recv":{"total": 66.26, "avg": 22.09, "max": 2.97, "min": 60.14, "cnt": 3}, "forward-compute":{"total": 1754.25, "avg": 54.82, "max": 48.87, "min": 65.18, "cnt": 32}, "fwd-compute":{"total": 1751.39, "avg": 54.73, "max": 48.81, "min": 65.05, "cnt": 32}, "batch-generator":{"total": 34.22, "avg": 1.07, "max": 0.66, "min": 1.70, "cnt": 32}, "fwd-embedding":{"total": 0.50, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1705.61, "avg": 53.30, "max": 47.85, "min": 62.89, "cnt": 32}, "fwd-layernorm":{"total": 9.10, "avg": 0.07, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 105.84, "avg": 0.83, "max": 0.74, "min": 1.54, "cnt": 128}, "fwd-misc":{"total": 19.57, "avg": 0.15, "max": 0.11, "min": 0.56, "cnt": 128}, "fwd-MLP":{"total": 1551.83, "avg": 12.12, "max": 9.85, "min": 19.10, "cnt": 128}, "MoE_L0_fwd":{"total": 441.74, "avg": 13.80, "max": 10.57, "min": 19.03, "cnt": 32}, "MoEMLP":{"total": 1535.94, "avg": 12.00, "max": 9.74, "min": 18.99, "cnt": 128}, "MoE_L1_fwd":{"total": 390.33, "avg": 12.20, "max": 11.19, "min": 15.48, "cnt": 32}, "MoE_L2_fwd":{"total": 365.83, "avg": 11.43, "max": 10.69, "min": 14.71, "cnt": 32}, "MoE_L3_fwd":{"total": 343.76, "avg": 10.74, "max": 9.78, "min": 14.74, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.65, "avg": 0.82, "max": 0.79, "min": 0.86, "cnt": 2}, "forward-send-backward-recv":{"total": 166.89, "avg": 5.56, "max": 1.37, "min": 100.33, "cnt": 30}, "backward-compute":{"total": 1509.32, "avg": 47.17, "max": 43.26, "min": 49.37, "cnt": 32}, "MoE_L3_bwd":{"total": 340.59, "avg": 10.64, "max": 8.75, "min": 12.12, "cnt": 32}, "MoE_L2_bwd":{"total": 334.30, "avg": 10.45, "max": 9.55, "min": 11.68, "cnt": 32}, "MoE_L1_bwd":{"total": 337.40, "avg": 10.54, "max": 9.94, "min": 12.35, "cnt": 32}, "MoE_L0_bwd":{"total": 280.96, "avg": 8.78, "max": 8.30, "min": 9.49, "cnt": 32}, "backward-send-forward-recv":{"total": 2679.16, "avg": 92.38, "max": 2.06, "min": 274.52, "cnt": 29}, "backward-send":{"total": 2.15, "avg": 0.72, "max": 0.63, "min": 0.84, "cnt": 3}, "backward-recv":{"total": 175.00, "avg": 87.50, "max": 67.91, "min": 107.09, "cnt": 2}, "backward-params-all-reduce":{"total": 489.21, "avg": 489.21, "max": 489.21, "min": 489.21, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 250.06, "avg": 250.06, "max": 250.06, "min": 250.06, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.40, "avg": 3.40, "max": 3.40, "min": 3.40, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 209.91, "avg": 209.91, "max": 209.91, "min": 209.91, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.71, "avg": 3.71, "max": 3.71, "min": 3.71, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 97, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 60.90, "avg": 20.30, "max": 1.26, "min": 54.11, "cnt": 3}, "forward-compute":{"total": 1787.83, "avg": 55.87, "max": 48.30, "min": 59.90, "cnt": 32}, "fwd-compute":{"total": 1784.81, "avg": 55.78, "max": 48.22, "min": 59.78, "cnt": 32}, "batch-generator":{"total": 48.20, "avg": 1.51, "max": 0.65, "min": 4.16, "cnt": 32}, "fwd-embedding":{"total": 0.73, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1724.25, "avg": 53.88, "max": 47.22, "min": 57.52, "cnt": 32}, "fwd-layernorm":{"total": 10.57, "avg": 0.08, "max": 0.05, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 114.03, "avg": 0.89, "max": 0.75, "min": 2.22, "cnt": 128}, "fwd-misc":{"total": 22.43, "avg": 0.18, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1555.49, "avg": 12.15, "max": 9.96, "min": 16.67, "cnt": 128}, "MoE_L0_fwd":{"total": 450.69, "avg": 14.08, "max": 10.26, "min": 16.58, "cnt": 32}, "MoEMLP":{"total": 1537.80, "avg": 12.01, "max": 9.85, "min": 16.53, "cnt": 128}, "MoE_L1_fwd":{"total": 391.96, "avg": 12.25, "max": 11.18, "min": 14.15, "cnt": 32}, "MoE_L2_fwd":{"total": 362.11, "avg": 11.32, "max": 10.55, "min": 14.35, "cnt": 32}, "MoE_L3_fwd":{"total": 339.53, "avg": 10.61, "max": 9.89, "min": 11.51, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.55, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.92, "avg": 0.96, "max": 0.92, "min": 1.01, "cnt": 2}, "forward-send-backward-recv":{"total": 324.03, "avg": 10.80, "max": 1.34, "min": 113.22, "cnt": 30}, "backward-compute":{"total": 1516.74, "avg": 47.40, "max": 45.90, "min": 51.86, "cnt": 32}, "MoE_L3_bwd":{"total": 356.28, "avg": 11.13, "max": 10.02, "min": 15.20, "cnt": 32}, "MoE_L2_bwd":{"total": 330.57, "avg": 10.33, "max": 9.17, "min": 12.45, "cnt": 32}, "MoE_L1_bwd":{"total": 332.06, "avg": 10.38, "max": 9.85, "min": 11.99, "cnt": 32}, "MoE_L0_bwd":{"total": 281.65, "avg": 8.80, "max": 8.35, "min": 9.07, "cnt": 32}, "backward-send-forward-recv":{"total": 2548.68, "avg": 87.89, "max": 2.26, "min": 484.11, "cnt": 29}, "backward-send":{"total": 2.27, "avg": 0.76, "max": 0.62, "min": 1.00, "cnt": 3}, "backward-recv":{"total": 170.34, "avg": 85.17, "max": 69.33, "min": 101.00, "cnt": 2}, "backward-params-all-reduce":{"total": 490.46, "avg": 490.46, "max": 490.46, "min": 490.46, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 245.20, "avg": 245.20, "max": 245.20, "min": 245.20, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 205.37, "avg": 205.37, "max": 205.37, "min": 205.37, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.26, "avg": 3.26, "max": 3.26, "min": 3.26, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.52, "avg": 3.52, "max": 3.52, "min": 3.52, "cnt": 1}}}
{"type":"time", "iteration": 98, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 69.44, "avg": 23.15, "max": 1.97, "min": 64.17, "cnt": 3}, "forward-compute":{"total": 1752.01, "avg": 54.75, "max": 50.14, "min": 61.96, "cnt": 32}, "fwd-compute":{"total": 1749.14, "avg": 54.66, "max": 50.06, "min": 61.88, "cnt": 32}, "batch-generator":{"total": 48.48, "avg": 1.52, "max": 0.75, "min": 4.49, "cnt": 32}, "fwd-embedding":{"total": 0.56, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1689.09, "avg": 52.78, "max": 47.76, "min": 59.38, "cnt": 32}, "fwd-layernorm":{"total": 9.43, "avg": 0.07, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 106.08, "avg": 0.83, "max": 0.74, "min": 1.52, "cnt": 128}, "fwd-misc":{"total": 19.66, "avg": 0.15, "max": 0.11, "min": 0.34, "cnt": 128}, "fwd-MLP":{"total": 1533.86, "avg": 11.98, "max": 10.06, "min": 17.04, "cnt": 128}, "MoE_L0_fwd":{"total": 427.64, "avg": 13.36, "max": 10.43, "min": 16.92, "cnt": 32}, "MoEMLP":{"total": 1517.60, "avg": 11.86, "max": 9.96, "min": 16.86, "cnt": 128}, "MoE_L1_fwd":{"total": 384.34, "avg": 12.01, "max": 10.94, "min": 14.14, "cnt": 32}, "MoE_L2_fwd":{"total": 362.85, "avg": 11.34, "max": 10.77, "min": 12.55, "cnt": 32}, "MoE_L3_fwd":{"total": 348.70, "avg": 10.90, "max": 10.00, "min": 14.10, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.98, "avg": 0.99, "max": 0.98, "min": 1.00, "cnt": 2}, "forward-send-backward-recv":{"total": 1202.66, "avg": 40.09, "max": 1.70, "min": 245.77, "cnt": 30}, "backward-compute":{"total": 1492.81, "avg": 46.65, "max": 43.17, "min": 49.37, "cnt": 32}, "MoE_L3_bwd":{"total": 349.27, "avg": 10.91, "max": 9.42, "min": 13.01, "cnt": 32}, "MoE_L2_bwd":{"total": 324.18, "avg": 10.13, "max": 8.55, "min": 11.06, "cnt": 32}, "MoE_L1_bwd":{"total": 319.89, "avg": 10.00, "max": 9.49, "min": 10.80, "cnt": 32}, "MoE_L0_bwd":{"total": 282.60, "avg": 8.83, "max": 8.26, "min": 9.12, "cnt": 32}, "backward-send-forward-recv":{"total": 2469.25, "avg": 85.15, "max": 1.84, "min": 506.12, "cnt": 29}, "backward-send":{"total": 2.13, "avg": 0.71, "max": 0.44, "min": 1.10, "cnt": 3}, "backward-recv":{"total": 299.62, "avg": 149.81, "max": 64.42, "min": 235.20, "cnt": 2}, "backward-params-all-reduce":{"total": 493.91, "avg": 493.91, "max": 493.91, "min": 493.91, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 256.76, "avg": 256.76, "max": 256.76, "min": 256.76, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 216.93, "avg": 216.93, "max": 216.93, "min": 216.93, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.32, "avg": 3.32, "max": 3.32, "min": 3.32, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.47, "avg": 3.47, "max": 3.47, "min": 3.47, "cnt": 1}}}
{"type":"time", "iteration": 99, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 73.09, "avg": 24.36, "max": 1.25, "min": 62.83, "cnt": 3}, "forward-compute":{"total": 1802.86, "avg": 56.34, "max": 48.25, "min": 64.07, "cnt": 32}, "fwd-compute":{"total": 1799.82, "avg": 56.24, "max": 48.16, "min": 63.98, "cnt": 32}, "batch-generator":{"total": 42.18, "avg": 1.32, "max": 0.70, "min": 2.53, "cnt": 32}, "fwd-embedding":{"total": 0.61, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1745.34, "avg": 54.54, "max": 47.16, "min": 61.77, "cnt": 32}, "fwd-layernorm":{"total": 9.65, "avg": 0.08, "max": 0.05, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 108.97, "avg": 0.85, "max": 0.74, "min": 1.54, "cnt": 128}, "fwd-misc":{"total": 20.75, "avg": 0.16, "max": 0.11, "min": 0.39, "cnt": 128}, "fwd-MLP":{"total": 1585.65, "avg": 12.39, "max": 10.07, "min": 22.12, "cnt": 128}, "MoE_L0_fwd":{"total": 482.38, "avg": 15.07, "max": 10.55, "min": 21.96, "cnt": 32}, "MoEMLP":{"total": 1568.86, "avg": 12.26, "max": 9.97, "min": 21.92, "cnt": 128}, "MoE_L1_fwd":{"total": 389.25, "avg": 12.16, "max": 10.89, "min": 14.16, "cnt": 32}, "MoE_L2_fwd":{"total": 358.98, "avg": 11.22, "max": 10.42, "min": 12.21, "cnt": 32}, "MoE_L3_fwd":{"total": 344.36, "avg": 10.76, "max": 10.01, "min": 11.65, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.05, "cnt": 32}, "forward-send":{"total": 2.20, "avg": 1.10, "max": 0.95, "min": 1.25, "cnt": 2}, "forward-send-backward-recv":{"total": 197.14, "avg": 6.57, "max": 1.60, "min": 100.26, "cnt": 30}, "backward-compute":{"total": 1527.05, "avg": 47.72, "max": 45.19, "min": 69.29, "cnt": 32}, "MoE_L3_bwd":{"total": 376.21, "avg": 11.76, "max": 9.87, "min": 34.79, "cnt": 32}, "MoE_L2_bwd":{"total": 333.33, "avg": 10.42, "max": 9.61, "min": 10.96, "cnt": 32}, "MoE_L1_bwd":{"total": 319.48, "avg": 9.98, "max": 9.45, "min": 11.92, "cnt": 32}, "MoE_L0_bwd":{"total": 289.43, "avg": 9.04, "max": 8.48, "min": 12.82, "cnt": 32}, "backward-send-forward-recv":{"total": 5523.72, "avg": 190.47, "max": 2.12, "min": 1430.89, "cnt": 29}, "backward-send":{"total": 2.17, "avg": 0.72, "max": 0.44, "min": 0.96, "cnt": 3}, "backward-recv":{"total": 143.51, "avg": 71.75, "max": 67.61, "min": 75.90, "cnt": 2}, "backward-params-all-reduce":{"total": 486.50, "avg": 486.50, "max": 486.50, "min": 486.50, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 248.03, "avg": 248.03, "max": 248.03, "min": 248.03, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 208.15, "avg": 208.15, "max": 208.15, "min": 208.15, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.33, "avg": 3.33, "max": 3.33, "min": 3.33, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 100, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 197.39, "avg": 65.80, "max": 0.98, "min": 195.39, "cnt": 3}, "forward-compute":{"total": 1931.64, "avg": 60.36, "max": 48.67, "min": 194.21, "cnt": 32}, "fwd-compute":{"total": 1928.62, "avg": 60.27, "max": 48.59, "min": 194.12, "cnt": 32}, "batch-generator":{"total": 43.23, "avg": 1.35, "max": 0.73, "min": 2.45, "cnt": 32}, "fwd-embedding":{"total": 0.64, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1873.17, "avg": 58.54, "max": 46.86, "min": 192.93, "cnt": 32}, "fwd-layernorm":{"total": 9.82, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 110.54, "avg": 0.86, "max": 0.74, "min": 1.71, "cnt": 128}, "fwd-misc":{"total": 20.88, "avg": 0.16, "max": 0.11, "min": 0.48, "cnt": 128}, "fwd-MLP":{"total": 1711.20, "avg": 13.37, "max": 10.21, "min": 143.26, "cnt": 128}, "MoE_L0_fwd":{"total": 474.84, "avg": 14.84, "max": 10.86, "min": 21.09, "cnt": 32}, "MoEMLP":{"total": 1694.05, "avg": 13.23, "max": 10.11, "min": 143.16, "cnt": 128}, "MoE_L1_fwd":{"total": 506.83, "avg": 15.84, "max": 10.60, "min": 143.19, "cnt": 32}, "MoE_L2_fwd":{"total": 363.07, "avg": 11.35, "max": 10.54, "min": 12.52, "cnt": 32}, "MoE_L3_fwd":{"total": 355.48, "avg": 11.11, "max": 10.15, "min": 12.93, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.56, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 147.41, "avg": 73.70, "max": 0.80, "min": 146.60, "cnt": 2}, "forward-send-backward-recv":{"total": 231.59, "avg": 7.72, "max": 1.68, "min": 103.11, "cnt": 30}, "backward-compute":{"total": 1476.07, "avg": 46.13, "max": 41.28, "min": 50.25, "cnt": 32}, "MoE_L3_bwd":{"total": 357.01, "avg": 11.16, "max": 9.06, "min": 12.55, "cnt": 32}, "MoE_L2_bwd":{"total": 329.54, "avg": 10.30, "max": 8.91, "min": 11.31, "cnt": 32}, "MoE_L1_bwd":{"total": 275.20, "avg": 8.60, "max": 8.00, "min": 10.43, "cnt": 32}, "MoE_L0_bwd":{"total": 298.43, "avg": 9.33, "max": 8.44, "min": 12.33, "cnt": 32}, "backward-send-forward-recv":{"total": 3076.13, "avg": 106.07, "max": 2.05, "min": 502.92, "cnt": 29}, "backward-send":{"total": 1.62, "avg": 0.54, "max": 0.47, "min": 0.60, "cnt": 3}, "backward-recv":{"total": 134.52, "avg": 67.26, "max": 64.87, "min": 69.65, "cnt": 2}, "backward-params-all-reduce":{"total": 488.87, "avg": 488.87, "max": 488.87, "min": 488.87, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 246.93, "avg": 246.93, "max": 246.93, "min": 246.93, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 207.01, "avg": 207.01, "max": 207.01, "min": 207.01, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.32, "avg": 3.32, "max": 3.32, "min": 3.32, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.48, "avg": 3.48, "max": 3.48, "min": 3.48, "cnt": 1}}}
{"type":"time", "iteration": 101, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 64.26, "avg": 21.42, "max": 1.24, "min": 61.76, "cnt": 3}, "forward-compute":{"total": 1795.49, "avg": 56.11, "max": 48.91, "min": 61.48, "cnt": 32}, "fwd-compute":{"total": 1792.29, "avg": 56.01, "max": 48.84, "min": 61.34, "cnt": 32}, "batch-generator":{"total": 39.60, "avg": 1.24, "max": 0.73, "min": 2.29, "cnt": 32}, "fwd-embedding":{"total": 0.67, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1740.09, "avg": 54.38, "max": 47.69, "min": 59.33, "cnt": 32}, "fwd-layernorm":{"total": 10.02, "avg": 0.08, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 108.87, "avg": 0.85, "max": 0.74, "min": 2.23, "cnt": 128}, "fwd-misc":{"total": 21.20, "avg": 0.17, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1579.18, "avg": 12.34, "max": 10.03, "min": 20.74, "cnt": 128}, "MoE_L0_fwd":{"total": 483.60, "avg": 15.11, "max": 10.96, "min": 20.67, "cnt": 32}, "MoEMLP":{"total": 1561.76, "avg": 12.20, "max": 9.92, "min": 20.63, "cnt": 128}, "MoE_L1_fwd":{"total": 362.40, "avg": 11.32, "max": 9.96, "min": 14.28, "cnt": 32}, "MoE_L2_fwd":{"total": 367.81, "avg": 11.49, "max": 10.96, "min": 12.35, "cnt": 32}, "MoE_L3_fwd":{"total": 354.24, "avg": 11.07, "max": 10.26, "min": 12.73, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.92, "avg": 0.96, "max": 0.96, "min": 0.97, "cnt": 2}, "forward-send-backward-recv":{"total": 1848.05, "avg": 61.60, "max": 1.59, "min": 244.81, "cnt": 30}, "backward-compute":{"total": 1556.11, "avg": 48.63, "max": 44.19, "min": 131.19, "cnt": 32}, "MoE_L3_bwd":{"total": 367.49, "avg": 11.48, "max": 10.07, "min": 13.60, "cnt": 32}, "MoE_L2_bwd":{"total": 327.05, "avg": 10.22, "max": 9.30, "min": 11.06, "cnt": 32}, "MoE_L1_bwd":{"total": 348.12, "avg": 10.88, "max": 7.75, "min": 92.94, "cnt": 32}, "MoE_L0_bwd":{"total": 297.12, "avg": 9.28, "max": 8.85, "min": 9.79, "cnt": 32}, "backward-send-forward-recv":{"total": 1020.96, "avg": 35.21, "max": 1.60, "min": 148.17, "cnt": 29}, "backward-send":{"total": 2.09, "avg": 0.70, "max": 0.55, "min": 0.96, "cnt": 3}, "backward-recv":{"total": 303.46, "avg": 151.73, "max": 67.90, "min": 235.56, "cnt": 2}, "backward-params-all-reduce":{"total": 479.67, "avg": 479.67, "max": 479.67, "min": 479.67, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 251.96, "avg": 251.96, "max": 251.96, "min": 251.96, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.41, "avg": 3.41, "max": 3.41, "min": 3.41, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 212.11, "avg": 212.11, "max": 212.11, "min": 212.11, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.25, "avg": 3.25, "max": 3.25, "min": 3.25, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.51, "avg": 3.51, "max": 3.51, "min": 3.51, "cnt": 1}}}
{"type":"time", "iteration": 102, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 60.34, "avg": 20.11, "max": 1.20, "min": 57.88, "cnt": 3}, "forward-compute":{"total": 1816.59, "avg": 56.77, "max": 48.23, "min": 69.97, "cnt": 32}, "fwd-compute":{"total": 1813.55, "avg": 56.67, "max": 48.16, "min": 69.88, "cnt": 32}, "batch-generator":{"total": 47.08, "avg": 1.47, "max": 0.65, "min": 3.53, "cnt": 32}, "fwd-embedding":{"total": 0.60, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1754.80, "avg": 54.84, "max": 47.22, "min": 68.71, "cnt": 32}, "fwd-layernorm":{"total": 9.52, "avg": 0.07, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 107.08, "avg": 0.84, "max": 0.74, "min": 1.50, "cnt": 128}, "fwd-misc":{"total": 20.07, "avg": 0.16, "max": 0.11, "min": 0.34, "cnt": 128}, "fwd-MLP":{"total": 1598.25, "avg": 12.49, "max": 10.39, "min": 21.97, "cnt": 128}, "MoE_L0_fwd":{"total": 477.47, "avg": 14.92, "max": 10.66, "min": 21.88, "cnt": 32}, "MoEMLP":{"total": 1581.94, "avg": 12.36, "max": 10.29, "min": 21.83, "cnt": 128}, "MoE_L1_fwd":{"total": 385.64, "avg": 12.05, "max": 10.49, "min": 15.44, "cnt": 32}, "MoE_L2_fwd":{"total": 367.72, "avg": 11.49, "max": 10.73, "min": 15.83, "cnt": 32}, "MoE_L3_fwd":{"total": 357.13, "avg": 11.16, "max": 10.33, "min": 13.53, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.86, "avg": 0.93, "max": 0.85, "min": 1.01, "cnt": 2}, "forward-send-backward-recv":{"total": 319.21, "avg": 10.64, "max": 1.21, "min": 120.31, "cnt": 30}, "backward-compute":{"total": 1476.72, "avg": 46.15, "max": 43.37, "min": 49.17, "cnt": 32}, "MoE_L3_bwd":{"total": 364.33, "avg": 11.39, "max": 9.81, "min": 12.36, "cnt": 32}, "MoE_L2_bwd":{"total": 323.41, "avg": 10.11, "max": 9.29, "min": 10.75, "cnt": 32}, "MoE_L1_bwd":{"total": 276.36, "avg": 8.64, "max": 8.05, "min": 12.24, "cnt": 32}, "MoE_L0_bwd":{"total": 295.35, "avg": 9.23, "max": 8.86, "min": 9.76, "cnt": 32}, "backward-send-forward-recv":{"total": 3106.11, "avg": 107.11, "max": 1.61, "min": 453.69, "cnt": 29}, "backward-send":{"total": 3.42, "avg": 1.14, "max": 0.90, "min": 1.29, "cnt": 3}, "backward-recv":{"total": 125.05, "avg": 62.53, "max": 59.92, "min": 65.14, "cnt": 2}, "backward-params-all-reduce":{"total": 486.02, "avg": 486.02, "max": 486.02, "min": 486.02, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 246.44, "avg": 246.44, "max": 246.44, "min": 246.44, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 206.67, "avg": 206.67, "max": 206.67, "min": 206.67, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.27, "avg": 3.27, "max": 3.27, "min": 3.27, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.47, "avg": 3.47, "max": 3.47, "min": 3.47, "cnt": 1}}}
{"type":"time", "iteration": 103, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 66.27, "avg": 22.09, "max": 0.98, "min": 64.07, "cnt": 3}, "forward-compute":{"total": 1814.23, "avg": 56.69, "max": 48.88, "min": 67.17, "cnt": 32}, "fwd-compute":{"total": 1811.02, "avg": 56.59, "max": 48.81, "min": 67.09, "cnt": 32}, "batch-generator":{"total": 43.30, "avg": 1.35, "max": 0.65, "min": 2.92, "cnt": 32}, "fwd-embedding":{"total": 0.64, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1755.06, "avg": 54.85, "max": 47.87, "min": 65.90, "cnt": 32}, "fwd-layernorm":{"total": 9.83, "avg": 0.08, "max": 0.05, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 108.67, "avg": 0.85, "max": 0.74, "min": 1.50, "cnt": 128}, "fwd-misc":{"total": 20.41, "avg": 0.16, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1595.47, "avg": 12.46, "max": 10.65, "min": 19.33, "cnt": 128}, "MoE_L0_fwd":{"total": 473.97, "avg": 14.81, "max": 10.65, "min": 19.22, "cnt": 32}, "MoEMLP":{"total": 1578.91, "avg": 12.34, "max": 10.53, "min": 19.15, "cnt": 128}, "MoE_L1_fwd":{"total": 390.04, "avg": 12.19, "max": 10.81, "min": 17.17, "cnt": 32}, "MoE_L2_fwd":{"total": 362.62, "avg": 11.33, "max": 10.68, "min": 13.40, "cnt": 32}, "MoE_L3_fwd":{"total": 358.26, "avg": 11.20, "max": 10.57, "min": 12.45, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 9.17, "avg": 4.58, "max": 0.86, "min": 8.31, "cnt": 2}, "forward-send-backward-recv":{"total": 179.53, "avg": 5.98, "max": 1.76, "min": 106.19, "cnt": 30}, "backward-compute":{"total": 1469.58, "avg": 45.92, "max": 44.12, "min": 47.43, "cnt": 32}, "MoE_L3_bwd":{"total": 360.48, "avg": 11.27, "max": 10.01, "min": 12.14, "cnt": 32}, "MoE_L2_bwd":{"total": 321.30, "avg": 10.04, "max": 9.29, "min": 10.74, "cnt": 32}, "MoE_L1_bwd":{"total": 280.65, "avg": 8.77, "max": 8.39, "min": 9.34, "cnt": 32}, "MoE_L0_bwd":{"total": 294.49, "avg": 9.20, "max": 8.76, "min": 10.11, "cnt": 32}, "backward-send-forward-recv":{"total": 3556.42, "avg": 122.64, "max": 1.64, "min": 606.70, "cnt": 29}, "backward-send":{"total": 1.87, "avg": 0.62, "max": 0.62, "min": 0.63, "cnt": 3}, "backward-recv":{"total": 123.49, "avg": 61.74, "max": 54.86, "min": 68.63, "cnt": 2}, "backward-params-all-reduce":{"total": 489.31, "avg": 489.31, "max": 489.31, "min": 489.31, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 244.43, "avg": 244.43, "max": 244.43, "min": 244.43, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.53, "avg": 3.53, "max": 3.53, "min": 3.53, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 204.51, "avg": 204.51, "max": 204.51, "min": 204.51, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.25, "avg": 3.25, "max": 3.25, "min": 3.25, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.49, "avg": 3.49, "max": 3.49, "min": 3.49, "cnt": 1}}}
{"type":"time", "iteration": 104, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 65.67, "avg": 21.89, "max": 1.05, "min": 63.54, "cnt": 3}, "forward-compute":{"total": 1882.31, "avg": 58.82, "max": 50.34, "min": 68.69, "cnt": 32}, "fwd-compute":{"total": 1878.96, "avg": 58.72, "max": 50.26, "min": 68.56, "cnt": 32}, "batch-generator":{"total": 42.41, "avg": 1.33, "max": 0.67, "min": 2.45, "cnt": 32}, "fwd-embedding":{"total": 0.67, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1824.20, "avg": 57.01, "max": 49.20, "min": 66.57, "cnt": 32}, "fwd-layernorm":{"total": 10.17, "avg": 0.08, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 110.86, "avg": 0.87, "max": 0.74, "min": 1.82, "cnt": 128}, "fwd-misc":{"total": 21.54, "avg": 0.17, "max": 0.11, "min": 0.50, "cnt": 128}, "fwd-MLP":{"total": 1660.48, "avg": 12.97, "max": 10.35, "min": 24.46, "cnt": 128}, "MoE_L0_fwd":{"total": 524.38, "avg": 16.39, "max": 11.73, "min": 24.33, "cnt": 32}, "MoEMLP":{"total": 1642.83, "avg": 12.83, "max": 10.24, "min": 24.26, "cnt": 128}, "MoE_L1_fwd":{"total": 395.35, "avg": 12.35, "max": 10.99, "min": 16.95, "cnt": 32}, "MoE_L2_fwd":{"total": 375.61, "avg": 11.74, "max": 10.76, "min": 16.85, "cnt": 32}, "MoE_L3_fwd":{"total": 353.78, "avg": 11.06, "max": 10.28, "min": 11.98, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.62, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 2.04, "avg": 1.02, "max": 1.01, "min": 1.04, "cnt": 2}, "forward-send-backward-recv":{"total": 639.22, "avg": 21.31, "max": 1.60, "min": 130.23, "cnt": 30}, "backward-compute":{"total": 1493.41, "avg": 46.67, "max": 43.94, "min": 48.72, "cnt": 32}, "MoE_L3_bwd":{"total": 367.91, "avg": 11.50, "max": 10.02, "min": 13.16, "cnt": 32}, "MoE_L2_bwd":{"total": 320.58, "avg": 10.02, "max": 9.13, "min": 10.61, "cnt": 32}, "MoE_L1_bwd":{"total": 283.56, "avg": 8.86, "max": 8.55, "min": 9.97, "cnt": 32}, "MoE_L0_bwd":{"total": 303.31, "avg": 9.48, "max": 8.98, "min": 11.16, "cnt": 32}, "backward-send-forward-recv":{"total": 2276.32, "avg": 78.49, "max": 1.55, "min": 568.74, "cnt": 29}, "backward-send":{"total": 2.37, "avg": 0.79, "max": 0.46, "min": 1.02, "cnt": 3}, "backward-recv":{"total": 285.96, "avg": 142.98, "max": 122.78, "min": 163.17, "cnt": 2}, "backward-params-all-reduce":{"total": 487.47, "avg": 487.47, "max": 487.47, "min": 487.47, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 250.76, "avg": 250.76, "max": 250.76, "min": 250.76, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 210.85, "avg": 210.85, "max": 210.85, "min": 210.85, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.40, "avg": 3.40, "max": 3.40, "min": 3.40, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.48, "avg": 3.48, "max": 3.48, "min": 3.48, "cnt": 1}}}
{"type":"time", "iteration": 105, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.06, "avg": 0.06, "max": 0.06, "min": 0.06, "cnt": 1}, "forward-recv":{"total": 71.02, "avg": 23.67, "max": 0.95, "min": 64.57, "cnt": 3}, "forward-compute":{"total": 1788.32, "avg": 55.89, "max": 49.67, "min": 64.37, "cnt": 32}, "fwd-compute":{"total": 1785.41, "avg": 55.79, "max": 49.59, "min": 64.28, "cnt": 32}, "batch-generator":{"total": 41.00, "avg": 1.28, "max": 0.73, "min": 4.06, "cnt": 32}, "fwd-embedding":{"total": 0.52, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1732.94, "avg": 54.15, "max": 48.49, "min": 62.84, "cnt": 32}, "fwd-layernorm":{"total": 9.22, "avg": 0.07, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 105.88, "avg": 0.83, "max": 0.75, "min": 1.44, "cnt": 128}, "fwd-misc":{"total": 19.31, "avg": 0.15, "max": 0.11, "min": 0.33, "cnt": 128}, "fwd-MLP":{"total": 1578.65, "avg": 12.33, "max": 10.38, "min": 21.57, "cnt": 128}, "MoE_L0_fwd":{"total": 468.34, "avg": 14.64, "max": 11.46, "min": 21.48, "cnt": 32}, "MoEMLP":{"total": 1562.65, "avg": 12.21, "max": 10.28, "min": 21.44, "cnt": 128}, "MoE_L1_fwd":{"total": 378.09, "avg": 11.82, "max": 10.73, "min": 16.86, "cnt": 32}, "MoE_L2_fwd":{"total": 365.79, "avg": 11.43, "max": 10.75, "min": 13.98, "cnt": 32}, "MoE_L3_fwd":{"total": 356.30, "avg": 11.13, "max": 10.31, "min": 15.32, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.96, "avg": 0.98, "max": 0.93, "min": 1.02, "cnt": 2}, "forward-send-backward-recv":{"total": 784.65, "avg": 26.16, "max": 1.30, "min": 248.77, "cnt": 30}, "backward-compute":{"total": 1488.59, "avg": 46.52, "max": 44.26, "min": 47.94, "cnt": 32}, "MoE_L3_bwd":{"total": 365.47, "avg": 11.42, "max": 9.54, "min": 12.97, "cnt": 32}, "MoE_L2_bwd":{"total": 324.69, "avg": 10.15, "max": 9.00, "min": 10.83, "cnt": 32}, "MoE_L1_bwd":{"total": 282.35, "avg": 8.82, "max": 8.28, "min": 9.87, "cnt": 32}, "MoE_L0_bwd":{"total": 298.28, "avg": 9.32, "max": 8.89, "min": 9.81, "cnt": 32}, "backward-send-forward-recv":{"total": 3783.80, "avg": 130.48, "max": 1.64, "min": 887.28, "cnt": 29}, "backward-send":{"total": 9.89, "avg": 3.30, "max": 0.56, "min": 8.55, "cnt": 3}, "backward-recv":{"total": 401.16, "avg": 200.58, "max": 71.84, "min": 329.32, "cnt": 2}, "backward-params-all-reduce":{"total": 483.71, "avg": 483.71, "max": 483.71, "min": 483.71, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 250.91, "avg": 250.91, "max": 250.91, "min": 250.91, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 210.94, "avg": 210.94, "max": 210.94, "min": 210.94, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.57, "avg": 3.57, "max": 3.57, "min": 3.57, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.41, "avg": 3.41, "max": 3.41, "min": 3.41, "cnt": 1}}}
{"type":"time", "iteration": 106, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 69.73, "avg": 23.24, "max": 1.30, "min": 59.77, "cnt": 3}, "forward-compute":{"total": 1837.18, "avg": 57.41, "max": 49.15, "min": 64.67, "cnt": 32}, "fwd-compute":{"total": 1834.26, "avg": 57.32, "max": 49.09, "min": 64.58, "cnt": 32}, "batch-generator":{"total": 43.14, "avg": 1.35, "max": 0.66, "min": 2.53, "cnt": 32}, "fwd-embedding":{"total": 0.56, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1779.28, "avg": 55.60, "max": 48.13, "min": 61.97, "cnt": 32}, "fwd-layernorm":{"total": 9.45, "avg": 0.07, "max": 0.05, "min": 0.22, "cnt": 128}, "fwd-attn":{"total": 107.85, "avg": 0.84, "max": 0.74, "min": 2.30, "cnt": 128}, "fwd-misc":{"total": 19.74, "avg": 0.15, "max": 0.11, "min": 0.38, "cnt": 128}, "fwd-MLP":{"total": 1622.14, "avg": 12.67, "max": 10.40, "min": 22.53, "cnt": 128}, "MoE_L0_fwd":{"total": 500.38, "avg": 15.64, "max": 11.58, "min": 22.45, "cnt": 32}, "MoEMLP":{"total": 1605.62, "avg": 12.54, "max": 10.29, "min": 22.40, "cnt": 128}, "MoE_L1_fwd":{"total": 382.01, "avg": 11.94, "max": 10.33, "min": 14.97, "cnt": 32}, "MoE_L2_fwd":{"total": 374.67, "avg": 11.71, "max": 10.70, "min": 15.63, "cnt": 32}, "MoE_L3_fwd":{"total": 354.55, "avg": 11.08, "max": 10.56, "min": 12.10, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.56, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 2.91, "avg": 1.46, "max": 0.91, "min": 2.00, "cnt": 2}, "forward-send-backward-recv":{"total": 242.58, "avg": 8.09, "max": 1.43, "min": 100.42, "cnt": 30}, "backward-compute":{"total": 1508.38, "avg": 47.14, "max": 43.49, "min": 49.53, "cnt": 32}, "MoE_L3_bwd":{"total": 364.16, "avg": 11.38, "max": 9.91, "min": 12.36, "cnt": 32}, "MoE_L2_bwd":{"total": 322.19, "avg": 10.07, "max": 9.49, "min": 10.55, "cnt": 32}, "MoE_L1_bwd":{"total": 281.38, "avg": 8.79, "max": 8.16, "min": 9.67, "cnt": 32}, "MoE_L0_bwd":{"total": 316.96, "avg": 9.91, "max": 9.06, "min": 11.01, "cnt": 32}, "backward-send-forward-recv":{"total": 2765.07, "avg": 95.35, "max": 2.06, "min": 279.96, "cnt": 29}, "backward-send":{"total": 3.12, "avg": 1.04, "max": 0.77, "min": 1.26, "cnt": 3}, "backward-recv":{"total": 121.97, "avg": 60.99, "max": 55.12, "min": 66.86, "cnt": 2}, "backward-params-all-reduce":{"total": 487.07, "avg": 487.07, "max": 487.07, "min": 487.07, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 258.74, "avg": 258.74, "max": 258.74, "min": 258.74, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 218.88, "avg": 218.88, "max": 218.88, "min": 218.88, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.26, "avg": 3.26, "max": 3.26, "min": 3.26, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 107, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 56.59, "avg": 18.86, "max": 1.04, "min": 54.32, "cnt": 3}, "forward-compute":{"total": 1832.25, "avg": 57.26, "max": 49.53, "min": 62.81, "cnt": 32}, "fwd-compute":{"total": 1829.05, "avg": 57.16, "max": 49.46, "min": 62.69, "cnt": 32}, "batch-generator":{"total": 42.87, "avg": 1.34, "max": 0.64, "min": 2.26, "cnt": 32}, "fwd-embedding":{"total": 0.65, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1773.68, "avg": 55.43, "max": 48.54, "min": 60.73, "cnt": 32}, "fwd-layernorm":{"total": 10.28, "avg": 0.08, "max": 0.06, "min": 0.22, "cnt": 128}, "fwd-attn":{"total": 110.15, "avg": 0.86, "max": 0.74, "min": 1.92, "cnt": 128}, "fwd-misc":{"total": 21.66, "avg": 0.17, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1609.93, "avg": 12.58, "max": 10.54, "min": 20.64, "cnt": 128}, "MoE_L0_fwd":{"total": 484.54, "avg": 15.14, "max": 11.50, "min": 20.55, "cnt": 32}, "MoEMLP":{"total": 1592.23, "avg": 12.44, "max": 10.44, "min": 20.49, "cnt": 128}, "MoE_L1_fwd":{"total": 376.06, "avg": 11.75, "max": 10.77, "min": 12.87, "cnt": 32}, "MoE_L2_fwd":{"total": 376.52, "avg": 11.77, "max": 11.05, "min": 16.96, "cnt": 32}, "MoE_L3_fwd":{"total": 361.64, "avg": 11.30, "max": 10.48, "min": 13.86, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.71, "avg": 0.85, "max": 0.78, "min": 0.93, "cnt": 2}, "forward-send-backward-recv":{"total": 1723.99, "avg": 57.47, "max": 1.68, "min": 284.80, "cnt": 30}, "backward-compute":{"total": 1510.61, "avg": 47.21, "max": 44.29, "min": 49.81, "cnt": 32}, "MoE_L3_bwd":{"total": 365.58, "avg": 11.42, "max": 10.22, "min": 12.98, "cnt": 32}, "MoE_L2_bwd":{"total": 335.52, "avg": 10.48, "max": 9.50, "min": 12.13, "cnt": 32}, "MoE_L1_bwd":{"total": 281.01, "avg": 8.78, "max": 8.48, "min": 9.12, "cnt": 32}, "MoE_L0_bwd":{"total": 313.24, "avg": 9.79, "max": 8.95, "min": 11.78, "cnt": 32}, "backward-send-forward-recv":{"total": 1287.11, "avg": 44.38, "max": 1.98, "min": 238.16, "cnt": 29}, "backward-send":{"total": 2.63, "avg": 0.88, "max": 0.73, "min": 1.15, "cnt": 3}, "backward-recv":{"total": 293.88, "avg": 146.94, "max": 70.60, "min": 223.28, "cnt": 2}, "backward-params-all-reduce":{"total": 486.13, "avg": 486.13, "max": 486.13, "min": 486.13, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 244.94, "avg": 244.94, "max": 244.94, "min": 244.94, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.40, "avg": 3.40, "max": 3.40, "min": 3.40, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 204.95, "avg": 204.95, "max": 204.95, "min": 204.95, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.40, "avg": 3.40, "max": 3.40, "min": 3.40, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.51, "avg": 3.51, "max": 3.51, "min": 3.51, "cnt": 1}}}
{"type":"time", "iteration": 108, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 70.08, "avg": 23.36, "max": 6.05, "min": 57.37, "cnt": 3}, "forward-compute":{"total": 1779.01, "avg": 55.59, "max": 49.98, "min": 62.67, "cnt": 32}, "fwd-compute":{"total": 1775.83, "avg": 55.49, "max": 49.90, "min": 62.59, "cnt": 32}, "batch-generator":{"total": 41.13, "avg": 1.29, "max": 0.73, "min": 2.78, "cnt": 32}, "fwd-embedding":{"total": 0.63, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1722.60, "avg": 53.83, "max": 48.47, "min": 60.69, "cnt": 32}, "fwd-layernorm":{"total": 9.53, "avg": 0.07, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 108.91, "avg": 0.85, "max": 0.75, "min": 1.47, "cnt": 128}, "fwd-misc":{"total": 19.94, "avg": 0.16, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1563.97, "avg": 12.22, "max": 10.32, "min": 20.51, "cnt": 128}, "MoE_L0_fwd":{"total": 465.44, "avg": 14.55, "max": 11.42, "min": 20.43, "cnt": 32}, "MoEMLP":{"total": 1547.74, "avg": 12.09, "max": 10.21, "min": 20.39, "cnt": 128}, "MoE_L1_fwd":{"total": 365.27, "avg": 11.41, "max": 10.25, "min": 16.34, "cnt": 32}, "MoE_L2_fwd":{"total": 370.34, "avg": 11.57, "max": 10.92, "min": 12.66, "cnt": 32}, "MoE_L3_fwd":{"total": 352.61, "avg": 11.02, "max": 10.35, "min": 12.04, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 4.33, "avg": 2.16, "max": 0.99, "min": 3.34, "cnt": 2}, "forward-send-backward-recv":{"total": 230.62, "avg": 7.69, "max": 1.43, "min": 107.40, "cnt": 30}, "backward-compute":{"total": 1514.40, "avg": 47.32, "max": 43.45, "min": 58.00, "cnt": 32}, "MoE_L3_bwd":{"total": 381.39, "avg": 11.92, "max": 9.46, "min": 22.92, "cnt": 32}, "MoE_L2_bwd":{"total": 332.79, "avg": 10.40, "max": 9.48, "min": 11.39, "cnt": 32}, "MoE_L1_bwd":{"total": 278.57, "avg": 8.71, "max": 8.11, "min": 9.34, "cnt": 32}, "MoE_L0_bwd":{"total": 306.74, "avg": 9.59, "max": 9.15, "min": 9.94, "cnt": 32}, "backward-send-forward-recv":{"total": 3234.94, "avg": 111.55, "max": 2.34, "min": 796.10, "cnt": 29}, "backward-send":{"total": 3.08, "avg": 1.03, "max": 0.86, "min": 1.12, "cnt": 3}, "backward-recv":{"total": 123.35, "avg": 61.68, "max": 55.24, "min": 68.11, "cnt": 2}, "backward-params-all-reduce":{"total": 490.57, "avg": 490.57, "max": 490.57, "min": 490.57, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 250.06, "avg": 250.06, "max": 250.06, "min": 250.06, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 210.10, "avg": 210.10, "max": 210.10, "min": 210.10, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.31, "avg": 3.31, "max": 3.31, "min": 3.31, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.49, "avg": 3.49, "max": 3.49, "min": 3.49, "cnt": 1}}}
{"type":"time", "iteration": 109, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 64.49, "avg": 21.50, "max": 0.90, "min": 62.14, "cnt": 3}, "forward-compute":{"total": 1820.49, "avg": 56.89, "max": 51.23, "min": 60.73, "cnt": 32}, "fwd-compute":{"total": 1817.39, "avg": 56.79, "max": 51.16, "min": 60.66, "cnt": 32}, "batch-generator":{"total": 51.84, "avg": 1.62, "max": 0.67, "min": 3.50, "cnt": 32}, "fwd-embedding":{"total": 0.57, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1753.88, "avg": 54.81, "max": 48.78, "min": 59.57, "cnt": 32}, "fwd-layernorm":{"total": 9.33, "avg": 0.07, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 106.31, "avg": 0.83, "max": 0.74, "min": 1.46, "cnt": 128}, "fwd-misc":{"total": 19.76, "avg": 0.15, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1598.97, "avg": 12.49, "max": 10.23, "min": 18.50, "cnt": 128}, "MoE_L0_fwd":{"total": 481.03, "avg": 15.03, "max": 11.64, "min": 18.40, "cnt": 32}, "MoEMLP":{"total": 1582.83, "avg": 12.37, "max": 10.13, "min": 18.35, "cnt": 128}, "MoE_L1_fwd":{"total": 387.87, "avg": 12.12, "max": 10.78, "min": 14.81, "cnt": 32}, "MoE_L2_fwd":{"total": 369.81, "avg": 11.56, "max": 10.78, "min": 14.63, "cnt": 32}, "MoE_L3_fwd":{"total": 350.05, "avg": 10.94, "max": 10.17, "min": 11.99, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.56, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 2.47, "avg": 1.23, "max": 0.88, "min": 1.59, "cnt": 2}, "forward-send-backward-recv":{"total": 185.68, "avg": 6.19, "max": 1.31, "min": 112.64, "cnt": 30}, "backward-compute":{"total": 1501.87, "avg": 46.93, "max": 45.08, "min": 49.03, "cnt": 32}, "MoE_L3_bwd":{"total": 361.02, "avg": 11.28, "max": 10.04, "min": 12.91, "cnt": 32}, "MoE_L2_bwd":{"total": 331.26, "avg": 10.35, "max": 9.34, "min": 11.96, "cnt": 32}, "MoE_L1_bwd":{"total": 283.06, "avg": 8.85, "max": 8.52, "min": 9.24, "cnt": 32}, "MoE_L0_bwd":{"total": 310.08, "avg": 9.69, "max": 9.21, "min": 11.04, "cnt": 32}, "backward-send-forward-recv":{"total": 4721.96, "avg": 162.83, "max": 2.23, "min": 1256.75, "cnt": 29}, "backward-send":{"total": 3.01, "avg": 1.00, "max": 0.93, "min": 1.12, "cnt": 3}, "backward-recv":{"total": 143.98, "avg": 71.99, "max": 71.04, "min": 72.94, "cnt": 2}, "backward-params-all-reduce":{"total": 481.51, "avg": 481.51, "max": 481.51, "min": 481.51, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 249.54, "avg": 249.54, "max": 249.54, "min": 249.54, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 209.74, "avg": 209.74, "max": 209.74, "min": 209.74, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.19, "avg": 3.19, "max": 3.19, "min": 3.19, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.50, "avg": 3.50, "max": 3.50, "min": 3.50, "cnt": 1}}}
{"type":"time", "iteration": 110, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.06, "avg": 0.06, "max": 0.06, "min": 0.06, "cnt": 1}, "forward-recv":{"total": 321.59, "avg": 107.20, "max": 0.80, "min": 319.76, "cnt": 3}, "forward-compute":{"total": 2060.54, "avg": 64.39, "max": 47.41, "min": 295.07, "cnt": 32}, "fwd-compute":{"total": 2057.52, "avg": 64.30, "max": 47.34, "min": 294.99, "cnt": 32}, "batch-generator":{"total": 42.32, "avg": 1.32, "max": 0.69, "min": 3.98, "cnt": 32}, "fwd-embedding":{"total": 0.63, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 2002.91, "avg": 62.59, "max": 46.18, "min": 293.79, "cnt": 32}, "fwd-layernorm":{"total": 9.71, "avg": 0.08, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 107.62, "avg": 0.84, "max": 0.74, "min": 1.46, "cnt": 128}, "fwd-misc":{"total": 20.83, "avg": 0.16, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1844.13, "avg": 14.41, "max": 9.18, "min": 141.53, "cnt": 128}, "MoE_L0_fwd":{"total": 654.40, "avg": 20.45, "max": 10.11, "min": 141.45, "cnt": 32}, "MoEMLP":{"total": 1827.25, "avg": 14.28, "max": 9.06, "min": 141.40, "cnt": 128}, "MoE_L1_fwd":{"total": 387.22, "avg": 12.10, "max": 10.61, "min": 15.36, "cnt": 32}, "MoE_L2_fwd":{"total": 359.62, "avg": 11.24, "max": 10.71, "min": 12.29, "cnt": 32}, "MoE_L3_fwd":{"total": 432.16, "avg": 13.51, "max": 9.11, "min": 124.54, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.56, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 292.49, "avg": 146.24, "max": 0.84, "min": 291.65, "cnt": 2}, "forward-send-backward-recv":{"total": 362.27, "avg": 12.08, "max": 1.28, "min": 225.54, "cnt": 30}, "backward-compute":{"total": 1426.90, "avg": 44.59, "max": 43.12, "min": 46.70, "cnt": 32}, "MoE_L3_bwd":{"total": 323.76, "avg": 10.12, "max": 9.21, "min": 12.68, "cnt": 32}, "MoE_L2_bwd":{"total": 329.03, "avg": 10.28, "max": 9.56, "min": 11.24, "cnt": 32}, "MoE_L1_bwd":{"total": 290.47, "avg": 9.08, "max": 8.57, "min": 10.37, "cnt": 32}, "MoE_L0_bwd":{"total": 267.57, "avg": 8.36, "max": 7.79, "min": 8.71, "cnt": 32}, "backward-send-forward-recv":{"total": 2633.34, "avg": 90.80, "max": 2.07, "min": 374.59, "cnt": 29}, "backward-send":{"total": 2.31, "avg": 0.77, "max": 0.71, "min": 0.83, "cnt": 3}, "backward-recv":{"total": 247.70, "avg": 123.85, "max": 55.90, "min": 191.80, "cnt": 2}, "backward-params-all-reduce":{"total": 482.52, "avg": 482.52, "max": 482.52, "min": 482.52, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 250.84, "avg": 250.84, "max": 250.84, "min": 250.84, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 210.96, "avg": 210.96, "max": 210.96, "min": 210.96, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 111, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 66.08, "avg": 22.03, "max": 0.97, "min": 60.03, "cnt": 3}, "forward-compute":{"total": 1756.74, "avg": 54.90, "max": 49.37, "min": 61.10, "cnt": 32}, "fwd-compute":{"total": 1753.90, "avg": 54.81, "max": 49.30, "min": 61.02, "cnt": 32}, "batch-generator":{"total": 37.19, "avg": 1.16, "max": 0.67, "min": 2.19, "cnt": 32}, "fwd-embedding":{"total": 0.53, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1705.37, "avg": 53.29, "max": 48.31, "min": 59.88, "cnt": 32}, "fwd-layernorm":{"total": 9.03, "avg": 0.07, "max": 0.05, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 103.63, "avg": 0.81, "max": 0.75, "min": 1.49, "cnt": 128}, "fwd-misc":{"total": 19.25, "avg": 0.15, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1553.91, "avg": 12.14, "max": 9.51, "min": 19.70, "cnt": 128}, "MoE_L0_fwd":{"total": 443.15, "avg": 13.85, "max": 10.43, "min": 19.62, "cnt": 32}, "MoEMLP":{"total": 1538.00, "avg": 12.02, "max": 9.40, "min": 19.58, "cnt": 128}, "MoE_L1_fwd":{"total": 378.75, "avg": 11.84, "max": 10.92, "min": 14.24, "cnt": 32}, "MoE_L2_fwd":{"total": 384.57, "avg": 12.02, "max": 11.28, "min": 15.64, "cnt": 32}, "MoE_L3_fwd":{"total": 337.25, "avg": 10.54, "max": 9.44, "min": 15.64, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.74, "avg": 0.87, "max": 0.86, "min": 0.88, "cnt": 2}, "forward-send-backward-recv":{"total": 521.62, "avg": 17.39, "max": 1.58, "min": 109.77, "cnt": 30}, "backward-compute":{"total": 1463.29, "avg": 45.73, "max": 43.41, "min": 47.71, "cnt": 32}, "MoE_L3_bwd":{"total": 325.12, "avg": 10.16, "max": 8.73, "min": 11.54, "cnt": 32}, "MoE_L2_bwd":{"total": 346.01, "avg": 10.81, "max": 9.70, "min": 11.80, "cnt": 32}, "MoE_L1_bwd":{"total": 299.15, "avg": 9.35, "max": 8.88, "min": 11.02, "cnt": 32}, "MoE_L0_bwd":{"total": 275.90, "avg": 8.62, "max": 8.16, "min": 8.89, "cnt": 32}, "backward-send-forward-recv":{"total": 1820.00, "avg": 62.76, "max": 1.90, "min": 201.41, "cnt": 29}, "backward-send":{"total": 2.40, "avg": 0.80, "max": 0.68, "min": 0.92, "cnt": 3}, "backward-recv":{"total": 162.52, "avg": 81.26, "max": 73.69, "min": 88.83, "cnt": 2}, "backward-params-all-reduce":{"total": 489.98, "avg": 489.98, "max": 489.98, "min": 489.98, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 248.26, "avg": 248.26, "max": 248.26, "min": 248.26, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 204.06, "avg": 204.06, "max": 204.06, "min": 204.06, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.87, "avg": 6.87, "max": 6.87, "min": 6.87, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 112, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 62.70, "avg": 20.90, "max": 0.93, "min": 60.58, "cnt": 3}, "forward-compute":{"total": 1830.79, "avg": 57.21, "max": 48.97, "min": 66.10, "cnt": 32}, "fwd-compute":{"total": 1827.63, "avg": 57.11, "max": 48.90, "min": 66.03, "cnt": 32}, "batch-generator":{"total": 41.22, "avg": 1.29, "max": 0.70, "min": 2.50, "cnt": 32}, "fwd-embedding":{"total": 0.67, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1773.62, "avg": 55.43, "max": 47.90, "min": 63.62, "cnt": 32}, "fwd-layernorm":{"total": 10.03, "avg": 0.08, "max": 0.05, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 111.94, "avg": 0.87, "max": 0.75, "min": 1.62, "cnt": 128}, "fwd-misc":{"total": 21.12, "avg": 0.16, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1609.50, "avg": 12.57, "max": 9.88, "min": 23.41, "cnt": 128}, "MoE_L0_fwd":{"total": 464.80, "avg": 14.52, "max": 10.43, "min": 23.31, "cnt": 32}, "MoEMLP":{"total": 1592.20, "avg": 12.44, "max": 9.77, "min": 23.27, "cnt": 128}, "MoE_L1_fwd":{"total": 404.27, "avg": 12.63, "max": 11.00, "min": 15.84, "cnt": 32}, "MoE_L2_fwd":{"total": 380.83, "avg": 11.90, "max": 10.81, "min": 13.32, "cnt": 32}, "MoE_L3_fwd":{"total": 348.48, "avg": 10.89, "max": 9.81, "min": 15.71, "cnt": 32}, "fwd-pooler":{"total": 0.31, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.04, "cnt": 32}, "forward-send":{"total": 15.12, "avg": 7.56, "max": 0.96, "min": 14.16, "cnt": 2}, "forward-send-backward-recv":{"total": 174.96, "avg": 5.83, "max": 1.29, "min": 112.87, "cnt": 30}, "backward-compute":{"total": 1498.95, "avg": 46.84, "max": 45.54, "min": 49.53, "cnt": 32}, "MoE_L3_bwd":{"total": 340.55, "avg": 10.64, "max": 9.62, "min": 12.18, "cnt": 32}, "MoE_L2_bwd":{"total": 343.21, "avg": 10.73, "max": 9.36, "min": 11.40, "cnt": 32}, "MoE_L1_bwd":{"total": 315.61, "avg": 9.86, "max": 9.58, "min": 10.24, "cnt": 32}, "MoE_L0_bwd":{"total": 281.02, "avg": 8.78, "max": 8.38, "min": 9.86, "cnt": 32}, "backward-send-forward-recv":{"total": 2300.93, "avg": 79.34, "max": 1.89, "min": 314.90, "cnt": 29}, "backward-send":{"total": 2.31, "avg": 0.77, "max": 0.67, "min": 0.96, "cnt": 3}, "backward-recv":{"total": 125.82, "avg": 62.91, "max": 61.03, "min": 64.79, "cnt": 2}, "backward-params-all-reduce":{"total": 487.84, "avg": 487.84, "max": 487.84, "min": 487.84, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 248.52, "avg": 248.52, "max": 248.52, "min": 248.52, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 208.62, "avg": 208.62, "max": 208.62, "min": 208.62, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.32, "avg": 3.32, "max": 3.32, "min": 3.32, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.49, "avg": 3.49, "max": 3.49, "min": 3.49, "cnt": 1}}}
{"type":"time", "iteration": 113, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.06, "avg": 0.06, "max": 0.06, "min": 0.06, "cnt": 1}, "forward-recv":{"total": 59.90, "avg": 19.97, "max": 2.98, "min": 52.48, "cnt": 3}, "forward-compute":{"total": 1824.34, "avg": 57.01, "max": 51.13, "min": 64.03, "cnt": 32}, "fwd-compute":{"total": 1821.22, "avg": 56.91, "max": 51.05, "min": 63.91, "cnt": 32}, "batch-generator":{"total": 47.41, "avg": 1.48, "max": 0.68, "min": 3.58, "cnt": 32}, "fwd-embedding":{"total": 0.62, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1761.36, "avg": 55.04, "max": 48.70, "min": 62.35, "cnt": 32}, "fwd-layernorm":{"total": 9.69, "avg": 0.08, "max": 0.05, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 106.92, "avg": 0.84, "max": 0.75, "min": 1.48, "cnt": 128}, "fwd-misc":{"total": 20.35, "avg": 0.16, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1603.86, "avg": 12.53, "max": 9.63, "min": 19.61, "cnt": 128}, "MoE_L0_fwd":{"total": 469.61, "avg": 14.68, "max": 10.43, "min": 19.48, "cnt": 32}, "MoEMLP":{"total": 1587.09, "avg": 12.40, "max": 9.52, "min": 19.41, "cnt": 128}, "MoE_L1_fwd":{"total": 412.02, "avg": 12.88, "max": 11.70, "min": 15.84, "cnt": 32}, "MoE_L2_fwd":{"total": 380.21, "avg": 11.88, "max": 11.17, "min": 14.82, "cnt": 32}, "MoE_L3_fwd":{"total": 331.39, "avg": 10.36, "max": 9.56, "min": 13.91, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.63, "avg": 0.82, "max": 0.81, "min": 0.82, "cnt": 2}, "forward-send-backward-recv":{"total": 460.80, "avg": 15.36, "max": 1.36, "min": 99.02, "cnt": 30}, "backward-compute":{"total": 1489.64, "avg": 46.55, "max": 44.93, "min": 48.80, "cnt": 32}, "MoE_L3_bwd":{"total": 335.77, "avg": 10.49, "max": 9.52, "min": 13.56, "cnt": 32}, "MoE_L2_bwd":{"total": 334.46, "avg": 10.45, "max": 9.77, "min": 11.85, "cnt": 32}, "MoE_L1_bwd":{"total": 325.91, "avg": 10.18, "max": 9.42, "min": 10.74, "cnt": 32}, "MoE_L0_bwd":{"total": 276.26, "avg": 8.63, "max": 8.18, "min": 9.10, "cnt": 32}, "backward-send-forward-recv":{"total": 2904.30, "avg": 100.15, "max": 1.53, "min": 655.46, "cnt": 29}, "backward-send":{"total": 3.10, "avg": 1.03, "max": 0.96, "min": 1.17, "cnt": 3}, "backward-recv":{"total": 258.75, "avg": 129.37, "max": 68.42, "min": 190.32, "cnt": 2}, "backward-params-all-reduce":{"total": 487.70, "avg": 487.70, "max": 487.70, "min": 487.70, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 245.02, "avg": 245.02, "max": 245.02, "min": 245.02, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 205.14, "avg": 205.14, "max": 205.14, "min": 205.14, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.30, "avg": 3.30, "max": 3.30, "min": 3.30, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.47, "avg": 3.47, "max": 3.47, "min": 3.47, "cnt": 1}}}
{"type":"time", "iteration": 114, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.06, "avg": 0.06, "max": 0.06, "min": 0.06, "cnt": 1}, "forward-recv":{"total": 53.83, "avg": 17.94, "max": 0.91, "min": 51.96, "cnt": 3}, "forward-compute":{"total": 1811.82, "avg": 56.62, "max": 48.55, "min": 63.61, "cnt": 32}, "fwd-compute":{"total": 1808.64, "avg": 56.52, "max": 48.48, "min": 63.47, "cnt": 32}, "batch-generator":{"total": 46.93, "avg": 1.47, "max": 0.64, "min": 4.58, "cnt": 32}, "fwd-embedding":{"total": 0.70, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1749.26, "avg": 54.66, "max": 47.55, "min": 61.44, "cnt": 32}, "fwd-layernorm":{"total": 10.36, "avg": 0.08, "max": 0.05, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 110.79, "avg": 0.87, "max": 0.74, "min": 1.48, "cnt": 128}, "fwd-misc":{"total": 21.83, "avg": 0.17, "max": 0.11, "min": 0.39, "cnt": 128}, "fwd-MLP":{"total": 1584.97, "avg": 12.38, "max": 9.88, "min": 17.81, "cnt": 128}, "MoE_L0_fwd":{"total": 462.32, "avg": 14.45, "max": 11.18, "min": 17.37, "cnt": 32}, "MoEMLP":{"total": 1567.78, "avg": 12.25, "max": 9.77, "min": 17.65, "cnt": 128}, "MoE_L1_fwd":{"total": 413.96, "avg": 12.94, "max": 11.11, "min": 17.70, "cnt": 32}, "MoE_L2_fwd":{"total": 366.31, "avg": 11.45, "max": 10.74, "min": 12.40, "cnt": 32}, "MoE_L3_fwd":{"total": 331.45, "avg": 10.36, "max": 9.81, "min": 11.93, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.61, "avg": 0.80, "max": 0.79, "min": 0.82, "cnt": 2}, "forward-send-backward-recv":{"total": 985.68, "avg": 32.86, "max": 1.24, "min": 230.47, "cnt": 30}, "backward-compute":{"total": 1484.00, "avg": 46.37, "max": 43.02, "min": 49.39, "cnt": 32}, "MoE_L3_bwd":{"total": 323.34, "avg": 10.10, "max": 8.90, "min": 10.95, "cnt": 32}, "MoE_L2_bwd":{"total": 335.61, "avg": 10.49, "max": 9.69, "min": 12.19, "cnt": 32}, "MoE_L1_bwd":{"total": 322.58, "avg": 10.08, "max": 9.28, "min": 11.83, "cnt": 32}, "MoE_L0_bwd":{"total": 285.16, "avg": 8.91, "max": 8.47, "min": 10.90, "cnt": 32}, "backward-send-forward-recv":{"total": 1342.67, "avg": 46.30, "max": 1.60, "min": 292.38, "cnt": 29}, "backward-send":{"total": 1.83, "avg": 0.61, "max": 0.59, "min": 0.64, "cnt": 3}, "backward-recv":{"total": 138.86, "avg": 69.43, "max": 68.92, "min": 69.93, "cnt": 2}, "backward-params-all-reduce":{"total": 491.17, "avg": 491.17, "max": 491.17, "min": 491.17, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 247.26, "avg": 247.26, "max": 247.26, "min": 247.26, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 207.43, "avg": 207.43, "max": 207.43, "min": 207.43, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.40, "avg": 3.40, "max": 3.40, "min": 3.40, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}}}
{"type":"time", "iteration": 115, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.06, "avg": 0.06, "max": 0.06, "min": 0.06, "cnt": 1}, "forward-recv":{"total": 77.57, "avg": 25.86, "max": 1.37, "min": 69.47, "cnt": 3}, "forward-compute":{"total": 1784.66, "avg": 55.77, "max": 48.03, "min": 63.61, "cnt": 32}, "fwd-compute":{"total": 1781.65, "avg": 55.68, "max": 47.96, "min": 63.53, "cnt": 32}, "batch-generator":{"total": 55.10, "avg": 1.72, "max": 0.64, "min": 3.45, "cnt": 32}, "fwd-embedding":{"total": 0.58, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1714.65, "avg": 53.58, "max": 47.04, "min": 59.99, "cnt": 32}, "fwd-layernorm":{"total": 9.33, "avg": 0.07, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 105.81, "avg": 0.83, "max": 0.74, "min": 1.55, "cnt": 128}, "fwd-misc":{"total": 19.59, "avg": 0.15, "max": 0.11, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1560.11, "avg": 12.19, "max": 9.58, "min": 18.29, "cnt": 128}, "MoE_L0_fwd":{"total": 450.88, "avg": 14.09, "max": 10.70, "min": 18.21, "cnt": 32}, "MoEMLP":{"total": 1543.98, "avg": 12.06, "max": 9.45, "min": 18.16, "cnt": 128}, "MoE_L1_fwd":{"total": 399.12, "avg": 12.47, "max": 11.07, "min": 13.93, "cnt": 32}, "MoE_L2_fwd":{"total": 367.44, "avg": 11.48, "max": 10.78, "min": 14.11, "cnt": 32}, "MoE_L3_fwd":{"total": 332.43, "avg": 10.39, "max": 9.49, "min": 15.52, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.43, "avg": 0.72, "max": 0.70, "min": 0.73, "cnt": 2}, "forward-send-backward-recv":{"total": 278.70, "avg": 9.29, "max": 1.38, "min": 101.40, "cnt": 30}, "backward-compute":{"total": 1482.72, "avg": 46.34, "max": 43.63, "min": 50.12, "cnt": 32}, "MoE_L3_bwd":{"total": 339.46, "avg": 10.61, "max": 8.98, "min": 13.90, "cnt": 32}, "MoE_L2_bwd":{"total": 332.82, "avg": 10.40, "max": 9.47, "min": 11.18, "cnt": 32}, "MoE_L1_bwd":{"total": 316.72, "avg": 9.90, "max": 9.49, "min": 10.86, "cnt": 32}, "MoE_L0_bwd":{"total": 277.91, "avg": 8.68, "max": 8.17, "min": 9.18, "cnt": 32}, "backward-send-forward-recv":{"total": 3574.41, "avg": 123.26, "max": 1.99, "min": 741.24, "cnt": 29}, "backward-send":{"total": 2.33, "avg": 0.78, "max": 0.63, "min": 1.06, "cnt": 3}, "backward-recv":{"total": 307.37, "avg": 153.69, "max": 56.51, "min": 250.86, "cnt": 2}, "backward-params-all-reduce":{"total": 485.03, "avg": 485.03, "max": 485.03, "min": 485.03, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 246.96, "avg": 246.96, "max": 246.96, "min": 246.96, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 207.02, "avg": 207.02, "max": 207.02, "min": 207.02, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.34, "avg": 3.34, "max": 3.34, "min": 3.34, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 116, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 55.47, "avg": 18.49, "max": 1.08, "min": 53.30, "cnt": 3}, "forward-compute":{"total": 1844.66, "avg": 57.65, "max": 48.49, "min": 90.28, "cnt": 32}, "fwd-compute":{"total": 1841.66, "avg": 57.55, "max": 48.42, "min": 90.21, "cnt": 32}, "batch-generator":{"total": 43.26, "avg": 1.35, "max": 0.64, "min": 2.54, "cnt": 32}, "fwd-embedding":{"total": 0.63, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1786.05, "avg": 55.81, "max": 47.48, "min": 89.14, "cnt": 32}, "fwd-layernorm":{"total": 10.36, "avg": 0.08, "max": 0.05, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 113.52, "avg": 0.89, "max": 0.74, "min": 2.08, "cnt": 128}, "fwd-misc":{"total": 21.94, "avg": 0.17, "max": 0.11, "min": 0.42, "cnt": 128}, "fwd-MLP":{"total": 1618.22, "avg": 12.64, "max": 9.51, "min": 47.46, "cnt": 128}, "MoE_L0_fwd":{"total": 521.51, "avg": 16.30, "max": 11.31, "min": 47.39, "cnt": 32}, "MoEMLP":{"total": 1600.31, "avg": 12.50, "max": 9.40, "min": 47.34, "cnt": 128}, "MoE_L1_fwd":{"total": 394.63, "avg": 12.33, "max": 10.83, "min": 14.28, "cnt": 32}, "MoE_L2_fwd":{"total": 363.60, "avg": 11.36, "max": 10.79, "min": 14.58, "cnt": 32}, "MoE_L3_fwd":{"total": 327.00, "avg": 10.22, "max": 9.44, "min": 11.61, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.56, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 7.04, "avg": 3.52, "max": 0.76, "min": 6.28, "cnt": 2}, "forward-send-backward-recv":{"total": 326.23, "avg": 10.87, "max": 1.26, "min": 231.15, "cnt": 30}, "backward-compute":{"total": 1464.68, "avg": 45.77, "max": 43.65, "min": 50.64, "cnt": 32}, "MoE_L3_bwd":{"total": 330.39, "avg": 10.32, "max": 9.01, "min": 11.16, "cnt": 32}, "MoE_L2_bwd":{"total": 343.23, "avg": 10.73, "max": 9.55, "min": 14.69, "cnt": 32}, "MoE_L1_bwd":{"total": 307.99, "avg": 9.62, "max": 9.12, "min": 9.99, "cnt": 32}, "MoE_L0_bwd":{"total": 267.22, "avg": 8.35, "max": 7.92, "min": 9.11, "cnt": 32}, "backward-send-forward-recv":{"total": 6078.97, "avg": 209.62, "max": 1.69, "min": 768.51, "cnt": 29}, "backward-send":{"total": 2.28, "avg": 0.76, "max": 0.69, "min": 0.88, "cnt": 3}, "backward-recv":{"total": 144.23, "avg": 72.11, "max": 68.89, "min": 75.33, "cnt": 2}, "backward-params-all-reduce":{"total": 484.81, "avg": 484.81, "max": 484.81, "min": 484.81, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 246.55, "avg": 246.55, "max": 246.55, "min": 246.55, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 206.68, "avg": 206.68, "max": 206.68, "min": 206.68, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.34, "avg": 3.34, "max": 3.34, "min": 3.34, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 117, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 58.76, "avg": 19.59, "max": 1.06, "min": 56.61, "cnt": 3}, "forward-compute":{"total": 1813.61, "avg": 56.68, "max": 48.70, "min": 63.37, "cnt": 32}, "fwd-compute":{"total": 1810.62, "avg": 56.58, "max": 48.63, "min": 63.28, "cnt": 32}, "batch-generator":{"total": 44.40, "avg": 1.39, "max": 0.69, "min": 3.45, "cnt": 32}, "fwd-embedding":{"total": 0.62, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1753.93, "avg": 54.81, "max": 47.65, "min": 61.57, "cnt": 32}, "fwd-layernorm":{"total": 9.69, "avg": 0.08, "max": 0.05, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 107.96, "avg": 0.84, "max": 0.74, "min": 1.43, "cnt": 128}, "fwd-misc":{"total": 20.34, "avg": 0.16, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1595.41, "avg": 12.46, "max": 9.63, "min": 18.56, "cnt": 128}, "MoE_L0_fwd":{"total": 476.43, "avg": 14.89, "max": 10.58, "min": 18.48, "cnt": 32}, "MoEMLP":{"total": 1578.74, "avg": 12.33, "max": 9.53, "min": 18.43, "cnt": 128}, "MoE_L1_fwd":{"total": 406.85, "avg": 12.71, "max": 10.99, "min": 14.63, "cnt": 32}, "MoE_L2_fwd":{"total": 365.69, "avg": 11.43, "max": 10.69, "min": 13.90, "cnt": 32}, "MoE_L3_fwd":{"total": 335.81, "avg": 10.49, "max": 9.56, "min": 16.83, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.56, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.66, "avg": 0.83, "max": 0.79, "min": 0.88, "cnt": 2}, "forward-send-backward-recv":{"total": 419.65, "avg": 13.99, "max": 1.53, "min": 121.27, "cnt": 30}, "backward-compute":{"total": 1482.72, "avg": 46.34, "max": 44.48, "min": 48.64, "cnt": 32}, "MoE_L3_bwd":{"total": 331.11, "avg": 10.35, "max": 8.78, "min": 11.62, "cnt": 32}, "MoE_L2_bwd":{"total": 335.87, "avg": 10.50, "max": 9.82, "min": 11.35, "cnt": 32}, "MoE_L1_bwd":{"total": 315.46, "avg": 9.86, "max": 9.50, "min": 10.49, "cnt": 32}, "MoE_L0_bwd":{"total": 279.80, "avg": 8.74, "max": 8.05, "min": 10.48, "cnt": 32}, "backward-send-forward-recv":{"total": 2560.48, "avg": 88.29, "max": 1.93, "min": 590.44, "cnt": 29}, "backward-send":{"total": 2.45, "avg": 0.82, "max": 0.61, "min": 1.14, "cnt": 3}, "backward-recv":{"total": 334.89, "avg": 167.44, "max": 70.96, "min": 263.93, "cnt": 2}, "backward-params-all-reduce":{"total": 484.19, "avg": 484.19, "max": 484.19, "min": 484.19, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 264.03, "avg": 264.03, "max": 264.03, "min": 264.03, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 224.18, "avg": 224.18, "max": 224.18, "min": 224.18, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.34, "avg": 3.34, "max": 3.34, "min": 3.34, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 118, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.13, "avg": 0.13, "max": 0.13, "min": 0.13, "cnt": 1}, "forward-recv":{"total": 53.84, "avg": 17.95, "max": 1.10, "min": 51.53, "cnt": 3}, "forward-compute":{"total": 1783.08, "avg": 55.72, "max": 47.98, "min": 67.62, "cnt": 32}, "fwd-compute":{"total": 1779.93, "avg": 55.62, "max": 47.91, "min": 67.55, "cnt": 32}, "batch-generator":{"total": 52.83, "avg": 1.65, "max": 0.68, "min": 3.29, "cnt": 32}, "fwd-embedding":{"total": 0.69, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1714.92, "avg": 53.59, "max": 46.93, "min": 66.21, "cnt": 32}, "fwd-layernorm":{"total": 10.21, "avg": 0.08, "max": 0.05, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 110.52, "avg": 0.86, "max": 0.74, "min": 1.49, "cnt": 128}, "fwd-misc":{"total": 21.23, "avg": 0.17, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1551.84, "avg": 12.12, "max": 9.69, "min": 26.44, "cnt": 128}, "MoE_L0_fwd":{"total": 458.47, "avg": 14.33, "max": 10.71, "min": 26.35, "cnt": 32}, "MoEMLP":{"total": 1534.66, "avg": 11.99, "max": 9.57, "min": 26.30, "cnt": 128}, "MoE_L1_fwd":{"total": 388.57, "avg": 12.14, "max": 10.91, "min": 14.13, "cnt": 32}, "MoE_L2_fwd":{"total": 364.91, "avg": 11.40, "max": 10.65, "min": 16.06, "cnt": 32}, "MoE_L3_fwd":{"total": 329.01, "avg": 10.28, "max": 9.62, "min": 13.57, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.65, "avg": 0.83, "max": 0.82, "min": 0.84, "cnt": 2}, "forward-send-backward-recv":{"total": 189.45, "avg": 6.31, "max": 1.37, "min": 108.58, "cnt": 30}, "backward-compute":{"total": 1455.13, "avg": 45.47, "max": 43.75, "min": 46.84, "cnt": 32}, "MoE_L3_bwd":{"total": 332.50, "avg": 10.39, "max": 9.01, "min": 11.17, "cnt": 32}, "MoE_L2_bwd":{"total": 324.74, "avg": 10.15, "max": 9.40, "min": 10.80, "cnt": 32}, "MoE_L1_bwd":{"total": 309.23, "avg": 9.66, "max": 8.96, "min": 10.13, "cnt": 32}, "MoE_L0_bwd":{"total": 272.68, "avg": 8.52, "max": 8.12, "min": 10.21, "cnt": 32}, "backward-send-forward-recv":{"total": 2703.05, "avg": 93.21, "max": 2.32, "min": 381.95, "cnt": 29}, "backward-send":{"total": 3.22, "avg": 1.07, "max": 1.04, "min": 1.13, "cnt": 3}, "backward-recv":{"total": 133.95, "avg": 66.97, "max": 61.89, "min": 72.05, "cnt": 2}, "backward-params-all-reduce":{"total": 492.86, "avg": 492.86, "max": 492.86, "min": 492.86, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "optimizer":{"total": 243.16, "avg": 243.16, "max": 243.16, "min": 243.16, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.40, "avg": 3.40, "max": 3.40, "min": 3.40, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 203.13, "avg": 203.13, "max": 203.13, "min": 203.13, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.47, "avg": 3.47, "max": 3.47, "min": 3.47, "cnt": 1}}}
{"type":"time", "iteration": 119, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.06, "avg": 0.06, "max": 0.06, "min": 0.06, "cnt": 1}, "forward-recv":{"total": 67.90, "avg": 22.63, "max": 1.01, "min": 65.87, "cnt": 3}, "forward-compute":{"total": 1800.01, "avg": 56.25, "max": 49.11, "min": 62.88, "cnt": 32}, "fwd-compute":{"total": 1796.67, "avg": 56.15, "max": 49.04, "min": 62.80, "cnt": 32}, "batch-generator":{"total": 43.79, "avg": 1.37, "max": 0.64, "min": 2.76, "cnt": 32}, "fwd-embedding":{"total": 0.73, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1739.64, "avg": 54.36, "max": 48.12, "min": 60.07, "cnt": 32}, "fwd-layernorm":{"total": 10.60, "avg": 0.08, "max": 0.05, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 114.09, "avg": 0.89, "max": 0.74, "min": 2.08, "cnt": 128}, "fwd-misc":{"total": 22.50, "avg": 0.18, "max": 0.11, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1570.41, "avg": 12.27, "max": 9.70, "min": 18.00, "cnt": 128}, "MoE_L0_fwd":{"total": 464.55, "avg": 14.52, "max": 10.82, "min": 17.92, "cnt": 32}, "MoEMLP":{"total": 1552.42, "avg": 12.13, "max": 9.60, "min": 17.87, "cnt": 128}, "MoE_L1_fwd":{"total": 400.45, "avg": 12.51, "max": 11.23, "min": 15.78, "cnt": 32}, "MoE_L2_fwd":{"total": 365.91, "avg": 11.43, "max": 10.56, "min": 13.26, "cnt": 32}, "MoE_L3_fwd":{"total": 327.97, "avg": 10.25, "max": 9.64, "min": 11.70, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 4.19, "avg": 2.09, "max": 1.01, "min": 3.18, "cnt": 2}, "forward-send-backward-recv":{"total": 248.87, "avg": 8.30, "max": 1.65, "min": 109.25, "cnt": 30}, "backward-compute":{"total": 1474.80, "avg": 46.09, "max": 44.64, "min": 47.16, "cnt": 32}, "MoE_L3_bwd":{"total": 327.52, "avg": 10.24, "max": 9.30, "min": 10.78, "cnt": 32}, "MoE_L2_bwd":{"total": 331.58, "avg": 10.36, "max": 9.50, "min": 11.19, "cnt": 32}, "MoE_L1_bwd":{"total": 320.16, "avg": 10.01, "max": 9.75, "min": 10.52, "cnt": 32}, "MoE_L0_bwd":{"total": 278.12, "avg": 8.69, "max": 8.11, "min": 9.30, "cnt": 32}, "backward-send-forward-recv":{"total": 2070.64, "avg": 71.40, "max": 2.35, "min": 268.95, "cnt": 29}, "backward-send":{"total": 2.69, "avg": 0.90, "max": 0.81, "min": 0.94, "cnt": 3}, "backward-recv":{"total": 138.54, "avg": 69.27, "max": 68.33, "min": 70.21, "cnt": 2}, "backward-params-all-reduce":{"total": 486.66, "avg": 486.66, "max": 486.66, "min": 486.66, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 246.59, "avg": 246.59, "max": 246.59, "min": 246.59, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 206.79, "avg": 206.79, "max": 206.79, "min": 206.79, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}}}
{"type":"time", "iteration": 120, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 66.50, "avg": 22.17, "max": 0.80, "min": 64.73, "cnt": 3}, "forward-compute":{"total": 1821.88, "avg": 56.93, "max": 48.47, "min": 64.24, "cnt": 32}, "fwd-compute":{"total": 1818.80, "avg": 56.84, "max": 48.40, "min": 64.11, "cnt": 32}, "batch-generator":{"total": 41.91, "avg": 1.31, "max": 0.64, "min": 3.50, "cnt": 32}, "fwd-embedding":{"total": 0.64, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1764.90, "avg": 55.15, "max": 47.49, "min": 62.08, "cnt": 32}, "fwd-layernorm":{"total": 9.61, "avg": 0.08, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 108.57, "avg": 0.85, "max": 0.74, "min": 1.79, "cnt": 128}, "fwd-misc":{"total": 21.03, "avg": 0.16, "max": 0.11, "min": 0.64, "cnt": 128}, "fwd-MLP":{"total": 1605.22, "avg": 12.54, "max": 9.57, "min": 22.25, "cnt": 128}, "MoE_L0_fwd":{"total": 502.38, "avg": 15.70, "max": 10.88, "min": 22.13, "cnt": 32}, "MoEMLP":{"total": 1588.61, "avg": 12.41, "max": 9.46, "min": 22.09, "cnt": 128}, "MoE_L1_fwd":{"total": 398.57, "avg": 12.46, "max": 11.20, "min": 14.89, "cnt": 32}, "MoE_L2_fwd":{"total": 364.82, "avg": 11.40, "max": 10.79, "min": 15.31, "cnt": 32}, "MoE_L3_fwd":{"total": 328.92, "avg": 10.28, "max": 9.50, "min": 13.62, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 11.54, "avg": 5.77, "max": 0.69, "min": 10.85, "cnt": 2}, "forward-send-backward-recv":{"total": 203.51, "avg": 6.78, "max": 1.23, "min": 117.88, "cnt": 30}, "backward-compute":{"total": 1483.09, "avg": 46.35, "max": 43.21, "min": 48.21, "cnt": 32}, "MoE_L3_bwd":{"total": 330.40, "avg": 10.32, "max": 9.19, "min": 11.96, "cnt": 32}, "MoE_L2_bwd":{"total": 335.43, "avg": 10.48, "max": 9.43, "min": 11.14, "cnt": 32}, "MoE_L1_bwd":{"total": 321.07, "avg": 10.03, "max": 9.62, "min": 10.42, "cnt": 32}, "MoE_L0_bwd":{"total": 279.42, "avg": 8.73, "max": 8.13, "min": 9.18, "cnt": 32}, "backward-send-forward-recv":{"total": 3289.10, "avg": 113.42, "max": 1.71, "min": 881.29, "cnt": 29}, "backward-send":{"total": 2.65, "avg": 0.88, "max": 0.55, "min": 1.44, "cnt": 3}, "backward-recv":{"total": 128.16, "avg": 64.08, "max": 58.57, "min": 69.60, "cnt": 2}, "backward-params-all-reduce":{"total": 489.57, "avg": 489.57, "max": 489.57, "min": 489.57, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 247.63, "avg": 247.63, "max": 247.63, "min": 247.63, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 207.38, "avg": 207.38, "max": 207.38, "min": 207.38, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.68, "avg": 3.68, "max": 3.68, "min": 3.68, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.51, "avg": 3.51, "max": 3.51, "min": 3.51, "cnt": 1}}}
{"type":"time", "iteration": 121, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 58.38, "avg": 19.46, "max": 0.94, "min": 56.21, "cnt": 3}, "forward-compute":{"total": 1801.34, "avg": 56.29, "max": 48.42, "min": 65.35, "cnt": 32}, "fwd-compute":{"total": 1798.40, "avg": 56.20, "max": 48.35, "min": 65.22, "cnt": 32}, "batch-generator":{"total": 44.39, "avg": 1.39, "max": 0.66, "min": 3.31, "cnt": 32}, "fwd-embedding":{"total": 0.62, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1742.54, "avg": 54.45, "max": 47.39, "min": 63.28, "cnt": 32}, "fwd-layernorm":{"total": 9.23, "avg": 0.07, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 105.47, "avg": 0.82, "max": 0.74, "min": 1.50, "cnt": 128}, "fwd-misc":{"total": 19.55, "avg": 0.15, "max": 0.11, "min": 0.34, "cnt": 128}, "fwd-MLP":{"total": 1588.55, "avg": 12.41, "max": 9.59, "min": 22.01, "cnt": 128}, "MoE_L0_fwd":{"total": 477.94, "avg": 14.94, "max": 10.85, "min": 21.87, "cnt": 32}, "MoEMLP":{"total": 1572.40, "avg": 12.28, "max": 9.49, "min": 21.79, "cnt": 128}, "MoE_L1_fwd":{"total": 405.71, "avg": 12.68, "max": 11.25, "min": 15.61, "cnt": 32}, "MoE_L2_fwd":{"total": 366.11, "avg": 11.44, "max": 10.44, "min": 13.34, "cnt": 32}, "MoE_L3_fwd":{"total": 328.46, "avg": 10.26, "max": 9.53, "min": 11.63, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 4.41, "avg": 2.21, "max": 0.88, "min": 3.54, "cnt": 2}, "forward-send-backward-recv":{"total": 602.79, "avg": 20.09, "max": 1.30, "min": 156.11, "cnt": 30}, "backward-compute":{"total": 1472.16, "avg": 46.00, "max": 43.40, "min": 48.25, "cnt": 32}, "MoE_L3_bwd":{"total": 329.27, "avg": 10.29, "max": 8.07, "min": 12.84, "cnt": 32}, "MoE_L2_bwd":{"total": 323.76, "avg": 10.12, "max": 8.79, "min": 11.00, "cnt": 32}, "MoE_L1_bwd":{"total": 323.99, "avg": 10.12, "max": 9.64, "min": 11.54, "cnt": 32}, "MoE_L0_bwd":{"total": 277.98, "avg": 8.69, "max": 8.16, "min": 9.48, "cnt": 32}, "backward-send-forward-recv":{"total": 1370.81, "avg": 47.27, "max": 1.53, "min": 233.55, "cnt": 29}, "backward-send":{"total": 1.93, "avg": 0.64, "max": 0.56, "min": 0.76, "cnt": 3}, "backward-recv":{"total": 280.88, "avg": 140.44, "max": 74.82, "min": 206.06, "cnt": 2}, "backward-params-all-reduce":{"total": 487.64, "avg": 487.64, "max": 487.64, "min": 487.64, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 250.35, "avg": 250.35, "max": 250.35, "min": 250.35, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 210.46, "avg": 210.46, "max": 210.46, "min": 210.46, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.36, "avg": 3.36, "max": 3.36, "min": 3.36, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 122, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.06, "avg": 0.06, "max": 0.06, "min": 0.06, "cnt": 1}, "forward-recv":{"total": 65.91, "avg": 21.97, "max": 1.63, "min": 60.17, "cnt": 3}, "forward-compute":{"total": 1861.42, "avg": 58.17, "max": 48.76, "min": 169.64, "cnt": 32}, "fwd-compute":{"total": 1858.30, "avg": 58.07, "max": 48.68, "min": 169.52, "cnt": 32}, "batch-generator":{"total": 40.12, "avg": 1.25, "max": 0.66, "min": 2.36, "cnt": 32}, "fwd-embedding":{"total": 0.69, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1805.97, "avg": 56.44, "max": 47.59, "min": 167.46, "cnt": 32}, "fwd-layernorm":{"total": 9.92, "avg": 0.08, "max": 0.05, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 110.61, "avg": 0.86, "max": 0.74, "min": 1.54, "cnt": 128}, "fwd-misc":{"total": 20.70, "avg": 0.16, "max": 0.11, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1643.79, "avg": 12.84, "max": 9.53, "min": 125.39, "cnt": 128}, "MoE_L0_fwd":{"total": 564.33, "avg": 17.64, "max": 10.90, "min": 125.23, "cnt": 32}, "MoEMLP":{"total": 1626.98, "avg": 12.71, "max": 9.43, "min": 125.15, "cnt": 128}, "MoE_L1_fwd":{"total": 396.58, "avg": 12.39, "max": 11.30, "min": 14.85, "cnt": 32}, "MoE_L2_fwd":{"total": 351.52, "avg": 10.98, "max": 10.03, "min": 11.66, "cnt": 32}, "MoE_L3_fwd":{"total": 320.72, "avg": 10.02, "max": 9.47, "min": 11.05, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.48, "avg": 0.74, "max": 0.69, "min": 0.79, "cnt": 2}, "forward-send-backward-recv":{"total": 1039.48, "avg": 34.65, "max": 1.75, "min": 170.41, "cnt": 30}, "backward-compute":{"total": 1472.88, "avg": 46.03, "max": 44.65, "min": 47.38, "cnt": 32}, "MoE_L3_bwd":{"total": 323.63, "avg": 10.11, "max": 8.77, "min": 11.94, "cnt": 32}, "MoE_L2_bwd":{"total": 323.62, "avg": 10.11, "max": 9.30, "min": 10.80, "cnt": 32}, "MoE_L1_bwd":{"total": 327.29, "avg": 10.23, "max": 9.67, "min": 10.76, "cnt": 32}, "MoE_L0_bwd":{"total": 280.79, "avg": 8.77, "max": 8.26, "min": 9.35, "cnt": 32}, "backward-send-forward-recv":{"total": 843.93, "avg": 29.10, "max": 1.46, "min": 223.73, "cnt": 29}, "backward-send":{"total": 2.13, "avg": 0.71, "max": 0.58, "min": 0.77, "cnt": 3}, "backward-recv":{"total": 941.01, "avg": 470.50, "max": 179.37, "min": 761.63, "cnt": 2}, "backward-params-all-reduce":{"total": 498.63, "avg": 498.63, "max": 498.63, "min": 498.63, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 233.43, "avg": 233.43, "max": 233.43, "min": 233.43, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 193.60, "avg": 193.60, "max": 193.60, "min": 193.60, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.29, "avg": 3.29, "max": 3.29, "min": 3.29, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.47, "avg": 3.47, "max": 3.47, "min": 3.47, "cnt": 1}}}
{"type":"time", "iteration": 123, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 75.51, "avg": 25.17, "max": 1.00, "min": 67.79, "cnt": 3}, "forward-compute":{"total": 1764.96, "avg": 55.16, "max": 48.46, "min": 60.97, "cnt": 32}, "fwd-compute":{"total": 1762.17, "avg": 55.07, "max": 48.39, "min": 60.85, "cnt": 32}, "batch-generator":{"total": 38.34, "avg": 1.20, "max": 0.61, "min": 3.34, "cnt": 32}, "fwd-embedding":{"total": 0.53, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1712.51, "avg": 53.52, "max": 47.52, "min": 58.94, "cnt": 32}, "fwd-layernorm":{"total": 9.03, "avg": 0.07, "max": 0.05, "min": 0.18, "cnt": 128}, "fwd-attn":{"total": 106.61, "avg": 0.83, "max": 0.74, "min": 2.13, "cnt": 128}, "fwd-misc":{"total": 19.32, "avg": 0.15, "max": 0.11, "min": 0.49, "cnt": 128}, "fwd-MLP":{"total": 1558.08, "avg": 12.17, "max": 9.28, "min": 19.35, "cnt": 128}, "MoE_L0_fwd":{"total": 474.41, "avg": 14.83, "max": 10.55, "min": 19.21, "cnt": 32}, "MoEMLP":{"total": 1542.31, "avg": 12.05, "max": 9.17, "min": 19.17, "cnt": 128}, "MoE_L1_fwd":{"total": 396.74, "avg": 12.40, "max": 11.51, "min": 14.34, "cnt": 32}, "MoE_L2_fwd":{"total": 349.24, "avg": 10.91, "max": 10.22, "min": 12.21, "cnt": 32}, "MoE_L3_fwd":{"total": 327.68, "avg": 10.24, "max": 9.21, "min": 17.10, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.67, "avg": 0.84, "max": 0.82, "min": 0.85, "cnt": 2}, "forward-send-backward-recv":{"total": 184.17, "avg": 6.14, "max": 1.58, "min": 98.44, "cnt": 30}, "backward-compute":{"total": 1484.45, "avg": 46.39, "max": 43.75, "min": 49.68, "cnt": 32}, "MoE_L3_bwd":{"total": 323.07, "avg": 10.10, "max": 8.95, "min": 12.61, "cnt": 32}, "MoE_L2_bwd":{"total": 327.61, "avg": 10.24, "max": 9.42, "min": 12.35, "cnt": 32}, "MoE_L1_bwd":{"total": 327.43, "avg": 10.23, "max": 9.73, "min": 10.56, "cnt": 32}, "MoE_L0_bwd":{"total": 290.65, "avg": 9.08, "max": 8.62, "min": 10.71, "cnt": 32}, "backward-send-forward-recv":{"total": 2874.03, "avg": 99.10, "max": 2.33, "min": 384.77, "cnt": 29}, "backward-send":{"total": 2.87, "avg": 0.96, "max": 0.71, "min": 1.13, "cnt": 3}, "backward-recv":{"total": 120.88, "avg": 60.44, "max": 52.90, "min": 67.98, "cnt": 2}, "backward-params-all-reduce":{"total": 483.86, "avg": 483.86, "max": 483.86, "min": 483.86, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 253.17, "avg": 253.17, "max": 253.17, "min": 253.17, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 213.28, "avg": 213.28, "max": 213.28, "min": 213.28, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.31, "avg": 3.31, "max": 3.31, "min": 3.31, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 124, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 55.03, "avg": 18.34, "max": 1.01, "min": 52.91, "cnt": 3}, "forward-compute":{"total": 1799.57, "avg": 56.24, "max": 48.64, "min": 63.69, "cnt": 32}, "fwd-compute":{"total": 1796.53, "avg": 56.14, "max": 48.57, "min": 63.61, "cnt": 32}, "batch-generator":{"total": 40.97, "avg": 1.28, "max": 0.66, "min": 2.85, "cnt": 32}, "fwd-embedding":{"total": 0.69, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1743.58, "avg": 54.49, "max": 47.62, "min": 62.19, "cnt": 32}, "fwd-layernorm":{"total": 9.73, "avg": 0.08, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 109.65, "avg": 0.86, "max": 0.74, "min": 1.75, "cnt": 128}, "fwd-misc":{"total": 20.71, "avg": 0.16, "max": 0.11, "min": 0.54, "cnt": 128}, "fwd-MLP":{"total": 1583.04, "avg": 12.37, "max": 9.12, "min": 24.36, "cnt": 128}, "MoE_L0_fwd":{"total": 504.76, "avg": 15.77, "max": 11.56, "min": 24.26, "cnt": 32}, "MoEMLP":{"total": 1566.64, "avg": 12.24, "max": 9.02, "min": 24.21, "cnt": 128}, "MoE_L1_fwd":{"total": 395.03, "avg": 12.34, "max": 11.21, "min": 14.97, "cnt": 32}, "MoE_L2_fwd":{"total": 352.82, "avg": 11.03, "max": 10.18, "min": 15.59, "cnt": 32}, "MoE_L3_fwd":{"total": 320.04, "avg": 10.00, "max": 9.06, "min": 11.29, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.74, "avg": 0.87, "max": 0.80, "min": 0.94, "cnt": 2}, "forward-send-backward-recv":{"total": 207.79, "avg": 6.93, "max": 1.38, "min": 108.17, "cnt": 30}, "backward-compute":{"total": 1479.49, "avg": 46.23, "max": 44.34, "min": 48.50, "cnt": 32}, "MoE_L3_bwd":{"total": 323.35, "avg": 10.10, "max": 8.76, "min": 10.97, "cnt": 32}, "MoE_L2_bwd":{"total": 316.51, "avg": 9.89, "max": 9.40, "min": 10.40, "cnt": 32}, "MoE_L1_bwd":{"total": 331.00, "avg": 10.34, "max": 9.46, "min": 10.76, "cnt": 32}, "MoE_L0_bwd":{"total": 290.53, "avg": 9.08, "max": 8.74, "min": 10.44, "cnt": 32}, "backward-send-forward-recv":{"total": 3126.61, "avg": 107.81, "max": 2.17, "min": 569.77, "cnt": 29}, "backward-send":{"total": 2.45, "avg": 0.82, "max": 0.71, "min": 0.93, "cnt": 3}, "backward-recv":{"total": 133.79, "avg": 66.90, "max": 64.07, "min": 69.73, "cnt": 2}, "backward-params-all-reduce":{"total": 489.03, "avg": 489.03, "max": 489.03, "min": 489.03, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 248.70, "avg": 248.70, "max": 248.70, "min": 248.70, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 208.83, "avg": 208.83, "max": 208.83, "min": 208.83, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.49, "avg": 3.49, "max": 3.49, "min": 3.49, "cnt": 1}}}
{"type":"time", "iteration": 125, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 55.36, "avg": 18.45, "max": 1.03, "min": 52.15, "cnt": 3}, "forward-compute":{"total": 1767.86, "avg": 55.25, "max": 49.20, "min": 63.50, "cnt": 32}, "fwd-compute":{"total": 1764.74, "avg": 55.15, "max": 49.13, "min": 63.41, "cnt": 32}, "batch-generator":{"total": 40.83, "avg": 1.28, "max": 0.72, "min": 3.58, "cnt": 32}, "fwd-embedding":{"total": 0.61, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1711.16, "avg": 53.47, "max": 48.10, "min": 61.30, "cnt": 32}, "fwd-layernorm":{"total": 9.71, "avg": 0.08, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 108.84, "avg": 0.85, "max": 0.75, "min": 1.90, "cnt": 128}, "fwd-misc":{"total": 20.58, "avg": 0.16, "max": 0.11, "min": 0.45, "cnt": 128}, "fwd-MLP":{"total": 1551.23, "avg": 12.12, "max": 9.43, "min": 17.57, "cnt": 128}, "MoE_L0_fwd":{"total": 460.83, "avg": 14.40, "max": 11.55, "min": 17.50, "cnt": 32}, "MoEMLP":{"total": 1534.24, "avg": 11.99, "max": 9.32, "min": 17.45, "cnt": 128}, "MoE_L1_fwd":{"total": 389.40, "avg": 12.17, "max": 11.22, "min": 14.51, "cnt": 32}, "MoE_L2_fwd":{"total": 358.22, "avg": 11.19, "max": 10.43, "min": 14.56, "cnt": 32}, "MoE_L3_fwd":{"total": 331.94, "avg": 10.37, "max": 9.36, "min": 17.47, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.78, "avg": 0.89, "max": 0.84, "min": 0.94, "cnt": 2}, "forward-send-backward-recv":{"total": 885.34, "avg": 29.51, "max": 1.42, "min": 132.58, "cnt": 30}, "backward-compute":{"total": 1494.06, "avg": 46.69, "max": 45.47, "min": 48.20, "cnt": 32}, "MoE_L3_bwd":{"total": 325.58, "avg": 10.17, "max": 9.04, "min": 11.16, "cnt": 32}, "MoE_L2_bwd":{"total": 325.41, "avg": 10.17, "max": 9.61, "min": 11.13, "cnt": 32}, "MoE_L1_bwd":{"total": 333.82, "avg": 10.43, "max": 9.89, "min": 11.35, "cnt": 32}, "MoE_L0_bwd":{"total": 293.38, "avg": 9.17, "max": 8.78, "min": 10.26, "cnt": 32}, "backward-send-forward-recv":{"total": 1358.07, "avg": 46.83, "max": 1.48, "min": 163.12, "cnt": 29}, "backward-send":{"total": 1.98, "avg": 0.66, "max": 0.47, "min": 0.86, "cnt": 3}, "backward-recv":{"total": 177.58, "avg": 88.79, "max": 86.43, "min": 91.15, "cnt": 2}, "backward-params-all-reduce":{"total": 484.12, "avg": 484.12, "max": 484.12, "min": 484.12, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 249.75, "avg": 249.75, "max": 249.75, "min": 249.75, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 209.87, "avg": 209.87, "max": 209.87, "min": 209.87, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.53, "avg": 3.53, "max": 3.53, "min": 3.53, "cnt": 1}}}
{"type":"time", "iteration": 126, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 57.27, "avg": 19.09, "max": 0.94, "min": 53.97, "cnt": 3}, "forward-compute":{"total": 1743.68, "avg": 54.49, "max": 47.59, "min": 59.30, "cnt": 32}, "fwd-compute":{"total": 1740.75, "avg": 54.40, "max": 47.52, "min": 59.20, "cnt": 32}, "batch-generator":{"total": 49.61, "avg": 1.55, "max": 0.64, "min": 4.31, "cnt": 32}, "fwd-embedding":{"total": 0.54, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1679.51, "avg": 52.48, "max": 46.57, "min": 57.44, "cnt": 32}, "fwd-layernorm":{"total": 9.26, "avg": 0.07, "max": 0.05, "min": 0.18, "cnt": 128}, "fwd-attn":{"total": 104.41, "avg": 0.82, "max": 0.74, "min": 1.45, "cnt": 128}, "fwd-misc":{"total": 19.94, "avg": 0.16, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1526.27, "avg": 11.92, "max": 9.40, "min": 18.51, "cnt": 128}, "MoE_L0_fwd":{"total": 453.24, "avg": 14.16, "max": 10.61, "min": 18.42, "cnt": 32}, "MoEMLP":{"total": 1510.14, "avg": 11.80, "max": 9.30, "min": 18.37, "cnt": 128}, "MoE_L1_fwd":{"total": 387.36, "avg": 12.11, "max": 10.96, "min": 13.66, "cnt": 32}, "MoE_L2_fwd":{"total": 354.64, "avg": 11.08, "max": 10.32, "min": 11.66, "cnt": 32}, "MoE_L3_fwd":{"total": 320.86, "avg": 10.03, "max": 9.34, "min": 11.22, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.56, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.51, "avg": 0.76, "max": 0.70, "min": 0.81, "cnt": 2}, "forward-send-backward-recv":{"total": 462.99, "avg": 15.43, "max": 1.66, "min": 145.62, "cnt": 30}, "backward-compute":{"total": 1476.28, "avg": 46.13, "max": 43.74, "min": 48.72, "cnt": 32}, "MoE_L3_bwd":{"total": 328.93, "avg": 10.28, "max": 8.89, "min": 12.35, "cnt": 32}, "MoE_L2_bwd":{"total": 322.63, "avg": 10.08, "max": 8.75, "min": 10.84, "cnt": 32}, "MoE_L1_bwd":{"total": 320.52, "avg": 10.02, "max": 9.29, "min": 11.69, "cnt": 32}, "MoE_L0_bwd":{"total": 284.23, "avg": 8.88, "max": 8.36, "min": 9.34, "cnt": 32}, "backward-send-forward-recv":{"total": 2144.64, "avg": 73.95, "max": 1.46, "min": 244.74, "cnt": 29}, "backward-send":{"total": 2.64, "avg": 0.88, "max": 0.82, "min": 0.97, "cnt": 3}, "backward-recv":{"total": 214.19, "avg": 107.09, "max": 71.73, "min": 142.45, "cnt": 2}, "backward-params-all-reduce":{"total": 486.82, "avg": 486.82, "max": 486.82, "min": 486.82, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 244.38, "avg": 244.38, "max": 244.38, "min": 244.38, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 204.60, "avg": 204.60, "max": 204.60, "min": 204.60, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.20, "avg": 3.20, "max": 3.20, "min": 3.20, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 127, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 60.94, "avg": 20.31, "max": 1.17, "min": 58.46, "cnt": 3}, "forward-compute":{"total": 1816.55, "avg": 56.77, "max": 48.31, "min": 68.63, "cnt": 32}, "fwd-compute":{"total": 1813.52, "avg": 56.67, "max": 48.24, "min": 68.50, "cnt": 32}, "batch-generator":{"total": 34.80, "avg": 1.09, "max": 0.67, "min": 1.63, "cnt": 32}, "fwd-embedding":{"total": 0.60, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1766.54, "avg": 55.20, "max": 47.28, "min": 66.52, "cnt": 32}, "fwd-layernorm":{"total": 9.44, "avg": 0.07, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 106.92, "avg": 0.84, "max": 0.74, "min": 1.41, "cnt": 128}, "fwd-misc":{"total": 20.23, "avg": 0.16, "max": 0.11, "min": 0.34, "cnt": 128}, "fwd-MLP":{"total": 1609.64, "avg": 12.58, "max": 9.79, "min": 20.54, "cnt": 128}, "MoE_L0_fwd":{"total": 506.41, "avg": 15.83, "max": 10.87, "min": 20.40, "cnt": 32}, "MoEMLP":{"total": 1593.17, "avg": 12.45, "max": 9.68, "min": 20.32, "cnt": 128}, "MoE_L1_fwd":{"total": 394.42, "avg": 12.33, "max": 11.15, "min": 15.39, "cnt": 32}, "MoE_L2_fwd":{"total": 363.23, "avg": 11.35, "max": 10.34, "min": 15.65, "cnt": 32}, "MoE_L3_fwd":{"total": 335.09, "avg": 10.47, "max": 9.72, "min": 16.10, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.56, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.48, "avg": 0.74, "max": 0.66, "min": 0.82, "cnt": 2}, "forward-send-backward-recv":{"total": 256.80, "avg": 8.56, "max": 1.08, "min": 105.66, "cnt": 30}, "backward-compute":{"total": 1456.79, "avg": 45.52, "max": 43.22, "min": 47.12, "cnt": 32}, "MoE_L3_bwd":{"total": 314.59, "avg": 9.83, "max": 8.81, "min": 11.32, "cnt": 32}, "MoE_L2_bwd":{"total": 319.60, "avg": 9.99, "max": 9.27, "min": 10.36, "cnt": 32}, "MoE_L1_bwd":{"total": 319.84, "avg": 9.99, "max": 9.24, "min": 11.62, "cnt": 32}, "MoE_L0_bwd":{"total": 285.12, "avg": 8.91, "max": 8.44, "min": 9.25, "cnt": 32}, "backward-send-forward-recv":{"total": 2105.19, "avg": 72.59, "max": 1.64, "min": 462.71, "cnt": 29}, "backward-send":{"total": 2.11, "avg": 0.70, "max": 0.44, "min": 0.99, "cnt": 3}, "backward-recv":{"total": 142.94, "avg": 71.47, "max": 54.92, "min": 88.02, "cnt": 2}, "backward-params-all-reduce":{"total": 486.68, "avg": 486.68, "max": 486.68, "min": 486.68, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 247.92, "avg": 247.92, "max": 247.92, "min": 247.92, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 208.13, "avg": 208.13, "max": 208.13, "min": 208.13, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.29, "avg": 3.29, "max": 3.29, "min": 3.29, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.53, "avg": 3.53, "max": 3.53, "min": 3.53, "cnt": 1}}}
{"type":"time", "iteration": 128, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 54.02, "avg": 18.01, "max": 1.03, "min": 51.81, "cnt": 3}, "forward-compute":{"total": 1750.40, "avg": 54.70, "max": 49.51, "min": 61.89, "cnt": 32}, "fwd-compute":{"total": 1747.29, "avg": 54.60, "max": 49.44, "min": 61.68, "cnt": 32}, "batch-generator":{"total": 36.61, "avg": 1.14, "max": 0.65, "min": 1.91, "cnt": 32}, "fwd-embedding":{"total": 0.65, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1698.24, "avg": 53.07, "max": 48.10, "min": 59.64, "cnt": 32}, "fwd-layernorm":{"total": 9.66, "avg": 0.08, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 109.53, "avg": 0.86, "max": 0.74, "min": 2.21, "cnt": 128}, "fwd-misc":{"total": 21.05, "avg": 0.16, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1537.15, "avg": 12.01, "max": 9.48, "min": 17.94, "cnt": 128}, "MoE_L0_fwd":{"total": 454.20, "avg": 14.19, "max": 10.77, "min": 17.87, "cnt": 32}, "MoEMLP":{"total": 1520.16, "avg": 11.88, "max": 9.37, "min": 17.82, "cnt": 128}, "MoE_L1_fwd":{"total": 383.52, "avg": 11.99, "max": 11.08, "min": 14.42, "cnt": 32}, "MoE_L2_fwd":{"total": 364.48, "avg": 11.39, "max": 10.62, "min": 15.75, "cnt": 32}, "MoE_L3_fwd":{"total": 324.19, "avg": 10.13, "max": 9.41, "min": 11.41, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.56, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.71, "avg": 0.86, "max": 0.77, "min": 0.94, "cnt": 2}, "forward-send-backward-recv":{"total": 473.70, "avg": 15.79, "max": 1.68, "min": 120.55, "cnt": 30}, "backward-compute":{"total": 1459.99, "avg": 45.62, "max": 43.61, "min": 47.63, "cnt": 32}, "MoE_L3_bwd":{"total": 317.91, "avg": 9.93, "max": 8.75, "min": 13.75, "cnt": 32}, "MoE_L2_bwd":{"total": 322.92, "avg": 10.09, "max": 8.47, "min": 11.23, "cnt": 32}, "MoE_L1_bwd":{"total": 316.54, "avg": 9.89, "max": 9.26, "min": 10.36, "cnt": 32}, "MoE_L0_bwd":{"total": 285.24, "avg": 8.91, "max": 8.61, "min": 9.17, "cnt": 32}, "backward-send-forward-recv":{"total": 1686.10, "avg": 58.14, "max": 2.13, "min": 186.37, "cnt": 29}, "backward-send":{"total": 2.75, "avg": 0.92, "max": 0.58, "min": 1.15, "cnt": 3}, "backward-recv":{"total": 132.64, "avg": 66.32, "max": 60.54, "min": 72.09, "cnt": 2}, "backward-params-all-reduce":{"total": 488.85, "avg": 488.85, "max": 488.85, "min": 488.85, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 246.11, "avg": 246.11, "max": 246.11, "min": 246.11, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 206.23, "avg": 206.23, "max": 206.23, "min": 206.23, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.36, "avg": 3.36, "max": 3.36, "min": 3.36, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.47, "avg": 3.47, "max": 3.47, "min": 3.47, "cnt": 1}}}
{"type":"time", "iteration": 129, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 63.31, "avg": 21.10, "max": 0.81, "min": 56.10, "cnt": 3}, "forward-compute":{"total": 1829.07, "avg": 57.16, "max": 48.55, "min": 69.67, "cnt": 32}, "fwd-compute":{"total": 1825.62, "avg": 57.05, "max": 48.48, "min": 69.51, "cnt": 32}, "batch-generator":{"total": 44.72, "avg": 1.40, "max": 0.66, "min": 2.10, "cnt": 32}, "fwd-embedding":{"total": 0.71, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1767.92, "avg": 55.25, "max": 47.05, "min": 66.97, "cnt": 32}, "fwd-layernorm":{"total": 10.87, "avg": 0.08, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 116.15, "avg": 0.91, "max": 0.74, "min": 2.03, "cnt": 128}, "fwd-misc":{"total": 22.84, "avg": 0.18, "max": 0.11, "min": 0.54, "cnt": 128}, "fwd-MLP":{"total": 1595.13, "avg": 12.46, "max": 9.53, "min": 19.57, "cnt": 128}, "MoE_L0_fwd":{"total": 484.42, "avg": 15.14, "max": 11.02, "min": 19.50, "cnt": 32}, "MoEMLP":{"total": 1576.42, "avg": 12.32, "max": 9.42, "min": 19.46, "cnt": 128}, "MoE_L1_fwd":{"total": 401.59, "avg": 12.55, "max": 10.99, "min": 16.67, "cnt": 32}, "MoE_L2_fwd":{"total": 364.50, "avg": 11.39, "max": 10.33, "min": 14.78, "cnt": 32}, "MoE_L3_fwd":{"total": 332.59, "avg": 10.39, "max": 9.46, "min": 15.22, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 9.74, "avg": 4.87, "max": 0.75, "min": 8.99, "cnt": 2}, "forward-send-backward-recv":{"total": 1365.24, "avg": 45.51, "max": 1.68, "min": 210.80, "cnt": 30}, "backward-compute":{"total": 1461.01, "avg": 45.66, "max": 43.70, "min": 47.55, "cnt": 32}, "MoE_L3_bwd":{"total": 314.17, "avg": 9.82, "max": 8.69, "min": 10.57, "cnt": 32}, "MoE_L2_bwd":{"total": 324.49, "avg": 10.14, "max": 8.98, "min": 10.70, "cnt": 32}, "MoE_L1_bwd":{"total": 319.05, "avg": 9.97, "max": 9.32, "min": 10.79, "cnt": 32}, "MoE_L0_bwd":{"total": 285.28, "avg": 8.91, "max": 8.48, "min": 9.16, "cnt": 32}, "backward-send-forward-recv":{"total": 1432.53, "avg": 49.40, "max": 1.49, "min": 368.60, "cnt": 29}, "backward-send":{"total": 3.26, "avg": 1.09, "max": 1.03, "min": 1.12, "cnt": 3}, "backward-recv":{"total": 205.34, "avg": 102.67, "max": 71.64, "min": 133.71, "cnt": 2}, "backward-params-all-reduce":{"total": 489.12, "avg": 489.12, "max": 489.12, "min": 489.12, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 243.83, "avg": 243.83, "max": 243.83, "min": 243.83, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 204.02, "avg": 204.02, "max": 204.02, "min": 204.02, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.27, "avg": 3.27, "max": 3.27, "min": 3.27, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 130, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 64.29, "avg": 21.43, "max": 1.11, "min": 61.76, "cnt": 3}, "forward-compute":{"total": 1818.50, "avg": 56.83, "max": 49.26, "min": 65.69, "cnt": 32}, "fwd-compute":{"total": 1815.27, "avg": 56.73, "max": 49.19, "min": 65.61, "cnt": 32}, "batch-generator":{"total": 47.72, "avg": 1.49, "max": 0.76, "min": 2.98, "cnt": 32}, "fwd-embedding":{"total": 0.80, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1754.47, "avg": 54.83, "max": 48.14, "min": 64.40, "cnt": 32}, "fwd-layernorm":{"total": 10.62, "avg": 0.08, "max": 0.05, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 113.05, "avg": 0.88, "max": 0.74, "min": 1.46, "cnt": 128}, "fwd-misc":{"total": 22.24, "avg": 0.17, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1586.72, "avg": 12.40, "max": 9.61, "min": 19.90, "cnt": 128}, "MoE_L0_fwd":{"total": 480.17, "avg": 15.01, "max": 11.11, "min": 19.82, "cnt": 32}, "MoEMLP":{"total": 1568.92, "avg": 12.26, "max": 9.50, "min": 19.78, "cnt": 128}, "MoE_L1_fwd":{"total": 398.11, "avg": 12.44, "max": 10.87, "min": 15.77, "cnt": 32}, "MoE_L2_fwd":{"total": 366.38, "avg": 11.45, "max": 10.74, "min": 14.70, "cnt": 32}, "MoE_L3_fwd":{"total": 330.73, "avg": 10.34, "max": 9.54, "min": 13.49, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 139.55, "avg": 69.77, "max": 0.90, "min": 138.65, "cnt": 2}, "forward-send-backward-recv":{"total": 603.48, "avg": 20.12, "max": 1.52, "min": 156.47, "cnt": 30}, "backward-compute":{"total": 1464.27, "avg": 45.76, "max": 43.69, "min": 48.90, "cnt": 32}, "MoE_L3_bwd":{"total": 323.37, "avg": 10.11, "max": 9.31, "min": 13.28, "cnt": 32}, "MoE_L2_bwd":{"total": 325.01, "avg": 10.16, "max": 9.23, "min": 11.01, "cnt": 32}, "MoE_L1_bwd":{"total": 315.47, "avg": 9.86, "max": 9.23, "min": 11.46, "cnt": 32}, "MoE_L0_bwd":{"total": 283.67, "avg": 8.86, "max": 8.48, "min": 9.28, "cnt": 32}, "backward-send-forward-recv":{"total": 1797.48, "avg": 61.98, "max": 1.89, "min": 465.78, "cnt": 29}, "backward-send":{"total": 2.56, "avg": 0.85, "max": 0.78, "min": 0.92, "cnt": 3}, "backward-recv":{"total": 162.38, "avg": 81.19, "max": 62.46, "min": 99.92, "cnt": 2}, "backward-params-all-reduce":{"total": 499.61, "avg": 499.61, "max": 499.61, "min": 499.61, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 240.69, "avg": 240.69, "max": 240.69, "min": 240.69, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 200.66, "avg": 200.66, "max": 200.66, "min": 200.66, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.47, "avg": 3.47, "max": 3.47, "min": 3.47, "cnt": 1}}}
{"type":"time", "iteration": 131, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.06, "avg": 0.06, "max": 0.06, "min": 0.06, "cnt": 1}, "forward-recv":{"total": 52.38, "avg": 17.46, "max": 0.94, "min": 50.33, "cnt": 3}, "forward-compute":{"total": 1824.96, "avg": 57.03, "max": 50.65, "min": 65.25, "cnt": 32}, "fwd-compute":{"total": 1821.87, "avg": 56.93, "max": 50.58, "min": 65.17, "cnt": 32}, "batch-generator":{"total": 56.45, "avg": 1.76, "max": 0.68, "min": 4.19, "cnt": 32}, "fwd-embedding":{"total": 0.67, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1752.92, "avg": 54.78, "max": 49.44, "min": 62.01, "cnt": 32}, "fwd-layernorm":{"total": 10.13, "avg": 0.08, "max": 0.05, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 109.41, "avg": 0.85, "max": 0.74, "min": 1.49, "cnt": 128}, "fwd-misc":{"total": 20.97, "avg": 0.16, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1591.60, "avg": 12.43, "max": 9.67, "min": 22.38, "cnt": 128}, "MoE_L0_fwd":{"total": 495.75, "avg": 15.49, "max": 11.44, "min": 22.30, "cnt": 32}, "MoEMLP":{"total": 1574.65, "avg": 12.30, "max": 9.57, "min": 22.25, "cnt": 128}, "MoE_L1_fwd":{"total": 391.67, "avg": 12.24, "max": 11.18, "min": 13.56, "cnt": 32}, "MoE_L2_fwd":{"total": 360.09, "avg": 11.25, "max": 10.30, "min": 15.86, "cnt": 32}, "MoE_L3_fwd":{"total": 333.25, "avg": 10.41, "max": 9.61, "min": 12.33, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.55, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.45, "avg": 0.72, "max": 0.69, "min": 0.76, "cnt": 2}, "forward-send-backward-recv":{"total": 243.94, "avg": 8.13, "max": 1.83, "min": 99.74, "cnt": 30}, "backward-compute":{"total": 1457.60, "avg": 45.55, "max": 44.03, "min": 46.44, "cnt": 32}, "MoE_L3_bwd":{"total": 324.30, "avg": 10.13, "max": 9.34, "min": 10.79, "cnt": 32}, "MoE_L2_bwd":{"total": 325.20, "avg": 10.16, "max": 8.88, "min": 10.91, "cnt": 32}, "MoE_L1_bwd":{"total": 310.79, "avg": 9.71, "max": 9.44, "min": 10.18, "cnt": 32}, "MoE_L0_bwd":{"total": 281.87, "avg": 8.81, "max": 8.45, "min": 9.02, "cnt": 32}, "backward-send-forward-recv":{"total": 7280.62, "avg": 251.06, "max": 1.64, "min": 1475.93, "cnt": 29}, "backward-send":{"total": 2.84, "avg": 0.95, "max": 0.62, "min": 1.25, "cnt": 3}, "backward-recv":{"total": 145.99, "avg": 72.99, "max": 72.52, "min": 73.47, "cnt": 2}, "backward-params-all-reduce":{"total": 489.95, "avg": 489.95, "max": 489.95, "min": 489.95, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 240.90, "avg": 240.90, "max": 240.90, "min": 240.90, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 200.83, "avg": 200.83, "max": 200.83, "min": 200.83, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.48, "avg": 3.48, "max": 3.48, "min": 3.48, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.47, "avg": 3.47, "max": 3.47, "min": 3.47, "cnt": 1}}}
{"type":"time", "iteration": 132, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 58.71, "avg": 19.57, "max": 1.04, "min": 54.28, "cnt": 3}, "forward-compute":{"total": 1762.47, "avg": 55.08, "max": 47.95, "min": 68.35, "cnt": 32}, "fwd-compute":{"total": 1759.44, "avg": 54.98, "max": 47.89, "min": 68.26, "cnt": 32}, "batch-generator":{"total": 45.32, "avg": 1.42, "max": 0.62, "min": 3.41, "cnt": 32}, "fwd-embedding":{"total": 0.55, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1702.35, "avg": 53.20, "max": 46.99, "min": 65.74, "cnt": 32}, "fwd-layernorm":{"total": 9.23, "avg": 0.07, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 106.97, "avg": 0.84, "max": 0.74, "min": 1.84, "cnt": 128}, "fwd-misc":{"total": 19.79, "avg": 0.15, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1546.65, "avg": 12.08, "max": 9.62, "min": 19.63, "cnt": 128}, "MoE_L0_fwd":{"total": 468.29, "avg": 14.63, "max": 10.85, "min": 19.55, "cnt": 32}, "MoEMLP":{"total": 1530.30, "avg": 11.96, "max": 9.52, "min": 19.51, "cnt": 128}, "MoE_L1_fwd":{"total": 378.18, "avg": 11.82, "max": 10.69, "min": 16.11, "cnt": 32}, "MoE_L2_fwd":{"total": 363.65, "avg": 11.36, "max": 10.40, "min": 18.32, "cnt": 32}, "MoE_L3_fwd":{"total": 326.09, "avg": 10.19, "max": 9.55, "min": 14.24, "cnt": 32}, "fwd-pooler":{"total": 0.31, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 2.00, "avg": 1.00, "max": 0.78, "min": 1.22, "cnt": 2}, "forward-send-backward-recv":{"total": 200.81, "avg": 6.69, "max": 1.36, "min": 109.03, "cnt": 30}, "backward-compute":{"total": 1456.30, "avg": 45.51, "max": 43.01, "min": 49.68, "cnt": 32}, "MoE_L3_bwd":{"total": 326.94, "avg": 10.22, "max": 9.09, "min": 12.13, "cnt": 32}, "MoE_L2_bwd":{"total": 330.22, "avg": 10.32, "max": 9.44, "min": 13.03, "cnt": 32}, "MoE_L1_bwd":{"total": 304.57, "avg": 9.52, "max": 8.89, "min": 9.81, "cnt": 32}, "MoE_L0_bwd":{"total": 278.04, "avg": 8.69, "max": 8.37, "min": 9.02, "cnt": 32}, "backward-send-forward-recv":{"total": 9424.50, "avg": 324.98, "max": 2.35, "min": 2298.35, "cnt": 29}, "backward-send":{"total": 2.92, "avg": 0.97, "max": 0.87, "min": 1.10, "cnt": 3}, "backward-recv":{"total": 117.65, "avg": 58.83, "max": 51.89, "min": 65.76, "cnt": 2}, "backward-params-all-reduce":{"total": 488.70, "avg": 488.70, "max": 488.70, "min": 488.70, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 250.65, "avg": 250.65, "max": 250.65, "min": 250.65, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 210.69, "avg": 210.69, "max": 210.69, "min": 210.69, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.35, "avg": 3.35, "max": 3.35, "min": 3.35, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.47, "avg": 3.47, "max": 3.47, "min": 3.47, "cnt": 1}}}
{"type":"time", "iteration": 133, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 2036.20, "avg": 678.73, "max": 176.71, "min": 1367.40, "cnt": 3}, "forward-compute":{"total": 1798.62, "avg": 56.21, "max": 49.57, "min": 64.79, "cnt": 32}, "fwd-compute":{"total": 1795.91, "avg": 56.12, "max": 49.50, "min": 64.72, "cnt": 32}, "batch-generator":{"total": 45.09, "avg": 1.41, "max": 0.73, "min": 3.30, "cnt": 32}, "fwd-embedding":{"total": 0.54, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1739.28, "avg": 54.35, "max": 48.38, "min": 63.66, "cnt": 32}, "fwd-layernorm":{"total": 9.17, "avg": 0.07, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 105.91, "avg": 0.83, "max": 0.75, "min": 2.29, "cnt": 128}, "fwd-misc":{"total": 19.67, "avg": 0.15, "max": 0.11, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1585.02, "avg": 12.38, "max": 9.68, "min": 18.19, "cnt": 128}, "MoE_L0_fwd":{"total": 476.51, "avg": 14.89, "max": 11.27, "min": 18.11, "cnt": 32}, "MoEMLP":{"total": 1569.22, "avg": 12.26, "max": 9.58, "min": 18.06, "cnt": 128}, "MoE_L1_fwd":{"total": 393.95, "avg": 12.31, "max": 10.84, "min": 15.47, "cnt": 32}, "MoE_L2_fwd":{"total": 368.94, "avg": 11.53, "max": 10.65, "min": 17.74, "cnt": 32}, "MoE_L3_fwd":{"total": 335.63, "avg": 10.49, "max": 9.62, "min": 13.82, "cnt": 32}, "fwd-pooler":{"total": 0.31, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.55, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.47, "avg": 0.74, "max": 0.71, "min": 0.76, "cnt": 2}, "forward-send-backward-recv":{"total": 178.51, "avg": 5.95, "max": 1.78, "min": 99.18, "cnt": 30}, "backward-compute":{"total": 1499.11, "avg": 46.85, "max": 45.30, "min": 48.02, "cnt": 32}, "MoE_L3_bwd":{"total": 335.89, "avg": 10.50, "max": 9.86, "min": 11.67, "cnt": 32}, "MoE_L2_bwd":{"total": 337.97, "avg": 10.56, "max": 9.70, "min": 11.35, "cnt": 32}, "MoE_L1_bwd":{"total": 324.25, "avg": 10.13, "max": 9.61, "min": 10.46, "cnt": 32}, "MoE_L0_bwd":{"total": 284.04, "avg": 8.88, "max": 8.14, "min": 9.21, "cnt": 32}, "backward-send-forward-recv":{"total": 7122.90, "avg": 245.62, "max": 1.63, "min": 1290.68, "cnt": 29}, "backward-send":{"total": 1.76, "avg": 0.59, "max": 0.51, "min": 0.70, "cnt": 3}, "backward-recv":{"total": 137.86, "avg": 68.93, "max": 64.07, "min": 73.79, "cnt": 2}, "backward-params-all-reduce":{"total": 487.10, "avg": 487.10, "max": 487.10, "min": 487.10, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 248.28, "avg": 248.28, "max": 248.28, "min": 248.28, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 208.44, "avg": 208.44, "max": 208.44, "min": 208.44, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.30, "avg": 3.30, "max": 3.30, "min": 3.30, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 134, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 59.29, "avg": 19.76, "max": 1.04, "min": 53.52, "cnt": 3}, "forward-compute":{"total": 1788.93, "avg": 55.90, "max": 50.59, "min": 64.44, "cnt": 32}, "fwd-compute":{"total": 1785.75, "avg": 55.80, "max": 50.49, "min": 64.29, "cnt": 32}, "batch-generator":{"total": 50.02, "avg": 1.56, "max": 0.67, "min": 3.33, "cnt": 32}, "fwd-embedding":{"total": 0.65, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1723.60, "avg": 53.86, "max": 48.01, "min": 62.07, "cnt": 32}, "fwd-layernorm":{"total": 9.83, "avg": 0.08, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 108.98, "avg": 0.85, "max": 0.74, "min": 2.05, "cnt": 128}, "fwd-misc":{"total": 21.22, "avg": 0.17, "max": 0.11, "min": 0.47, "cnt": 128}, "fwd-MLP":{"total": 1563.07, "avg": 12.21, "max": 9.87, "min": 18.30, "cnt": 128}, "MoE_L0_fwd":{"total": 464.90, "avg": 14.53, "max": 10.76, "min": 18.22, "cnt": 32}, "MoEMLP":{"total": 1546.18, "avg": 12.08, "max": 9.73, "min": 18.18, "cnt": 128}, "MoE_L1_fwd":{"total": 388.17, "avg": 12.13, "max": 10.62, "min": 17.79, "cnt": 32}, "MoE_L2_fwd":{"total": 362.57, "avg": 11.33, "max": 10.62, "min": 12.73, "cnt": 32}, "MoE_L3_fwd":{"total": 336.77, "avg": 10.52, "max": 9.78, "min": 11.64, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 2.75, "avg": 1.37, "max": 0.86, "min": 1.89, "cnt": 2}, "forward-send-backward-recv":{"total": 292.62, "avg": 9.75, "max": 1.63, "min": 98.93, "cnt": 30}, "backward-compute":{"total": 1466.96, "avg": 45.84, "max": 43.28, "min": 47.23, "cnt": 32}, "MoE_L3_bwd":{"total": 340.97, "avg": 10.66, "max": 9.45, "min": 11.69, "cnt": 32}, "MoE_L2_bwd":{"total": 328.04, "avg": 10.25, "max": 9.79, "min": 11.11, "cnt": 32}, "MoE_L1_bwd":{"total": 303.86, "avg": 9.50, "max": 9.09, "min": 9.80, "cnt": 32}, "MoE_L0_bwd":{"total": 278.05, "avg": 8.69, "max": 8.00, "min": 9.36, "cnt": 32}, "backward-send-forward-recv":{"total": 1555.72, "avg": 53.65, "max": 1.65, "min": 183.03, "cnt": 29}, "backward-send":{"total": 2.34, "avg": 0.78, "max": 0.65, "min": 0.88, "cnt": 3}, "backward-recv":{"total": 136.14, "avg": 68.07, "max": 63.35, "min": 72.79, "cnt": 2}, "backward-params-all-reduce":{"total": 485.21, "avg": 485.21, "max": 485.21, "min": 485.21, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 248.17, "avg": 248.17, "max": 248.17, "min": 248.17, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 208.47, "avg": 208.47, "max": 208.47, "min": 208.47, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.30, "avg": 3.30, "max": 3.30, "min": 3.30, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 135, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 62.95, "avg": 20.98, "max": 1.34, "min": 56.13, "cnt": 3}, "forward-compute":{"total": 1794.27, "avg": 56.07, "max": 47.71, "min": 63.17, "cnt": 32}, "fwd-compute":{"total": 1791.18, "avg": 55.97, "max": 47.65, "min": 63.08, "cnt": 32}, "batch-generator":{"total": 51.60, "avg": 1.61, "max": 0.65, "min": 3.43, "cnt": 32}, "fwd-embedding":{"total": 0.59, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1727.35, "avg": 53.98, "max": 46.71, "min": 59.79, "cnt": 32}, "fwd-layernorm":{"total": 9.70, "avg": 0.08, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 107.69, "avg": 0.84, "max": 0.75, "min": 1.46, "cnt": 128}, "fwd-misc":{"total": 20.61, "avg": 0.16, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1568.82, "avg": 12.26, "max": 10.06, "min": 19.65, "cnt": 128}, "MoE_L0_fwd":{"total": 470.49, "avg": 14.70, "max": 10.43, "min": 19.57, "cnt": 32}, "MoEMLP":{"total": 1552.04, "avg": 12.13, "max": 9.94, "min": 19.52, "cnt": 128}, "MoE_L1_fwd":{"total": 387.34, "avg": 12.10, "max": 10.69, "min": 14.45, "cnt": 32}, "MoE_L2_fwd":{"total": 358.87, "avg": 11.21, "max": 10.70, "min": 12.30, "cnt": 32}, "MoE_L3_fwd":{"total": 341.53, "avg": 10.67, "max": 9.98, "min": 11.65, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.04, "cnt": 32}, "forward-send":{"total": 1.81, "avg": 0.91, "max": 0.88, "min": 0.94, "cnt": 2}, "forward-send-backward-recv":{"total": 418.01, "avg": 13.93, "max": 1.69, "min": 123.42, "cnt": 30}, "backward-compute":{"total": 1483.55, "avg": 46.36, "max": 44.15, "min": 48.97, "cnt": 32}, "MoE_L3_bwd":{"total": 345.31, "avg": 10.79, "max": 9.81, "min": 13.31, "cnt": 32}, "MoE_L2_bwd":{"total": 327.88, "avg": 10.25, "max": 9.31, "min": 11.16, "cnt": 32}, "MoE_L1_bwd":{"total": 312.51, "avg": 9.77, "max": 9.23, "min": 11.23, "cnt": 32}, "MoE_L0_bwd":{"total": 281.08, "avg": 8.78, "max": 8.33, "min": 9.12, "cnt": 32}, "backward-send-forward-recv":{"total": 2393.17, "avg": 82.52, "max": 1.79, "min": 638.11, "cnt": 29}, "backward-send":{"total": 3.44, "avg": 1.15, "max": 1.07, "min": 1.20, "cnt": 3}, "backward-recv":{"total": 149.11, "avg": 74.55, "max": 68.82, "min": 80.29, "cnt": 2}, "backward-params-all-reduce":{"total": 489.95, "avg": 489.95, "max": 489.95, "min": 489.95, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 238.53, "avg": 238.53, "max": 238.53, "min": 238.53, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 198.77, "avg": 198.77, "max": 198.77, "min": 198.77, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.25, "avg": 3.25, "max": 3.25, "min": 3.25, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 136, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 63.04, "avg": 21.01, "max": 0.77, "min": 60.75, "cnt": 3}, "forward-compute":{"total": 1799.53, "avg": 56.24, "max": 50.98, "min": 61.36, "cnt": 32}, "fwd-compute":{"total": 1796.37, "avg": 56.14, "max": 50.90, "min": 61.28, "cnt": 32}, "batch-generator":{"total": 41.82, "avg": 1.31, "max": 0.66, "min": 3.32, "cnt": 32}, "fwd-embedding":{"total": 0.64, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1742.34, "avg": 54.45, "max": 49.83, "min": 60.11, "cnt": 32}, "fwd-layernorm":{"total": 9.87, "avg": 0.08, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 108.85, "avg": 0.85, "max": 0.74, "min": 1.46, "cnt": 128}, "fwd-misc":{"total": 20.72, "avg": 0.16, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1582.05, "avg": 12.36, "max": 10.01, "min": 18.56, "cnt": 128}, "MoE_L0_fwd":{"total": 483.78, "avg": 15.12, "max": 11.62, "min": 18.49, "cnt": 32}, "MoEMLP":{"total": 1565.35, "avg": 12.23, "max": 9.90, "min": 18.44, "cnt": 128}, "MoE_L1_fwd":{"total": 386.81, "avg": 12.09, "max": 10.63, "min": 14.73, "cnt": 32}, "MoE_L2_fwd":{"total": 361.50, "avg": 11.30, "max": 10.75, "min": 12.47, "cnt": 32}, "MoE_L3_fwd":{"total": 339.38, "avg": 10.61, "max": 9.94, "min": 11.41, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.56, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 4.48, "avg": 2.24, "max": 0.79, "min": 3.69, "cnt": 2}, "forward-send-backward-recv":{"total": 899.19, "avg": 29.97, "max": 1.75, "min": 199.04, "cnt": 30}, "backward-compute":{"total": 1494.96, "avg": 46.72, "max": 44.44, "min": 48.88, "cnt": 32}, "MoE_L3_bwd":{"total": 350.49, "avg": 10.95, "max": 10.09, "min": 12.65, "cnt": 32}, "MoE_L2_bwd":{"total": 335.76, "avg": 10.49, "max": 9.72, "min": 12.91, "cnt": 32}, "MoE_L1_bwd":{"total": 310.86, "avg": 9.71, "max": 9.22, "min": 10.22, "cnt": 32}, "MoE_L0_bwd":{"total": 279.71, "avg": 8.74, "max": 7.98, "min": 9.10, "cnt": 32}, "backward-send-forward-recv":{"total": 2546.55, "avg": 87.81, "max": 1.66, "min": 890.86, "cnt": 29}, "backward-send":{"total": 3.34, "avg": 1.11, "max": 0.98, "min": 1.26, "cnt": 3}, "backward-recv":{"total": 148.71, "avg": 74.35, "max": 70.10, "min": 78.61, "cnt": 2}, "backward-params-all-reduce":{"total": 485.12, "avg": 485.12, "max": 485.12, "min": 485.12, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 247.47, "avg": 247.47, "max": 247.47, "min": 247.47, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 207.73, "avg": 207.73, "max": 207.73, "min": 207.73, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.29, "avg": 3.29, "max": 3.29, "min": 3.29, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.50, "avg": 3.50, "max": 3.50, "min": 3.50, "cnt": 1}}}
{"type":"time", "iteration": 137, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 53.12, "avg": 17.71, "max": 0.75, "min": 51.22, "cnt": 3}, "forward-compute":{"total": 1814.41, "avg": 56.70, "max": 49.38, "min": 65.42, "cnt": 32}, "fwd-compute":{"total": 1811.28, "avg": 56.60, "max": 49.31, "min": 65.34, "cnt": 32}, "batch-generator":{"total": 39.52, "avg": 1.24, "max": 0.65, "min": 2.49, "cnt": 32}, "fwd-embedding":{"total": 0.64, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1759.26, "avg": 54.98, "max": 48.32, "min": 64.13, "cnt": 32}, "fwd-layernorm":{"total": 9.93, "avg": 0.08, "max": 0.05, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 110.87, "avg": 0.87, "max": 0.74, "min": 1.71, "cnt": 128}, "fwd-misc":{"total": 21.25, "avg": 0.17, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1596.16, "avg": 12.47, "max": 9.95, "min": 19.01, "cnt": 128}, "MoE_L0_fwd":{"total": 488.69, "avg": 15.27, "max": 11.11, "min": 18.10, "cnt": 32}, "MoEMLP":{"total": 1578.90, "avg": 12.34, "max": 9.84, "min": 18.87, "cnt": 128}, "MoE_L1_fwd":{"total": 398.82, "avg": 12.46, "max": 10.68, "min": 18.92, "cnt": 32}, "MoE_L2_fwd":{"total": 359.36, "avg": 11.23, "max": 10.61, "min": 12.63, "cnt": 32}, "MoE_L3_fwd":{"total": 338.20, "avg": 10.57, "max": 9.88, "min": 11.39, "cnt": 32}, "fwd-pooler":{"total": 0.31, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 8.01, "avg": 4.00, "max": 0.89, "min": 7.12, "cnt": 2}, "forward-send-backward-recv":{"total": 248.63, "avg": 8.29, "max": 1.35, "min": 117.43, "cnt": 30}, "backward-compute":{"total": 1478.49, "avg": 46.20, "max": 45.22, "min": 47.66, "cnt": 32}, "MoE_L3_bwd":{"total": 345.82, "avg": 10.81, "max": 9.81, "min": 12.04, "cnt": 32}, "MoE_L2_bwd":{"total": 332.04, "avg": 10.38, "max": 9.92, "min": 11.25, "cnt": 32}, "MoE_L1_bwd":{"total": 305.40, "avg": 9.54, "max": 9.20, "min": 9.99, "cnt": 32}, "MoE_L0_bwd":{"total": 278.32, "avg": 8.70, "max": 8.27, "min": 10.30, "cnt": 32}, "backward-send-forward-recv":{"total": 2369.00, "avg": 81.69, "max": 1.77, "min": 536.26, "cnt": 29}, "backward-send":{"total": 2.22, "avg": 0.74, "max": 0.70, "min": 0.82, "cnt": 3}, "backward-recv":{"total": 147.33, "avg": 73.66, "max": 73.51, "min": 73.82, "cnt": 2}, "backward-params-all-reduce":{"total": 488.42, "avg": 488.42, "max": 488.42, "min": 488.42, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 244.86, "avg": 244.86, "max": 244.86, "min": 244.86, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.40, "avg": 3.40, "max": 3.40, "min": 3.40, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 204.12, "avg": 204.12, "max": 204.12, "min": 204.12, "cnt": 1}, "optimizer-clip-main-grad":{"total": 4.23, "avg": 4.23, "max": 4.23, "min": 4.23, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 138, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.06, "avg": 0.06, "max": 0.06, "min": 0.06, "cnt": 1}, "forward-recv":{"total": 58.54, "avg": 19.51, "max": 0.79, "min": 56.31, "cnt": 3}, "forward-compute":{"total": 1810.54, "avg": 56.58, "max": 48.33, "min": 64.26, "cnt": 32}, "fwd-compute":{"total": 1807.35, "avg": 56.48, "max": 48.27, "min": 64.17, "cnt": 32}, "batch-generator":{"total": 40.76, "avg": 1.27, "max": 0.65, "min": 1.98, "cnt": 32}, "fwd-embedding":{"total": 0.64, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1754.14, "avg": 54.82, "max": 47.27, "min": 62.78, "cnt": 32}, "fwd-layernorm":{"total": 9.91, "avg": 0.08, "max": 0.05, "min": 0.18, "cnt": 128}, "fwd-attn":{"total": 108.86, "avg": 0.85, "max": 0.74, "min": 1.59, "cnt": 128}, "fwd-misc":{"total": 20.95, "avg": 0.16, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1593.03, "avg": 12.45, "max": 10.02, "min": 20.15, "cnt": 128}, "MoE_L0_fwd":{"total": 478.41, "avg": 14.95, "max": 10.65, "min": 20.07, "cnt": 32}, "MoEMLP":{"total": 1575.91, "avg": 12.31, "max": 9.90, "min": 20.03, "cnt": 128}, "MoE_L1_fwd":{"total": 379.91, "avg": 11.87, "max": 10.69, "min": 12.84, "cnt": 32}, "MoE_L2_fwd":{"total": 365.69, "avg": 11.43, "max": 10.66, "min": 12.79, "cnt": 32}, "MoE_L3_fwd":{"total": 358.00, "avg": 11.19, "max": 9.94, "min": 16.79, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 13.77, "avg": 6.89, "max": 0.93, "min": 12.84, "cnt": 2}, "forward-send-backward-recv":{"total": 1382.21, "avg": 46.07, "max": 1.67, "min": 228.94, "cnt": 30}, "backward-compute":{"total": 1476.71, "avg": 46.15, "max": 44.27, "min": 47.14, "cnt": 32}, "MoE_L3_bwd":{"total": 347.53, "avg": 10.86, "max": 10.33, "min": 11.68, "cnt": 32}, "MoE_L2_bwd":{"total": 333.23, "avg": 10.41, "max": 9.18, "min": 11.12, "cnt": 32}, "MoE_L1_bwd":{"total": 306.08, "avg": 9.56, "max": 9.29, "min": 10.07, "cnt": 32}, "MoE_L0_bwd":{"total": 273.74, "avg": 8.55, "max": 8.25, "min": 8.88, "cnt": 32}, "backward-send-forward-recv":{"total": 837.95, "avg": 28.89, "max": 1.69, "min": 156.43, "cnt": 29}, "backward-send":{"total": 2.33, "avg": 0.78, "max": 0.54, "min": 1.03, "cnt": 3}, "backward-recv":{"total": 237.21, "avg": 118.60, "max": 76.84, "min": 160.37, "cnt": 2}, "backward-params-all-reduce":{"total": 488.52, "avg": 488.52, "max": 488.52, "min": 488.52, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 243.19, "avg": 243.19, "max": 243.19, "min": 243.19, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 203.54, "avg": 203.54, "max": 203.54, "min": 203.54, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.25, "avg": 3.25, "max": 3.25, "min": 3.25, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 139, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.06, "avg": 0.06, "max": 0.06, "min": 0.06, "cnt": 1}, "forward-recv":{"total": 68.22, "avg": 22.74, "max": 5.86, "min": 54.66, "cnt": 3}, "forward-compute":{"total": 1759.22, "avg": 54.98, "max": 47.62, "min": 62.72, "cnt": 32}, "fwd-compute":{"total": 1756.22, "avg": 54.88, "max": 47.55, "min": 62.64, "cnt": 32}, "batch-generator":{"total": 51.24, "avg": 1.60, "max": 0.70, "min": 3.99, "cnt": 32}, "fwd-embedding":{"total": 0.61, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1692.58, "avg": 52.89, "max": 46.55, "min": 61.34, "cnt": 32}, "fwd-layernorm":{"total": 9.83, "avg": 0.08, "max": 0.05, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 106.76, "avg": 0.83, "max": 0.74, "min": 1.53, "cnt": 128}, "fwd-misc":{"total": 20.43, "avg": 0.16, "max": 0.11, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1535.16, "avg": 11.99, "max": 9.79, "min": 21.60, "cnt": 128}, "MoE_L0_fwd":{"total": 454.27, "avg": 14.20, "max": 10.30, "min": 21.49, "cnt": 32}, "MoEMLP":{"total": 1518.44, "avg": 11.86, "max": 9.69, "min": 21.43, "cnt": 128}, "MoE_L1_fwd":{"total": 376.56, "avg": 11.77, "max": 10.56, "min": 13.51, "cnt": 32}, "MoE_L2_fwd":{"total": 359.02, "avg": 11.22, "max": 10.74, "min": 11.97, "cnt": 32}, "MoE_L3_fwd":{"total": 334.73, "avg": 10.46, "max": 9.72, "min": 11.38, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.78, "avg": 0.89, "max": 0.87, "min": 0.91, "cnt": 2}, "forward-send-backward-recv":{"total": 193.21, "avg": 6.44, "max": 1.55, "min": 100.86, "cnt": 30}, "backward-compute":{"total": 1486.05, "avg": 46.44, "max": 43.83, "min": 53.85, "cnt": 32}, "MoE_L3_bwd":{"total": 347.75, "avg": 10.87, "max": 10.04, "min": 13.28, "cnt": 32}, "MoE_L2_bwd":{"total": 343.48, "avg": 10.73, "max": 9.84, "min": 17.89, "cnt": 32}, "MoE_L1_bwd":{"total": 303.88, "avg": 9.50, "max": 9.18, "min": 10.06, "cnt": 32}, "MoE_L0_bwd":{"total": 275.29, "avg": 8.60, "max": 7.91, "min": 9.16, "cnt": 32}, "backward-send-forward-recv":{"total": 4947.05, "avg": 170.59, "max": 2.36, "min": 708.26, "cnt": 29}, "backward-send":{"total": 2.18, "avg": 0.73, "max": 0.54, "min": 0.93, "cnt": 3}, "backward-recv":{"total": 133.32, "avg": 66.66, "max": 59.52, "min": 73.81, "cnt": 2}, "backward-params-all-reduce":{"total": 493.52, "avg": 493.52, "max": 493.52, "min": 493.52, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 242.79, "avg": 242.79, "max": 242.79, "min": 242.79, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 203.05, "avg": 203.05, "max": 203.05, "min": 203.05, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.34, "avg": 3.34, "max": 3.34, "min": 3.34, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 140, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 70.55, "avg": 23.52, "max": 0.96, "min": 66.72, "cnt": 3}, "forward-compute":{"total": 1777.01, "avg": 55.53, "max": 48.45, "min": 61.28, "cnt": 32}, "fwd-compute":{"total": 1773.84, "avg": 55.43, "max": 48.38, "min": 61.20, "cnt": 32}, "batch-generator":{"total": 43.82, "avg": 1.37, "max": 0.66, "min": 2.70, "cnt": 32}, "fwd-embedding":{"total": 0.64, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1717.32, "avg": 53.67, "max": 47.40, "min": 58.34, "cnt": 32}, "fwd-layernorm":{"total": 9.97, "avg": 0.08, "max": 0.05, "min": 0.18, "cnt": 128}, "fwd-attn":{"total": 113.38, "avg": 0.89, "max": 0.74, "min": 2.18, "cnt": 128}, "fwd-misc":{"total": 21.59, "avg": 0.17, "max": 0.11, "min": 0.45, "cnt": 128}, "fwd-MLP":{"total": 1551.16, "avg": 12.12, "max": 9.82, "min": 18.34, "cnt": 128}, "MoE_L0_fwd":{"total": 453.56, "avg": 14.17, "max": 10.18, "min": 18.15, "cnt": 32}, "MoEMLP":{"total": 1533.93, "avg": 11.98, "max": 9.71, "min": 18.10, "cnt": 128}, "MoE_L1_fwd":{"total": 386.13, "avg": 12.07, "max": 10.76, "min": 13.50, "cnt": 32}, "MoE_L2_fwd":{"total": 361.52, "avg": 11.30, "max": 10.63, "min": 12.59, "cnt": 32}, "MoE_L3_fwd":{"total": 338.98, "avg": 10.59, "max": 9.75, "min": 11.52, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 4.83, "avg": 2.41, "max": 0.84, "min": 3.99, "cnt": 2}, "forward-send-backward-recv":{"total": 386.18, "avg": 12.87, "max": 1.53, "min": 110.81, "cnt": 30}, "backward-compute":{"total": 1483.83, "avg": 46.37, "max": 45.00, "min": 48.45, "cnt": 32}, "MoE_L3_bwd":{"total": 352.22, "avg": 11.01, "max": 10.05, "min": 12.48, "cnt": 32}, "MoE_L2_bwd":{"total": 338.27, "avg": 10.57, "max": 9.84, "min": 13.10, "cnt": 32}, "MoE_L1_bwd":{"total": 302.54, "avg": 9.45, "max": 9.07, "min": 10.01, "cnt": 32}, "MoE_L0_bwd":{"total": 271.79, "avg": 8.49, "max": 8.11, "min": 8.86, "cnt": 32}, "backward-send-forward-recv":{"total": 2847.93, "avg": 98.20, "max": 1.23, "min": 619.16, "cnt": 29}, "backward-send":{"total": 2.63, "avg": 0.88, "max": 0.80, "min": 0.93, "cnt": 3}, "backward-recv":{"total": 143.95, "avg": 71.97, "max": 70.91, "min": 73.04, "cnt": 2}, "backward-params-all-reduce":{"total": 485.00, "avg": 485.00, "max": 485.00, "min": 485.00, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 244.16, "avg": 244.16, "max": 244.16, "min": 244.16, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 204.40, "avg": 204.40, "max": 204.40, "min": 204.40, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.28, "avg": 3.28, "max": 3.28, "min": 3.28, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.49, "avg": 3.49, "max": 3.49, "min": 3.49, "cnt": 1}}}
{"type":"time", "iteration": 141, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 63.66, "avg": 21.22, "max": 0.77, "min": 61.90, "cnt": 3}, "forward-compute":{"total": 1823.09, "avg": 56.97, "max": 48.86, "min": 64.03, "cnt": 32}, "fwd-compute":{"total": 1819.85, "avg": 56.87, "max": 48.79, "min": 63.94, "cnt": 32}, "batch-generator":{"total": 40.80, "avg": 1.28, "max": 0.65, "min": 2.35, "cnt": 32}, "fwd-embedding":{"total": 0.68, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1766.21, "avg": 55.19, "max": 47.83, "min": 62.66, "cnt": 32}, "fwd-layernorm":{"total": 10.37, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 112.06, "avg": 0.88, "max": 0.74, "min": 1.50, "cnt": 128}, "fwd-misc":{"total": 21.65, "avg": 0.17, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1600.40, "avg": 12.50, "max": 9.96, "min": 17.68, "cnt": 128}, "MoE_L0_fwd":{"total": 476.97, "avg": 14.91, "max": 10.79, "min": 17.60, "cnt": 32}, "MoEMLP":{"total": 1582.70, "avg": 12.36, "max": 9.86, "min": 17.55, "cnt": 128}, "MoE_L1_fwd":{"total": 394.01, "avg": 12.31, "max": 10.81, "min": 16.74, "cnt": 32}, "MoE_L2_fwd":{"total": 371.17, "avg": 11.60, "max": 10.85, "min": 16.54, "cnt": 32}, "MoE_L3_fwd":{"total": 346.95, "avg": 10.84, "max": 9.90, "min": 14.36, "cnt": 32}, "fwd-pooler":{"total": 0.31, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 4.11, "avg": 2.05, "max": 0.80, "min": 3.30, "cnt": 2}, "forward-send-backward-recv":{"total": 399.82, "avg": 13.33, "max": 1.42, "min": 114.46, "cnt": 30}, "backward-compute":{"total": 1494.07, "avg": 46.69, "max": 44.64, "min": 48.02, "cnt": 32}, "MoE_L3_bwd":{"total": 351.95, "avg": 11.00, "max": 10.09, "min": 12.13, "cnt": 32}, "MoE_L2_bwd":{"total": 345.88, "avg": 10.81, "max": 10.04, "min": 11.28, "cnt": 32}, "MoE_L1_bwd":{"total": 306.79, "avg": 9.59, "max": 9.16, "min": 10.31, "cnt": 32}, "MoE_L0_bwd":{"total": 275.48, "avg": 8.61, "max": 8.16, "min": 9.51, "cnt": 32}, "backward-send-forward-recv":{"total": 1597.51, "avg": 55.09, "max": 1.70, "min": 277.36, "cnt": 29}, "backward-send":{"total": 3.00, "avg": 1.00, "max": 0.94, "min": 1.07, "cnt": 3}, "backward-recv":{"total": 143.82, "avg": 71.91, "max": 70.67, "min": 73.15, "cnt": 2}, "backward-params-all-reduce":{"total": 487.10, "avg": 487.10, "max": 487.10, "min": 487.10, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 240.10, "avg": 240.10, "max": 240.10, "min": 240.10, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 200.14, "avg": 200.14, "max": 200.14, "min": 200.14, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.32, "avg": 3.32, "max": 3.32, "min": 3.32, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.54, "avg": 3.54, "max": 3.54, "min": 3.54, "cnt": 1}}}
{"type":"time", "iteration": 142, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 2.99, "avg": 1.00, "max": 0.73, "min": 1.35, "cnt": 3}, "forward-compute":{"total": 1781.81, "avg": 55.68, "max": 49.76, "min": 59.50, "cnt": 32}, "fwd-compute":{"total": 1778.85, "avg": 55.59, "max": 49.68, "min": 59.43, "cnt": 32}, "batch-generator":{"total": 38.01, "avg": 1.19, "max": 0.71, "min": 2.38, "cnt": 32}, "fwd-embedding":{"total": 0.62, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1728.87, "avg": 54.03, "max": 48.51, "min": 58.34, "cnt": 32}, "fwd-layernorm":{"total": 9.72, "avg": 0.08, "max": 0.05, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 107.14, "avg": 0.84, "max": 0.74, "min": 1.60, "cnt": 128}, "fwd-misc":{"total": 20.37, "avg": 0.16, "max": 0.11, "min": 0.38, "cnt": 128}, "fwd-MLP":{"total": 1571.30, "avg": 12.28, "max": 9.46, "min": 20.58, "cnt": 128}, "MoE_L0_fwd":{"total": 486.79, "avg": 15.21, "max": 11.55, "min": 20.48, "cnt": 32}, "MoEMLP":{"total": 1554.43, "avg": 12.14, "max": 9.36, "min": 20.42, "cnt": 128}, "MoE_L1_fwd":{"total": 381.70, "avg": 11.93, "max": 10.70, "min": 13.17, "cnt": 32}, "MoE_L2_fwd":{"total": 362.34, "avg": 11.32, "max": 10.69, "min": 12.69, "cnt": 32}, "MoE_L3_fwd":{"total": 329.64, "avg": 10.30, "max": 9.40, "min": 11.13, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.56, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 8.04, "avg": 4.02, "max": 0.60, "min": 7.45, "cnt": 2}, "forward-send-backward-recv":{"total": 1346.64, "avg": 44.89, "max": 1.44, "min": 560.56, "cnt": 30}, "backward-compute":{"total": 1483.86, "avg": 46.37, "max": 44.23, "min": 47.62, "cnt": 32}, "MoE_L3_bwd":{"total": 345.30, "avg": 10.79, "max": 9.68, "min": 12.12, "cnt": 32}, "MoE_L2_bwd":{"total": 337.79, "avg": 10.56, "max": 9.84, "min": 11.39, "cnt": 32}, "MoE_L1_bwd":{"total": 306.20, "avg": 9.57, "max": 9.18, "min": 9.92, "cnt": 32}, "MoE_L0_bwd":{"total": 278.54, "avg": 8.70, "max": 7.94, "min": 9.32, "cnt": 32}, "backward-send-forward-recv":{"total": 1691.10, "avg": 58.31, "max": 1.64, "min": 206.84, "cnt": 29}, "backward-send":{"total": 2.24, "avg": 0.75, "max": 0.51, "min": 0.90, "cnt": 3}, "backward-recv":{"total": 680.62, "avg": 340.31, "max": 73.55, "min": 607.07, "cnt": 2}, "backward-params-all-reduce":{"total": 488.89, "avg": 488.89, "max": 488.89, "min": 488.89, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 238.37, "avg": 238.37, "max": 238.37, "min": 238.37, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 198.67, "avg": 198.67, "max": 198.67, "min": 198.67, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.28, "avg": 3.28, "max": 3.28, "min": 3.28, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 143, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.13, "avg": 0.13, "max": 0.13, "min": 0.13, "cnt": 1}, "forward-recv":{"total": 61.92, "avg": 20.64, "max": 1.08, "min": 59.61, "cnt": 3}, "forward-compute":{"total": 1784.90, "avg": 55.78, "max": 47.88, "min": 71.17, "cnt": 32}, "fwd-compute":{"total": 1781.91, "avg": 55.68, "max": 47.81, "min": 71.09, "cnt": 32}, "batch-generator":{"total": 38.35, "avg": 1.20, "max": 0.66, "min": 3.03, "cnt": 32}, "fwd-embedding":{"total": 0.58, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1730.81, "avg": 54.09, "max": 46.84, "min": 69.94, "cnt": 32}, "fwd-layernorm":{"total": 9.59, "avg": 0.07, "max": 0.05, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 108.40, "avg": 0.85, "max": 0.74, "min": 2.33, "cnt": 128}, "fwd-misc":{"total": 20.68, "avg": 0.16, "max": 0.11, "min": 0.38, "cnt": 128}, "fwd-MLP":{"total": 1570.99, "avg": 12.27, "max": 9.84, "min": 21.28, "cnt": 128}, "MoE_L0_fwd":{"total": 449.00, "avg": 14.03, "max": 10.47, "min": 21.20, "cnt": 32}, "MoEMLP":{"total": 1554.03, "avg": 12.14, "max": 9.73, "min": 21.16, "cnt": 128}, "MoE_L1_fwd":{"total": 386.74, "avg": 12.09, "max": 10.81, "min": 16.75, "cnt": 32}, "MoE_L2_fwd":{"total": 374.81, "avg": 11.71, "max": 10.81, "min": 17.61, "cnt": 32}, "MoE_L3_fwd":{"total": 349.57, "avg": 10.92, "max": 9.77, "min": 19.43, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.61, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 13.52, "avg": 6.76, "max": 0.90, "min": 12.62, "cnt": 2}, "forward-send-backward-recv":{"total": 203.43, "avg": 6.78, "max": 1.24, "min": 107.59, "cnt": 30}, "backward-compute":{"total": 1482.77, "avg": 46.34, "max": 45.12, "min": 49.19, "cnt": 32}, "MoE_L3_bwd":{"total": 344.28, "avg": 10.76, "max": 9.59, "min": 13.49, "cnt": 32}, "MoE_L2_bwd":{"total": 333.64, "avg": 10.43, "max": 9.74, "min": 11.31, "cnt": 32}, "MoE_L1_bwd":{"total": 306.60, "avg": 9.58, "max": 9.14, "min": 11.08, "cnt": 32}, "MoE_L0_bwd":{"total": 279.55, "avg": 8.74, "max": 8.32, "min": 9.04, "cnt": 32}, "backward-send-forward-recv":{"total": 1644.03, "avg": 56.69, "max": 2.21, "min": 398.12, "cnt": 29}, "backward-send":{"total": 2.46, "avg": 0.82, "max": 0.57, "min": 1.15, "cnt": 3}, "backward-recv":{"total": 124.22, "avg": 62.11, "max": 52.79, "min": 71.43, "cnt": 2}, "backward-params-all-reduce":{"total": 485.06, "avg": 485.06, "max": 485.06, "min": 485.06, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "optimizer":{"total": 249.33, "avg": 249.33, "max": 249.33, "min": 249.33, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.40, "avg": 3.40, "max": 3.40, "min": 3.40, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 209.24, "avg": 209.24, "max": 209.24, "min": 209.24, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.35, "avg": 3.35, "max": 3.35, "min": 3.35, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.48, "avg": 3.48, "max": 3.48, "min": 3.48, "cnt": 1}}}
{"type":"time", "iteration": 144, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.12, "avg": 0.12, "max": 0.12, "min": 0.12, "cnt": 1}, "forward-recv":{"total": 56.41, "avg": 18.80, "max": 0.76, "min": 54.66, "cnt": 3}, "forward-compute":{"total": 1799.74, "avg": 56.24, "max": 49.90, "min": 63.57, "cnt": 32}, "fwd-compute":{"total": 1796.46, "avg": 56.14, "max": 49.83, "min": 63.49, "cnt": 32}, "batch-generator":{"total": 47.58, "avg": 1.49, "max": 0.68, "min": 3.26, "cnt": 32}, "fwd-embedding":{"total": 0.66, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1736.04, "avg": 54.25, "max": 48.81, "min": 61.92, "cnt": 32}, "fwd-layernorm":{"total": 10.34, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 111.92, "avg": 0.87, "max": 0.74, "min": 1.46, "cnt": 128}, "fwd-misc":{"total": 21.68, "avg": 0.17, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1570.22, "avg": 12.27, "max": 9.80, "min": 18.16, "cnt": 128}, "MoE_L0_fwd":{"total": 454.55, "avg": 14.20, "max": 11.07, "min": 18.06, "cnt": 32}, "MoEMLP":{"total": 1552.58, "avg": 12.13, "max": 9.70, "min": 18.00, "cnt": 128}, "MoE_L1_fwd":{"total": 384.84, "avg": 12.03, "max": 10.96, "min": 13.24, "cnt": 32}, "MoE_L2_fwd":{"total": 372.76, "avg": 11.65, "max": 10.98, "min": 13.16, "cnt": 32}, "MoE_L3_fwd":{"total": 346.84, "avg": 10.84, "max": 9.74, "min": 15.08, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 5.85, "avg": 2.92, "max": 0.72, "min": 5.12, "cnt": 2}, "forward-send-backward-recv":{"total": 291.29, "avg": 9.71, "max": 1.34, "min": 106.41, "cnt": 30}, "backward-compute":{"total": 1492.41, "avg": 46.64, "max": 44.39, "min": 52.57, "cnt": 32}, "MoE_L3_bwd":{"total": 354.10, "avg": 11.07, "max": 10.00, "min": 18.29, "cnt": 32}, "MoE_L2_bwd":{"total": 336.26, "avg": 10.51, "max": 9.38, "min": 11.84, "cnt": 32}, "MoE_L1_bwd":{"total": 307.62, "avg": 9.61, "max": 9.04, "min": 11.67, "cnt": 32}, "MoE_L0_bwd":{"total": 275.95, "avg": 8.62, "max": 8.19, "min": 9.15, "cnt": 32}, "backward-send-forward-recv":{"total": 1410.94, "avg": 48.65, "max": 1.96, "min": 209.45, "cnt": 29}, "backward-send":{"total": 3.06, "avg": 1.02, "max": 0.77, "min": 1.17, "cnt": 3}, "backward-recv":{"total": 212.69, "avg": 106.34, "max": 67.69, "min": 144.99, "cnt": 2}, "backward-params-all-reduce":{"total": 485.38, "avg": 485.38, "max": 485.38, "min": 485.38, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "optimizer":{"total": 246.76, "avg": 246.76, "max": 246.76, "min": 246.76, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.40, "avg": 3.40, "max": 3.40, "min": 3.40, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 206.84, "avg": 206.84, "max": 206.84, "min": 206.84, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.20, "avg": 3.20, "max": 3.20, "min": 3.20, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.48, "avg": 3.48, "max": 3.48, "min": 3.48, "cnt": 1}}}
{"type":"time", "iteration": 145, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 53.41, "avg": 17.80, "max": 0.96, "min": 51.41, "cnt": 3}, "forward-compute":{"total": 1807.67, "avg": 56.49, "max": 49.82, "min": 62.98, "cnt": 32}, "fwd-compute":{"total": 1804.34, "avg": 56.39, "max": 49.74, "min": 62.90, "cnt": 32}, "batch-generator":{"total": 44.94, "avg": 1.40, "max": 0.70, "min": 3.31, "cnt": 32}, "fwd-embedding":{"total": 0.72, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1746.57, "avg": 54.58, "max": 48.65, "min": 61.83, "cnt": 32}, "fwd-layernorm":{"total": 10.44, "avg": 0.08, "max": 0.05, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 111.22, "avg": 0.87, "max": 0.74, "min": 1.51, "cnt": 128}, "fwd-misc":{"total": 20.96, "avg": 0.16, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1582.74, "avg": 12.37, "max": 9.83, "min": 18.41, "cnt": 128}, "MoE_L0_fwd":{"total": 464.66, "avg": 14.52, "max": 10.62, "min": 18.32, "cnt": 32}, "MoEMLP":{"total": 1565.30, "avg": 12.23, "max": 9.73, "min": 18.27, "cnt": 128}, "MoE_L1_fwd":{"total": 395.68, "avg": 12.36, "max": 10.83, "min": 15.44, "cnt": 32}, "MoE_L2_fwd":{"total": 370.98, "avg": 11.59, "max": 10.72, "min": 14.18, "cnt": 32}, "MoE_L3_fwd":{"total": 340.30, "avg": 10.63, "max": 9.77, "min": 14.59, "cnt": 32}, "fwd-pooler":{"total": 0.31, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.79, "avg": 0.89, "max": 0.79, "min": 0.99, "cnt": 2}, "forward-send-backward-recv":{"total": 1016.55, "avg": 33.88, "max": 1.23, "min": 243.49, "cnt": 30}, "backward-compute":{"total": 1478.46, "avg": 46.20, "max": 44.13, "min": 48.53, "cnt": 32}, "MoE_L3_bwd":{"total": 349.33, "avg": 10.92, "max": 9.92, "min": 13.59, "cnt": 32}, "MoE_L2_bwd":{"total": 334.88, "avg": 10.46, "max": 9.22, "min": 11.85, "cnt": 32}, "MoE_L1_bwd":{"total": 303.67, "avg": 9.49, "max": 9.00, "min": 9.83, "cnt": 32}, "MoE_L0_bwd":{"total": 275.81, "avg": 8.62, "max": 8.24, "min": 9.99, "cnt": 32}, "backward-send-forward-recv":{"total": 727.23, "avg": 25.08, "max": 1.51, "min": 141.61, "cnt": 29}, "backward-send":{"total": 2.79, "avg": 0.93, "max": 0.79, "min": 1.02, "cnt": 3}, "backward-recv":{"total": 144.62, "avg": 72.31, "max": 72.05, "min": 72.57, "cnt": 2}, "backward-params-all-reduce":{"total": 485.99, "avg": 485.99, "max": 485.99, "min": 485.99, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 253.94, "avg": 253.94, "max": 253.94, "min": 253.94, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.40, "avg": 3.40, "max": 3.40, "min": 3.40, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 210.32, "avg": 210.32, "max": 210.32, "min": 210.32, "cnt": 1}, "optimizer-clip-main-grad":{"total": 7.05, "avg": 7.05, "max": 7.05, "min": 7.05, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 146, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.06, "avg": 0.06, "max": 0.06, "min": 0.06, "cnt": 1}, "forward-recv":{"total": 55.87, "avg": 18.62, "max": 0.73, "min": 54.20, "cnt": 3}, "forward-compute":{"total": 1806.88, "avg": 56.46, "max": 49.21, "min": 60.77, "cnt": 32}, "fwd-compute":{"total": 1803.34, "avg": 56.35, "max": 49.14, "min": 60.63, "cnt": 32}, "batch-generator":{"total": 43.91, "avg": 1.37, "max": 0.65, "min": 2.28, "cnt": 32}, "fwd-embedding":{"total": 0.77, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1746.46, "avg": 54.58, "max": 48.12, "min": 58.41, "cnt": 32}, "fwd-layernorm":{"total": 10.97, "avg": 0.09, "max": 0.05, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 116.42, "avg": 0.91, "max": 0.74, "min": 1.52, "cnt": 128}, "fwd-misc":{"total": 23.06, "avg": 0.18, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1573.18, "avg": 12.29, "max": 9.39, "min": 18.87, "cnt": 128}, "MoE_L0_fwd":{"total": 470.95, "avg": 14.72, "max": 10.80, "min": 18.78, "cnt": 32}, "MoEMLP":{"total": 1554.64, "avg": 12.15, "max": 9.27, "min": 18.73, "cnt": 128}, "MoE_L1_fwd":{"total": 395.56, "avg": 12.36, "max": 11.02, "min": 14.03, "cnt": 32}, "MoE_L2_fwd":{"total": 365.84, "avg": 11.43, "max": 10.81, "min": 12.72, "cnt": 32}, "MoE_L3_fwd":{"total": 328.94, "avg": 10.28, "max": 9.32, "min": 11.09, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 3.63, "avg": 1.82, "max": 0.79, "min": 2.84, "cnt": 2}, "forward-send-backward-recv":{"total": 1957.04, "avg": 65.23, "max": 2.00, "min": 243.56, "cnt": 30}, "backward-compute":{"total": 1487.51, "avg": 46.48, "max": 43.14, "min": 49.59, "cnt": 32}, "MoE_L3_bwd":{"total": 336.29, "avg": 10.51, "max": 9.68, "min": 11.62, "cnt": 32}, "MoE_L2_bwd":{"total": 344.28, "avg": 10.76, "max": 9.37, "min": 13.40, "cnt": 32}, "MoE_L1_bwd":{"total": 308.11, "avg": 9.63, "max": 8.94, "min": 10.09, "cnt": 32}, "MoE_L0_bwd":{"total": 279.92, "avg": 8.75, "max": 8.12, "min": 10.33, "cnt": 32}, "backward-send-forward-recv":{"total": 717.31, "avg": 24.73, "max": 1.65, "min": 236.53, "cnt": 29}, "backward-send":{"total": 2.59, "avg": 0.86, "max": 0.71, "min": 0.97, "cnt": 3}, "backward-recv":{"total": 149.74, "avg": 74.87, "max": 72.07, "min": 77.67, "cnt": 2}, "backward-params-all-reduce":{"total": 487.93, "avg": 487.93, "max": 487.93, "min": 487.93, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 242.71, "avg": 242.71, "max": 242.71, "min": 242.71, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 202.01, "avg": 202.01, "max": 202.01, "min": 202.01, "cnt": 1}, "optimizer-clip-main-grad":{"total": 4.15, "avg": 4.15, "max": 4.15, "min": 4.15, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 147, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 68.73, "avg": 22.91, "max": 3.47, "min": 54.95, "cnt": 3}, "forward-compute":{"total": 1838.62, "avg": 57.46, "max": 49.83, "min": 65.91, "cnt": 32}, "fwd-compute":{"total": 1835.30, "avg": 57.35, "max": 49.75, "min": 65.78, "cnt": 32}, "batch-generator":{"total": 41.38, "avg": 1.29, "max": 0.66, "min": 2.55, "cnt": 32}, "fwd-embedding":{"total": 0.69, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1781.69, "avg": 55.68, "max": 48.65, "min": 64.06, "cnt": 32}, "fwd-layernorm":{"total": 10.07, "avg": 0.08, "max": 0.05, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 109.76, "avg": 0.86, "max": 0.74, "min": 1.50, "cnt": 128}, "fwd-misc":{"total": 20.89, "avg": 0.16, "max": 0.11, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1620.13, "avg": 12.66, "max": 9.82, "min": 18.42, "cnt": 128}, "MoE_L0_fwd":{"total": 476.10, "avg": 14.88, "max": 10.88, "min": 18.34, "cnt": 32}, "MoEMLP":{"total": 1603.23, "avg": 12.53, "max": 9.71, "min": 18.29, "cnt": 128}, "MoE_L1_fwd":{"total": 397.00, "avg": 12.41, "max": 11.05, "min": 16.20, "cnt": 32}, "MoE_L2_fwd":{"total": 379.12, "avg": 11.85, "max": 11.01, "min": 15.64, "cnt": 32}, "MoE_L3_fwd":{"total": 357.18, "avg": 11.16, "max": 9.75, "min": 16.22, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.55, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.56, "avg": 0.78, "max": 0.69, "min": 0.86, "cnt": 2}, "forward-send-backward-recv":{"total": 537.07, "avg": 17.90, "max": 1.47, "min": 137.71, "cnt": 30}, "backward-compute":{"total": 1491.09, "avg": 46.60, "max": 44.76, "min": 49.65, "cnt": 32}, "MoE_L3_bwd":{"total": 342.50, "avg": 10.70, "max": 9.81, "min": 11.80, "cnt": 32}, "MoE_L2_bwd":{"total": 338.65, "avg": 10.58, "max": 9.57, "min": 11.68, "cnt": 32}, "MoE_L1_bwd":{"total": 309.98, "avg": 9.69, "max": 9.13, "min": 11.25, "cnt": 32}, "MoE_L0_bwd":{"total": 280.11, "avg": 8.75, "max": 8.03, "min": 11.32, "cnt": 32}, "backward-send-forward-recv":{"total": 1033.09, "avg": 35.62, "max": 1.72, "min": 222.06, "cnt": 29}, "backward-send":{"total": 2.15, "avg": 0.72, "max": 0.60, "min": 0.83, "cnt": 3}, "backward-recv":{"total": 215.57, "avg": 107.79, "max": 83.61, "min": 131.97, "cnt": 2}, "backward-params-all-reduce":{"total": 485.21, "avg": 485.21, "max": 485.21, "min": 485.21, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 243.14, "avg": 243.14, "max": 243.14, "min": 243.14, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.40, "avg": 3.40, "max": 3.40, "min": 3.40, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 203.07, "avg": 203.07, "max": 203.07, "min": 203.07, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.29, "avg": 3.29, "max": 3.29, "min": 3.29, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.55, "avg": 3.55, "max": 3.55, "min": 3.55, "cnt": 1}}}
{"type":"time", "iteration": 148, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.06, "avg": 0.06, "max": 0.06, "min": 0.06, "cnt": 1}, "forward-recv":{"total": 53.70, "avg": 17.90, "max": 0.94, "min": 51.49, "cnt": 3}, "forward-compute":{"total": 1820.33, "avg": 56.89, "max": 49.45, "min": 65.97, "cnt": 32}, "fwd-compute":{"total": 1817.01, "avg": 56.78, "max": 49.39, "min": 65.84, "cnt": 32}, "batch-generator":{"total": 43.16, "avg": 1.35, "max": 0.66, "min": 2.69, "cnt": 32}, "fwd-embedding":{"total": 0.71, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1760.51, "avg": 55.02, "max": 48.38, "min": 63.85, "cnt": 32}, "fwd-layernorm":{"total": 10.38, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 112.24, "avg": 0.88, "max": 0.74, "min": 2.08, "cnt": 128}, "fwd-misc":{"total": 21.99, "avg": 0.17, "max": 0.11, "min": 0.38, "cnt": 128}, "fwd-MLP":{"total": 1594.22, "avg": 12.45, "max": 9.72, "min": 20.35, "cnt": 128}, "MoE_L0_fwd":{"total": 474.00, "avg": 14.81, "max": 10.92, "min": 20.25, "cnt": 32}, "MoEMLP":{"total": 1576.73, "avg": 12.32, "max": 9.61, "min": 20.20, "cnt": 128}, "MoE_L1_fwd":{"total": 399.42, "avg": 12.48, "max": 11.08, "min": 15.31, "cnt": 32}, "MoE_L2_fwd":{"total": 376.97, "avg": 11.78, "max": 10.80, "min": 16.91, "cnt": 32}, "MoE_L3_fwd":{"total": 332.73, "avg": 10.40, "max": 9.65, "min": 12.29, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.61, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 12.34, "avg": 6.17, "max": 0.79, "min": 11.55, "cnt": 2}, "forward-send-backward-recv":{"total": 315.83, "avg": 10.53, "max": 1.30, "min": 120.74, "cnt": 30}, "backward-compute":{"total": 1488.81, "avg": 46.53, "max": 41.88, "min": 50.03, "cnt": 32}, "MoE_L3_bwd":{"total": 342.45, "avg": 10.70, "max": 8.01, "min": 12.85, "cnt": 32}, "MoE_L2_bwd":{"total": 341.13, "avg": 10.66, "max": 9.08, "min": 14.39, "cnt": 32}, "MoE_L1_bwd":{"total": 309.79, "avg": 9.68, "max": 9.18, "min": 10.08, "cnt": 32}, "MoE_L0_bwd":{"total": 277.73, "avg": 8.68, "max": 8.22, "min": 9.18, "cnt": 32}, "backward-send-forward-recv":{"total": 2302.78, "avg": 79.41, "max": 1.81, "min": 653.01, "cnt": 29}, "backward-send":{"total": 2.48, "avg": 0.83, "max": 0.62, "min": 1.09, "cnt": 3}, "backward-recv":{"total": 144.98, "avg": 72.49, "max": 72.22, "min": 72.75, "cnt": 2}, "backward-params-all-reduce":{"total": 485.03, "avg": 485.03, "max": 485.03, "min": 485.03, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 244.82, "avg": 244.82, "max": 244.82, "min": 244.82, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 204.17, "avg": 204.17, "max": 204.17, "min": 204.17, "cnt": 1}, "optimizer-clip-main-grad":{"total": 4.11, "avg": 4.11, "max": 4.11, "min": 4.11, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 149, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 414.81, "avg": 138.27, "max": 1.30, "min": 409.40, "cnt": 3}, "forward-compute":{"total": 1809.28, "avg": 56.54, "max": 50.02, "min": 63.77, "cnt": 32}, "fwd-compute":{"total": 1806.05, "avg": 56.44, "max": 49.95, "min": 63.55, "cnt": 32}, "batch-generator":{"total": 42.27, "avg": 1.32, "max": 0.67, "min": 2.82, "cnt": 32}, "fwd-embedding":{"total": 0.61, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1751.58, "avg": 54.74, "max": 48.91, "min": 61.52, "cnt": 32}, "fwd-layernorm":{"total": 9.80, "avg": 0.08, "max": 0.05, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 108.77, "avg": 0.85, "max": 0.74, "min": 1.90, "cnt": 128}, "fwd-misc":{"total": 21.47, "avg": 0.17, "max": 0.11, "min": 0.38, "cnt": 128}, "fwd-MLP":{"total": 1590.72, "avg": 12.43, "max": 9.75, "min": 19.62, "cnt": 128}, "MoE_L0_fwd":{"total": 475.84, "avg": 14.87, "max": 10.90, "min": 19.46, "cnt": 32}, "MoEMLP":{"total": 1573.81, "avg": 12.30, "max": 9.65, "min": 19.41, "cnt": 128}, "MoE_L1_fwd":{"total": 394.12, "avg": 12.32, "max": 11.00, "min": 13.81, "cnt": 32}, "MoE_L2_fwd":{"total": 367.92, "avg": 11.50, "max": 10.85, "min": 12.45, "cnt": 32}, "MoE_L3_fwd":{"total": 342.04, "avg": 10.69, "max": 9.69, "min": 18.47, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 5.67, "avg": 2.83, "max": 1.08, "min": 4.59, "cnt": 2}, "forward-send-backward-recv":{"total": 220.92, "avg": 7.36, "max": 1.47, "min": 101.85, "cnt": 30}, "backward-compute":{"total": 1497.10, "avg": 46.78, "max": 45.65, "min": 49.34, "cnt": 32}, "MoE_L3_bwd":{"total": 340.79, "avg": 10.65, "max": 10.01, "min": 11.54, "cnt": 32}, "MoE_L2_bwd":{"total": 338.79, "avg": 10.59, "max": 9.81, "min": 11.58, "cnt": 32}, "MoE_L1_bwd":{"total": 315.13, "avg": 9.85, "max": 9.36, "min": 10.77, "cnt": 32}, "MoE_L0_bwd":{"total": 280.83, "avg": 8.78, "max": 8.28, "min": 10.32, "cnt": 32}, "backward-send-forward-recv":{"total": 2532.28, "avg": 87.32, "max": 1.55, "min": 572.23, "cnt": 29}, "backward-send":{"total": 2.92, "avg": 0.97, "max": 0.96, "min": 1.00, "cnt": 3}, "backward-recv":{"total": 139.14, "avg": 69.57, "max": 66.99, "min": 72.15, "cnt": 2}, "backward-params-all-reduce":{"total": 483.49, "avg": 483.49, "max": 483.49, "min": 483.49, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 244.87, "avg": 244.87, "max": 244.87, "min": 244.87, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 204.97, "avg": 204.97, "max": 204.97, "min": 204.97, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.27, "avg": 3.27, "max": 3.27, "min": 3.27, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.50, "avg": 3.50, "max": 3.50, "min": 3.50, "cnt": 1}}}
{"type":"time", "iteration": 150, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 63.67, "avg": 21.22, "max": 0.96, "min": 61.56, "cnt": 3}, "forward-compute":{"total": 1829.04, "avg": 57.16, "max": 51.92, "min": 68.63, "cnt": 32}, "fwd-compute":{"total": 1825.97, "avg": 57.06, "max": 51.83, "min": 68.54, "cnt": 32}, "batch-generator":{"total": 39.92, "avg": 1.25, "max": 0.65, "min": 2.61, "cnt": 32}, "fwd-embedding":{"total": 0.60, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1773.88, "avg": 55.43, "max": 50.64, "min": 66.93, "cnt": 32}, "fwd-layernorm":{"total": 9.57, "avg": 0.07, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 107.07, "avg": 0.84, "max": 0.74, "min": 1.45, "cnt": 128}, "fwd-misc":{"total": 20.72, "avg": 0.16, "max": 0.11, "min": 0.34, "cnt": 128}, "fwd-MLP":{"total": 1616.07, "avg": 12.63, "max": 9.75, "min": 19.64, "cnt": 128}, "MoE_L0_fwd":{"total": 484.84, "avg": 15.15, "max": 11.86, "min": 19.56, "cnt": 32}, "MoEMLP":{"total": 1599.28, "avg": 12.49, "max": 9.63, "min": 19.51, "cnt": 128}, "MoE_L1_fwd":{"total": 400.76, "avg": 12.52, "max": 11.41, "min": 13.28, "cnt": 32}, "MoE_L2_fwd":{"total": 378.31, "avg": 11.82, "max": 10.93, "min": 17.89, "cnt": 32}, "MoE_L3_fwd":{"total": 341.48, "avg": 10.67, "max": 9.68, "min": 12.95, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.04, "cnt": 32}, "forward-send":{"total": 6.57, "avg": 3.28, "max": 0.90, "min": 5.66, "cnt": 2}, "forward-send-backward-recv":{"total": 257.15, "avg": 8.57, "max": 1.44, "min": 107.84, "cnt": 30}, "backward-compute":{"total": 1496.96, "avg": 46.78, "max": 44.46, "min": 48.52, "cnt": 32}, "MoE_L3_bwd":{"total": 340.40, "avg": 10.64, "max": 9.23, "min": 11.56, "cnt": 32}, "MoE_L2_bwd":{"total": 340.40, "avg": 10.64, "max": 9.82, "min": 11.43, "cnt": 32}, "MoE_L1_bwd":{"total": 321.26, "avg": 10.04, "max": 9.42, "min": 10.55, "cnt": 32}, "MoE_L0_bwd":{"total": 278.49, "avg": 8.70, "max": 8.32, "min": 9.23, "cnt": 32}, "backward-send-forward-recv":{"total": 1840.88, "avg": 63.48, "max": 1.54, "min": 499.13, "cnt": 29}, "backward-send":{"total": 3.25, "avg": 1.08, "max": 1.04, "min": 1.13, "cnt": 3}, "backward-recv":{"total": 134.80, "avg": 67.40, "max": 60.00, "min": 74.80, "cnt": 2}, "backward-params-all-reduce":{"total": 488.31, "avg": 488.31, "max": 488.31, "min": 488.31, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 245.75, "avg": 245.75, "max": 245.75, "min": 245.75, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 206.00, "avg": 206.00, "max": 206.00, "min": 206.00, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.26, "avg": 3.26, "max": 3.26, "min": 3.26, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.50, "avg": 3.50, "max": 3.50, "min": 3.50, "cnt": 1}}}
{"type":"time", "iteration": 151, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 56.97, "avg": 18.99, "max": 0.89, "min": 52.24, "cnt": 3}, "forward-compute":{"total": 1830.24, "avg": 57.20, "max": 49.73, "min": 61.24, "cnt": 32}, "fwd-compute":{"total": 1826.91, "avg": 57.09, "max": 49.66, "min": 61.16, "cnt": 32}, "batch-generator":{"total": 44.57, "avg": 1.39, "max": 0.63, "min": 2.65, "cnt": 32}, "fwd-embedding":{"total": 0.73, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1769.78, "avg": 55.31, "max": 48.24, "min": 58.90, "cnt": 32}, "fwd-layernorm":{"total": 10.36, "avg": 0.08, "max": 0.05, "min": 0.18, "cnt": 128}, "fwd-attn":{"total": 114.05, "avg": 0.89, "max": 0.74, "min": 1.51, "cnt": 128}, "fwd-misc":{"total": 21.83, "avg": 0.17, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1601.38, "avg": 12.51, "max": 9.78, "min": 18.74, "cnt": 128}, "MoE_L0_fwd":{"total": 480.88, "avg": 15.03, "max": 10.67, "min": 18.64, "cnt": 32}, "MoEMLP":{"total": 1583.19, "avg": 12.37, "max": 9.67, "min": 18.59, "cnt": 128}, "MoE_L1_fwd":{"total": 398.84, "avg": 12.46, "max": 11.08, "min": 14.22, "cnt": 32}, "MoE_L2_fwd":{"total": 369.95, "avg": 11.56, "max": 10.99, "min": 12.45, "cnt": 32}, "MoE_L3_fwd":{"total": 340.02, "avg": 10.63, "max": 9.71, "min": 11.63, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.44, "avg": 0.72, "max": 0.69, "min": 0.75, "cnt": 2}, "forward-send-backward-recv":{"total": 415.09, "avg": 13.84, "max": 1.28, "min": 155.50, "cnt": 30}, "backward-compute":{"total": 1516.59, "avg": 47.39, "max": 45.61, "min": 49.10, "cnt": 32}, "MoE_L3_bwd":{"total": 341.58, "avg": 10.67, "max": 9.76, "min": 12.15, "cnt": 32}, "MoE_L2_bwd":{"total": 344.45, "avg": 10.76, "max": 10.16, "min": 11.29, "cnt": 32}, "MoE_L1_bwd":{"total": 326.86, "avg": 10.21, "max": 9.67, "min": 10.96, "cnt": 32}, "MoE_L0_bwd":{"total": 286.76, "avg": 8.96, "max": 8.14, "min": 11.13, "cnt": 32}, "backward-send-forward-recv":{"total": 1559.37, "avg": 53.77, "max": 2.04, "min": 274.01, "cnt": 29}, "backward-send":{"total": 2.97, "avg": 0.99, "max": 0.85, "min": 1.15, "cnt": 3}, "backward-recv":{"total": 143.70, "avg": 71.85, "max": 71.63, "min": 72.07, "cnt": 2}, "backward-params-all-reduce":{"total": 490.42, "avg": 490.42, "max": 490.42, "min": 490.42, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 252.45, "avg": 252.45, "max": 252.45, "min": 252.45, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 205.84, "avg": 205.84, "max": 205.84, "min": 205.84, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.28, "avg": 3.28, "max": 3.28, "min": 3.28, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.47, "avg": 3.47, "max": 3.47, "min": 3.47, "cnt": 1}}}
{"type":"time", "iteration": 152, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 53.18, "avg": 17.73, "max": 0.83, "min": 51.18, "cnt": 3}, "forward-compute":{"total": 1788.91, "avg": 55.90, "max": 50.27, "min": 64.52, "cnt": 32}, "fwd-compute":{"total": 1785.83, "avg": 55.81, "max": 50.19, "min": 64.38, "cnt": 32}, "batch-generator":{"total": 41.26, "avg": 1.29, "max": 0.72, "min": 3.04, "cnt": 32}, "fwd-embedding":{"total": 0.59, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1732.25, "avg": 54.13, "max": 48.83, "min": 62.29, "cnt": 32}, "fwd-layernorm":{"total": 9.55, "avg": 0.07, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 109.39, "avg": 0.85, "max": 0.74, "min": 1.93, "cnt": 128}, "fwd-misc":{"total": 20.52, "avg": 0.16, "max": 0.11, "min": 0.41, "cnt": 128}, "fwd-MLP":{"total": 1572.03, "avg": 12.28, "max": 10.06, "min": 18.05, "cnt": 128}, "MoE_L0_fwd":{"total": 453.20, "avg": 14.16, "max": 10.62, "min": 17.98, "cnt": 32}, "MoEMLP":{"total": 1554.97, "avg": 12.15, "max": 9.97, "min": 17.94, "cnt": 128}, "MoE_L1_fwd":{"total": 391.34, "avg": 12.23, "max": 10.96, "min": 14.73, "cnt": 32}, "MoE_L2_fwd":{"total": 365.85, "avg": 11.43, "max": 10.80, "min": 12.66, "cnt": 32}, "MoE_L3_fwd":{"total": 350.72, "avg": 10.96, "max": 10.00, "min": 15.39, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.61, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 3.33, "avg": 1.67, "max": 1.02, "min": 2.31, "cnt": 2}, "forward-send-backward-recv":{"total": 354.73, "avg": 11.82, "max": 1.31, "min": 113.52, "cnt": 30}, "backward-compute":{"total": 1495.78, "avg": 46.74, "max": 44.59, "min": 47.82, "cnt": 32}, "MoE_L3_bwd":{"total": 350.44, "avg": 10.95, "max": 10.11, "min": 11.84, "cnt": 32}, "MoE_L2_bwd":{"total": 331.70, "avg": 10.37, "max": 9.51, "min": 10.98, "cnt": 32}, "MoE_L1_bwd":{"total": 320.76, "avg": 10.02, "max": 9.42, "min": 10.57, "cnt": 32}, "MoE_L0_bwd":{"total": 272.93, "avg": 8.53, "max": 8.06, "min": 8.87, "cnt": 32}, "backward-send-forward-recv":{"total": 2447.56, "avg": 84.40, "max": 1.68, "min": 358.31, "cnt": 29}, "backward-send":{"total": 2.66, "avg": 0.89, "max": 0.79, "min": 0.94, "cnt": 3}, "backward-recv":{"total": 281.96, "avg": 140.98, "max": 66.66, "min": 215.30, "cnt": 2}, "backward-params-all-reduce":{"total": 485.61, "avg": 485.61, "max": 485.61, "min": 485.61, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 248.69, "avg": 248.69, "max": 248.69, "min": 248.69, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 208.82, "avg": 208.82, "max": 208.82, "min": 208.82, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.33, "avg": 3.33, "max": 3.33, "min": 3.33, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 153, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 68.84, "avg": 22.95, "max": 0.71, "min": 60.06, "cnt": 3}, "forward-compute":{"total": 1856.91, "avg": 58.03, "max": 49.80, "min": 86.24, "cnt": 32}, "fwd-compute":{"total": 1849.97, "avg": 57.81, "max": 49.72, "min": 86.11, "cnt": 32}, "batch-generator":{"total": 43.70, "avg": 1.37, "max": 0.71, "min": 2.79, "cnt": 32}, "fwd-embedding":{"total": 0.64, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1793.66, "avg": 56.05, "max": 48.53, "min": 84.07, "cnt": 32}, "fwd-layernorm":{"total": 9.78, "avg": 0.08, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 109.61, "avg": 0.86, "max": 0.74, "min": 1.45, "cnt": 128}, "fwd-misc":{"total": 20.57, "avg": 0.16, "max": 0.11, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1633.14, "avg": 12.76, "max": 9.84, "min": 45.24, "cnt": 128}, "MoE_L0_fwd":{"total": 503.27, "avg": 15.73, "max": 10.44, "min": 45.10, "cnt": 32}, "MoEMLP":{"total": 1616.43, "avg": 12.63, "max": 9.72, "min": 45.03, "cnt": 128}, "MoE_L1_fwd":{"total": 397.45, "avg": 12.42, "max": 10.79, "min": 15.46, "cnt": 32}, "MoE_L2_fwd":{"total": 368.99, "avg": 11.53, "max": 10.85, "min": 12.75, "cnt": 32}, "MoE_L3_fwd":{"total": 352.81, "avg": 11.03, "max": 9.77, "min": 17.82, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.46, "avg": 0.73, "max": 0.45, "min": 1.01, "cnt": 2}, "forward-send-backward-recv":{"total": 355.09, "avg": 11.84, "max": 1.73, "min": 89.53, "cnt": 30}, "backward-compute":{"total": 1493.45, "avg": 46.67, "max": 45.25, "min": 48.95, "cnt": 32}, "MoE_L3_bwd":{"total": 345.76, "avg": 10.80, "max": 10.06, "min": 12.11, "cnt": 32}, "MoE_L2_bwd":{"total": 336.66, "avg": 10.52, "max": 9.46, "min": 12.09, "cnt": 32}, "MoE_L1_bwd":{"total": 318.33, "avg": 9.95, "max": 9.34, "min": 10.33, "cnt": 32}, "MoE_L0_bwd":{"total": 275.94, "avg": 8.62, "max": 7.82, "min": 9.15, "cnt": 32}, "backward-send-forward-recv":{"total": 1287.78, "avg": 44.41, "max": 1.75, "min": 179.49, "cnt": 29}, "backward-send":{"total": 47.58, "avg": 15.86, "max": 1.11, "min": 45.35, "cnt": 3}, "backward-recv":{"total": 119.07, "avg": 59.54, "max": 54.32, "min": 64.76, "cnt": 2}, "backward-params-all-reduce":{"total": 484.34, "avg": 484.34, "max": 484.34, "min": 484.34, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 250.31, "avg": 250.31, "max": 250.31, "min": 250.31, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.41, "avg": 3.41, "max": 3.41, "min": 3.41, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 205.60, "avg": 205.60, "max": 205.60, "min": 205.60, "cnt": 1}, "optimizer-clip-main-grad":{"total": 7.37, "avg": 7.37, "max": 7.37, "min": 7.37, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.48, "avg": 3.48, "max": 3.48, "min": 3.48, "cnt": 1}}}
{"type":"time", "iteration": 154, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 58.36, "avg": 19.45, "max": 1.00, "min": 56.34, "cnt": 3}, "forward-compute":{"total": 1853.88, "avg": 57.93, "max": 51.77, "min": 64.93, "cnt": 32}, "fwd-compute":{"total": 1850.58, "avg": 57.83, "max": 51.69, "min": 64.80, "cnt": 32}, "batch-generator":{"total": 45.83, "avg": 1.43, "max": 0.65, "min": 3.16, "cnt": 32}, "fwd-embedding":{"total": 0.75, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1791.91, "avg": 56.00, "max": 50.50, "min": 62.80, "cnt": 32}, "fwd-layernorm":{"total": 10.55, "avg": 0.08, "max": 0.05, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 111.12, "avg": 0.87, "max": 0.74, "min": 1.52, "cnt": 128}, "fwd-misc":{"total": 22.38, "avg": 0.17, "max": 0.11, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1626.00, "avg": 12.70, "max": 10.23, "min": 20.10, "cnt": 128}, "MoE_L0_fwd":{"total": 488.36, "avg": 15.26, "max": 11.72, "min": 19.94, "cnt": 32}, "MoEMLP":{"total": 1608.10, "avg": 12.56, "max": 10.11, "min": 19.86, "cnt": 128}, "MoE_L1_fwd":{"total": 406.35, "avg": 12.70, "max": 11.02, "min": 15.93, "cnt": 32}, "MoE_L2_fwd":{"total": 368.84, "avg": 11.53, "max": 10.71, "min": 16.19, "cnt": 32}, "MoE_L3_fwd":{"total": 351.14, "avg": 10.97, "max": 10.16, "min": 12.99, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.52, "avg": 0.76, "max": 0.75, "min": 0.76, "cnt": 2}, "forward-send-backward-recv":{"total": 607.94, "avg": 20.26, "max": 1.70, "min": 172.80, "cnt": 30}, "backward-compute":{"total": 1500.00, "avg": 46.87, "max": 45.03, "min": 50.56, "cnt": 32}, "MoE_L3_bwd":{"total": 346.64, "avg": 10.83, "max": 9.86, "min": 11.90, "cnt": 32}, "MoE_L2_bwd":{"total": 336.70, "avg": 10.52, "max": 9.55, "min": 12.83, "cnt": 32}, "MoE_L1_bwd":{"total": 322.80, "avg": 10.09, "max": 9.46, "min": 14.82, "cnt": 32}, "MoE_L0_bwd":{"total": 277.31, "avg": 8.67, "max": 8.03, "min": 9.15, "cnt": 32}, "backward-send-forward-recv":{"total": 883.74, "avg": 30.47, "max": 1.77, "min": 167.22, "cnt": 29}, "backward-send":{"total": 3.04, "avg": 1.01, "max": 0.86, "min": 1.11, "cnt": 3}, "backward-recv":{"total": 201.16, "avg": 100.58, "max": 74.00, "min": 127.16, "cnt": 2}, "backward-params-all-reduce":{"total": 489.24, "avg": 489.24, "max": 489.24, "min": 489.24, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 244.47, "avg": 244.47, "max": 244.47, "min": 244.47, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 204.13, "avg": 204.13, "max": 204.13, "min": 204.13, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.72, "avg": 3.72, "max": 3.72, "min": 3.72, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.50, "avg": 3.50, "max": 3.50, "min": 3.50, "cnt": 1}}}
{"type":"time", "iteration": 155, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 55.04, "avg": 18.35, "max": 0.95, "min": 52.69, "cnt": 3}, "forward-compute":{"total": 1827.68, "avg": 57.11, "max": 48.15, "min": 64.83, "cnt": 32}, "fwd-compute":{"total": 1824.62, "avg": 57.02, "max": 48.08, "min": 64.75, "cnt": 32}, "batch-generator":{"total": 50.16, "avg": 1.57, "max": 0.67, "min": 3.11, "cnt": 32}, "fwd-embedding":{"total": 0.62, "avg": 0.02, "max": 0.01, "min": 0.06, "cnt": 32}, "fwd-encoder":{"total": 1762.56, "avg": 55.08, "max": 46.99, "min": 62.78, "cnt": 32}, "fwd-layernorm":{"total": 9.59, "avg": 0.07, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 109.11, "avg": 0.85, "max": 0.74, "min": 1.48, "cnt": 128}, "fwd-misc":{"total": 20.80, "avg": 0.16, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1602.34, "avg": 12.52, "max": 9.92, "min": 19.08, "cnt": 128}, "MoE_L0_fwd":{"total": 473.93, "avg": 14.81, "max": 10.51, "min": 18.96, "cnt": 32}, "MoEMLP":{"total": 1585.51, "avg": 12.39, "max": 9.82, "min": 18.91, "cnt": 128}, "MoE_L1_fwd":{"total": 402.07, "avg": 12.56, "max": 10.80, "min": 16.86, "cnt": 32}, "MoE_L2_fwd":{"total": 372.28, "avg": 11.63, "max": 10.37, "min": 17.00, "cnt": 32}, "MoE_L3_fwd":{"total": 343.24, "avg": 10.73, "max": 9.86, "min": 12.10, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.04, "cnt": 32}, "forward-send":{"total": 9.97, "avg": 4.99, "max": 0.96, "min": 9.01, "cnt": 2}, "forward-send-backward-recv":{"total": 647.01, "avg": 21.57, "max": 1.29, "min": 142.75, "cnt": 30}, "backward-compute":{"total": 1496.16, "avg": 46.76, "max": 45.29, "min": 48.94, "cnt": 32}, "MoE_L3_bwd":{"total": 349.61, "avg": 10.93, "max": 9.88, "min": 12.77, "cnt": 32}, "MoE_L2_bwd":{"total": 338.03, "avg": 10.56, "max": 9.98, "min": 11.84, "cnt": 32}, "MoE_L1_bwd":{"total": 315.91, "avg": 9.87, "max": 9.43, "min": 10.52, "cnt": 32}, "MoE_L0_bwd":{"total": 276.91, "avg": 8.65, "max": 8.35, "min": 9.03, "cnt": 32}, "backward-send-forward-recv":{"total": 4095.80, "avg": 141.23, "max": 1.85, "min": 1208.37, "cnt": 29}, "backward-send":{"total": 3.01, "avg": 1.00, "max": 0.96, "min": 1.05, "cnt": 3}, "backward-recv":{"total": 136.12, "avg": 68.06, "max": 63.62, "min": 72.50, "cnt": 2}, "backward-params-all-reduce":{"total": 488.59, "avg": 488.59, "max": 488.59, "min": 488.59, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 245.43, "avg": 245.43, "max": 245.43, "min": 245.43, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 205.66, "avg": 205.66, "max": 205.66, "min": 205.66, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}}}
{"type":"time", "iteration": 156, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.06, "avg": 0.06, "max": 0.06, "min": 0.06, "cnt": 1}, "forward-recv":{"total": 61.77, "avg": 20.59, "max": 0.94, "min": 58.66, "cnt": 3}, "forward-compute":{"total": 1858.32, "avg": 58.07, "max": 49.79, "min": 65.52, "cnt": 32}, "fwd-compute":{"total": 1855.13, "avg": 57.97, "max": 49.72, "min": 65.44, "cnt": 32}, "batch-generator":{"total": 48.46, "avg": 1.51, "max": 0.66, "min": 3.60, "cnt": 32}, "fwd-embedding":{"total": 0.64, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1794.23, "avg": 56.07, "max": 48.75, "min": 64.21, "cnt": 32}, "fwd-layernorm":{"total": 9.98, "avg": 0.08, "max": 0.05, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 110.53, "avg": 0.86, "max": 0.74, "min": 1.74, "cnt": 128}, "fwd-misc":{"total": 21.18, "avg": 0.17, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1629.93, "avg": 12.73, "max": 9.89, "min": 20.43, "cnt": 128}, "MoE_L0_fwd":{"total": 482.38, "avg": 15.07, "max": 10.69, "min": 20.33, "cnt": 32}, "MoEMLP":{"total": 1612.76, "avg": 12.60, "max": 9.79, "min": 20.27, "cnt": 128}, "MoE_L1_fwd":{"total": 404.65, "avg": 12.65, "max": 11.16, "min": 16.22, "cnt": 32}, "MoE_L2_fwd":{"total": 380.96, "avg": 11.91, "max": 10.70, "min": 18.75, "cnt": 32}, "MoE_L3_fwd":{"total": 351.08, "avg": 10.97, "max": 9.82, "min": 15.72, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.04, "cnt": 32}, "forward-send":{"total": 11.71, "avg": 5.85, "max": 0.76, "min": 10.95, "cnt": 2}, "forward-send-backward-recv":{"total": 331.64, "avg": 11.05, "max": 1.47, "min": 109.43, "cnt": 30}, "backward-compute":{"total": 1504.66, "avg": 47.02, "max": 43.34, "min": 49.01, "cnt": 32}, "MoE_L3_bwd":{"total": 345.55, "avg": 10.80, "max": 9.32, "min": 12.06, "cnt": 32}, "MoE_L2_bwd":{"total": 346.44, "avg": 10.83, "max": 10.13, "min": 12.33, "cnt": 32}, "MoE_L1_bwd":{"total": 318.92, "avg": 9.97, "max": 9.43, "min": 10.61, "cnt": 32}, "MoE_L0_bwd":{"total": 278.64, "avg": 8.71, "max": 7.87, "min": 9.32, "cnt": 32}, "backward-send-forward-recv":{"total": 1128.27, "avg": 38.91, "max": 1.61, "min": 198.36, "cnt": 29}, "backward-send":{"total": 2.42, "avg": 0.81, "max": 0.63, "min": 0.92, "cnt": 3}, "backward-recv":{"total": 161.66, "avg": 80.83, "max": 74.60, "min": 87.06, "cnt": 2}, "backward-params-all-reduce":{"total": 487.70, "avg": 487.70, "max": 487.70, "min": 487.70, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 244.50, "avg": 244.50, "max": 244.50, "min": 244.50, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 204.52, "avg": 204.52, "max": 204.52, "min": 204.52, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 157, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 63.54, "avg": 21.18, "max": 5.16, "min": 51.60, "cnt": 3}, "forward-compute":{"total": 1787.81, "avg": 55.87, "max": 48.08, "min": 63.52, "cnt": 32}, "fwd-compute":{"total": 1784.68, "avg": 55.77, "max": 48.01, "min": 63.44, "cnt": 32}, "batch-generator":{"total": 42.71, "avg": 1.33, "max": 0.68, "min": 2.57, "cnt": 32}, "fwd-embedding":{"total": 0.66, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1729.72, "avg": 54.05, "max": 47.06, "min": 61.36, "cnt": 32}, "fwd-layernorm":{"total": 10.00, "avg": 0.08, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 110.98, "avg": 0.87, "max": 0.74, "min": 1.47, "cnt": 128}, "fwd-misc":{"total": 21.39, "avg": 0.17, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1566.43, "avg": 12.24, "max": 9.75, "min": 23.85, "cnt": 128}, "MoE_L0_fwd":{"total": 465.11, "avg": 14.53, "max": 10.06, "min": 23.77, "cnt": 32}, "MoEMLP":{"total": 1549.32, "avg": 12.10, "max": 9.62, "min": 23.71, "cnt": 128}, "MoE_L1_fwd":{"total": 384.08, "avg": 12.00, "max": 11.06, "min": 12.85, "cnt": 32}, "MoE_L2_fwd":{"total": 369.67, "avg": 11.55, "max": 10.64, "min": 15.56, "cnt": 32}, "MoE_L3_fwd":{"total": 336.68, "avg": 10.52, "max": 9.67, "min": 12.08, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.90, "avg": 0.95, "max": 0.80, "min": 1.10, "cnt": 2}, "forward-send-backward-recv":{"total": 383.94, "avg": 12.80, "max": 1.48, "min": 133.39, "cnt": 30}, "backward-compute":{"total": 1505.49, "avg": 47.05, "max": 45.41, "min": 52.74, "cnt": 32}, "MoE_L3_bwd":{"total": 354.18, "avg": 11.07, "max": 10.40, "min": 15.45, "cnt": 32}, "MoE_L2_bwd":{"total": 346.48, "avg": 10.83, "max": 9.98, "min": 16.00, "cnt": 32}, "MoE_L1_bwd":{"total": 318.35, "avg": 9.95, "max": 9.26, "min": 10.63, "cnt": 32}, "MoE_L0_bwd":{"total": 273.74, "avg": 8.55, "max": 7.93, "min": 9.01, "cnt": 32}, "backward-send-forward-recv":{"total": 1551.75, "avg": 53.51, "max": 2.09, "min": 237.45, "cnt": 29}, "backward-send":{"total": 2.91, "avg": 0.97, "max": 0.93, "min": 1.04, "cnt": 3}, "backward-recv":{"total": 148.60, "avg": 74.30, "max": 72.67, "min": 75.93, "cnt": 2}, "backward-params-all-reduce":{"total": 488.68, "avg": 488.68, "max": 488.68, "min": 488.68, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 240.41, "avg": 240.41, "max": 240.41, "min": 240.41, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 200.54, "avg": 200.54, "max": 200.54, "min": 200.54, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.47, "avg": 3.47, "max": 3.47, "min": 3.47, "cnt": 1}}}
{"type":"time", "iteration": 158, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 54.75, "avg": 18.25, "max": 1.07, "min": 52.27, "cnt": 3}, "forward-compute":{"total": 1752.84, "avg": 54.78, "max": 48.94, "min": 64.91, "cnt": 32}, "fwd-compute":{"total": 1749.91, "avg": 54.68, "max": 48.85, "min": 64.78, "cnt": 32}, "batch-generator":{"total": 35.02, "avg": 1.09, "max": 0.67, "min": 1.88, "cnt": 32}, "fwd-embedding":{"total": 0.56, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1702.87, "avg": 53.21, "max": 47.54, "min": 62.78, "cnt": 32}, "fwd-layernorm":{"total": 9.35, "avg": 0.07, "max": 0.05, "min": 0.18, "cnt": 128}, "fwd-attn":{"total": 106.22, "avg": 0.83, "max": 0.74, "min": 1.48, "cnt": 128}, "fwd-misc":{"total": 19.98, "avg": 0.16, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1547.27, "avg": 12.09, "max": 10.14, "min": 17.62, "cnt": 128}, "MoE_L0_fwd":{"total": 428.71, "avg": 13.40, "max": 10.41, "min": 17.17, "cnt": 32}, "MoEMLP":{"total": 1530.79, "avg": 11.96, "max": 10.04, "min": 17.46, "cnt": 128}, "MoE_L1_fwd":{"total": 394.39, "avg": 12.32, "max": 10.89, "min": 17.52, "cnt": 32}, "MoE_L2_fwd":{"total": 364.11, "avg": 11.38, "max": 10.71, "min": 13.04, "cnt": 32}, "MoE_L3_fwd":{"total": 349.55, "avg": 10.92, "max": 10.07, "min": 14.19, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 3.89, "avg": 1.94, "max": 0.92, "min": 2.97, "cnt": 2}, "forward-send-backward-recv":{"total": 283.91, "avg": 9.46, "max": 1.17, "min": 110.97, "cnt": 30}, "backward-compute":{"total": 1577.95, "avg": 49.31, "max": 45.68, "min": 122.64, "cnt": 32}, "MoE_L3_bwd":{"total": 360.83, "avg": 11.28, "max": 10.30, "min": 13.16, "cnt": 32}, "MoE_L2_bwd":{"total": 332.02, "avg": 10.38, "max": 9.46, "min": 11.06, "cnt": 32}, "MoE_L1_bwd":{"total": 391.49, "avg": 12.23, "max": 9.56, "min": 85.58, "cnt": 32}, "MoE_L0_bwd":{"total": 278.69, "avg": 8.71, "max": 8.11, "min": 10.54, "cnt": 32}, "backward-send-forward-recv":{"total": 1178.54, "avg": 40.64, "max": 2.37, "min": 148.28, "cnt": 29}, "backward-send":{"total": 2.45, "avg": 0.82, "max": 0.52, "min": 1.08, "cnt": 3}, "backward-recv":{"total": 119.48, "avg": 59.74, "max": 51.59, "min": 67.89, "cnt": 2}, "backward-params-all-reduce":{"total": 488.09, "avg": 488.09, "max": 488.09, "min": 488.09, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 244.94, "avg": 244.94, "max": 244.94, "min": 244.94, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 204.26, "avg": 204.26, "max": 204.26, "min": 204.26, "cnt": 1}, "optimizer-clip-main-grad":{"total": 4.21, "avg": 4.21, "max": 4.21, "min": 4.21, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 159, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 58.30, "avg": 19.43, "max": 0.75, "min": 56.63, "cnt": 3}, "forward-compute":{"total": 1794.33, "avg": 56.07, "max": 49.05, "min": 63.67, "cnt": 32}, "fwd-compute":{"total": 1791.05, "avg": 55.97, "max": 48.99, "min": 63.58, "cnt": 32}, "batch-generator":{"total": 36.43, "avg": 1.14, "max": 0.64, "min": 1.97, "cnt": 32}, "fwd-embedding":{"total": 0.68, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1742.38, "avg": 54.45, "max": 48.04, "min": 62.27, "cnt": 32}, "fwd-layernorm":{"total": 10.02, "avg": 0.08, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 108.18, "avg": 0.85, "max": 0.74, "min": 1.47, "cnt": 128}, "fwd-misc":{"total": 21.18, "avg": 0.17, "max": 0.11, "min": 0.38, "cnt": 128}, "fwd-MLP":{"total": 1582.04, "avg": 12.36, "max": 10.08, "min": 19.45, "cnt": 128}, "MoE_L0_fwd":{"total": 453.66, "avg": 14.18, "max": 10.74, "min": 19.37, "cnt": 32}, "MoEMLP":{"total": 1565.18, "avg": 12.23, "max": 9.97, "min": 19.32, "cnt": 128}, "MoE_L1_fwd":{"total": 396.58, "avg": 12.39, "max": 11.01, "min": 14.90, "cnt": 32}, "MoE_L2_fwd":{"total": 368.22, "avg": 11.51, "max": 10.67, "min": 16.37, "cnt": 32}, "MoE_L3_fwd":{"total": 352.89, "avg": 11.03, "max": 10.01, "min": 17.25, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 3.75, "avg": 1.88, "max": 0.70, "min": 3.05, "cnt": 2}, "forward-send-backward-recv":{"total": 1346.89, "avg": 44.90, "max": 1.83, "min": 322.93, "cnt": 30}, "backward-compute":{"total": 1495.66, "avg": 46.74, "max": 45.56, "min": 48.53, "cnt": 32}, "MoE_L3_bwd":{"total": 346.83, "avg": 10.84, "max": 9.90, "min": 11.78, "cnt": 32}, "MoE_L2_bwd":{"total": 334.94, "avg": 10.47, "max": 9.68, "min": 11.04, "cnt": 32}, "MoE_L1_bwd":{"total": 317.83, "avg": 9.93, "max": 9.49, "min": 10.75, "cnt": 32}, "MoE_L0_bwd":{"total": 277.47, "avg": 8.67, "max": 7.98, "min": 9.08, "cnt": 32}, "backward-send-forward-recv":{"total": 481.19, "avg": 16.59, "max": 1.60, "min": 113.12, "cnt": 29}, "backward-send":{"total": 2.68, "avg": 0.89, "max": 0.89, "min": 0.90, "cnt": 3}, "backward-recv":{"total": 401.28, "avg": 200.64, "max": 177.43, "min": 223.85, "cnt": 2}, "backward-params-all-reduce":{"total": 487.15, "avg": 487.15, "max": 487.15, "min": 487.15, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 246.19, "avg": 246.19, "max": 246.19, "min": 246.19, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 206.35, "avg": 206.35, "max": 206.35, "min": 206.35, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.32, "avg": 3.32, "max": 3.32, "min": 3.32, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 160, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.06, "avg": 0.06, "max": 0.06, "min": 0.06, "cnt": 1}, "forward-recv":{"total": 167.61, "avg": 55.87, "max": 0.84, "min": 165.90, "cnt": 3}, "forward-compute":{"total": 1871.86, "avg": 58.50, "max": 50.41, "min": 78.61, "cnt": 32}, "fwd-compute":{"total": 1868.33, "avg": 58.39, "max": 50.34, "min": 78.48, "cnt": 32}, "batch-generator":{"total": 43.78, "avg": 1.37, "max": 0.65, "min": 2.40, "cnt": 32}, "fwd-embedding":{"total": 0.79, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1811.12, "avg": 56.60, "max": 48.61, "min": 76.30, "cnt": 32}, "fwd-layernorm":{"total": 10.63, "avg": 0.08, "max": 0.05, "min": 0.18, "cnt": 128}, "fwd-attn":{"total": 112.60, "avg": 0.88, "max": 0.75, "min": 1.57, "cnt": 128}, "fwd-misc":{"total": 22.17, "avg": 0.17, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1643.86, "avg": 12.84, "max": 10.05, "min": 29.76, "cnt": 128}, "MoE_L0_fwd":{"total": 478.24, "avg": 14.95, "max": 10.78, "min": 17.93, "cnt": 32}, "MoEMLP":{"total": 1625.94, "avg": 12.70, "max": 9.93, "min": 29.64, "cnt": 128}, "MoE_L1_fwd":{"total": 406.13, "avg": 12.69, "max": 10.62, "min": 15.43, "cnt": 32}, "MoE_L2_fwd":{"total": 376.30, "avg": 11.76, "max": 10.72, "min": 17.95, "cnt": 32}, "MoE_L3_fwd":{"total": 371.75, "avg": 11.62, "max": 9.97, "min": 29.68, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.62, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 16.70, "avg": 8.35, "max": 1.35, "min": 15.35, "cnt": 2}, "forward-send-backward-recv":{"total": 1148.05, "avg": 38.27, "max": 1.38, "min": 225.07, "cnt": 30}, "backward-compute":{"total": 1495.00, "avg": 46.72, "max": 45.39, "min": 49.36, "cnt": 32}, "MoE_L3_bwd":{"total": 347.82, "avg": 10.87, "max": 10.28, "min": 11.75, "cnt": 32}, "MoE_L2_bwd":{"total": 339.08, "avg": 10.60, "max": 9.42, "min": 13.46, "cnt": 32}, "MoE_L1_bwd":{"total": 314.22, "avg": 9.82, "max": 9.41, "min": 10.27, "cnt": 32}, "MoE_L0_bwd":{"total": 277.20, "avg": 8.66, "max": 8.37, "min": 9.06, "cnt": 32}, "backward-send-forward-recv":{"total": 358.01, "avg": 12.35, "max": 1.62, "min": 130.73, "cnt": 29}, "backward-send":{"total": 2.98, "avg": 0.99, "max": 0.90, "min": 1.16, "cnt": 3}, "backward-recv":{"total": 285.69, "avg": 142.85, "max": 71.41, "min": 214.28, "cnt": 2}, "backward-params-all-reduce":{"total": 490.45, "avg": 490.45, "max": 490.45, "min": 490.45, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 246.96, "avg": 246.96, "max": 246.96, "min": 246.96, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 207.15, "avg": 207.15, "max": 207.15, "min": 207.15, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 161, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 63.33, "avg": 21.11, "max": 0.74, "min": 58.23, "cnt": 3}, "forward-compute":{"total": 1831.71, "avg": 57.24, "max": 48.95, "min": 65.49, "cnt": 32}, "fwd-compute":{"total": 1828.27, "avg": 57.13, "max": 48.88, "min": 65.36, "cnt": 32}, "batch-generator":{"total": 42.52, "avg": 1.33, "max": 0.64, "min": 1.87, "cnt": 32}, "fwd-embedding":{"total": 0.76, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1772.88, "avg": 55.40, "max": 47.91, "min": 63.31, "cnt": 32}, "fwd-layernorm":{"total": 10.62, "avg": 0.08, "max": 0.05, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 113.66, "avg": 0.89, "max": 0.74, "min": 1.49, "cnt": 128}, "fwd-misc":{"total": 22.17, "avg": 0.17, "max": 0.11, "min": 0.47, "cnt": 128}, "fwd-MLP":{"total": 1604.30, "avg": 12.53, "max": 10.18, "min": 17.40, "cnt": 128}, "MoE_L0_fwd":{"total": 470.41, "avg": 14.70, "max": 10.44, "min": 17.31, "cnt": 32}, "MoEMLP":{"total": 1586.40, "avg": 12.39, "max": 10.06, "min": 17.25, "cnt": 128}, "MoE_L1_fwd":{"total": 400.06, "avg": 12.50, "max": 11.06, "min": 15.15, "cnt": 32}, "MoE_L2_fwd":{"total": 361.99, "avg": 11.31, "max": 10.66, "min": 12.51, "cnt": 32}, "MoE_L3_fwd":{"total": 360.45, "avg": 11.26, "max": 10.10, "min": 15.84, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 3.05, "avg": 1.53, "max": 0.83, "min": 2.22, "cnt": 2}, "forward-send-backward-recv":{"total": 1172.16, "avg": 39.07, "max": 1.32, "min": 228.45, "cnt": 30}, "backward-compute":{"total": 1499.78, "avg": 46.87, "max": 43.92, "min": 49.16, "cnt": 32}, "MoE_L3_bwd":{"total": 359.54, "avg": 11.24, "max": 10.24, "min": 13.54, "cnt": 32}, "MoE_L2_bwd":{"total": 336.03, "avg": 10.50, "max": 9.78, "min": 11.42, "cnt": 32}, "MoE_L1_bwd":{"total": 311.22, "avg": 9.73, "max": 9.19, "min": 10.49, "cnt": 32}, "MoE_L0_bwd":{"total": 276.48, "avg": 8.64, "max": 8.21, "min": 9.30, "cnt": 32}, "backward-send-forward-recv":{"total": 478.78, "avg": 16.51, "max": 1.80, "min": 123.30, "cnt": 29}, "backward-send":{"total": 2.09, "avg": 0.70, "max": 0.52, "min": 0.81, "cnt": 3}, "backward-recv":{"total": 140.46, "avg": 70.23, "max": 68.48, "min": 71.99, "cnt": 2}, "backward-params-all-reduce":{"total": 482.36, "avg": 482.36, "max": 482.36, "min": 482.36, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 246.22, "avg": 246.22, "max": 246.22, "min": 246.22, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 206.37, "avg": 206.37, "max": 206.37, "min": 206.37, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.35, "avg": 3.35, "max": 3.35, "min": 3.35, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 162, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 57.86, "avg": 19.29, "max": 0.73, "min": 55.82, "cnt": 3}, "forward-compute":{"total": 1829.51, "avg": 57.17, "max": 48.94, "min": 64.55, "cnt": 32}, "fwd-compute":{"total": 1826.39, "avg": 57.07, "max": 48.87, "min": 64.44, "cnt": 32}, "batch-generator":{"total": 49.22, "avg": 1.54, "max": 0.71, "min": 3.62, "cnt": 32}, "fwd-embedding":{"total": 0.60, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1765.18, "avg": 55.16, "max": 47.89, "min": 62.43, "cnt": 32}, "fwd-layernorm":{"total": 9.72, "avg": 0.08, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 107.03, "avg": 0.84, "max": 0.75, "min": 1.53, "cnt": 128}, "fwd-misc":{"total": 20.32, "avg": 0.16, "max": 0.11, "min": 0.34, "cnt": 128}, "fwd-MLP":{"total": 1607.99, "avg": 12.56, "max": 9.94, "min": 20.85, "cnt": 128}, "MoE_L0_fwd":{"total": 474.70, "avg": 14.83, "max": 10.15, "min": 20.74, "cnt": 32}, "MoEMLP":{"total": 1591.49, "avg": 12.43, "max": 9.84, "min": 20.69, "cnt": 128}, "MoE_L1_fwd":{"total": 396.37, "avg": 12.39, "max": 10.99, "min": 15.07, "cnt": 32}, "MoE_L2_fwd":{"total": 375.95, "avg": 11.75, "max": 10.32, "min": 15.32, "cnt": 32}, "MoE_L3_fwd":{"total": 350.47, "avg": 10.95, "max": 9.87, "min": 13.67, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.56, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 4.38, "avg": 2.19, "max": 0.78, "min": 3.60, "cnt": 2}, "forward-send-backward-recv":{"total": 255.06, "avg": 8.50, "max": 1.31, "min": 113.84, "cnt": 30}, "backward-compute":{"total": 1496.82, "avg": 46.78, "max": 45.03, "min": 49.64, "cnt": 32}, "MoE_L3_bwd":{"total": 354.41, "avg": 11.08, "max": 9.36, "min": 12.87, "cnt": 32}, "MoE_L2_bwd":{"total": 331.65, "avg": 10.36, "max": 9.27, "min": 12.67, "cnt": 32}, "MoE_L1_bwd":{"total": 311.24, "avg": 9.73, "max": 9.34, "min": 10.17, "cnt": 32}, "MoE_L0_bwd":{"total": 282.23, "avg": 8.82, "max": 8.28, "min": 11.18, "cnt": 32}, "backward-send-forward-recv":{"total": 2298.93, "avg": 79.27, "max": 1.96, "min": 678.31, "cnt": 29}, "backward-send":{"total": 3.07, "avg": 1.02, "max": 0.88, "min": 1.11, "cnt": 3}, "backward-recv":{"total": 267.10, "avg": 133.55, "max": 70.23, "min": 196.87, "cnt": 2}, "backward-params-all-reduce":{"total": 485.66, "avg": 485.66, "max": 485.66, "min": 485.66, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 244.24, "avg": 244.24, "max": 244.24, "min": 244.24, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 204.21, "avg": 204.21, "max": 204.21, "min": 204.21, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.52, "avg": 3.52, "max": 3.52, "min": 3.52, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 163, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 57.22, "avg": 19.07, "max": 0.67, "min": 55.20, "cnt": 3}, "forward-compute":{"total": 1777.11, "avg": 55.53, "max": 49.28, "min": 64.80, "cnt": 32}, "fwd-compute":{"total": 1773.16, "avg": 55.41, "max": 49.21, "min": 64.67, "cnt": 32}, "batch-generator":{"total": 35.46, "avg": 1.11, "max": 0.67, "min": 1.74, "cnt": 32}, "fwd-embedding":{"total": 0.61, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1725.09, "avg": 53.91, "max": 48.22, "min": 62.62, "cnt": 32}, "fwd-layernorm":{"total": 9.66, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 107.46, "avg": 0.84, "max": 0.74, "min": 1.49, "cnt": 128}, "fwd-misc":{"total": 21.21, "avg": 0.17, "max": 0.11, "min": 0.34, "cnt": 128}, "fwd-MLP":{"total": 1566.18, "avg": 12.24, "max": 10.14, "min": 18.27, "cnt": 128}, "MoE_L0_fwd":{"total": 445.87, "avg": 13.93, "max": 10.07, "min": 18.18, "cnt": 32}, "MoEMLP":{"total": 1549.25, "avg": 12.10, "max": 10.03, "min": 18.11, "cnt": 128}, "MoE_L1_fwd":{"total": 383.08, "avg": 11.97, "max": 10.89, "min": 14.41, "cnt": 32}, "MoE_L2_fwd":{"total": 375.27, "avg": 11.73, "max": 10.86, "min": 15.32, "cnt": 32}, "MoE_L3_fwd":{"total": 351.22, "avg": 10.98, "max": 10.16, "min": 13.45, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 1.45, "avg": 0.05, "max": 0.02, "min": 0.89, "cnt": 32}, "forward-send":{"total": 4.36, "avg": 2.18, "max": 0.83, "min": 3.53, "cnt": 2}, "forward-send-backward-recv":{"total": 256.60, "avg": 8.55, "max": 1.37, "min": 131.30, "cnt": 30}, "backward-compute":{"total": 1508.01, "avg": 47.13, "max": 45.94, "min": 48.80, "cnt": 32}, "MoE_L3_bwd":{"total": 361.72, "avg": 11.30, "max": 10.21, "min": 12.97, "cnt": 32}, "MoE_L2_bwd":{"total": 341.47, "avg": 10.67, "max": 10.12, "min": 11.41, "cnt": 32}, "MoE_L1_bwd":{"total": 307.77, "avg": 9.62, "max": 9.21, "min": 11.12, "cnt": 32}, "MoE_L0_bwd":{"total": 281.19, "avg": 8.79, "max": 8.44, "min": 10.07, "cnt": 32}, "backward-send-forward-recv":{"total": 1148.55, "avg": 39.61, "max": 1.76, "min": 230.98, "cnt": 29}, "backward-send":{"total": 2.72, "avg": 0.91, "max": 0.82, "min": 1.01, "cnt": 3}, "backward-recv":{"total": 116.53, "avg": 58.26, "max": 55.04, "min": 61.49, "cnt": 2}, "backward-params-all-reduce":{"total": 481.72, "avg": 481.72, "max": 481.72, "min": 481.72, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 249.22, "avg": 249.22, "max": 249.22, "min": 249.22, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 209.51, "avg": 209.51, "max": 209.51, "min": 209.51, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.28, "avg": 3.28, "max": 3.28, "min": 3.28, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 164, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 59.87, "avg": 19.96, "max": 1.04, "min": 51.43, "cnt": 3}, "forward-compute":{"total": 1882.18, "avg": 58.82, "max": 50.01, "min": 69.18, "cnt": 32}, "fwd-compute":{"total": 1878.68, "avg": 58.71, "max": 49.93, "min": 69.11, "cnt": 32}, "batch-generator":{"total": 49.40, "avg": 1.54, "max": 0.68, "min": 3.87, "cnt": 32}, "fwd-embedding":{"total": 0.82, "avg": 0.03, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1815.40, "avg": 56.73, "max": 48.31, "min": 65.87, "cnt": 32}, "fwd-layernorm":{"total": 11.31, "avg": 0.09, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 117.37, "avg": 0.92, "max": 0.75, "min": 2.31, "cnt": 128}, "fwd-misc":{"total": 23.55, "avg": 0.18, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1639.60, "avg": 12.81, "max": 10.10, "min": 19.58, "cnt": 128}, "MoE_L0_fwd":{"total": 472.84, "avg": 14.78, "max": 10.75, "min": 19.38, "cnt": 32}, "MoEMLP":{"total": 1620.31, "avg": 12.66, "max": 9.98, "min": 19.33, "cnt": 128}, "MoE_L1_fwd":{"total": 410.52, "avg": 12.83, "max": 11.00, "min": 17.75, "cnt": 32}, "MoE_L2_fwd":{"total": 372.51, "avg": 11.64, "max": 10.81, "min": 17.88, "cnt": 32}, "MoE_L3_fwd":{"total": 371.33, "avg": 11.60, "max": 10.02, "min": 16.64, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.53, "avg": 0.76, "max": 0.72, "min": 0.81, "cnt": 2}, "forward-send-backward-recv":{"total": 352.71, "avg": 11.76, "max": 1.34, "min": 107.26, "cnt": 30}, "backward-compute":{"total": 1505.85, "avg": 47.06, "max": 44.98, "min": 49.82, "cnt": 32}, "MoE_L3_bwd":{"total": 361.51, "avg": 11.30, "max": 10.40, "min": 14.16, "cnt": 32}, "MoE_L2_bwd":{"total": 334.94, "avg": 10.47, "max": 9.85, "min": 12.51, "cnt": 32}, "MoE_L1_bwd":{"total": 310.08, "avg": 9.69, "max": 9.07, "min": 12.21, "cnt": 32}, "MoE_L0_bwd":{"total": 280.86, "avg": 8.78, "max": 7.93, "min": 9.02, "cnt": 32}, "backward-send-forward-recv":{"total": 800.63, "avg": 27.61, "max": 1.68, "min": 140.98, "cnt": 29}, "backward-send":{"total": 2.81, "avg": 0.94, "max": 0.52, "min": 1.19, "cnt": 3}, "backward-recv":{"total": 135.74, "avg": 67.87, "max": 65.27, "min": 70.47, "cnt": 2}, "backward-params-all-reduce":{"total": 487.72, "avg": 487.72, "max": 487.72, "min": 487.72, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 243.28, "avg": 243.28, "max": 243.28, "min": 243.28, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 203.42, "avg": 203.42, "max": 203.42, "min": 203.42, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 165, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 52.01, "avg": 17.34, "max": 0.94, "min": 50.11, "cnt": 3}, "forward-compute":{"total": 1824.10, "avg": 57.00, "max": 47.32, "min": 66.29, "cnt": 32}, "fwd-compute":{"total": 1820.54, "avg": 56.89, "max": 47.25, "min": 66.16, "cnt": 32}, "batch-generator":{"total": 46.23, "avg": 1.44, "max": 0.70, "min": 3.52, "cnt": 32}, "fwd-embedding":{"total": 0.72, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1760.03, "avg": 55.00, "max": 46.27, "min": 64.16, "cnt": 32}, "fwd-layernorm":{"total": 10.46, "avg": 0.08, "max": 0.05, "min": 0.18, "cnt": 128}, "fwd-attn":{"total": 111.99, "avg": 0.87, "max": 0.74, "min": 1.68, "cnt": 128}, "fwd-misc":{"total": 22.04, "avg": 0.17, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1592.30, "avg": 12.44, "max": 9.87, "min": 21.17, "cnt": 128}, "MoE_L0_fwd":{"total": 472.66, "avg": 14.77, "max": 10.20, "min": 20.99, "cnt": 32}, "MoEMLP":{"total": 1574.14, "avg": 12.30, "max": 9.76, "min": 20.89, "cnt": 128}, "MoE_L1_fwd":{"total": 394.13, "avg": 12.32, "max": 10.81, "min": 16.77, "cnt": 32}, "MoE_L2_fwd":{"total": 361.17, "avg": 11.29, "max": 10.34, "min": 12.39, "cnt": 32}, "MoE_L3_fwd":{"total": 352.70, "avg": 11.02, "max": 9.80, "min": 16.04, "cnt": 32}, "fwd-pooler":{"total": 0.37, "avg": 0.01, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-loss-func":{"total": 0.65, "avg": 0.02, "max": 0.02, "min": 0.05, "cnt": 32}, "forward-send":{"total": 3.39, "avg": 1.69, "max": 0.80, "min": 2.59, "cnt": 2}, "forward-send-backward-recv":{"total": 553.17, "avg": 18.44, "max": 1.44, "min": 151.19, "cnt": 30}, "backward-compute":{"total": 1495.55, "avg": 46.74, "max": 44.39, "min": 49.12, "cnt": 32}, "MoE_L3_bwd":{"total": 349.85, "avg": 10.93, "max": 9.60, "min": 13.66, "cnt": 32}, "MoE_L2_bwd":{"total": 335.21, "avg": 10.48, "max": 9.78, "min": 13.36, "cnt": 32}, "MoE_L1_bwd":{"total": 307.38, "avg": 9.61, "max": 8.87, "min": 9.97, "cnt": 32}, "MoE_L0_bwd":{"total": 286.10, "avg": 8.94, "max": 8.39, "min": 10.85, "cnt": 32}, "backward-send-forward-recv":{"total": 1369.07, "avg": 47.21, "max": 1.92, "min": 434.36, "cnt": 29}, "backward-send":{"total": 2.84, "avg": 0.95, "max": 0.67, "min": 1.12, "cnt": 3}, "backward-recv":{"total": 242.94, "avg": 121.47, "max": 56.71, "min": 186.23, "cnt": 2}, "backward-params-all-reduce":{"total": 483.18, "avg": 483.18, "max": 483.18, "min": 483.18, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 248.24, "avg": 248.24, "max": 248.24, "min": 248.24, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 208.41, "avg": 208.41, "max": 208.41, "min": 208.41, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.24, "avg": 3.24, "max": 3.24, "min": 3.24, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.48, "avg": 3.48, "max": 3.48, "min": 3.48, "cnt": 1}}}
{"type":"time", "iteration": 166, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 74.20, "avg": 24.73, "max": 1.13, "min": 67.24, "cnt": 3}, "forward-compute":{"total": 1837.58, "avg": 57.42, "max": 47.89, "min": 67.71, "cnt": 32}, "fwd-compute":{"total": 1833.74, "avg": 57.30, "max": 47.82, "min": 67.35, "cnt": 32}, "batch-generator":{"total": 46.41, "avg": 1.45, "max": 0.65, "min": 2.90, "cnt": 32}, "fwd-embedding":{"total": 0.83, "avg": 0.03, "max": 0.01, "min": 0.06, "cnt": 32}, "fwd-encoder":{"total": 1773.61, "avg": 55.43, "max": 46.86, "min": 63.82, "cnt": 32}, "fwd-layernorm":{"total": 11.06, "avg": 0.09, "max": 0.06, "min": 0.23, "cnt": 128}, "fwd-attn":{"total": 116.29, "avg": 0.91, "max": 0.74, "min": 2.12, "cnt": 128}, "fwd-misc":{"total": 22.91, "avg": 0.18, "max": 0.11, "min": 0.41, "cnt": 128}, "fwd-MLP":{"total": 1600.53, "avg": 12.50, "max": 9.98, "min": 20.21, "cnt": 128}, "MoE_L0_fwd":{"total": 474.69, "avg": 14.83, "max": 10.43, "min": 20.08, "cnt": 32}, "MoEMLP":{"total": 1582.26, "avg": 12.36, "max": 9.87, "min": 20.03, "cnt": 128}, "MoE_L1_fwd":{"total": 394.63, "avg": 12.33, "max": 10.75, "min": 14.72, "cnt": 32}, "MoE_L2_fwd":{"total": 363.66, "avg": 11.36, "max": 10.37, "min": 16.94, "cnt": 32}, "MoE_L3_fwd":{"total": 355.87, "avg": 11.12, "max": 9.91, "min": 17.12, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.62, "avg": 0.02, "max": 0.02, "min": 0.04, "cnt": 32}, "forward-send":{"total": 1.75, "avg": 0.88, "max": 0.80, "min": 0.95, "cnt": 2}, "forward-send-backward-recv":{"total": 801.81, "avg": 26.73, "max": 1.66, "min": 171.57, "cnt": 30}, "backward-compute":{"total": 1568.09, "avg": 49.00, "max": 44.40, "min": 128.80, "cnt": 32}, "MoE_L3_bwd":{"total": 350.26, "avg": 10.95, "max": 9.79, "min": 12.20, "cnt": 32}, "MoE_L2_bwd":{"total": 406.60, "avg": 12.71, "max": 9.39, "min": 92.51, "cnt": 32}, "MoE_L1_bwd":{"total": 307.91, "avg": 9.62, "max": 9.01, "min": 11.71, "cnt": 32}, "MoE_L0_bwd":{"total": 284.88, "avg": 8.90, "max": 8.56, "min": 9.18, "cnt": 32}, "backward-send-forward-recv":{"total": 1199.29, "avg": 41.35, "max": 2.05, "min": 309.69, "cnt": 29}, "backward-send":{"total": 3.43, "avg": 1.14, "max": 1.13, "min": 1.17, "cnt": 3}, "backward-recv":{"total": 190.21, "avg": 95.11, "max": 84.39, "min": 105.82, "cnt": 2}, "backward-params-all-reduce":{"total": 486.55, "avg": 486.55, "max": 486.55, "min": 486.55, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 247.05, "avg": 247.05, "max": 247.05, "min": 247.05, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 207.10, "avg": 207.10, "max": 207.10, "min": 207.10, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.27, "avg": 3.27, "max": 3.27, "min": 3.27, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.52, "avg": 3.52, "max": 3.52, "min": 3.52, "cnt": 1}}}
{"type":"time", "iteration": 167, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 60.04, "avg": 20.01, "max": 0.96, "min": 57.93, "cnt": 3}, "forward-compute":{"total": 1862.90, "avg": 58.22, "max": 50.08, "min": 71.68, "cnt": 32}, "fwd-compute":{"total": 1859.48, "avg": 58.11, "max": 49.98, "min": 71.55, "cnt": 32}, "batch-generator":{"total": 41.21, "avg": 1.29, "max": 0.64, "min": 2.26, "cnt": 32}, "fwd-embedding":{"total": 0.69, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1805.45, "avg": 56.42, "max": 48.75, "min": 69.42, "cnt": 32}, "fwd-layernorm":{"total": 10.37, "avg": 0.08, "max": 0.05, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 113.27, "avg": 0.88, "max": 0.74, "min": 1.47, "cnt": 128}, "fwd-misc":{"total": 22.02, "avg": 0.17, "max": 0.11, "min": 0.38, "cnt": 128}, "fwd-MLP":{"total": 1638.05, "avg": 12.80, "max": 9.97, "min": 24.62, "cnt": 128}, "MoE_L0_fwd":{"total": 505.90, "avg": 15.81, "max": 11.07, "min": 24.48, "cnt": 32}, "MoEMLP":{"total": 1619.95, "avg": 12.66, "max": 9.85, "min": 24.40, "cnt": 128}, "MoE_L1_fwd":{"total": 391.47, "avg": 12.23, "max": 10.78, "min": 13.50, "cnt": 32}, "MoE_L2_fwd":{"total": 361.37, "avg": 11.29, "max": 10.50, "min": 13.08, "cnt": 32}, "MoE_L3_fwd":{"total": 367.60, "avg": 11.49, "max": 9.89, "min": 17.38, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.86, "avg": 0.93, "max": 0.90, "min": 0.96, "cnt": 2}, "forward-send-backward-recv":{"total": 444.03, "avg": 14.80, "max": 1.10, "min": 126.57, "cnt": 30}, "backward-compute":{"total": 1503.60, "avg": 46.99, "max": 45.50, "min": 49.95, "cnt": 32}, "MoE_L3_bwd":{"total": 355.62, "avg": 11.11, "max": 9.95, "min": 14.60, "cnt": 32}, "MoE_L2_bwd":{"total": 335.00, "avg": 10.47, "max": 9.83, "min": 11.13, "cnt": 32}, "MoE_L1_bwd":{"total": 306.47, "avg": 9.58, "max": 9.28, "min": 10.19, "cnt": 32}, "MoE_L0_bwd":{"total": 287.61, "avg": 8.99, "max": 8.54, "min": 9.95, "cnt": 32}, "backward-send-forward-recv":{"total": 812.14, "avg": 28.00, "max": 1.92, "min": 200.62, "cnt": 29}, "backward-send":{"total": 3.01, "avg": 1.00, "max": 0.95, "min": 1.06, "cnt": 3}, "backward-recv":{"total": 139.98, "avg": 69.99, "max": 66.54, "min": 73.45, "cnt": 2}, "backward-params-all-reduce":{"total": 483.19, "avg": 483.19, "max": 483.19, "min": 483.19, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 249.15, "avg": 249.15, "max": 249.15, "min": 249.15, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 209.32, "avg": 209.32, "max": 209.32, "min": 209.32, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 168, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 64.82, "avg": 21.61, "max": 0.88, "min": 62.81, "cnt": 3}, "forward-compute":{"total": 1843.09, "avg": 57.60, "max": 49.24, "min": 65.08, "cnt": 32}, "fwd-compute":{"total": 1839.81, "avg": 57.49, "max": 49.17, "min": 64.99, "cnt": 32}, "batch-generator":{"total": 42.03, "avg": 1.31, "max": 0.68, "min": 2.41, "cnt": 32}, "fwd-embedding":{"total": 0.69, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1785.03, "avg": 55.78, "max": 48.20, "min": 63.62, "cnt": 32}, "fwd-layernorm":{"total": 10.18, "avg": 0.08, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 110.35, "avg": 0.86, "max": 0.74, "min": 1.52, "cnt": 128}, "fwd-misc":{"total": 21.74, "avg": 0.17, "max": 0.11, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1621.41, "avg": 12.67, "max": 10.52, "min": 18.37, "cnt": 128}, "MoE_L0_fwd":{"total": 488.79, "avg": 15.27, "max": 10.78, "min": 18.30, "cnt": 32}, "MoEMLP":{"total": 1603.65, "avg": 12.53, "max": 10.41, "min": 18.24, "cnt": 128}, "MoE_L1_fwd":{"total": 399.57, "avg": 12.49, "max": 10.84, "min": 15.26, "cnt": 32}, "MoE_L2_fwd":{"total": 358.18, "avg": 11.19, "max": 10.45, "min": 14.33, "cnt": 32}, "MoE_L3_fwd":{"total": 363.58, "avg": 11.36, "max": 10.61, "min": 16.20, "cnt": 32}, "fwd-pooler":{"total": 0.36, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 13.26, "avg": 6.63, "max": 0.83, "min": 12.43, "cnt": 2}, "forward-send-backward-recv":{"total": 509.42, "avg": 16.98, "max": 1.57, "min": 108.03, "cnt": 30}, "backward-compute":{"total": 1495.46, "avg": 46.73, "max": 45.26, "min": 48.68, "cnt": 32}, "MoE_L3_bwd":{"total": 356.42, "avg": 11.14, "max": 10.32, "min": 12.97, "cnt": 32}, "MoE_L2_bwd":{"total": 321.23, "avg": 10.04, "max": 9.23, "min": 10.79, "cnt": 32}, "MoE_L1_bwd":{"total": 310.86, "avg": 9.71, "max": 8.44, "min": 10.18, "cnt": 32}, "MoE_L0_bwd":{"total": 288.24, "avg": 9.01, "max": 8.42, "min": 10.66, "cnt": 32}, "backward-send-forward-recv":{"total": 387.55, "avg": 13.36, "max": 1.38, "min": 124.76, "cnt": 29}, "backward-send":{"total": 3.21, "avg": 1.07, "max": 0.93, "min": 1.15, "cnt": 3}, "backward-recv":{"total": 156.74, "avg": 78.37, "max": 75.37, "min": 81.38, "cnt": 2}, "backward-params-all-reduce":{"total": 483.34, "avg": 483.34, "max": 483.34, "min": 483.34, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 256.35, "avg": 256.35, "max": 256.35, "min": 256.35, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 216.50, "avg": 216.50, "max": 216.50, "min": 216.50, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.47, "avg": 3.47, "max": 3.47, "min": 3.47, "cnt": 1}}}
{"type":"time", "iteration": 169, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 60.50, "avg": 20.17, "max": 1.02, "min": 58.44, "cnt": 3}, "forward-compute":{"total": 1815.05, "avg": 56.72, "max": 48.45, "min": 65.10, "cnt": 32}, "fwd-compute":{"total": 1811.66, "avg": 56.61, "max": 48.38, "min": 64.97, "cnt": 32}, "batch-generator":{"total": 40.95, "avg": 1.28, "max": 0.68, "min": 1.94, "cnt": 32}, "fwd-embedding":{"total": 0.70, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1757.32, "avg": 54.92, "max": 47.31, "min": 62.93, "cnt": 32}, "fwd-layernorm":{"total": 10.30, "avg": 0.08, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 110.66, "avg": 0.86, "max": 0.75, "min": 1.44, "cnt": 128}, "fwd-misc":{"total": 22.00, "avg": 0.17, "max": 0.11, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1592.66, "avg": 12.44, "max": 10.06, "min": 23.44, "cnt": 128}, "MoE_L0_fwd":{"total": 475.91, "avg": 14.87, "max": 10.66, "min": 23.35, "cnt": 32}, "MoEMLP":{"total": 1575.08, "avg": 12.31, "max": 9.94, "min": 23.30, "cnt": 128}, "MoE_L1_fwd":{"total": 392.46, "avg": 12.26, "max": 11.02, "min": 16.18, "cnt": 32}, "MoE_L2_fwd":{"total": 358.61, "avg": 11.21, "max": 10.07, "min": 16.61, "cnt": 32}, "MoE_L3_fwd":{"total": 354.48, "avg": 11.08, "max": 9.99, "min": 16.45, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 8.12, "avg": 4.06, "max": 1.00, "min": 7.12, "cnt": 2}, "forward-send-backward-recv":{"total": 658.18, "avg": 21.94, "max": 1.34, "min": 121.62, "cnt": 30}, "backward-compute":{"total": 1478.47, "avg": 46.20, "max": 45.50, "min": 47.32, "cnt": 32}, "MoE_L3_bwd":{"total": 347.83, "avg": 10.87, "max": 10.18, "min": 11.55, "cnt": 32}, "MoE_L2_bwd":{"total": 320.73, "avg": 10.02, "max": 9.57, "min": 11.06, "cnt": 32}, "MoE_L1_bwd":{"total": 307.95, "avg": 9.62, "max": 9.34, "min": 10.53, "cnt": 32}, "MoE_L0_bwd":{"total": 284.74, "avg": 8.90, "max": 8.53, "min": 9.29, "cnt": 32}, "backward-send-forward-recv":{"total": 657.65, "avg": 22.68, "max": 1.70, "min": 139.65, "cnt": 29}, "backward-send":{"total": 2.90, "avg": 0.97, "max": 0.91, "min": 1.03, "cnt": 3}, "backward-recv":{"total": 141.16, "avg": 70.58, "max": 64.46, "min": 76.70, "cnt": 2}, "backward-params-all-reduce":{"total": 487.03, "avg": 487.03, "max": 487.03, "min": 487.03, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 250.36, "avg": 250.36, "max": 250.36, "min": 250.36, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.36, "avg": 3.36, "max": 3.36, "min": 3.36, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 210.62, "avg": 210.62, "max": 210.62, "min": 210.62, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.30, "avg": 3.30, "max": 3.30, "min": 3.30, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 170, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.06, "avg": 0.06, "max": 0.06, "min": 0.06, "cnt": 1}, "forward-recv":{"total": 65.38, "avg": 21.79, "max": 1.23, "min": 62.83, "cnt": 3}, "forward-compute":{"total": 1842.88, "avg": 57.59, "max": 50.84, "min": 64.76, "cnt": 32}, "fwd-compute":{"total": 1839.42, "avg": 57.48, "max": 50.76, "min": 64.62, "cnt": 32}, "batch-generator":{"total": 41.77, "avg": 1.31, "max": 0.65, "min": 1.76, "cnt": 32}, "fwd-embedding":{"total": 0.71, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1784.36, "avg": 55.76, "max": 49.53, "min": 62.44, "cnt": 32}, "fwd-layernorm":{"total": 10.67, "avg": 0.08, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 112.89, "avg": 0.88, "max": 0.75, "min": 2.23, "cnt": 128}, "fwd-misc":{"total": 22.46, "avg": 0.18, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1616.35, "avg": 12.63, "max": 10.29, "min": 18.68, "cnt": 128}, "MoE_L0_fwd":{"total": 490.85, "avg": 15.34, "max": 11.03, "min": 18.59, "cnt": 32}, "MoEMLP":{"total": 1598.24, "avg": 12.49, "max": 10.17, "min": 18.53, "cnt": 128}, "MoE_L1_fwd":{"total": 407.14, "avg": 12.72, "max": 10.98, "min": 17.24, "cnt": 32}, "MoE_L2_fwd":{"total": 354.54, "avg": 11.08, "max": 10.22, "min": 15.79, "cnt": 32}, "MoE_L3_fwd":{"total": 352.28, "avg": 11.01, "max": 10.32, "min": 12.19, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.90, "avg": 0.95, "max": 0.90, "min": 1.00, "cnt": 2}, "forward-send-backward-recv":{"total": 378.56, "avg": 12.62, "max": 1.74, "min": 114.31, "cnt": 30}, "backward-compute":{"total": 1477.70, "avg": 46.18, "max": 44.87, "min": 47.60, "cnt": 32}, "MoE_L3_bwd":{"total": 343.34, "avg": 10.73, "max": 9.72, "min": 11.51, "cnt": 32}, "MoE_L2_bwd":{"total": 318.67, "avg": 9.96, "max": 9.27, "min": 10.38, "cnt": 32}, "MoE_L1_bwd":{"total": 307.52, "avg": 9.61, "max": 9.21, "min": 10.39, "cnt": 32}, "MoE_L0_bwd":{"total": 288.78, "avg": 9.02, "max": 8.39, "min": 10.37, "cnt": 32}, "backward-send-forward-recv":{"total": 578.21, "avg": 19.94, "max": 1.60, "min": 131.21, "cnt": 29}, "backward-send":{"total": 3.23, "avg": 1.08, "max": 1.04, "min": 1.16, "cnt": 3}, "backward-recv":{"total": 146.53, "avg": 73.26, "max": 60.81, "min": 85.71, "cnt": 2}, "backward-params-all-reduce":{"total": 483.69, "avg": 483.69, "max": 483.69, "min": 483.69, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 247.48, "avg": 247.48, "max": 247.48, "min": 247.48, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 207.61, "avg": 207.61, "max": 207.61, "min": 207.61, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.33, "avg": 3.33, "max": 3.33, "min": 3.33, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 171, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.06, "avg": 0.06, "max": 0.06, "min": 0.06, "cnt": 1}, "forward-recv":{"total": 62.22, "avg": 20.74, "max": 0.91, "min": 59.94, "cnt": 3}, "forward-compute":{"total": 1785.07, "avg": 55.78, "max": 47.88, "min": 59.34, "cnt": 32}, "fwd-compute":{"total": 1781.78, "avg": 55.68, "max": 47.81, "min": 59.21, "cnt": 32}, "batch-generator":{"total": 43.42, "avg": 1.36, "max": 0.66, "min": 4.09, "cnt": 32}, "fwd-embedding":{"total": 0.75, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1725.34, "avg": 53.92, "max": 46.86, "min": 57.16, "cnt": 32}, "fwd-layernorm":{"total": 10.48, "avg": 0.08, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 112.12, "avg": 0.88, "max": 0.74, "min": 1.49, "cnt": 128}, "fwd-misc":{"total": 22.28, "avg": 0.17, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1558.14, "avg": 12.17, "max": 10.03, "min": 17.64, "cnt": 128}, "MoE_L0_fwd":{"total": 470.20, "avg": 14.69, "max": 10.90, "min": 17.57, "cnt": 32}, "MoEMLP":{"total": 1539.73, "avg": 12.03, "max": 9.92, "min": 17.52, "cnt": 128}, "MoE_L1_fwd":{"total": 389.08, "avg": 12.16, "max": 10.97, "min": 13.70, "cnt": 32}, "MoE_L2_fwd":{"total": 338.77, "avg": 10.59, "max": 9.96, "min": 11.65, "cnt": 32}, "MoE_L3_fwd":{"total": 348.28, "avg": 10.88, "max": 10.26, "min": 12.44, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 3.82, "avg": 1.91, "max": 0.95, "min": 2.87, "cnt": 2}, "forward-send-backward-recv":{"total": 359.37, "avg": 11.98, "max": 1.92, "min": 122.26, "cnt": 30}, "backward-compute":{"total": 1469.67, "avg": 45.93, "max": 44.04, "min": 47.87, "cnt": 32}, "MoE_L3_bwd":{"total": 348.12, "avg": 10.88, "max": 10.24, "min": 11.84, "cnt": 32}, "MoE_L2_bwd":{"total": 312.55, "avg": 9.77, "max": 9.12, "min": 10.47, "cnt": 32}, "MoE_L1_bwd":{"total": 309.34, "avg": 9.67, "max": 8.98, "min": 10.89, "cnt": 32}, "MoE_L0_bwd":{"total": 282.68, "avg": 8.83, "max": 8.03, "min": 9.45, "cnt": 32}, "backward-send-forward-recv":{"total": 645.57, "avg": 22.26, "max": 2.02, "min": 90.19, "cnt": 29}, "backward-send":{"total": 3.21, "avg": 1.07, "max": 0.98, "min": 1.14, "cnt": 3}, "backward-recv":{"total": 124.44, "avg": 62.22, "max": 56.76, "min": 67.68, "cnt": 2}, "backward-params-all-reduce":{"total": 484.21, "avg": 484.21, "max": 484.21, "min": 484.21, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 255.48, "avg": 255.48, "max": 255.48, "min": 255.48, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 215.67, "avg": 215.67, "max": 215.67, "min": 215.67, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.29, "avg": 3.29, "max": 3.29, "min": 3.29, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 172, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.06, "avg": 0.06, "max": 0.06, "min": 0.06, "cnt": 1}, "forward-recv":{"total": 52.98, "avg": 17.66, "max": 1.10, "min": 50.54, "cnt": 3}, "forward-compute":{"total": 1757.67, "avg": 54.93, "max": 49.08, "min": 61.17, "cnt": 32}, "fwd-compute":{"total": 1754.47, "avg": 54.83, "max": 49.00, "min": 61.02, "cnt": 32}, "batch-generator":{"total": 43.07, "avg": 1.35, "max": 0.67, "min": 3.01, "cnt": 32}, "fwd-embedding":{"total": 0.61, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1697.98, "avg": 53.06, "max": 47.89, "min": 58.69, "cnt": 32}, "fwd-layernorm":{"total": 9.52, "avg": 0.07, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 106.22, "avg": 0.83, "max": 0.74, "min": 1.60, "cnt": 128}, "fwd-misc":{"total": 20.07, "avg": 0.16, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1541.93, "avg": 12.05, "max": 10.28, "min": 18.07, "cnt": 128}, "MoE_L0_fwd":{"total": 449.23, "avg": 14.04, "max": 10.69, "min": 17.99, "cnt": 32}, "MoEMLP":{"total": 1525.52, "avg": 11.92, "max": 10.16, "min": 17.95, "cnt": 128}, "MoE_L1_fwd":{"total": 386.18, "avg": 12.07, "max": 11.04, "min": 15.35, "cnt": 32}, "MoE_L2_fwd":{"total": 341.15, "avg": 10.66, "max": 10.22, "min": 11.63, "cnt": 32}, "MoE_L3_fwd":{"total": 354.92, "avg": 11.09, "max": 10.20, "min": 15.83, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.77, "avg": 0.88, "max": 0.82, "min": 0.95, "cnt": 2}, "forward-send-backward-recv":{"total": 275.59, "avg": 9.19, "max": 1.43, "min": 128.90, "cnt": 30}, "backward-compute":{"total": 1492.17, "avg": 46.63, "max": 45.61, "min": 48.41, "cnt": 32}, "MoE_L3_bwd":{"total": 359.34, "avg": 11.23, "max": 10.44, "min": 14.12, "cnt": 32}, "MoE_L2_bwd":{"total": 311.86, "avg": 9.75, "max": 9.23, "min": 10.88, "cnt": 32}, "MoE_L1_bwd":{"total": 318.80, "avg": 9.96, "max": 9.47, "min": 10.85, "cnt": 32}, "MoE_L0_bwd":{"total": 282.83, "avg": 8.84, "max": 8.50, "min": 9.24, "cnt": 32}, "backward-send-forward-recv":{"total": 1448.48, "avg": 49.95, "max": 1.95, "min": 184.97, "cnt": 29}, "backward-send":{"total": 3.13, "avg": 1.04, "max": 0.99, "min": 1.12, "cnt": 3}, "backward-recv":{"total": 142.12, "avg": 71.06, "max": 67.36, "min": 74.76, "cnt": 2}, "backward-params-all-reduce":{"total": 487.22, "avg": 487.22, "max": 487.22, "min": 487.22, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 276.66, "avg": 276.66, "max": 276.66, "min": 276.66, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.36, "avg": 3.36, "max": 3.36, "min": 3.36, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 236.98, "avg": 236.98, "max": 236.98, "min": 236.98, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.30, "avg": 3.30, "max": 3.30, "min": 3.30, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}}}
{"type":"time", "iteration": 173, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 60.88, "avg": 20.29, "max": 1.22, "min": 52.30, "cnt": 3}, "forward-compute":{"total": 1797.68, "avg": 56.18, "max": 49.37, "min": 66.22, "cnt": 32}, "fwd-compute":{"total": 1794.35, "avg": 56.07, "max": 49.30, "min": 66.04, "cnt": 32}, "batch-generator":{"total": 46.06, "avg": 1.44, "max": 0.71, "min": 3.50, "cnt": 32}, "fwd-embedding":{"total": 0.68, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1734.73, "avg": 54.21, "max": 48.13, "min": 63.76, "cnt": 32}, "fwd-layernorm":{"total": 10.21, "avg": 0.08, "max": 0.05, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 110.88, "avg": 0.87, "max": 0.74, "min": 1.76, "cnt": 128}, "fwd-misc":{"total": 22.05, "avg": 0.17, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1569.98, "avg": 12.27, "max": 10.08, "min": 19.61, "cnt": 128}, "MoE_L0_fwd":{"total": 459.21, "avg": 14.35, "max": 10.49, "min": 19.53, "cnt": 32}, "MoEMLP":{"total": 1552.05, "avg": 12.13, "max": 9.97, "min": 19.49, "cnt": 128}, "MoE_L1_fwd":{"total": 392.38, "avg": 12.26, "max": 10.88, "min": 15.64, "cnt": 32}, "MoE_L2_fwd":{"total": 350.60, "avg": 10.96, "max": 10.01, "min": 15.21, "cnt": 32}, "MoE_L3_fwd":{"total": 356.38, "avg": 11.14, "max": 10.34, "min": 13.69, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.61, "avg": 0.02, "max": 0.02, "min": 0.04, "cnt": 32}, "forward-send":{"total": 1.88, "avg": 0.94, "max": 0.91, "min": 0.97, "cnt": 2}, "forward-send-backward-recv":{"total": 280.96, "avg": 9.37, "max": 1.49, "min": 88.38, "cnt": 30}, "backward-compute":{"total": 1486.38, "avg": 46.45, "max": 44.60, "min": 49.66, "cnt": 32}, "MoE_L3_bwd":{"total": 349.97, "avg": 10.94, "max": 10.23, "min": 11.63, "cnt": 32}, "MoE_L2_bwd":{"total": 319.50, "avg": 9.98, "max": 9.19, "min": 11.21, "cnt": 32}, "MoE_L1_bwd":{"total": 314.50, "avg": 9.83, "max": 9.31, "min": 10.81, "cnt": 32}, "MoE_L0_bwd":{"total": 285.53, "avg": 8.92, "max": 8.44, "min": 12.34, "cnt": 32}, "backward-send-forward-recv":{"total": 916.56, "avg": 31.61, "max": 1.98, "min": 141.59, "cnt": 29}, "backward-send":{"total": 3.05, "avg": 1.02, "max": 0.96, "min": 1.06, "cnt": 3}, "backward-recv":{"total": 205.71, "avg": 102.86, "max": 71.96, "min": 133.75, "cnt": 2}, "backward-params-all-reduce":{"total": 486.12, "avg": 486.12, "max": 486.12, "min": 486.12, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 240.54, "avg": 240.54, "max": 240.54, "min": 240.54, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 200.79, "avg": 200.79, "max": 200.79, "min": 200.79, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.23, "avg": 3.23, "max": 3.23, "min": 3.23, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.47, "avg": 3.47, "max": 3.47, "min": 3.47, "cnt": 1}}}
{"type":"time", "iteration": 174, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.06, "avg": 0.06, "max": 0.06, "min": 0.06, "cnt": 1}, "forward-recv":{"total": 62.64, "avg": 20.88, "max": 0.68, "min": 60.66, "cnt": 3}, "forward-compute":{"total": 1774.72, "avg": 55.46, "max": 47.72, "min": 59.90, "cnt": 32}, "fwd-compute":{"total": 1771.31, "avg": 55.35, "max": 47.66, "min": 59.81, "cnt": 32}, "batch-generator":{"total": 42.72, "avg": 1.33, "max": 0.68, "min": 2.45, "cnt": 32}, "fwd-embedding":{"total": 0.72, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1715.66, "avg": 53.61, "max": 46.63, "min": 58.22, "cnt": 32}, "fwd-layernorm":{"total": 10.66, "avg": 0.08, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 114.18, "avg": 0.89, "max": 0.74, "min": 1.48, "cnt": 128}, "fwd-misc":{"total": 22.28, "avg": 0.17, "max": 0.11, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1546.58, "avg": 12.08, "max": 10.01, "min": 18.73, "cnt": 128}, "MoE_L0_fwd":{"total": 458.91, "avg": 14.34, "max": 10.74, "min": 18.66, "cnt": 32}, "MoEMLP":{"total": 1528.50, "avg": 11.94, "max": 9.90, "min": 18.61, "cnt": 128}, "MoE_L1_fwd":{"total": 389.38, "avg": 12.17, "max": 10.86, "min": 13.41, "cnt": 32}, "MoE_L2_fwd":{"total": 337.72, "avg": 10.55, "max": 9.94, "min": 11.30, "cnt": 32}, "MoE_L3_fwd":{"total": 349.12, "avg": 10.91, "max": 10.32, "min": 12.38, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 10.04, "avg": 5.02, "max": 0.91, "min": 9.12, "cnt": 2}, "forward-send-backward-recv":{"total": 430.51, "avg": 14.35, "max": 1.69, "min": 106.73, "cnt": 30}, "backward-compute":{"total": 1474.46, "avg": 46.08, "max": 44.68, "min": 48.25, "cnt": 32}, "MoE_L3_bwd":{"total": 354.45, "avg": 11.08, "max": 9.95, "min": 13.49, "cnt": 32}, "MoE_L2_bwd":{"total": 316.45, "avg": 9.89, "max": 9.22, "min": 10.54, "cnt": 32}, "MoE_L1_bwd":{"total": 310.39, "avg": 9.70, "max": 9.15, "min": 10.20, "cnt": 32}, "MoE_L0_bwd":{"total": 280.32, "avg": 8.76, "max": 8.17, "min": 10.23, "cnt": 32}, "backward-send-forward-recv":{"total": 989.43, "avg": 34.12, "max": 1.83, "min": 232.64, "cnt": 29}, "backward-send":{"total": 3.22, "avg": 1.07, "max": 1.07, "min": 1.08, "cnt": 3}, "backward-recv":{"total": 144.05, "avg": 72.03, "max": 71.64, "min": 72.42, "cnt": 2}, "backward-params-all-reduce":{"total": 485.22, "avg": 485.22, "max": 485.22, "min": 485.22, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 244.98, "avg": 244.98, "max": 244.98, "min": 244.98, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 205.24, "avg": 205.24, "max": 205.24, "min": 205.24, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.33, "avg": 3.33, "max": 3.33, "min": 3.33, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 175, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 63.21, "avg": 21.07, "max": 0.99, "min": 61.11, "cnt": 3}, "forward-compute":{"total": 1796.88, "avg": 56.15, "max": 48.89, "min": 59.88, "cnt": 32}, "fwd-compute":{"total": 1793.46, "avg": 56.05, "max": 48.82, "min": 59.73, "cnt": 32}, "batch-generator":{"total": 42.12, "avg": 1.32, "max": 0.72, "min": 2.03, "cnt": 32}, "fwd-embedding":{"total": 0.74, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1737.51, "avg": 54.30, "max": 47.77, "min": 58.02, "cnt": 32}, "fwd-layernorm":{"total": 10.62, "avg": 0.08, "max": 0.05, "min": 0.22, "cnt": 128}, "fwd-attn":{"total": 111.11, "avg": 0.87, "max": 0.74, "min": 1.50, "cnt": 128}, "fwd-misc":{"total": 22.58, "avg": 0.18, "max": 0.11, "min": 0.48, "cnt": 128}, "fwd-MLP":{"total": 1571.10, "avg": 12.27, "max": 10.06, "min": 18.39, "cnt": 128}, "MoE_L0_fwd":{"total": 477.06, "avg": 14.91, "max": 10.76, "min": 18.22, "cnt": 32}, "MoEMLP":{"total": 1552.75, "avg": 12.13, "max": 9.95, "min": 18.10, "cnt": 128}, "MoE_L1_fwd":{"total": 389.38, "avg": 12.17, "max": 10.72, "min": 14.48, "cnt": 32}, "MoE_L2_fwd":{"total": 334.92, "avg": 10.47, "max": 9.99, "min": 11.41, "cnt": 32}, "MoE_L3_fwd":{"total": 358.04, "avg": 11.19, "max": 10.36, "min": 12.61, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.61, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 11.12, "avg": 5.56, "max": 0.88, "min": 10.24, "cnt": 2}, "forward-send-backward-recv":{"total": 329.89, "avg": 11.00, "max": 1.44, "min": 109.04, "cnt": 30}, "backward-compute":{"total": 1468.54, "avg": 45.89, "max": 44.43, "min": 47.64, "cnt": 32}, "MoE_L3_bwd":{"total": 352.65, "avg": 11.02, "max": 10.42, "min": 12.13, "cnt": 32}, "MoE_L2_bwd":{"total": 306.50, "avg": 9.58, "max": 8.94, "min": 10.37, "cnt": 32}, "MoE_L1_bwd":{"total": 313.51, "avg": 9.80, "max": 9.07, "min": 10.24, "cnt": 32}, "MoE_L0_bwd":{"total": 278.91, "avg": 8.72, "max": 8.20, "min": 9.15, "cnt": 32}, "backward-send-forward-recv":{"total": 1137.41, "avg": 39.22, "max": 1.98, "min": 171.73, "cnt": 29}, "backward-send":{"total": 2.66, "avg": 0.89, "max": 0.82, "min": 1.00, "cnt": 3}, "backward-recv":{"total": 148.89, "avg": 74.44, "max": 72.53, "min": 76.36, "cnt": 2}, "backward-params-all-reduce":{"total": 489.35, "avg": 489.35, "max": 489.35, "min": 489.35, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 242.86, "avg": 242.86, "max": 242.86, "min": 242.86, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.36, "avg": 3.36, "max": 3.36, "min": 3.36, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 202.72, "avg": 202.72, "max": 202.72, "min": 202.72, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.62, "avg": 3.62, "max": 3.62, "min": 3.62, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 176, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.11, "avg": 0.11, "max": 0.11, "min": 0.11, "cnt": 1}, "forward-recv":{"total": 53.05, "avg": 17.68, "max": 0.79, "min": 50.94, "cnt": 3}, "forward-compute":{"total": 1768.98, "avg": 55.28, "max": 47.80, "min": 63.79, "cnt": 32}, "fwd-compute":{"total": 1765.80, "avg": 55.18, "max": 47.73, "min": 63.63, "cnt": 32}, "batch-generator":{"total": 45.09, "avg": 1.41, "max": 0.66, "min": 2.86, "cnt": 32}, "fwd-embedding":{"total": 0.67, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1707.85, "avg": 53.37, "max": 46.38, "min": 61.12, "cnt": 32}, "fwd-layernorm":{"total": 10.27, "avg": 0.08, "max": 0.05, "min": 0.25, "cnt": 128}, "fwd-attn":{"total": 110.33, "avg": 0.86, "max": 0.74, "min": 2.03, "cnt": 128}, "fwd-misc":{"total": 21.52, "avg": 0.17, "max": 0.11, "min": 0.51, "cnt": 128}, "fwd-MLP":{"total": 1544.26, "avg": 12.06, "max": 9.97, "min": 17.72, "cnt": 128}, "MoE_L0_fwd":{"total": 450.49, "avg": 14.08, "max": 10.03, "min": 17.65, "cnt": 32}, "MoEMLP":{"total": 1526.79, "avg": 11.93, "max": 9.85, "min": 17.60, "cnt": 128}, "MoE_L1_fwd":{"total": 390.19, "avg": 12.19, "max": 10.87, "min": 14.21, "cnt": 32}, "MoE_L2_fwd":{"total": 336.36, "avg": 10.51, "max": 9.89, "min": 15.03, "cnt": 32}, "MoE_L3_fwd":{"total": 356.08, "avg": 11.13, "max": 10.33, "min": 13.95, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 9.82, "avg": 4.91, "max": 0.96, "min": 8.85, "cnt": 2}, "forward-send-backward-recv":{"total": 742.10, "avg": 24.74, "max": 1.99, "min": 145.78, "cnt": 30}, "backward-compute":{"total": 1467.07, "avg": 45.85, "max": 43.44, "min": 46.68, "cnt": 32}, "MoE_L3_bwd":{"total": 355.14, "avg": 11.10, "max": 10.17, "min": 11.57, "cnt": 32}, "MoE_L2_bwd":{"total": 304.61, "avg": 9.52, "max": 8.60, "min": 10.11, "cnt": 32}, "MoE_L1_bwd":{"total": 311.71, "avg": 9.74, "max": 9.24, "min": 10.18, "cnt": 32}, "MoE_L0_bwd":{"total": 277.48, "avg": 8.67, "max": 8.07, "min": 9.07, "cnt": 32}, "backward-send-forward-recv":{"total": 1640.67, "avg": 56.57, "max": 2.03, "min": 461.83, "cnt": 29}, "backward-send":{"total": 2.63, "avg": 0.88, "max": 0.80, "min": 0.98, "cnt": 3}, "backward-recv":{"total": 155.90, "avg": 77.95, "max": 75.75, "min": 80.15, "cnt": 2}, "backward-params-all-reduce":{"total": 487.24, "avg": 487.24, "max": 487.24, "min": 487.24, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 248.53, "avg": 248.53, "max": 248.53, "min": 248.53, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 208.51, "avg": 208.51, "max": 208.51, "min": 208.51, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.32, "avg": 3.32, "max": 3.32, "min": 3.32, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.48, "avg": 3.48, "max": 3.48, "min": 3.48, "cnt": 1}}}
{"type":"time", "iteration": 177, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 68.50, "avg": 22.83, "max": 1.22, "min": 60.77, "cnt": 3}, "forward-compute":{"total": 1791.07, "avg": 55.97, "max": 49.44, "min": 61.64, "cnt": 32}, "fwd-compute":{"total": 1787.35, "avg": 55.85, "max": 49.37, "min": 61.51, "cnt": 32}, "batch-generator":{"total": 43.82, "avg": 1.37, "max": 0.67, "min": 1.89, "cnt": 32}, "fwd-embedding":{"total": 0.81, "avg": 0.03, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1728.91, "avg": 54.03, "max": 48.38, "min": 59.14, "cnt": 32}, "fwd-layernorm":{"total": 11.30, "avg": 0.09, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 117.23, "avg": 0.92, "max": 0.74, "min": 1.50, "cnt": 128}, "fwd-misc":{"total": 23.81, "avg": 0.19, "max": 0.11, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1553.27, "avg": 12.13, "max": 10.05, "min": 17.59, "cnt": 128}, "MoE_L0_fwd":{"total": 453.08, "avg": 14.16, "max": 10.99, "min": 17.49, "cnt": 32}, "MoEMLP":{"total": 1534.25, "avg": 11.99, "max": 9.95, "min": 17.42, "cnt": 128}, "MoE_L1_fwd":{"total": 390.10, "avg": 12.19, "max": 11.09, "min": 13.35, "cnt": 32}, "MoE_L2_fwd":{"total": 339.94, "avg": 10.62, "max": 9.99, "min": 11.51, "cnt": 32}, "MoE_L3_fwd":{"total": 357.99, "avg": 11.19, "max": 10.39, "min": 14.10, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-loss-func":{"total": 0.61, "avg": 0.02, "max": 0.02, "min": 0.05, "cnt": 32}, "forward-send":{"total": 1.97, "avg": 0.99, "max": 0.97, "min": 1.00, "cnt": 2}, "forward-send-backward-recv":{"total": 704.80, "avg": 23.49, "max": 1.81, "min": 123.52, "cnt": 30}, "backward-compute":{"total": 1475.16, "avg": 46.10, "max": 44.36, "min": 47.00, "cnt": 32}, "MoE_L3_bwd":{"total": 356.41, "avg": 11.14, "max": 10.37, "min": 11.90, "cnt": 32}, "MoE_L2_bwd":{"total": 310.55, "avg": 9.70, "max": 8.66, "min": 10.36, "cnt": 32}, "MoE_L1_bwd":{"total": 312.88, "avg": 9.78, "max": 9.13, "min": 10.12, "cnt": 32}, "MoE_L0_bwd":{"total": 276.77, "avg": 8.65, "max": 8.08, "min": 8.99, "cnt": 32}, "backward-send-forward-recv":{"total": 271.76, "avg": 9.37, "max": 1.97, "min": 61.57, "cnt": 29}, "backward-send":{"total": 2.74, "avg": 0.91, "max": 0.70, "min": 1.13, "cnt": 3}, "backward-recv":{"total": 150.18, "avg": 75.09, "max": 74.22, "min": 75.96, "cnt": 2}, "backward-params-all-reduce":{"total": 484.11, "avg": 484.11, "max": 484.11, "min": 484.11, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 246.67, "avg": 246.67, "max": 246.67, "min": 246.67, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 206.96, "avg": 206.96, "max": 206.96, "min": 206.96, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.25, "avg": 3.25, "max": 3.25, "min": 3.25, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 178, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.06, "avg": 0.06, "max": 0.06, "min": 0.06, "cnt": 1}, "forward-recv":{"total": 69.43, "avg": 23.14, "max": 1.08, "min": 67.19, "cnt": 3}, "forward-compute":{"total": 1824.60, "avg": 57.02, "max": 50.15, "min": 62.46, "cnt": 32}, "fwd-compute":{"total": 1821.18, "avg": 56.91, "max": 50.07, "min": 62.32, "cnt": 32}, "batch-generator":{"total": 45.37, "avg": 1.42, "max": 0.71, "min": 2.93, "cnt": 32}, "fwd-embedding":{"total": 0.77, "avg": 0.02, "max": 0.01, "min": 0.09, "cnt": 32}, "fwd-encoder":{"total": 1762.24, "avg": 55.07, "max": 48.98, "min": 60.13, "cnt": 32}, "fwd-layernorm":{"total": 10.97, "avg": 0.09, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 115.57, "avg": 0.90, "max": 0.74, "min": 2.16, "cnt": 128}, "fwd-misc":{"total": 22.90, "avg": 0.18, "max": 0.11, "min": 0.41, "cnt": 128}, "fwd-MLP":{"total": 1590.21, "avg": 12.42, "max": 10.12, "min": 17.56, "cnt": 128}, "MoE_L0_fwd":{"total": 475.14, "avg": 14.85, "max": 10.99, "min": 17.47, "cnt": 32}, "MoEMLP":{"total": 1571.60, "avg": 12.28, "max": 10.01, "min": 17.41, "cnt": 128}, "MoE_L1_fwd":{"total": 405.36, "avg": 12.67, "max": 11.59, "min": 15.92, "cnt": 32}, "MoE_L2_fwd":{"total": 343.64, "avg": 10.74, "max": 10.05, "min": 13.76, "cnt": 32}, "MoE_L3_fwd":{"total": 354.26, "avg": 11.07, "max": 10.38, "min": 13.90, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.61, "avg": 0.02, "max": 0.02, "min": 0.04, "cnt": 32}, "forward-send":{"total": 1.76, "avg": 0.88, "max": 0.84, "min": 0.92, "cnt": 2}, "forward-send-backward-recv":{"total": 504.17, "avg": 16.81, "max": 1.94, "min": 126.51, "cnt": 30}, "backward-compute":{"total": 1469.77, "avg": 45.93, "max": 44.58, "min": 47.22, "cnt": 32}, "MoE_L3_bwd":{"total": 350.70, "avg": 10.96, "max": 9.58, "min": 11.65, "cnt": 32}, "MoE_L2_bwd":{"total": 308.96, "avg": 9.66, "max": 8.98, "min": 10.53, "cnt": 32}, "MoE_L1_bwd":{"total": 313.56, "avg": 9.80, "max": 9.14, "min": 10.11, "cnt": 32}, "MoE_L0_bwd":{"total": 279.03, "avg": 8.72, "max": 8.16, "min": 8.96, "cnt": 32}, "backward-send-forward-recv":{"total": 3024.49, "avg": 104.29, "max": 1.88, "min": 860.05, "cnt": 29}, "backward-send":{"total": 2.82, "avg": 0.94, "max": 0.80, "min": 1.03, "cnt": 3}, "backward-recv":{"total": 139.57, "avg": 69.78, "max": 63.39, "min": 76.17, "cnt": 2}, "backward-params-all-reduce":{"total": 492.92, "avg": 492.92, "max": 492.92, "min": 492.92, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 245.71, "avg": 245.71, "max": 245.71, "min": 245.71, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.36, "avg": 3.36, "max": 3.36, "min": 3.36, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 205.90, "avg": 205.90, "max": 205.90, "min": 205.90, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.33, "avg": 3.33, "max": 3.33, "min": 3.33, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 179, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 60.30, "avg": 20.10, "max": 0.85, "min": 58.00, "cnt": 3}, "forward-compute":{"total": 1791.70, "avg": 55.99, "max": 47.78, "min": 59.81, "cnt": 32}, "fwd-compute":{"total": 1788.39, "avg": 55.89, "max": 47.71, "min": 59.67, "cnt": 32}, "batch-generator":{"total": 43.86, "avg": 1.37, "max": 0.63, "min": 2.57, "cnt": 32}, "fwd-embedding":{"total": 0.68, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1731.93, "avg": 54.12, "max": 46.76, "min": 58.09, "cnt": 32}, "fwd-layernorm":{"total": 10.21, "avg": 0.08, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 111.34, "avg": 0.87, "max": 0.74, "min": 1.49, "cnt": 128}, "fwd-misc":{"total": 21.69, "avg": 0.17, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1567.02, "avg": 12.24, "max": 10.24, "min": 18.52, "cnt": 128}, "MoE_L0_fwd":{"total": 464.42, "avg": 14.51, "max": 10.43, "min": 18.40, "cnt": 32}, "MoEMLP":{"total": 1549.26, "avg": 12.10, "max": 10.13, "min": 18.35, "cnt": 128}, "MoE_L1_fwd":{"total": 395.16, "avg": 12.35, "max": 10.71, "min": 15.49, "cnt": 32}, "MoE_L2_fwd":{"total": 342.61, "avg": 10.71, "max": 10.17, "min": 11.53, "cnt": 32}, "MoE_L3_fwd":{"total": 353.46, "avg": 11.05, "max": 10.34, "min": 15.03, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 5.33, "avg": 2.66, "max": 0.87, "min": 4.45, "cnt": 2}, "forward-send-backward-recv":{"total": 561.11, "avg": 18.70, "max": 1.83, "min": 170.01, "cnt": 30}, "backward-compute":{"total": 1481.12, "avg": 46.28, "max": 43.77, "min": 48.59, "cnt": 32}, "MoE_L3_bwd":{"total": 354.62, "avg": 11.08, "max": 10.34, "min": 13.46, "cnt": 32}, "MoE_L2_bwd":{"total": 310.85, "avg": 9.71, "max": 8.99, "min": 11.42, "cnt": 32}, "MoE_L1_bwd":{"total": 318.64, "avg": 9.96, "max": 9.28, "min": 11.38, "cnt": 32}, "MoE_L0_bwd":{"total": 278.40, "avg": 8.70, "max": 8.14, "min": 8.97, "cnt": 32}, "backward-send-forward-recv":{"total": 979.23, "avg": 33.77, "max": 2.02, "min": 173.71, "cnt": 29}, "backward-send":{"total": 2.95, "avg": 0.98, "max": 0.71, "min": 1.12, "cnt": 3}, "backward-recv":{"total": 148.43, "avg": 74.22, "max": 73.07, "min": 75.36, "cnt": 2}, "backward-params-all-reduce":{"total": 486.64, "avg": 486.64, "max": 486.64, "min": 486.64, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 244.00, "avg": 244.00, "max": 244.00, "min": 244.00, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 204.01, "avg": 204.01, "max": 204.01, "min": 204.01, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.53, "avg": 3.53, "max": 3.53, "min": 3.53, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 180, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 75.74, "avg": 25.25, "max": 1.00, "min": 73.47, "cnt": 3}, "forward-compute":{"total": 1929.82, "avg": 60.31, "max": 50.65, "min": 206.52, "cnt": 32}, "fwd-compute":{"total": 1926.43, "avg": 60.20, "max": 50.58, "min": 206.44, "cnt": 32}, "batch-generator":{"total": 44.21, "avg": 1.38, "max": 0.78, "min": 2.25, "cnt": 32}, "fwd-embedding":{"total": 0.74, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1868.51, "avg": 58.39, "max": 48.70, "min": 205.30, "cnt": 32}, "fwd-layernorm":{"total": 10.78, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 113.13, "avg": 0.88, "max": 0.74, "min": 1.56, "cnt": 128}, "fwd-misc":{"total": 22.82, "avg": 0.18, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1699.26, "avg": 13.28, "max": 10.14, "min": 158.46, "cnt": 128}, "MoE_L0_fwd":{"total": 464.31, "avg": 14.51, "max": 12.00, "min": 18.10, "cnt": 32}, "MoEMLP":{"total": 1681.14, "avg": 13.13, "max": 10.03, "min": 158.34, "cnt": 128}, "MoE_L1_fwd":{"total": 509.97, "avg": 15.94, "max": 10.07, "min": 158.39, "cnt": 32}, "MoE_L2_fwd":{"total": 353.44, "avg": 11.05, "max": 10.22, "min": 14.31, "cnt": 32}, "MoE_L3_fwd":{"total": 359.95, "avg": 11.25, "max": 10.42, "min": 13.35, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 9.99, "avg": 4.99, "max": 0.97, "min": 9.02, "cnt": 2}, "forward-send-backward-recv":{"total": 469.90, "avg": 15.66, "max": 1.65, "min": 112.83, "cnt": 30}, "backward-compute":{"total": 1433.44, "avg": 44.79, "max": 43.30, "min": 46.15, "cnt": 32}, "MoE_L3_bwd":{"total": 352.56, "avg": 11.02, "max": 10.22, "min": 12.99, "cnt": 32}, "MoE_L2_bwd":{"total": 315.39, "avg": 9.86, "max": 9.15, "min": 10.41, "cnt": 32}, "MoE_L1_bwd":{"total": 267.87, "avg": 8.37, "max": 7.90, "min": 9.27, "cnt": 32}, "MoE_L0_bwd":{"total": 279.93, "avg": 8.75, "max": 8.24, "min": 9.43, "cnt": 32}, "backward-send-forward-recv":{"total": 869.51, "avg": 29.98, "max": 1.83, "min": 145.06, "cnt": 29}, "backward-send":{"total": 3.03, "avg": 1.01, "max": 0.81, "min": 1.17, "cnt": 3}, "backward-recv":{"total": 146.00, "avg": 73.00, "max": 72.12, "min": 73.88, "cnt": 2}, "backward-params-all-reduce":{"total": 486.55, "avg": 486.55, "max": 486.55, "min": 486.55, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 252.04, "avg": 252.04, "max": 252.04, "min": 252.04, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 212.23, "avg": 212.23, "max": 212.23, "min": 212.23, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.27, "avg": 3.27, "max": 3.27, "min": 3.27, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.48, "avg": 3.48, "max": 3.48, "min": 3.48, "cnt": 1}}}
{"type":"time", "iteration": 181, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 61.51, "avg": 20.50, "max": 1.37, "min": 58.64, "cnt": 3}, "forward-compute":{"total": 1757.94, "avg": 54.94, "max": 47.79, "min": 60.94, "cnt": 32}, "fwd-compute":{"total": 1754.77, "avg": 54.84, "max": 47.72, "min": 60.84, "cnt": 32}, "batch-generator":{"total": 40.43, "avg": 1.26, "max": 0.71, "min": 2.05, "cnt": 32}, "fwd-embedding":{"total": 0.74, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1701.65, "avg": 53.18, "max": 46.65, "min": 59.62, "cnt": 32}, "fwd-layernorm":{"total": 10.07, "avg": 0.08, "max": 0.06, "min": 0.18, "cnt": 128}, "fwd-attn":{"total": 110.68, "avg": 0.86, "max": 0.74, "min": 2.20, "cnt": 128}, "fwd-misc":{"total": 21.66, "avg": 0.17, "max": 0.11, "min": 0.49, "cnt": 128}, "fwd-MLP":{"total": 1537.82, "avg": 12.01, "max": 10.08, "min": 20.21, "cnt": 128}, "MoE_L0_fwd":{"total": 465.62, "avg": 14.55, "max": 10.46, "min": 20.13, "cnt": 32}, "MoEMLP":{"total": 1520.47, "avg": 11.88, "max": 9.96, "min": 20.08, "cnt": 128}, "MoE_L1_fwd":{"total": 359.12, "avg": 11.22, "max": 10.00, "min": 13.29, "cnt": 32}, "MoE_L2_fwd":{"total": 342.83, "avg": 10.71, "max": 10.06, "min": 11.90, "cnt": 32}, "MoE_L3_fwd":{"total": 359.28, "avg": 11.23, "max": 10.38, "min": 14.11, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 7.71, "avg": 3.85, "max": 1.03, "min": 6.68, "cnt": 2}, "forward-send-backward-recv":{"total": 453.01, "avg": 15.10, "max": 1.81, "min": 116.58, "cnt": 30}, "backward-compute":{"total": 1437.54, "avg": 44.92, "max": 43.53, "min": 46.59, "cnt": 32}, "MoE_L3_bwd":{"total": 363.25, "avg": 11.35, "max": 10.41, "min": 12.38, "cnt": 32}, "MoE_L2_bwd":{"total": 312.96, "avg": 9.78, "max": 9.23, "min": 11.31, "cnt": 32}, "MoE_L1_bwd":{"total": 265.94, "avg": 8.31, "max": 7.73, "min": 8.85, "cnt": 32}, "MoE_L0_bwd":{"total": 279.04, "avg": 8.72, "max": 8.09, "min": 9.21, "cnt": 32}, "backward-send-forward-recv":{"total": 1672.25, "avg": 57.66, "max": 2.01, "min": 430.13, "cnt": 29}, "backward-send":{"total": 3.36, "avg": 1.12, "max": 1.05, "min": 1.23, "cnt": 3}, "backward-recv":{"total": 196.06, "avg": 98.03, "max": 70.03, "min": 126.03, "cnt": 2}, "backward-params-all-reduce":{"total": 485.13, "avg": 485.13, "max": 485.13, "min": 485.13, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.04, "avg": 0.04, "max": 0.04, "min": 0.04, "cnt": 1}, "optimizer":{"total": 248.16, "avg": 248.16, "max": 248.16, "min": 248.16, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 208.44, "avg": 208.44, "max": 208.44, "min": 208.44, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.26, "avg": 3.26, "max": 3.26, "min": 3.26, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 182, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 59.49, "avg": 19.83, "max": 1.46, "min": 52.50, "cnt": 3}, "forward-compute":{"total": 1751.92, "avg": 54.75, "max": 47.97, "min": 61.87, "cnt": 32}, "fwd-compute":{"total": 1748.44, "avg": 54.64, "max": 47.90, "min": 61.78, "cnt": 32}, "batch-generator":{"total": 41.61, "avg": 1.30, "max": 0.66, "min": 1.79, "cnt": 32}, "fwd-embedding":{"total": 0.70, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1693.39, "avg": 52.92, "max": 46.88, "min": 60.50, "cnt": 32}, "fwd-layernorm":{"total": 10.46, "avg": 0.08, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 111.25, "avg": 0.87, "max": 0.74, "min": 1.52, "cnt": 128}, "fwd-misc":{"total": 22.50, "avg": 0.18, "max": 0.12, "min": 0.38, "cnt": 128}, "fwd-MLP":{"total": 1527.14, "avg": 11.93, "max": 9.86, "min": 18.21, "cnt": 128}, "MoE_L0_fwd":{"total": 450.67, "avg": 14.08, "max": 10.68, "min": 18.10, "cnt": 32}, "MoEMLP":{"total": 1509.27, "avg": 11.79, "max": 9.73, "min": 18.05, "cnt": 128}, "MoE_L1_fwd":{"total": 362.86, "avg": 11.34, "max": 9.78, "min": 15.40, "cnt": 32}, "MoE_L2_fwd":{"total": 347.05, "avg": 10.85, "max": 10.16, "min": 13.76, "cnt": 32}, "MoE_L3_fwd":{"total": 355.14, "avg": 11.10, "max": 10.39, "min": 12.26, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.94, "avg": 0.97, "max": 0.95, "min": 0.99, "cnt": 2}, "forward-send-backward-recv":{"total": 332.34, "avg": 11.08, "max": 1.85, "min": 117.67, "cnt": 30}, "backward-compute":{"total": 1435.54, "avg": 44.86, "max": 42.95, "min": 47.04, "cnt": 32}, "MoE_L3_bwd":{"total": 352.59, "avg": 11.02, "max": 9.67, "min": 12.45, "cnt": 32}, "MoE_L2_bwd":{"total": 318.56, "avg": 9.96, "max": 9.31, "min": 10.91, "cnt": 32}, "MoE_L1_bwd":{"total": 266.99, "avg": 8.34, "max": 7.73, "min": 8.90, "cnt": 32}, "MoE_L0_bwd":{"total": 280.93, "avg": 8.78, "max": 8.30, "min": 11.64, "cnt": 32}, "backward-send-forward-recv":{"total": 1491.84, "avg": 51.44, "max": 2.38, "min": 284.97, "cnt": 29}, "backward-send":{"total": 2.97, "avg": 0.99, "max": 0.90, "min": 1.04, "cnt": 3}, "backward-recv":{"total": 158.09, "avg": 79.04, "max": 76.66, "min": 81.42, "cnt": 2}, "backward-params-all-reduce":{"total": 482.36, "avg": 482.36, "max": 482.36, "min": 482.36, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 249.43, "avg": 249.43, "max": 249.43, "min": 249.43, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 209.37, "avg": 209.37, "max": 209.37, "min": 209.37, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.47, "avg": 3.47, "max": 3.47, "min": 3.47, "cnt": 1}}}
{"type":"time", "iteration": 183, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 72.28, "avg": 24.09, "max": 0.77, "min": 70.12, "cnt": 3}, "forward-compute":{"total": 1739.12, "avg": 54.35, "max": 48.10, "min": 59.36, "cnt": 32}, "fwd-compute":{"total": 1735.83, "avg": 54.24, "max": 48.02, "min": 59.22, "cnt": 32}, "batch-generator":{"total": 41.19, "avg": 1.29, "max": 0.74, "min": 2.19, "cnt": 32}, "fwd-embedding":{"total": 0.61, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1682.46, "avg": 52.58, "max": 46.94, "min": 57.75, "cnt": 32}, "fwd-layernorm":{"total": 9.94, "avg": 0.08, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 110.83, "avg": 0.87, "max": 0.74, "min": 1.47, "cnt": 128}, "fwd-misc":{"total": 21.75, "avg": 0.17, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1518.30, "avg": 11.86, "max": 9.65, "min": 19.18, "cnt": 128}, "MoE_L0_fwd":{"total": 452.93, "avg": 14.15, "max": 10.47, "min": 19.09, "cnt": 32}, "MoEMLP":{"total": 1500.80, "avg": 11.72, "max": 9.52, "min": 19.04, "cnt": 128}, "MoE_L1_fwd":{"total": 352.28, "avg": 11.01, "max": 9.57, "min": 15.53, "cnt": 32}, "MoE_L2_fwd":{"total": 349.71, "avg": 10.93, "max": 10.25, "min": 12.42, "cnt": 32}, "MoE_L3_fwd":{"total": 352.20, "avg": 11.01, "max": 10.33, "min": 11.67, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 8.11, "avg": 4.06, "max": 0.95, "min": 7.17, "cnt": 2}, "forward-send-backward-recv":{"total": 242.03, "avg": 8.07, "max": 1.77, "min": 114.41, "cnt": 30}, "backward-compute":{"total": 1437.21, "avg": 44.91, "max": 42.74, "min": 46.92, "cnt": 32}, "MoE_L3_bwd":{"total": 351.31, "avg": 10.98, "max": 10.20, "min": 12.57, "cnt": 32}, "MoE_L2_bwd":{"total": 330.06, "avg": 10.31, "max": 9.57, "min": 11.21, "cnt": 32}, "MoE_L1_bwd":{"total": 266.27, "avg": 8.32, "max": 7.84, "min": 8.85, "cnt": 32}, "MoE_L0_bwd":{"total": 280.53, "avg": 8.77, "max": 8.14, "min": 10.79, "cnt": 32}, "backward-send-forward-recv":{"total": 2598.45, "avg": 89.60, "max": 2.34, "min": 530.38, "cnt": 29}, "backward-send":{"total": 2.98, "avg": 0.99, "max": 0.78, "min": 1.19, "cnt": 3}, "backward-recv":{"total": 161.26, "avg": 80.63, "max": 76.81, "min": 84.45, "cnt": 2}, "backward-params-all-reduce":{"total": 483.13, "avg": 483.13, "max": 483.13, "min": 483.13, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 255.79, "avg": 255.79, "max": 255.79, "min": 255.79, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 215.97, "avg": 215.97, "max": 215.97, "min": 215.97, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.33, "avg": 3.33, "max": 3.33, "min": 3.33, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.48, "avg": 3.48, "max": 3.48, "min": 3.48, "cnt": 1}}}
{"type":"time", "iteration": 184, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 54.91, "avg": 18.30, "max": 1.10, "min": 52.52, "cnt": 3}, "forward-compute":{"total": 1797.32, "avg": 56.17, "max": 47.48, "min": 64.82, "cnt": 32}, "fwd-compute":{"total": 1793.90, "avg": 56.06, "max": 47.41, "min": 64.69, "cnt": 32}, "batch-generator":{"total": 43.04, "avg": 1.35, "max": 0.66, "min": 2.78, "cnt": 32}, "fwd-embedding":{"total": 0.71, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1737.66, "avg": 54.30, "max": 46.46, "min": 63.17, "cnt": 32}, "fwd-layernorm":{"total": 10.54, "avg": 0.08, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 113.97, "avg": 0.89, "max": 0.74, "min": 1.50, "cnt": 128}, "fwd-misc":{"total": 22.52, "avg": 0.18, "max": 0.11, "min": 0.44, "cnt": 128}, "fwd-MLP":{"total": 1568.33, "avg": 12.25, "max": 10.03, "min": 18.35, "cnt": 128}, "MoE_L0_fwd":{"total": 467.57, "avg": 14.61, "max": 10.19, "min": 18.28, "cnt": 32}, "MoEMLP":{"total": 1550.36, "avg": 12.11, "max": 9.91, "min": 18.23, "cnt": 128}, "MoE_L1_fwd":{"total": 367.77, "avg": 11.49, "max": 9.96, "min": 14.57, "cnt": 32}, "MoE_L2_fwd":{"total": 360.88, "avg": 11.28, "max": 9.96, "min": 15.80, "cnt": 32}, "MoE_L3_fwd":{"total": 360.61, "avg": 11.27, "max": 10.27, "min": 14.50, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 4.20, "avg": 2.10, "max": 0.94, "min": 3.26, "cnt": 2}, "forward-send-backward-recv":{"total": 618.10, "avg": 20.60, "max": 1.49, "min": 133.29, "cnt": 30}, "backward-compute":{"total": 1443.62, "avg": 45.11, "max": 43.87, "min": 46.69, "cnt": 32}, "MoE_L3_bwd":{"total": 361.60, "avg": 11.30, "max": 10.33, "min": 12.97, "cnt": 32}, "MoE_L2_bwd":{"total": 316.60, "avg": 9.89, "max": 9.28, "min": 10.83, "cnt": 32}, "MoE_L1_bwd":{"total": 267.91, "avg": 8.37, "max": 7.81, "min": 9.04, "cnt": 32}, "MoE_L0_bwd":{"total": 280.12, "avg": 8.75, "max": 8.19, "min": 10.19, "cnt": 32}, "backward-send-forward-recv":{"total": 520.79, "avg": 17.96, "max": 1.58, "min": 100.47, "cnt": 29}, "backward-send":{"total": 3.11, "avg": 1.04, "max": 0.92, "min": 1.11, "cnt": 3}, "backward-recv":{"total": 254.11, "avg": 127.05, "max": 74.87, "min": 179.24, "cnt": 2}, "backward-params-all-reduce":{"total": 486.91, "avg": 486.91, "max": 486.91, "min": 486.91, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 248.89, "avg": 248.89, "max": 248.89, "min": 248.89, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 208.91, "avg": 208.91, "max": 208.91, "min": 208.91, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.22, "avg": 3.22, "max": 3.22, "min": 3.22, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.57, "avg": 3.57, "max": 3.57, "min": 3.57, "cnt": 1}}}
{"type":"time", "iteration": 185, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 68.38, "avg": 22.79, "max": 1.30, "min": 65.75, "cnt": 3}, "forward-compute":{"total": 1790.05, "avg": 55.94, "max": 49.35, "min": 64.47, "cnt": 32}, "fwd-compute":{"total": 1786.70, "avg": 55.83, "max": 49.27, "min": 64.33, "cnt": 32}, "batch-generator":{"total": 43.03, "avg": 1.34, "max": 0.64, "min": 3.34, "cnt": 32}, "fwd-embedding":{"total": 0.68, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1731.44, "avg": 54.11, "max": 47.93, "min": 62.34, "cnt": 32}, "fwd-layernorm":{"total": 10.20, "avg": 0.08, "max": 0.06, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 109.42, "avg": 0.85, "max": 0.74, "min": 1.65, "cnt": 128}, "fwd-misc":{"total": 21.57, "avg": 0.17, "max": 0.11, "min": 0.46, "cnt": 128}, "fwd-MLP":{"total": 1569.19, "avg": 12.26, "max": 10.05, "min": 21.21, "cnt": 128}, "MoE_L0_fwd":{"total": 475.76, "avg": 14.87, "max": 10.47, "min": 21.13, "cnt": 32}, "MoEMLP":{"total": 1551.93, "avg": 12.12, "max": 9.94, "min": 21.09, "cnt": 128}, "MoE_L1_fwd":{"total": 374.89, "avg": 11.72, "max": 9.98, "min": 16.99, "cnt": 32}, "MoE_L2_fwd":{"total": 349.09, "avg": 10.91, "max": 10.24, "min": 12.76, "cnt": 32}, "MoE_L3_fwd":{"total": 358.55, "avg": 11.20, "max": 10.53, "min": 12.23, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.99, "avg": 0.99, "max": 0.97, "min": 1.02, "cnt": 2}, "forward-send-backward-recv":{"total": 1307.03, "avg": 43.57, "max": 1.84, "min": 180.40, "cnt": 30}, "backward-compute":{"total": 1446.23, "avg": 45.19, "max": 43.76, "min": 47.05, "cnt": 32}, "MoE_L3_bwd":{"total": 364.04, "avg": 11.38, "max": 10.73, "min": 12.40, "cnt": 32}, "MoE_L2_bwd":{"total": 322.57, "avg": 10.08, "max": 9.16, "min": 11.25, "cnt": 32}, "MoE_L1_bwd":{"total": 268.08, "avg": 8.38, "max": 7.42, "min": 9.65, "cnt": 32}, "MoE_L0_bwd":{"total": 274.65, "avg": 8.58, "max": 8.05, "min": 8.85, "cnt": 32}, "backward-send-forward-recv":{"total": 705.66, "avg": 24.33, "max": 1.54, "min": 271.14, "cnt": 29}, "backward-send":{"total": 2.48, "avg": 0.83, "max": 0.65, "min": 0.95, "cnt": 3}, "backward-recv":{"total": 179.08, "avg": 89.54, "max": 85.05, "min": 94.03, "cnt": 2}, "backward-params-all-reduce":{"total": 484.25, "avg": 484.25, "max": 484.25, "min": 484.25, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 243.09, "avg": 243.09, "max": 243.09, "min": 243.09, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 203.32, "avg": 203.32, "max": 203.32, "min": 203.32, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.24, "avg": 3.24, "max": 3.24, "min": 3.24, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.49, "avg": 3.49, "max": 3.49, "min": 3.49, "cnt": 1}}}
{"type":"time", "iteration": 186, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 59.32, "avg": 19.77, "max": 1.01, "min": 57.06, "cnt": 3}, "forward-compute":{"total": 1890.07, "avg": 59.06, "max": 47.91, "min": 135.64, "cnt": 32}, "fwd-compute":{"total": 1886.48, "avg": 58.95, "max": 47.84, "min": 135.51, "cnt": 32}, "batch-generator":{"total": 46.86, "avg": 1.46, "max": 0.70, "min": 4.43, "cnt": 32}, "fwd-embedding":{"total": 0.86, "avg": 0.03, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1825.60, "avg": 57.05, "max": 46.83, "min": 133.37, "cnt": 32}, "fwd-layernorm":{"total": 11.54, "avg": 0.09, "max": 0.05, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 119.66, "avg": 0.93, "max": 0.74, "min": 2.09, "cnt": 128}, "fwd-misc":{"total": 24.18, "avg": 0.19, "max": 0.11, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1646.12, "avg": 12.86, "max": 10.02, "min": 89.25, "cnt": 128}, "MoE_L0_fwd":{"total": 474.31, "avg": 14.82, "max": 10.65, "min": 17.90, "cnt": 32}, "MoEMLP":{"total": 1626.67, "avg": 12.71, "max": 9.90, "min": 89.06, "cnt": 128}, "MoE_L1_fwd":{"total": 441.53, "avg": 13.80, "max": 9.95, "min": 89.12, "cnt": 32}, "MoE_L2_fwd":{"total": 358.28, "avg": 11.20, "max": 10.51, "min": 14.94, "cnt": 32}, "MoE_L3_fwd":{"total": 359.59, "avg": 11.24, "max": 10.28, "min": 15.69, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 8.33, "avg": 4.17, "max": 0.91, "min": 7.42, "cnt": 2}, "forward-send-backward-recv":{"total": 893.54, "avg": 29.78, "max": 1.72, "min": 239.45, "cnt": 30}, "backward-compute":{"total": 1453.68, "avg": 45.43, "max": 44.02, "min": 47.14, "cnt": 32}, "MoE_L3_bwd":{"total": 358.89, "avg": 11.22, "max": 10.58, "min": 12.43, "cnt": 32}, "MoE_L2_bwd":{"total": 326.96, "avg": 10.22, "max": 9.51, "min": 11.06, "cnt": 32}, "MoE_L1_bwd":{"total": 271.00, "avg": 8.47, "max": 8.01, "min": 9.46, "cnt": 32}, "MoE_L0_bwd":{"total": 280.66, "avg": 8.77, "max": 8.16, "min": 10.37, "cnt": 32}, "backward-send-forward-recv":{"total": 331.25, "avg": 11.42, "max": 1.87, "min": 103.14, "cnt": 29}, "backward-send":{"total": 3.15, "avg": 1.05, "max": 1.02, "min": 1.07, "cnt": 3}, "backward-recv":{"total": 149.06, "avg": 74.53, "max": 73.66, "min": 75.40, "cnt": 2}, "backward-params-all-reduce":{"total": 485.48, "avg": 485.48, "max": 485.48, "min": 485.48, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 243.92, "avg": 243.92, "max": 243.92, "min": 243.92, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 204.19, "avg": 204.19, "max": 204.19, "min": 204.19, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.31, "avg": 3.31, "max": 3.31, "min": 3.31, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 187, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 56.82, "avg": 18.94, "max": 0.96, "min": 54.74, "cnt": 3}, "forward-compute":{"total": 1844.49, "avg": 57.64, "max": 48.60, "min": 67.11, "cnt": 32}, "fwd-compute":{"total": 1840.82, "avg": 57.53, "max": 48.53, "min": 66.94, "cnt": 32}, "batch-generator":{"total": 43.13, "avg": 1.35, "max": 0.70, "min": 2.18, "cnt": 32}, "fwd-embedding":{"total": 0.87, "avg": 0.03, "max": 0.01, "min": 0.06, "cnt": 32}, "fwd-encoder":{"total": 1784.12, "avg": 55.75, "max": 47.54, "min": 64.87, "cnt": 32}, "fwd-layernorm":{"total": 11.23, "avg": 0.09, "max": 0.05, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 115.78, "avg": 0.90, "max": 0.74, "min": 1.49, "cnt": 128}, "fwd-misc":{"total": 23.48, "avg": 0.18, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1610.50, "avg": 12.58, "max": 10.44, "min": 22.12, "cnt": 128}, "MoE_L0_fwd":{"total": 492.60, "avg": 15.39, "max": 10.39, "min": 21.97, "cnt": 32}, "MoEMLP":{"total": 1591.46, "avg": 12.43, "max": 10.34, "min": 21.89, "cnt": 128}, "MoE_L1_fwd":{"total": 381.55, "avg": 11.92, "max": 10.42, "min": 18.95, "cnt": 32}, "MoE_L2_fwd":{"total": 362.20, "avg": 11.32, "max": 10.43, "min": 13.84, "cnt": 32}, "MoE_L3_fwd":{"total": 361.95, "avg": 11.31, "max": 10.38, "min": 12.32, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 6.13, "avg": 3.07, "max": 0.81, "min": 5.33, "cnt": 2}, "forward-send-backward-recv":{"total": 735.09, "avg": 24.50, "max": 1.49, "min": 131.55, "cnt": 30}, "backward-compute":{"total": 1458.34, "avg": 45.57, "max": 43.90, "min": 47.05, "cnt": 32}, "MoE_L3_bwd":{"total": 358.86, "avg": 11.21, "max": 10.59, "min": 12.40, "cnt": 32}, "MoE_L2_bwd":{"total": 326.45, "avg": 10.20, "max": 9.52, "min": 10.72, "cnt": 32}, "MoE_L1_bwd":{"total": 277.54, "avg": 8.67, "max": 8.17, "min": 9.03, "cnt": 32}, "MoE_L0_bwd":{"total": 279.01, "avg": 8.72, "max": 8.43, "min": 9.14, "cnt": 32}, "backward-send-forward-recv":{"total": 68.50, "avg": 2.36, "max": 1.45, "min": 6.44, "cnt": 29}, "backward-send":{"total": 2.59, "avg": 0.86, "max": 0.68, "min": 1.00, "cnt": 3}, "backward-recv":{"total": 371.84, "avg": 185.92, "max": 72.63, "min": 299.21, "cnt": 2}, "backward-params-all-reduce":{"total": 484.31, "avg": 484.31, "max": 484.31, "min": 484.31, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 248.01, "avg": 248.01, "max": 248.01, "min": 248.01, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 208.15, "avg": 208.15, "max": 208.15, "min": 208.15, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.35, "avg": 3.35, "max": 3.35, "min": 3.35, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 188, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 58.57, "avg": 19.52, "max": 0.79, "min": 56.54, "cnt": 3}, "forward-compute":{"total": 1798.21, "avg": 56.19, "max": 47.64, "min": 59.94, "cnt": 32}, "fwd-compute":{"total": 1794.47, "avg": 56.08, "max": 47.56, "min": 59.81, "cnt": 32}, "batch-generator":{"total": 45.84, "avg": 1.43, "max": 0.67, "min": 2.66, "cnt": 32}, "fwd-embedding":{"total": 0.81, "avg": 0.03, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1734.66, "avg": 54.21, "max": 46.58, "min": 57.76, "cnt": 32}, "fwd-layernorm":{"total": 11.62, "avg": 0.09, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 120.15, "avg": 0.94, "max": 0.74, "min": 3.29, "cnt": 128}, "fwd-misc":{"total": 23.97, "avg": 0.19, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1555.03, "avg": 12.15, "max": 10.02, "min": 18.18, "cnt": 128}, "MoE_L0_fwd":{"total": 452.66, "avg": 14.15, "max": 10.67, "min": 18.05, "cnt": 32}, "MoEMLP":{"total": 1535.29, "avg": 11.99, "max": 9.90, "min": 17.97, "cnt": 128}, "MoE_L1_fwd":{"total": 366.67, "avg": 11.46, "max": 9.95, "min": 14.46, "cnt": 32}, "MoE_L2_fwd":{"total": 361.96, "avg": 11.31, "max": 10.42, "min": 16.52, "cnt": 32}, "MoE_L3_fwd":{"total": 361.02, "avg": 11.28, "max": 10.32, "min": 14.25, "cnt": 32}, "fwd-pooler":{"total": 0.36, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.04, "cnt": 32}, "forward-send":{"total": 14.25, "avg": 7.12, "max": 0.95, "min": 13.30, "cnt": 2}, "forward-send-backward-recv":{"total": 536.12, "avg": 17.87, "max": 1.76, "min": 112.57, "cnt": 30}, "backward-compute":{"total": 1467.46, "avg": 45.86, "max": 44.19, "min": 48.60, "cnt": 32}, "MoE_L3_bwd":{"total": 358.58, "avg": 11.21, "max": 10.27, "min": 11.95, "cnt": 32}, "MoE_L2_bwd":{"total": 338.04, "avg": 10.56, "max": 9.74, "min": 12.76, "cnt": 32}, "MoE_L1_bwd":{"total": 273.24, "avg": 8.54, "max": 7.76, "min": 8.93, "cnt": 32}, "MoE_L0_bwd":{"total": 281.73, "avg": 8.80, "max": 8.24, "min": 10.39, "cnt": 32}, "backward-send-forward-recv":{"total": 507.19, "avg": 17.49, "max": 1.77, "min": 197.73, "cnt": 29}, "backward-send":{"total": 3.36, "avg": 1.12, "max": 1.10, "min": 1.15, "cnt": 3}, "backward-recv":{"total": 281.69, "avg": 140.85, "max": 120.86, "min": 160.84, "cnt": 2}, "backward-params-all-reduce":{"total": 482.78, "avg": 482.78, "max": 482.78, "min": 482.78, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 245.70, "avg": 245.70, "max": 245.70, "min": 245.70, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 205.94, "avg": 205.94, "max": 205.94, "min": 205.94, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.29, "avg": 3.29, "max": 3.29, "min": 3.29, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 189, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 58.01, "avg": 19.34, "max": 1.22, "min": 55.56, "cnt": 3}, "forward-compute":{"total": 1829.03, "avg": 57.16, "max": 50.87, "min": 63.13, "cnt": 32}, "fwd-compute":{"total": 1825.19, "avg": 57.04, "max": 50.80, "min": 63.06, "cnt": 32}, "batch-generator":{"total": 47.78, "avg": 1.49, "max": 0.66, "min": 2.15, "cnt": 32}, "fwd-embedding":{"total": 0.92, "avg": 0.03, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1762.64, "avg": 55.08, "max": 49.67, "min": 60.47, "cnt": 32}, "fwd-layernorm":{"total": 11.95, "avg": 0.09, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 120.73, "avg": 0.94, "max": 0.75, "min": 1.80, "cnt": 128}, "fwd-misc":{"total": 24.42, "avg": 0.19, "max": 0.11, "min": 0.38, "cnt": 128}, "fwd-MLP":{"total": 1581.13, "avg": 12.35, "max": 10.42, "min": 18.31, "cnt": 128}, "MoE_L0_fwd":{"total": 469.27, "avg": 14.66, "max": 10.91, "min": 18.23, "cnt": 32}, "MoEMLP":{"total": 1561.73, "avg": 12.20, "max": 10.30, "min": 18.19, "cnt": 128}, "MoE_L1_fwd":{"total": 381.52, "avg": 11.92, "max": 10.45, "min": 15.63, "cnt": 32}, "MoE_L2_fwd":{"total": 355.00, "avg": 11.09, "max": 10.34, "min": 13.39, "cnt": 32}, "MoE_L3_fwd":{"total": 362.96, "avg": 11.34, "max": 10.35, "min": 15.81, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.86, "avg": 0.93, "max": 0.92, "min": 0.95, "cnt": 2}, "forward-send-backward-recv":{"total": 1118.01, "avg": 37.27, "max": 1.70, "min": 555.88, "cnt": 30}, "backward-compute":{"total": 1451.40, "avg": 45.36, "max": 44.25, "min": 46.73, "cnt": 32}, "MoE_L3_bwd":{"total": 358.97, "avg": 11.22, "max": 10.26, "min": 12.19, "cnt": 32}, "MoE_L2_bwd":{"total": 324.29, "avg": 10.13, "max": 8.95, "min": 11.34, "cnt": 32}, "MoE_L1_bwd":{"total": 273.32, "avg": 8.54, "max": 8.09, "min": 9.25, "cnt": 32}, "MoE_L0_bwd":{"total": 281.03, "avg": 8.78, "max": 8.18, "min": 9.10, "cnt": 32}, "backward-send-forward-recv":{"total": 361.24, "avg": 12.46, "max": 1.82, "min": 161.72, "cnt": 29}, "backward-send":{"total": 3.03, "avg": 1.01, "max": 0.77, "min": 1.15, "cnt": 3}, "backward-recv":{"total": 148.53, "avg": 74.27, "max": 73.10, "min": 75.43, "cnt": 2}, "backward-params-all-reduce":{"total": 487.52, "avg": 487.52, "max": 487.52, "min": 487.52, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 245.20, "avg": 245.20, "max": 245.20, "min": 245.20, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 205.39, "avg": 205.39, "max": 205.39, "min": 205.39, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.29, "avg": 3.29, "max": 3.29, "min": 3.29, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 190, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 76.07, "avg": 25.36, "max": 0.92, "min": 74.15, "cnt": 3}, "forward-compute":{"total": 1885.29, "avg": 58.92, "max": 48.77, "min": 202.34, "cnt": 32}, "fwd-compute":{"total": 1881.94, "avg": 58.81, "max": 48.69, "min": 202.25, "cnt": 32}, "batch-generator":{"total": 45.20, "avg": 1.41, "max": 0.66, "min": 3.85, "cnt": 32}, "fwd-embedding":{"total": 0.67, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1823.78, "avg": 56.99, "max": 45.80, "min": 201.12, "cnt": 32}, "fwd-layernorm":{"total": 10.37, "avg": 0.08, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 110.85, "avg": 0.87, "max": 0.75, "min": 1.51, "cnt": 128}, "fwd-misc":{"total": 21.35, "avg": 0.17, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1659.49, "avg": 12.96, "max": 9.53, "min": 149.73, "cnt": 128}, "MoE_L0_fwd":{"total": 458.79, "avg": 14.34, "max": 10.73, "min": 17.85, "cnt": 32}, "MoEMLP":{"total": 1641.91, "avg": 12.83, "max": 9.43, "min": 149.62, "cnt": 128}, "MoE_L1_fwd":{"total": 368.49, "avg": 11.52, "max": 10.11, "min": 14.47, "cnt": 32}, "MoE_L2_fwd":{"total": 461.92, "avg": 14.44, "max": 9.47, "min": 149.66, "cnt": 32}, "MoE_L3_fwd":{"total": 359.02, "avg": 11.22, "max": 10.37, "min": 15.00, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 19.10, "avg": 9.55, "max": 0.83, "min": 18.27, "cnt": 2}, "forward-send-backward-recv":{"total": 919.26, "avg": 30.64, "max": 1.83, "min": 232.91, "cnt": 30}, "backward-compute":{"total": 1424.03, "avg": 44.50, "max": 42.68, "min": 46.51, "cnt": 32}, "MoE_L3_bwd":{"total": 363.01, "avg": 11.34, "max": 10.57, "min": 12.40, "cnt": 32}, "MoE_L2_bwd":{"total": 284.36, "avg": 8.89, "max": 8.19, "min": 10.59, "cnt": 32}, "MoE_L1_bwd":{"total": 274.37, "avg": 8.57, "max": 7.85, "min": 9.22, "cnt": 32}, "MoE_L0_bwd":{"total": 283.74, "avg": 8.87, "max": 8.56, "min": 9.28, "cnt": 32}, "backward-send-forward-recv":{"total": 2302.42, "avg": 79.39, "max": 1.82, "min": 382.36, "cnt": 29}, "backward-send":{"total": 3.06, "avg": 1.02, "max": 0.85, "min": 1.12, "cnt": 3}, "backward-recv":{"total": 149.46, "avg": 74.73, "max": 72.89, "min": 76.57, "cnt": 2}, "backward-params-all-reduce":{"total": 480.49, "avg": 480.49, "max": 480.49, "min": 480.49, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 249.42, "avg": 249.42, "max": 249.42, "min": 249.42, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 209.59, "avg": 209.59, "max": 209.59, "min": 209.59, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.30, "avg": 3.30, "max": 3.30, "min": 3.30, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.48, "avg": 3.48, "max": 3.48, "min": 3.48, "cnt": 1}}}
{"type":"time", "iteration": 191, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 57.44, "avg": 19.15, "max": 0.97, "min": 55.39, "cnt": 3}, "forward-compute":{"total": 1791.73, "avg": 55.99, "max": 48.94, "min": 65.68, "cnt": 32}, "fwd-compute":{"total": 1788.23, "avg": 55.88, "max": 48.87, "min": 65.53, "cnt": 32}, "batch-generator":{"total": 41.77, "avg": 1.31, "max": 0.67, "min": 2.50, "cnt": 32}, "fwd-embedding":{"total": 0.76, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1733.46, "avg": 54.17, "max": 47.83, "min": 63.27, "cnt": 32}, "fwd-layernorm":{"total": 10.69, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 114.57, "avg": 0.90, "max": 0.75, "min": 1.53, "cnt": 128}, "fwd-misc":{"total": 22.38, "avg": 0.17, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1563.26, "avg": 12.21, "max": 9.91, "min": 17.63, "cnt": 128}, "MoE_L0_fwd":{"total": 466.93, "avg": 14.59, "max": 11.16, "min": 17.51, "cnt": 32}, "MoEMLP":{"total": 1545.03, "avg": 12.07, "max": 9.79, "min": 17.45, "cnt": 128}, "MoE_L1_fwd":{"total": 380.00, "avg": 11.87, "max": 10.39, "min": 14.97, "cnt": 32}, "MoE_L2_fwd":{"total": 339.94, "avg": 10.62, "max": 9.84, "min": 14.61, "cnt": 32}, "MoE_L3_fwd":{"total": 364.74, "avg": 11.40, "max": 10.61, "min": 14.82, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 12.64, "avg": 6.32, "max": 0.78, "min": 11.86, "cnt": 2}, "forward-send-backward-recv":{"total": 541.84, "avg": 18.06, "max": 1.93, "min": 112.49, "cnt": 30}, "backward-compute":{"total": 1437.40, "avg": 44.92, "max": 43.37, "min": 47.04, "cnt": 32}, "MoE_L3_bwd":{"total": 365.28, "avg": 11.42, "max": 10.69, "min": 13.78, "cnt": 32}, "MoE_L2_bwd":{"total": 289.56, "avg": 9.05, "max": 8.43, "min": 9.58, "cnt": 32}, "MoE_L1_bwd":{"total": 278.87, "avg": 8.71, "max": 8.18, "min": 9.13, "cnt": 32}, "MoE_L0_bwd":{"total": 285.32, "avg": 8.92, "max": 8.44, "min": 9.83, "cnt": 32}, "backward-send-forward-recv":{"total": 531.89, "avg": 18.34, "max": 1.61, "min": 127.96, "cnt": 29}, "backward-send":{"total": 1.99, "avg": 0.66, "max": 0.48, "min": 0.97, "cnt": 3}, "backward-recv":{"total": 182.97, "avg": 91.48, "max": 80.00, "min": 102.97, "cnt": 2}, "backward-params-all-reduce":{"total": 490.23, "avg": 490.23, "max": 490.23, "min": 490.23, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 247.09, "avg": 247.09, "max": 247.09, "min": 247.09, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 202.92, "avg": 202.92, "max": 202.92, "min": 202.92, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.82, "avg": 6.82, "max": 6.82, "min": 6.82, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 192, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 60.44, "avg": 20.15, "max": 1.32, "min": 51.72, "cnt": 3}, "forward-compute":{"total": 1768.11, "avg": 55.25, "max": 47.41, "min": 61.26, "cnt": 32}, "fwd-compute":{"total": 1764.73, "avg": 55.15, "max": 47.34, "min": 61.13, "cnt": 32}, "batch-generator":{"total": 41.55, "avg": 1.30, "max": 0.65, "min": 2.05, "cnt": 32}, "fwd-embedding":{"total": 0.76, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1709.84, "avg": 53.43, "max": 46.32, "min": 59.04, "cnt": 32}, "fwd-layernorm":{"total": 10.77, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 114.14, "avg": 0.89, "max": 0.75, "min": 2.18, "cnt": 128}, "fwd-misc":{"total": 22.60, "avg": 0.18, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1539.98, "avg": 12.03, "max": 9.47, "min": 18.87, "cnt": 128}, "MoE_L0_fwd":{"total": 476.74, "avg": 14.90, "max": 10.77, "min": 18.80, "cnt": 32}, "MoEMLP":{"total": 1521.67, "avg": 11.89, "max": 9.37, "min": 18.75, "cnt": 128}, "MoE_L1_fwd":{"total": 372.46, "avg": 11.64, "max": 10.33, "min": 13.54, "cnt": 32}, "MoE_L2_fwd":{"total": 328.44, "avg": 10.26, "max": 9.41, "min": 11.49, "cnt": 32}, "MoE_L3_fwd":{"total": 350.60, "avg": 10.96, "max": 10.26, "min": 12.46, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.91, "avg": 0.95, "max": 0.93, "min": 0.98, "cnt": 2}, "forward-send-backward-recv":{"total": 575.10, "avg": 19.17, "max": 1.82, "min": 117.53, "cnt": 30}, "backward-compute":{"total": 1431.47, "avg": 44.73, "max": 43.01, "min": 46.92, "cnt": 32}, "MoE_L3_bwd":{"total": 363.13, "avg": 11.35, "max": 10.21, "min": 13.28, "cnt": 32}, "MoE_L2_bwd":{"total": 292.19, "avg": 9.13, "max": 8.48, "min": 10.24, "cnt": 32}, "MoE_L1_bwd":{"total": 278.97, "avg": 8.72, "max": 8.24, "min": 9.27, "cnt": 32}, "MoE_L0_bwd":{"total": 283.99, "avg": 8.87, "max": 8.44, "min": 9.21, "cnt": 32}, "backward-send-forward-recv":{"total": 1134.09, "avg": 39.11, "max": 1.76, "min": 305.70, "cnt": 29}, "backward-send":{"total": 2.60, "avg": 0.87, "max": 0.77, "min": 0.94, "cnt": 3}, "backward-recv":{"total": 148.01, "avg": 74.00, "max": 72.52, "min": 75.49, "cnt": 2}, "backward-params-all-reduce":{"total": 485.02, "avg": 485.02, "max": 485.02, "min": 485.02, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 249.78, "avg": 249.78, "max": 249.78, "min": 249.78, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 209.77, "avg": 209.77, "max": 209.77, "min": 209.77, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.40, "avg": 3.40, "max": 3.40, "min": 3.40, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.47, "avg": 3.47, "max": 3.47, "min": 3.47, "cnt": 1}}}
{"type":"time", "iteration": 193, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 58.86, "avg": 19.62, "max": 1.28, "min": 56.29, "cnt": 3}, "forward-compute":{"total": 1815.89, "avg": 56.75, "max": 47.26, "min": 64.80, "cnt": 32}, "fwd-compute":{"total": 1812.33, "avg": 56.64, "max": 47.18, "min": 64.66, "cnt": 32}, "batch-generator":{"total": 42.46, "avg": 1.33, "max": 0.67, "min": 1.94, "cnt": 32}, "fwd-embedding":{"total": 0.80, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1756.12, "avg": 54.88, "max": 46.20, "min": 62.47, "cnt": 32}, "fwd-layernorm":{"total": 11.06, "avg": 0.09, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 116.55, "avg": 0.91, "max": 0.75, "min": 2.44, "cnt": 128}, "fwd-misc":{"total": 23.56, "avg": 0.18, "max": 0.11, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1581.53, "avg": 12.36, "max": 9.61, "min": 18.33, "cnt": 128}, "MoE_L0_fwd":{"total": 491.14, "avg": 15.35, "max": 10.55, "min": 18.24, "cnt": 32}, "MoEMLP":{"total": 1562.38, "avg": 12.21, "max": 9.50, "min": 18.18, "cnt": 128}, "MoE_L1_fwd":{"total": 382.16, "avg": 11.94, "max": 10.46, "min": 16.75, "cnt": 32}, "MoE_L2_fwd":{"total": 335.60, "avg": 10.49, "max": 9.54, "min": 14.17, "cnt": 32}, "MoE_L3_fwd":{"total": 360.35, "avg": 11.26, "max": 10.44, "min": 13.13, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.92, "avg": 0.96, "max": 0.95, "min": 0.97, "cnt": 2}, "forward-send-backward-recv":{"total": 701.79, "avg": 23.39, "max": 1.92, "min": 117.15, "cnt": 30}, "backward-compute":{"total": 1433.56, "avg": 44.80, "max": 42.26, "min": 48.60, "cnt": 32}, "MoE_L3_bwd":{"total": 358.47, "avg": 11.20, "max": 9.03, "min": 12.05, "cnt": 32}, "MoE_L2_bwd":{"total": 293.21, "avg": 9.16, "max": 8.70, "min": 9.74, "cnt": 32}, "MoE_L1_bwd":{"total": 285.68, "avg": 8.93, "max": 8.48, "min": 12.21, "cnt": 32}, "MoE_L0_bwd":{"total": 279.17, "avg": 8.72, "max": 8.36, "min": 9.41, "cnt": 32}, "backward-send-forward-recv":{"total": 173.97, "avg": 6.00, "max": 1.59, "min": 104.77, "cnt": 29}, "backward-send":{"total": 2.88, "avg": 0.96, "max": 0.88, "min": 1.02, "cnt": 3}, "backward-recv":{"total": 160.30, "avg": 80.15, "max": 78.93, "min": 81.37, "cnt": 2}, "backward-params-all-reduce":{"total": 485.38, "avg": 485.38, "max": 485.38, "min": 485.38, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 247.26, "avg": 247.26, "max": 247.26, "min": 247.26, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 207.55, "avg": 207.55, "max": 207.55, "min": 207.55, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.27, "avg": 3.27, "max": 3.27, "min": 3.27, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 194, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 55.49, "avg": 18.50, "max": 0.78, "min": 53.45, "cnt": 3}, "forward-compute":{"total": 1757.93, "avg": 54.94, "max": 46.62, "min": 59.13, "cnt": 32}, "fwd-compute":{"total": 1754.40, "avg": 54.82, "max": 46.55, "min": 59.04, "cnt": 32}, "batch-generator":{"total": 43.24, "avg": 1.35, "max": 0.67, "min": 2.39, "cnt": 32}, "fwd-embedding":{"total": 0.78, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1697.53, "avg": 53.05, "max": 45.55, "min": 57.86, "cnt": 32}, "fwd-layernorm":{"total": 11.06, "avg": 0.09, "max": 0.06, "min": 0.25, "cnt": 128}, "fwd-attn":{"total": 116.85, "avg": 0.91, "max": 0.74, "min": 2.19, "cnt": 128}, "fwd-misc":{"total": 22.48, "avg": 0.18, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1524.42, "avg": 11.91, "max": 9.62, "min": 19.23, "cnt": 128}, "MoE_L0_fwd":{"total": 466.23, "avg": 14.57, "max": 10.49, "min": 19.09, "cnt": 32}, "MoEMLP":{"total": 1505.75, "avg": 11.76, "max": 9.51, "min": 19.03, "cnt": 128}, "MoE_L1_fwd":{"total": 366.65, "avg": 11.46, "max": 9.82, "min": 14.24, "cnt": 32}, "MoE_L2_fwd":{"total": 324.49, "avg": 10.14, "max": 9.55, "min": 11.83, "cnt": 32}, "MoE_L3_fwd":{"total": 355.00, "avg": 11.09, "max": 10.14, "min": 12.19, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 12.04, "avg": 6.02, "max": 1.00, "min": 11.04, "cnt": 2}, "forward-send-backward-recv":{"total": 1398.83, "avg": 46.63, "max": 1.79, "min": 210.05, "cnt": 30}, "backward-compute":{"total": 1425.60, "avg": 44.55, "max": 42.31, "min": 46.45, "cnt": 32}, "MoE_L3_bwd":{"total": 365.05, "avg": 11.41, "max": 10.56, "min": 13.83, "cnt": 32}, "MoE_L2_bwd":{"total": 287.92, "avg": 9.00, "max": 8.33, "min": 9.89, "cnt": 32}, "MoE_L1_bwd":{"total": 276.21, "avg": 8.63, "max": 8.22, "min": 9.10, "cnt": 32}, "MoE_L0_bwd":{"total": 278.43, "avg": 8.70, "max": 8.11, "min": 9.01, "cnt": 32}, "backward-send-forward-recv":{"total": 974.45, "avg": 33.60, "max": 1.72, "min": 757.21, "cnt": 29}, "backward-send":{"total": 2.66, "avg": 0.89, "max": 0.56, "min": 1.16, "cnt": 3}, "backward-recv":{"total": 183.08, "avg": 91.54, "max": 82.17, "min": 100.91, "cnt": 2}, "backward-params-all-reduce":{"total": 483.05, "avg": 483.05, "max": 483.05, "min": 483.05, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 251.33, "avg": 251.33, "max": 251.33, "min": 251.33, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 211.43, "avg": 211.43, "max": 211.43, "min": 211.43, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.28, "avg": 3.28, "max": 3.28, "min": 3.28, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 195, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 53.01, "avg": 17.67, "max": 0.71, "min": 51.03, "cnt": 3}, "forward-compute":{"total": 1765.09, "avg": 55.16, "max": 47.58, "min": 61.35, "cnt": 32}, "fwd-compute":{"total": 1761.30, "avg": 55.04, "max": 47.51, "min": 61.25, "cnt": 32}, "batch-generator":{"total": 48.02, "avg": 1.50, "max": 0.67, "min": 2.89, "cnt": 32}, "fwd-embedding":{"total": 0.86, "avg": 0.03, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1699.18, "avg": 53.10, "max": 46.50, "min": 59.06, "cnt": 32}, "fwd-layernorm":{"total": 11.44, "avg": 0.09, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 117.32, "avg": 0.92, "max": 0.75, "min": 1.57, "cnt": 128}, "fwd-misc":{"total": 23.36, "avg": 0.18, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1523.79, "avg": 11.90, "max": 9.40, "min": 18.60, "cnt": 128}, "MoE_L0_fwd":{"total": 462.45, "avg": 14.45, "max": 10.36, "min": 18.51, "cnt": 32}, "MoEMLP":{"total": 1504.95, "avg": 11.76, "max": 9.27, "min": 18.46, "cnt": 128}, "MoE_L1_fwd":{"total": 371.15, "avg": 11.60, "max": 10.10, "min": 14.87, "cnt": 32}, "MoE_L2_fwd":{"total": 326.07, "avg": 10.19, "max": 9.32, "min": 11.42, "cnt": 32}, "MoE_L3_fwd":{"total": 352.11, "avg": 11.00, "max": 10.41, "min": 12.63, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 13.50, "avg": 6.75, "max": 1.00, "min": 12.50, "cnt": 2}, "forward-send-backward-recv":{"total": 1009.10, "avg": 33.64, "max": 7.75, "min": 145.32, "cnt": 30}, "backward-compute":{"total": 1406.05, "avg": 43.94, "max": 40.89, "min": 47.21, "cnt": 32}, "MoE_L3_bwd":{"total": 353.52, "avg": 11.05, "max": 10.27, "min": 14.36, "cnt": 32}, "MoE_L2_bwd":{"total": 286.65, "avg": 8.96, "max": 8.03, "min": 9.68, "cnt": 32}, "MoE_L1_bwd":{"total": 273.13, "avg": 8.54, "max": 7.86, "min": 9.07, "cnt": 32}, "MoE_L0_bwd":{"total": 276.03, "avg": 8.63, "max": 7.91, "min": 9.27, "cnt": 32}, "backward-send-forward-recv":{"total": 94.43, "avg": 3.26, "max": 2.02, "min": 22.16, "cnt": 29}, "backward-send":{"total": 3.11, "avg": 1.04, "max": 0.94, "min": 1.19, "cnt": 3}, "backward-recv":{"total": 157.79, "avg": 78.89, "max": 78.18, "min": 79.60, "cnt": 2}, "backward-params-all-reduce":{"total": 486.00, "avg": 486.00, "max": 486.00, "min": 486.00, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 241.86, "avg": 241.86, "max": 241.86, "min": 241.86, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 202.10, "avg": 202.10, "max": 202.10, "min": 202.10, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.26, "avg": 3.26, "max": 3.26, "min": 3.26, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 196, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 66.33, "avg": 22.11, "max": 1.00, "min": 64.04, "cnt": 3}, "forward-compute":{"total": 1745.75, "avg": 54.55, "max": 47.28, "min": 63.38, "cnt": 32}, "fwd-compute":{"total": 1742.18, "avg": 54.44, "max": 47.21, "min": 63.27, "cnt": 32}, "batch-generator":{"total": 44.44, "avg": 1.39, "max": 0.73, "min": 2.65, "cnt": 32}, "fwd-embedding":{"total": 0.74, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1684.45, "avg": 52.64, "max": 46.11, "min": 61.95, "cnt": 32}, "fwd-layernorm":{"total": 10.58, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 111.42, "avg": 0.87, "max": 0.74, "min": 1.51, "cnt": 128}, "fwd-misc":{"total": 22.44, "avg": 0.18, "max": 0.11, "min": 0.67, "cnt": 128}, "fwd-MLP":{"total": 1517.98, "avg": 11.86, "max": 9.50, "min": 18.95, "cnt": 128}, "MoE_L0_fwd":{"total": 447.13, "avg": 13.97, "max": 10.67, "min": 18.87, "cnt": 32}, "MoEMLP":{"total": 1500.08, "avg": 11.72, "max": 9.40, "min": 18.82, "cnt": 128}, "MoE_L1_fwd":{"total": 368.61, "avg": 11.52, "max": 9.78, "min": 17.65, "cnt": 32}, "MoE_L2_fwd":{"total": 335.66, "avg": 10.49, "max": 9.44, "min": 14.38, "cnt": 32}, "MoE_L3_fwd":{"total": 355.24, "avg": 11.10, "max": 10.35, "min": 12.75, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.63, "avg": 0.02, "max": 0.02, "min": 0.05, "cnt": 32}, "forward-send":{"total": 3.65, "avg": 1.83, "max": 0.92, "min": 2.73, "cnt": 2}, "forward-send-backward-recv":{"total": 486.03, "avg": 16.20, "max": 1.98, "min": 116.41, "cnt": 30}, "backward-compute":{"total": 1430.91, "avg": 44.72, "max": 41.92, "min": 48.48, "cnt": 32}, "MoE_L3_bwd":{"total": 366.10, "avg": 11.44, "max": 10.10, "min": 14.67, "cnt": 32}, "MoE_L2_bwd":{"total": 293.93, "avg": 9.19, "max": 8.39, "min": 12.06, "cnt": 32}, "MoE_L1_bwd":{"total": 281.69, "avg": 8.80, "max": 8.23, "min": 9.28, "cnt": 32}, "MoE_L0_bwd":{"total": 271.04, "avg": 8.47, "max": 7.52, "min": 9.13, "cnt": 32}, "backward-send-forward-recv":{"total": 1988.46, "avg": 68.57, "max": 1.79, "min": 587.84, "cnt": 29}, "backward-send":{"total": 2.86, "avg": 0.95, "max": 0.89, "min": 1.03, "cnt": 3}, "backward-recv":{"total": 138.89, "avg": 69.45, "max": 64.25, "min": 74.65, "cnt": 2}, "backward-params-all-reduce":{"total": 486.49, "avg": 486.49, "max": 486.49, "min": 486.49, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 245.49, "avg": 245.49, "max": 245.49, "min": 245.49, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 205.68, "avg": 205.68, "max": 205.68, "min": 205.68, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 197, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 59.51, "avg": 19.84, "max": 0.73, "min": 57.66, "cnt": 3}, "forward-compute":{"total": 1777.47, "avg": 55.55, "max": 47.47, "min": 65.68, "cnt": 32}, "fwd-compute":{"total": 1774.16, "avg": 55.44, "max": 47.39, "min": 65.60, "cnt": 32}, "batch-generator":{"total": 44.07, "avg": 1.38, "max": 0.67, "min": 3.08, "cnt": 32}, "fwd-embedding":{"total": 0.76, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1716.86, "avg": 53.65, "max": 46.40, "min": 64.42, "cnt": 32}, "fwd-layernorm":{"total": 10.84, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 115.87, "avg": 0.91, "max": 0.75, "min": 1.66, "cnt": 128}, "fwd-misc":{"total": 22.72, "avg": 0.18, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1544.62, "avg": 12.07, "max": 9.73, "min": 19.18, "cnt": 128}, "MoE_L0_fwd":{"total": 465.61, "avg": 14.55, "max": 10.45, "min": 19.10, "cnt": 32}, "MoEMLP":{"total": 1525.77, "avg": 11.92, "max": 9.61, "min": 19.04, "cnt": 128}, "MoE_L1_fwd":{"total": 368.95, "avg": 11.53, "max": 10.13, "min": 15.22, "cnt": 32}, "MoE_L2_fwd":{"total": 332.69, "avg": 10.40, "max": 9.65, "min": 11.73, "cnt": 32}, "MoE_L3_fwd":{"total": 365.24, "avg": 11.41, "max": 10.23, "min": 16.90, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 8.05, "avg": 4.02, "max": 0.96, "min": 7.09, "cnt": 2}, "forward-send-backward-recv":{"total": 750.06, "avg": 25.00, "max": 1.88, "min": 112.48, "cnt": 30}, "backward-compute":{"total": 1420.08, "avg": 44.38, "max": 42.65, "min": 47.22, "cnt": 32}, "MoE_L3_bwd":{"total": 361.10, "avg": 11.28, "max": 10.40, "min": 13.03, "cnt": 32}, "MoE_L2_bwd":{"total": 288.16, "avg": 9.00, "max": 8.28, "min": 9.65, "cnt": 32}, "MoE_L1_bwd":{"total": 282.27, "avg": 8.82, "max": 8.25, "min": 11.36, "cnt": 32}, "MoE_L0_bwd":{"total": 272.32, "avg": 8.51, "max": 8.13, "min": 8.87, "cnt": 32}, "backward-send-forward-recv":{"total": 416.07, "avg": 14.35, "max": 1.81, "min": 89.32, "cnt": 29}, "backward-send":{"total": 2.92, "avg": 0.97, "max": 0.68, "min": 1.12, "cnt": 3}, "backward-recv":{"total": 151.41, "avg": 75.71, "max": 73.27, "min": 78.14, "cnt": 2}, "backward-params-all-reduce":{"total": 492.03, "avg": 492.03, "max": 492.03, "min": 492.03, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 241.69, "avg": 241.69, "max": 241.69, "min": 241.69, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 201.90, "avg": 201.90, "max": 201.90, "min": 201.90, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.26, "avg": 3.26, "max": 3.26, "min": 3.26, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 198, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 56.16, "avg": 18.72, "max": 1.24, "min": 53.27, "cnt": 3}, "forward-compute":{"total": 1779.04, "avg": 55.60, "max": 48.45, "min": 61.30, "cnt": 32}, "fwd-compute":{"total": 1775.42, "avg": 55.48, "max": 48.37, "min": 61.19, "cnt": 32}, "batch-generator":{"total": 46.16, "avg": 1.44, "max": 0.66, "min": 2.90, "cnt": 32}, "fwd-embedding":{"total": 0.80, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1715.90, "avg": 53.62, "max": 47.02, "min": 59.80, "cnt": 32}, "fwd-layernorm":{"total": 11.30, "avg": 0.09, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 116.44, "avg": 0.91, "max": 0.75, "min": 1.55, "cnt": 128}, "fwd-misc":{"total": 23.65, "avg": 0.18, "max": 0.11, "min": 0.43, "cnt": 128}, "fwd-MLP":{"total": 1540.86, "avg": 12.04, "max": 9.74, "min": 19.68, "cnt": 128}, "MoE_L0_fwd":{"total": 464.17, "avg": 14.51, "max": 11.00, "min": 19.55, "cnt": 32}, "MoEMLP":{"total": 1521.65, "avg": 11.89, "max": 9.63, "min": 19.48, "cnt": 128}, "MoE_L1_fwd":{"total": 373.32, "avg": 11.67, "max": 10.28, "min": 16.12, "cnt": 32}, "MoE_L2_fwd":{"total": 336.45, "avg": 10.51, "max": 9.67, "min": 11.51, "cnt": 32}, "MoE_L3_fwd":{"total": 354.73, "avg": 11.09, "max": 10.53, "min": 12.38, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.87, "avg": 0.94, "max": 0.93, "min": 0.94, "cnt": 2}, "forward-send-backward-recv":{"total": 432.76, "avg": 14.43, "max": 1.94, "min": 128.49, "cnt": 30}, "backward-compute":{"total": 1435.77, "avg": 44.87, "max": 42.96, "min": 47.83, "cnt": 32}, "MoE_L3_bwd":{"total": 364.67, "avg": 11.40, "max": 10.38, "min": 12.47, "cnt": 32}, "MoE_L2_bwd":{"total": 296.62, "avg": 9.27, "max": 8.57, "min": 9.86, "cnt": 32}, "MoE_L1_bwd":{"total": 283.56, "avg": 8.86, "max": 8.07, "min": 10.64, "cnt": 32}, "MoE_L0_bwd":{"total": 273.21, "avg": 8.54, "max": 8.08, "min": 9.00, "cnt": 32}, "backward-send-forward-recv":{"total": 1660.15, "avg": 57.25, "max": 2.10, "min": 656.33, "cnt": 29}, "backward-send":{"total": 2.41, "avg": 0.80, "max": 0.63, "min": 0.93, "cnt": 3}, "backward-recv":{"total": 144.24, "avg": 72.12, "max": 69.93, "min": 74.31, "cnt": 2}, "backward-params-all-reduce":{"total": 484.90, "avg": 484.90, "max": 484.90, "min": 484.90, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 244.36, "avg": 244.36, "max": 244.36, "min": 244.36, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 204.38, "avg": 204.38, "max": 204.38, "min": 204.38, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.47, "avg": 3.47, "max": 3.47, "min": 3.47, "cnt": 1}}}
{"type":"time", "iteration": 199, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 66.83, "avg": 22.28, "max": 1.20, "min": 64.40, "cnt": 3}, "forward-compute":{"total": 1813.53, "avg": 56.67, "max": 50.09, "min": 70.46, "cnt": 32}, "fwd-compute":{"total": 1809.96, "avg": 56.56, "max": 50.00, "min": 70.32, "cnt": 32}, "batch-generator":{"total": 44.43, "avg": 1.39, "max": 0.67, "min": 2.54, "cnt": 32}, "fwd-embedding":{"total": 0.81, "avg": 0.03, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1751.77, "avg": 54.74, "max": 48.50, "min": 68.22, "cnt": 32}, "fwd-layernorm":{"total": 11.27, "avg": 0.09, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 115.99, "avg": 0.91, "max": 0.74, "min": 1.50, "cnt": 128}, "fwd-misc":{"total": 23.89, "avg": 0.19, "max": 0.11, "min": 0.39, "cnt": 128}, "fwd-MLP":{"total": 1577.21, "avg": 12.32, "max": 9.84, "min": 18.77, "cnt": 128}, "MoE_L0_fwd":{"total": 474.97, "avg": 14.84, "max": 10.75, "min": 18.60, "cnt": 32}, "MoEMLP":{"total": 1558.02, "avg": 12.17, "max": 9.73, "min": 18.51, "cnt": 128}, "MoE_L1_fwd":{"total": 382.04, "avg": 11.94, "max": 10.11, "min": 17.15, "cnt": 32}, "MoE_L2_fwd":{"total": 342.33, "avg": 10.70, "max": 9.77, "min": 15.40, "cnt": 32}, "MoE_L3_fwd":{"total": 365.55, "avg": 11.42, "max": 10.42, "min": 15.94, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 2.02, "avg": 1.01, "max": 1.00, "min": 1.03, "cnt": 2}, "forward-send-backward-recv":{"total": 1263.82, "avg": 42.13, "max": 8.05, "min": 207.08, "cnt": 30}, "backward-compute":{"total": 1425.02, "avg": 44.53, "max": 42.19, "min": 46.47, "cnt": 32}, "MoE_L3_bwd":{"total": 365.07, "avg": 11.41, "max": 10.15, "min": 12.97, "cnt": 32}, "MoE_L2_bwd":{"total": 293.58, "avg": 9.17, "max": 8.41, "min": 10.02, "cnt": 32}, "MoE_L1_bwd":{"total": 279.57, "avg": 8.74, "max": 8.18, "min": 9.48, "cnt": 32}, "MoE_L0_bwd":{"total": 271.33, "avg": 8.48, "max": 8.01, "min": 10.53, "cnt": 32}, "backward-send-forward-recv":{"total": 168.06, "avg": 5.80, "max": 1.84, "min": 72.39, "cnt": 29}, "backward-send":{"total": 2.67, "avg": 0.89, "max": 0.77, "min": 0.96, "cnt": 3}, "backward-recv":{"total": 148.27, "avg": 74.14, "max": 73.87, "min": 74.41, "cnt": 2}, "backward-params-all-reduce":{"total": 499.14, "avg": 499.14, "max": 499.14, "min": 499.14, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 242.98, "avg": 242.98, "max": 242.98, "min": 242.98, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 202.96, "avg": 202.96, "max": 202.96, "min": 202.96, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.52, "avg": 3.52, "max": 3.52, "min": 3.52, "cnt": 1}}}
{"type":"time", "iteration": 200, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 69.63, "avg": 23.21, "max": 1.16, "min": 67.14, "cnt": 3}, "forward-compute":{"total": 1806.77, "avg": 56.46, "max": 51.66, "min": 63.82, "cnt": 32}, "fwd-compute":{"total": 1803.17, "avg": 56.35, "max": 51.57, "min": 63.73, "cnt": 32}, "batch-generator":{"total": 41.81, "avg": 1.31, "max": 0.73, "min": 1.72, "cnt": 32}, "fwd-embedding":{"total": 0.79, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1747.22, "avg": 54.60, "max": 50.21, "min": 62.54, "cnt": 32}, "fwd-layernorm":{"total": 11.10, "avg": 0.09, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 114.94, "avg": 0.90, "max": 0.74, "min": 2.51, "cnt": 128}, "fwd-misc":{"total": 23.42, "avg": 0.18, "max": 0.12, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1574.00, "avg": 12.30, "max": 10.00, "min": 17.86, "cnt": 128}, "MoE_L0_fwd":{"total": 481.09, "avg": 15.03, "max": 11.72, "min": 17.78, "cnt": 32}, "MoEMLP":{"total": 1554.84, "avg": 12.15, "max": 9.88, "min": 17.72, "cnt": 128}, "MoE_L1_fwd":{"total": 380.12, "avg": 11.88, "max": 10.73, "min": 14.61, "cnt": 32}, "MoE_L2_fwd":{"total": 343.49, "avg": 10.73, "max": 9.92, "min": 13.31, "cnt": 32}, "MoE_L3_fwd":{"total": 357.05, "avg": 11.16, "max": 10.39, "min": 13.27, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.62, "avg": 0.02, "max": 0.02, "min": 0.06, "cnt": 32}, "forward-send":{"total": 6.53, "avg": 3.26, "max": 0.82, "min": 5.71, "cnt": 2}, "forward-send-backward-recv":{"total": 623.77, "avg": 20.79, "max": 1.92, "min": 122.09, "cnt": 30}, "backward-compute":{"total": 1418.20, "avg": 44.32, "max": 43.10, "min": 45.87, "cnt": 32}, "MoE_L3_bwd":{"total": 356.19, "avg": 11.13, "max": 10.50, "min": 11.98, "cnt": 32}, "MoE_L2_bwd":{"total": 295.35, "avg": 9.23, "max": 8.55, "min": 10.16, "cnt": 32}, "MoE_L1_bwd":{"total": 278.92, "avg": 8.72, "max": 8.23, "min": 9.26, "cnt": 32}, "MoE_L0_bwd":{"total": 270.67, "avg": 8.46, "max": 7.94, "min": 8.74, "cnt": 32}, "backward-send-forward-recv":{"total": 292.58, "avg": 10.09, "max": 1.94, "min": 141.66, "cnt": 29}, "backward-send":{"total": 2.99, "avg": 1.00, "max": 0.88, "min": 1.09, "cnt": 3}, "backward-recv":{"total": 157.05, "avg": 78.52, "max": 75.99, "min": 81.05, "cnt": 2}, "backward-params-all-reduce":{"total": 484.46, "avg": 484.46, "max": 484.46, "min": 484.46, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 245.48, "avg": 245.48, "max": 245.48, "min": 245.48, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 205.69, "avg": 205.69, "max": 205.69, "min": 205.69, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.30, "avg": 3.30, "max": 3.30, "min": 3.30, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
