{"type":"time", "iteration": -1, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 7061.79, "avg": 7061.79, "max": 7061.79, "min": 7061.79, "cnt": 1}, "train/valid/test-data-iterators-setup":{"total": 13493.74, "avg": 13493.74, "max": 13493.74, "min": 13493.74, "cnt": 1}}}
{"type":"time", "iteration": 1, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 2.30, "avg": 2.30, "max": 2.30, "min": 2.30, "cnt": 1}, "forward-recv":{"total": 4061.20, "avg": 1353.73, "max": 0.85, "min": 4058.57, "cnt": 3}, "forward-compute":{"total": 4195.23, "avg": 131.10, "max": 55.63, "min": 1498.09, "cnt": 32}, "fwd-compute":{"total": 4190.92, "avg": 130.97, "max": 55.47, "min": 1497.89, "cnt": 32}, "batch-generator":{"total": 320.57, "avg": 10.02, "max": 0.92, "min": 72.87, "cnt": 32}, "fwd-embedding":{"total": 0.83, "avg": 0.03, "max": 0.01, "min": 0.06, "cnt": 32}, "fwd-encoder":{"total": 3854.56, "avg": 120.46, "max": 53.74, "min": 1491.84, "cnt": 32}, "fwd-layernorm":{"total": 12.46, "avg": 0.10, "max": 0.06, "min": 0.36, "cnt": 128}, "fwd-attn":{"total": 688.12, "avg": 5.38, "max": 0.74, "min": 517.83, "cnt": 128}, "fwd-misc":{"total": 382.63, "avg": 2.99, "max": 0.11, "min": 358.66, "cnt": 128}, "fwd-MLP":{"total": 2738.55, "avg": 21.39, "max": 11.34, "min": 514.60, "cnt": 128}, "MoE_L0_fwd":{"total": 1467.72, "avg": 45.87, "max": 11.75, "min": 514.34, "cnt": 32}, "MoEMLP":{"total": 2719.61, "avg": 21.25, "max": 11.24, "min": 514.21, "cnt": 128}, "MoE_L1_fwd":{"total": 424.82, "avg": 13.28, "max": 11.46, "min": 20.17, "cnt": 32}, "MoE_L2_fwd":{"total": 411.05, "avg": 12.85, "max": 11.30, "min": 25.14, "cnt": 32}, "MoE_L3_fwd":{"total": 422.78, "avg": 13.21, "max": 11.27, "min": 30.58, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.63, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1665.88, "avg": 832.94, "max": 89.72, "min": 1576.16, "cnt": 2}, "forward-send-backward-recv":{"total": 3038.10, "avg": 101.27, "max": 1.19, "min": 2908.98, "cnt": 30}, "backward-compute":{"total": 1975.30, "avg": 61.73, "max": 46.37, "min": 433.47, "cnt": 32}, "MoE_L3_bwd":{"total": 459.72, "avg": 14.37, "max": 11.51, "min": 54.89, "cnt": 32}, "MoE_L2_bwd":{"total": 355.06, "avg": 11.10, "max": 9.53, "min": 23.30, "cnt": 32}, "MoE_L1_bwd":{"total": 302.44, "avg": 9.45, "max": 8.84, "min": 11.28, "cnt": 32}, "MoE_L0_bwd":{"total": 294.36, "avg": 9.20, "max": 8.64, "min": 11.35, "cnt": 32}, "backward-send-forward-recv":{"total": 8419.18, "avg": 290.32, "max": 1.20, "min": 927.47, "cnt": 29}, "backward-send":{"total": 3.17, "avg": 1.06, "max": 0.87, "min": 1.16, "cnt": 3}, "backward-recv":{"total": 185.90, "avg": 92.95, "max": 90.38, "min": 95.52, "cnt": 2}, "backward-params-all-reduce":{"total": 797.06, "avg": 797.06, "max": 797.06, "min": 797.06, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.04, "avg": 0.04, "max": 0.04, "min": 0.04, "cnt": 1}, "optimizer":{"total": 523.31, "avg": 523.31, "max": 523.31, "min": 523.31, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 329.66, "avg": 329.66, "max": 329.66, "min": 329.66, "cnt": 1}, "optimizer-clip-main-grad":{"total": 7.87, "avg": 7.87, "max": 7.87, "min": 7.87, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.82, "avg": 3.82, "max": 3.82, "min": 3.82, "cnt": 1}}}
{"type":"time", "iteration": 2, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.11, "avg": 0.11, "max": 0.11, "min": 0.11, "cnt": 1}, "forward-recv":{"total": 81.39, "avg": 27.13, "max": 0.89, "min": 70.94, "cnt": 3}, "forward-compute":{"total": 2985.51, "avg": 93.30, "max": 54.49, "min": 440.49, "cnt": 32}, "fwd-compute":{"total": 2981.93, "avg": 93.19, "max": 54.43, "min": 440.40, "cnt": 32}, "batch-generator":{"total": 53.62, "avg": 1.68, "max": 0.64, "min": 4.46, "cnt": 32}, "fwd-embedding":{"total": 0.73, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 2914.76, "avg": 91.09, "max": 53.50, "min": 438.65, "cnt": 32}, "fwd-layernorm":{"total": 11.12, "avg": 0.09, "max": 0.06, "min": 0.26, "cnt": 128}, "fwd-attn":{"total": 115.61, "avg": 0.90, "max": 0.74, "min": 2.13, "cnt": 128}, "fwd-misc":{"total": 23.50, "avg": 0.18, "max": 0.11, "min": 0.49, "cnt": 128}, "fwd-MLP":{"total": 2741.90, "avg": 21.42, "max": 10.30, "min": 398.47, "cnt": 128}, "MoE_L0_fwd":{"total": 1557.87, "avg": 48.68, "max": 13.30, "min": 398.37, "cnt": 32}, "MoEMLP":{"total": 2723.95, "avg": 21.28, "max": 10.19, "min": 398.32, "cnt": 128}, "MoE_L1_fwd":{"total": 401.33, "avg": 12.54, "max": 10.93, "min": 15.87, "cnt": 32}, "MoE_L2_fwd":{"total": 363.74, "avg": 11.37, "max": 10.23, "min": 14.93, "cnt": 32}, "MoE_L3_fwd":{"total": 407.53, "avg": 12.74, "max": 11.72, "min": 17.40, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.47, "avg": 0.74, "max": 0.57, "min": 0.90, "cnt": 2}, "forward-send-backward-recv":{"total": 300.42, "avg": 10.01, "max": 1.09, "min": 125.31, "cnt": 30}, "backward-compute":{"total": 1767.51, "avg": 55.23, "max": 52.77, "min": 60.70, "cnt": 32}, "MoE_L3_bwd":{"total": 458.19, "avg": 14.32, "max": 13.03, "min": 18.39, "cnt": 32}, "MoE_L2_bwd":{"total": 355.54, "avg": 11.11, "max": 10.53, "min": 12.67, "cnt": 32}, "MoE_L1_bwd":{"total": 352.72, "avg": 11.02, "max": 10.48, "min": 11.75, "cnt": 32}, "MoE_L0_bwd":{"total": 368.44, "avg": 11.51, "max": 11.31, "min": 12.10, "cnt": 32}, "backward-send-forward-recv":{"total": 8824.02, "avg": 304.28, "max": 1.53, "min": 1315.18, "cnt": 29}, "backward-send":{"total": 2.86, "avg": 0.95, "max": 0.63, "min": 1.25, "cnt": 3}, "backward-recv":{"total": 153.44, "avg": 76.72, "max": 75.73, "min": 77.71, "cnt": 2}, "backward-params-all-reduce":{"total": 493.52, "avg": 493.52, "max": 493.52, "min": 493.52, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 240.75, "avg": 240.75, "max": 240.75, "min": 240.75, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 195.74, "avg": 195.74, "max": 195.74, "min": 195.74, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.93, "avg": 6.93, "max": 6.93, "min": 6.93, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 3, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.10, "avg": 0.10, "max": 0.10, "min": 0.10, "cnt": 1}, "forward-recv":{"total": 80.00, "avg": 26.67, "max": 1.13, "min": 77.66, "cnt": 3}, "forward-compute":{"total": 2575.35, "avg": 80.48, "max": 56.64, "min": 231.73, "cnt": 32}, "fwd-compute":{"total": 2572.28, "avg": 80.38, "max": 56.57, "min": 231.64, "cnt": 32}, "batch-generator":{"total": 223.35, "avg": 6.98, "max": 0.65, "min": 150.76, "cnt": 32}, "fwd-embedding":{"total": 0.59, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 2336.15, "avg": 73.00, "max": 55.55, "min": 179.39, "cnt": 32}, "fwd-layernorm":{"total": 10.29, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 111.74, "avg": 0.87, "max": 0.74, "min": 3.83, "cnt": 128}, "fwd-misc":{"total": 21.82, "avg": 0.17, "max": 0.11, "min": 0.39, "cnt": 128}, "fwd-MLP":{"total": 2170.45, "avg": 16.96, "max": 12.33, "min": 133.45, "cnt": 128}, "MoE_L0_fwd":{"total": 881.98, "avg": 27.56, "max": 12.58, "min": 133.36, "cnt": 32}, "MoEMLP":{"total": 2153.40, "avg": 16.82, "max": 12.22, "min": 133.31, "cnt": 128}, "MoE_L1_fwd":{"total": 443.26, "avg": 13.85, "max": 12.40, "min": 20.12, "cnt": 32}, "MoE_L2_fwd":{"total": 418.78, "avg": 13.09, "max": 12.39, "min": 17.55, "cnt": 32}, "MoE_L3_fwd":{"total": 415.56, "avg": 12.99, "max": 12.25, "min": 15.29, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.81, "avg": 0.90, "max": 0.89, "min": 0.92, "cnt": 2}, "forward-send-backward-recv":{"total": 255.12, "avg": 8.50, "max": 1.10, "min": 112.42, "cnt": 30}, "backward-compute":{"total": 1964.56, "avg": 61.39, "max": 57.67, "min": 64.41, "cnt": 32}, "MoE_L3_bwd":{"total": 439.60, "avg": 13.74, "max": 12.71, "min": 16.10, "cnt": 32}, "MoE_L2_bwd":{"total": 462.26, "avg": 14.45, "max": 13.66, "min": 16.98, "cnt": 32}, "MoE_L1_bwd":{"total": 453.79, "avg": 14.18, "max": 13.35, "min": 15.38, "cnt": 32}, "MoE_L0_bwd":{"total": 387.86, "avg": 12.12, "max": 11.21, "min": 14.85, "cnt": 32}, "backward-send-forward-recv":{"total": 9043.06, "avg": 311.83, "max": 2.11, "min": 1119.12, "cnt": 29}, "backward-send":{"total": 2.85, "avg": 0.95, "max": 0.89, "min": 1.07, "cnt": 3}, "backward-recv":{"total": 133.15, "avg": 66.57, "max": 60.12, "min": 73.03, "cnt": 2}, "backward-params-all-reduce":{"total": 489.99, "avg": 489.99, "max": 489.99, "min": 489.99, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 243.33, "avg": 243.33, "max": 243.33, "min": 243.33, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.41, "avg": 3.41, "max": 3.41, "min": 3.41, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 197.62, "avg": 197.62, "max": 197.62, "min": 197.62, "cnt": 1}, "optimizer-clip-main-grad":{"total": 7.63, "avg": 7.63, "max": 7.63, "min": 7.63, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.51, "avg": 3.51, "max": 3.51, "min": 3.51, "cnt": 1}}}
{"type":"time", "iteration": 4, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 92.84, "avg": 30.95, "max": 1.48, "min": 81.64, "cnt": 3}, "forward-compute":{"total": 2393.60, "avg": 74.80, "max": 55.06, "min": 247.72, "cnt": 32}, "fwd-compute":{"total": 2390.20, "avg": 74.69, "max": 54.98, "min": 247.63, "cnt": 32}, "batch-generator":{"total": 57.99, "avg": 1.81, "max": 0.70, "min": 5.96, "cnt": 32}, "fwd-embedding":{"total": 0.69, "avg": 0.02, "max": 0.01, "min": 0.06, "cnt": 32}, "fwd-encoder":{"total": 2319.07, "avg": 72.47, "max": 53.66, "min": 246.15, "cnt": 32}, "fwd-layernorm":{"total": 10.78, "avg": 0.08, "max": 0.06, "min": 0.30, "cnt": 128}, "fwd-attn":{"total": 112.94, "avg": 0.88, "max": 0.74, "min": 2.35, "cnt": 128}, "fwd-misc":{"total": 23.05, "avg": 0.18, "max": 0.12, "min": 0.52, "cnt": 128}, "fwd-MLP":{"total": 2150.34, "avg": 16.80, "max": 11.33, "min": 203.39, "cnt": 128}, "MoE_L0_fwd":{"total": 917.55, "avg": 28.67, "max": 12.31, "min": 203.29, "cnt": 32}, "MoEMLP":{"total": 2132.93, "avg": 16.66, "max": 11.22, "min": 203.24, "cnt": 128}, "MoE_L1_fwd":{"total": 430.80, "avg": 13.46, "max": 11.45, "min": 23.64, "cnt": 32}, "MoE_L2_fwd":{"total": 410.86, "avg": 12.84, "max": 12.14, "min": 13.91, "cnt": 32}, "MoE_L3_fwd":{"total": 380.08, "avg": 11.88, "max": 11.26, "min": 17.50, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.54, "avg": 0.77, "max": 0.70, "min": 0.84, "cnt": 2}, "forward-send-backward-recv":{"total": 310.84, "avg": 10.36, "max": 1.31, "min": 127.33, "cnt": 30}, "backward-compute":{"total": 1751.05, "avg": 54.72, "max": 52.00, "min": 59.27, "cnt": 32}, "MoE_L3_bwd":{"total": 424.82, "avg": 13.28, "max": 12.48, "min": 18.58, "cnt": 32}, "MoE_L2_bwd":{"total": 390.77, "avg": 12.21, "max": 11.55, "min": 12.68, "cnt": 32}, "MoE_L1_bwd":{"total": 338.96, "avg": 10.59, "max": 10.01, "min": 13.64, "cnt": 32}, "MoE_L0_bwd":{"total": 372.46, "avg": 11.64, "max": 10.81, "min": 12.49, "cnt": 32}, "backward-send-forward-recv":{"total": 7936.92, "avg": 273.69, "max": 2.04, "min": 1094.97, "cnt": 29}, "backward-send":{"total": 2.55, "avg": 0.85, "max": 0.73, "min": 1.05, "cnt": 3}, "backward-recv":{"total": 144.29, "avg": 72.15, "max": 71.07, "min": 73.22, "cnt": 2}, "backward-params-all-reduce":{"total": 488.35, "avg": 488.35, "max": 488.35, "min": 488.35, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 241.36, "avg": 241.36, "max": 241.36, "min": 241.36, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.40, "avg": 3.40, "max": 3.40, "min": 3.40, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 196.73, "avg": 196.73, "max": 196.73, "min": 196.73, "cnt": 1}, "optimizer-clip-main-grad":{"total": 7.27, "avg": 7.27, "max": 7.27, "min": 7.27, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 5, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 78.94, "avg": 26.31, "max": 0.78, "min": 76.76, "cnt": 3}, "forward-compute":{"total": 2506.15, "avg": 78.32, "max": 56.03, "min": 283.03, "cnt": 32}, "fwd-compute":{"total": 2502.70, "avg": 78.21, "max": 55.96, "min": 282.94, "cnt": 32}, "batch-generator":{"total": 60.09, "avg": 1.88, "max": 0.70, "min": 3.67, "cnt": 32}, "fwd-embedding":{"total": 0.70, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 2429.59, "avg": 75.92, "max": 54.94, "min": 280.35, "cnt": 32}, "fwd-layernorm":{"total": 10.60, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 110.47, "avg": 0.86, "max": 0.74, "min": 1.58, "cnt": 128}, "fwd-misc":{"total": 22.63, "avg": 0.18, "max": 0.12, "min": 0.43, "cnt": 128}, "fwd-MLP":{"total": 2264.13, "avg": 17.69, "max": 10.90, "min": 237.74, "cnt": 128}, "MoE_L0_fwd":{"total": 1011.61, "avg": 31.61, "max": 13.44, "min": 237.66, "cnt": 32}, "MoEMLP":{"total": 2246.82, "avg": 17.55, "max": 10.79, "min": 237.61, "cnt": 128}, "MoE_L1_fwd":{"total": 459.12, "avg": 14.35, "max": 12.63, "min": 21.62, "cnt": 32}, "MoE_L2_fwd":{"total": 415.65, "avg": 12.99, "max": 11.76, "min": 16.95, "cnt": 32}, "MoE_L3_fwd":{"total": 366.78, "avg": 11.46, "max": 10.83, "min": 15.54, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 4.72, "avg": 2.36, "max": 0.61, "min": 4.12, "cnt": 2}, "forward-send-backward-recv":{"total": 233.18, "avg": 7.77, "max": 1.22, "min": 125.88, "cnt": 30}, "backward-compute":{"total": 1916.71, "avg": 59.90, "max": 54.96, "min": 151.97, "cnt": 32}, "MoE_L3_bwd":{"total": 505.19, "avg": 15.79, "max": 12.08, "min": 100.30, "cnt": 32}, "MoE_L2_bwd":{"total": 411.41, "avg": 12.86, "max": 11.89, "min": 20.94, "cnt": 32}, "MoE_L1_bwd":{"total": 409.71, "avg": 12.80, "max": 12.27, "min": 15.83, "cnt": 32}, "MoE_L0_bwd":{"total": 366.82, "avg": 11.46, "max": 11.01, "min": 13.43, "cnt": 32}, "backward-send-forward-recv":{"total": 8137.16, "avg": 280.59, "max": 2.04, "min": 1553.46, "cnt": 29}, "backward-send":{"total": 3.00, "avg": 1.00, "max": 0.94, "min": 1.07, "cnt": 3}, "backward-recv":{"total": 367.61, "avg": 183.81, "max": 65.53, "min": 302.09, "cnt": 2}, "backward-params-all-reduce":{"total": 486.76, "avg": 486.76, "max": 486.76, "min": 486.76, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 245.57, "avg": 245.57, "max": 245.57, "min": 245.57, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.40, "avg": 3.40, "max": 3.40, "min": 3.40, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 201.26, "avg": 201.26, "max": 201.26, "min": 201.26, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.96, "avg": 6.96, "max": 6.96, "min": 6.96, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 6, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 74.00, "avg": 24.67, "max": 1.38, "min": 71.18, "cnt": 3}, "forward-compute":{"total": 2153.93, "avg": 67.31, "max": 55.19, "min": 171.91, "cnt": 32}, "fwd-compute":{"total": 2150.70, "avg": 67.21, "max": 55.12, "min": 171.82, "cnt": 32}, "batch-generator":{"total": 55.47, "avg": 1.73, "max": 0.65, "min": 3.48, "cnt": 32}, "fwd-embedding":{"total": 0.60, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 2082.22, "avg": 65.07, "max": 54.15, "min": 169.93, "cnt": 32}, "fwd-layernorm":{"total": 10.15, "avg": 0.08, "max": 0.06, "min": 0.22, "cnt": 128}, "fwd-attn":{"total": 106.85, "avg": 0.83, "max": 0.74, "min": 1.54, "cnt": 128}, "fwd-misc":{"total": 21.93, "avg": 0.17, "max": 0.12, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1921.83, "avg": 15.01, "max": 10.96, "min": 126.99, "cnt": 128}, "MoE_L0_fwd":{"total": 705.69, "avg": 22.05, "max": 13.31, "min": 126.91, "cnt": 32}, "MoEMLP":{"total": 1904.99, "avg": 14.88, "max": 10.85, "min": 126.87, "cnt": 128}, "MoE_L1_fwd":{"total": 453.06, "avg": 14.16, "max": 12.96, "min": 16.31, "cnt": 32}, "MoE_L2_fwd":{"total": 379.94, "avg": 11.87, "max": 11.31, "min": 15.84, "cnt": 32}, "MoE_L3_fwd":{"total": 372.46, "avg": 11.64, "max": 10.89, "min": 12.50, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 2.76, "avg": 1.38, "max": 0.84, "min": 1.92, "cnt": 2}, "forward-send-backward-recv":{"total": 341.95, "avg": 11.40, "max": 1.33, "min": 148.07, "cnt": 30}, "backward-compute":{"total": 1917.43, "avg": 59.92, "max": 57.03, "min": 64.96, "cnt": 32}, "MoE_L3_bwd":{"total": 417.30, "avg": 13.04, "max": 11.76, "min": 14.82, "cnt": 32}, "MoE_L2_bwd":{"total": 381.37, "avg": 11.92, "max": 11.10, "min": 16.34, "cnt": 32}, "MoE_L1_bwd":{"total": 440.30, "avg": 13.76, "max": 13.31, "min": 15.99, "cnt": 32}, "MoE_L0_bwd":{"total": 459.44, "avg": 14.36, "max": 13.71, "min": 19.18, "cnt": 32}, "backward-send-forward-recv":{"total": 7050.45, "avg": 243.12, "max": 2.35, "min": 813.69, "cnt": 29}, "backward-send":{"total": 3.33, "avg": 1.11, "max": 0.98, "min": 1.21, "cnt": 3}, "backward-recv":{"total": 477.95, "avg": 238.97, "max": 175.11, "min": 302.84, "cnt": 2}, "backward-params-all-reduce":{"total": 486.17, "avg": 486.17, "max": 486.17, "min": 486.17, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 258.77, "avg": 258.77, "max": 258.77, "min": 258.77, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 214.61, "avg": 214.61, "max": 214.61, "min": 214.61, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.95, "avg": 6.95, "max": 6.95, "min": 6.95, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 7, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 80.84, "avg": 26.95, "max": 1.08, "min": 78.23, "cnt": 3}, "forward-compute":{"total": 2130.85, "avg": 66.59, "max": 59.92, "min": 85.50, "cnt": 32}, "fwd-compute":{"total": 2128.01, "avg": 66.50, "max": 59.85, "min": 85.41, "cnt": 32}, "batch-generator":{"total": 42.64, "avg": 1.33, "max": 0.66, "min": 2.74, "cnt": 32}, "fwd-embedding":{"total": 0.54, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 2073.06, "avg": 64.78, "max": 58.12, "min": 83.78, "cnt": 32}, "fwd-layernorm":{"total": 9.57, "avg": 0.07, "max": 0.06, "min": 0.22, "cnt": 128}, "fwd-attn":{"total": 107.17, "avg": 0.84, "max": 0.74, "min": 1.64, "cnt": 128}, "fwd-misc":{"total": 20.98, "avg": 0.16, "max": 0.11, "min": 0.45, "cnt": 128}, "fwd-MLP":{"total": 1914.23, "avg": 14.95, "max": 11.24, "min": 38.92, "cnt": 128}, "MoE_L0_fwd":{"total": 609.49, "avg": 19.05, "max": 14.68, "min": 38.85, "cnt": 32}, "MoEMLP":{"total": 1897.59, "avg": 14.82, "max": 11.13, "min": 38.80, "cnt": 128}, "MoE_L1_fwd":{"total": 401.72, "avg": 12.55, "max": 11.17, "min": 14.70, "cnt": 32}, "MoE_L2_fwd":{"total": 463.58, "avg": 14.49, "max": 13.77, "min": 20.14, "cnt": 32}, "MoE_L3_fwd":{"total": 428.84, "avg": 13.40, "max": 12.54, "min": 18.43, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 8.07, "avg": 4.04, "max": 0.77, "min": 7.31, "cnt": 2}, "forward-send-backward-recv":{"total": 185.02, "avg": 6.17, "max": 1.22, "min": 130.63, "cnt": 30}, "backward-compute":{"total": 2103.56, "avg": 65.74, "max": 64.35, "min": 68.28, "cnt": 32}, "MoE_L3_bwd":{"total": 453.03, "avg": 14.16, "max": 13.33, "min": 16.78, "cnt": 32}, "MoE_L2_bwd":{"total": 540.91, "avg": 16.90, "max": 16.27, "min": 18.98, "cnt": 32}, "MoE_L1_bwd":{"total": 376.34, "avg": 11.76, "max": 10.84, "min": 14.65, "cnt": 32}, "MoE_L0_bwd":{"total": 517.75, "avg": 16.18, "max": 15.75, "min": 16.67, "cnt": 32}, "backward-send-forward-recv":{"total": 6661.11, "avg": 229.69, "max": 2.02, "min": 632.92, "cnt": 29}, "backward-send":{"total": 1.91, "avg": 0.64, "max": 0.48, "min": 0.82, "cnt": 3}, "backward-recv":{"total": 125.19, "avg": 62.60, "max": 59.42, "min": 65.77, "cnt": 2}, "backward-params-all-reduce":{"total": 494.34, "avg": 494.34, "max": 494.34, "min": 494.34, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 252.48, "avg": 252.48, "max": 252.48, "min": 252.48, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.41, "avg": 3.41, "max": 3.41, "min": 3.41, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 208.35, "avg": 208.35, "max": 208.35, "min": 208.35, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.85, "avg": 6.85, "max": 6.85, "min": 6.85, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.47, "avg": 3.47, "max": 3.47, "min": 3.47, "cnt": 1}}}
{"type":"time", "iteration": 8, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 81.76, "avg": 27.25, "max": 1.02, "min": 79.64, "cnt": 3}, "forward-compute":{"total": 2092.02, "avg": 65.38, "max": 54.92, "min": 117.77, "cnt": 32}, "fwd-compute":{"total": 2088.68, "avg": 65.27, "max": 54.85, "min": 117.68, "cnt": 32}, "batch-generator":{"total": 45.29, "avg": 1.42, "max": 0.69, "min": 2.30, "cnt": 32}, "fwd-embedding":{"total": 0.59, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 2030.47, "avg": 63.45, "max": 53.75, "min": 115.36, "cnt": 32}, "fwd-layernorm":{"total": 10.32, "avg": 0.08, "max": 0.06, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 110.56, "avg": 0.86, "max": 0.74, "min": 1.57, "cnt": 128}, "fwd-misc":{"total": 22.14, "avg": 0.17, "max": 0.11, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1865.37, "avg": 14.57, "max": 11.08, "min": 71.40, "cnt": 128}, "MoE_L0_fwd":{"total": 553.35, "avg": 17.29, "max": 11.01, "min": 71.31, "cnt": 32}, "MoEMLP":{"total": 1848.10, "avg": 14.44, "max": 10.97, "min": 71.26, "cnt": 128}, "MoE_L1_fwd":{"total": 409.39, "avg": 12.79, "max": 11.25, "min": 17.44, "cnt": 32}, "MoE_L2_fwd":{"total": 489.16, "avg": 15.29, "max": 14.34, "min": 24.94, "cnt": 32}, "MoE_L3_fwd":{"total": 402.38, "avg": 12.57, "max": 11.78, "min": 15.53, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.61, "avg": 0.02, "max": 0.02, "min": 0.04, "cnt": 32}, "forward-send":{"total": 6.57, "avg": 3.28, "max": 1.17, "min": 5.40, "cnt": 2}, "forward-send-backward-recv":{"total": 326.28, "avg": 10.88, "max": 1.40, "min": 222.85, "cnt": 30}, "backward-compute":{"total": 1900.67, "avg": 59.40, "max": 55.45, "min": 63.01, "cnt": 32}, "MoE_L3_bwd":{"total": 434.16, "avg": 13.57, "max": 11.97, "min": 17.72, "cnt": 32}, "MoE_L2_bwd":{"total": 516.59, "avg": 16.14, "max": 15.64, "min": 16.91, "cnt": 32}, "MoE_L1_bwd":{"total": 366.56, "avg": 11.45, "max": 10.74, "min": 11.85, "cnt": 32}, "MoE_L0_bwd":{"total": 360.80, "avg": 11.28, "max": 10.18, "min": 12.17, "cnt": 32}, "backward-send-forward-recv":{"total": 6637.56, "avg": 228.88, "max": 1.48, "min": 572.92, "cnt": 29}, "backward-send":{"total": 1.53, "avg": 0.51, "max": 0.44, "min": 0.56, "cnt": 3}, "backward-recv":{"total": 348.20, "avg": 174.10, "max": 59.52, "min": 288.68, "cnt": 2}, "backward-params-all-reduce":{"total": 491.97, "avg": 491.97, "max": 491.97, "min": 491.97, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 251.60, "avg": 251.60, "max": 251.60, "min": 251.60, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 207.47, "avg": 207.47, "max": 207.47, "min": 207.47, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.99, "avg": 6.99, "max": 6.99, "min": 6.99, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 9, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.11, "avg": 0.11, "max": 0.11, "min": 0.11, "cnt": 1}, "forward-recv":{"total": 75.28, "avg": 25.09, "max": 1.18, "min": 72.87, "cnt": 3}, "forward-compute":{"total": 2057.54, "avg": 64.30, "max": 54.75, "min": 83.10, "cnt": 32}, "fwd-compute":{"total": 2054.12, "avg": 64.19, "max": 54.68, "min": 83.00, "cnt": 32}, "batch-generator":{"total": 61.17, "avg": 1.91, "max": 0.69, "min": 4.69, "cnt": 32}, "fwd-embedding":{"total": 0.64, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1979.71, "avg": 61.87, "max": 53.66, "min": 80.50, "cnt": 32}, "fwd-layernorm":{"total": 10.67, "avg": 0.08, "max": 0.06, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 113.40, "avg": 0.89, "max": 0.74, "min": 2.97, "cnt": 128}, "fwd-misc":{"total": 23.03, "avg": 0.18, "max": 0.11, "min": 0.75, "cnt": 128}, "fwd-MLP":{"total": 1810.62, "avg": 14.15, "max": 11.24, "min": 37.13, "cnt": 128}, "MoE_L0_fwd":{"total": 572.79, "avg": 17.90, "max": 12.44, "min": 37.04, "cnt": 32}, "MoEMLP":{"total": 1793.38, "avg": 14.01, "max": 11.12, "min": 36.99, "cnt": 128}, "MoE_L1_fwd":{"total": 417.03, "avg": 13.03, "max": 11.83, "min": 16.06, "cnt": 32}, "MoE_L2_fwd":{"total": 395.08, "avg": 12.35, "max": 11.17, "min": 14.09, "cnt": 32}, "MoE_L3_fwd":{"total": 414.81, "avg": 12.96, "max": 12.24, "min": 15.15, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 9.91, "avg": 4.95, "max": 0.83, "min": 9.07, "cnt": 2}, "forward-send-backward-recv":{"total": 444.27, "avg": 14.81, "max": 0.94, "min": 156.60, "cnt": 30}, "backward-compute":{"total": 1711.68, "avg": 53.49, "max": 49.23, "min": 57.55, "cnt": 32}, "MoE_L3_bwd":{"total": 428.35, "avg": 13.39, "max": 12.04, "min": 15.68, "cnt": 32}, "MoE_L2_bwd":{"total": 357.85, "avg": 11.18, "max": 10.06, "min": 12.73, "cnt": 32}, "MoE_L1_bwd":{"total": 360.83, "avg": 11.28, "max": 10.56, "min": 13.59, "cnt": 32}, "MoE_L0_bwd":{"total": 340.45, "avg": 10.64, "max": 9.89, "min": 12.55, "cnt": 32}, "backward-send-forward-recv":{"total": 5456.57, "avg": 188.16, "max": 2.21, "min": 569.46, "cnt": 29}, "backward-send":{"total": 3.19, "avg": 1.06, "max": 0.96, "min": 1.14, "cnt": 3}, "backward-recv":{"total": 358.81, "avg": 179.41, "max": 112.92, "min": 245.90, "cnt": 2}, "backward-params-all-reduce":{"total": 489.21, "avg": 489.21, "max": 489.21, "min": 489.21, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 209.17, "avg": 209.17, "max": 209.17, "min": 209.17, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.40, "avg": 3.40, "max": 3.40, "min": 3.40, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 198.68, "avg": 198.68, "max": 198.68, "min": 198.68, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.96, "avg": 6.96, "max": 6.96, "min": 6.96, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}}}
{"type":"time", "iteration": 10, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.11, "avg": 0.11, "max": 0.11, "min": 0.11, "cnt": 1}, "forward-recv":{"total": 117.00, "avg": 39.00, "max": 1.21, "min": 114.55, "cnt": 3}, "forward-compute":{"total": 3622.03, "avg": 113.19, "max": 50.40, "min": 1848.88, "cnt": 32}, "fwd-compute":{"total": 3618.50, "avg": 113.08, "max": 50.31, "min": 1848.75, "cnt": 32}, "batch-generator":{"total": 59.19, "avg": 1.85, "max": 0.88, "min": 4.53, "cnt": 32}, "fwd-embedding":{"total": 0.61, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 3545.89, "avg": 110.81, "max": 48.85, "min": 1847.31, "cnt": 32}, "fwd-layernorm":{"total": 10.50, "avg": 0.08, "max": 0.06, "min": 0.24, "cnt": 128}, "fwd-attn":{"total": 111.10, "avg": 0.87, "max": 0.74, "min": 3.72, "cnt": 128}, "fwd-misc":{"total": 22.18, "avg": 0.17, "max": 0.12, "min": 0.43, "cnt": 128}, "fwd-MLP":{"total": 3379.71, "avg": 26.40, "max": 9.73, "min": 1269.90, "cnt": 128}, "MoE_L0_fwd":{"total": 523.29, "avg": 16.35, "max": 12.24, "min": 25.41, "cnt": 32}, "MoEMLP":{"total": 3362.61, "avg": 26.27, "max": 9.60, "min": 1269.76, "cnt": 128}, "MoE_L1_fwd":{"total": 1618.96, "avg": 50.59, "max": 9.64, "min": 1269.81, "cnt": 32}, "MoE_L2_fwd":{"total": 692.96, "avg": 21.66, "max": 10.20, "min": 353.97, "cnt": 32}, "MoE_L3_fwd":{"total": 533.69, "avg": 16.68, "max": 10.01, "min": 194.04, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1641.31, "avg": 820.65, "max": 0.77, "min": 1640.54, "cnt": 2}, "forward-send-backward-recv":{"total": 348.28, "avg": 11.61, "max": 1.08, "min": 139.70, "cnt": 30}, "backward-compute":{"total": 1503.78, "avg": 46.99, "max": 45.17, "min": 49.66, "cnt": 32}, "MoE_L3_bwd":{"total": 349.77, "avg": 10.93, "max": 10.12, "min": 12.68, "cnt": 32}, "MoE_L2_bwd":{"total": 306.84, "avg": 9.59, "max": 8.66, "min": 10.26, "cnt": 32}, "MoE_L1_bwd":{"total": 266.53, "avg": 8.33, "max": 7.51, "min": 9.50, "cnt": 32}, "MoE_L0_bwd":{"total": 345.87, "avg": 10.81, "max": 10.18, "min": 13.47, "cnt": 32}, "backward-send-forward-recv":{"total": 5052.15, "avg": 174.21, "max": 2.19, "min": 547.91, "cnt": 29}, "backward-send":{"total": 2.83, "avg": 0.94, "max": 0.82, "min": 1.04, "cnt": 3}, "backward-recv":{"total": 287.19, "avg": 143.59, "max": 84.50, "min": 202.68, "cnt": 2}, "backward-params-all-reduce":{"total": 490.46, "avg": 490.46, "max": 490.46, "min": 490.46, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.04, "avg": 0.04, "max": 0.04, "min": 0.04, "cnt": 1}, "optimizer":{"total": 234.85, "avg": 234.85, "max": 234.85, "min": 234.85, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 203.77, "avg": 203.77, "max": 203.77, "min": 203.77, "cnt": 1}, "optimizer-clip-main-grad":{"total": 7.41, "avg": 7.41, "max": 7.41, "min": 7.41, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}}}
{"type":"time", "iteration": 11, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.13, "avg": 0.13, "max": 0.13, "min": 0.13, "cnt": 1}, "forward-recv":{"total": 71.33, "avg": 23.78, "max": 1.30, "min": 67.14, "cnt": 3}, "forward-compute":{"total": 1822.16, "avg": 56.94, "max": 50.65, "min": 66.68, "cnt": 32}, "fwd-compute":{"total": 1819.04, "avg": 56.84, "max": 50.58, "min": 66.60, "cnt": 32}, "batch-generator":{"total": 72.37, "avg": 2.26, "max": 0.72, "min": 4.97, "cnt": 32}, "fwd-embedding":{"total": 0.60, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1734.17, "avg": 54.19, "max": 49.43, "min": 62.68, "cnt": 32}, "fwd-layernorm":{"total": 10.36, "avg": 0.08, "max": 0.06, "min": 0.23, "cnt": 128}, "fwd-attn":{"total": 107.11, "avg": 0.84, "max": 0.74, "min": 1.94, "cnt": 128}, "fwd-misc":{"total": 21.75, "avg": 0.17, "max": 0.12, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1573.51, "avg": 12.29, "max": 9.72, "min": 21.21, "cnt": 128}, "MoE_L0_fwd":{"total": 516.71, "avg": 16.15, "max": 12.61, "min": 21.12, "cnt": 32}, "MoEMLP":{"total": 1556.94, "avg": 12.16, "max": 9.60, "min": 21.07, "cnt": 128}, "MoE_L1_fwd":{"total": 345.65, "avg": 10.80, "max": 9.65, "min": 13.75, "cnt": 32}, "MoE_L2_fwd":{"total": 355.72, "avg": 11.12, "max": 10.00, "min": 15.64, "cnt": 32}, "MoE_L3_fwd":{"total": 344.98, "avg": 10.78, "max": 9.92, "min": 11.69, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.56, "avg": 0.78, "max": 0.76, "min": 0.80, "cnt": 2}, "forward-send-backward-recv":{"total": 862.85, "avg": 28.76, "max": 1.54, "min": 207.38, "cnt": 30}, "backward-compute":{"total": 1515.24, "avg": 47.35, "max": 45.50, "min": 52.40, "cnt": 32}, "MoE_L3_bwd":{"total": 357.77, "avg": 11.18, "max": 9.96, "min": 13.07, "cnt": 32}, "MoE_L2_bwd":{"total": 297.18, "avg": 9.29, "max": 8.45, "min": 10.83, "cnt": 32}, "MoE_L1_bwd":{"total": 258.17, "avg": 8.07, "max": 7.19, "min": 8.57, "cnt": 32}, "MoE_L0_bwd":{"total": 348.81, "avg": 10.90, "max": 9.93, "min": 14.21, "cnt": 32}, "backward-send-forward-recv":{"total": 5944.90, "avg": 205.00, "max": 1.75, "min": 883.52, "cnt": 29}, "backward-send":{"total": 3.01, "avg": 1.00, "max": 0.86, "min": 1.13, "cnt": 3}, "backward-recv":{"total": 494.84, "avg": 247.42, "max": 74.23, "min": 420.61, "cnt": 2}, "backward-params-all-reduce":{"total": 487.69, "avg": 487.69, "max": 487.69, "min": 487.69, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "optimizer":{"total": 214.21, "avg": 214.21, "max": 214.21, "min": 214.21, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.41, "avg": 3.41, "max": 3.41, "min": 3.41, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 203.74, "avg": 203.74, "max": 203.74, "min": 203.74, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.84, "avg": 6.84, "max": 6.84, "min": 6.84, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}}}
{"type":"time", "iteration": 12, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 87.66, "avg": 29.22, "max": 4.77, "min": 78.07, "cnt": 3}, "forward-compute":{"total": 1857.21, "avg": 58.04, "max": 50.17, "min": 100.34, "cnt": 32}, "fwd-compute":{"total": 1853.74, "avg": 57.93, "max": 50.10, "min": 100.26, "cnt": 32}, "batch-generator":{"total": 102.67, "avg": 3.21, "max": 0.69, "min": 45.01, "cnt": 32}, "fwd-embedding":{"total": 0.65, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1738.20, "avg": 54.32, "max": 49.10, "min": 63.43, "cnt": 32}, "fwd-layernorm":{"total": 10.24, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 107.56, "avg": 0.84, "max": 0.74, "min": 2.30, "cnt": 128}, "fwd-misc":{"total": 21.26, "avg": 0.17, "max": 0.12, "min": 0.42, "cnt": 128}, "fwd-MLP":{"total": 1577.88, "avg": 12.33, "max": 9.63, "min": 21.22, "cnt": 128}, "MoE_L0_fwd":{"total": 517.20, "avg": 16.16, "max": 12.73, "min": 21.14, "cnt": 32}, "MoEMLP":{"total": 1561.48, "avg": 12.20, "max": 9.53, "min": 21.10, "cnt": 128}, "MoE_L1_fwd":{"total": 350.20, "avg": 10.94, "max": 9.56, "min": 14.74, "cnt": 32}, "MoE_L2_fwd":{"total": 350.83, "avg": 10.96, "max": 9.90, "min": 15.41, "cnt": 32}, "MoE_L3_fwd":{"total": 349.35, "avg": 10.92, "max": 10.21, "min": 13.05, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.80, "avg": 0.90, "max": 0.85, "min": 0.95, "cnt": 2}, "forward-send-backward-recv":{"total": 753.11, "avg": 25.10, "max": 1.63, "min": 230.73, "cnt": 30}, "backward-compute":{"total": 1495.56, "avg": 46.74, "max": 44.37, "min": 53.82, "cnt": 32}, "MoE_L3_bwd":{"total": 354.27, "avg": 11.07, "max": 9.24, "min": 13.11, "cnt": 32}, "MoE_L2_bwd":{"total": 301.00, "avg": 9.41, "max": 8.56, "min": 10.50, "cnt": 32}, "MoE_L1_bwd":{"total": 264.79, "avg": 8.27, "max": 7.71, "min": 13.31, "cnt": 32}, "MoE_L0_bwd":{"total": 337.28, "avg": 10.54, "max": 9.93, "min": 11.72, "cnt": 32}, "backward-send-forward-recv":{"total": 5415.73, "avg": 186.75, "max": 2.23, "min": 528.55, "cnt": 29}, "backward-send":{"total": 2.51, "avg": 0.84, "max": 0.62, "min": 0.96, "cnt": 3}, "backward-recv":{"total": 578.01, "avg": 289.00, "max": 139.54, "min": 438.47, "cnt": 2}, "backward-params-all-reduce":{"total": 483.53, "avg": 483.53, "max": 483.53, "min": 483.53, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 214.51, "avg": 214.51, "max": 214.51, "min": 214.51, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 204.15, "avg": 204.15, "max": 204.15, "min": 204.15, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.76, "avg": 6.76, "max": 6.76, "min": 6.76, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}}}
{"type":"time", "iteration": 13, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.10, "avg": 0.10, "max": 0.10, "min": 0.10, "cnt": 1}, "forward-recv":{"total": 88.94, "avg": 29.65, "max": 4.19, "min": 79.04, "cnt": 3}, "forward-compute":{"total": 1826.15, "avg": 57.07, "max": 50.67, "min": 70.16, "cnt": 32}, "fwd-compute":{"total": 1822.77, "avg": 56.96, "max": 50.58, "min": 70.08, "cnt": 32}, "batch-generator":{"total": 59.00, "avg": 1.84, "max": 0.69, "min": 4.65, "cnt": 32}, "fwd-embedding":{"total": 0.59, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1750.68, "avg": 54.71, "max": 49.03, "min": 66.07, "cnt": 32}, "fwd-layernorm":{"total": 10.22, "avg": 0.08, "max": 0.06, "min": 0.25, "cnt": 128}, "fwd-attn":{"total": 107.26, "avg": 0.84, "max": 0.74, "min": 1.91, "cnt": 128}, "fwd-misc":{"total": 21.43, "avg": 0.17, "max": 0.11, "min": 0.43, "cnt": 128}, "fwd-MLP":{"total": 1589.97, "avg": 12.42, "max": 9.54, "min": 27.99, "cnt": 128}, "MoE_L0_fwd":{"total": 534.13, "avg": 16.69, "max": 12.74, "min": 27.92, "cnt": 32}, "MoEMLP":{"total": 1573.15, "avg": 12.29, "max": 9.43, "min": 27.87, "cnt": 128}, "MoE_L1_fwd":{"total": 350.11, "avg": 10.94, "max": 9.47, "min": 15.73, "cnt": 32}, "MoE_L2_fwd":{"total": 347.72, "avg": 10.87, "max": 10.23, "min": 12.91, "cnt": 32}, "MoE_L3_fwd":{"total": 347.34, "avg": 10.85, "max": 9.91, "min": 12.96, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.50, "avg": 0.75, "max": 0.59, "min": 0.91, "cnt": 2}, "forward-send-backward-recv":{"total": 192.39, "avg": 6.41, "max": 1.23, "min": 113.61, "cnt": 30}, "backward-compute":{"total": 1487.19, "avg": 46.47, "max": 44.97, "min": 51.53, "cnt": 32}, "MoE_L3_bwd":{"total": 344.92, "avg": 10.78, "max": 10.01, "min": 11.81, "cnt": 32}, "MoE_L2_bwd":{"total": 306.74, "avg": 9.59, "max": 8.90, "min": 10.39, "cnt": 32}, "MoE_L1_bwd":{"total": 264.01, "avg": 8.25, "max": 7.54, "min": 10.81, "cnt": 32}, "MoE_L0_bwd":{"total": 342.36, "avg": 10.70, "max": 9.82, "min": 15.64, "cnt": 32}, "backward-send-forward-recv":{"total": 7140.55, "avg": 246.23, "max": 2.15, "min": 1579.79, "cnt": 29}, "backward-send":{"total": 2.93, "avg": 0.98, "max": 0.95, "min": 1.02, "cnt": 3}, "backward-recv":{"total": 287.31, "avg": 143.66, "max": 84.12, "min": 203.19, "cnt": 2}, "backward-params-all-reduce":{"total": 500.25, "avg": 500.25, "max": 500.25, "min": 500.25, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.04, "avg": 0.04, "max": 0.04, "min": 0.04, "cnt": 1}, "optimizer":{"total": 247.95, "avg": 247.95, "max": 247.95, "min": 247.95, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 203.54, "avg": 203.54, "max": 203.54, "min": 203.54, "cnt": 1}, "optimizer-clip-main-grad":{"total": 7.06, "avg": 7.06, "max": 7.06, "min": 7.06, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.48, "avg": 3.48, "max": 3.48, "min": 3.48, "cnt": 1}}}
{"type":"time", "iteration": 14, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 71.69, "avg": 23.90, "max": 1.14, "min": 67.54, "cnt": 3}, "forward-compute":{"total": 1850.67, "avg": 57.83, "max": 51.43, "min": 63.79, "cnt": 32}, "fwd-compute":{"total": 1847.41, "avg": 57.73, "max": 51.36, "min": 63.71, "cnt": 32}, "batch-generator":{"total": 58.08, "avg": 1.81, "max": 0.75, "min": 3.77, "cnt": 32}, "fwd-embedding":{"total": 0.58, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1776.39, "avg": 55.51, "max": 50.13, "min": 61.23, "cnt": 32}, "fwd-layernorm":{"total": 10.24, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 107.80, "avg": 0.84, "max": 0.74, "min": 1.57, "cnt": 128}, "fwd-misc":{"total": 22.01, "avg": 0.17, "max": 0.12, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1614.48, "avg": 12.61, "max": 9.46, "min": 18.51, "cnt": 128}, "MoE_L0_fwd":{"total": 485.74, "avg": 15.18, "max": 11.70, "min": 18.35, "cnt": 32}, "MoEMLP":{"total": 1597.50, "avg": 12.48, "max": 9.36, "min": 18.26, "cnt": 128}, "MoE_L1_fwd":{"total": 402.89, "avg": 12.59, "max": 11.29, "min": 14.60, "cnt": 32}, "MoE_L2_fwd":{"total": 319.50, "avg": 9.98, "max": 9.40, "min": 12.90, "cnt": 32}, "MoE_L3_fwd":{"total": 395.59, "avg": 12.36, "max": 11.74, "min": 13.90, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 6.10, "avg": 3.05, "max": 0.96, "min": 5.15, "cnt": 2}, "forward-send-backward-recv":{"total": 213.95, "avg": 7.13, "max": 1.40, "min": 135.17, "cnt": 30}, "backward-compute":{"total": 1726.21, "avg": 53.94, "max": 50.44, "min": 56.45, "cnt": 32}, "MoE_L3_bwd":{"total": 396.79, "avg": 12.40, "max": 10.72, "min": 14.31, "cnt": 32}, "MoE_L2_bwd":{"total": 329.46, "avg": 10.30, "max": 9.67, "min": 10.81, "cnt": 32}, "MoE_L1_bwd":{"total": 411.06, "avg": 12.85, "max": 12.20, "min": 13.24, "cnt": 32}, "MoE_L0_bwd":{"total": 366.03, "avg": 11.44, "max": 10.70, "min": 13.95, "cnt": 32}, "backward-send-forward-recv":{"total": 6197.11, "avg": 213.69, "max": 2.35, "min": 858.83, "cnt": 29}, "backward-send":{"total": 3.53, "avg": 1.18, "max": 1.09, "min": 1.23, "cnt": 3}, "backward-recv":{"total": 141.08, "avg": 70.54, "max": 65.46, "min": 75.63, "cnt": 2}, "backward-params-all-reduce":{"total": 490.62, "avg": 490.62, "max": 490.62, "min": 490.62, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 246.18, "avg": 246.18, "max": 246.18, "min": 246.18, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.40, "avg": 3.40, "max": 3.40, "min": 3.40, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 201.87, "avg": 201.87, "max": 201.87, "min": 201.87, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.99, "avg": 6.99, "max": 6.99, "min": 6.99, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.50, "avg": 3.50, "max": 3.50, "min": 3.50, "cnt": 1}}}
{"type":"time", "iteration": 15, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 78.18, "avg": 26.06, "max": 1.08, "min": 73.75, "cnt": 3}, "forward-compute":{"total": 1901.96, "avg": 59.44, "max": 53.22, "min": 70.94, "cnt": 32}, "fwd-compute":{"total": 1898.48, "avg": 59.33, "max": 53.13, "min": 70.86, "cnt": 32}, "batch-generator":{"total": 55.57, "avg": 1.74, "max": 0.74, "min": 4.94, "cnt": 32}, "fwd-embedding":{"total": 0.68, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1829.38, "avg": 57.17, "max": 51.70, "min": 69.53, "cnt": 32}, "fwd-layernorm":{"total": 10.90, "avg": 0.09, "max": 0.06, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 110.95, "avg": 0.87, "max": 0.74, "min": 1.60, "cnt": 128}, "fwd-misc":{"total": 23.08, "avg": 0.18, "max": 0.12, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1661.82, "avg": 12.98, "max": 9.58, "min": 26.13, "cnt": 128}, "MoE_L0_fwd":{"total": 503.45, "avg": 15.73, "max": 11.90, "min": 26.05, "cnt": 32}, "MoEMLP":{"total": 1644.06, "avg": 12.84, "max": 9.47, "min": 26.01, "cnt": 128}, "MoE_L1_fwd":{"total": 414.66, "avg": 12.96, "max": 11.75, "min": 15.28, "cnt": 32}, "MoE_L2_fwd":{"total": 317.25, "avg": 9.91, "max": 9.51, "min": 10.59, "cnt": 32}, "MoE_L3_fwd":{"total": 415.15, "avg": 12.97, "max": 12.11, "min": 16.39, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.62, "avg": 0.02, "max": 0.02, "min": 0.04, "cnt": 32}, "forward-send":{"total": 10.53, "avg": 5.26, "max": 0.89, "min": 9.64, "cnt": 2}, "forward-send-backward-recv":{"total": 681.05, "avg": 22.70, "max": 1.02, "min": 165.72, "cnt": 30}, "backward-compute":{"total": 1733.03, "avg": 54.16, "max": 51.49, "min": 56.91, "cnt": 32}, "MoE_L3_bwd":{"total": 420.96, "avg": 13.16, "max": 12.09, "min": 15.51, "cnt": 32}, "MoE_L2_bwd":{"total": 322.73, "avg": 10.09, "max": 8.35, "min": 10.76, "cnt": 32}, "MoE_L1_bwd":{"total": 406.75, "avg": 12.71, "max": 12.03, "min": 13.11, "cnt": 32}, "MoE_L0_bwd":{"total": 357.69, "avg": 11.18, "max": 10.50, "min": 11.48, "cnt": 32}, "backward-send-forward-recv":{"total": 4576.55, "avg": 157.81, "max": 2.24, "min": 749.56, "cnt": 29}, "backward-send":{"total": 2.77, "avg": 0.92, "max": 0.79, "min": 1.00, "cnt": 3}, "backward-recv":{"total": 395.89, "avg": 197.94, "max": 67.38, "min": 328.51, "cnt": 2}, "backward-params-all-reduce":{"total": 485.97, "avg": 485.97, "max": 485.97, "min": 485.97, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 243.35, "avg": 243.35, "max": 243.35, "min": 243.35, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.41, "avg": 3.41, "max": 3.41, "min": 3.41, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 198.86, "avg": 198.86, "max": 198.86, "min": 198.86, "cnt": 1}, "optimizer-clip-main-grad":{"total": 7.22, "avg": 7.22, "max": 7.22, "min": 7.22, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.48, "avg": 3.48, "max": 3.48, "min": 3.48, "cnt": 1}}}
{"type":"time", "iteration": 16, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 102.58, "avg": 34.19, "max": 10.36, "min": 81.25, "cnt": 3}, "forward-compute":{"total": 1880.43, "avg": 58.76, "max": 51.84, "min": 69.06, "cnt": 32}, "fwd-compute":{"total": 1877.41, "avg": 58.67, "max": 51.77, "min": 68.98, "cnt": 32}, "batch-generator":{"total": 54.21, "avg": 1.69, "max": 0.69, "min": 4.14, "cnt": 32}, "fwd-embedding":{"total": 0.57, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1811.09, "avg": 56.60, "max": 50.78, "min": 67.42, "cnt": 32}, "fwd-layernorm":{"total": 9.96, "avg": 0.08, "max": 0.06, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 105.60, "avg": 0.83, "max": 0.74, "min": 1.53, "cnt": 128}, "fwd-misc":{"total": 21.30, "avg": 0.17, "max": 0.12, "min": 0.38, "cnt": 128}, "fwd-MLP":{"total": 1653.19, "avg": 12.92, "max": 9.62, "min": 26.28, "cnt": 128}, "MoE_L0_fwd":{"total": 483.00, "avg": 15.09, "max": 11.01, "min": 26.15, "cnt": 32}, "MoEMLP":{"total": 1636.53, "avg": 12.79, "max": 9.51, "min": 26.09, "cnt": 128}, "MoE_L1_fwd":{"total": 409.75, "avg": 12.80, "max": 11.70, "min": 16.22, "cnt": 32}, "MoE_L2_fwd":{"total": 331.19, "avg": 10.35, "max": 9.55, "min": 15.74, "cnt": 32}, "MoE_L3_fwd":{"total": 418.70, "avg": 13.08, "max": 11.50, "min": 16.69, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.55, "avg": 0.78, "max": 0.57, "min": 0.98, "cnt": 2}, "forward-send-backward-recv":{"total": 224.49, "avg": 7.48, "max": 1.49, "min": 117.80, "cnt": 30}, "backward-compute":{"total": 1723.50, "avg": 53.86, "max": 50.53, "min": 55.58, "cnt": 32}, "MoE_L3_bwd":{"total": 418.36, "avg": 13.07, "max": 12.48, "min": 14.37, "cnt": 32}, "MoE_L2_bwd":{"total": 321.50, "avg": 10.05, "max": 9.44, "min": 10.75, "cnt": 32}, "MoE_L1_bwd":{"total": 404.37, "avg": 12.64, "max": 11.96, "min": 13.17, "cnt": 32}, "MoE_L0_bwd":{"total": 356.20, "avg": 11.13, "max": 10.50, "min": 12.48, "cnt": 32}, "backward-send-forward-recv":{"total": 6476.17, "avg": 223.32, "max": 2.28, "min": 1329.22, "cnt": 29}, "backward-send":{"total": 2.92, "avg": 0.97, "max": 0.86, "min": 1.10, "cnt": 3}, "backward-recv":{"total": 139.61, "avg": 69.81, "max": 69.20, "min": 70.42, "cnt": 2}, "backward-params-all-reduce":{"total": 486.94, "avg": 486.94, "max": 486.94, "min": 486.94, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 248.23, "avg": 248.23, "max": 248.23, "min": 248.23, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.41, "avg": 3.41, "max": 3.41, "min": 3.41, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 204.08, "avg": 204.08, "max": 204.08, "min": 204.08, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.77, "avg": 6.77, "max": 6.77, "min": 6.77, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 17, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.11, "avg": 0.11, "max": 0.11, "min": 0.11, "cnt": 1}, "forward-recv":{"total": 150.75, "avg": 50.25, "max": 1.09, "min": 148.36, "cnt": 3}, "forward-compute":{"total": 1859.94, "avg": 58.12, "max": 52.35, "min": 69.09, "cnt": 32}, "fwd-compute":{"total": 1856.71, "avg": 58.02, "max": 52.27, "min": 69.00, "cnt": 32}, "batch-generator":{"total": 49.90, "avg": 1.56, "max": 0.73, "min": 3.29, "cnt": 32}, "fwd-embedding":{"total": 0.56, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1794.07, "avg": 56.06, "max": 51.16, "min": 66.69, "cnt": 32}, "fwd-layernorm":{"total": 10.09, "avg": 0.08, "max": 0.06, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 107.49, "avg": 0.84, "max": 0.74, "min": 1.55, "cnt": 128}, "fwd-misc":{"total": 21.61, "avg": 0.17, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1633.16, "avg": 12.76, "max": 9.46, "min": 25.03, "cnt": 128}, "MoE_L0_fwd":{"total": 487.38, "avg": 15.23, "max": 11.33, "min": 24.85, "cnt": 32}, "MoEMLP":{"total": 1615.95, "avg": 12.62, "max": 9.36, "min": 24.76, "cnt": 128}, "MoE_L1_fwd":{"total": 406.37, "avg": 12.70, "max": 11.76, "min": 15.56, "cnt": 32}, "MoE_L2_fwd":{"total": 316.41, "avg": 9.89, "max": 9.40, "min": 11.57, "cnt": 32}, "MoE_L3_fwd":{"total": 411.99, "avg": 12.87, "max": 12.38, "min": 13.57, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.05, "cnt": 32}, "forward-send":{"total": 1.85, "avg": 0.92, "max": 0.89, "min": 0.95, "cnt": 2}, "forward-send-backward-recv":{"total": 318.78, "avg": 10.63, "max": 1.35, "min": 112.12, "cnt": 30}, "backward-compute":{"total": 1726.07, "avg": 53.94, "max": 51.16, "min": 57.30, "cnt": 32}, "MoE_L3_bwd":{"total": 417.30, "avg": 13.04, "max": 12.21, "min": 14.24, "cnt": 32}, "MoE_L2_bwd":{"total": 322.99, "avg": 10.09, "max": 9.22, "min": 11.02, "cnt": 32}, "MoE_L1_bwd":{"total": 412.80, "avg": 12.90, "max": 11.72, "min": 13.83, "cnt": 32}, "MoE_L0_bwd":{"total": 349.90, "avg": 10.93, "max": 10.23, "min": 13.29, "cnt": 32}, "backward-send-forward-recv":{"total": 6163.63, "avg": 212.54, "max": 2.27, "min": 679.34, "cnt": 29}, "backward-send":{"total": 2.97, "avg": 0.99, "max": 0.86, "min": 1.09, "cnt": 3}, "backward-recv":{"total": 467.51, "avg": 233.75, "max": 67.07, "min": 400.44, "cnt": 2}, "backward-params-all-reduce":{"total": 485.77, "avg": 485.77, "max": 485.77, "min": 485.77, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.05, "avg": 0.05, "max": 0.05, "min": 0.05, "cnt": 1}, "optimizer":{"total": 244.82, "avg": 244.82, "max": 244.82, "min": 244.82, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.41, "avg": 3.41, "max": 3.41, "min": 3.41, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 200.46, "avg": 200.46, "max": 200.46, "min": 200.46, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.83, "avg": 6.83, "max": 6.83, "min": 6.83, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.47, "avg": 3.47, "max": 3.47, "min": 3.47, "cnt": 1}}}
{"type":"time", "iteration": 18, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 90.10, "avg": 30.03, "max": 1.60, "min": 86.51, "cnt": 3}, "forward-compute":{"total": 1840.47, "avg": 57.51, "max": 50.80, "min": 62.06, "cnt": 32}, "fwd-compute":{"total": 1837.26, "avg": 57.41, "max": 50.74, "min": 61.97, "cnt": 32}, "batch-generator":{"total": 52.64, "avg": 1.64, "max": 0.66, "min": 3.63, "cnt": 32}, "fwd-embedding":{"total": 0.53, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1772.41, "avg": 55.39, "max": 49.76, "min": 60.56, "cnt": 32}, "fwd-layernorm":{"total": 9.64, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 106.28, "avg": 0.83, "max": 0.74, "min": 1.55, "cnt": 128}, "fwd-misc":{"total": 21.09, "avg": 0.16, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1615.03, "avg": 12.62, "max": 9.75, "min": 20.41, "cnt": 128}, "MoE_L0_fwd":{"total": 458.59, "avg": 14.33, "max": 10.99, "min": 20.33, "cnt": 32}, "MoEMLP":{"total": 1598.67, "avg": 12.49, "max": 9.63, "min": 20.28, "cnt": 128}, "MoE_L1_fwd":{"total": 394.32, "avg": 12.32, "max": 11.20, "min": 15.40, "cnt": 32}, "MoE_L2_fwd":{"total": 337.19, "avg": 10.54, "max": 9.67, "min": 16.51, "cnt": 32}, "MoE_L3_fwd":{"total": 414.56, "avg": 12.96, "max": 12.40, "min": 13.69, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.69, "avg": 0.84, "max": 0.81, "min": 0.88, "cnt": 2}, "forward-send-backward-recv":{"total": 191.33, "avg": 6.38, "max": 1.26, "min": 123.42, "cnt": 30}, "backward-compute":{"total": 1761.90, "avg": 55.06, "max": 51.98, "min": 56.70, "cnt": 32}, "MoE_L3_bwd":{"total": 437.56, "avg": 13.67, "max": 12.65, "min": 15.67, "cnt": 32}, "MoE_L2_bwd":{"total": 337.25, "avg": 10.54, "max": 9.92, "min": 11.17, "cnt": 32}, "MoE_L1_bwd":{"total": 396.52, "avg": 12.39, "max": 11.69, "min": 13.29, "cnt": 32}, "MoE_L0_bwd":{"total": 372.76, "avg": 11.65, "max": 11.00, "min": 12.13, "cnt": 32}, "backward-send-forward-recv":{"total": 7394.16, "avg": 254.97, "max": 2.08, "min": 1045.16, "cnt": 29}, "backward-send":{"total": 2.54, "avg": 0.85, "max": 0.68, "min": 1.09, "cnt": 3}, "backward-recv":{"total": 129.08, "avg": 64.54, "max": 62.84, "min": 66.25, "cnt": 2}, "backward-params-all-reduce":{"total": 487.93, "avg": 487.93, "max": 487.93, "min": 487.93, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 252.41, "avg": 252.41, "max": 252.41, "min": 252.41, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.40, "avg": 3.40, "max": 3.40, "min": 3.40, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 208.08, "avg": 208.08, "max": 208.08, "min": 208.08, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.98, "avg": 6.98, "max": 6.98, "min": 6.98, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.49, "avg": 3.49, "max": 3.49, "min": 3.49, "cnt": 1}}}
{"type":"time", "iteration": 19, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.10, "avg": 0.10, "max": 0.10, "min": 0.10, "cnt": 1}, "forward-recv":{"total": 81.92, "avg": 27.31, "max": 0.92, "min": 77.90, "cnt": 3}, "forward-compute":{"total": 1875.88, "avg": 58.62, "max": 52.02, "min": 78.36, "cnt": 32}, "fwd-compute":{"total": 1872.89, "avg": 58.53, "max": 51.93, "min": 78.27, "cnt": 32}, "batch-generator":{"total": 52.03, "avg": 1.63, "max": 0.66, "min": 4.26, "cnt": 32}, "fwd-embedding":{"total": 0.57, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1808.51, "avg": 56.52, "max": 50.50, "min": 75.81, "cnt": 32}, "fwd-layernorm":{"total": 9.67, "avg": 0.08, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 106.29, "avg": 0.83, "max": 0.74, "min": 1.97, "cnt": 128}, "fwd-misc":{"total": 21.44, "avg": 0.17, "max": 0.12, "min": 0.38, "cnt": 128}, "fwd-MLP":{"total": 1650.30, "avg": 12.89, "max": 10.01, "min": 23.66, "cnt": 128}, "MoE_L0_fwd":{"total": 478.54, "avg": 14.95, "max": 11.31, "min": 23.51, "cnt": 32}, "MoEMLP":{"total": 1633.81, "avg": 12.76, "max": 9.90, "min": 23.43, "cnt": 128}, "MoE_L1_fwd":{"total": 390.73, "avg": 12.21, "max": 10.82, "min": 20.39, "cnt": 32}, "MoE_L2_fwd":{"total": 351.16, "avg": 10.97, "max": 9.94, "min": 14.80, "cnt": 32}, "MoE_L3_fwd":{"total": 419.50, "avg": 13.11, "max": 12.29, "min": 16.93, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 11.67, "avg": 5.83, "max": 0.71, "min": 10.95, "cnt": 2}, "forward-send-backward-recv":{"total": 203.99, "avg": 6.80, "max": 1.25, "min": 122.18, "cnt": 30}, "backward-compute":{"total": 1745.57, "avg": 54.55, "max": 51.25, "min": 57.37, "cnt": 32}, "MoE_L3_bwd":{"total": 426.10, "avg": 13.32, "max": 12.32, "min": 16.03, "cnt": 32}, "MoE_L2_bwd":{"total": 327.87, "avg": 10.25, "max": 9.81, "min": 12.10, "cnt": 32}, "MoE_L1_bwd":{"total": 386.40, "avg": 12.07, "max": 10.23, "min": 12.84, "cnt": 32}, "MoE_L0_bwd":{"total": 379.65, "avg": 11.86, "max": 11.17, "min": 13.36, "cnt": 32}, "backward-send-forward-recv":{"total": 5420.72, "avg": 186.92, "max": 2.17, "min": 801.25, "cnt": 29}, "backward-send":{"total": 3.42, "avg": 1.14, "max": 1.06, "min": 1.21, "cnt": 3}, "backward-recv":{"total": 119.11, "avg": 59.55, "max": 58.54, "min": 60.56, "cnt": 2}, "backward-params-all-reduce":{"total": 490.33, "avg": 490.33, "max": 490.33, "min": 490.33, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "optimizer":{"total": 246.65, "avg": 246.65, "max": 246.65, "min": 246.65, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 202.29, "avg": 202.29, "max": 202.29, "min": 202.29, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.84, "avg": 6.84, "max": 6.84, "min": 6.84, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 20, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.11, "avg": 0.11, "max": 0.11, "min": 0.11, "cnt": 1}, "forward-recv":{"total": 1084.84, "avg": 361.61, "max": 0.73, "min": 1082.37, "cnt": 3}, "forward-compute":{"total": 1913.45, "avg": 59.80, "max": 51.19, "min": 67.84, "cnt": 32}, "fwd-compute":{"total": 1909.81, "avg": 59.68, "max": 51.12, "min": 67.70, "cnt": 32}, "batch-generator":{"total": 53.30, "avg": 1.67, "max": 0.69, "min": 4.38, "cnt": 32}, "fwd-embedding":{"total": 0.70, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1842.87, "avg": 57.59, "max": 50.13, "min": 64.72, "cnt": 32}, "fwd-layernorm":{"total": 10.95, "avg": 0.09, "max": 0.06, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 113.56, "avg": 0.89, "max": 0.74, "min": 2.03, "cnt": 128}, "fwd-misc":{"total": 23.29, "avg": 0.18, "max": 0.12, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1671.76, "avg": 13.06, "max": 9.73, "min": 20.71, "cnt": 128}, "MoE_L0_fwd":{"total": 506.64, "avg": 15.83, "max": 11.28, "min": 20.63, "cnt": 32}, "MoEMLP":{"total": 1653.62, "avg": 12.92, "max": 9.60, "min": 20.58, "cnt": 128}, "MoE_L1_fwd":{"total": 390.64, "avg": 12.21, "max": 11.04, "min": 15.11, "cnt": 32}, "MoE_L2_fwd":{"total": 337.12, "avg": 10.54, "max": 9.66, "min": 12.16, "cnt": 32}, "MoE_L3_fwd":{"total": 425.87, "avg": 13.31, "max": 11.95, "min": 18.07, "cnt": 32}, "fwd-pooler":{"total": 0.36, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.05, "cnt": 32}, "forward-send":{"total": 26.71, "avg": 13.36, "max": 0.87, "min": 25.84, "cnt": 2}, "forward-send-backward-recv":{"total": 218.14, "avg": 7.27, "max": 1.37, "min": 120.38, "cnt": 30}, "backward-compute":{"total": 1740.82, "avg": 54.40, "max": 52.14, "min": 57.77, "cnt": 32}, "MoE_L3_bwd":{"total": 435.78, "avg": 13.62, "max": 12.56, "min": 15.08, "cnt": 32}, "MoE_L2_bwd":{"total": 328.67, "avg": 10.27, "max": 9.42, "min": 12.29, "cnt": 32}, "MoE_L1_bwd":{"total": 387.91, "avg": 12.12, "max": 11.00, "min": 12.49, "cnt": 32}, "MoE_L0_bwd":{"total": 368.81, "avg": 11.53, "max": 10.97, "min": 11.97, "cnt": 32}, "backward-send-forward-recv":{"total": 6618.80, "avg": 228.23, "max": 2.15, "min": 844.17, "cnt": 29}, "backward-send":{"total": 3.31, "avg": 1.10, "max": 1.02, "min": 1.15, "cnt": 3}, "backward-recv":{"total": 135.94, "avg": 67.97, "max": 65.04, "min": 70.90, "cnt": 2}, "backward-params-all-reduce":{"total": 486.88, "avg": 486.88, "max": 486.88, "min": 486.88, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 248.75, "avg": 248.75, "max": 248.75, "min": 248.75, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.40, "avg": 3.40, "max": 3.40, "min": 3.40, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 204.54, "avg": 204.54, "max": 204.54, "min": 204.54, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.89, "avg": 6.89, "max": 6.89, "min": 6.89, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 21, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 72.76, "avg": 24.25, "max": 1.38, "min": 69.93, "cnt": 3}, "forward-compute":{"total": 1844.01, "avg": 57.63, "max": 50.62, "min": 69.15, "cnt": 32}, "fwd-compute":{"total": 1840.49, "avg": 57.52, "max": 50.56, "min": 69.05, "cnt": 32}, "batch-generator":{"total": 52.64, "avg": 1.64, "max": 0.63, "min": 4.16, "cnt": 32}, "fwd-embedding":{"total": 0.67, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1774.37, "avg": 55.45, "max": 49.61, "min": 66.80, "cnt": 32}, "fwd-layernorm":{"total": 10.64, "avg": 0.08, "max": 0.06, "min": 0.25, "cnt": 128}, "fwd-attn":{"total": 110.66, "avg": 0.86, "max": 0.74, "min": 1.91, "cnt": 128}, "fwd-misc":{"total": 22.66, "avg": 0.18, "max": 0.12, "min": 0.42, "cnt": 128}, "fwd-MLP":{"total": 1607.90, "avg": 12.56, "max": 9.57, "min": 23.69, "cnt": 128}, "MoE_L0_fwd":{"total": 470.40, "avg": 14.70, "max": 11.21, "min": 23.58, "cnt": 32}, "MoEMLP":{"total": 1590.09, "avg": 12.42, "max": 9.44, "min": 23.53, "cnt": 128}, "MoE_L1_fwd":{"total": 385.39, "avg": 12.04, "max": 10.98, "min": 14.11, "cnt": 32}, "MoE_L2_fwd":{"total": 335.49, "avg": 10.48, "max": 9.49, "min": 12.15, "cnt": 32}, "MoE_L3_fwd":{"total": 405.22, "avg": 12.66, "max": 11.45, "min": 13.73, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 3.34, "avg": 1.67, "max": 0.77, "min": 2.57, "cnt": 2}, "forward-send-backward-recv":{"total": 289.04, "avg": 9.63, "max": 1.58, "min": 120.33, "cnt": 30}, "backward-compute":{"total": 1729.14, "avg": 54.04, "max": 52.13, "min": 55.67, "cnt": 32}, "MoE_L3_bwd":{"total": 417.61, "avg": 13.05, "max": 12.46, "min": 15.00, "cnt": 32}, "MoE_L2_bwd":{"total": 328.23, "avg": 10.26, "max": 9.67, "min": 11.30, "cnt": 32}, "MoE_L1_bwd":{"total": 392.55, "avg": 12.27, "max": 9.90, "min": 13.00, "cnt": 32}, "MoE_L0_bwd":{"total": 364.85, "avg": 11.40, "max": 10.87, "min": 12.74, "cnt": 32}, "backward-send-forward-recv":{"total": 4323.72, "avg": 149.09, "max": 2.35, "min": 451.73, "cnt": 29}, "backward-send":{"total": 2.68, "avg": 0.89, "max": 0.73, "min": 0.99, "cnt": 3}, "backward-recv":{"total": 138.77, "avg": 69.39, "max": 65.98, "min": 72.80, "cnt": 2}, "backward-params-all-reduce":{"total": 486.83, "avg": 486.83, "max": 486.83, "min": 486.83, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 243.84, "avg": 243.84, "max": 243.84, "min": 243.84, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.40, "avg": 3.40, "max": 3.40, "min": 3.40, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 199.71, "avg": 199.71, "max": 199.71, "min": 199.71, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.94, "avg": 6.94, "max": 6.94, "min": 6.94, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 22, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.10, "avg": 0.10, "max": 0.10, "min": 0.10, "cnt": 1}, "forward-recv":{"total": 73.56, "avg": 24.52, "max": 1.67, "min": 67.58, "cnt": 3}, "forward-compute":{"total": 1910.70, "avg": 59.71, "max": 51.45, "min": 69.89, "cnt": 32}, "fwd-compute":{"total": 1907.46, "avg": 59.61, "max": 51.38, "min": 69.82, "cnt": 32}, "batch-generator":{"total": 45.39, "avg": 1.42, "max": 0.69, "min": 2.91, "cnt": 32}, "fwd-embedding":{"total": 0.57, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1848.37, "avg": 57.76, "max": 50.38, "min": 68.42, "cnt": 32}, "fwd-layernorm":{"total": 9.96, "avg": 0.08, "max": 0.06, "min": 0.24, "cnt": 128}, "fwd-attn":{"total": 107.25, "avg": 0.84, "max": 0.74, "min": 1.98, "cnt": 128}, "fwd-misc":{"total": 21.34, "avg": 0.17, "max": 0.11, "min": 0.44, "cnt": 128}, "fwd-MLP":{"total": 1688.37, "avg": 13.19, "max": 9.61, "min": 21.37, "cnt": 128}, "MoE_L0_fwd":{"total": 494.06, "avg": 15.44, "max": 11.28, "min": 21.21, "cnt": 32}, "MoEMLP":{"total": 1671.11, "avg": 13.06, "max": 9.49, "min": 21.16, "cnt": 128}, "MoE_L1_fwd":{"total": 398.45, "avg": 12.45, "max": 10.77, "min": 15.88, "cnt": 32}, "MoE_L2_fwd":{"total": 337.15, "avg": 10.54, "max": 9.54, "min": 16.03, "cnt": 32}, "MoE_L3_fwd":{"total": 447.64, "avg": 13.99, "max": 13.23, "min": 18.31, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.15, "avg": 0.57, "max": 0.56, "min": 0.59, "cnt": 2}, "forward-send-backward-recv":{"total": 217.29, "avg": 7.24, "max": 1.19, "min": 117.59, "cnt": 30}, "backward-compute":{"total": 1791.33, "avg": 55.98, "max": 53.04, "min": 58.05, "cnt": 32}, "MoE_L3_bwd":{"total": 484.94, "avg": 15.15, "max": 14.16, "min": 17.11, "cnt": 32}, "MoE_L2_bwd":{"total": 330.28, "avg": 10.32, "max": 7.91, "min": 10.97, "cnt": 32}, "MoE_L1_bwd":{"total": 394.77, "avg": 12.34, "max": 11.61, "min": 13.19, "cnt": 32}, "MoE_L0_bwd":{"total": 361.47, "avg": 11.30, "max": 10.67, "min": 11.90, "cnt": 32}, "backward-send-forward-recv":{"total": 5349.09, "avg": 184.45, "max": 2.31, "min": 608.18, "cnt": 29}, "backward-send":{"total": 2.89, "avg": 0.96, "max": 0.88, "min": 1.11, "cnt": 3}, "backward-recv":{"total": 128.11, "avg": 64.05, "max": 59.52, "min": 68.59, "cnt": 2}, "backward-params-all-reduce":{"total": 524.28, "avg": 524.28, "max": 524.28, "min": 524.28, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 241.38, "avg": 241.38, "max": 241.38, "min": 241.38, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.40, "avg": 3.40, "max": 3.40, "min": 3.40, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 197.10, "avg": 197.10, "max": 197.10, "min": 197.10, "cnt": 1}, "optimizer-clip-main-grad":{"total": 7.00, "avg": 7.00, "max": 7.00, "min": 7.00, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 23, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 81.66, "avg": 27.22, "max": 1.51, "min": 77.31, "cnt": 3}, "forward-compute":{"total": 1896.34, "avg": 59.26, "max": 51.42, "min": 65.94, "cnt": 32}, "fwd-compute":{"total": 1893.24, "avg": 59.16, "max": 51.35, "min": 65.80, "cnt": 32}, "batch-generator":{"total": 53.74, "avg": 1.68, "max": 0.68, "min": 4.58, "cnt": 32}, "fwd-embedding":{"total": 0.55, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1827.13, "avg": 57.10, "max": 50.36, "min": 63.72, "cnt": 32}, "fwd-layernorm":{"total": 10.09, "avg": 0.08, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 107.26, "avg": 0.84, "max": 0.74, "min": 1.56, "cnt": 128}, "fwd-misc":{"total": 21.98, "avg": 0.17, "max": 0.12, "min": 0.63, "cnt": 128}, "fwd-MLP":{"total": 1666.30, "avg": 13.02, "max": 9.93, "min": 18.70, "cnt": 128}, "MoE_L0_fwd":{"total": 471.19, "avg": 14.72, "max": 10.95, "min": 18.61, "cnt": 32}, "MoEMLP":{"total": 1648.97, "avg": 12.88, "max": 9.83, "min": 18.57, "cnt": 128}, "MoE_L1_fwd":{"total": 382.79, "avg": 11.96, "max": 10.77, "min": 15.50, "cnt": 32}, "MoE_L2_fwd":{"total": 343.19, "avg": 10.72, "max": 9.87, "min": 11.85, "cnt": 32}, "MoE_L3_fwd":{"total": 458.14, "avg": 14.32, "max": 13.78, "min": 16.22, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.61, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 4.86, "avg": 2.43, "max": 0.66, "min": 4.21, "cnt": 2}, "forward-send-backward-recv":{"total": 170.13, "avg": 5.67, "max": 1.11, "min": 114.80, "cnt": 30}, "backward-compute":{"total": 1833.91, "avg": 57.31, "max": 54.35, "min": 59.38, "cnt": 32}, "MoE_L3_bwd":{"total": 531.07, "avg": 16.60, "max": 15.16, "min": 18.54, "cnt": 32}, "MoE_L2_bwd":{"total": 327.91, "avg": 10.25, "max": 9.47, "min": 10.53, "cnt": 32}, "MoE_L1_bwd":{"total": 393.10, "avg": 12.28, "max": 11.38, "min": 13.37, "cnt": 32}, "MoE_L0_bwd":{"total": 366.35, "avg": 11.45, "max": 10.79, "min": 12.05, "cnt": 32}, "backward-send-forward-recv":{"total": 4024.80, "avg": 138.79, "max": 2.12, "min": 384.57, "cnt": 29}, "backward-send":{"total": 3.38, "avg": 1.13, "max": 1.09, "min": 1.15, "cnt": 3}, "backward-recv":{"total": 428.55, "avg": 214.27, "max": 53.85, "min": 374.70, "cnt": 2}, "backward-params-all-reduce":{"total": 484.17, "avg": 484.17, "max": 484.17, "min": 484.17, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 252.69, "avg": 252.69, "max": 252.69, "min": 252.69, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 208.46, "avg": 208.46, "max": 208.46, "min": 208.46, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.91, "avg": 6.91, "max": 6.91, "min": 6.91, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 24, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.10, "avg": 0.10, "max": 0.10, "min": 0.10, "cnt": 1}, "forward-recv":{"total": 68.29, "avg": 22.76, "max": 1.50, "min": 65.16, "cnt": 3}, "forward-compute":{"total": 1894.41, "avg": 59.20, "max": 52.83, "min": 66.16, "cnt": 32}, "fwd-compute":{"total": 1891.09, "avg": 59.10, "max": 52.75, "min": 66.07, "cnt": 32}, "batch-generator":{"total": 45.02, "avg": 1.41, "max": 0.66, "min": 2.91, "cnt": 32}, "fwd-embedding":{"total": 0.54, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1833.65, "avg": 57.30, "max": 51.79, "min": 63.75, "cnt": 32}, "fwd-layernorm":{"total": 9.75, "avg": 0.08, "max": 0.06, "min": 0.22, "cnt": 128}, "fwd-attn":{"total": 104.59, "avg": 0.82, "max": 0.74, "min": 1.82, "cnt": 128}, "fwd-misc":{"total": 21.11, "avg": 0.16, "max": 0.12, "min": 0.39, "cnt": 128}, "fwd-MLP":{"total": 1677.54, "avg": 13.11, "max": 9.62, "min": 21.64, "cnt": 128}, "MoE_L0_fwd":{"total": 463.06, "avg": 14.47, "max": 11.06, "min": 21.55, "cnt": 32}, "MoEMLP":{"total": 1661.24, "avg": 12.98, "max": 9.52, "min": 21.51, "cnt": 128}, "MoE_L1_fwd":{"total": 389.55, "avg": 12.17, "max": 10.73, "min": 13.52, "cnt": 32}, "MoE_L2_fwd":{"total": 328.55, "avg": 10.27, "max": 9.56, "min": 11.28, "cnt": 32}, "MoE_L3_fwd":{"total": 486.06, "avg": 15.19, "max": 14.45, "min": 18.26, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 8.68, "avg": 4.34, "max": 0.93, "min": 7.75, "cnt": 2}, "forward-send-backward-recv":{"total": 1513.67, "avg": 50.46, "max": 1.26, "min": 263.84, "cnt": 30}, "backward-compute":{"total": 1853.04, "avg": 57.91, "max": 54.88, "min": 59.75, "cnt": 32}, "MoE_L3_bwd":{"total": 549.60, "avg": 17.17, "max": 16.26, "min": 18.82, "cnt": 32}, "MoE_L2_bwd":{"total": 322.77, "avg": 10.09, "max": 9.34, "min": 10.71, "cnt": 32}, "MoE_L1_bwd":{"total": 394.91, "avg": 12.34, "max": 11.08, "min": 13.29, "cnt": 32}, "MoE_L0_bwd":{"total": 366.79, "avg": 11.46, "max": 10.48, "min": 13.80, "cnt": 32}, "backward-send-forward-recv":{"total": 2880.97, "avg": 99.34, "max": 2.08, "min": 302.93, "cnt": 29}, "backward-send":{"total": 3.40, "avg": 1.13, "max": 0.96, "min": 1.24, "cnt": 3}, "backward-recv":{"total": 354.17, "avg": 177.08, "max": 85.35, "min": 268.82, "cnt": 2}, "backward-params-all-reduce":{"total": 497.85, "avg": 497.85, "max": 497.85, "min": 497.85, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 236.53, "avg": 236.53, "max": 236.53, "min": 236.53, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.41, "avg": 3.41, "max": 3.41, "min": 3.41, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 192.19, "avg": 192.19, "max": 192.19, "min": 192.19, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.99, "avg": 6.99, "max": 6.99, "min": 6.99, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 25, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.10, "avg": 0.10, "max": 0.10, "min": 0.10, "cnt": 1}, "forward-recv":{"total": 78.21, "avg": 26.07, "max": 1.27, "min": 75.48, "cnt": 3}, "forward-compute":{"total": 1951.09, "avg": 60.97, "max": 53.61, "min": 70.15, "cnt": 32}, "fwd-compute":{"total": 1947.67, "avg": 60.86, "max": 53.52, "min": 70.05, "cnt": 32}, "batch-generator":{"total": 47.20, "avg": 1.48, "max": 0.64, "min": 3.15, "cnt": 32}, "fwd-embedding":{"total": 0.71, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1887.06, "avg": 58.97, "max": 52.29, "min": 67.66, "cnt": 32}, "fwd-layernorm":{"total": 11.06, "avg": 0.09, "max": 0.05, "min": 0.33, "cnt": 128}, "fwd-attn":{"total": 112.75, "avg": 0.88, "max": 0.74, "min": 2.49, "cnt": 128}, "fwd-misc":{"total": 23.11, "avg": 0.18, "max": 0.11, "min": 0.48, "cnt": 128}, "fwd-MLP":{"total": 1717.33, "avg": 13.42, "max": 9.49, "min": 21.31, "cnt": 128}, "MoE_L0_fwd":{"total": 504.25, "avg": 15.76, "max": 11.11, "min": 21.18, "cnt": 32}, "MoEMLP":{"total": 1699.01, "avg": 13.27, "max": 9.39, "min": 21.13, "cnt": 128}, "MoE_L1_fwd":{"total": 388.12, "avg": 12.13, "max": 10.94, "min": 14.12, "cnt": 32}, "MoE_L2_fwd":{"total": 329.09, "avg": 10.28, "max": 9.43, "min": 11.58, "cnt": 32}, "MoE_L3_fwd":{"total": 484.18, "avg": 15.13, "max": 14.69, "min": 15.75, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 5.03, "avg": 2.51, "max": 0.98, "min": 4.05, "cnt": 2}, "forward-send-backward-recv":{"total": 175.03, "avg": 5.83, "max": 1.17, "min": 111.77, "cnt": 30}, "backward-compute":{"total": 1857.65, "avg": 58.05, "max": 54.33, "min": 60.46, "cnt": 32}, "MoE_L3_bwd":{"total": 558.52, "avg": 17.45, "max": 16.30, "min": 17.94, "cnt": 32}, "MoE_L2_bwd":{"total": 316.78, "avg": 9.90, "max": 8.60, "min": 10.66, "cnt": 32}, "MoE_L1_bwd":{"total": 402.22, "avg": 12.57, "max": 11.68, "min": 15.90, "cnt": 32}, "MoE_L0_bwd":{"total": 366.24, "avg": 11.44, "max": 10.50, "min": 13.65, "cnt": 32}, "backward-send-forward-recv":{"total": 5302.05, "avg": 182.83, "max": 1.14, "min": 1166.12, "cnt": 29}, "backward-send":{"total": 3.40, "avg": 1.13, "max": 1.07, "min": 1.17, "cnt": 3}, "backward-recv":{"total": 122.44, "avg": 61.22, "max": 57.62, "min": 64.81, "cnt": 2}, "backward-params-all-reduce":{"total": 488.51, "avg": 488.51, "max": 488.51, "min": 488.51, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.05, "avg": 0.05, "max": 0.05, "min": 0.05, "cnt": 1}, "optimizer":{"total": 243.44, "avg": 243.44, "max": 243.44, "min": 243.44, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 199.16, "avg": 199.16, "max": 199.16, "min": 199.16, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.87, "avg": 6.87, "max": 6.87, "min": 6.87, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 26, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 71.31, "avg": 23.77, "max": 1.41, "min": 68.40, "cnt": 3}, "forward-compute":{"total": 1941.94, "avg": 60.69, "max": 52.52, "min": 69.82, "cnt": 32}, "fwd-compute":{"total": 1938.85, "avg": 60.59, "max": 52.45, "min": 69.73, "cnt": 32}, "batch-generator":{"total": 44.49, "avg": 1.39, "max": 0.68, "min": 3.23, "cnt": 32}, "fwd-embedding":{"total": 0.57, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1881.94, "avg": 58.81, "max": 51.45, "min": 68.20, "cnt": 32}, "fwd-layernorm":{"total": 9.90, "avg": 0.08, "max": 0.06, "min": 0.30, "cnt": 128}, "fwd-attn":{"total": 109.29, "avg": 0.85, "max": 0.74, "min": 2.43, "cnt": 128}, "fwd-misc":{"total": 21.62, "avg": 0.17, "max": 0.11, "min": 0.47, "cnt": 128}, "fwd-MLP":{"total": 1719.48, "avg": 13.43, "max": 9.47, "min": 22.47, "cnt": 128}, "MoE_L0_fwd":{"total": 488.95, "avg": 15.28, "max": 10.63, "min": 22.37, "cnt": 32}, "MoEMLP":{"total": 1702.28, "avg": 13.30, "max": 9.35, "min": 22.32, "cnt": 128}, "MoE_L1_fwd":{"total": 401.94, "avg": 12.56, "max": 11.01, "min": 17.31, "cnt": 32}, "MoE_L2_fwd":{"total": 327.37, "avg": 10.23, "max": 9.40, "min": 11.38, "cnt": 32}, "MoE_L3_fwd":{"total": 490.19, "avg": 15.32, "max": 14.26, "min": 17.42, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 16.27, "avg": 8.13, "max": 0.94, "min": 15.32, "cnt": 2}, "forward-send-backward-recv":{"total": 171.89, "avg": 5.73, "max": 1.29, "min": 118.02, "cnt": 30}, "backward-compute":{"total": 1882.44, "avg": 58.83, "max": 57.00, "min": 79.78, "cnt": 32}, "MoE_L3_bwd":{"total": 595.53, "avg": 18.61, "max": 16.72, "min": 40.28, "cnt": 32}, "MoE_L2_bwd":{"total": 317.82, "avg": 9.93, "max": 7.92, "min": 10.39, "cnt": 32}, "MoE_L1_bwd":{"total": 400.76, "avg": 12.52, "max": 11.81, "min": 13.15, "cnt": 32}, "MoE_L0_bwd":{"total": 355.81, "avg": 11.12, "max": 10.50, "min": 12.68, "cnt": 32}, "backward-send-forward-recv":{"total": 6237.40, "avg": 215.08, "max": 2.29, "min": 1066.41, "cnt": 29}, "backward-send":{"total": 3.05, "avg": 1.02, "max": 0.90, "min": 1.12, "cnt": 3}, "backward-recv":{"total": 123.36, "avg": 61.68, "max": 56.21, "min": 67.15, "cnt": 2}, "backward-params-all-reduce":{"total": 488.47, "avg": 488.47, "max": 488.47, "min": 488.47, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 290.16, "avg": 290.16, "max": 290.16, "min": 290.16, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.40, "avg": 3.40, "max": 3.40, "min": 3.40, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 245.97, "avg": 245.97, "max": 245.97, "min": 245.97, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.86, "avg": 6.86, "max": 6.86, "min": 6.86, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 27, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.10, "avg": 0.10, "max": 0.10, "min": 0.10, "cnt": 1}, "forward-recv":{"total": 73.47, "avg": 24.49, "max": 1.55, "min": 70.33, "cnt": 3}, "forward-compute":{"total": 1959.07, "avg": 61.22, "max": 54.15, "min": 67.09, "cnt": 32}, "fwd-compute":{"total": 1955.65, "avg": 61.11, "max": 54.08, "min": 67.01, "cnt": 32}, "batch-generator":{"total": 63.81, "avg": 1.99, "max": 0.66, "min": 4.14, "cnt": 32}, "fwd-embedding":{"total": 0.69, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1876.76, "avg": 58.65, "max": 53.10, "min": 65.83, "cnt": 32}, "fwd-layernorm":{"total": 10.55, "avg": 0.08, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 110.48, "avg": 0.86, "max": 0.74, "min": 2.18, "cnt": 128}, "fwd-misc":{"total": 22.27, "avg": 0.17, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1709.09, "avg": 13.35, "max": 9.71, "min": 18.70, "cnt": 128}, "MoE_L0_fwd":{"total": 463.90, "avg": 14.50, "max": 10.79, "min": 18.55, "cnt": 32}, "MoEMLP":{"total": 1691.58, "avg": 13.22, "max": 9.60, "min": 18.50, "cnt": 128}, "MoE_L1_fwd":{"total": 402.05, "avg": 12.56, "max": 11.44, "min": 14.67, "cnt": 32}, "MoE_L2_fwd":{"total": 338.09, "avg": 10.57, "max": 9.64, "min": 14.96, "cnt": 32}, "MoE_L3_fwd":{"total": 493.92, "avg": 15.43, "max": 14.95, "min": 17.84, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.90, "avg": 0.95, "max": 0.92, "min": 0.98, "cnt": 2}, "forward-send-backward-recv":{"total": 199.81, "avg": 6.66, "max": 1.53, "min": 134.05, "cnt": 30}, "backward-compute":{"total": 1933.35, "avg": 60.42, "max": 54.88, "min": 145.97, "cnt": 32}, "MoE_L3_bwd":{"total": 562.72, "avg": 17.59, "max": 16.87, "min": 18.49, "cnt": 32}, "MoE_L2_bwd":{"total": 318.99, "avg": 9.97, "max": 8.61, "min": 11.20, "cnt": 32}, "MoE_L1_bwd":{"total": 408.38, "avg": 12.76, "max": 11.96, "min": 13.96, "cnt": 32}, "MoE_L0_bwd":{"total": 432.15, "avg": 13.50, "max": 9.91, "min": 97.15, "cnt": 32}, "backward-send-forward-recv":{"total": 4149.77, "avg": 143.10, "max": 2.17, "min": 385.88, "cnt": 29}, "backward-send":{"total": 6.78, "avg": 2.26, "max": 1.08, "min": 4.54, "cnt": 3}, "backward-recv":{"total": 129.86, "avg": 64.93, "max": 61.75, "min": 68.11, "cnt": 2}, "backward-params-all-reduce":{"total": 489.34, "avg": 489.34, "max": 489.34, "min": 489.34, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 240.92, "avg": 240.92, "max": 240.92, "min": 240.92, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.40, "avg": 3.40, "max": 3.40, "min": 3.40, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 196.33, "avg": 196.33, "max": 196.33, "min": 196.33, "cnt": 1}, "optimizer-clip-main-grad":{"total": 7.21, "avg": 7.21, "max": 7.21, "min": 7.21, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 28, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 81.23, "avg": 27.08, "max": 1.53, "min": 78.05, "cnt": 3}, "forward-compute":{"total": 1965.58, "avg": 61.42, "max": 53.22, "min": 69.16, "cnt": 32}, "fwd-compute":{"total": 1962.21, "avg": 61.32, "max": 53.15, "min": 68.98, "cnt": 32}, "batch-generator":{"total": 52.20, "avg": 1.63, "max": 0.69, "min": 4.40, "cnt": 32}, "fwd-embedding":{"total": 0.67, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1897.33, "avg": 59.29, "max": 52.07, "min": 66.06, "cnt": 32}, "fwd-layernorm":{"total": 10.42, "avg": 0.08, "max": 0.06, "min": 0.22, "cnt": 128}, "fwd-attn":{"total": 109.57, "avg": 0.86, "max": 0.74, "min": 1.59, "cnt": 128}, "fwd-misc":{"total": 21.81, "avg": 0.17, "max": 0.11, "min": 0.39, "cnt": 128}, "fwd-MLP":{"total": 1733.82, "avg": 13.55, "max": 9.51, "min": 20.49, "cnt": 128}, "MoE_L0_fwd":{"total": 495.12, "avg": 15.47, "max": 10.85, "min": 20.42, "cnt": 32}, "MoEMLP":{"total": 1716.74, "avg": 13.41, "max": 9.40, "min": 20.37, "cnt": 128}, "MoE_L1_fwd":{"total": 415.08, "avg": 12.97, "max": 11.48, "min": 14.86, "cnt": 32}, "MoE_L2_fwd":{"total": 321.60, "avg": 10.05, "max": 9.44, "min": 11.01, "cnt": 32}, "MoE_L3_fwd":{"total": 491.27, "avg": 15.35, "max": 13.14, "min": 18.12, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 4.36, "avg": 2.18, "max": 0.86, "min": 3.50, "cnt": 2}, "forward-send-backward-recv":{"total": 400.35, "avg": 13.34, "max": 0.88, "min": 166.97, "cnt": 30}, "backward-compute":{"total": 1860.66, "avg": 58.15, "max": 55.05, "min": 60.81, "cnt": 32}, "MoE_L3_bwd":{"total": 568.36, "avg": 17.76, "max": 16.74, "min": 19.27, "cnt": 32}, "MoE_L2_bwd":{"total": 322.19, "avg": 10.07, "max": 9.58, "min": 11.87, "cnt": 32}, "MoE_L1_bwd":{"total": 412.27, "avg": 12.88, "max": 12.25, "min": 13.66, "cnt": 32}, "MoE_L0_bwd":{"total": 348.58, "avg": 10.89, "max": 10.27, "min": 12.38, "cnt": 32}, "backward-send-forward-recv":{"total": 4732.03, "avg": 163.17, "max": 2.31, "min": 731.54, "cnt": 29}, "backward-send":{"total": 3.40, "avg": 1.13, "max": 1.08, "min": 1.20, "cnt": 3}, "backward-recv":{"total": 274.73, "avg": 137.37, "max": 65.50, "min": 209.24, "cnt": 2}, "backward-params-all-reduce":{"total": 487.33, "avg": 487.33, "max": 487.33, "min": 487.33, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 244.87, "avg": 244.87, "max": 244.87, "min": 244.87, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.41, "avg": 3.41, "max": 3.41, "min": 3.41, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 198.17, "avg": 198.17, "max": 198.17, "min": 198.17, "cnt": 1}, "optimizer-clip-main-grad":{"total": 9.31, "avg": 9.31, "max": 9.31, "min": 9.31, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 29, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 71.96, "avg": 23.99, "max": 1.00, "min": 69.55, "cnt": 3}, "forward-compute":{"total": 1972.11, "avg": 61.63, "max": 55.54, "min": 69.84, "cnt": 32}, "fwd-compute":{"total": 1968.81, "avg": 61.53, "max": 55.46, "min": 69.75, "cnt": 32}, "batch-generator":{"total": 43.44, "avg": 1.36, "max": 0.67, "min": 2.67, "cnt": 32}, "fwd-embedding":{"total": 0.68, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1912.03, "avg": 59.75, "max": 54.10, "min": 67.78, "cnt": 32}, "fwd-layernorm":{"total": 10.35, "avg": 0.08, "max": 0.05, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 112.50, "avg": 0.88, "max": 0.74, "min": 2.22, "cnt": 128}, "fwd-misc":{"total": 22.84, "avg": 0.18, "max": 0.11, "min": 0.44, "cnt": 128}, "fwd-MLP":{"total": 1744.26, "avg": 13.63, "max": 9.69, "min": 22.34, "cnt": 128}, "MoE_L0_fwd":{"total": 500.86, "avg": 15.65, "max": 10.66, "min": 22.26, "cnt": 32}, "MoEMLP":{"total": 1726.64, "avg": 13.49, "max": 9.58, "min": 22.21, "cnt": 128}, "MoE_L1_fwd":{"total": 420.40, "avg": 13.14, "max": 11.63, "min": 16.89, "cnt": 32}, "MoE_L2_fwd":{"total": 330.74, "avg": 10.34, "max": 9.62, "min": 12.57, "cnt": 32}, "MoE_L3_fwd":{"total": 481.06, "avg": 15.03, "max": 14.17, "min": 17.24, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 3.79, "avg": 1.90, "max": 1.01, "min": 2.78, "cnt": 2}, "forward-send-backward-recv":{"total": 173.98, "avg": 5.80, "max": 0.89, "min": 111.33, "cnt": 30}, "backward-compute":{"total": 1849.79, "avg": 57.81, "max": 54.55, "min": 61.02, "cnt": 32}, "MoE_L3_bwd":{"total": 561.59, "avg": 17.55, "max": 16.12, "min": 21.04, "cnt": 32}, "MoE_L2_bwd":{"total": 320.37, "avg": 10.01, "max": 8.99, "min": 10.62, "cnt": 32}, "MoE_L1_bwd":{"total": 411.81, "avg": 12.87, "max": 12.17, "min": 13.57, "cnt": 32}, "MoE_L0_bwd":{"total": 344.82, "avg": 10.78, "max": 10.21, "min": 11.57, "cnt": 32}, "backward-send-forward-recv":{"total": 3803.79, "avg": 131.17, "max": 2.34, "min": 480.38, "cnt": 29}, "backward-send":{"total": 2.91, "avg": 0.97, "max": 0.79, "min": 1.08, "cnt": 3}, "backward-recv":{"total": 122.93, "avg": 61.47, "max": 59.21, "min": 63.72, "cnt": 2}, "backward-params-all-reduce":{"total": 489.20, "avg": 489.20, "max": 489.20, "min": 489.20, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 243.14, "avg": 243.14, "max": 243.14, "min": 243.14, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 198.95, "avg": 198.95, "max": 198.95, "min": 198.95, "cnt": 1}, "optimizer-clip-main-grad":{"total": 7.03, "avg": 7.03, "max": 7.03, "min": 7.03, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 30, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 469.37, "avg": 156.46, "max": 0.70, "min": 467.41, "cnt": 3}, "forward-compute":{"total": 1938.10, "avg": 60.57, "max": 51.37, "min": 164.03, "cnt": 32}, "fwd-compute":{"total": 1934.95, "avg": 60.47, "max": 51.30, "min": 163.81, "cnt": 32}, "batch-generator":{"total": 51.04, "avg": 1.59, "max": 0.73, "min": 3.33, "cnt": 32}, "fwd-embedding":{"total": 0.59, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1871.22, "avg": 58.48, "max": 49.36, "min": 161.78, "cnt": 32}, "fwd-layernorm":{"total": 9.76, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 107.90, "avg": 0.84, "max": 0.74, "min": 1.52, "cnt": 128}, "fwd-misc":{"total": 20.87, "avg": 0.16, "max": 0.11, "min": 0.42, "cnt": 128}, "fwd-MLP":{"total": 1711.61, "avg": 13.37, "max": 9.68, "min": 116.48, "cnt": 128}, "MoE_L0_fwd":{"total": 487.93, "avg": 15.25, "max": 11.02, "min": 25.79, "cnt": 32}, "MoEMLP":{"total": 1694.91, "avg": 13.24, "max": 9.57, "min": 116.36, "cnt": 128}, "MoE_L1_fwd":{"total": 422.22, "avg": 13.19, "max": 11.68, "min": 16.61, "cnt": 32}, "MoE_L2_fwd":{"total": 331.39, "avg": 10.36, "max": 9.61, "min": 11.53, "cnt": 32}, "MoE_L3_fwd":{"total": 459.44, "avg": 14.36, "max": 10.51, "min": 116.40, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 25.81, "avg": 12.91, "max": 0.50, "min": 25.31, "cnt": 2}, "forward-send-backward-recv":{"total": 421.06, "avg": 14.04, "max": 0.84, "min": 133.22, "cnt": 30}, "backward-compute":{"total": 1707.25, "avg": 53.35, "max": 50.80, "min": 56.18, "cnt": 32}, "MoE_L3_bwd":{"total": 388.66, "avg": 12.15, "max": 10.58, "min": 15.36, "cnt": 32}, "MoE_L2_bwd":{"total": 344.18, "avg": 10.76, "max": 9.60, "min": 11.55, "cnt": 32}, "MoE_L1_bwd":{"total": 405.81, "avg": 12.68, "max": 11.76, "min": 13.54, "cnt": 32}, "MoE_L0_bwd":{"total": 350.68, "avg": 10.96, "max": 10.29, "min": 12.09, "cnt": 32}, "backward-send-forward-recv":{"total": 4033.34, "avg": 139.08, "max": 1.59, "min": 432.94, "cnt": 29}, "backward-send":{"total": 1.94, "avg": 0.65, "max": 0.61, "min": 0.72, "cnt": 3}, "backward-recv":{"total": 481.66, "avg": 240.83, "max": 75.79, "min": 405.87, "cnt": 2}, "backward-params-all-reduce":{"total": 487.07, "avg": 487.07, "max": 487.07, "min": 487.07, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 243.25, "avg": 243.25, "max": 243.25, "min": 243.25, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 199.09, "avg": 199.09, "max": 199.09, "min": 199.09, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.85, "avg": 6.85, "max": 6.85, "min": 6.85, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 31, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.10, "avg": 0.10, "max": 0.10, "min": 0.10, "cnt": 1}, "forward-recv":{"total": 70.27, "avg": 23.42, "max": 1.52, "min": 67.18, "cnt": 3}, "forward-compute":{"total": 1894.70, "avg": 59.21, "max": 51.31, "min": 67.57, "cnt": 32}, "fwd-compute":{"total": 1891.22, "avg": 59.10, "max": 51.24, "min": 67.47, "cnt": 32}, "batch-generator":{"total": 48.39, "avg": 1.51, "max": 0.62, "min": 3.03, "cnt": 32}, "fwd-embedding":{"total": 0.68, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1829.58, "avg": 57.17, "max": 50.32, "min": 65.80, "cnt": 32}, "fwd-layernorm":{"total": 10.65, "avg": 0.08, "max": 0.05, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 111.95, "avg": 0.87, "max": 0.74, "min": 2.07, "cnt": 128}, "fwd-misc":{"total": 22.57, "avg": 0.18, "max": 0.11, "min": 0.41, "cnt": 128}, "fwd-MLP":{"total": 1661.83, "avg": 12.98, "max": 9.60, "min": 19.10, "cnt": 128}, "MoE_L0_fwd":{"total": 513.96, "avg": 16.06, "max": 11.94, "min": 18.98, "cnt": 32}, "MoEMLP":{"total": 1644.08, "avg": 12.84, "max": 9.48, "min": 18.93, "cnt": 128}, "MoE_L1_fwd":{"total": 416.31, "avg": 13.01, "max": 11.81, "min": 17.00, "cnt": 32}, "MoE_L2_fwd":{"total": 330.86, "avg": 10.34, "max": 9.52, "min": 11.66, "cnt": 32}, "MoE_L3_fwd":{"total": 389.51, "avg": 12.17, "max": 10.64, "min": 18.53, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.63, "avg": 0.02, "max": 0.02, "min": 0.04, "cnt": 32}, "forward-send":{"total": 4.29, "avg": 2.14, "max": 0.96, "min": 3.33, "cnt": 2}, "forward-send-backward-recv":{"total": 213.35, "avg": 7.11, "max": 1.12, "min": 130.31, "cnt": 30}, "backward-compute":{"total": 1706.91, "avg": 53.34, "max": 50.51, "min": 57.49, "cnt": 32}, "MoE_L3_bwd":{"total": 383.31, "avg": 11.98, "max": 10.64, "min": 13.75, "cnt": 32}, "MoE_L2_bwd":{"total": 330.21, "avg": 10.32, "max": 9.56, "min": 11.75, "cnt": 32}, "MoE_L1_bwd":{"total": 404.71, "avg": 12.65, "max": 11.64, "min": 13.29, "cnt": 32}, "MoE_L0_bwd":{"total": 369.98, "avg": 11.56, "max": 10.81, "min": 15.67, "cnt": 32}, "backward-send-forward-recv":{"total": 4264.20, "avg": 147.04, "max": 1.85, "min": 513.33, "cnt": 29}, "backward-send":{"total": 1.83, "avg": 0.61, "max": 0.53, "min": 0.69, "cnt": 3}, "backward-recv":{"total": 151.85, "avg": 75.92, "max": 68.30, "min": 83.55, "cnt": 2}, "backward-params-all-reduce":{"total": 485.55, "avg": 485.55, "max": 485.55, "min": 485.55, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 244.53, "avg": 244.53, "max": 244.53, "min": 244.53, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.40, "avg": 3.40, "max": 3.40, "min": 3.40, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 200.24, "avg": 200.24, "max": 200.24, "min": 200.24, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.93, "avg": 6.93, "max": 6.93, "min": 6.93, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.47, "avg": 3.47, "max": 3.47, "min": 3.47, "cnt": 1}}}
{"type":"time", "iteration": 32, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 70.96, "avg": 23.65, "max": 1.20, "min": 67.41, "cnt": 3}, "forward-compute":{"total": 1851.78, "avg": 57.87, "max": 51.35, "min": 64.88, "cnt": 32}, "fwd-compute":{"total": 1848.36, "avg": 57.76, "max": 51.26, "min": 64.75, "cnt": 32}, "batch-generator":{"total": 64.33, "avg": 2.01, "max": 0.80, "min": 4.86, "cnt": 32}, "fwd-embedding":{"total": 0.63, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1770.98, "avg": 55.34, "max": 49.30, "min": 62.49, "cnt": 32}, "fwd-layernorm":{"total": 10.23, "avg": 0.08, "max": 0.06, "min": 0.29, "cnt": 128}, "fwd-attn":{"total": 108.93, "avg": 0.85, "max": 0.74, "min": 2.30, "cnt": 128}, "fwd-misc":{"total": 21.85, "avg": 0.17, "max": 0.12, "min": 0.45, "cnt": 128}, "fwd-MLP":{"total": 1608.50, "avg": 12.57, "max": 9.89, "min": 21.78, "cnt": 128}, "MoE_L0_fwd":{"total": 480.81, "avg": 15.03, "max": 11.16, "min": 21.64, "cnt": 32}, "MoEMLP":{"total": 1591.52, "avg": 12.43, "max": 9.77, "min": 21.56, "cnt": 128}, "MoE_L1_fwd":{"total": 386.15, "avg": 12.07, "max": 10.95, "min": 15.03, "cnt": 32}, "MoE_L2_fwd":{"total": 335.74, "avg": 10.49, "max": 9.81, "min": 12.78, "cnt": 32}, "MoE_L3_fwd":{"total": 395.09, "avg": 12.35, "max": 11.31, "min": 15.25, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 3.42, "avg": 1.71, "max": 0.84, "min": 2.58, "cnt": 2}, "forward-send-backward-recv":{"total": 244.02, "avg": 8.13, "max": 0.93, "min": 123.31, "cnt": 30}, "backward-compute":{"total": 1686.85, "avg": 52.71, "max": 51.67, "min": 54.57, "cnt": 32}, "MoE_L3_bwd":{"total": 389.18, "avg": 12.16, "max": 11.57, "min": 13.08, "cnt": 32}, "MoE_L2_bwd":{"total": 316.70, "avg": 9.90, "max": 8.93, "min": 11.16, "cnt": 32}, "MoE_L1_bwd":{"total": 388.37, "avg": 12.14, "max": 11.50, "min": 12.71, "cnt": 32}, "MoE_L0_bwd":{"total": 372.15, "avg": 11.63, "max": 11.28, "min": 12.22, "cnt": 32}, "backward-send-forward-recv":{"total": 4223.59, "avg": 145.64, "max": 2.35, "min": 461.62, "cnt": 29}, "backward-send":{"total": 3.17, "avg": 1.06, "max": 0.96, "min": 1.15, "cnt": 3}, "backward-recv":{"total": 369.27, "avg": 184.64, "max": 67.03, "min": 302.24, "cnt": 2}, "backward-params-all-reduce":{"total": 488.15, "avg": 488.15, "max": 488.15, "min": 488.15, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 239.01, "avg": 239.01, "max": 239.01, "min": 239.01, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.40, "avg": 3.40, "max": 3.40, "min": 3.40, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 194.59, "avg": 194.59, "max": 194.59, "min": 194.59, "cnt": 1}, "optimizer-clip-main-grad":{"total": 7.27, "avg": 7.27, "max": 7.27, "min": 7.27, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.49, "avg": 3.49, "max": 3.49, "min": 3.49, "cnt": 1}}}
{"type":"time", "iteration": 33, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.10, "avg": 0.10, "max": 0.10, "min": 0.10, "cnt": 1}, "forward-recv":{"total": 84.11, "avg": 28.04, "max": 1.29, "min": 81.25, "cnt": 3}, "forward-compute":{"total": 1841.11, "avg": 57.53, "max": 52.12, "min": 62.50, "cnt": 32}, "fwd-compute":{"total": 1838.01, "avg": 57.44, "max": 52.05, "min": 62.42, "cnt": 32}, "batch-generator":{"total": 38.70, "avg": 1.21, "max": 0.69, "min": 2.54, "cnt": 32}, "fwd-embedding":{"total": 0.51, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1787.33, "avg": 55.85, "max": 51.04, "min": 60.58, "cnt": 32}, "fwd-layernorm":{"total": 9.15, "avg": 0.07, "max": 0.05, "min": 0.22, "cnt": 128}, "fwd-attn":{"total": 103.59, "avg": 0.81, "max": 0.74, "min": 1.85, "cnt": 128}, "fwd-misc":{"total": 20.78, "avg": 0.16, "max": 0.12, "min": 0.39, "cnt": 128}, "fwd-MLP":{"total": 1633.35, "avg": 12.76, "max": 10.03, "min": 19.39, "cnt": 128}, "MoE_L0_fwd":{"total": 488.01, "avg": 15.25, "max": 11.95, "min": 19.31, "cnt": 32}, "MoEMLP":{"total": 1616.80, "avg": 12.63, "max": 9.91, "min": 19.26, "cnt": 128}, "MoE_L1_fwd":{"total": 382.77, "avg": 11.96, "max": 11.07, "min": 14.15, "cnt": 32}, "MoE_L2_fwd":{"total": 345.82, "avg": 10.81, "max": 9.96, "min": 12.91, "cnt": 32}, "MoE_L3_fwd":{"total": 406.41, "avg": 12.70, "max": 11.40, "min": 15.14, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 8.41, "avg": 4.20, "max": 0.59, "min": 7.82, "cnt": 2}, "forward-send-backward-recv":{"total": 424.39, "avg": 14.15, "max": 0.94, "min": 145.77, "cnt": 30}, "backward-compute":{"total": 1715.93, "avg": 53.62, "max": 51.49, "min": 55.61, "cnt": 32}, "MoE_L3_bwd":{"total": 398.89, "avg": 12.47, "max": 11.16, "min": 14.12, "cnt": 32}, "MoE_L2_bwd":{"total": 318.55, "avg": 9.95, "max": 8.69, "min": 11.56, "cnt": 32}, "MoE_L1_bwd":{"total": 381.87, "avg": 11.93, "max": 10.90, "min": 12.63, "cnt": 32}, "MoE_L0_bwd":{"total": 395.67, "avg": 12.36, "max": 11.68, "min": 13.97, "cnt": 32}, "backward-send-forward-recv":{"total": 3776.93, "avg": 130.24, "max": 1.92, "min": 647.06, "cnt": 29}, "backward-send":{"total": 3.40, "avg": 1.13, "max": 1.07, "min": 1.21, "cnt": 3}, "backward-recv":{"total": 437.04, "avg": 218.52, "max": 65.28, "min": 371.76, "cnt": 2}, "backward-params-all-reduce":{"total": 487.06, "avg": 487.06, "max": 487.06, "min": 487.06, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 245.68, "avg": 245.68, "max": 245.68, "min": 245.68, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 201.10, "avg": 201.10, "max": 201.10, "min": 201.10, "cnt": 1}, "optimizer-clip-main-grad":{"total": 7.10, "avg": 7.10, "max": 7.10, "min": 7.10, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.47, "avg": 3.47, "max": 3.47, "min": 3.47, "cnt": 1}}}
{"type":"time", "iteration": 34, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.13, "avg": 0.13, "max": 0.13, "min": 0.13, "cnt": 1}, "forward-recv":{"total": 85.49, "avg": 28.50, "max": 0.91, "min": 83.18, "cnt": 3}, "forward-compute":{"total": 1852.74, "avg": 57.90, "max": 51.07, "min": 67.37, "cnt": 32}, "fwd-compute":{"total": 1849.60, "avg": 57.80, "max": 51.00, "min": 67.28, "cnt": 32}, "batch-generator":{"total": 50.11, "avg": 1.57, "max": 0.68, "min": 3.03, "cnt": 32}, "fwd-embedding":{"total": 0.59, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1786.81, "avg": 55.84, "max": 50.03, "min": 65.21, "cnt": 32}, "fwd-layernorm":{"total": 10.39, "avg": 0.08, "max": 0.06, "min": 0.38, "cnt": 128}, "fwd-attn":{"total": 109.65, "avg": 0.86, "max": 0.74, "min": 2.12, "cnt": 128}, "fwd-misc":{"total": 21.70, "avg": 0.17, "max": 0.12, "min": 0.39, "cnt": 128}, "fwd-MLP":{"total": 1623.63, "avg": 12.68, "max": 10.85, "min": 20.09, "cnt": 128}, "MoE_L0_fwd":{"total": 478.69, "avg": 14.96, "max": 11.77, "min": 19.93, "cnt": 32}, "MoEMLP":{"total": 1606.44, "avg": 12.55, "max": 10.73, "min": 19.84, "cnt": 128}, "MoE_L1_fwd":{"total": 385.13, "avg": 12.04, "max": 10.79, "min": 14.84, "cnt": 32}, "MoE_L2_fwd":{"total": 372.54, "avg": 11.64, "max": 10.78, "min": 13.16, "cnt": 32}, "MoE_L3_fwd":{"total": 376.31, "avg": 11.76, "max": 11.40, "min": 14.70, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 3.45, "avg": 1.72, "max": 0.65, "min": 2.80, "cnt": 2}, "forward-send-backward-recv":{"total": 245.20, "avg": 8.17, "max": 0.85, "min": 117.86, "cnt": 30}, "backward-compute":{"total": 1719.96, "avg": 53.75, "max": 51.60, "min": 56.39, "cnt": 32}, "MoE_L3_bwd":{"total": 410.29, "avg": 12.82, "max": 11.96, "min": 15.09, "cnt": 32}, "MoE_L2_bwd":{"total": 346.78, "avg": 10.84, "max": 10.12, "min": 11.71, "cnt": 32}, "MoE_L1_bwd":{"total": 354.20, "avg": 11.07, "max": 10.66, "min": 11.46, "cnt": 32}, "MoE_L0_bwd":{"total": 393.34, "avg": 12.29, "max": 10.98, "min": 13.82, "cnt": 32}, "backward-send-forward-recv":{"total": 3702.61, "avg": 127.68, "max": 2.29, "min": 372.30, "cnt": 29}, "backward-send":{"total": 2.67, "avg": 0.89, "max": 0.67, "min": 1.18, "cnt": 3}, "backward-recv":{"total": 127.69, "avg": 63.84, "max": 58.14, "min": 69.55, "cnt": 2}, "backward-params-all-reduce":{"total": 490.58, "avg": 490.58, "max": 490.58, "min": 490.58, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 239.07, "avg": 239.07, "max": 239.07, "min": 239.07, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.40, "avg": 3.40, "max": 3.40, "min": 3.40, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 194.85, "avg": 194.85, "max": 194.85, "min": 194.85, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.78, "avg": 6.78, "max": 6.78, "min": 6.78, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.49, "avg": 3.49, "max": 3.49, "min": 3.49, "cnt": 1}}}
{"type":"time", "iteration": 35, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 76.07, "avg": 25.36, "max": 1.96, "min": 69.89, "cnt": 3}, "forward-compute":{"total": 1892.11, "avg": 59.13, "max": 52.20, "min": 67.01, "cnt": 32}, "fwd-compute":{"total": 1888.82, "avg": 59.03, "max": 52.13, "min": 66.91, "cnt": 32}, "batch-generator":{"total": 44.62, "avg": 1.39, "max": 0.70, "min": 2.32, "cnt": 32}, "fwd-embedding":{"total": 0.61, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1831.72, "avg": 57.24, "max": 51.03, "min": 64.78, "cnt": 32}, "fwd-layernorm":{"total": 10.10, "avg": 0.08, "max": 0.05, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 109.74, "avg": 0.86, "max": 0.74, "min": 1.62, "cnt": 128}, "fwd-misc":{"total": 22.08, "avg": 0.17, "max": 0.12, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1667.81, "avg": 13.03, "max": 10.98, "min": 22.94, "cnt": 128}, "MoE_L0_fwd":{"total": 521.78, "avg": 16.31, "max": 12.01, "min": 22.86, "cnt": 32}, "MoEMLP":{"total": 1650.37, "avg": 12.89, "max": 10.87, "min": 22.82, "cnt": 128}, "MoE_L1_fwd":{"total": 391.68, "avg": 12.24, "max": 11.11, "min": 13.50, "cnt": 32}, "MoE_L2_fwd":{"total": 369.34, "avg": 11.54, "max": 11.07, "min": 13.19, "cnt": 32}, "MoE_L3_fwd":{"total": 373.86, "avg": 11.68, "max": 10.91, "min": 12.36, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 5.69, "avg": 2.84, "max": 0.43, "min": 5.26, "cnt": 2}, "forward-send-backward-recv":{"total": 170.95, "avg": 5.70, "max": 0.84, "min": 114.77, "cnt": 30}, "backward-compute":{"total": 1726.66, "avg": 53.96, "max": 51.81, "min": 55.71, "cnt": 32}, "MoE_L3_bwd":{"total": 412.37, "avg": 12.89, "max": 12.15, "min": 14.58, "cnt": 32}, "MoE_L2_bwd":{"total": 354.29, "avg": 11.07, "max": 10.21, "min": 13.58, "cnt": 32}, "MoE_L1_bwd":{"total": 360.12, "avg": 11.25, "max": 10.92, "min": 11.60, "cnt": 32}, "MoE_L0_bwd":{"total": 387.52, "avg": 12.11, "max": 11.49, "min": 12.53, "cnt": 32}, "backward-send-forward-recv":{"total": 4768.22, "avg": 164.42, "max": 2.43, "min": 504.35, "cnt": 29}, "backward-send":{"total": 2.58, "avg": 0.86, "max": 0.76, "min": 0.99, "cnt": 3}, "backward-recv":{"total": 136.12, "avg": 68.06, "max": 59.62, "min": 76.50, "cnt": 2}, "backward-params-all-reduce":{"total": 493.19, "avg": 493.19, "max": 493.19, "min": 493.19, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 241.87, "avg": 241.87, "max": 241.87, "min": 241.87, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 197.77, "avg": 197.77, "max": 197.77, "min": 197.77, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.85, "avg": 6.85, "max": 6.85, "min": 6.85, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 36, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 84.13, "avg": 28.04, "max": 6.65, "min": 68.94, "cnt": 3}, "forward-compute":{"total": 1846.88, "avg": 57.72, "max": 50.69, "min": 68.63, "cnt": 32}, "fwd-compute":{"total": 1843.58, "avg": 57.61, "max": 50.62, "min": 68.44, "cnt": 32}, "batch-generator":{"total": 47.60, "avg": 1.49, "max": 0.64, "min": 4.06, "cnt": 32}, "fwd-embedding":{"total": 0.60, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1782.94, "avg": 55.72, "max": 49.70, "min": 66.28, "cnt": 32}, "fwd-layernorm":{"total": 10.02, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 107.92, "avg": 0.84, "max": 0.74, "min": 1.53, "cnt": 128}, "fwd-misc":{"total": 21.71, "avg": 0.17, "max": 0.11, "min": 0.41, "cnt": 128}, "fwd-MLP":{"total": 1621.40, "avg": 12.67, "max": 9.87, "min": 20.75, "cnt": 128}, "MoE_L0_fwd":{"total": 478.35, "avg": 14.95, "max": 11.63, "min": 20.63, "cnt": 32}, "MoEMLP":{"total": 1604.01, "avg": 12.53, "max": 9.75, "min": 20.58, "cnt": 128}, "MoE_L1_fwd":{"total": 384.63, "avg": 12.02, "max": 10.83, "min": 14.99, "cnt": 32}, "MoE_L2_fwd":{"total": 347.28, "avg": 10.85, "max": 9.79, "min": 13.39, "cnt": 32}, "MoE_L3_fwd":{"total": 400.08, "avg": 12.50, "max": 11.33, "min": 14.32, "cnt": 32}, "fwd-pooler":{"total": 0.37, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.62, "avg": 0.02, "max": 0.02, "min": 0.05, "cnt": 32}, "forward-send":{"total": 1.08, "avg": 0.54, "max": 0.52, "min": 0.56, "cnt": 2}, "forward-send-backward-recv":{"total": 371.08, "avg": 12.37, "max": 0.85, "min": 157.33, "cnt": 30}, "backward-compute":{"total": 1708.72, "avg": 53.40, "max": 50.73, "min": 55.10, "cnt": 32}, "MoE_L3_bwd":{"total": 411.00, "avg": 12.84, "max": 11.44, "min": 13.67, "cnt": 32}, "MoE_L2_bwd":{"total": 329.41, "avg": 10.29, "max": 9.18, "min": 11.82, "cnt": 32}, "MoE_L1_bwd":{"total": 374.39, "avg": 11.70, "max": 10.18, "min": 12.67, "cnt": 32}, "MoE_L0_bwd":{"total": 377.00, "avg": 11.78, "max": 11.16, "min": 12.15, "cnt": 32}, "backward-send-forward-recv":{"total": 3996.21, "avg": 137.80, "max": 2.39, "min": 421.15, "cnt": 29}, "backward-send":{"total": 3.00, "avg": 1.00, "max": 0.89, "min": 1.06, "cnt": 3}, "backward-recv":{"total": 315.35, "avg": 157.67, "max": 69.77, "min": 245.58, "cnt": 2}, "backward-params-all-reduce":{"total": 485.05, "avg": 485.05, "max": 485.05, "min": 485.05, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 254.15, "avg": 254.15, "max": 254.15, "min": 254.15, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 209.98, "avg": 209.98, "max": 209.98, "min": 209.98, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.90, "avg": 6.90, "max": 6.90, "min": 6.90, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 37, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 73.84, "avg": 24.61, "max": 0.85, "min": 71.27, "cnt": 3}, "forward-compute":{"total": 1843.30, "avg": 57.60, "max": 52.47, "min": 63.30, "cnt": 32}, "fwd-compute":{"total": 1840.10, "avg": 57.50, "max": 52.38, "min": 63.22, "cnt": 32}, "batch-generator":{"total": 52.61, "avg": 1.64, "max": 0.66, "min": 3.52, "cnt": 32}, "fwd-embedding":{"total": 0.60, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1775.03, "avg": 55.47, "max": 51.13, "min": 60.61, "cnt": 32}, "fwd-layernorm":{"total": 9.72, "avg": 0.08, "max": 0.05, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 107.78, "avg": 0.84, "max": 0.74, "min": 2.01, "cnt": 128}, "fwd-misc":{"total": 20.98, "avg": 0.16, "max": 0.11, "min": 0.38, "cnt": 128}, "fwd-MLP":{"total": 1615.65, "avg": 12.62, "max": 9.75, "min": 20.00, "cnt": 128}, "MoE_L0_fwd":{"total": 479.11, "avg": 14.97, "max": 11.98, "min": 19.92, "cnt": 32}, "MoEMLP":{"total": 1599.11, "avg": 12.49, "max": 9.64, "min": 19.88, "cnt": 128}, "MoE_L1_fwd":{"total": 388.38, "avg": 12.14, "max": 11.13, "min": 14.48, "cnt": 32}, "MoE_L2_fwd":{"total": 340.57, "avg": 10.64, "max": 9.68, "min": 11.85, "cnt": 32}, "MoE_L3_fwd":{"total": 397.19, "avg": 12.41, "max": 11.46, "min": 13.35, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.29, "avg": 0.65, "max": 0.53, "min": 0.77, "cnt": 2}, "forward-send-backward-recv":{"total": 868.69, "avg": 28.96, "max": 0.85, "min": 287.74, "cnt": 30}, "backward-compute":{"total": 1704.92, "avg": 53.28, "max": 50.61, "min": 54.72, "cnt": 32}, "MoE_L3_bwd":{"total": 404.59, "avg": 12.64, "max": 11.98, "min": 13.89, "cnt": 32}, "MoE_L2_bwd":{"total": 326.46, "avg": 10.20, "max": 9.32, "min": 11.22, "cnt": 32}, "MoE_L1_bwd":{"total": 382.73, "avg": 11.96, "max": 10.84, "min": 12.92, "cnt": 32}, "MoE_L0_bwd":{"total": 378.39, "avg": 11.82, "max": 11.09, "min": 12.93, "cnt": 32}, "backward-send-forward-recv":{"total": 3472.37, "avg": 119.74, "max": 2.38, "min": 572.28, "cnt": 29}, "backward-send":{"total": 2.91, "avg": 0.97, "max": 0.91, "min": 1.06, "cnt": 3}, "backward-recv":{"total": 297.59, "avg": 148.80, "max": 68.47, "min": 229.13, "cnt": 2}, "backward-params-all-reduce":{"total": 489.95, "avg": 489.95, "max": 489.95, "min": 489.95, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 257.44, "avg": 257.44, "max": 257.44, "min": 257.44, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 204.90, "avg": 204.90, "max": 204.90, "min": 204.90, "cnt": 1}, "optimizer-clip-main-grad":{"total": 11.22, "avg": 11.22, "max": 11.22, "min": 11.22, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 38, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 74.33, "avg": 24.78, "max": 0.96, "min": 71.78, "cnt": 3}, "forward-compute":{"total": 1850.29, "avg": 57.82, "max": 51.13, "min": 68.10, "cnt": 32}, "fwd-compute":{"total": 1847.17, "avg": 57.72, "max": 51.06, "min": 68.02, "cnt": 32}, "batch-generator":{"total": 41.27, "avg": 1.29, "max": 0.65, "min": 3.07, "cnt": 32}, "fwd-embedding":{"total": 0.53, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1792.60, "avg": 56.02, "max": 50.13, "min": 66.24, "cnt": 32}, "fwd-layernorm":{"total": 9.61, "avg": 0.08, "max": 0.05, "min": 0.23, "cnt": 128}, "fwd-attn":{"total": 104.61, "avg": 0.82, "max": 0.74, "min": 1.64, "cnt": 128}, "fwd-misc":{"total": 21.73, "avg": 0.17, "max": 0.11, "min": 0.86, "cnt": 128}, "fwd-MLP":{"total": 1635.24, "avg": 12.78, "max": 10.86, "min": 20.14, "cnt": 128}, "MoE_L0_fwd":{"total": 485.40, "avg": 15.17, "max": 11.65, "min": 20.06, "cnt": 32}, "MoEMLP":{"total": 1618.69, "avg": 12.65, "max": 10.76, "min": 20.01, "cnt": 128}, "MoE_L1_fwd":{"total": 382.89, "avg": 11.97, "max": 10.87, "min": 14.36, "cnt": 32}, "MoE_L2_fwd":{"total": 369.02, "avg": 11.53, "max": 10.80, "min": 16.41, "cnt": 32}, "MoE_L3_fwd":{"total": 387.45, "avg": 12.11, "max": 11.38, "min": 15.26, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.59, "avg": 0.80, "max": 0.50, "min": 1.09, "cnt": 2}, "forward-send-backward-recv":{"total": 191.33, "avg": 6.38, "max": 0.85, "min": 132.69, "cnt": 30}, "backward-compute":{"total": 1701.26, "avg": 53.16, "max": 50.90, "min": 55.01, "cnt": 32}, "MoE_L3_bwd":{"total": 406.79, "avg": 12.71, "max": 12.06, "min": 13.69, "cnt": 32}, "MoE_L2_bwd":{"total": 344.95, "avg": 10.78, "max": 10.19, "min": 11.38, "cnt": 32}, "MoE_L1_bwd":{"total": 351.94, "avg": 11.00, "max": 10.29, "min": 12.51, "cnt": 32}, "MoE_L0_bwd":{"total": 381.72, "avg": 11.93, "max": 11.51, "min": 12.50, "cnt": 32}, "backward-send-forward-recv":{"total": 3718.27, "avg": 128.22, "max": 2.56, "min": 309.50, "cnt": 29}, "backward-send":{"total": 2.32, "avg": 0.77, "max": 0.60, "min": 1.04, "cnt": 3}, "backward-recv":{"total": 146.57, "avg": 73.29, "max": 71.34, "min": 75.23, "cnt": 2}, "backward-params-all-reduce":{"total": 487.55, "avg": 487.55, "max": 487.55, "min": 487.55, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 316.63, "avg": 316.63, "max": 316.63, "min": 316.63, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 271.41, "avg": 271.41, "max": 271.41, "min": 271.41, "cnt": 1}, "optimizer-clip-main-grad":{"total": 7.22, "avg": 7.22, "max": 7.22, "min": 7.22, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.50, "avg": 3.50, "max": 3.50, "min": 3.50, "cnt": 1}}}
{"type":"time", "iteration": 39, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 70.92, "avg": 23.64, "max": 0.78, "min": 68.80, "cnt": 3}, "forward-compute":{"total": 1901.26, "avg": 59.41, "max": 51.68, "min": 98.52, "cnt": 32}, "fwd-compute":{"total": 1898.19, "avg": 59.32, "max": 51.62, "min": 98.39, "cnt": 32}, "batch-generator":{"total": 44.56, "avg": 1.39, "max": 0.66, "min": 3.22, "cnt": 32}, "fwd-embedding":{"total": 0.56, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1841.16, "avg": 57.54, "max": 50.55, "min": 96.36, "cnt": 32}, "fwd-layernorm":{"total": 9.69, "avg": 0.08, "max": 0.06, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 104.77, "avg": 0.82, "max": 0.74, "min": 1.56, "cnt": 128}, "fwd-misc":{"total": 20.67, "avg": 0.16, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1684.99, "avg": 13.16, "max": 10.47, "min": 54.47, "cnt": 128}, "MoE_L0_fwd":{"total": 542.08, "avg": 16.94, "max": 12.26, "min": 54.34, "cnt": 32}, "MoEMLP":{"total": 1668.46, "avg": 13.03, "max": 10.36, "min": 54.26, "cnt": 128}, "MoE_L1_fwd":{"total": 397.34, "avg": 12.42, "max": 10.99, "min": 14.51, "cnt": 32}, "MoE_L2_fwd":{"total": 351.61, "avg": 10.99, "max": 10.40, "min": 12.03, "cnt": 32}, "MoE_L3_fwd":{"total": 383.46, "avg": 11.98, "max": 11.35, "min": 16.02, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.04, "cnt": 32}, "forward-send":{"total": 8.59, "avg": 4.30, "max": 0.60, "min": 7.99, "cnt": 2}, "forward-send-backward-recv":{"total": 759.13, "avg": 25.30, "max": 0.87, "min": 139.79, "cnt": 30}, "backward-compute":{"total": 1712.28, "avg": 53.51, "max": 50.23, "min": 55.95, "cnt": 32}, "MoE_L3_bwd":{"total": 410.91, "avg": 12.84, "max": 11.94, "min": 15.01, "cnt": 32}, "MoE_L2_bwd":{"total": 335.16, "avg": 10.47, "max": 9.54, "min": 11.53, "cnt": 32}, "MoE_L1_bwd":{"total": 356.97, "avg": 11.16, "max": 10.48, "min": 13.75, "cnt": 32}, "MoE_L0_bwd":{"total": 388.07, "avg": 12.13, "max": 11.66, "min": 13.20, "cnt": 32}, "backward-send-forward-recv":{"total": 4477.21, "avg": 154.39, "max": 1.98, "min": 1168.82, "cnt": 29}, "backward-send":{"total": 2.51, "avg": 0.84, "max": 0.71, "min": 0.92, "cnt": 3}, "backward-recv":{"total": 209.40, "avg": 104.70, "max": 65.04, "min": 144.36, "cnt": 2}, "backward-params-all-reduce":{"total": 490.14, "avg": 490.14, "max": 490.14, "min": 490.14, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 255.22, "avg": 255.22, "max": 255.22, "min": 255.22, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.40, "avg": 3.40, "max": 3.40, "min": 3.40, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 201.66, "avg": 201.66, "max": 201.66, "min": 201.66, "cnt": 1}, "optimizer-clip-main-grad":{"total": 7.32, "avg": 7.32, "max": 7.32, "min": 7.32, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 40, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.10, "avg": 0.10, "max": 0.10, "min": 0.10, "cnt": 1}, "forward-recv":{"total": 375.60, "avg": 125.20, "max": 0.92, "min": 373.62, "cnt": 3}, "forward-compute":{"total": 1928.09, "avg": 60.25, "max": 54.49, "min": 67.66, "cnt": 32}, "fwd-compute":{"total": 1924.86, "avg": 60.15, "max": 54.41, "min": 67.57, "cnt": 32}, "batch-generator":{"total": 46.05, "avg": 1.44, "max": 0.74, "min": 2.27, "cnt": 32}, "fwd-embedding":{"total": 0.72, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1866.12, "avg": 58.32, "max": 52.11, "min": 64.97, "cnt": 32}, "fwd-layernorm":{"total": 10.42, "avg": 0.08, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 112.37, "avg": 0.88, "max": 0.74, "min": 1.50, "cnt": 128}, "fwd-misc":{"total": 22.68, "avg": 0.18, "max": 0.11, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1698.58, "avg": 13.27, "max": 11.19, "min": 23.86, "cnt": 128}, "MoE_L0_fwd":{"total": 546.31, "avg": 17.07, "max": 12.50, "min": 23.68, "cnt": 32}, "MoEMLP":{"total": 1681.08, "avg": 13.13, "max": 11.07, "min": 23.60, "cnt": 128}, "MoE_L1_fwd":{"total": 391.39, "avg": 12.23, "max": 11.12, "min": 14.21, "cnt": 32}, "MoE_L2_fwd":{"total": 373.15, "avg": 11.66, "max": 11.17, "min": 12.54, "cnt": 32}, "MoE_L3_fwd":{"total": 376.65, "avg": 11.77, "max": 11.41, "min": 12.95, "cnt": 32}, "fwd-pooler":{"total": 0.36, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 3.34, "avg": 1.67, "max": 0.71, "min": 2.62, "cnt": 2}, "forward-send-backward-recv":{"total": 1093.75, "avg": 36.46, "max": 0.91, "min": 286.62, "cnt": 30}, "backward-compute":{"total": 1730.98, "avg": 54.09, "max": 51.67, "min": 56.73, "cnt": 32}, "MoE_L3_bwd":{"total": 412.74, "avg": 12.90, "max": 11.14, "min": 15.13, "cnt": 32}, "MoE_L2_bwd":{"total": 365.99, "avg": 11.44, "max": 10.58, "min": 12.12, "cnt": 32}, "MoE_L1_bwd":{"total": 350.80, "avg": 10.96, "max": 10.29, "min": 11.78, "cnt": 32}, "MoE_L0_bwd":{"total": 383.54, "avg": 11.99, "max": 11.56, "min": 12.85, "cnt": 32}, "backward-send-forward-recv":{"total": 4981.02, "avg": 171.76, "max": 1.05, "min": 804.27, "cnt": 29}, "backward-send":{"total": 2.82, "avg": 0.94, "max": 0.69, "min": 1.20, "cnt": 3}, "backward-recv":{"total": 455.72, "avg": 227.86, "max": 60.72, "min": 395.00, "cnt": 2}, "backward-params-all-reduce":{"total": 485.49, "avg": 485.49, "max": 485.49, "min": 485.49, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 243.11, "avg": 243.11, "max": 243.11, "min": 243.11, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 198.56, "avg": 198.56, "max": 198.56, "min": 198.56, "cnt": 1}, "optimizer-clip-main-grad":{"total": 7.22, "avg": 7.22, "max": 7.22, "min": 7.22, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 41, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 67.17, "avg": 22.39, "max": 0.89, "min": 65.01, "cnt": 3}, "forward-compute":{"total": 2229.18, "avg": 69.66, "max": 53.71, "min": 385.65, "cnt": 32}, "fwd-compute":{"total": 2225.98, "avg": 69.56, "max": 53.62, "min": 385.57, "cnt": 32}, "batch-generator":{"total": 46.32, "avg": 1.45, "max": 0.67, "min": 3.76, "cnt": 32}, "fwd-embedding":{"total": 0.55, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 2167.80, "avg": 67.74, "max": 52.32, "min": 384.14, "cnt": 32}, "fwd-layernorm":{"total": 9.59, "avg": 0.07, "max": 0.06, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 109.29, "avg": 0.85, "max": 0.74, "min": 2.68, "cnt": 128}, "fwd-misc":{"total": 21.44, "avg": 0.17, "max": 0.11, "min": 0.33, "cnt": 128}, "fwd-MLP":{"total": 2006.46, "avg": 15.68, "max": 11.31, "min": 340.04, "cnt": 128}, "MoE_L0_fwd":{"total": 821.87, "avg": 25.68, "max": 12.49, "min": 339.81, "cnt": 32}, "MoEMLP":{"total": 1989.67, "avg": 15.54, "max": 11.19, "min": 339.72, "cnt": 128}, "MoE_L1_fwd":{"total": 398.93, "avg": 12.47, "max": 11.24, "min": 14.47, "cnt": 32}, "MoE_L2_fwd":{"total": 394.06, "avg": 12.31, "max": 11.53, "min": 17.31, "cnt": 32}, "MoE_L3_fwd":{"total": 380.93, "avg": 11.90, "max": 11.43, "min": 13.49, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 2.49, "avg": 1.24, "max": 0.61, "min": 1.88, "cnt": 2}, "forward-send-backward-recv":{"total": 590.23, "avg": 19.67, "max": 0.89, "min": 141.56, "cnt": 30}, "backward-compute":{"total": 1764.40, "avg": 55.14, "max": 53.19, "min": 56.53, "cnt": 32}, "MoE_L3_bwd":{"total": 402.79, "avg": 12.59, "max": 11.73, "min": 13.34, "cnt": 32}, "MoE_L2_bwd":{"total": 384.42, "avg": 12.01, "max": 11.36, "min": 12.72, "cnt": 32}, "MoE_L1_bwd":{"total": 376.47, "avg": 11.76, "max": 11.35, "min": 12.19, "cnt": 32}, "MoE_L0_bwd":{"total": 384.29, "avg": 12.01, "max": 11.35, "min": 13.91, "cnt": 32}, "backward-send-forward-recv":{"total": 3508.61, "avg": 120.99, "max": 1.76, "min": 505.53, "cnt": 29}, "backward-send":{"total": 2.59, "avg": 0.86, "max": 0.77, "min": 1.03, "cnt": 3}, "backward-recv":{"total": 141.51, "avg": 70.75, "max": 70.54, "min": 70.97, "cnt": 2}, "backward-params-all-reduce":{"total": 490.08, "avg": 490.08, "max": 490.08, "min": 490.08, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 239.28, "avg": 239.28, "max": 239.28, "min": 239.28, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 195.11, "avg": 195.11, "max": 195.11, "min": 195.11, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.88, "avg": 6.88, "max": 6.88, "min": 6.88, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}}}
{"type":"time", "iteration": 42, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 73.90, "avg": 24.63, "max": 0.72, "min": 72.29, "cnt": 3}, "forward-compute":{"total": 1988.35, "avg": 62.14, "max": 52.58, "min": 69.21, "cnt": 32}, "fwd-compute":{"total": 1985.15, "avg": 62.04, "max": 52.51, "min": 69.13, "cnt": 32}, "batch-generator":{"total": 53.76, "avg": 1.68, "max": 0.67, "min": 3.92, "cnt": 32}, "fwd-embedding":{"total": 0.76, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1917.87, "avg": 59.93, "max": 51.53, "min": 66.74, "cnt": 32}, "fwd-layernorm":{"total": 11.04, "avg": 0.09, "max": 0.06, "min": 0.23, "cnt": 128}, "fwd-attn":{"total": 112.51, "avg": 0.88, "max": 0.74, "min": 1.56, "cnt": 128}, "fwd-misc":{"total": 23.25, "avg": 0.18, "max": 0.12, "min": 0.41, "cnt": 128}, "fwd-MLP":{"total": 1748.12, "avg": 13.66, "max": 10.88, "min": 22.80, "cnt": 128}, "MoE_L0_fwd":{"total": 531.94, "avg": 16.62, "max": 11.69, "min": 22.62, "cnt": 32}, "MoEMLP":{"total": 1729.72, "avg": 13.51, "max": 10.77, "min": 22.53, "cnt": 128}, "MoE_L1_fwd":{"total": 457.67, "avg": 14.30, "max": 13.10, "min": 16.22, "cnt": 32}, "MoE_L2_fwd":{"total": 365.09, "avg": 11.41, "max": 10.81, "min": 15.86, "cnt": 32}, "MoE_L3_fwd":{"total": 381.68, "avg": 11.93, "max": 11.32, "min": 14.16, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.10, "avg": 0.55, "max": 0.55, "min": 0.56, "cnt": 2}, "forward-send-backward-recv":{"total": 157.33, "avg": 5.24, "max": 0.85, "min": 114.35, "cnt": 30}, "backward-compute":{"total": 1826.89, "avg": 57.09, "max": 54.97, "min": 59.53, "cnt": 32}, "MoE_L3_bwd":{"total": 408.35, "avg": 12.76, "max": 12.02, "min": 13.81, "cnt": 32}, "MoE_L2_bwd":{"total": 356.34, "avg": 11.14, "max": 10.11, "min": 12.42, "cnt": 32}, "MoE_L1_bwd":{"total": 467.40, "avg": 14.61, "max": 13.96, "min": 16.88, "cnt": 32}, "MoE_L0_bwd":{"total": 378.38, "avg": 11.82, "max": 11.38, "min": 13.67, "cnt": 32}, "backward-send-forward-recv":{"total": 4826.59, "avg": 166.43, "max": 1.07, "min": 992.67, "cnt": 29}, "backward-send":{"total": 3.25, "avg": 1.08, "max": 0.98, "min": 1.15, "cnt": 3}, "backward-recv":{"total": 129.68, "avg": 64.84, "max": 58.11, "min": 71.57, "cnt": 2}, "backward-params-all-reduce":{"total": 487.97, "avg": 487.97, "max": 487.97, "min": 487.97, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 238.66, "avg": 238.66, "max": 238.66, "min": 238.66, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 194.63, "avg": 194.63, "max": 194.63, "min": 194.63, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.82, "avg": 6.82, "max": 6.82, "min": 6.82, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 43, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 70.96, "avg": 23.65, "max": 0.83, "min": 69.29, "cnt": 3}, "forward-compute":{"total": 1975.49, "avg": 61.73, "max": 53.61, "min": 69.08, "cnt": 32}, "fwd-compute":{"total": 1971.88, "avg": 61.62, "max": 53.52, "min": 68.64, "cnt": 32}, "batch-generator":{"total": 49.04, "avg": 1.53, "max": 0.69, "min": 4.36, "cnt": 32}, "fwd-embedding":{"total": 0.65, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1909.95, "avg": 59.69, "max": 52.52, "min": 66.07, "cnt": 32}, "fwd-layernorm":{"total": 10.27, "avg": 0.08, "max": 0.06, "min": 0.23, "cnt": 128}, "fwd-attn":{"total": 110.29, "avg": 0.86, "max": 0.74, "min": 1.88, "cnt": 128}, "fwd-misc":{"total": 22.22, "avg": 0.17, "max": 0.12, "min": 0.40, "cnt": 128}, "fwd-MLP":{"total": 1745.19, "avg": 13.63, "max": 10.24, "min": 21.93, "cnt": 128}, "MoE_L0_fwd":{"total": 511.36, "avg": 15.98, "max": 11.97, "min": 21.83, "cnt": 32}, "MoEMLP":{"total": 1727.74, "avg": 13.50, "max": 10.13, "min": 21.78, "cnt": 128}, "MoE_L1_fwd":{"total": 496.93, "avg": 15.53, "max": 14.19, "min": 20.19, "cnt": 32}, "MoE_L2_fwd":{"total": 348.63, "avg": 10.89, "max": 10.17, "min": 14.64, "cnt": 32}, "MoE_L3_fwd":{"total": 377.09, "avg": 11.78, "max": 10.79, "min": 13.60, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.13, "avg": 0.56, "max": 0.51, "min": 0.62, "cnt": 2}, "forward-send-backward-recv":{"total": 159.94, "avg": 5.33, "max": 0.89, "min": 114.35, "cnt": 30}, "backward-compute":{"total": 1870.10, "avg": 58.44, "max": 57.28, "min": 60.00, "cnt": 32}, "MoE_L3_bwd":{"total": 410.38, "avg": 12.82, "max": 12.10, "min": 14.44, "cnt": 32}, "MoE_L2_bwd":{"total": 342.66, "avg": 10.71, "max": 10.12, "min": 11.75, "cnt": 32}, "MoE_L1_bwd":{"total": 528.02, "avg": 16.50, "max": 16.00, "min": 17.41, "cnt": 32}, "MoE_L0_bwd":{"total": 375.82, "avg": 11.74, "max": 11.24, "min": 12.36, "cnt": 32}, "backward-send-forward-recv":{"total": 4034.04, "avg": 139.10, "max": 2.24, "min": 749.18, "cnt": 29}, "backward-send":{"total": 2.71, "avg": 0.90, "max": 0.66, "min": 1.06, "cnt": 3}, "backward-recv":{"total": 136.86, "avg": 68.43, "max": 51.56, "min": 85.29, "cnt": 2}, "backward-params-all-reduce":{"total": 485.79, "avg": 485.79, "max": 485.79, "min": 485.79, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 250.17, "avg": 250.17, "max": 250.17, "min": 250.17, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.40, "avg": 3.40, "max": 3.40, "min": 3.40, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 205.79, "avg": 205.79, "max": 205.79, "min": 205.79, "cnt": 1}, "optimizer-clip-main-grad":{"total": 7.08, "avg": 7.08, "max": 7.08, "min": 7.08, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 44, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 79.65, "avg": 26.55, "max": 0.99, "min": 77.62, "cnt": 3}, "forward-compute":{"total": 1994.10, "avg": 62.32, "max": 55.93, "min": 68.08, "cnt": 32}, "fwd-compute":{"total": 1990.88, "avg": 62.22, "max": 55.86, "min": 67.92, "cnt": 32}, "batch-generator":{"total": 42.01, "avg": 1.31, "max": 0.63, "min": 2.94, "cnt": 32}, "fwd-embedding":{"total": 0.58, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1936.22, "avg": 60.51, "max": 54.92, "min": 66.20, "cnt": 32}, "fwd-layernorm":{"total": 9.57, "avg": 0.07, "max": 0.05, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 106.80, "avg": 0.83, "max": 0.74, "min": 1.48, "cnt": 128}, "fwd-misc":{"total": 21.03, "avg": 0.16, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1778.08, "avg": 13.89, "max": 11.31, "min": 22.42, "cnt": 128}, "MoE_L0_fwd":{"total": 497.21, "avg": 15.54, "max": 12.19, "min": 22.32, "cnt": 32}, "MoEMLP":{"total": 1761.51, "avg": 13.76, "max": 11.20, "min": 22.27, "cnt": 128}, "MoE_L1_fwd":{"total": 501.47, "avg": 15.67, "max": 14.47, "min": 18.01, "cnt": 32}, "MoE_L2_fwd":{"total": 392.95, "avg": 12.28, "max": 11.44, "min": 15.99, "cnt": 32}, "MoE_L3_fwd":{"total": 375.88, "avg": 11.75, "max": 11.24, "min": 13.93, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.23, "avg": 0.62, "max": 0.61, "min": 0.63, "cnt": 2}, "forward-send-backward-recv":{"total": 135.26, "avg": 4.51, "max": 0.88, "min": 104.31, "cnt": 30}, "backward-compute":{"total": 1939.90, "avg": 60.62, "max": 57.77, "min": 62.86, "cnt": 32}, "MoE_L3_bwd":{"total": 408.41, "avg": 12.76, "max": 11.99, "min": 14.71, "cnt": 32}, "MoE_L2_bwd":{"total": 387.25, "avg": 12.10, "max": 11.45, "min": 12.99, "cnt": 32}, "MoE_L1_bwd":{"total": 548.34, "avg": 17.14, "max": 16.46, "min": 18.98, "cnt": 32}, "MoE_L0_bwd":{"total": 382.74, "avg": 11.96, "max": 11.53, "min": 13.94, "cnt": 32}, "backward-send-forward-recv":{"total": 4601.06, "avg": 158.66, "max": 1.94, "min": 1005.07, "cnt": 29}, "backward-send":{"total": 3.00, "avg": 1.00, "max": 0.86, "min": 1.09, "cnt": 3}, "backward-recv":{"total": 115.95, "avg": 57.98, "max": 51.51, "min": 64.44, "cnt": 2}, "backward-params-all-reduce":{"total": 489.96, "avg": 489.96, "max": 489.96, "min": 489.96, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 240.92, "avg": 240.92, "max": 240.92, "min": 240.92, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 196.87, "avg": 196.87, "max": 196.87, "min": 196.87, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.80, "avg": 6.80, "max": 6.80, "min": 6.80, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 45, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 74.09, "avg": 24.70, "max": 1.27, "min": 71.38, "cnt": 3}, "forward-compute":{"total": 2007.40, "avg": 62.73, "max": 56.47, "min": 69.04, "cnt": 32}, "fwd-compute":{"total": 2004.31, "avg": 62.63, "max": 56.38, "min": 68.94, "cnt": 32}, "batch-generator":{"total": 45.32, "avg": 1.42, "max": 0.64, "min": 3.07, "cnt": 32}, "fwd-embedding":{"total": 0.59, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1946.51, "avg": 60.83, "max": 54.46, "min": 67.61, "cnt": 32}, "fwd-layernorm":{"total": 10.03, "avg": 0.08, "max": 0.06, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 107.89, "avg": 0.84, "max": 0.74, "min": 1.52, "cnt": 128}, "fwd-misc":{"total": 21.67, "avg": 0.17, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1785.29, "avg": 13.95, "max": 11.31, "min": 22.35, "cnt": 128}, "MoE_L0_fwd":{"total": 529.46, "avg": 16.55, "max": 12.73, "min": 22.23, "cnt": 32}, "MoEMLP":{"total": 1767.94, "avg": 13.81, "max": 11.19, "min": 22.17, "cnt": 128}, "MoE_L1_fwd":{"total": 473.45, "avg": 14.80, "max": 13.14, "min": 17.21, "cnt": 32}, "MoE_L2_fwd":{"total": 393.30, "avg": 12.29, "max": 11.47, "min": 15.06, "cnt": 32}, "MoE_L3_fwd":{"total": 378.07, "avg": 11.81, "max": 11.23, "min": 14.73, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.93, "avg": 0.97, "max": 0.94, "min": 0.99, "cnt": 2}, "forward-send-backward-recv":{"total": 166.60, "avg": 5.55, "max": 0.86, "min": 115.44, "cnt": 30}, "backward-compute":{"total": 1890.09, "avg": 59.07, "max": 55.81, "min": 61.73, "cnt": 32}, "MoE_L3_bwd":{"total": 412.25, "avg": 12.88, "max": 11.29, "min": 14.15, "cnt": 32}, "MoE_L2_bwd":{"total": 395.82, "avg": 12.37, "max": 11.65, "min": 13.97, "cnt": 32}, "MoE_L1_bwd":{"total": 479.69, "avg": 14.99, "max": 14.11, "min": 16.25, "cnt": 32}, "MoE_L0_bwd":{"total": 388.00, "avg": 12.12, "max": 11.36, "min": 13.33, "cnt": 32}, "backward-send-forward-recv":{"total": 4949.52, "avg": 170.67, "max": 1.16, "min": 702.28, "cnt": 29}, "backward-send":{"total": 2.86, "avg": 0.95, "max": 0.86, "min": 1.14, "cnt": 3}, "backward-recv":{"total": 129.29, "avg": 64.64, "max": 64.47, "min": 64.82, "cnt": 2}, "backward-params-all-reduce":{"total": 491.26, "avg": 491.26, "max": 491.26, "min": 491.26, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 246.18, "avg": 246.18, "max": 246.18, "min": 246.18, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 202.07, "avg": 202.07, "max": 202.07, "min": 202.07, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.84, "avg": 6.84, "max": 6.84, "min": 6.84, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 46, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 71.97, "avg": 23.99, "max": 1.48, "min": 68.52, "cnt": 3}, "forward-compute":{"total": 1946.66, "avg": 60.83, "max": 54.51, "min": 70.72, "cnt": 32}, "fwd-compute":{"total": 1943.68, "avg": 60.74, "max": 54.44, "min": 70.59, "cnt": 32}, "batch-generator":{"total": 42.75, "avg": 1.34, "max": 0.72, "min": 2.96, "cnt": 32}, "fwd-embedding":{"total": 0.54, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1889.01, "avg": 59.03, "max": 53.43, "min": 68.49, "cnt": 32}, "fwd-layernorm":{"total": 9.48, "avg": 0.07, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 105.32, "avg": 0.82, "max": 0.74, "min": 1.55, "cnt": 128}, "fwd-misc":{"total": 20.80, "avg": 0.16, "max": 0.11, "min": 0.45, "cnt": 128}, "fwd-MLP":{"total": 1732.63, "avg": 13.54, "max": 10.00, "min": 19.73, "cnt": 128}, "MoE_L0_fwd":{"total": 471.89, "avg": 14.75, "max": 11.55, "min": 19.65, "cnt": 32}, "MoEMLP":{"total": 1715.95, "avg": 13.41, "max": 9.90, "min": 19.61, "cnt": 128}, "MoE_L1_fwd":{"total": 508.46, "avg": 15.89, "max": 14.73, "min": 17.37, "cnt": 32}, "MoE_L2_fwd":{"total": 387.96, "avg": 12.12, "max": 11.43, "min": 16.01, "cnt": 32}, "MoE_L3_fwd":{"total": 353.77, "avg": 11.06, "max": 9.94, "min": 14.99, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.26, "avg": 0.63, "max": 0.59, "min": 0.67, "cnt": 2}, "forward-send-backward-recv":{"total": 177.71, "avg": 5.92, "max": 0.87, "min": 112.97, "cnt": 30}, "backward-compute":{"total": 1934.79, "avg": 60.46, "max": 56.13, "min": 63.09, "cnt": 32}, "MoE_L3_bwd":{"total": 392.10, "avg": 12.25, "max": 10.44, "min": 14.08, "cnt": 32}, "MoE_L2_bwd":{"total": 393.42, "avg": 12.29, "max": 11.38, "min": 13.05, "cnt": 32}, "MoE_L1_bwd":{"total": 557.50, "avg": 17.42, "max": 16.89, "min": 18.06, "cnt": 32}, "MoE_L0_bwd":{"total": 375.75, "avg": 11.74, "max": 10.96, "min": 12.21, "cnt": 32}, "backward-send-forward-recv":{"total": 3683.06, "avg": 127.00, "max": 1.11, "min": 483.94, "cnt": 29}, "backward-send":{"total": 2.35, "avg": 0.78, "max": 0.49, "min": 1.06, "cnt": 3}, "backward-recv":{"total": 144.48, "avg": 72.24, "max": 50.29, "min": 94.18, "cnt": 2}, "backward-params-all-reduce":{"total": 487.46, "avg": 487.46, "max": 487.46, "min": 487.46, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 241.57, "avg": 241.57, "max": 241.57, "min": 241.57, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.41, "avg": 3.41, "max": 3.41, "min": 3.41, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 197.18, "avg": 197.18, "max": 197.18, "min": 197.18, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.91, "avg": 6.91, "max": 6.91, "min": 6.91, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 47, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 74.16, "avg": 24.72, "max": 1.63, "min": 70.75, "cnt": 3}, "forward-compute":{"total": 2161.87, "avg": 67.56, "max": 53.58, "min": 247.61, "cnt": 32}, "fwd-compute":{"total": 2158.73, "avg": 67.46, "max": 53.51, "min": 247.48, "cnt": 32}, "batch-generator":{"total": 49.73, "avg": 1.55, "max": 0.66, "min": 3.45, "cnt": 32}, "fwd-embedding":{"total": 0.63, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 2096.49, "avg": 65.52, "max": 52.55, "min": 245.36, "cnt": 32}, "fwd-layernorm":{"total": 9.84, "avg": 0.08, "max": 0.06, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 107.49, "avg": 0.84, "max": 0.74, "min": 1.74, "cnt": 128}, "fwd-misc":{"total": 21.65, "avg": 0.17, "max": 0.12, "min": 0.53, "cnt": 128}, "fwd-MLP":{"total": 1936.45, "avg": 15.13, "max": 10.17, "min": 199.37, "cnt": 128}, "MoE_L0_fwd":{"total": 528.27, "avg": 16.51, "max": 12.12, "min": 20.63, "cnt": 32}, "MoEMLP":{"total": 1919.86, "avg": 15.00, "max": 10.06, "min": 199.22, "cnt": 128}, "MoE_L1_fwd":{"total": 666.90, "avg": 20.84, "max": 13.69, "min": 199.27, "cnt": 32}, "MoE_L2_fwd":{"total": 379.82, "avg": 11.87, "max": 10.76, "min": 16.58, "cnt": 32}, "MoE_L3_fwd":{"total": 351.02, "avg": 10.97, "max": 10.10, "min": 16.27, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.90, "avg": 0.95, "max": 0.87, "min": 1.04, "cnt": 2}, "forward-send-backward-recv":{"total": 237.66, "avg": 7.92, "max": 1.68, "min": 119.94, "cnt": 30}, "backward-compute":{"total": 1822.02, "avg": 56.94, "max": 54.36, "min": 58.20, "cnt": 32}, "MoE_L3_bwd":{"total": 381.44, "avg": 11.92, "max": 10.89, "min": 13.62, "cnt": 32}, "MoE_L2_bwd":{"total": 357.63, "avg": 11.18, "max": 9.67, "min": 12.39, "cnt": 32}, "MoE_L1_bwd":{"total": 489.41, "avg": 15.29, "max": 14.37, "min": 16.04, "cnt": 32}, "MoE_L0_bwd":{"total": 376.28, "avg": 11.76, "max": 11.05, "min": 12.46, "cnt": 32}, "backward-send-forward-recv":{"total": 4460.22, "avg": 153.80, "max": 1.54, "min": 655.76, "cnt": 29}, "backward-send":{"total": 2.70, "avg": 0.90, "max": 0.72, "min": 1.01, "cnt": 3}, "backward-recv":{"total": 206.97, "avg": 103.49, "max": 59.10, "min": 147.88, "cnt": 2}, "backward-params-all-reduce":{"total": 487.10, "avg": 487.10, "max": 487.10, "min": 487.10, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 238.83, "avg": 238.83, "max": 238.83, "min": 238.83, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 194.76, "avg": 194.76, "max": 194.76, "min": 194.76, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.83, "avg": 6.83, "max": 6.83, "min": 6.83, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 48, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 79.38, "avg": 26.46, "max": 1.54, "min": 76.28, "cnt": 3}, "forward-compute":{"total": 1915.23, "avg": 59.85, "max": 54.38, "min": 67.91, "cnt": 32}, "fwd-compute":{"total": 1912.27, "avg": 59.76, "max": 54.30, "min": 67.84, "cnt": 32}, "batch-generator":{"total": 40.00, "avg": 1.25, "max": 0.67, "min": 2.28, "cnt": 32}, "fwd-embedding":{"total": 0.54, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1860.13, "avg": 58.13, "max": 53.16, "min": 65.71, "cnt": 32}, "fwd-layernorm":{"total": 9.52, "avg": 0.07, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 107.20, "avg": 0.84, "max": 0.74, "min": 1.44, "cnt": 128}, "fwd-misc":{"total": 20.57, "avg": 0.16, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1701.96, "avg": 13.30, "max": 10.09, "min": 23.29, "cnt": 128}, "MoE_L0_fwd":{"total": 516.38, "avg": 16.14, "max": 11.70, "min": 23.21, "cnt": 32}, "MoEMLP":{"total": 1685.54, "avg": 13.17, "max": 9.99, "min": 23.17, "cnt": 128}, "MoE_L1_fwd":{"total": 453.24, "avg": 14.16, "max": 13.10, "min": 15.97, "cnt": 32}, "MoE_L2_fwd":{"total": 374.90, "avg": 11.72, "max": 10.78, "min": 15.43, "cnt": 32}, "MoE_L3_fwd":{"total": 346.99, "avg": 10.84, "max": 10.03, "min": 12.18, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.93, "avg": 0.96, "max": 0.95, "min": 0.98, "cnt": 2}, "forward-send-backward-recv":{"total": 1045.78, "avg": 34.86, "max": 1.74, "min": 176.26, "cnt": 30}, "backward-compute":{"total": 1720.76, "avg": 53.77, "max": 51.70, "min": 56.71, "cnt": 32}, "MoE_L3_bwd":{"total": 365.64, "avg": 11.43, "max": 10.03, "min": 15.13, "cnt": 32}, "MoE_L2_bwd":{"total": 332.45, "avg": 10.39, "max": 9.45, "min": 11.29, "cnt": 32}, "MoE_L1_bwd":{"total": 425.44, "avg": 13.30, "max": 12.94, "min": 13.75, "cnt": 32}, "MoE_L0_bwd":{"total": 381.02, "avg": 11.91, "max": 11.42, "min": 13.47, "cnt": 32}, "backward-send-forward-recv":{"total": 3797.50, "avg": 130.95, "max": 1.99, "min": 723.33, "cnt": 29}, "backward-send":{"total": 2.94, "avg": 0.98, "max": 0.93, "min": 1.02, "cnt": 3}, "backward-recv":{"total": 595.14, "avg": 297.57, "max": 206.76, "min": 388.38, "cnt": 2}, "backward-params-all-reduce":{"total": 486.89, "avg": 486.89, "max": 486.89, "min": 486.89, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 245.70, "avg": 245.70, "max": 245.70, "min": 245.70, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 194.32, "avg": 194.32, "max": 194.32, "min": 194.32, "cnt": 1}, "optimizer-clip-main-grad":{"total": 7.48, "avg": 7.48, "max": 7.48, "min": 7.48, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 49, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 64.62, "avg": 21.54, "max": 1.42, "min": 61.57, "cnt": 3}, "forward-compute":{"total": 1900.48, "avg": 59.39, "max": 53.13, "min": 66.05, "cnt": 32}, "fwd-compute":{"total": 1897.20, "avg": 59.29, "max": 53.05, "min": 65.98, "cnt": 32}, "batch-generator":{"total": 45.33, "avg": 1.42, "max": 0.65, "min": 3.66, "cnt": 32}, "fwd-embedding":{"total": 0.67, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1839.05, "avg": 57.47, "max": 51.94, "min": 64.75, "cnt": 32}, "fwd-layernorm":{"total": 10.27, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 110.08, "avg": 0.86, "max": 0.74, "min": 1.48, "cnt": 128}, "fwd-misc":{"total": 21.84, "avg": 0.17, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1675.12, "avg": 13.09, "max": 10.46, "min": 23.13, "cnt": 128}, "MoE_L0_fwd":{"total": 504.38, "avg": 15.76, "max": 12.10, "min": 23.05, "cnt": 32}, "MoEMLP":{"total": 1657.54, "avg": 12.95, "max": 10.35, "min": 23.00, "cnt": 128}, "MoE_L1_fwd":{"total": 435.49, "avg": 13.61, "max": 12.37, "min": 15.58, "cnt": 32}, "MoE_L2_fwd":{"total": 382.72, "avg": 11.96, "max": 11.32, "min": 14.65, "cnt": 32}, "MoE_L3_fwd":{"total": 341.31, "avg": 10.67, "max": 10.39, "min": 11.16, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 3.35, "avg": 1.67, "max": 0.97, "min": 2.38, "cnt": 2}, "forward-send-backward-recv":{"total": 278.92, "avg": 9.30, "max": 1.62, "min": 119.04, "cnt": 30}, "backward-compute":{"total": 1684.37, "avg": 52.64, "max": 50.41, "min": 53.56, "cnt": 32}, "MoE_L3_bwd":{"total": 368.14, "avg": 11.50, "max": 10.71, "min": 11.95, "cnt": 32}, "MoE_L2_bwd":{"total": 341.74, "avg": 10.68, "max": 10.08, "min": 12.08, "cnt": 32}, "MoE_L1_bwd":{"total": 396.41, "avg": 12.39, "max": 11.97, "min": 12.97, "cnt": 32}, "MoE_L0_bwd":{"total": 359.64, "avg": 11.24, "max": 10.88, "min": 11.61, "cnt": 32}, "backward-send-forward-recv":{"total": 3585.37, "avg": 123.63, "max": 2.09, "min": 596.52, "cnt": 29}, "backward-send":{"total": 2.98, "avg": 0.99, "max": 0.79, "min": 1.11, "cnt": 3}, "backward-recv":{"total": 563.53, "avg": 281.77, "max": 68.43, "min": 495.10, "cnt": 2}, "backward-params-all-reduce":{"total": 488.33, "avg": 488.33, "max": 488.33, "min": 488.33, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 234.04, "avg": 234.04, "max": 234.04, "min": 234.04, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 193.75, "avg": 193.75, "max": 193.75, "min": 193.75, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.70, "avg": 3.70, "max": 3.70, "min": 3.70, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.47, "avg": 3.47, "max": 3.47, "min": 3.47, "cnt": 1}}}
{"type":"time", "iteration": 50, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 193.69, "avg": 64.56, "max": 1.23, "min": 190.91, "cnt": 3}, "forward-compute":{"total": 2003.73, "avg": 62.62, "max": 48.94, "min": 313.27, "cnt": 32}, "fwd-compute":{"total": 2000.75, "avg": 62.52, "max": 48.87, "min": 313.18, "cnt": 32}, "batch-generator":{"total": 43.36, "avg": 1.36, "max": 0.71, "min": 3.41, "cnt": 32}, "fwd-embedding":{"total": 0.55, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1944.96, "avg": 60.78, "max": 47.60, "min": 312.02, "cnt": 32}, "fwd-layernorm":{"total": 9.49, "avg": 0.07, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 105.50, "avg": 0.82, "max": 0.74, "min": 1.50, "cnt": 128}, "fwd-misc":{"total": 20.33, "avg": 0.16, "max": 0.12, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1789.01, "avg": 13.98, "max": 9.80, "min": 141.60, "cnt": 128}, "MoE_L0_fwd":{"total": 563.09, "avg": 17.60, "max": 9.73, "min": 141.52, "cnt": 32}, "MoEMLP":{"total": 1772.78, "avg": 13.85, "max": 9.69, "min": 141.47, "cnt": 128}, "MoE_L1_fwd":{"total": 509.83, "avg": 15.93, "max": 10.47, "min": 141.47, "cnt": 32}, "MoE_L2_fwd":{"total": 373.03, "avg": 11.66, "max": 11.01, "min": 13.52, "cnt": 32}, "MoE_L3_fwd":{"total": 332.82, "avg": 10.40, "max": 9.91, "min": 11.12, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.63, "avg": 0.02, "max": 0.02, "min": 0.04, "cnt": 32}, "forward-send":{"total": 17.40, "avg": 8.70, "max": 0.84, "min": 16.55, "cnt": 2}, "forward-send-backward-recv":{"total": 255.86, "avg": 8.53, "max": 1.30, "min": 126.03, "cnt": 30}, "backward-compute":{"total": 1472.36, "avg": 46.01, "max": 43.44, "min": 48.13, "cnt": 32}, "MoE_L3_bwd":{"total": 345.23, "avg": 10.79, "max": 9.85, "min": 12.42, "cnt": 32}, "MoE_L2_bwd":{"total": 347.83, "avg": 10.87, "max": 10.21, "min": 12.05, "cnt": 32}, "MoE_L1_bwd":{"total": 293.79, "avg": 9.18, "max": 8.56, "min": 9.64, "cnt": 32}, "MoE_L0_bwd":{"total": 266.86, "avg": 8.34, "max": 7.71, "min": 8.82, "cnt": 32}, "backward-send-forward-recv":{"total": 3935.86, "avg": 135.72, "max": 2.38, "min": 418.38, "cnt": 29}, "backward-send":{"total": 3.19, "avg": 1.06, "max": 1.05, "min": 1.07, "cnt": 3}, "backward-recv":{"total": 140.66, "avg": 70.33, "max": 67.46, "min": 73.20, "cnt": 2}, "backward-params-all-reduce":{"total": 488.78, "avg": 488.78, "max": 488.78, "min": 488.78, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 242.17, "avg": 242.17, "max": 242.17, "min": 242.17, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 202.39, "avg": 202.39, "max": 202.39, "min": 202.39, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 51, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 96.42, "avg": 32.14, "max": 3.07, "min": 79.98, "cnt": 3}, "forward-compute":{"total": 1783.52, "avg": 55.73, "max": 49.33, "min": 62.58, "cnt": 32}, "fwd-compute":{"total": 1780.57, "avg": 55.64, "max": 49.26, "min": 62.50, "cnt": 32}, "batch-generator":{"total": 54.28, "avg": 1.70, "max": 0.66, "min": 3.65, "cnt": 32}, "fwd-embedding":{"total": 0.55, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1713.65, "avg": 53.55, "max": 48.24, "min": 59.51, "cnt": 32}, "fwd-layernorm":{"total": 9.56, "avg": 0.07, "max": 0.06, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 104.11, "avg": 0.81, "max": 0.74, "min": 1.50, "cnt": 128}, "fwd-misc":{"total": 20.58, "avg": 0.16, "max": 0.12, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1558.54, "avg": 12.18, "max": 10.10, "min": 18.77, "cnt": 128}, "MoE_L0_fwd":{"total": 433.17, "avg": 13.54, "max": 10.17, "min": 18.69, "cnt": 32}, "MoEMLP":{"total": 1541.95, "avg": 12.05, "max": 9.99, "min": 18.64, "cnt": 128}, "MoE_L1_fwd":{"total": 390.77, "avg": 12.21, "max": 10.64, "min": 18.17, "cnt": 32}, "MoE_L2_fwd":{"total": 377.48, "avg": 11.80, "max": 11.18, "min": 13.51, "cnt": 32}, "MoE_L3_fwd":{"total": 346.67, "avg": 10.83, "max": 10.03, "min": 12.67, "cnt": 32}, "fwd-pooler":{"total": 0.36, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.61, "avg": 0.02, "max": 0.02, "min": 0.05, "cnt": 32}, "forward-send":{"total": 1.87, "avg": 0.94, "max": 0.85, "min": 1.02, "cnt": 2}, "forward-send-backward-recv":{"total": 312.85, "avg": 10.43, "max": 1.09, "min": 105.43, "cnt": 30}, "backward-compute":{"total": 1513.50, "avg": 47.30, "max": 44.21, "min": 49.82, "cnt": 32}, "MoE_L3_bwd":{"total": 345.00, "avg": 10.78, "max": 9.83, "min": 11.86, "cnt": 32}, "MoE_L2_bwd":{"total": 346.41, "avg": 10.83, "max": 9.87, "min": 11.68, "cnt": 32}, "MoE_L1_bwd":{"total": 317.23, "avg": 9.91, "max": 9.31, "min": 12.26, "cnt": 32}, "MoE_L0_bwd":{"total": 286.67, "avg": 8.96, "max": 8.22, "min": 10.82, "cnt": 32}, "backward-send-forward-recv":{"total": 3136.85, "avg": 108.17, "max": 2.47, "min": 261.78, "cnt": 29}, "backward-send":{"total": 2.13, "avg": 0.71, "max": 0.53, "min": 1.05, "cnt": 3}, "backward-recv":{"total": 568.19, "avg": 284.10, "max": 252.40, "min": 315.80, "cnt": 2}, "backward-params-all-reduce":{"total": 485.96, "avg": 485.96, "max": 485.96, "min": 485.96, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 246.30, "avg": 246.30, "max": 246.30, "min": 246.30, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 201.18, "avg": 201.18, "max": 201.18, "min": 201.18, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.54, "avg": 3.54, "max": 3.54, "min": 3.54, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 52, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 84.46, "avg": 28.15, "max": 4.24, "min": 69.36, "cnt": 3}, "forward-compute":{"total": 1852.63, "avg": 57.89, "max": 49.49, "min": 71.11, "cnt": 32}, "fwd-compute":{"total": 1849.36, "avg": 57.79, "max": 49.42, "min": 71.03, "cnt": 32}, "batch-generator":{"total": 41.90, "avg": 1.31, "max": 0.68, "min": 2.34, "cnt": 32}, "fwd-embedding":{"total": 0.65, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1794.81, "avg": 56.09, "max": 48.44, "min": 69.78, "cnt": 32}, "fwd-layernorm":{"total": 10.31, "avg": 0.08, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 110.75, "avg": 0.87, "max": 0.74, "min": 1.70, "cnt": 128}, "fwd-misc":{"total": 22.07, "avg": 0.17, "max": 0.11, "min": 0.47, "cnt": 128}, "fwd-MLP":{"total": 1629.63, "avg": 12.73, "max": 10.28, "min": 25.88, "cnt": 128}, "MoE_L0_fwd":{"total": 479.37, "avg": 14.98, "max": 10.95, "min": 25.78, "cnt": 32}, "MoEMLP":{"total": 1611.74, "avg": 12.59, "max": 10.17, "min": 25.73, "cnt": 128}, "MoE_L1_fwd":{"total": 404.65, "avg": 12.65, "max": 11.21, "min": 17.96, "cnt": 32}, "MoE_L2_fwd":{"total": 373.55, "avg": 11.67, "max": 10.91, "min": 14.66, "cnt": 32}, "MoE_L3_fwd":{"total": 360.48, "avg": 11.27, "max": 10.22, "min": 15.79, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.66, "avg": 0.83, "max": 0.73, "min": 0.93, "cnt": 2}, "forward-send-backward-recv":{"total": 260.74, "avg": 8.69, "max": 1.35, "min": 96.99, "cnt": 30}, "backward-compute":{"total": 1531.47, "avg": 47.86, "max": 44.80, "min": 55.92, "cnt": 32}, "MoE_L3_bwd":{"total": 358.83, "avg": 11.21, "max": 9.96, "min": 19.42, "cnt": 32}, "MoE_L2_bwd":{"total": 343.25, "avg": 10.73, "max": 10.13, "min": 11.78, "cnt": 32}, "MoE_L1_bwd":{"total": 321.23, "avg": 10.04, "max": 9.64, "min": 11.63, "cnt": 32}, "MoE_L0_bwd":{"total": 290.53, "avg": 9.08, "max": 8.21, "min": 9.96, "cnt": 32}, "backward-send-forward-recv":{"total": 5189.85, "avg": 178.96, "max": 1.83, "min": 937.64, "cnt": 29}, "backward-send":{"total": 3.64, "avg": 1.21, "max": 1.06, "min": 1.50, "cnt": 3}, "backward-recv":{"total": 359.71, "avg": 179.85, "max": 131.53, "min": 228.18, "cnt": 2}, "backward-params-all-reduce":{"total": 486.79, "avg": 486.79, "max": 486.79, "min": 486.79, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 237.11, "avg": 237.11, "max": 237.11, "min": 237.11, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 197.36, "avg": 197.36, "max": 197.36, "min": 197.36, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 53, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 77.66, "avg": 25.89, "max": 1.88, "min": 72.97, "cnt": 3}, "forward-compute":{"total": 1850.37, "avg": 57.82, "max": 50.14, "min": 76.51, "cnt": 32}, "fwd-compute":{"total": 1847.21, "avg": 57.73, "max": 50.07, "min": 76.42, "cnt": 32}, "batch-generator":{"total": 42.02, "avg": 1.31, "max": 0.66, "min": 4.30, "cnt": 32}, "fwd-embedding":{"total": 0.65, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1792.61, "avg": 56.02, "max": 49.12, "min": 71.64, "cnt": 32}, "fwd-layernorm":{"total": 10.00, "avg": 0.08, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 108.77, "avg": 0.85, "max": 0.74, "min": 2.09, "cnt": 128}, "fwd-misc":{"total": 21.18, "avg": 0.17, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1631.39, "avg": 12.75, "max": 10.74, "min": 18.60, "cnt": 128}, "MoE_L0_fwd":{"total": 468.68, "avg": 14.65, "max": 10.68, "min": 18.52, "cnt": 32}, "MoEMLP":{"total": 1614.00, "avg": 12.61, "max": 10.64, "min": 18.46, "cnt": 128}, "MoE_L1_fwd":{"total": 402.67, "avg": 12.58, "max": 11.26, "min": 16.47, "cnt": 32}, "MoE_L2_fwd":{"total": 378.06, "avg": 11.81, "max": 10.95, "min": 17.34, "cnt": 32}, "MoE_L3_fwd":{"total": 370.87, "avg": 11.59, "max": 10.75, "min": 16.29, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.61, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 2.66, "avg": 1.33, "max": 0.90, "min": 1.76, "cnt": 2}, "forward-send-backward-recv":{"total": 1518.04, "avg": 50.60, "max": 1.02, "min": 379.84, "cnt": 30}, "backward-compute":{"total": 1557.51, "avg": 48.67, "max": 45.81, "min": 51.63, "cnt": 32}, "MoE_L3_bwd":{"total": 378.07, "avg": 11.81, "max": 10.76, "min": 14.78, "cnt": 32}, "MoE_L2_bwd":{"total": 347.83, "avg": 10.87, "max": 10.20, "min": 12.03, "cnt": 32}, "MoE_L1_bwd":{"total": 319.20, "avg": 9.98, "max": 9.36, "min": 10.47, "cnt": 32}, "MoE_L0_bwd":{"total": 296.79, "avg": 9.27, "max": 8.41, "min": 9.82, "cnt": 32}, "backward-send-forward-recv":{"total": 2731.33, "avg": 94.18, "max": 1.12, "min": 620.90, "cnt": 29}, "backward-send":{"total": 2.77, "avg": 0.92, "max": 0.86, "min": 0.97, "cnt": 3}, "backward-recv":{"total": 351.26, "avg": 175.63, "max": 72.28, "min": 278.97, "cnt": 2}, "backward-params-all-reduce":{"total": 488.02, "avg": 488.02, "max": 488.02, "min": 488.02, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 235.93, "avg": 235.93, "max": 235.93, "min": 235.93, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 196.15, "avg": 196.15, "max": 196.15, "min": 196.15, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.34, "avg": 3.34, "max": 3.34, "min": 3.34, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 54, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 75.92, "avg": 25.31, "max": 1.73, "min": 71.05, "cnt": 3}, "forward-compute":{"total": 1817.64, "avg": 56.80, "max": 49.25, "min": 63.18, "cnt": 32}, "fwd-compute":{"total": 1814.58, "avg": 56.71, "max": 49.19, "min": 63.10, "cnt": 32}, "batch-generator":{"total": 41.69, "avg": 1.30, "max": 0.65, "min": 2.85, "cnt": 32}, "fwd-embedding":{"total": 0.53, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1760.59, "avg": 55.02, "max": 48.19, "min": 60.37, "cnt": 32}, "fwd-layernorm":{"total": 9.42, "avg": 0.07, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 104.82, "avg": 0.82, "max": 0.74, "min": 1.46, "cnt": 128}, "fwd-misc":{"total": 20.84, "avg": 0.16, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1605.20, "avg": 12.54, "max": 10.34, "min": 19.25, "cnt": 128}, "MoE_L0_fwd":{"total": 473.63, "avg": 14.80, "max": 10.30, "min": 19.17, "cnt": 32}, "MoEMLP":{"total": 1589.07, "avg": 12.41, "max": 10.24, "min": 19.12, "cnt": 128}, "MoE_L1_fwd":{"total": 403.08, "avg": 12.60, "max": 11.13, "min": 16.69, "cnt": 32}, "MoE_L2_fwd":{"total": 368.69, "avg": 11.52, "max": 10.80, "min": 12.38, "cnt": 32}, "MoE_L3_fwd":{"total": 349.61, "avg": 10.93, "max": 10.28, "min": 12.24, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 3.57, "avg": 1.79, "max": 0.73, "min": 2.84, "cnt": 2}, "forward-send-backward-recv":{"total": 193.80, "avg": 6.46, "max": 1.36, "min": 119.45, "cnt": 30}, "backward-compute":{"total": 1519.68, "avg": 47.49, "max": 45.69, "min": 48.50, "cnt": 32}, "MoE_L3_bwd":{"total": 347.43, "avg": 10.86, "max": 10.38, "min": 12.09, "cnt": 32}, "MoE_L2_bwd":{"total": 339.46, "avg": 10.61, "max": 9.97, "min": 11.45, "cnt": 32}, "MoE_L1_bwd":{"total": 322.14, "avg": 10.07, "max": 9.69, "min": 10.50, "cnt": 32}, "MoE_L0_bwd":{"total": 292.89, "avg": 9.15, "max": 8.83, "min": 9.46, "cnt": 32}, "backward-send-forward-recv":{"total": 3991.94, "avg": 137.65, "max": 2.39, "min": 436.99, "cnt": 29}, "backward-send":{"total": 3.06, "avg": 1.02, "max": 0.99, "min": 1.06, "cnt": 3}, "backward-recv":{"total": 121.84, "avg": 60.92, "max": 55.03, "min": 66.81, "cnt": 2}, "backward-params-all-reduce":{"total": 486.85, "avg": 486.85, "max": 486.85, "min": 486.85, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 238.88, "avg": 238.88, "max": 238.88, "min": 238.88, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.36, "avg": 3.36, "max": 3.36, "min": 3.36, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 199.11, "avg": 199.11, "max": 199.11, "min": 199.11, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.29, "avg": 3.29, "max": 3.29, "min": 3.29, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 55, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.10, "avg": 0.10, "max": 0.10, "min": 0.10, "cnt": 1}, "forward-recv":{"total": 82.90, "avg": 27.63, "max": 1.45, "min": 79.89, "cnt": 3}, "forward-compute":{"total": 1794.12, "avg": 56.07, "max": 47.71, "min": 72.19, "cnt": 32}, "fwd-compute":{"total": 1790.79, "avg": 55.96, "max": 47.64, "min": 72.09, "cnt": 32}, "batch-generator":{"total": 48.07, "avg": 1.50, "max": 0.67, "min": 2.83, "cnt": 32}, "fwd-embedding":{"total": 0.66, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1729.57, "avg": 54.05, "max": 46.67, "min": 69.74, "cnt": 32}, "fwd-layernorm":{"total": 10.33, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 109.34, "avg": 0.85, "max": 0.74, "min": 1.58, "cnt": 128}, "fwd-misc":{"total": 22.06, "avg": 0.17, "max": 0.12, "min": 0.41, "cnt": 128}, "fwd-MLP":{"total": 1565.78, "avg": 12.23, "max": 9.97, "min": 23.59, "cnt": 128}, "MoE_L0_fwd":{"total": 447.53, "avg": 13.99, "max": 10.32, "min": 18.11, "cnt": 32}, "MoEMLP":{"total": 1548.54, "avg": 12.10, "max": 9.85, "min": 23.45, "cnt": 128}, "MoE_L1_fwd":{"total": 394.49, "avg": 12.33, "max": 10.90, "min": 23.51, "cnt": 32}, "MoE_L2_fwd":{"total": 361.52, "avg": 11.30, "max": 10.64, "min": 12.33, "cnt": 32}, "MoE_L3_fwd":{"total": 351.37, "avg": 10.98, "max": 9.90, "min": 16.05, "cnt": 32}, "fwd-pooler":{"total": 0.36, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 4.17, "avg": 2.09, "max": 0.94, "min": 3.23, "cnt": 2}, "forward-send-backward-recv":{"total": 306.32, "avg": 10.21, "max": 1.18, "min": 117.82, "cnt": 30}, "backward-compute":{"total": 1514.98, "avg": 47.34, "max": 44.18, "min": 49.49, "cnt": 32}, "MoE_L3_bwd":{"total": 352.50, "avg": 11.02, "max": 9.74, "min": 12.35, "cnt": 32}, "MoE_L2_bwd":{"total": 334.30, "avg": 10.45, "max": 9.82, "min": 11.12, "cnt": 32}, "MoE_L1_bwd":{"total": 314.53, "avg": 9.83, "max": 9.28, "min": 11.28, "cnt": 32}, "MoE_L0_bwd":{"total": 294.67, "avg": 9.21, "max": 8.43, "min": 10.29, "cnt": 32}, "backward-send-forward-recv":{"total": 3493.64, "avg": 120.47, "max": 2.32, "min": 325.39, "cnt": 29}, "backward-send":{"total": 2.69, "avg": 0.90, "max": 0.65, "min": 1.12, "cnt": 3}, "backward-recv":{"total": 234.46, "avg": 117.23, "max": 79.78, "min": 154.68, "cnt": 2}, "backward-params-all-reduce":{"total": 538.92, "avg": 538.92, "max": 538.92, "min": 538.92, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 191.20, "avg": 191.20, "max": 191.20, "min": 191.20, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.40, "avg": 3.40, "max": 3.40, "min": 3.40, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 140.35, "avg": 140.35, "max": 140.35, "min": 140.35, "cnt": 1}, "optimizer-clip-main-grad":{"total": 7.55, "avg": 7.55, "max": 7.55, "min": 7.55, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 56, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 68.94, "avg": 22.98, "max": 1.58, "min": 64.43, "cnt": 3}, "forward-compute":{"total": 1822.58, "avg": 56.96, "max": 50.70, "min": 65.42, "cnt": 32}, "fwd-compute":{"total": 1819.36, "avg": 56.86, "max": 50.62, "min": 65.31, "cnt": 32}, "batch-generator":{"total": 57.28, "avg": 1.79, "max": 0.64, "min": 4.10, "cnt": 32}, "fwd-embedding":{"total": 0.65, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1749.42, "avg": 54.67, "max": 49.64, "min": 63.67, "cnt": 32}, "fwd-layernorm":{"total": 10.28, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 109.30, "avg": 0.85, "max": 0.74, "min": 1.47, "cnt": 128}, "fwd-misc":{"total": 21.54, "avg": 0.17, "max": 0.11, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1586.81, "avg": 12.40, "max": 10.39, "min": 17.82, "cnt": 128}, "MoE_L0_fwd":{"total": 443.61, "avg": 13.86, "max": 10.76, "min": 17.73, "cnt": 32}, "MoEMLP":{"total": 1569.71, "avg": 12.26, "max": 10.28, "min": 17.69, "cnt": 128}, "MoE_L1_fwd":{"total": 393.34, "avg": 12.29, "max": 11.03, "min": 15.76, "cnt": 32}, "MoE_L2_fwd":{"total": 379.86, "avg": 11.87, "max": 10.71, "min": 17.23, "cnt": 32}, "MoE_L3_fwd":{"total": 359.16, "avg": 11.22, "max": 10.32, "min": 17.16, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.46, "avg": 0.73, "max": 0.62, "min": 0.84, "cnt": 2}, "forward-send-backward-recv":{"total": 186.52, "avg": 6.22, "max": 1.11, "min": 117.60, "cnt": 30}, "backward-compute":{"total": 1533.33, "avg": 47.92, "max": 46.65, "min": 48.89, "cnt": 32}, "MoE_L3_bwd":{"total": 362.02, "avg": 11.31, "max": 10.59, "min": 13.22, "cnt": 32}, "MoE_L2_bwd":{"total": 337.05, "avg": 10.53, "max": 9.87, "min": 11.55, "cnt": 32}, "MoE_L1_bwd":{"total": 316.33, "avg": 9.89, "max": 9.20, "min": 10.21, "cnt": 32}, "MoE_L0_bwd":{"total": 298.45, "avg": 9.33, "max": 8.86, "min": 9.63, "cnt": 32}, "backward-send-forward-recv":{"total": 4221.84, "avg": 145.58, "max": 2.08, "min": 687.74, "cnt": 29}, "backward-send":{"total": 2.82, "avg": 0.94, "max": 0.50, "min": 1.17, "cnt": 3}, "backward-recv":{"total": 202.93, "avg": 101.46, "max": 72.47, "min": 130.46, "cnt": 2}, "backward-params-all-reduce":{"total": 488.73, "avg": 488.73, "max": 488.73, "min": 488.73, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 236.02, "avg": 236.02, "max": 236.02, "min": 236.02, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.49, "avg": 3.49, "max": 3.49, "min": 3.49, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 195.94, "avg": 195.94, "max": 195.94, "min": 195.94, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.56, "avg": 3.56, "max": 3.56, "min": 3.56, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 57, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 76.17, "avg": 25.39, "max": 2.04, "min": 65.65, "cnt": 3}, "forward-compute":{"total": 1869.17, "avg": 58.41, "max": 50.19, "min": 69.80, "cnt": 32}, "fwd-compute":{"total": 1865.86, "avg": 58.31, "max": 50.12, "min": 69.71, "cnt": 32}, "batch-generator":{"total": 66.47, "avg": 2.08, "max": 0.68, "min": 4.41, "cnt": 32}, "fwd-embedding":{"total": 0.71, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1786.41, "avg": 55.83, "max": 49.13, "min": 66.45, "cnt": 32}, "fwd-layernorm":{"total": 10.65, "avg": 0.08, "max": 0.06, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 109.74, "avg": 0.86, "max": 0.74, "min": 1.64, "cnt": 128}, "fwd-misc":{"total": 22.17, "avg": 0.17, "max": 0.12, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1621.91, "avg": 12.67, "max": 10.68, "min": 18.22, "cnt": 128}, "MoE_L0_fwd":{"total": 452.73, "avg": 14.15, "max": 10.59, "min": 16.99, "cnt": 32}, "MoEMLP":{"total": 1604.37, "avg": 12.53, "max": 10.54, "min": 18.12, "cnt": 128}, "MoE_L1_fwd":{"total": 399.87, "avg": 12.50, "max": 11.12, "min": 14.90, "cnt": 32}, "MoE_L2_fwd":{"total": 385.99, "avg": 12.06, "max": 11.21, "min": 14.85, "cnt": 32}, "MoE_L3_fwd":{"total": 372.33, "avg": 11.64, "max": 10.62, "min": 18.15, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 7.10, "avg": 3.55, "max": 0.81, "min": 6.29, "cnt": 2}, "forward-send-backward-recv":{"total": 256.27, "avg": 8.54, "max": 1.55, "min": 122.80, "cnt": 30}, "backward-compute":{"total": 1571.00, "avg": 49.09, "max": 47.62, "min": 50.65, "cnt": 32}, "MoE_L3_bwd":{"total": 380.99, "avg": 11.91, "max": 11.20, "min": 13.10, "cnt": 32}, "MoE_L2_bwd":{"total": 353.67, "avg": 11.05, "max": 10.19, "min": 12.05, "cnt": 32}, "MoE_L1_bwd":{"total": 317.23, "avg": 9.91, "max": 9.43, "min": 11.94, "cnt": 32}, "MoE_L0_bwd":{"total": 302.97, "avg": 9.47, "max": 9.10, "min": 9.84, "cnt": 32}, "backward-send-forward-recv":{"total": 4780.30, "avg": 164.84, "max": 1.98, "min": 870.26, "cnt": 29}, "backward-send":{"total": 2.75, "avg": 0.92, "max": 0.83, "min": 1.03, "cnt": 3}, "backward-recv":{"total": 142.93, "avg": 71.46, "max": 63.44, "min": 79.49, "cnt": 2}, "backward-params-all-reduce":{"total": 485.32, "avg": 485.32, "max": 485.32, "min": 485.32, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 243.36, "avg": 243.36, "max": 243.36, "min": 243.36, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 203.57, "avg": 203.57, "max": 203.57, "min": 203.57, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.28, "avg": 3.28, "max": 3.28, "min": 3.28, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 58, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 78.69, "avg": 26.23, "max": 1.33, "min": 75.86, "cnt": 3}, "forward-compute":{"total": 1862.35, "avg": 58.20, "max": 50.23, "min": 63.69, "cnt": 32}, "fwd-compute":{"total": 1858.88, "avg": 58.09, "max": 50.17, "min": 63.58, "cnt": 32}, "batch-generator":{"total": 60.02, "avg": 1.88, "max": 0.68, "min": 4.94, "cnt": 32}, "fwd-embedding":{"total": 0.78, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1785.31, "avg": 55.79, "max": 49.20, "min": 61.47, "cnt": 32}, "fwd-layernorm":{"total": 11.05, "avg": 0.09, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 111.87, "avg": 0.87, "max": 0.74, "min": 1.56, "cnt": 128}, "fwd-misc":{"total": 22.95, "avg": 0.18, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1616.62, "avg": 12.63, "max": 10.24, "min": 17.92, "cnt": 128}, "MoE_L0_fwd":{"total": 452.07, "avg": 14.13, "max": 10.18, "min": 17.85, "cnt": 32}, "MoEMLP":{"total": 1598.39, "avg": 12.49, "max": 10.14, "min": 17.80, "cnt": 128}, "MoE_L1_fwd":{"total": 398.88, "avg": 12.47, "max": 11.55, "min": 13.49, "cnt": 32}, "MoE_L2_fwd":{"total": 375.47, "avg": 11.73, "max": 10.98, "min": 14.93, "cnt": 32}, "MoE_L3_fwd":{"total": 378.63, "avg": 11.83, "max": 11.07, "min": 13.37, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 4.24, "avg": 2.12, "max": 0.90, "min": 3.34, "cnt": 2}, "forward-send-backward-recv":{"total": 222.24, "avg": 7.41, "max": 1.49, "min": 121.49, "cnt": 30}, "backward-compute":{"total": 1582.44, "avg": 49.45, "max": 47.91, "min": 51.00, "cnt": 32}, "MoE_L3_bwd":{"total": 390.37, "avg": 12.20, "max": 11.27, "min": 13.36, "cnt": 32}, "MoE_L2_bwd":{"total": 347.25, "avg": 10.85, "max": 9.62, "min": 11.79, "cnt": 32}, "MoE_L1_bwd":{"total": 322.71, "avg": 10.08, "max": 9.66, "min": 10.59, "cnt": 32}, "MoE_L0_bwd":{"total": 307.59, "avg": 9.61, "max": 9.08, "min": 9.98, "cnt": 32}, "backward-send-forward-recv":{"total": 5176.24, "avg": 178.49, "max": 2.25, "min": 1067.62, "cnt": 29}, "backward-send":{"total": 3.10, "avg": 1.03, "max": 0.83, "min": 1.17, "cnt": 3}, "backward-recv":{"total": 223.21, "avg": 111.61, "max": 86.93, "min": 136.28, "cnt": 2}, "backward-params-all-reduce":{"total": 486.77, "avg": 486.77, "max": 486.77, "min": 486.77, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 234.45, "avg": 234.45, "max": 234.45, "min": 234.45, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 194.64, "avg": 194.64, "max": 194.64, "min": 194.64, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.49, "avg": 3.49, "max": 3.49, "min": 3.49, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 59, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 84.90, "avg": 28.30, "max": 1.39, "min": 82.01, "cnt": 3}, "forward-compute":{"total": 1883.45, "avg": 58.86, "max": 51.74, "min": 67.77, "cnt": 32}, "fwd-compute":{"total": 1880.21, "avg": 58.76, "max": 51.67, "min": 67.69, "cnt": 32}, "batch-generator":{"total": 50.10, "avg": 1.57, "max": 0.68, "min": 4.37, "cnt": 32}, "fwd-embedding":{"total": 0.81, "avg": 0.03, "max": 0.01, "min": 0.06, "cnt": 32}, "fwd-encoder":{"total": 1816.67, "avg": 56.77, "max": 50.69, "min": 66.52, "cnt": 32}, "fwd-layernorm":{"total": 11.32, "avg": 0.09, "max": 0.06, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 114.87, "avg": 0.90, "max": 0.74, "min": 1.55, "cnt": 128}, "fwd-misc":{"total": 23.79, "avg": 0.19, "max": 0.11, "min": 0.53, "cnt": 128}, "fwd-MLP":{"total": 1642.72, "avg": 12.83, "max": 10.88, "min": 22.75, "cnt": 128}, "MoE_L0_fwd":{"total": 468.23, "avg": 14.63, "max": 11.32, "min": 22.43, "cnt": 32}, "MoEMLP":{"total": 1624.04, "avg": 12.69, "max": 10.77, "min": 22.34, "cnt": 128}, "MoE_L1_fwd":{"total": 415.44, "avg": 12.98, "max": 11.68, "min": 17.17, "cnt": 32}, "MoE_L2_fwd":{"total": 369.32, "avg": 11.54, "max": 10.81, "min": 15.31, "cnt": 32}, "MoE_L3_fwd":{"total": 377.81, "avg": 11.81, "max": 11.21, "min": 13.97, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 2.18, "avg": 1.09, "max": 0.94, "min": 1.24, "cnt": 2}, "forward-send-backward-recv":{"total": 208.39, "avg": 6.95, "max": 1.26, "min": 120.56, "cnt": 30}, "backward-compute":{"total": 1623.36, "avg": 50.73, "max": 47.91, "min": 52.90, "cnt": 32}, "MoE_L3_bwd":{"total": 400.47, "avg": 12.51, "max": 11.38, "min": 13.61, "cnt": 32}, "MoE_L2_bwd":{"total": 339.15, "avg": 10.60, "max": 10.09, "min": 11.41, "cnt": 32}, "MoE_L1_bwd":{"total": 351.23, "avg": 10.98, "max": 10.40, "min": 12.29, "cnt": 32}, "MoE_L0_bwd":{"total": 317.02, "avg": 9.91, "max": 9.31, "min": 10.34, "cnt": 32}, "backward-send-forward-recv":{"total": 5017.71, "avg": 173.02, "max": 2.34, "min": 709.56, "cnt": 29}, "backward-send":{"total": 2.59, "avg": 0.86, "max": 0.66, "min": 0.99, "cnt": 3}, "backward-recv":{"total": 242.55, "avg": 121.27, "max": 75.87, "min": 166.68, "cnt": 2}, "backward-params-all-reduce":{"total": 485.78, "avg": 485.78, "max": 485.78, "min": 485.78, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 239.31, "avg": 239.31, "max": 239.31, "min": 239.31, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 199.49, "avg": 199.49, "max": 199.49, "min": 199.49, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.40, "avg": 3.40, "max": 3.40, "min": 3.40, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}}}
{"type":"time", "iteration": 60, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 82.80, "avg": 27.60, "max": 1.23, "min": 80.13, "cnt": 3}, "forward-compute":{"total": 2139.26, "avg": 66.85, "max": 51.07, "min": 353.74, "cnt": 32}, "fwd-compute":{"total": 2136.00, "avg": 66.75, "max": 50.99, "min": 353.65, "cnt": 32}, "batch-generator":{"total": 51.11, "avg": 1.60, "max": 0.74, "min": 4.96, "cnt": 32}, "fwd-embedding":{"total": 0.68, "avg": 0.02, "max": 0.01, "min": 0.06, "cnt": 32}, "fwd-encoder":{"total": 2071.88, "avg": 64.75, "max": 49.67, "min": 352.53, "cnt": 32}, "fwd-layernorm":{"total": 10.51, "avg": 0.08, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 110.84, "avg": 0.87, "max": 0.74, "min": 1.66, "cnt": 128}, "fwd-misc":{"total": 22.24, "avg": 0.17, "max": 0.11, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1905.77, "avg": 14.89, "max": 10.58, "min": 175.43, "cnt": 128}, "MoE_L0_fwd":{"total": 618.96, "avg": 19.34, "max": 10.50, "min": 175.35, "cnt": 32}, "MoEMLP":{"total": 1887.96, "avg": 14.75, "max": 10.46, "min": 175.30, "cnt": 128}, "MoE_L1_fwd":{"total": 512.06, "avg": 16.00, "max": 10.77, "min": 142.22, "cnt": 32}, "MoE_L2_fwd":{"total": 382.78, "avg": 11.96, "max": 10.67, "min": 17.48, "cnt": 32}, "MoE_L3_fwd":{"total": 380.58, "avg": 11.89, "max": 11.26, "min": 13.19, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 271.22, "avg": 135.61, "max": 0.80, "min": 270.42, "cnt": 2}, "forward-send-backward-recv":{"total": 1518.69, "avg": 50.62, "max": 1.12, "min": 1405.14, "cnt": 30}, "backward-compute":{"total": 1539.42, "avg": 48.11, "max": 45.90, "min": 49.87, "cnt": 32}, "MoE_L3_bwd":{"total": 411.41, "avg": 12.86, "max": 11.55, "min": 13.86, "cnt": 32}, "MoE_L2_bwd":{"total": 341.54, "avg": 10.67, "max": 9.67, "min": 11.54, "cnt": 32}, "MoE_L1_bwd":{"total": 292.34, "avg": 9.14, "max": 8.76, "min": 9.93, "cnt": 32}, "MoE_L0_bwd":{"total": 276.05, "avg": 8.63, "max": 8.24, "min": 9.61, "cnt": 32}, "backward-send-forward-recv":{"total": 5057.99, "avg": 174.41, "max": 1.73, "min": 944.75, "cnt": 29}, "backward-send":{"total": 3.07, "avg": 1.02, "max": 0.96, "min": 1.13, "cnt": 3}, "backward-recv":{"total": 148.23, "avg": 74.12, "max": 68.38, "min": 79.85, "cnt": 2}, "backward-params-all-reduce":{"total": 486.49, "avg": 486.49, "max": 486.49, "min": 486.49, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 241.39, "avg": 241.39, "max": 241.39, "min": 241.39, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 201.41, "avg": 201.41, "max": 201.41, "min": 201.41, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.50, "avg": 3.50, "max": 3.50, "min": 3.50, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 61, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.10, "avg": 0.10, "max": 0.10, "min": 0.10, "cnt": 1}, "forward-recv":{"total": 90.17, "avg": 30.06, "max": 2.75, "min": 80.57, "cnt": 3}, "forward-compute":{"total": 1832.07, "avg": 57.25, "max": 50.01, "min": 64.26, "cnt": 32}, "fwd-compute":{"total": 1828.78, "avg": 57.15, "max": 49.94, "min": 64.15, "cnt": 32}, "batch-generator":{"total": 43.18, "avg": 1.35, "max": 0.73, "min": 2.64, "cnt": 32}, "fwd-embedding":{"total": 0.66, "avg": 0.02, "max": 0.01, "min": 0.06, "cnt": 32}, "fwd-encoder":{"total": 1773.01, "avg": 55.41, "max": 48.91, "min": 62.26, "cnt": 32}, "fwd-layernorm":{"total": 9.91, "avg": 0.08, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 110.26, "avg": 0.86, "max": 0.74, "min": 2.16, "cnt": 128}, "fwd-misc":{"total": 21.40, "avg": 0.17, "max": 0.11, "min": 0.41, "cnt": 128}, "fwd-MLP":{"total": 1610.44, "avg": 12.58, "max": 10.84, "min": 19.02, "cnt": 128}, "MoE_L0_fwd":{"total": 449.64, "avg": 14.05, "max": 10.77, "min": 18.91, "cnt": 32}, "MoEMLP":{"total": 1593.84, "avg": 12.45, "max": 10.73, "min": 18.86, "cnt": 128}, "MoE_L1_fwd":{"total": 380.33, "avg": 11.89, "max": 10.77, "min": 15.62, "cnt": 32}, "MoE_L2_fwd":{"total": 392.87, "avg": 12.28, "max": 10.89, "min": 16.81, "cnt": 32}, "MoE_L3_fwd":{"total": 377.12, "avg": 11.79, "max": 11.26, "min": 12.66, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.56, "avg": 0.78, "max": 0.68, "min": 0.88, "cnt": 2}, "forward-send-backward-recv":{"total": 161.95, "avg": 5.40, "max": 1.00, "min": 94.73, "cnt": 30}, "backward-compute":{"total": 1567.69, "avg": 48.99, "max": 45.80, "min": 52.76, "cnt": 32}, "MoE_L3_bwd":{"total": 420.10, "avg": 13.13, "max": 12.27, "min": 14.96, "cnt": 32}, "MoE_L2_bwd":{"total": 353.30, "avg": 11.04, "max": 10.18, "min": 12.05, "cnt": 32}, "MoE_L1_bwd":{"total": 294.98, "avg": 9.22, "max": 8.63, "min": 10.61, "cnt": 32}, "MoE_L0_bwd":{"total": 283.18, "avg": 8.85, "max": 7.94, "min": 10.43, "cnt": 32}, "backward-send-forward-recv":{"total": 3433.12, "avg": 118.38, "max": 1.86, "min": 431.85, "cnt": 29}, "backward-send":{"total": 3.06, "avg": 1.02, "max": 0.91, "min": 1.16, "cnt": 3}, "backward-recv":{"total": 368.47, "avg": 184.23, "max": 56.11, "min": 312.35, "cnt": 2}, "backward-params-all-reduce":{"total": 485.94, "avg": 485.94, "max": 485.94, "min": 485.94, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 245.74, "avg": 245.74, "max": 245.74, "min": 245.74, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 205.94, "avg": 205.94, "max": 205.94, "min": 205.94, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.32, "avg": 3.32, "max": 3.32, "min": 3.32, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 62, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 85.32, "avg": 28.44, "max": 1.55, "min": 77.19, "cnt": 3}, "forward-compute":{"total": 1882.13, "avg": 58.82, "max": 52.71, "min": 65.29, "cnt": 32}, "fwd-compute":{"total": 1878.87, "avg": 58.71, "max": 52.62, "min": 65.20, "cnt": 32}, "batch-generator":{"total": 44.99, "avg": 1.41, "max": 0.69, "min": 2.97, "cnt": 32}, "fwd-embedding":{"total": 0.64, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1821.50, "avg": 56.92, "max": 51.48, "min": 62.93, "cnt": 32}, "fwd-layernorm":{"total": 10.10, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 109.84, "avg": 0.86, "max": 0.74, "min": 1.48, "cnt": 128}, "fwd-misc":{"total": 21.17, "avg": 0.17, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1659.15, "avg": 12.96, "max": 10.87, "min": 21.10, "cnt": 128}, "MoE_L0_fwd":{"total": 492.05, "avg": 15.38, "max": 10.80, "min": 20.91, "cnt": 32}, "MoEMLP":{"total": 1642.29, "avg": 12.83, "max": 10.75, "min": 20.87, "cnt": 128}, "MoE_L1_fwd":{"total": 379.90, "avg": 11.87, "max": 10.84, "min": 16.87, "cnt": 32}, "MoE_L2_fwd":{"total": 390.14, "avg": 12.19, "max": 11.36, "min": 13.27, "cnt": 32}, "MoE_L3_fwd":{"total": 386.32, "avg": 12.07, "max": 11.41, "min": 12.91, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.56, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.84, "avg": 0.92, "max": 0.89, "min": 0.95, "cnt": 2}, "forward-send-backward-recv":{"total": 326.53, "avg": 10.88, "max": 0.87, "min": 102.74, "cnt": 30}, "backward-compute":{"total": 1602.97, "avg": 50.09, "max": 47.46, "min": 52.68, "cnt": 32}, "MoE_L3_bwd":{"total": 439.39, "avg": 13.73, "max": 12.43, "min": 15.95, "cnt": 32}, "MoE_L2_bwd":{"total": 377.14, "avg": 11.79, "max": 10.45, "min": 13.01, "cnt": 32}, "MoE_L1_bwd":{"total": 288.34, "avg": 9.01, "max": 8.37, "min": 9.38, "cnt": 32}, "MoE_L0_bwd":{"total": 282.36, "avg": 8.82, "max": 7.40, "min": 9.84, "cnt": 32}, "backward-send-forward-recv":{"total": 3846.02, "avg": 132.62, "max": 1.74, "min": 565.31, "cnt": 29}, "backward-send":{"total": 2.61, "avg": 0.87, "max": 0.79, "min": 0.95, "cnt": 3}, "backward-recv":{"total": 349.43, "avg": 174.71, "max": 75.81, "min": 273.62, "cnt": 2}, "backward-params-all-reduce":{"total": 489.51, "avg": 489.51, "max": 489.51, "min": 489.51, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 236.95, "avg": 236.95, "max": 236.95, "min": 236.95, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 197.08, "avg": 197.08, "max": 197.08, "min": 197.08, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.34, "avg": 3.34, "max": 3.34, "min": 3.34, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.50, "avg": 3.50, "max": 3.50, "min": 3.50, "cnt": 1}}}
{"type":"time", "iteration": 63, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.10, "avg": 0.10, "max": 0.10, "min": 0.10, "cnt": 1}, "forward-recv":{"total": 69.19, "avg": 23.06, "max": 1.54, "min": 65.89, "cnt": 3}, "forward-compute":{"total": 1887.17, "avg": 58.97, "max": 51.45, "min": 66.51, "cnt": 32}, "fwd-compute":{"total": 1883.84, "avg": 58.87, "max": 51.37, "min": 66.43, "cnt": 32}, "batch-generator":{"total": 46.62, "avg": 1.46, "max": 0.77, "min": 2.27, "cnt": 32}, "fwd-embedding":{"total": 0.66, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1823.59, "avg": 56.99, "max": 50.23, "min": 65.24, "cnt": 32}, "fwd-layernorm":{"total": 10.23, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 110.29, "avg": 0.86, "max": 0.74, "min": 1.53, "cnt": 128}, "fwd-misc":{"total": 21.69, "avg": 0.17, "max": 0.12, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1659.94, "avg": 12.97, "max": 10.44, "min": 19.23, "cnt": 128}, "MoE_L0_fwd":{"total": 465.07, "avg": 14.53, "max": 10.36, "min": 19.15, "cnt": 32}, "MoEMLP":{"total": 1642.77, "avg": 12.83, "max": 10.32, "min": 19.10, "cnt": 128}, "MoE_L1_fwd":{"total": 378.70, "avg": 11.83, "max": 10.68, "min": 14.05, "cnt": 32}, "MoE_L2_fwd":{"total": 409.71, "avg": 12.80, "max": 11.80, "min": 17.98, "cnt": 32}, "MoE_L3_fwd":{"total": 395.49, "avg": 12.36, "max": 11.43, "min": 16.00, "cnt": 32}, "fwd-pooler":{"total": 0.37, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.56, "avg": 0.78, "max": 0.73, "min": 0.82, "cnt": 2}, "forward-send-backward-recv":{"total": 243.13, "avg": 8.10, "max": 0.95, "min": 104.40, "cnt": 30}, "backward-compute":{"total": 1602.57, "avg": 50.08, "max": 46.89, "min": 52.35, "cnt": 32}, "MoE_L3_bwd":{"total": 437.72, "avg": 13.68, "max": 12.33, "min": 16.73, "cnt": 32}, "MoE_L2_bwd":{"total": 382.25, "avg": 11.95, "max": 11.36, "min": 13.80, "cnt": 32}, "MoE_L1_bwd":{"total": 293.77, "avg": 9.18, "max": 8.64, "min": 9.67, "cnt": 32}, "MoE_L0_bwd":{"total": 276.25, "avg": 8.63, "max": 8.02, "min": 9.17, "cnt": 32}, "backward-send-forward-recv":{"total": 5334.70, "avg": 183.96, "max": 2.24, "min": 666.94, "cnt": 29}, "backward-send":{"total": 2.60, "avg": 0.87, "max": 0.58, "min": 1.04, "cnt": 3}, "backward-recv":{"total": 383.28, "avg": 191.64, "max": 56.10, "min": 327.19, "cnt": 2}, "backward-params-all-reduce":{"total": 487.64, "avg": 487.64, "max": 487.64, "min": 487.64, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 244.14, "avg": 244.14, "max": 244.14, "min": 244.14, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 203.84, "avg": 203.84, "max": 203.84, "min": 203.84, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.72, "avg": 3.72, "max": 3.72, "min": 3.72, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 64, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.06, "avg": 0.06, "max": 0.06, "min": 0.06, "cnt": 1}, "forward-recv":{"total": 73.23, "avg": 24.41, "max": 1.70, "min": 69.80, "cnt": 3}, "forward-compute":{"total": 1856.31, "avg": 58.01, "max": 50.33, "min": 67.96, "cnt": 32}, "fwd-compute":{"total": 1853.14, "avg": 57.91, "max": 50.25, "min": 67.87, "cnt": 32}, "batch-generator":{"total": 43.28, "avg": 1.35, "max": 0.65, "min": 2.66, "cnt": 32}, "fwd-embedding":{"total": 0.61, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1797.49, "avg": 56.17, "max": 49.29, "min": 66.26, "cnt": 32}, "fwd-layernorm":{"total": 9.97, "avg": 0.08, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 109.00, "avg": 0.85, "max": 0.74, "min": 1.55, "cnt": 128}, "fwd-misc":{"total": 21.37, "avg": 0.17, "max": 0.12, "min": 0.39, "cnt": 128}, "fwd-MLP":{"total": 1635.81, "avg": 12.78, "max": 10.47, "min": 18.78, "cnt": 128}, "MoE_L0_fwd":{"total": 463.72, "avg": 14.49, "max": 10.39, "min": 18.71, "cnt": 32}, "MoEMLP":{"total": 1619.14, "avg": 12.65, "max": 10.35, "min": 18.66, "cnt": 128}, "MoE_L1_fwd":{"total": 376.67, "avg": 11.77, "max": 10.43, "min": 15.58, "cnt": 32}, "MoE_L2_fwd":{"total": 401.48, "avg": 12.55, "max": 11.68, "min": 15.54, "cnt": 32}, "MoE_L3_fwd":{"total": 383.42, "avg": 11.98, "max": 11.37, "min": 13.61, "cnt": 32}, "fwd-pooler":{"total": 0.36, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.47, "avg": 0.73, "max": 0.73, "min": 0.74, "cnt": 2}, "forward-send-backward-recv":{"total": 178.81, "avg": 5.96, "max": 1.45, "min": 112.39, "cnt": 30}, "backward-compute":{"total": 1578.27, "avg": 49.32, "max": 45.81, "min": 51.22, "cnt": 32}, "MoE_L3_bwd":{"total": 424.27, "avg": 13.26, "max": 11.34, "min": 14.36, "cnt": 32}, "MoE_L2_bwd":{"total": 368.28, "avg": 11.51, "max": 10.69, "min": 13.15, "cnt": 32}, "MoE_L1_bwd":{"total": 296.12, "avg": 9.25, "max": 8.66, "min": 9.73, "cnt": 32}, "MoE_L0_bwd":{"total": 275.22, "avg": 8.60, "max": 8.07, "min": 9.05, "cnt": 32}, "backward-send-forward-recv":{"total": 4698.16, "avg": 162.01, "max": 2.31, "min": 743.75, "cnt": 29}, "backward-send":{"total": 2.62, "avg": 0.87, "max": 0.75, "min": 1.03, "cnt": 3}, "backward-recv":{"total": 223.61, "avg": 111.80, "max": 106.28, "min": 117.33, "cnt": 2}, "backward-params-all-reduce":{"total": 487.79, "avg": 487.79, "max": 487.79, "min": 487.79, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 302.29, "avg": 302.29, "max": 302.29, "min": 302.29, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 197.56, "avg": 197.56, "max": 197.56, "min": 197.56, "cnt": 1}, "optimizer-clip-main-grad":{"total": 32.39, "avg": 32.39, "max": 32.39, "min": 32.39, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.41, "avg": 3.41, "max": 3.41, "min": 3.41, "cnt": 1}}}
{"type":"time", "iteration": 65, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 65.01, "avg": 21.67, "max": 3.81, "min": 57.23, "cnt": 3}, "forward-compute":{"total": 1822.96, "avg": 56.97, "max": 50.93, "min": 63.46, "cnt": 32}, "fwd-compute":{"total": 1820.05, "avg": 56.88, "max": 50.85, "min": 63.38, "cnt": 32}, "batch-generator":{"total": 39.11, "avg": 1.22, "max": 0.70, "min": 2.46, "cnt": 32}, "fwd-embedding":{"total": 0.58, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1768.37, "avg": 55.26, "max": 49.77, "min": 61.66, "cnt": 32}, "fwd-layernorm":{"total": 9.95, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 108.85, "avg": 0.85, "max": 0.74, "min": 1.52, "cnt": 128}, "fwd-misc":{"total": 21.55, "avg": 0.17, "max": 0.12, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1605.75, "avg": 12.54, "max": 10.31, "min": 19.04, "cnt": 128}, "MoE_L0_fwd":{"total": 434.49, "avg": 13.58, "max": 10.26, "min": 18.87, "cnt": 32}, "MoEMLP":{"total": 1588.21, "avg": 12.41, "max": 10.19, "min": 18.82, "cnt": 128}, "MoE_L1_fwd":{"total": 362.76, "avg": 11.34, "max": 10.24, "min": 14.26, "cnt": 32}, "MoE_L2_fwd":{"total": 408.13, "avg": 12.75, "max": 12.18, "min": 13.68, "cnt": 32}, "MoE_L3_fwd":{"total": 389.13, "avg": 12.16, "max": 11.44, "min": 16.42, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.61, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.81, "avg": 0.90, "max": 0.86, "min": 0.94, "cnt": 2}, "forward-send-backward-recv":{"total": 161.35, "avg": 5.38, "max": 1.31, "min": 98.19, "cnt": 30}, "backward-compute":{"total": 1642.54, "avg": 51.33, "max": 48.21, "min": 79.12, "cnt": 32}, "MoE_L3_bwd":{"total": 453.28, "avg": 14.17, "max": 12.36, "min": 42.69, "cnt": 32}, "MoE_L2_bwd":{"total": 400.78, "avg": 12.52, "max": 11.70, "min": 13.38, "cnt": 32}, "MoE_L1_bwd":{"total": 291.36, "avg": 9.11, "max": 8.06, "min": 9.61, "cnt": 32}, "MoE_L0_bwd":{"total": 282.19, "avg": 8.82, "max": 8.33, "min": 9.23, "cnt": 32}, "backward-send-forward-recv":{"total": 3786.88, "avg": 130.58, "max": 2.47, "min": 834.37, "cnt": 29}, "backward-send":{"total": 2.55, "avg": 0.85, "max": 0.70, "min": 1.12, "cnt": 3}, "backward-recv":{"total": 324.59, "avg": 162.30, "max": 120.29, "min": 204.31, "cnt": 2}, "backward-params-all-reduce":{"total": 485.87, "avg": 485.87, "max": 485.87, "min": 485.87, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 237.76, "avg": 237.76, "max": 237.76, "min": 237.76, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 198.10, "avg": 198.10, "max": 198.10, "min": 198.10, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.32, "avg": 3.32, "max": 3.32, "min": 3.32, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 66, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 82.23, "avg": 27.41, "max": 1.30, "min": 79.42, "cnt": 3}, "forward-compute":{"total": 1916.65, "avg": 59.90, "max": 51.80, "min": 68.15, "cnt": 32}, "fwd-compute":{"total": 1913.49, "avg": 59.80, "max": 51.72, "min": 68.06, "cnt": 32}, "batch-generator":{"total": 40.22, "avg": 1.26, "max": 0.68, "min": 2.12, "cnt": 32}, "fwd-embedding":{"total": 0.64, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1860.17, "avg": 58.13, "max": 50.74, "min": 66.49, "cnt": 32}, "fwd-layernorm":{"total": 10.25, "avg": 0.08, "max": 0.06, "min": 0.22, "cnt": 128}, "fwd-attn":{"total": 110.04, "avg": 0.86, "max": 0.74, "min": 1.52, "cnt": 128}, "fwd-misc":{"total": 22.30, "avg": 0.17, "max": 0.12, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1695.39, "avg": 13.25, "max": 10.36, "min": 19.23, "cnt": 128}, "MoE_L0_fwd":{"total": 479.96, "avg": 15.00, "max": 10.44, "min": 18.68, "cnt": 32}, "MoEMLP":{"total": 1677.99, "avg": 13.11, "max": 10.24, "min": 19.03, "cnt": 128}, "MoE_L1_fwd":{"total": 385.26, "avg": 12.04, "max": 10.29, "min": 19.07, "cnt": 32}, "MoE_L2_fwd":{"total": 424.24, "avg": 13.26, "max": 12.62, "min": 16.04, "cnt": 32}, "MoE_L3_fwd":{"total": 394.82, "avg": 12.34, "max": 11.70, "min": 15.97, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 3.44, "avg": 1.72, "max": 0.94, "min": 2.50, "cnt": 2}, "forward-send-backward-recv":{"total": 170.76, "avg": 5.69, "max": 1.74, "min": 105.30, "cnt": 30}, "backward-compute":{"total": 1631.60, "avg": 50.99, "max": 49.26, "min": 53.76, "cnt": 32}, "MoE_L3_bwd":{"total": 419.66, "avg": 13.11, "max": 12.00, "min": 13.70, "cnt": 32}, "MoE_L2_bwd":{"total": 421.92, "avg": 13.18, "max": 12.16, "min": 15.12, "cnt": 32}, "MoE_L1_bwd":{"total": 291.35, "avg": 9.10, "max": 8.53, "min": 9.52, "cnt": 32}, "MoE_L0_bwd":{"total": 285.23, "avg": 8.91, "max": 8.36, "min": 11.38, "cnt": 32}, "backward-send-forward-recv":{"total": 3176.08, "avg": 109.52, "max": 1.71, "min": 381.44, "cnt": 29}, "backward-send":{"total": 3.10, "avg": 1.03, "max": 1.01, "min": 1.05, "cnt": 3}, "backward-recv":{"total": 121.84, "avg": 60.92, "max": 49.61, "min": 72.22, "cnt": 2}, "backward-params-all-reduce":{"total": 481.40, "avg": 481.40, "max": 481.40, "min": 481.40, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 244.47, "avg": 244.47, "max": 244.47, "min": 244.47, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 204.43, "avg": 204.43, "max": 204.43, "min": 204.43, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.54, "avg": 3.54, "max": 3.54, "min": 3.54, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 67, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 75.04, "avg": 25.01, "max": 1.11, "min": 67.72, "cnt": 3}, "forward-compute":{"total": 1889.35, "avg": 59.04, "max": 51.22, "min": 66.25, "cnt": 32}, "fwd-compute":{"total": 1885.86, "avg": 58.93, "max": 51.15, "min": 66.18, "cnt": 32}, "batch-generator":{"total": 41.36, "avg": 1.29, "max": 0.69, "min": 2.37, "cnt": 32}, "fwd-embedding":{"total": 0.65, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1831.55, "avg": 57.24, "max": 50.15, "min": 64.97, "cnt": 32}, "fwd-layernorm":{"total": 10.36, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 111.33, "avg": 0.87, "max": 0.74, "min": 1.53, "cnt": 128}, "fwd-misc":{"total": 22.52, "avg": 0.18, "max": 0.12, "min": 0.52, "cnt": 128}, "fwd-MLP":{"total": 1665.11, "avg": 13.01, "max": 10.39, "min": 18.61, "cnt": 128}, "MoE_L0_fwd":{"total": 459.91, "avg": 14.37, "max": 10.47, "min": 18.49, "cnt": 32}, "MoEMLP":{"total": 1647.47, "avg": 12.87, "max": 10.28, "min": 18.45, "cnt": 128}, "MoE_L1_fwd":{"total": 369.54, "avg": 11.55, "max": 10.32, "min": 14.03, "cnt": 32}, "MoE_L2_fwd":{"total": 422.58, "avg": 13.21, "max": 12.30, "min": 14.67, "cnt": 32}, "MoE_L3_fwd":{"total": 401.73, "avg": 12.55, "max": 11.83, "min": 13.26, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 3.95, "avg": 1.97, "max": 0.97, "min": 2.97, "cnt": 2}, "forward-send-backward-recv":{"total": 884.69, "avg": 29.49, "max": 1.35, "min": 163.14, "cnt": 30}, "backward-compute":{"total": 1650.31, "avg": 51.57, "max": 50.81, "min": 53.15, "cnt": 32}, "MoE_L3_bwd":{"total": 440.47, "avg": 13.76, "max": 13.04, "min": 15.78, "cnt": 32}, "MoE_L2_bwd":{"total": 418.35, "avg": 13.07, "max": 12.07, "min": 13.97, "cnt": 32}, "MoE_L1_bwd":{"total": 290.84, "avg": 9.09, "max": 8.51, "min": 9.67, "cnt": 32}, "MoE_L0_bwd":{"total": 284.52, "avg": 8.89, "max": 8.55, "min": 9.73, "cnt": 32}, "backward-send-forward-recv":{"total": 1946.17, "avg": 67.11, "max": 1.38, "min": 317.35, "cnt": 29}, "backward-send":{"total": 2.99, "avg": 1.00, "max": 0.97, "min": 1.04, "cnt": 3}, "backward-recv":{"total": 290.34, "avg": 145.17, "max": 63.36, "min": 226.98, "cnt": 2}, "backward-params-all-reduce":{"total": 486.30, "avg": 486.30, "max": 486.30, "min": 486.30, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 243.69, "avg": 243.69, "max": 243.69, "min": 243.69, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 203.59, "avg": 203.59, "max": 203.59, "min": 203.59, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.69, "avg": 3.69, "max": 3.69, "min": 3.69, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 68, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 71.25, "avg": 23.75, "max": 1.40, "min": 68.45, "cnt": 3}, "forward-compute":{"total": 1880.86, "avg": 58.78, "max": 52.16, "min": 65.02, "cnt": 32}, "fwd-compute":{"total": 1877.79, "avg": 58.68, "max": 52.09, "min": 64.91, "cnt": 32}, "batch-generator":{"total": 50.01, "avg": 1.56, "max": 0.67, "min": 3.13, "cnt": 32}, "fwd-embedding":{"total": 0.57, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1815.44, "avg": 56.73, "max": 51.13, "min": 62.83, "cnt": 32}, "fwd-layernorm":{"total": 9.74, "avg": 0.08, "max": 0.06, "min": 0.18, "cnt": 128}, "fwd-attn":{"total": 106.03, "avg": 0.83, "max": 0.74, "min": 1.48, "cnt": 128}, "fwd-misc":{"total": 20.79, "avg": 0.16, "max": 0.12, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1658.06, "avg": 12.95, "max": 10.45, "min": 18.55, "cnt": 128}, "MoE_L0_fwd":{"total": 447.70, "avg": 13.99, "max": 10.91, "min": 18.46, "cnt": 32}, "MoEMLP":{"total": 1641.57, "avg": 12.82, "max": 10.33, "min": 18.40, "cnt": 128}, "MoE_L1_fwd":{"total": 372.65, "avg": 11.65, "max": 10.37, "min": 13.89, "cnt": 32}, "MoE_L2_fwd":{"total": 415.77, "avg": 12.99, "max": 12.13, "min": 16.94, "cnt": 32}, "MoE_L3_fwd":{"total": 411.50, "avg": 12.86, "max": 12.23, "min": 13.64, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.94, "avg": 0.97, "max": 0.93, "min": 1.01, "cnt": 2}, "forward-send-backward-recv":{"total": 182.03, "avg": 6.07, "max": 1.66, "min": 111.87, "cnt": 30}, "backward-compute":{"total": 1643.29, "avg": 51.35, "max": 49.06, "min": 56.47, "cnt": 32}, "MoE_L3_bwd":{"total": 441.83, "avg": 13.81, "max": 12.95, "min": 15.03, "cnt": 32}, "MoE_L2_bwd":{"total": 407.49, "avg": 12.73, "max": 11.86, "min": 13.48, "cnt": 32}, "MoE_L1_bwd":{"total": 296.11, "avg": 9.25, "max": 8.41, "min": 11.85, "cnt": 32}, "MoE_L0_bwd":{"total": 284.79, "avg": 8.90, "max": 8.34, "min": 9.73, "cnt": 32}, "backward-send-forward-recv":{"total": 3950.65, "avg": 136.23, "max": 2.04, "min": 947.13, "cnt": 29}, "backward-send":{"total": 2.83, "avg": 0.94, "max": 0.75, "min": 1.07, "cnt": 3}, "backward-recv":{"total": 124.94, "avg": 62.47, "max": 58.18, "min": 66.75, "cnt": 2}, "backward-params-all-reduce":{"total": 485.36, "avg": 485.36, "max": 485.36, "min": 485.36, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 240.52, "avg": 240.52, "max": 240.52, "min": 240.52, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.53, "avg": 3.53, "max": 3.53, "min": 3.53, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 200.57, "avg": 200.57, "max": 200.57, "min": 200.57, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.53, "avg": 3.53, "max": 3.53, "min": 3.53, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 69, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 78.30, "avg": 26.10, "max": 1.38, "min": 75.42, "cnt": 3}, "forward-compute":{"total": 1943.85, "avg": 60.75, "max": 52.45, "min": 68.59, "cnt": 32}, "fwd-compute":{"total": 1940.91, "avg": 60.65, "max": 52.38, "min": 68.51, "cnt": 32}, "batch-generator":{"total": 42.02, "avg": 1.31, "max": 0.69, "min": 4.41, "cnt": 32}, "fwd-embedding":{"total": 0.58, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1886.68, "avg": 58.96, "max": 51.40, "min": 65.82, "cnt": 32}, "fwd-layernorm":{"total": 9.51, "avg": 0.07, "max": 0.06, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 105.72, "avg": 0.83, "max": 0.74, "min": 1.49, "cnt": 128}, "fwd-misc":{"total": 20.50, "avg": 0.16, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1730.13, "avg": 13.52, "max": 10.65, "min": 23.95, "cnt": 128}, "MoE_L0_fwd":{"total": 502.83, "avg": 15.71, "max": 10.68, "min": 23.87, "cnt": 32}, "MoEMLP":{"total": 1713.93, "avg": 13.39, "max": 10.53, "min": 23.83, "cnt": 128}, "MoE_L1_fwd":{"total": 382.93, "avg": 11.97, "max": 10.57, "min": 15.84, "cnt": 32}, "MoE_L2_fwd":{"total": 416.21, "avg": 13.01, "max": 12.12, "min": 16.67, "cnt": 32}, "MoE_L3_fwd":{"total": 417.95, "avg": 13.06, "max": 12.13, "min": 16.52, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 9.03, "avg": 4.52, "max": 0.89, "min": 8.14, "cnt": 2}, "forward-send-backward-recv":{"total": 168.71, "avg": 5.62, "max": 1.49, "min": 110.40, "cnt": 30}, "backward-compute":{"total": 1654.58, "avg": 51.71, "max": 50.06, "min": 56.73, "cnt": 32}, "MoE_L3_bwd":{"total": 448.13, "avg": 14.00, "max": 12.82, "min": 16.70, "cnt": 32}, "MoE_L2_bwd":{"total": 409.50, "avg": 12.80, "max": 12.13, "min": 14.03, "cnt": 32}, "MoE_L1_bwd":{"total": 294.86, "avg": 9.21, "max": 8.10, "min": 11.71, "cnt": 32}, "MoE_L0_bwd":{"total": 288.68, "avg": 9.02, "max": 8.40, "min": 10.35, "cnt": 32}, "backward-send-forward-recv":{"total": 3738.97, "avg": 128.93, "max": 1.19, "min": 411.33, "cnt": 29}, "backward-send":{"total": 2.83, "avg": 0.94, "max": 0.64, "min": 1.14, "cnt": 3}, "backward-recv":{"total": 123.97, "avg": 61.99, "max": 58.25, "min": 65.73, "cnt": 2}, "backward-params-all-reduce":{"total": 487.69, "avg": 487.69, "max": 487.69, "min": 487.69, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 237.48, "avg": 237.48, "max": 237.48, "min": 237.48, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 197.71, "avg": 197.71, "max": 197.71, "min": 197.71, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 70, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 347.64, "avg": 115.88, "max": 1.34, "min": 344.83, "cnt": 3}, "forward-compute":{"total": 2019.79, "avg": 63.12, "max": 51.06, "min": 211.91, "cnt": 32}, "fwd-compute":{"total": 2016.48, "avg": 63.02, "max": 50.99, "min": 211.82, "cnt": 32}, "batch-generator":{"total": 47.61, "avg": 1.49, "max": 0.77, "min": 4.32, "cnt": 32}, "fwd-embedding":{"total": 0.69, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1955.73, "avg": 61.12, "max": 49.61, "min": 210.55, "cnt": 32}, "fwd-layernorm":{"total": 10.78, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 112.90, "avg": 0.88, "max": 0.74, "min": 1.99, "cnt": 128}, "fwd-misc":{"total": 22.39, "avg": 0.17, "max": 0.11, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1787.27, "avg": 13.96, "max": 10.16, "min": 151.75, "cnt": 128}, "MoE_L0_fwd":{"total": 484.12, "avg": 15.13, "max": 10.74, "min": 26.74, "cnt": 32}, "MoEMLP":{"total": 1769.23, "avg": 13.82, "max": 10.06, "min": 151.64, "cnt": 128}, "MoE_L1_fwd":{"total": 391.61, "avg": 12.24, "max": 10.41, "min": 19.11, "cnt": 32}, "MoE_L2_fwd":{"total": 489.32, "avg": 15.29, "max": 10.10, "min": 151.68, "cnt": 32}, "MoE_L3_fwd":{"total": 410.75, "avg": 12.84, "max": 12.21, "min": 16.41, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 160.73, "avg": 80.37, "max": 1.02, "min": 159.71, "cnt": 2}, "forward-send-backward-recv":{"total": 235.13, "avg": 7.84, "max": 1.67, "min": 119.74, "cnt": 30}, "backward-compute":{"total": 1540.80, "avg": 48.15, "max": 45.01, "min": 50.07, "cnt": 32}, "MoE_L3_bwd":{"total": 445.16, "avg": 13.91, "max": 12.88, "min": 15.67, "cnt": 32}, "MoE_L2_bwd":{"total": 308.31, "avg": 9.63, "max": 8.53, "min": 10.76, "cnt": 32}, "MoE_L1_bwd":{"total": 293.13, "avg": 9.16, "max": 8.40, "min": 9.68, "cnt": 32}, "MoE_L0_bwd":{"total": 282.05, "avg": 8.81, "max": 8.00, "min": 9.18, "cnt": 32}, "backward-send-forward-recv":{"total": 3191.19, "avg": 110.04, "max": 1.67, "min": 467.97, "cnt": 29}, "backward-send":{"total": 3.23, "avg": 1.08, "max": 1.04, "min": 1.11, "cnt": 3}, "backward-recv":{"total": 143.19, "avg": 71.60, "max": 64.52, "min": 78.67, "cnt": 2}, "backward-params-all-reduce":{"total": 487.00, "avg": 487.00, "max": 487.00, "min": 487.00, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 236.73, "avg": 236.73, "max": 236.73, "min": 236.73, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 197.06, "avg": 197.06, "max": 197.06, "min": 197.06, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.30, "avg": 3.30, "max": 3.30, "min": 3.30, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 71, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 67.40, "avg": 22.47, "max": 1.29, "min": 64.55, "cnt": 3}, "forward-compute":{"total": 1850.71, "avg": 57.83, "max": 51.23, "min": 68.47, "cnt": 32}, "fwd-compute":{"total": 1847.54, "avg": 57.74, "max": 51.16, "min": 68.37, "cnt": 32}, "batch-generator":{"total": 41.58, "avg": 1.30, "max": 0.64, "min": 2.65, "cnt": 32}, "fwd-embedding":{"total": 0.63, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1792.76, "avg": 56.02, "max": 50.20, "min": 65.34, "cnt": 32}, "fwd-layernorm":{"total": 10.22, "avg": 0.08, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 110.13, "avg": 0.86, "max": 0.74, "min": 1.55, "cnt": 128}, "fwd-misc":{"total": 22.03, "avg": 0.17, "max": 0.11, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1628.07, "avg": 12.72, "max": 10.12, "min": 19.84, "cnt": 128}, "MoE_L0_fwd":{"total": 454.84, "avg": 14.21, "max": 11.20, "min": 19.74, "cnt": 32}, "MoEMLP":{"total": 1610.50, "avg": 12.58, "max": 10.00, "min": 19.70, "cnt": 128}, "MoE_L1_fwd":{"total": 373.69, "avg": 11.68, "max": 10.04, "min": 15.44, "cnt": 32}, "MoE_L2_fwd":{"total": 381.15, "avg": 11.91, "max": 10.78, "min": 16.93, "cnt": 32}, "MoE_L3_fwd":{"total": 407.24, "avg": 12.73, "max": 12.16, "min": 14.12, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.42, "avg": 0.71, "max": 0.67, "min": 0.75, "cnt": 2}, "forward-send-backward-recv":{"total": 168.74, "avg": 5.62, "max": 1.72, "min": 100.79, "cnt": 30}, "backward-compute":{"total": 1548.19, "avg": 48.38, "max": 46.98, "min": 50.85, "cnt": 32}, "MoE_L3_bwd":{"total": 439.04, "avg": 13.72, "max": 12.97, "min": 14.36, "cnt": 32}, "MoE_L2_bwd":{"total": 321.09, "avg": 10.03, "max": 9.05, "min": 10.66, "cnt": 32}, "MoE_L1_bwd":{"total": 291.91, "avg": 9.12, "max": 8.59, "min": 11.31, "cnt": 32}, "MoE_L0_bwd":{"total": 282.48, "avg": 8.83, "max": 8.50, "min": 9.22, "cnt": 32}, "backward-send-forward-recv":{"total": 3072.09, "avg": 105.93, "max": 2.25, "min": 343.56, "cnt": 29}, "backward-send":{"total": 2.79, "avg": 0.93, "max": 0.80, "min": 1.00, "cnt": 3}, "backward-recv":{"total": 129.90, "avg": 64.95, "max": 61.39, "min": 68.51, "cnt": 2}, "backward-params-all-reduce":{"total": 487.11, "avg": 487.11, "max": 487.11, "min": 487.11, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 232.55, "avg": 232.55, "max": 232.55, "min": 232.55, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 192.62, "avg": 192.62, "max": 192.62, "min": 192.62, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.66, "avg": 3.66, "max": 3.66, "min": 3.66, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}}}
{"type":"time", "iteration": 72, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 74.45, "avg": 24.82, "max": 1.27, "min": 71.61, "cnt": 3}, "forward-compute":{"total": 1840.07, "avg": 57.50, "max": 52.28, "min": 62.82, "cnt": 32}, "fwd-compute":{"total": 1836.80, "avg": 57.40, "max": 52.20, "min": 62.68, "cnt": 32}, "batch-generator":{"total": 42.03, "avg": 1.31, "max": 0.71, "min": 3.40, "cnt": 32}, "fwd-embedding":{"total": 0.61, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1781.78, "avg": 55.68, "max": 50.71, "min": 61.13, "cnt": 32}, "fwd-layernorm":{"total": 10.04, "avg": 0.08, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 109.48, "avg": 0.86, "max": 0.75, "min": 1.59, "cnt": 128}, "fwd-misc":{"total": 21.50, "avg": 0.17, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1619.01, "avg": 12.65, "max": 10.63, "min": 18.32, "cnt": 128}, "MoE_L0_fwd":{"total": 455.95, "avg": 14.25, "max": 10.89, "min": 18.25, "cnt": 32}, "MoEMLP":{"total": 1601.97, "avg": 12.52, "max": 10.49, "min": 18.20, "cnt": 128}, "MoE_L1_fwd":{"total": 374.04, "avg": 11.69, "max": 10.54, "min": 13.53, "cnt": 32}, "MoE_L2_fwd":{"total": 369.04, "avg": 11.53, "max": 10.82, "min": 14.04, "cnt": 32}, "MoE_L3_fwd":{"total": 409.16, "avg": 12.79, "max": 12.08, "min": 18.03, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 4.00, "avg": 2.00, "max": 0.94, "min": 3.07, "cnt": 2}, "forward-send-backward-recv":{"total": 234.87, "avg": 7.83, "max": 1.07, "min": 104.55, "cnt": 30}, "backward-compute":{"total": 1550.55, "avg": 48.45, "max": 46.24, "min": 49.78, "cnt": 32}, "MoE_L3_bwd":{"total": 442.30, "avg": 13.82, "max": 12.68, "min": 15.12, "cnt": 32}, "MoE_L2_bwd":{"total": 319.77, "avg": 9.99, "max": 9.56, "min": 10.56, "cnt": 32}, "MoE_L1_bwd":{"total": 288.30, "avg": 9.01, "max": 8.21, "min": 9.55, "cnt": 32}, "MoE_L0_bwd":{"total": 285.92, "avg": 8.94, "max": 8.52, "min": 10.20, "cnt": 32}, "backward-send-forward-recv":{"total": 2974.25, "avg": 102.56, "max": 2.03, "min": 321.74, "cnt": 29}, "backward-send":{"total": 3.16, "avg": 1.05, "max": 1.00, "min": 1.13, "cnt": 3}, "backward-recv":{"total": 314.44, "avg": 157.22, "max": 49.32, "min": 265.12, "cnt": 2}, "backward-params-all-reduce":{"total": 486.92, "avg": 486.92, "max": 486.92, "min": 486.92, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 235.68, "avg": 235.68, "max": 235.68, "min": 235.68, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 195.84, "avg": 195.84, "max": 195.84, "min": 195.84, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 73, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 67.46, "avg": 22.49, "max": 1.06, "min": 64.89, "cnt": 3}, "forward-compute":{"total": 1852.54, "avg": 57.89, "max": 50.45, "min": 71.68, "cnt": 32}, "fwd-compute":{"total": 1849.45, "avg": 57.80, "max": 50.38, "min": 71.60, "cnt": 32}, "batch-generator":{"total": 39.23, "avg": 1.23, "max": 0.68, "min": 1.96, "cnt": 32}, "fwd-embedding":{"total": 0.63, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1798.00, "avg": 56.19, "max": 49.27, "min": 70.48, "cnt": 32}, "fwd-layernorm":{"total": 10.06, "avg": 0.08, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 109.21, "avg": 0.85, "max": 0.74, "min": 1.73, "cnt": 128}, "fwd-misc":{"total": 21.43, "avg": 0.17, "max": 0.12, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1635.37, "avg": 12.78, "max": 10.47, "min": 21.87, "cnt": 128}, "MoE_L0_fwd":{"total": 476.45, "avg": 14.89, "max": 10.76, "min": 21.75, "cnt": 32}, "MoEMLP":{"total": 1617.75, "avg": 12.64, "max": 10.36, "min": 21.71, "cnt": 128}, "MoE_L1_fwd":{"total": 370.43, "avg": 11.58, "max": 10.40, "min": 16.39, "cnt": 32}, "MoE_L2_fwd":{"total": 367.42, "avg": 11.48, "max": 10.66, "min": 14.78, "cnt": 32}, "MoE_L3_fwd":{"total": 409.77, "avg": 12.81, "max": 12.07, "min": 14.32, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 4.45, "avg": 2.23, "max": 0.96, "min": 3.50, "cnt": 2}, "forward-send-backward-recv":{"total": 1380.64, "avg": 46.02, "max": 1.42, "min": 430.43, "cnt": 30}, "backward-compute":{"total": 1547.79, "avg": 48.37, "max": 46.45, "min": 50.22, "cnt": 32}, "MoE_L3_bwd":{"total": 447.28, "avg": 13.98, "max": 13.07, "min": 15.35, "cnt": 32}, "MoE_L2_bwd":{"total": 318.36, "avg": 9.95, "max": 9.41, "min": 10.38, "cnt": 32}, "MoE_L1_bwd":{"total": 284.55, "avg": 8.89, "max": 8.34, "min": 9.49, "cnt": 32}, "MoE_L0_bwd":{"total": 283.98, "avg": 8.87, "max": 8.35, "min": 10.52, "cnt": 32}, "backward-send-forward-recv":{"total": 3115.89, "avg": 107.44, "max": 1.59, "min": 380.62, "cnt": 29}, "backward-send":{"total": 3.29, "avg": 1.10, "max": 1.05, "min": 1.13, "cnt": 3}, "backward-recv":{"total": 412.38, "avg": 206.19, "max": 64.67, "min": 347.71, "cnt": 2}, "backward-params-all-reduce":{"total": 489.04, "avg": 489.04, "max": 489.04, "min": 489.04, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 228.72, "avg": 228.72, "max": 228.72, "min": 228.72, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 188.72, "avg": 188.72, "max": 188.72, "min": 188.72, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.58, "avg": 3.58, "max": 3.58, "min": 3.58, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 74, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 76.05, "avg": 25.35, "max": 1.60, "min": 69.66, "cnt": 3}, "forward-compute":{"total": 1944.03, "avg": 60.75, "max": 51.96, "min": 151.00, "cnt": 32}, "fwd-compute":{"total": 1940.60, "avg": 60.64, "max": 51.87, "min": 150.91, "cnt": 32}, "batch-generator":{"total": 41.52, "avg": 1.30, "max": 0.71, "min": 2.19, "cnt": 32}, "fwd-embedding":{"total": 0.68, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1886.11, "avg": 58.94, "max": 50.44, "min": 149.64, "cnt": 32}, "fwd-layernorm":{"total": 10.67, "avg": 0.08, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 113.22, "avg": 0.88, "max": 0.74, "min": 1.79, "cnt": 128}, "fwd-misc":{"total": 22.48, "avg": 0.18, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1717.19, "avg": 13.42, "max": 10.38, "min": 110.21, "cnt": 128}, "MoE_L0_fwd":{"total": 558.02, "avg": 17.44, "max": 10.84, "min": 110.12, "cnt": 32}, "MoEMLP":{"total": 1699.47, "avg": 13.28, "max": 10.26, "min": 110.07, "cnt": 128}, "MoE_L1_fwd":{"total": 370.00, "avg": 11.56, "max": 10.30, "min": 13.76, "cnt": 32}, "MoE_L2_fwd":{"total": 367.07, "avg": 11.47, "max": 10.78, "min": 15.39, "cnt": 32}, "MoE_L3_fwd":{"total": 410.81, "avg": 12.84, "max": 12.32, "min": 13.51, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.87, "avg": 0.93, "max": 0.93, "min": 0.94, "cnt": 2}, "forward-send-backward-recv":{"total": 1014.47, "avg": 33.82, "max": 1.76, "min": 261.13, "cnt": 30}, "backward-compute":{"total": 1557.79, "avg": 48.68, "max": 47.16, "min": 52.21, "cnt": 32}, "MoE_L3_bwd":{"total": 452.58, "avg": 14.14, "max": 12.89, "min": 17.52, "cnt": 32}, "MoE_L2_bwd":{"total": 322.45, "avg": 10.08, "max": 9.54, "min": 11.19, "cnt": 32}, "MoE_L1_bwd":{"total": 284.34, "avg": 8.89, "max": 8.37, "min": 9.23, "cnt": 32}, "MoE_L0_bwd":{"total": 282.41, "avg": 8.83, "max": 8.47, "min": 10.07, "cnt": 32}, "backward-send-forward-recv":{"total": 2537.38, "avg": 87.50, "max": 2.34, "min": 268.29, "cnt": 29}, "backward-send":{"total": 2.96, "avg": 0.99, "max": 0.69, "min": 1.17, "cnt": 3}, "backward-recv":{"total": 327.38, "avg": 163.69, "max": 69.85, "min": 257.53, "cnt": 2}, "backward-params-all-reduce":{"total": 488.77, "avg": 488.77, "max": 488.77, "min": 488.77, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.04, "avg": 0.04, "max": 0.04, "min": 0.04, "cnt": 1}, "optimizer":{"total": 232.78, "avg": 232.78, "max": 232.78, "min": 232.78, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.40, "avg": 3.40, "max": 3.40, "min": 3.40, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 193.00, "avg": 193.00, "max": 193.00, "min": 193.00, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 75, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 73.13, "avg": 24.38, "max": 1.51, "min": 66.80, "cnt": 3}, "forward-compute":{"total": 1884.20, "avg": 58.88, "max": 51.99, "min": 74.24, "cnt": 32}, "fwd-compute":{"total": 1880.91, "avg": 58.78, "max": 51.92, "min": 74.15, "cnt": 32}, "batch-generator":{"total": 69.87, "avg": 2.18, "max": 0.74, "min": 4.27, "cnt": 32}, "fwd-embedding":{"total": 0.72, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1797.94, "avg": 56.19, "max": 50.81, "min": 70.34, "cnt": 32}, "fwd-layernorm":{"total": 10.80, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 109.70, "avg": 0.86, "max": 0.74, "min": 1.47, "cnt": 128}, "fwd-misc":{"total": 22.60, "avg": 0.18, "max": 0.12, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1632.70, "avg": 12.76, "max": 10.45, "min": 29.42, "cnt": 128}, "MoE_L0_fwd":{"total": 465.88, "avg": 14.56, "max": 10.58, "min": 29.34, "cnt": 32}, "MoEMLP":{"total": 1615.15, "avg": 12.62, "max": 10.33, "min": 29.29, "cnt": 128}, "MoE_L1_fwd":{"total": 373.92, "avg": 11.68, "max": 10.38, "min": 13.40, "cnt": 32}, "MoE_L2_fwd":{"total": 363.64, "avg": 11.36, "max": 10.92, "min": 13.31, "cnt": 32}, "MoE_L3_fwd":{"total": 418.23, "avg": 13.07, "max": 12.19, "min": 13.75, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.58, "avg": 0.79, "max": 0.75, "min": 0.82, "cnt": 2}, "forward-send-backward-recv":{"total": 180.13, "avg": 6.00, "max": 1.61, "min": 108.51, "cnt": 30}, "backward-compute":{"total": 1576.76, "avg": 49.27, "max": 47.17, "min": 57.67, "cnt": 32}, "MoE_L3_bwd":{"total": 459.12, "avg": 14.35, "max": 13.03, "min": 17.88, "cnt": 32}, "MoE_L2_bwd":{"total": 323.18, "avg": 10.10, "max": 9.40, "min": 11.51, "cnt": 32}, "MoE_L1_bwd":{"total": 294.38, "avg": 9.20, "max": 8.67, "min": 12.81, "cnt": 32}, "MoE_L0_bwd":{"total": 282.59, "avg": 8.83, "max": 8.31, "min": 9.28, "cnt": 32}, "backward-send-forward-recv":{"total": 3368.20, "avg": 116.14, "max": 2.06, "min": 540.42, "cnt": 29}, "backward-send":{"total": 3.31, "avg": 1.10, "max": 1.06, "min": 1.16, "cnt": 3}, "backward-recv":{"total": 154.92, "avg": 77.46, "max": 72.79, "min": 82.13, "cnt": 2}, "backward-params-all-reduce":{"total": 487.62, "avg": 487.62, "max": 487.62, "min": 487.62, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 234.85, "avg": 234.85, "max": 234.85, "min": 234.85, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 194.52, "avg": 194.52, "max": 194.52, "min": 194.52, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.67, "avg": 3.67, "max": 3.67, "min": 3.67, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.47, "avg": 3.47, "max": 3.47, "min": 3.47, "cnt": 1}}}
{"type":"time", "iteration": 76, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 78.88, "avg": 26.29, "max": 1.25, "min": 76.21, "cnt": 3}, "forward-compute":{"total": 1880.22, "avg": 58.76, "max": 51.84, "min": 64.13, "cnt": 32}, "fwd-compute":{"total": 1877.02, "avg": 58.66, "max": 51.77, "min": 64.00, "cnt": 32}, "batch-generator":{"total": 46.69, "avg": 1.46, "max": 0.71, "min": 2.82, "cnt": 32}, "fwd-embedding":{"total": 0.69, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1817.29, "avg": 56.79, "max": 50.62, "min": 62.57, "cnt": 32}, "fwd-layernorm":{"total": 10.67, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 112.18, "avg": 0.88, "max": 0.74, "min": 1.91, "cnt": 128}, "fwd-misc":{"total": 22.84, "avg": 0.18, "max": 0.12, "min": 0.53, "cnt": 128}, "fwd-MLP":{"total": 1649.54, "avg": 12.89, "max": 10.24, "min": 20.11, "cnt": 128}, "MoE_L0_fwd":{"total": 480.72, "avg": 15.02, "max": 10.79, "min": 20.01, "cnt": 32}, "MoEMLP":{"total": 1632.15, "avg": 12.75, "max": 10.12, "min": 19.95, "cnt": 128}, "MoE_L1_fwd":{"total": 370.45, "avg": 11.58, "max": 10.17, "min": 13.91, "cnt": 32}, "MoE_L2_fwd":{"total": 366.17, "avg": 11.44, "max": 11.05, "min": 12.00, "cnt": 32}, "MoE_L3_fwd":{"total": 421.26, "avg": 13.16, "max": 12.49, "min": 15.74, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 3.84, "avg": 1.92, "max": 0.84, "min": 3.00, "cnt": 2}, "forward-send-backward-recv":{"total": 227.57, "avg": 7.59, "max": 0.94, "min": 111.11, "cnt": 30}, "backward-compute":{"total": 1570.01, "avg": 49.06, "max": 46.45, "min": 51.13, "cnt": 32}, "MoE_L3_bwd":{"total": 459.83, "avg": 14.37, "max": 12.42, "min": 17.12, "cnt": 32}, "MoE_L2_bwd":{"total": 326.93, "avg": 10.22, "max": 9.57, "min": 11.00, "cnt": 32}, "MoE_L1_bwd":{"total": 283.94, "avg": 8.87, "max": 8.18, "min": 9.46, "cnt": 32}, "MoE_L0_bwd":{"total": 284.21, "avg": 8.88, "max": 8.26, "min": 9.46, "cnt": 32}, "backward-send-forward-recv":{"total": 3609.93, "avg": 124.48, "max": 1.81, "min": 419.85, "cnt": 29}, "backward-send":{"total": 2.91, "avg": 0.97, "max": 0.89, "min": 1.02, "cnt": 3}, "backward-recv":{"total": 194.59, "avg": 97.29, "max": 58.64, "min": 135.94, "cnt": 2}, "backward-params-all-reduce":{"total": 484.46, "avg": 484.46, "max": 484.46, "min": 484.46, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 234.79, "avg": 234.79, "max": 234.79, "min": 234.79, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 195.01, "avg": 195.01, "max": 195.01, "min": 195.01, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.52, "avg": 3.52, "max": 3.52, "min": 3.52, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 77, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 71.46, "avg": 23.82, "max": 1.01, "min": 67.06, "cnt": 3}, "forward-compute":{"total": 1865.26, "avg": 58.29, "max": 49.60, "min": 67.54, "cnt": 32}, "fwd-compute":{"total": 1862.19, "avg": 58.19, "max": 49.53, "min": 67.45, "cnt": 32}, "batch-generator":{"total": 49.62, "avg": 1.55, "max": 0.68, "min": 3.58, "cnt": 32}, "fwd-embedding":{"total": 0.63, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1799.27, "avg": 56.23, "max": 48.55, "min": 65.82, "cnt": 32}, "fwd-layernorm":{"total": 10.21, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 108.88, "avg": 0.85, "max": 0.74, "min": 2.01, "cnt": 128}, "fwd-misc":{"total": 21.96, "avg": 0.17, "max": 0.11, "min": 0.38, "cnt": 128}, "fwd-MLP":{"total": 1636.34, "avg": 12.78, "max": 10.21, "min": 20.01, "cnt": 128}, "MoE_L0_fwd":{"total": 472.48, "avg": 14.76, "max": 10.14, "min": 19.92, "cnt": 32}, "MoEMLP":{"total": 1619.21, "avg": 12.65, "max": 10.10, "min": 19.88, "cnt": 128}, "MoE_L1_fwd":{"total": 378.22, "avg": 11.82, "max": 10.45, "min": 17.11, "cnt": 32}, "MoE_L2_fwd":{"total": 358.05, "avg": 11.19, "max": 10.57, "min": 12.85, "cnt": 32}, "MoE_L3_fwd":{"total": 416.69, "avg": 13.02, "max": 11.97, "min": 16.95, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 8.34, "avg": 4.17, "max": 0.92, "min": 7.43, "cnt": 2}, "forward-send-backward-recv":{"total": 198.59, "avg": 6.62, "max": 1.21, "min": 129.65, "cnt": 30}, "backward-compute":{"total": 1558.74, "avg": 48.71, "max": 46.35, "min": 51.87, "cnt": 32}, "MoE_L3_bwd":{"total": 451.83, "avg": 14.12, "max": 12.95, "min": 15.35, "cnt": 32}, "MoE_L2_bwd":{"total": 314.92, "avg": 9.84, "max": 9.29, "min": 10.74, "cnt": 32}, "MoE_L1_bwd":{"total": 288.39, "avg": 9.01, "max": 8.45, "min": 9.77, "cnt": 32}, "MoE_L0_bwd":{"total": 283.99, "avg": 8.87, "max": 8.06, "min": 9.94, "cnt": 32}, "backward-send-forward-recv":{"total": 5152.17, "avg": 177.66, "max": 1.83, "min": 858.04, "cnt": 29}, "backward-send":{"total": 3.39, "avg": 1.13, "max": 1.11, "min": 1.17, "cnt": 3}, "backward-recv":{"total": 120.90, "avg": 60.45, "max": 50.92, "min": 69.99, "cnt": 2}, "backward-params-all-reduce":{"total": 485.22, "avg": 485.22, "max": 485.22, "min": 485.22, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 234.77, "avg": 234.77, "max": 234.77, "min": 234.77, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 194.54, "avg": 194.54, "max": 194.54, "min": 194.54, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.73, "avg": 3.73, "max": 3.73, "min": 3.73, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 78, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.12, "avg": 0.12, "max": 0.12, "min": 0.12, "cnt": 1}, "forward-recv":{"total": 74.05, "avg": 24.68, "max": 1.36, "min": 71.13, "cnt": 3}, "forward-compute":{"total": 1921.99, "avg": 60.06, "max": 49.52, "min": 117.78, "cnt": 32}, "fwd-compute":{"total": 1918.49, "avg": 59.95, "max": 49.46, "min": 117.68, "cnt": 32}, "batch-generator":{"total": 46.97, "avg": 1.47, "max": 0.69, "min": 2.57, "cnt": 32}, "fwd-embedding":{"total": 0.74, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1858.49, "avg": 58.08, "max": 48.47, "min": 116.07, "cnt": 32}, "fwd-layernorm":{"total": 11.07, "avg": 0.09, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 113.78, "avg": 0.89, "max": 0.74, "min": 2.35, "cnt": 128}, "fwd-misc":{"total": 22.96, "avg": 0.18, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1688.29, "avg": 13.19, "max": 10.39, "min": 74.99, "cnt": 128}, "MoE_L0_fwd":{"total": 531.44, "avg": 16.61, "max": 10.31, "min": 74.90, "cnt": 32}, "MoEMLP":{"total": 1670.35, "avg": 13.05, "max": 10.27, "min": 74.85, "cnt": 128}, "MoE_L1_fwd":{"total": 377.17, "avg": 11.79, "max": 10.43, "min": 15.55, "cnt": 32}, "MoE_L2_fwd":{"total": 353.82, "avg": 11.06, "max": 10.55, "min": 12.91, "cnt": 32}, "MoE_L3_fwd":{"total": 414.50, "avg": 12.95, "max": 11.83, "min": 15.86, "cnt": 32}, "fwd-pooler":{"total": 0.36, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 4.34, "avg": 2.17, "max": 1.02, "min": 3.32, "cnt": 2}, "forward-send-backward-recv":{"total": 1711.76, "avg": 57.06, "max": 0.95, "min": 403.20, "cnt": 30}, "backward-compute":{"total": 1548.25, "avg": 48.38, "max": 46.40, "min": 50.31, "cnt": 32}, "MoE_L3_bwd":{"total": 450.55, "avg": 14.08, "max": 12.89, "min": 15.70, "cnt": 32}, "MoE_L2_bwd":{"total": 309.68, "avg": 9.68, "max": 8.83, "min": 10.46, "cnt": 32}, "MoE_L1_bwd":{"total": 286.10, "avg": 8.94, "max": 8.58, "min": 9.27, "cnt": 32}, "MoE_L0_bwd":{"total": 278.15, "avg": 8.69, "max": 8.11, "min": 9.15, "cnt": 32}, "backward-send-forward-recv":{"total": 1707.17, "avg": 58.87, "max": 1.90, "min": 431.33, "cnt": 29}, "backward-send":{"total": 2.84, "avg": 0.95, "max": 0.91, "min": 1.01, "cnt": 3}, "backward-recv":{"total": 294.29, "avg": 147.14, "max": 76.05, "min": 218.24, "cnt": 2}, "backward-params-all-reduce":{"total": 484.87, "avg": 484.87, "max": 484.87, "min": 484.87, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.06, "avg": 0.06, "max": 0.06, "min": 0.06, "cnt": 1}, "optimizer":{"total": 235.28, "avg": 235.28, "max": 235.28, "min": 235.28, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 195.23, "avg": 195.23, "max": 195.23, "min": 195.23, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.52, "avg": 3.52, "max": 3.52, "min": 3.52, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 79, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 63.74, "avg": 21.25, "max": 1.47, "min": 60.74, "cnt": 3}, "forward-compute":{"total": 1856.82, "avg": 58.03, "max": 49.07, "min": 67.07, "cnt": 32}, "fwd-compute":{"total": 1853.31, "avg": 57.92, "max": 49.01, "min": 66.94, "cnt": 32}, "batch-generator":{"total": 43.20, "avg": 1.35, "max": 0.66, "min": 2.09, "cnt": 32}, "fwd-embedding":{"total": 0.72, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1796.33, "avg": 56.14, "max": 48.04, "min": 64.73, "cnt": 32}, "fwd-layernorm":{"total": 10.91, "avg": 0.09, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 113.13, "avg": 0.88, "max": 0.74, "min": 1.56, "cnt": 128}, "fwd-misc":{"total": 22.94, "avg": 0.18, "max": 0.11, "min": 0.55, "cnt": 128}, "fwd-MLP":{"total": 1626.84, "avg": 12.71, "max": 10.51, "min": 22.58, "cnt": 128}, "MoE_L0_fwd":{"total": 479.67, "avg": 14.99, "max": 10.44, "min": 22.43, "cnt": 32}, "MoEMLP":{"total": 1609.06, "avg": 12.57, "max": 10.41, "min": 22.35, "cnt": 128}, "MoE_L1_fwd":{"total": 378.31, "avg": 11.82, "max": 10.46, "min": 13.21, "cnt": 32}, "MoE_L2_fwd":{"total": 360.70, "avg": 11.27, "max": 10.62, "min": 12.08, "cnt": 32}, "MoE_L3_fwd":{"total": 396.88, "avg": 12.40, "max": 11.45, "min": 13.69, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 10.29, "avg": 5.15, "max": 0.99, "min": 9.30, "cnt": 2}, "forward-send-backward-recv":{"total": 1104.50, "avg": 36.82, "max": 0.87, "min": 374.35, "cnt": 30}, "backward-compute":{"total": 1561.86, "avg": 48.81, "max": 45.98, "min": 51.99, "cnt": 32}, "MoE_L3_bwd":{"total": 447.80, "avg": 13.99, "max": 12.33, "min": 16.59, "cnt": 32}, "MoE_L2_bwd":{"total": 324.15, "avg": 10.13, "max": 9.11, "min": 12.60, "cnt": 32}, "MoE_L1_bwd":{"total": 288.00, "avg": 9.00, "max": 8.63, "min": 9.48, "cnt": 32}, "MoE_L0_bwd":{"total": 288.22, "avg": 9.01, "max": 8.62, "min": 9.51, "cnt": 32}, "backward-send-forward-recv":{"total": 1994.05, "avg": 68.76, "max": 2.19, "min": 256.82, "cnt": 29}, "backward-send":{"total": 3.35, "avg": 1.12, "max": 1.07, "min": 1.16, "cnt": 3}, "backward-recv":{"total": 305.80, "avg": 152.90, "max": 79.66, "min": 226.14, "cnt": 2}, "backward-params-all-reduce":{"total": 489.99, "avg": 489.99, "max": 489.99, "min": 489.99, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 304.23, "avg": 304.23, "max": 304.23, "min": 304.23, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.40, "avg": 3.40, "max": 3.40, "min": 3.40, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 264.48, "avg": 264.48, "max": 264.48, "min": 264.48, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 80, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.10, "avg": 0.10, "max": 0.10, "min": 0.10, "cnt": 1}, "forward-recv":{"total": 174.92, "avg": 58.31, "max": 0.74, "min": 173.18, "cnt": 3}, "forward-compute":{"total": 1970.32, "avg": 61.57, "max": 49.78, "min": 199.10, "cnt": 32}, "fwd-compute":{"total": 1967.02, "avg": 61.47, "max": 49.70, "min": 199.00, "cnt": 32}, "batch-generator":{"total": 45.26, "avg": 1.41, "max": 0.66, "min": 2.65, "cnt": 32}, "fwd-embedding":{"total": 0.67, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1907.89, "avg": 59.62, "max": 48.35, "min": 197.72, "cnt": 32}, "fwd-layernorm":{"total": 10.88, "avg": 0.08, "max": 0.06, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 112.73, "avg": 0.88, "max": 0.74, "min": 2.92, "cnt": 128}, "fwd-misc":{"total": 23.27, "avg": 0.18, "max": 0.11, "min": 0.54, "cnt": 128}, "fwd-MLP":{"total": 1738.07, "avg": 13.58, "max": 10.71, "min": 142.35, "cnt": 128}, "MoE_L0_fwd":{"total": 608.19, "avg": 19.01, "max": 10.61, "min": 142.26, "cnt": 32}, "MoEMLP":{"total": 1719.87, "avg": 13.44, "max": 10.55, "min": 142.21, "cnt": 128}, "MoE_L1_fwd":{"total": 395.32, "avg": 12.35, "max": 10.64, "min": 27.71, "cnt": 32}, "MoE_L2_fwd":{"total": 361.92, "avg": 11.31, "max": 10.70, "min": 13.70, "cnt": 32}, "MoE_L3_fwd":{"total": 361.05, "avg": 11.28, "max": 10.67, "min": 11.93, "cnt": 32}, "fwd-pooler":{"total": 0.36, "avg": 0.01, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-loss-func":{"total": 0.63, "avg": 0.02, "max": 0.02, "min": 0.06, "cnt": 32}, "forward-send":{"total": 5.92, "avg": 2.96, "max": 0.48, "min": 5.44, "cnt": 2}, "forward-send-backward-recv":{"total": 653.95, "avg": 21.80, "max": 0.95, "min": 512.50, "cnt": 30}, "backward-compute":{"total": 1482.92, "avg": 46.34, "max": 44.19, "min": 48.19, "cnt": 32}, "MoE_L3_bwd":{"total": 387.69, "avg": 12.12, "max": 10.20, "min": 13.82, "cnt": 32}, "MoE_L2_bwd":{"total": 326.43, "avg": 10.20, "max": 8.77, "min": 11.08, "cnt": 32}, "MoE_L1_bwd":{"total": 288.49, "avg": 9.02, "max": 8.56, "min": 9.65, "cnt": 32}, "MoE_L0_bwd":{"total": 250.51, "avg": 7.83, "max": 7.26, "min": 9.11, "cnt": 32}, "backward-send-forward-recv":{"total": 2393.78, "avg": 82.54, "max": 1.13, "min": 354.80, "cnt": 29}, "backward-send":{"total": 3.27, "avg": 1.09, "max": 0.93, "min": 1.18, "cnt": 3}, "backward-recv":{"total": 127.02, "avg": 63.51, "max": 61.04, "min": 65.98, "cnt": 2}, "backward-params-all-reduce":{"total": 487.47, "avg": 487.47, "max": 487.47, "min": 487.47, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 229.54, "avg": 229.54, "max": 229.54, "min": 229.54, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 189.52, "avg": 189.52, "max": 189.52, "min": 189.52, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.49, "avg": 3.49, "max": 3.49, "min": 3.49, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 81, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 69.82, "avg": 23.27, "max": 0.86, "min": 67.53, "cnt": 3}, "forward-compute":{"total": 1764.98, "avg": 55.16, "max": 49.10, "min": 61.02, "cnt": 32}, "fwd-compute":{"total": 1761.89, "avg": 55.06, "max": 49.02, "min": 60.93, "cnt": 32}, "batch-generator":{"total": 52.56, "avg": 1.64, "max": 0.62, "min": 4.40, "cnt": 32}, "fwd-embedding":{"total": 0.67, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1696.90, "avg": 53.03, "max": 47.41, "min": 59.53, "cnt": 32}, "fwd-layernorm":{"total": 10.15, "avg": 0.08, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 109.42, "avg": 0.85, "max": 0.74, "min": 1.56, "cnt": 128}, "fwd-misc":{"total": 21.41, "avg": 0.17, "max": 0.12, "min": 0.38, "cnt": 128}, "fwd-MLP":{"total": 1533.91, "avg": 11.98, "max": 10.07, "min": 21.46, "cnt": 128}, "MoE_L0_fwd":{"total": 447.48, "avg": 13.98, "max": 10.23, "min": 21.38, "cnt": 32}, "MoEMLP":{"total": 1516.62, "avg": 11.85, "max": 9.96, "min": 21.33, "cnt": 128}, "MoE_L1_fwd":{"total": 377.04, "avg": 11.78, "max": 10.39, "min": 14.08, "cnt": 32}, "MoE_L2_fwd":{"total": 352.74, "avg": 11.02, "max": 10.56, "min": 12.65, "cnt": 32}, "MoE_L3_fwd":{"total": 345.64, "avg": 10.80, "max": 10.00, "min": 12.43, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.62, "avg": 0.81, "max": 0.69, "min": 0.93, "cnt": 2}, "forward-send-backward-recv":{"total": 175.46, "avg": 5.85, "max": 0.96, "min": 101.85, "cnt": 30}, "backward-compute":{"total": 1481.00, "avg": 46.28, "max": 43.95, "min": 47.90, "cnt": 32}, "MoE_L3_bwd":{"total": 374.32, "avg": 11.70, "max": 10.32, "min": 13.20, "cnt": 32}, "MoE_L2_bwd":{"total": 334.29, "avg": 10.45, "max": 9.75, "min": 11.62, "cnt": 32}, "MoE_L1_bwd":{"total": 290.74, "avg": 9.09, "max": 8.66, "min": 9.47, "cnt": 32}, "MoE_L0_bwd":{"total": 263.65, "avg": 8.24, "max": 7.76, "min": 8.69, "cnt": 32}, "backward-send-forward-recv":{"total": 5482.09, "avg": 189.04, "max": 2.17, "min": 1136.89, "cnt": 29}, "backward-send":{"total": 3.24, "avg": 1.08, "max": 0.74, "min": 1.53, "cnt": 3}, "backward-recv":{"total": 124.28, "avg": 62.14, "max": 61.20, "min": 63.08, "cnt": 2}, "backward-params-all-reduce":{"total": 489.82, "avg": 489.82, "max": 489.82, "min": 489.82, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 235.94, "avg": 235.94, "max": 235.94, "min": 235.94, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.41, "avg": 3.41, "max": 3.41, "min": 3.41, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 195.50, "avg": 195.50, "max": 195.50, "min": 195.50, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 82, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 68.34, "avg": 22.78, "max": 1.61, "min": 65.08, "cnt": 3}, "forward-compute":{"total": 1809.07, "avg": 56.53, "max": 48.80, "min": 66.50, "cnt": 32}, "fwd-compute":{"total": 1806.12, "avg": 56.44, "max": 48.74, "min": 66.41, "cnt": 32}, "batch-generator":{"total": 50.62, "avg": 1.58, "max": 0.69, "min": 3.98, "cnt": 32}, "fwd-embedding":{"total": 0.57, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1743.54, "avg": 54.49, "max": 47.72, "min": 62.59, "cnt": 32}, "fwd-layernorm":{"total": 9.83, "avg": 0.08, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 106.77, "avg": 0.83, "max": 0.74, "min": 1.54, "cnt": 128}, "fwd-misc":{"total": 20.57, "avg": 0.16, "max": 0.12, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1585.60, "avg": 12.39, "max": 10.37, "min": 21.62, "cnt": 128}, "MoE_L0_fwd":{"total": 470.44, "avg": 14.70, "max": 10.29, "min": 21.55, "cnt": 32}, "MoEMLP":{"total": 1569.22, "avg": 12.26, "max": 10.25, "min": 21.51, "cnt": 128}, "MoE_L1_fwd":{"total": 398.07, "avg": 12.44, "max": 10.75, "min": 14.43, "cnt": 32}, "MoE_L2_fwd":{"total": 353.72, "avg": 11.05, "max": 10.47, "min": 13.81, "cnt": 32}, "MoE_L3_fwd":{"total": 352.98, "avg": 11.03, "max": 10.52, "min": 11.63, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.55, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.83, "avg": 0.91, "max": 0.88, "min": 0.94, "cnt": 2}, "forward-send-backward-recv":{"total": 182.25, "avg": 6.08, "max": 1.91, "min": 106.71, "cnt": 30}, "backward-compute":{"total": 1485.92, "avg": 46.43, "max": 44.42, "min": 48.03, "cnt": 32}, "MoE_L3_bwd":{"total": 374.95, "avg": 11.72, "max": 10.58, "min": 12.22, "cnt": 32}, "MoE_L2_bwd":{"total": 323.92, "avg": 10.12, "max": 8.98, "min": 11.09, "cnt": 32}, "MoE_L1_bwd":{"total": 298.85, "avg": 9.34, "max": 8.75, "min": 10.03, "cnt": 32}, "MoE_L0_bwd":{"total": 269.81, "avg": 8.43, "max": 7.88, "min": 8.93, "cnt": 32}, "backward-send-forward-recv":{"total": 12632.85, "avg": 435.62, "max": 1.79, "min": 2264.17, "cnt": 29}, "backward-send":{"total": 2.85, "avg": 0.95, "max": 0.79, "min": 1.07, "cnt": 3}, "backward-recv":{"total": 449.55, "avg": 224.77, "max": 97.63, "min": 351.92, "cnt": 2}, "backward-params-all-reduce":{"total": 488.91, "avg": 488.91, "max": 488.91, "min": 488.91, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 231.31, "avg": 231.31, "max": 231.31, "min": 231.31, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.48, "avg": 3.48, "max": 3.48, "min": 3.48, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 191.36, "avg": 191.36, "max": 191.36, "min": 191.36, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.49, "avg": 3.49, "max": 3.49, "min": 3.49, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 83, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 83.02, "avg": 27.67, "max": 1.29, "min": 80.12, "cnt": 3}, "forward-compute":{"total": 1837.15, "avg": 57.41, "max": 48.44, "min": 68.39, "cnt": 32}, "fwd-compute":{"total": 1833.84, "avg": 57.31, "max": 48.36, "min": 68.30, "cnt": 32}, "batch-generator":{"total": 63.62, "avg": 1.99, "max": 0.70, "min": 5.74, "cnt": 32}, "fwd-embedding":{"total": 0.68, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1757.38, "avg": 54.92, "max": 47.33, "min": 65.10, "cnt": 32}, "fwd-layernorm":{"total": 10.56, "avg": 0.08, "max": 0.06, "min": 0.29, "cnt": 128}, "fwd-attn":{"total": 111.74, "avg": 0.87, "max": 0.74, "min": 2.27, "cnt": 128}, "fwd-misc":{"total": 22.00, "avg": 0.17, "max": 0.12, "min": 0.47, "cnt": 128}, "fwd-MLP":{"total": 1590.86, "avg": 12.43, "max": 10.13, "min": 19.26, "cnt": 128}, "MoE_L0_fwd":{"total": 476.05, "avg": 14.88, "max": 10.06, "min": 19.15, "cnt": 32}, "MoEMLP":{"total": 1573.61, "avg": 12.29, "max": 10.02, "min": 19.10, "cnt": 128}, "MoE_L1_fwd":{"total": 390.85, "avg": 12.21, "max": 10.78, "min": 18.68, "cnt": 32}, "MoE_L2_fwd":{"total": 345.18, "avg": 10.79, "max": 10.31, "min": 13.11, "cnt": 32}, "MoE_L3_fwd":{"total": 367.82, "avg": 11.49, "max": 10.74, "min": 13.66, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 7.16, "avg": 3.58, "max": 0.85, "min": 6.32, "cnt": 2}, "forward-send-backward-recv":{"total": 173.76, "avg": 5.79, "max": 1.65, "min": 98.76, "cnt": 30}, "backward-compute":{"total": 1483.38, "avg": 46.36, "max": 43.64, "min": 49.80, "cnt": 32}, "MoE_L3_bwd":{"total": 393.49, "avg": 12.30, "max": 11.26, "min": 12.89, "cnt": 32}, "MoE_L2_bwd":{"total": 315.01, "avg": 9.84, "max": 8.87, "min": 10.84, "cnt": 32}, "MoE_L1_bwd":{"total": 292.71, "avg": 9.15, "max": 8.72, "min": 10.98, "cnt": 32}, "MoE_L0_bwd":{"total": 265.03, "avg": 8.28, "max": 7.32, "min": 10.60, "cnt": 32}, "backward-send-forward-recv":{"total": 13063.79, "avg": 450.48, "max": 1.97, "min": 2464.46, "cnt": 29}, "backward-send":{"total": 3.17, "avg": 1.06, "max": 1.04, "min": 1.07, "cnt": 3}, "backward-recv":{"total": 138.30, "avg": 69.15, "max": 63.48, "min": 74.82, "cnt": 2}, "backward-params-all-reduce":{"total": 488.17, "avg": 488.17, "max": 488.17, "min": 488.17, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 233.08, "avg": 233.08, "max": 233.08, "min": 233.08, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.40, "avg": 3.40, "max": 3.40, "min": 3.40, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 192.87, "avg": 192.87, "max": 192.87, "min": 192.87, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.67, "avg": 3.67, "max": 3.67, "min": 3.67, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 84, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 71.91, "avg": 23.97, "max": 1.68, "min": 68.50, "cnt": 3}, "forward-compute":{"total": 1778.01, "avg": 55.56, "max": 49.12, "min": 65.71, "cnt": 32}, "fwd-compute":{"total": 1775.18, "avg": 55.47, "max": 49.05, "min": 65.61, "cnt": 32}, "batch-generator":{"total": 47.66, "avg": 1.49, "max": 0.70, "min": 3.53, "cnt": 32}, "fwd-embedding":{"total": 0.52, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1715.54, "avg": 53.61, "max": 47.70, "min": 63.94, "cnt": 32}, "fwd-layernorm":{"total": 9.70, "avg": 0.08, "max": 0.06, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 106.85, "avg": 0.83, "max": 0.74, "min": 2.14, "cnt": 128}, "fwd-misc":{"total": 20.69, "avg": 0.16, "max": 0.12, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1557.38, "avg": 12.17, "max": 10.01, "min": 20.82, "cnt": 128}, "MoE_L0_fwd":{"total": 445.78, "avg": 13.93, "max": 10.34, "min": 20.73, "cnt": 32}, "MoEMLP":{"total": 1541.10, "avg": 12.04, "max": 9.90, "min": 20.69, "cnt": 128}, "MoE_L1_fwd":{"total": 392.65, "avg": 12.27, "max": 10.32, "min": 17.96, "cnt": 32}, "MoE_L2_fwd":{"total": 363.34, "avg": 11.35, "max": 10.81, "min": 13.07, "cnt": 32}, "MoE_L3_fwd":{"total": 345.35, "avg": 10.79, "max": 9.94, "min": 14.97, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.72, "avg": 0.86, "max": 0.85, "min": 0.87, "cnt": 2}, "forward-send-backward-recv":{"total": 183.59, "avg": 6.12, "max": 1.38, "min": 104.58, "cnt": 30}, "backward-compute":{"total": 1495.64, "avg": 46.74, "max": 44.27, "min": 52.85, "cnt": 32}, "MoE_L3_bwd":{"total": 378.60, "avg": 11.83, "max": 10.94, "min": 14.41, "cnt": 32}, "MoE_L2_bwd":{"total": 337.24, "avg": 10.54, "max": 9.21, "min": 11.51, "cnt": 32}, "MoE_L1_bwd":{"total": 296.22, "avg": 9.26, "max": 8.67, "min": 10.83, "cnt": 32}, "MoE_L0_bwd":{"total": 264.73, "avg": 8.27, "max": 7.45, "min": 9.88, "cnt": 32}, "backward-send-forward-recv":{"total": 8199.24, "avg": 282.73, "max": 2.33, "min": 1130.20, "cnt": 29}, "backward-send":{"total": 2.26, "avg": 0.75, "max": 0.54, "min": 1.15, "cnt": 3}, "backward-recv":{"total": 331.30, "avg": 165.65, "max": 78.65, "min": 252.65, "cnt": 2}, "backward-params-all-reduce":{"total": 485.78, "avg": 485.78, "max": 485.78, "min": 485.78, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 234.85, "avg": 234.85, "max": 234.85, "min": 234.85, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 194.70, "avg": 194.70, "max": 194.70, "min": 194.70, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.85, "avg": 3.85, "max": 3.85, "min": 3.85, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 85, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 80.00, "avg": 26.67, "max": 1.56, "min": 76.65, "cnt": 3}, "forward-compute":{"total": 1949.55, "avg": 60.92, "max": 49.27, "min": 222.13, "cnt": 32}, "fwd-compute":{"total": 1946.73, "avg": 60.84, "max": 49.20, "min": 222.02, "cnt": 32}, "batch-generator":{"total": 34.94, "avg": 1.09, "max": 0.68, "min": 1.79, "cnt": 32}, "fwd-embedding":{"total": 0.49, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1900.13, "avg": 59.38, "max": 48.21, "min": 220.45, "cnt": 32}, "fwd-layernorm":{"total": 9.18, "avg": 0.07, "max": 0.06, "min": 0.18, "cnt": 128}, "fwd-attn":{"total": 104.42, "avg": 0.82, "max": 0.74, "min": 1.61, "cnt": 128}, "fwd-misc":{"total": 20.24, "avg": 0.16, "max": 0.11, "min": 0.48, "cnt": 128}, "fwd-MLP":{"total": 1745.99, "avg": 13.64, "max": 10.05, "min": 180.97, "cnt": 128}, "MoE_L0_fwd":{"total": 628.65, "avg": 19.65, "max": 10.46, "min": 180.88, "cnt": 32}, "MoEMLP":{"total": 1729.80, "avg": 13.51, "max": 9.94, "min": 180.83, "cnt": 128}, "MoE_L1_fwd":{"total": 387.55, "avg": 12.11, "max": 10.94, "min": 15.97, "cnt": 32}, "MoE_L2_fwd":{"total": 375.85, "avg": 11.75, "max": 10.99, "min": 15.82, "cnt": 32}, "MoE_L3_fwd":{"total": 343.66, "avg": 10.74, "max": 9.98, "min": 12.05, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.50, "avg": 0.75, "max": 0.58, "min": 0.93, "cnt": 2}, "forward-send-backward-recv":{"total": 170.70, "avg": 5.69, "max": 1.39, "min": 101.40, "cnt": 30}, "backward-compute":{"total": 1493.48, "avg": 46.67, "max": 44.18, "min": 49.34, "cnt": 32}, "MoE_L3_bwd":{"total": 361.24, "avg": 11.29, "max": 10.26, "min": 12.62, "cnt": 32}, "MoE_L2_bwd":{"total": 334.40, "avg": 10.45, "max": 9.80, "min": 11.30, "cnt": 32}, "MoE_L1_bwd":{"total": 301.12, "avg": 9.41, "max": 8.81, "min": 11.41, "cnt": 32}, "MoE_L0_bwd":{"total": 276.92, "avg": 8.65, "max": 8.00, "min": 9.07, "cnt": 32}, "backward-send-forward-recv":{"total": 2949.25, "avg": 101.70, "max": 2.10, "min": 313.43, "cnt": 29}, "backward-send":{"total": 2.74, "avg": 0.91, "max": 0.85, "min": 0.98, "cnt": 3}, "backward-recv":{"total": 136.50, "avg": 68.25, "max": 67.53, "min": 68.97, "cnt": 2}, "backward-params-all-reduce":{"total": 487.18, "avg": 487.18, "max": 487.18, "min": 487.18, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 232.21, "avg": 232.21, "max": 232.21, "min": 232.21, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.40, "avg": 3.40, "max": 3.40, "min": 3.40, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 191.95, "avg": 191.95, "max": 191.95, "min": 191.95, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.91, "avg": 3.91, "max": 3.91, "min": 3.91, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 86, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 81.29, "avg": 27.10, "max": 1.58, "min": 70.77, "cnt": 3}, "forward-compute":{"total": 1819.82, "avg": 56.87, "max": 49.50, "min": 66.23, "cnt": 32}, "fwd-compute":{"total": 1816.68, "avg": 56.77, "max": 49.43, "min": 66.05, "cnt": 32}, "batch-generator":{"total": 53.64, "avg": 1.68, "max": 0.66, "min": 7.66, "cnt": 32}, "fwd-embedding":{"total": 0.57, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1750.14, "avg": 54.69, "max": 48.39, "min": 63.81, "cnt": 32}, "fwd-layernorm":{"total": 10.17, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 107.35, "avg": 0.84, "max": 0.74, "min": 2.12, "cnt": 128}, "fwd-misc":{"total": 21.75, "avg": 0.17, "max": 0.12, "min": 0.49, "cnt": 128}, "fwd-MLP":{"total": 1588.78, "avg": 12.41, "max": 10.14, "min": 22.28, "cnt": 128}, "MoE_L0_fwd":{"total": 460.13, "avg": 14.38, "max": 10.42, "min": 22.11, "cnt": 32}, "MoEMLP":{"total": 1571.54, "avg": 12.28, "max": 10.04, "min": 22.03, "cnt": 128}, "MoE_L1_fwd":{"total": 384.81, "avg": 12.03, "max": 10.67, "min": 14.01, "cnt": 32}, "MoE_L2_fwd":{"total": 385.47, "avg": 12.05, "max": 11.58, "min": 14.76, "cnt": 32}, "MoE_L3_fwd":{"total": 347.36, "avg": 10.85, "max": 10.08, "min": 12.52, "cnt": 32}, "fwd-pooler":{"total": 0.37, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.62, "avg": 0.02, "max": 0.02, "min": 0.05, "cnt": 32}, "forward-send":{"total": 1.81, "avg": 0.90, "max": 0.87, "min": 0.94, "cnt": 2}, "forward-send-backward-recv":{"total": 162.41, "avg": 5.41, "max": 1.67, "min": 106.09, "cnt": 30}, "backward-compute":{"total": 1506.47, "avg": 47.08, "max": 45.24, "min": 48.52, "cnt": 32}, "MoE_L3_bwd":{"total": 355.62, "avg": 11.11, "max": 10.27, "min": 11.78, "cnt": 32}, "MoE_L2_bwd":{"total": 360.07, "avg": 11.25, "max": 10.35, "min": 12.81, "cnt": 32}, "MoE_L1_bwd":{"total": 300.33, "avg": 9.39, "max": 8.93, "min": 10.44, "cnt": 32}, "MoE_L0_bwd":{"total": 269.87, "avg": 8.43, "max": 7.68, "min": 8.97, "cnt": 32}, "backward-send-forward-recv":{"total": 4136.07, "avg": 142.62, "max": 2.27, "min": 501.09, "cnt": 29}, "backward-send":{"total": 3.36, "avg": 1.12, "max": 1.06, "min": 1.17, "cnt": 3}, "backward-recv":{"total": 109.99, "avg": 55.00, "max": 48.40, "min": 61.59, "cnt": 2}, "backward-params-all-reduce":{"total": 489.90, "avg": 489.90, "max": 489.90, "min": 489.90, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 233.44, "avg": 233.44, "max": 233.44, "min": 233.44, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.47, "avg": 3.47, "max": 3.47, "min": 3.47, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 193.32, "avg": 193.32, "max": 193.32, "min": 193.32, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.54, "avg": 3.54, "max": 3.54, "min": 3.54, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}}}
{"type":"time", "iteration": 87, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 73.02, "avg": 24.34, "max": 1.36, "min": 70.20, "cnt": 3}, "forward-compute":{"total": 1874.63, "avg": 58.58, "max": 50.20, "min": 67.05, "cnt": 32}, "fwd-compute":{"total": 1871.30, "avg": 58.48, "max": 50.10, "min": 66.88, "cnt": 32}, "batch-generator":{"total": 44.18, "avg": 1.38, "max": 0.70, "min": 2.89, "cnt": 32}, "fwd-embedding":{"total": 0.69, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1814.24, "avg": 56.70, "max": 49.05, "min": 63.46, "cnt": 32}, "fwd-layernorm":{"total": 10.63, "avg": 0.08, "max": 0.06, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 113.15, "avg": 0.88, "max": 0.74, "min": 1.47, "cnt": 128}, "fwd-misc":{"total": 23.03, "avg": 0.18, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1644.88, "avg": 12.85, "max": 10.41, "min": 18.30, "cnt": 128}, "MoE_L0_fwd":{"total": 465.17, "avg": 14.54, "max": 10.34, "min": 18.21, "cnt": 32}, "MoEMLP":{"total": 1627.17, "avg": 12.71, "max": 10.30, "min": 18.16, "cnt": 128}, "MoE_L1_fwd":{"total": 397.25, "avg": 12.41, "max": 11.20, "min": 14.45, "cnt": 32}, "MoE_L2_fwd":{"total": 394.89, "avg": 12.34, "max": 11.37, "min": 16.98, "cnt": 32}, "MoE_L3_fwd":{"total": 376.38, "avg": 11.76, "max": 10.68, "min": 15.21, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.91, "avg": 0.95, "max": 0.91, "min": 0.99, "cnt": 2}, "forward-send-backward-recv":{"total": 177.01, "avg": 5.90, "max": 1.63, "min": 103.66, "cnt": 30}, "backward-compute":{"total": 1514.46, "avg": 47.33, "max": 45.56, "min": 50.09, "cnt": 32}, "MoE_L3_bwd":{"total": 378.88, "avg": 11.84, "max": 11.09, "min": 13.44, "cnt": 32}, "MoE_L2_bwd":{"total": 348.96, "avg": 10.90, "max": 9.32, "min": 11.66, "cnt": 32}, "MoE_L1_bwd":{"total": 294.81, "avg": 9.21, "max": 8.71, "min": 9.61, "cnt": 32}, "MoE_L0_bwd":{"total": 270.02, "avg": 8.44, "max": 7.98, "min": 9.04, "cnt": 32}, "backward-send-forward-recv":{"total": 2638.74, "avg": 90.99, "max": 2.22, "min": 314.44, "cnt": 29}, "backward-send":{"total": 3.01, "avg": 1.00, "max": 0.88, "min": 1.15, "cnt": 3}, "backward-recv":{"total": 137.23, "avg": 68.62, "max": 67.40, "min": 69.83, "cnt": 2}, "backward-params-all-reduce":{"total": 487.14, "avg": 487.14, "max": 487.14, "min": 487.14, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 232.54, "avg": 232.54, "max": 232.54, "min": 232.54, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 192.40, "avg": 192.40, "max": 192.40, "min": 192.40, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.72, "avg": 3.72, "max": 3.72, "min": 3.72, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 88, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 72.29, "avg": 24.10, "max": 1.49, "min": 67.35, "cnt": 3}, "forward-compute":{"total": 1883.90, "avg": 58.87, "max": 50.05, "min": 65.79, "cnt": 32}, "fwd-compute":{"total": 1880.88, "avg": 58.78, "max": 49.98, "min": 65.71, "cnt": 32}, "batch-generator":{"total": 46.12, "avg": 1.44, "max": 0.69, "min": 3.06, "cnt": 32}, "fwd-embedding":{"total": 0.56, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1821.93, "avg": 56.94, "max": 48.99, "min": 63.03, "cnt": 32}, "fwd-layernorm":{"total": 9.79, "avg": 0.08, "max": 0.06, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 106.13, "avg": 0.83, "max": 0.74, "min": 1.70, "cnt": 128}, "fwd-misc":{"total": 20.98, "avg": 0.16, "max": 0.12, "min": 0.40, "cnt": 128}, "fwd-MLP":{"total": 1664.19, "avg": 13.00, "max": 10.46, "min": 18.90, "cnt": 128}, "MoE_L0_fwd":{"total": 489.36, "avg": 15.29, "max": 10.39, "min": 18.83, "cnt": 32}, "MoEMLP":{"total": 1647.47, "avg": 12.87, "max": 10.35, "min": 18.78, "cnt": 128}, "MoE_L1_fwd":{"total": 395.23, "avg": 12.35, "max": 10.67, "min": 17.00, "cnt": 32}, "MoE_L2_fwd":{"total": 392.64, "avg": 12.27, "max": 11.64, "min": 15.16, "cnt": 32}, "MoE_L3_fwd":{"total": 376.37, "avg": 11.76, "max": 10.94, "min": 13.08, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.58, "avg": 0.79, "max": 0.78, "min": 0.80, "cnt": 2}, "forward-send-backward-recv":{"total": 415.90, "avg": 13.86, "max": 1.22, "min": 158.17, "cnt": 30}, "backward-compute":{"total": 1532.96, "avg": 47.90, "max": 45.70, "min": 52.56, "cnt": 32}, "MoE_L3_bwd":{"total": 381.40, "avg": 11.92, "max": 11.32, "min": 14.50, "cnt": 32}, "MoE_L2_bwd":{"total": 360.71, "avg": 11.27, "max": 10.32, "min": 14.79, "cnt": 32}, "MoE_L1_bwd":{"total": 291.91, "avg": 9.12, "max": 8.02, "min": 10.63, "cnt": 32}, "MoE_L0_bwd":{"total": 280.28, "avg": 8.76, "max": 8.18, "min": 12.08, "cnt": 32}, "backward-send-forward-recv":{"total": 3573.29, "avg": 123.22, "max": 1.92, "min": 393.12, "cnt": 29}, "backward-send":{"total": 2.92, "avg": 0.97, "max": 0.74, "min": 1.15, "cnt": 3}, "backward-recv":{"total": 287.42, "avg": 143.71, "max": 61.66, "min": 225.75, "cnt": 2}, "backward-params-all-reduce":{"total": 487.85, "avg": 487.85, "max": 487.85, "min": 487.85, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 230.91, "avg": 230.91, "max": 230.91, "min": 230.91, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.40, "avg": 3.40, "max": 3.40, "min": 3.40, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 191.07, "avg": 191.07, "max": 191.07, "min": 191.07, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.48, "avg": 3.48, "max": 3.48, "min": 3.48, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 89, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 82.28, "avg": 27.43, "max": 1.36, "min": 75.64, "cnt": 3}, "forward-compute":{"total": 1823.29, "avg": 56.98, "max": 50.08, "min": 63.45, "cnt": 32}, "fwd-compute":{"total": 1820.21, "avg": 56.88, "max": 50.01, "min": 63.36, "cnt": 32}, "batch-generator":{"total": 43.03, "avg": 1.34, "max": 0.66, "min": 2.79, "cnt": 32}, "fwd-embedding":{"total": 0.63, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1764.64, "avg": 55.14, "max": 49.05, "min": 61.82, "cnt": 32}, "fwd-layernorm":{"total": 10.20, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 110.64, "avg": 0.86, "max": 0.74, "min": 1.94, "cnt": 128}, "fwd-misc":{"total": 22.14, "avg": 0.17, "max": 0.11, "min": 0.43, "cnt": 128}, "fwd-MLP":{"total": 1599.54, "avg": 12.50, "max": 10.77, "min": 21.13, "cnt": 128}, "MoE_L0_fwd":{"total": 459.28, "avg": 14.35, "max": 10.70, "min": 21.06, "cnt": 32}, "MoEMLP":{"total": 1582.17, "avg": 12.36, "max": 10.66, "min": 21.02, "cnt": 128}, "MoE_L1_fwd":{"total": 378.41, "avg": 11.83, "max": 10.81, "min": 13.89, "cnt": 32}, "MoE_L2_fwd":{"total": 386.45, "avg": 12.08, "max": 11.13, "min": 16.97, "cnt": 32}, "MoE_L3_fwd":{"total": 364.31, "avg": 11.38, "max": 10.75, "min": 12.50, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.56, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.95, "avg": 0.98, "max": 0.91, "min": 1.04, "cnt": 2}, "forward-send-backward-recv":{"total": 161.58, "avg": 5.39, "max": 1.44, "min": 97.11, "cnt": 30}, "backward-compute":{"total": 1534.35, "avg": 47.95, "max": 46.18, "min": 52.79, "cnt": 32}, "MoE_L3_bwd":{"total": 387.15, "avg": 12.10, "max": 10.25, "min": 15.16, "cnt": 32}, "MoE_L2_bwd":{"total": 351.57, "avg": 10.99, "max": 9.68, "min": 12.84, "cnt": 32}, "MoE_L1_bwd":{"total": 302.25, "avg": 9.45, "max": 8.88, "min": 12.12, "cnt": 32}, "MoE_L0_bwd":{"total": 279.55, "avg": 8.74, "max": 8.32, "min": 9.41, "cnt": 32}, "backward-send-forward-recv":{"total": 4596.47, "avg": 158.50, "max": 2.00, "min": 579.57, "cnt": 29}, "backward-send":{"total": 2.29, "avg": 0.76, "max": 0.57, "min": 0.95, "cnt": 3}, "backward-recv":{"total": 118.55, "avg": 59.28, "max": 55.33, "min": 63.22, "cnt": 2}, "backward-params-all-reduce":{"total": 484.73, "avg": 484.73, "max": 484.73, "min": 484.73, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 244.54, "avg": 244.54, "max": 244.54, "min": 244.54, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 198.44, "avg": 198.44, "max": 198.44, "min": 198.44, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.88, "avg": 3.88, "max": 3.88, "min": 3.88, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 90, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 76.47, "avg": 25.49, "max": 0.70, "min": 74.43, "cnt": 3}, "forward-compute":{"total": 1898.42, "avg": 59.33, "max": 49.31, "min": 173.91, "cnt": 32}, "fwd-compute":{"total": 1895.17, "avg": 59.22, "max": 49.24, "min": 173.82, "cnt": 32}, "batch-generator":{"total": 44.68, "avg": 1.40, "max": 0.74, "min": 3.08, "cnt": 32}, "fwd-embedding":{"total": 0.61, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1837.77, "avg": 57.43, "max": 47.35, "min": 172.54, "cnt": 32}, "fwd-layernorm":{"total": 9.94, "avg": 0.08, "max": 0.06, "min": 0.23, "cnt": 128}, "fwd-attn":{"total": 109.38, "avg": 0.85, "max": 0.74, "min": 2.32, "cnt": 128}, "fwd-misc":{"total": 21.65, "avg": 0.17, "max": 0.12, "min": 0.45, "cnt": 128}, "fwd-MLP":{"total": 1674.93, "avg": 13.09, "max": 9.24, "min": 130.82, "cnt": 128}, "MoE_L0_fwd":{"total": 466.25, "avg": 14.57, "max": 10.44, "min": 17.88, "cnt": 32}, "MoEMLP":{"total": 1657.61, "avg": 12.95, "max": 9.13, "min": 130.69, "cnt": 128}, "MoE_L1_fwd":{"total": 385.55, "avg": 12.05, "max": 10.64, "min": 13.56, "cnt": 32}, "MoE_L2_fwd":{"total": 370.46, "avg": 11.58, "max": 11.08, "min": 12.22, "cnt": 32}, "MoE_L3_fwd":{"total": 441.60, "avg": 13.80, "max": 9.17, "min": 130.74, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 11.68, "avg": 5.84, "max": 0.92, "min": 10.76, "cnt": 2}, "forward-send-backward-recv":{"total": 293.91, "avg": 9.80, "max": 1.38, "min": 199.03, "cnt": 30}, "backward-compute":{"total": 1471.47, "avg": 45.98, "max": 43.42, "min": 48.02, "cnt": 32}, "MoE_L3_bwd":{"total": 312.21, "avg": 9.76, "max": 9.13, "min": 11.26, "cnt": 32}, "MoE_L2_bwd":{"total": 350.99, "avg": 10.97, "max": 9.99, "min": 12.82, "cnt": 32}, "MoE_L1_bwd":{"total": 304.14, "avg": 9.50, "max": 8.91, "min": 9.82, "cnt": 32}, "MoE_L0_bwd":{"total": 284.16, "avg": 8.88, "max": 8.47, "min": 9.46, "cnt": 32}, "backward-send-forward-recv":{"total": 3425.59, "avg": 118.12, "max": 2.50, "min": 419.86, "cnt": 29}, "backward-send":{"total": 3.09, "avg": 1.03, "max": 0.99, "min": 1.06, "cnt": 3}, "backward-recv":{"total": 135.66, "avg": 67.83, "max": 63.57, "min": 72.09, "cnt": 2}, "backward-params-all-reduce":{"total": 488.71, "avg": 488.71, "max": 488.71, "min": 488.71, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 235.28, "avg": 235.28, "max": 235.28, "min": 235.28, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 195.19, "avg": 195.19, "max": 195.19, "min": 195.19, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.70, "avg": 3.70, "max": 3.70, "min": 3.70, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 91, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 70.71, "avg": 23.57, "max": 1.51, "min": 67.64, "cnt": 3}, "forward-compute":{"total": 1815.86, "avg": 56.75, "max": 49.32, "min": 70.38, "cnt": 32}, "fwd-compute":{"total": 1812.38, "avg": 56.64, "max": 49.26, "min": 70.29, "cnt": 32}, "batch-generator":{"total": 45.26, "avg": 1.41, "max": 0.73, "min": 2.81, "cnt": 32}, "fwd-embedding":{"total": 0.73, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1753.81, "avg": 54.81, "max": 48.21, "min": 69.02, "cnt": 32}, "fwd-layernorm":{"total": 10.83, "avg": 0.08, "max": 0.06, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 112.64, "avg": 0.88, "max": 0.74, "min": 1.53, "cnt": 128}, "fwd-misc":{"total": 22.53, "avg": 0.18, "max": 0.12, "min": 0.38, "cnt": 128}, "fwd-MLP":{"total": 1585.50, "avg": 12.39, "max": 9.24, "min": 22.35, "cnt": 128}, "MoE_L0_fwd":{"total": 484.65, "avg": 15.15, "max": 10.80, "min": 22.27, "cnt": 32}, "MoEMLP":{"total": 1567.67, "avg": 12.25, "max": 9.14, "min": 22.22, "cnt": 128}, "MoE_L1_fwd":{"total": 397.55, "avg": 12.42, "max": 10.85, "min": 15.83, "cnt": 32}, "MoE_L2_fwd":{"total": 372.27, "avg": 11.63, "max": 10.82, "min": 14.68, "cnt": 32}, "MoE_L3_fwd":{"total": 319.72, "avg": 9.99, "max": 9.18, "min": 14.76, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 4.80, "avg": 2.40, "max": 0.97, "min": 3.83, "cnt": 2}, "forward-send-backward-recv":{"total": 1956.89, "avg": 65.23, "max": 1.53, "min": 471.05, "cnt": 30}, "backward-compute":{"total": 1468.12, "avg": 45.88, "max": 44.01, "min": 48.08, "cnt": 32}, "MoE_L3_bwd":{"total": 319.26, "avg": 9.98, "max": 8.94, "min": 10.97, "cnt": 32}, "MoE_L2_bwd":{"total": 337.71, "avg": 10.55, "max": 9.73, "min": 11.76, "cnt": 32}, "MoE_L1_bwd":{"total": 305.78, "avg": 9.56, "max": 9.16, "min": 10.17, "cnt": 32}, "MoE_L0_bwd":{"total": 284.92, "avg": 8.90, "max": 8.21, "min": 9.21, "cnt": 32}, "backward-send-forward-recv":{"total": 2380.36, "avg": 82.08, "max": 1.50, "min": 379.25, "cnt": 29}, "backward-send":{"total": 2.72, "avg": 0.91, "max": 0.78, "min": 1.08, "cnt": 3}, "backward-recv":{"total": 319.36, "avg": 159.68, "max": 65.24, "min": 254.12, "cnt": 2}, "backward-params-all-reduce":{"total": 487.75, "avg": 487.75, "max": 487.75, "min": 487.75, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 230.96, "avg": 230.96, "max": 230.96, "min": 230.96, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 191.12, "avg": 191.12, "max": 191.12, "min": 191.12, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.58, "avg": 3.58, "max": 3.58, "min": 3.58, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 92, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 76.76, "avg": 25.59, "max": 1.42, "min": 73.40, "cnt": 3}, "forward-compute":{"total": 1787.98, "avg": 55.87, "max": 47.35, "min": 61.67, "cnt": 32}, "fwd-compute":{"total": 1784.74, "avg": 55.77, "max": 47.28, "min": 61.58, "cnt": 32}, "batch-generator":{"total": 64.00, "avg": 2.00, "max": 0.67, "min": 3.58, "cnt": 32}, "fwd-embedding":{"total": 0.67, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1707.73, "avg": 53.37, "max": 46.30, "min": 59.23, "cnt": 32}, "fwd-layernorm":{"total": 10.23, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 108.20, "avg": 0.85, "max": 0.74, "min": 1.60, "cnt": 128}, "fwd-misc":{"total": 21.62, "avg": 0.17, "max": 0.11, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1546.28, "avg": 12.08, "max": 9.09, "min": 16.80, "cnt": 128}, "MoE_L0_fwd":{"total": 449.50, "avg": 14.05, "max": 10.01, "min": 16.72, "cnt": 32}, "MoEMLP":{"total": 1529.29, "avg": 11.95, "max": 8.99, "min": 16.68, "cnt": 128}, "MoE_L1_fwd":{"total": 387.84, "avg": 12.12, "max": 10.97, "min": 13.73, "cnt": 32}, "MoE_L2_fwd":{"total": 375.46, "avg": 11.73, "max": 11.23, "min": 12.22, "cnt": 32}, "MoE_L3_fwd":{"total": 322.76, "avg": 10.09, "max": 9.03, "min": 14.03, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 2.01, "avg": 1.01, "max": 1.00, "min": 1.02, "cnt": 2}, "forward-send-backward-recv":{"total": 1109.51, "avg": 36.98, "max": 1.91, "min": 308.57, "cnt": 30}, "backward-compute":{"total": 1493.26, "avg": 46.66, "max": 44.01, "min": 51.91, "cnt": 32}, "MoE_L3_bwd":{"total": 326.00, "avg": 10.19, "max": 9.06, "min": 13.79, "cnt": 32}, "MoE_L2_bwd":{"total": 369.28, "avg": 11.54, "max": 10.81, "min": 15.33, "cnt": 32}, "MoE_L1_bwd":{"total": 307.96, "avg": 9.62, "max": 9.06, "min": 11.39, "cnt": 32}, "MoE_L0_bwd":{"total": 271.88, "avg": 8.50, "max": 7.86, "min": 8.92, "cnt": 32}, "backward-send-forward-recv":{"total": 3487.94, "avg": 120.27, "max": 2.19, "min": 671.67, "cnt": 29}, "backward-send":{"total": 3.35, "avg": 1.12, "max": 0.81, "min": 1.30, "cnt": 3}, "backward-recv":{"total": 209.03, "avg": 104.52, "max": 67.19, "min": 141.84, "cnt": 2}, "backward-params-all-reduce":{"total": 484.10, "avg": 484.10, "max": 484.10, "min": 484.10, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 239.76, "avg": 239.76, "max": 239.76, "min": 239.76, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 195.68, "avg": 195.68, "max": 195.68, "min": 195.68, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.36, "avg": 3.36, "max": 3.36, "min": 3.36, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 93, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 73.37, "avg": 24.46, "max": 1.45, "min": 60.53, "cnt": 3}, "forward-compute":{"total": 1807.09, "avg": 56.47, "max": 48.62, "min": 65.58, "cnt": 32}, "fwd-compute":{"total": 1803.78, "avg": 56.37, "max": 48.55, "min": 65.51, "cnt": 32}, "batch-generator":{"total": 45.15, "avg": 1.41, "max": 0.66, "min": 2.37, "cnt": 32}, "fwd-embedding":{"total": 0.70, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1745.78, "avg": 54.56, "max": 47.50, "min": 64.04, "cnt": 32}, "fwd-layernorm":{"total": 10.36, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 113.19, "avg": 0.88, "max": 0.74, "min": 1.89, "cnt": 128}, "fwd-misc":{"total": 22.54, "avg": 0.18, "max": 0.11, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1577.61, "avg": 12.33, "max": 9.35, "min": 21.13, "cnt": 128}, "MoE_L0_fwd":{"total": 457.96, "avg": 14.31, "max": 10.29, "min": 21.04, "cnt": 32}, "MoEMLP":{"total": 1560.17, "avg": 12.19, "max": 9.24, "min": 20.99, "cnt": 128}, "MoE_L1_fwd":{"total": 400.04, "avg": 12.50, "max": 11.03, "min": 16.10, "cnt": 32}, "MoE_L2_fwd":{"total": 387.11, "avg": 12.10, "max": 11.33, "min": 15.24, "cnt": 32}, "MoE_L3_fwd":{"total": 321.47, "avg": 10.05, "max": 9.28, "min": 11.29, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.95, "avg": 0.97, "max": 0.94, "min": 1.01, "cnt": 2}, "forward-send-backward-recv":{"total": 537.78, "avg": 17.93, "max": 1.57, "min": 106.19, "cnt": 30}, "backward-compute":{"total": 1502.10, "avg": 46.94, "max": 44.08, "min": 49.50, "cnt": 32}, "MoE_L3_bwd":{"total": 327.38, "avg": 10.23, "max": 9.32, "min": 12.61, "cnt": 32}, "MoE_L2_bwd":{"total": 365.04, "avg": 11.41, "max": 10.79, "min": 12.15, "cnt": 32}, "MoE_L1_bwd":{"total": 319.85, "avg": 10.00, "max": 9.49, "min": 12.05, "cnt": 32}, "MoE_L0_bwd":{"total": 270.64, "avg": 8.46, "max": 7.75, "min": 9.34, "cnt": 32}, "backward-send-forward-recv":{"total": 2352.88, "avg": 81.13, "max": 2.15, "min": 267.11, "cnt": 29}, "backward-send":{"total": 3.13, "avg": 1.04, "max": 0.98, "min": 1.13, "cnt": 3}, "backward-recv":{"total": 205.90, "avg": 102.95, "max": 67.46, "min": 138.44, "cnt": 2}, "backward-params-all-reduce":{"total": 487.21, "avg": 487.21, "max": 487.21, "min": 487.21, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 230.40, "avg": 230.40, "max": 230.40, "min": 230.40, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 190.62, "avg": 190.62, "max": 190.62, "min": 190.62, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}}}
{"type":"time", "iteration": 94, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.12, "avg": 0.12, "max": 0.12, "min": 0.12, "cnt": 1}, "forward-recv":{"total": 69.29, "avg": 23.10, "max": 1.31, "min": 66.37, "cnt": 3}, "forward-compute":{"total": 1794.48, "avg": 56.08, "max": 48.71, "min": 63.84, "cnt": 32}, "fwd-compute":{"total": 1791.40, "avg": 55.98, "max": 48.64, "min": 63.72, "cnt": 32}, "batch-generator":{"total": 43.47, "avg": 1.36, "max": 0.68, "min": 2.45, "cnt": 32}, "fwd-embedding":{"total": 0.66, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1735.15, "avg": 54.22, "max": 47.65, "min": 61.56, "cnt": 32}, "fwd-layernorm":{"total": 10.55, "avg": 0.08, "max": 0.06, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 113.08, "avg": 0.88, "max": 0.74, "min": 1.88, "cnt": 128}, "fwd-misc":{"total": 22.82, "avg": 0.18, "max": 0.11, "min": 0.46, "cnt": 128}, "fwd-MLP":{"total": 1566.21, "avg": 12.24, "max": 9.62, "min": 17.05, "cnt": 128}, "MoE_L0_fwd":{"total": 439.63, "avg": 13.74, "max": 10.54, "min": 16.80, "cnt": 32}, "MoEMLP":{"total": 1548.34, "avg": 12.10, "max": 9.52, "min": 16.91, "cnt": 128}, "MoE_L1_fwd":{"total": 400.01, "avg": 12.50, "max": 11.10, "min": 15.00, "cnt": 32}, "MoE_L2_fwd":{"total": 382.94, "avg": 11.97, "max": 11.34, "min": 15.41, "cnt": 32}, "MoE_L3_fwd":{"total": 332.23, "avg": 10.38, "max": 9.56, "min": 16.95, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 2.96, "avg": 1.48, "max": 0.92, "min": 2.04, "cnt": 2}, "forward-send-backward-recv":{"total": 189.31, "avg": 6.31, "max": 1.82, "min": 116.02, "cnt": 30}, "backward-compute":{"total": 1497.90, "avg": 46.81, "max": 44.39, "min": 48.80, "cnt": 32}, "MoE_L3_bwd":{"total": 327.44, "avg": 10.23, "max": 8.96, "min": 12.46, "cnt": 32}, "MoE_L2_bwd":{"total": 356.59, "avg": 11.14, "max": 10.25, "min": 11.82, "cnt": 32}, "MoE_L1_bwd":{"total": 321.22, "avg": 10.04, "max": 9.15, "min": 11.03, "cnt": 32}, "MoE_L0_bwd":{"total": 272.75, "avg": 8.52, "max": 7.97, "min": 9.85, "cnt": 32}, "backward-send-forward-recv":{"total": 2676.26, "avg": 92.28, "max": 2.15, "min": 284.71, "cnt": 29}, "backward-send":{"total": 3.11, "avg": 1.04, "max": 0.99, "min": 1.13, "cnt": 3}, "backward-recv":{"total": 118.02, "avg": 59.01, "max": 54.56, "min": 63.46, "cnt": 2}, "backward-params-all-reduce":{"total": 484.25, "avg": 484.25, "max": 484.25, "min": 484.25, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "optimizer":{"total": 249.49, "avg": 249.49, "max": 249.49, "min": 249.49, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 209.63, "avg": 209.63, "max": 209.63, "min": 209.63, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.31, "avg": 3.31, "max": 3.31, "min": 3.31, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 95, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 77.10, "avg": 25.70, "max": 1.42, "min": 72.84, "cnt": 3}, "forward-compute":{"total": 1791.62, "avg": 55.99, "max": 48.41, "min": 65.59, "cnt": 32}, "fwd-compute":{"total": 1788.40, "avg": 55.89, "max": 48.34, "min": 65.48, "cnt": 32}, "batch-generator":{"total": 46.88, "avg": 1.47, "max": 0.67, "min": 2.64, "cnt": 32}, "fwd-embedding":{"total": 0.60, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1728.79, "avg": 54.02, "max": 47.38, "min": 62.54, "cnt": 32}, "fwd-layernorm":{"total": 9.95, "avg": 0.08, "max": 0.06, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 108.77, "avg": 0.85, "max": 0.74, "min": 1.50, "cnt": 128}, "fwd-misc":{"total": 21.48, "avg": 0.17, "max": 0.11, "min": 0.40, "cnt": 128}, "fwd-MLP":{"total": 1567.08, "avg": 12.24, "max": 9.43, "min": 18.59, "cnt": 128}, "MoE_L0_fwd":{"total": 439.74, "avg": 13.74, "max": 10.23, "min": 18.49, "cnt": 32}, "MoEMLP":{"total": 1550.06, "avg": 12.11, "max": 9.33, "min": 18.45, "cnt": 128}, "MoE_L1_fwd":{"total": 399.72, "avg": 12.49, "max": 11.31, "min": 16.65, "cnt": 32}, "MoE_L2_fwd":{"total": 382.16, "avg": 11.94, "max": 11.18, "min": 14.05, "cnt": 32}, "MoE_L3_fwd":{"total": 334.56, "avg": 10.45, "max": 9.37, "min": 13.40, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.70, "avg": 0.85, "max": 0.77, "min": 0.93, "cnt": 2}, "forward-send-backward-recv":{"total": 185.60, "avg": 6.19, "max": 1.26, "min": 106.06, "cnt": 30}, "backward-compute":{"total": 1516.50, "avg": 47.39, "max": 44.73, "min": 52.22, "cnt": 32}, "MoE_L3_bwd":{"total": 336.28, "avg": 10.51, "max": 9.80, "min": 12.53, "cnt": 32}, "MoE_L2_bwd":{"total": 347.86, "avg": 10.87, "max": 9.70, "min": 11.44, "cnt": 32}, "MoE_L1_bwd":{"total": 336.78, "avg": 10.52, "max": 9.72, "min": 13.43, "cnt": 32}, "MoE_L0_bwd":{"total": 274.66, "avg": 8.58, "max": 8.06, "min": 9.62, "cnt": 32}, "backward-send-forward-recv":{"total": 2529.52, "avg": 87.22, "max": 2.27, "min": 320.88, "cnt": 29}, "backward-send":{"total": 3.41, "avg": 1.14, "max": 1.10, "min": 1.18, "cnt": 3}, "backward-recv":{"total": 151.57, "avg": 75.79, "max": 53.75, "min": 97.82, "cnt": 2}, "backward-params-all-reduce":{"total": 485.03, "avg": 485.03, "max": 485.03, "min": 485.03, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 234.36, "avg": 234.36, "max": 234.36, "min": 234.36, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 194.48, "avg": 194.48, "max": 194.48, "min": 194.48, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.49, "avg": 3.49, "max": 3.49, "min": 3.49, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 96, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 75.75, "avg": 25.25, "max": 1.40, "min": 71.74, "cnt": 3}, "forward-compute":{"total": 1860.06, "avg": 58.13, "max": 50.29, "min": 67.82, "cnt": 32}, "fwd-compute":{"total": 1856.80, "avg": 58.02, "max": 50.21, "min": 67.70, "cnt": 32}, "batch-generator":{"total": 48.64, "avg": 1.52, "max": 0.76, "min": 2.89, "cnt": 32}, "fwd-embedding":{"total": 0.76, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1794.31, "avg": 56.07, "max": 49.06, "min": 65.96, "cnt": 32}, "fwd-layernorm":{"total": 11.31, "avg": 0.09, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 114.46, "avg": 0.89, "max": 0.75, "min": 2.24, "cnt": 128}, "fwd-misc":{"total": 23.48, "avg": 0.18, "max": 0.12, "min": 0.43, "cnt": 128}, "fwd-MLP":{"total": 1621.72, "avg": 12.67, "max": 9.80, "min": 19.25, "cnt": 128}, "MoE_L0_fwd":{"total": 475.06, "avg": 14.85, "max": 10.69, "min": 19.16, "cnt": 32}, "MoEMLP":{"total": 1603.24, "avg": 12.53, "max": 9.68, "min": 19.12, "cnt": 128}, "MoE_L1_fwd":{"total": 414.86, "avg": 12.96, "max": 11.71, "min": 15.58, "cnt": 32}, "MoE_L2_fwd":{"total": 381.21, "avg": 11.91, "max": 10.79, "min": 18.35, "cnt": 32}, "MoE_L3_fwd":{"total": 338.80, "avg": 10.59, "max": 9.72, "min": 15.31, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.62, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 2.02, "avg": 1.01, "max": 0.98, "min": 1.04, "cnt": 2}, "forward-send-backward-recv":{"total": 166.87, "avg": 5.56, "max": 1.55, "min": 98.48, "cnt": 30}, "backward-compute":{"total": 1515.23, "avg": 47.35, "max": 43.95, "min": 48.68, "cnt": 32}, "MoE_L3_bwd":{"total": 334.45, "avg": 10.45, "max": 9.49, "min": 11.10, "cnt": 32}, "MoE_L2_bwd":{"total": 333.45, "avg": 10.42, "max": 8.83, "min": 11.28, "cnt": 32}, "MoE_L1_bwd":{"total": 350.31, "avg": 10.95, "max": 10.24, "min": 12.10, "cnt": 32}, "MoE_L0_bwd":{"total": 277.92, "avg": 8.69, "max": 7.78, "min": 9.96, "cnt": 32}, "backward-send-forward-recv":{"total": 2606.86, "avg": 89.89, "max": 2.43, "min": 306.80, "cnt": 29}, "backward-send":{"total": 2.18, "avg": 0.73, "max": 0.49, "min": 1.03, "cnt": 3}, "backward-recv":{"total": 140.52, "avg": 70.26, "max": 67.06, "min": 73.45, "cnt": 2}, "backward-params-all-reduce":{"total": 484.89, "avg": 484.89, "max": 484.89, "min": 484.89, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 238.49, "avg": 238.49, "max": 238.49, "min": 238.49, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 198.68, "avg": 198.68, "max": 198.68, "min": 198.68, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 97, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 74.91, "avg": 24.97, "max": 1.35, "min": 71.95, "cnt": 3}, "forward-compute":{"total": 1787.10, "avg": 55.85, "max": 49.90, "min": 63.66, "cnt": 32}, "fwd-compute":{"total": 1783.97, "avg": 55.75, "max": 49.82, "min": 63.57, "cnt": 32}, "batch-generator":{"total": 43.38, "avg": 1.36, "max": 0.68, "min": 3.29, "cnt": 32}, "fwd-embedding":{"total": 0.61, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1727.43, "avg": 53.98, "max": 48.81, "min": 61.07, "cnt": 32}, "fwd-layernorm":{"total": 10.23, "avg": 0.08, "max": 0.06, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 111.91, "avg": 0.87, "max": 0.74, "min": 2.52, "cnt": 128}, "fwd-misc":{"total": 22.04, "avg": 0.17, "max": 0.12, "min": 0.41, "cnt": 128}, "fwd-MLP":{"total": 1561.20, "avg": 12.20, "max": 9.75, "min": 18.51, "cnt": 128}, "MoE_L0_fwd":{"total": 452.18, "avg": 14.13, "max": 11.01, "min": 18.43, "cnt": 32}, "MoEMLP":{"total": 1543.79, "avg": 12.06, "max": 9.63, "min": 18.39, "cnt": 128}, "MoE_L1_fwd":{"total": 400.87, "avg": 12.53, "max": 11.30, "min": 16.15, "cnt": 32}, "MoE_L2_fwd":{"total": 360.40, "avg": 11.26, "max": 10.55, "min": 14.57, "cnt": 32}, "MoE_L3_fwd":{"total": 336.60, "avg": 10.52, "max": 9.68, "min": 13.44, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 7.66, "avg": 3.83, "max": 0.73, "min": 6.94, "cnt": 2}, "forward-send-backward-recv":{"total": 173.14, "avg": 5.77, "max": 1.73, "min": 100.00, "cnt": 30}, "backward-compute":{"total": 1504.90, "avg": 47.03, "max": 44.15, "min": 51.43, "cnt": 32}, "MoE_L3_bwd":{"total": 339.20, "avg": 10.60, "max": 8.97, "min": 13.15, "cnt": 32}, "MoE_L2_bwd":{"total": 332.19, "avg": 10.38, "max": 9.60, "min": 12.86, "cnt": 32}, "MoE_L1_bwd":{"total": 333.79, "avg": 10.43, "max": 10.02, "min": 11.45, "cnt": 32}, "MoE_L0_bwd":{"total": 280.13, "avg": 8.75, "max": 8.18, "min": 9.58, "cnt": 32}, "backward-send-forward-recv":{"total": 2761.00, "avg": 95.21, "max": 2.32, "min": 664.06, "cnt": 29}, "backward-send":{"total": 3.44, "avg": 1.15, "max": 1.12, "min": 1.16, "cnt": 3}, "backward-recv":{"total": 110.78, "avg": 55.39, "max": 52.99, "min": 57.79, "cnt": 2}, "backward-params-all-reduce":{"total": 488.90, "avg": 488.90, "max": 488.90, "min": 488.90, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 229.35, "avg": 229.35, "max": 229.35, "min": 229.35, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 189.65, "avg": 189.65, "max": 189.65, "min": 189.65, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.28, "avg": 3.28, "max": 3.28, "min": 3.28, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.48, "avg": 3.48, "max": 3.48, "min": 3.48, "cnt": 1}}}
{"type":"time", "iteration": 98, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 95.95, "avg": 31.98, "max": 1.46, "min": 91.01, "cnt": 3}, "forward-compute":{"total": 1831.94, "avg": 57.25, "max": 50.49, "min": 63.77, "cnt": 32}, "fwd-compute":{"total": 1828.74, "avg": 57.15, "max": 50.41, "min": 63.66, "cnt": 32}, "batch-generator":{"total": 42.80, "avg": 1.34, "max": 0.60, "min": 2.35, "cnt": 32}, "fwd-embedding":{"total": 0.71, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1772.82, "avg": 55.40, "max": 49.33, "min": 62.05, "cnt": 32}, "fwd-layernorm":{"total": 10.53, "avg": 0.08, "max": 0.06, "min": 0.22, "cnt": 128}, "fwd-attn":{"total": 111.08, "avg": 0.87, "max": 0.74, "min": 1.94, "cnt": 128}, "fwd-misc":{"total": 21.85, "avg": 0.17, "max": 0.12, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1606.99, "avg": 12.55, "max": 9.86, "min": 19.47, "cnt": 128}, "MoE_L0_fwd":{"total": 484.02, "avg": 15.13, "max": 10.72, "min": 19.35, "cnt": 32}, "MoEMLP":{"total": 1589.56, "avg": 12.42, "max": 9.75, "min": 19.28, "cnt": 128}, "MoE_L1_fwd":{"total": 399.64, "avg": 12.49, "max": 11.28, "min": 15.60, "cnt": 32}, "MoE_L2_fwd":{"total": 360.71, "avg": 11.27, "max": 10.57, "min": 13.01, "cnt": 32}, "MoE_L3_fwd":{"total": 351.46, "avg": 10.98, "max": 9.79, "min": 15.54, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.59, "avg": 0.80, "max": 0.76, "min": 0.84, "cnt": 2}, "forward-send-backward-recv":{"total": 171.27, "avg": 5.71, "max": 1.65, "min": 103.33, "cnt": 30}, "backward-compute":{"total": 1503.59, "avg": 46.99, "max": 44.89, "min": 49.26, "cnt": 32}, "MoE_L3_bwd":{"total": 344.41, "avg": 10.76, "max": 9.31, "min": 12.79, "cnt": 32}, "MoE_L2_bwd":{"total": 333.36, "avg": 10.42, "max": 9.59, "min": 11.70, "cnt": 32}, "MoE_L1_bwd":{"total": 324.99, "avg": 10.16, "max": 9.55, "min": 12.14, "cnt": 32}, "MoE_L0_bwd":{"total": 283.57, "avg": 8.86, "max": 8.43, "min": 9.65, "cnt": 32}, "backward-send-forward-recv":{"total": 3570.65, "avg": 123.13, "max": 2.57, "min": 451.78, "cnt": 29}, "backward-send":{"total": 3.01, "avg": 1.00, "max": 0.80, "min": 1.15, "cnt": 3}, "backward-recv":{"total": 133.62, "avg": 66.81, "max": 61.62, "min": 72.00, "cnt": 2}, "backward-params-all-reduce":{"total": 486.06, "avg": 486.06, "max": 486.06, "min": 486.06, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 243.08, "avg": 243.08, "max": 243.08, "min": 243.08, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 203.23, "avg": 203.23, "max": 203.23, "min": 203.23, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.51, "avg": 3.51, "max": 3.51, "min": 3.51, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 99, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 75.50, "avg": 25.17, "max": 1.68, "min": 72.10, "cnt": 3}, "forward-compute":{"total": 1846.89, "avg": 57.72, "max": 48.42, "min": 66.46, "cnt": 32}, "fwd-compute":{"total": 1843.28, "avg": 57.60, "max": 48.35, "min": 66.35, "cnt": 32}, "batch-generator":{"total": 45.22, "avg": 1.41, "max": 0.66, "min": 3.56, "cnt": 32}, "fwd-embedding":{"total": 0.66, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1785.09, "avg": 55.78, "max": 47.40, "min": 65.18, "cnt": 32}, "fwd-layernorm":{"total": 10.38, "avg": 0.08, "max": 0.06, "min": 0.23, "cnt": 128}, "fwd-attn":{"total": 110.70, "avg": 0.86, "max": 0.74, "min": 1.85, "cnt": 128}, "fwd-misc":{"total": 22.06, "avg": 0.17, "max": 0.11, "min": 0.45, "cnt": 128}, "fwd-MLP":{"total": 1620.12, "avg": 12.66, "max": 9.98, "min": 21.58, "cnt": 128}, "MoE_L0_fwd":{"total": 489.87, "avg": 15.31, "max": 10.61, "min": 21.50, "cnt": 32}, "MoEMLP":{"total": 1603.06, "avg": 12.52, "max": 9.87, "min": 21.45, "cnt": 128}, "MoE_L1_fwd":{"total": 405.61, "avg": 12.68, "max": 10.93, "min": 16.50, "cnt": 32}, "MoE_L2_fwd":{"total": 373.85, "avg": 11.68, "max": 10.81, "min": 18.04, "cnt": 32}, "MoE_L3_fwd":{"total": 340.02, "avg": 10.63, "max": 9.91, "min": 11.83, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.77, "avg": 0.88, "max": 0.84, "min": 0.92, "cnt": 2}, "forward-send-backward-recv":{"total": 2323.60, "avg": 77.45, "max": 1.06, "min": 769.48, "cnt": 30}, "backward-compute":{"total": 1511.85, "avg": 47.25, "max": 44.35, "min": 51.20, "cnt": 32}, "MoE_L3_bwd":{"total": 367.91, "avg": 11.50, "max": 10.18, "min": 15.14, "cnt": 32}, "MoE_L2_bwd":{"total": 327.36, "avg": 10.23, "max": 9.51, "min": 12.43, "cnt": 32}, "MoE_L1_bwd":{"total": 317.43, "avg": 9.92, "max": 9.50, "min": 13.77, "cnt": 32}, "MoE_L0_bwd":{"total": 280.83, "avg": 8.78, "max": 7.87, "min": 9.25, "cnt": 32}, "backward-send-forward-recv":{"total": 2723.53, "avg": 93.91, "max": 1.42, "min": 732.36, "cnt": 29}, "backward-send":{"total": 2.92, "avg": 0.97, "max": 0.92, "min": 1.03, "cnt": 3}, "backward-recv":{"total": 797.14, "avg": 398.57, "max": 66.82, "min": 730.32, "cnt": 2}, "backward-params-all-reduce":{"total": 486.95, "avg": 486.95, "max": 486.95, "min": 486.95, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 235.19, "avg": 235.19, "max": 235.19, "min": 235.19, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 195.30, "avg": 195.30, "max": 195.30, "min": 195.30, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.49, "avg": 3.49, "max": 3.49, "min": 3.49, "cnt": 1}}}
{"type":"time", "iteration": 100, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 214.66, "avg": 71.55, "max": 0.85, "min": 212.40, "cnt": 3}, "forward-compute":{"total": 2058.19, "avg": 64.32, "max": 50.61, "min": 189.56, "cnt": 32}, "fwd-compute":{"total": 2054.98, "avg": 64.22, "max": 50.54, "min": 189.47, "cnt": 32}, "batch-generator":{"total": 46.45, "avg": 1.45, "max": 0.75, "min": 3.51, "cnt": 32}, "fwd-embedding":{"total": 0.67, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1995.55, "avg": 62.36, "max": 49.45, "min": 188.28, "cnt": 32}, "fwd-layernorm":{"total": 10.42, "avg": 0.08, "max": 0.06, "min": 0.23, "cnt": 128}, "fwd-attn":{"total": 111.24, "avg": 0.87, "max": 0.74, "min": 2.45, "cnt": 128}, "fwd-misc":{"total": 21.91, "avg": 0.17, "max": 0.11, "min": 0.56, "cnt": 128}, "fwd-MLP":{"total": 1830.20, "avg": 14.30, "max": 10.07, "min": 139.47, "cnt": 128}, "MoE_L0_fwd":{"total": 603.10, "avg": 18.85, "max": 11.27, "min": 133.90, "cnt": 32}, "MoEMLP":{"total": 1813.05, "avg": 14.16, "max": 9.96, "min": 139.35, "cnt": 128}, "MoE_L1_fwd":{"total": 503.71, "avg": 15.74, "max": 10.65, "min": 139.40, "cnt": 32}, "MoE_L2_fwd":{"total": 370.90, "avg": 11.59, "max": 10.94, "min": 14.60, "cnt": 32}, "MoE_L3_fwd":{"total": 341.65, "avg": 10.68, "max": 10.01, "min": 11.45, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 155.49, "avg": 77.75, "max": 0.83, "min": 154.66, "cnt": 2}, "forward-send-backward-recv":{"total": 576.53, "avg": 19.22, "max": 1.71, "min": 159.29, "cnt": 30}, "backward-compute":{"total": 1475.08, "avg": 46.10, "max": 44.04, "min": 49.25, "cnt": 32}, "MoE_L3_bwd":{"total": 356.63, "avg": 11.14, "max": 10.14, "min": 14.37, "cnt": 32}, "MoE_L2_bwd":{"total": 332.27, "avg": 10.38, "max": 9.30, "min": 12.76, "cnt": 32}, "MoE_L1_bwd":{"total": 274.74, "avg": 8.59, "max": 8.12, "min": 9.08, "cnt": 32}, "MoE_L0_bwd":{"total": 291.65, "avg": 9.11, "max": 7.92, "min": 9.62, "cnt": 32}, "backward-send-forward-recv":{"total": 2517.71, "avg": 86.82, "max": 1.63, "min": 689.36, "cnt": 29}, "backward-send":{"total": 3.31, "avg": 1.10, "max": 1.02, "min": 1.18, "cnt": 3}, "backward-recv":{"total": 209.02, "avg": 104.51, "max": 63.85, "min": 145.17, "cnt": 2}, "backward-params-all-reduce":{"total": 485.82, "avg": 485.82, "max": 485.82, "min": 485.82, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 233.28, "avg": 233.28, "max": 233.28, "min": 233.28, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 193.52, "avg": 193.52, "max": 193.52, "min": 193.52, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.33, "avg": 3.33, "max": 3.33, "min": 3.33, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 101, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 87.31, "avg": 29.10, "max": 3.72, "min": 78.10, "cnt": 3}, "forward-compute":{"total": 1830.20, "avg": 57.19, "max": 49.96, "min": 66.39, "cnt": 32}, "fwd-compute":{"total": 1827.13, "avg": 57.10, "max": 49.89, "min": 66.30, "cnt": 32}, "batch-generator":{"total": 42.58, "avg": 1.33, "max": 0.71, "min": 2.51, "cnt": 32}, "fwd-embedding":{"total": 0.64, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1771.74, "avg": 55.37, "max": 48.83, "min": 64.30, "cnt": 32}, "fwd-layernorm":{"total": 10.39, "avg": 0.08, "max": 0.06, "min": 0.23, "cnt": 128}, "fwd-attn":{"total": 109.53, "avg": 0.86, "max": 0.74, "min": 1.50, "cnt": 128}, "fwd-misc":{"total": 21.87, "avg": 0.17, "max": 0.12, "min": 0.39, "cnt": 128}, "fwd-MLP":{"total": 1608.07, "avg": 12.56, "max": 10.20, "min": 20.85, "cnt": 128}, "MoE_L0_fwd":{"total": 495.31, "avg": 15.48, "max": 11.96, "min": 20.77, "cnt": 32}, "MoEMLP":{"total": 1590.88, "avg": 12.43, "max": 10.09, "min": 20.73, "cnt": 128}, "MoE_L1_fwd":{"total": 372.84, "avg": 11.65, "max": 10.13, "min": 15.68, "cnt": 32}, "MoE_L2_fwd":{"total": 377.18, "avg": 11.79, "max": 11.06, "min": 15.61, "cnt": 32}, "MoE_L3_fwd":{"total": 351.94, "avg": 11.00, "max": 10.14, "min": 13.59, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.83, "avg": 0.91, "max": 0.87, "min": 0.96, "cnt": 2}, "forward-send-backward-recv":{"total": 161.58, "avg": 5.39, "max": 1.09, "min": 89.78, "cnt": 30}, "backward-compute":{"total": 1473.52, "avg": 46.05, "max": 44.61, "min": 46.94, "cnt": 32}, "MoE_L3_bwd":{"total": 355.79, "avg": 11.12, "max": 10.29, "min": 11.86, "cnt": 32}, "MoE_L2_bwd":{"total": 333.47, "avg": 10.42, "max": 9.40, "min": 11.33, "cnt": 32}, "MoE_L1_bwd":{"total": 270.41, "avg": 8.45, "max": 7.86, "min": 9.53, "cnt": 32}, "MoE_L0_bwd":{"total": 296.29, "avg": 9.26, "max": 8.84, "min": 9.69, "cnt": 32}, "backward-send-forward-recv":{"total": 2913.47, "avg": 100.46, "max": 2.34, "min": 275.48, "cnt": 29}, "backward-send":{"total": 3.20, "avg": 1.07, "max": 0.99, "min": 1.13, "cnt": 3}, "backward-recv":{"total": 132.48, "avg": 66.24, "max": 64.95, "min": 67.53, "cnt": 2}, "backward-params-all-reduce":{"total": 479.87, "avg": 479.87, "max": 479.87, "min": 479.87, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 242.55, "avg": 242.55, "max": 242.55, "min": 242.55, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 200.26, "avg": 200.26, "max": 200.26, "min": 200.26, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.60, "avg": 3.60, "max": 3.60, "min": 3.60, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}}}
{"type":"time", "iteration": 102, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 76.47, "avg": 25.49, "max": 1.48, "min": 73.45, "cnt": 3}, "forward-compute":{"total": 1839.90, "avg": 57.50, "max": 49.81, "min": 69.14, "cnt": 32}, "fwd-compute":{"total": 1836.85, "avg": 57.40, "max": 49.74, "min": 69.06, "cnt": 32}, "batch-generator":{"total": 41.40, "avg": 1.29, "max": 0.68, "min": 2.80, "cnt": 32}, "fwd-embedding":{"total": 0.69, "avg": 0.02, "max": 0.01, "min": 0.06, "cnt": 32}, "fwd-encoder":{"total": 1782.67, "avg": 55.71, "max": 48.77, "min": 67.59, "cnt": 32}, "fwd-layernorm":{"total": 10.24, "avg": 0.08, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 110.62, "avg": 0.86, "max": 0.74, "min": 1.84, "cnt": 128}, "fwd-misc":{"total": 21.90, "avg": 0.17, "max": 0.11, "min": 0.39, "cnt": 128}, "fwd-MLP":{"total": 1617.76, "avg": 12.64, "max": 10.18, "min": 22.45, "cnt": 128}, "MoE_L0_fwd":{"total": 504.34, "avg": 15.76, "max": 11.48, "min": 22.35, "cnt": 32}, "MoEMLP":{"total": 1600.30, "avg": 12.50, "max": 10.08, "min": 22.30, "cnt": 128}, "MoE_L1_fwd":{"total": 370.14, "avg": 11.57, "max": 10.62, "min": 13.93, "cnt": 32}, "MoE_L2_fwd":{"total": 371.56, "avg": 11.61, "max": 10.72, "min": 16.31, "cnt": 32}, "MoE_L3_fwd":{"total": 360.68, "avg": 11.27, "max": 10.11, "min": 14.67, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.76, "avg": 0.88, "max": 0.83, "min": 0.93, "cnt": 2}, "forward-send-backward-recv":{"total": 586.79, "avg": 19.56, "max": 1.12, "min": 221.26, "cnt": 30}, "backward-compute":{"total": 1473.79, "avg": 46.06, "max": 43.95, "min": 47.80, "cnt": 32}, "MoE_L3_bwd":{"total": 363.05, "avg": 11.35, "max": 10.21, "min": 13.03, "cnt": 32}, "MoE_L2_bwd":{"total": 319.73, "avg": 9.99, "max": 8.43, "min": 10.84, "cnt": 32}, "MoE_L1_bwd":{"total": 271.86, "avg": 8.50, "max": 8.07, "min": 8.78, "cnt": 32}, "MoE_L0_bwd":{"total": 300.93, "avg": 9.40, "max": 8.75, "min": 10.10, "cnt": 32}, "backward-send-forward-recv":{"total": 2709.41, "avg": 93.43, "max": 1.97, "min": 701.87, "cnt": 29}, "backward-send":{"total": 2.75, "avg": 0.92, "max": 0.74, "min": 1.13, "cnt": 3}, "backward-recv":{"total": 224.28, "avg": 112.14, "max": 78.38, "min": 145.90, "cnt": 2}, "backward-params-all-reduce":{"total": 489.16, "avg": 489.16, "max": 489.16, "min": 489.16, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 233.64, "avg": 233.64, "max": 233.64, "min": 233.64, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 193.87, "avg": 193.87, "max": 193.87, "min": 193.87, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.40, "avg": 3.40, "max": 3.40, "min": 3.40, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 103, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 91.88, "avg": 30.63, "max": 7.63, "min": 73.30, "cnt": 3}, "forward-compute":{"total": 1801.96, "avg": 56.31, "max": 49.58, "min": 62.94, "cnt": 32}, "fwd-compute":{"total": 1798.77, "avg": 56.21, "max": 49.50, "min": 62.81, "cnt": 32}, "batch-generator":{"total": 42.58, "avg": 1.33, "max": 0.68, "min": 2.69, "cnt": 32}, "fwd-embedding":{"total": 0.65, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1742.78, "avg": 54.46, "max": 48.31, "min": 60.72, "cnt": 32}, "fwd-layernorm":{"total": 10.09, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 107.49, "avg": 0.84, "max": 0.74, "min": 1.51, "cnt": 128}, "fwd-misc":{"total": 21.55, "avg": 0.17, "max": 0.11, "min": 0.54, "cnt": 128}, "fwd-MLP":{"total": 1582.07, "avg": 12.36, "max": 10.39, "min": 18.77, "cnt": 128}, "MoE_L0_fwd":{"total": 481.25, "avg": 15.04, "max": 11.30, "min": 18.70, "cnt": 32}, "MoEMLP":{"total": 1565.20, "avg": 12.23, "max": 10.29, "min": 18.66, "cnt": 128}, "MoE_L1_fwd":{"total": 375.32, "avg": 11.73, "max": 10.71, "min": 13.25, "cnt": 32}, "MoE_L2_fwd":{"total": 357.94, "avg": 11.19, "max": 10.46, "min": 12.71, "cnt": 32}, "MoE_L3_fwd":{"total": 356.85, "avg": 11.15, "max": 10.33, "min": 17.38, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.55, "avg": 0.77, "max": 0.69, "min": 0.86, "cnt": 2}, "forward-send-backward-recv":{"total": 630.53, "avg": 21.02, "max": 1.73, "min": 283.45, "cnt": 30}, "backward-compute":{"total": 1487.79, "avg": 46.49, "max": 44.43, "min": 50.04, "cnt": 32}, "MoE_L3_bwd":{"total": 362.36, "avg": 11.32, "max": 10.14, "min": 12.29, "cnt": 32}, "MoE_L2_bwd":{"total": 325.04, "avg": 10.16, "max": 9.53, "min": 10.81, "cnt": 32}, "MoE_L1_bwd":{"total": 285.11, "avg": 8.91, "max": 8.39, "min": 11.66, "cnt": 32}, "MoE_L0_bwd":{"total": 297.94, "avg": 9.31, "max": 8.76, "min": 10.52, "cnt": 32}, "backward-send-forward-recv":{"total": 2990.35, "avg": 103.12, "max": 2.00, "min": 623.96, "cnt": 29}, "backward-send":{"total": 2.86, "avg": 0.95, "max": 0.86, "min": 1.06, "cnt": 3}, "backward-recv":{"total": 225.45, "avg": 112.73, "max": 68.02, "min": 157.43, "cnt": 2}, "backward-params-all-reduce":{"total": 489.16, "avg": 489.16, "max": 489.16, "min": 489.16, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 233.91, "avg": 233.91, "max": 233.91, "min": 233.91, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 194.00, "avg": 194.00, "max": 194.00, "min": 194.00, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.58, "avg": 3.58, "max": 3.58, "min": 3.58, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 104, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 74.32, "avg": 24.77, "max": 1.64, "min": 68.02, "cnt": 3}, "forward-compute":{"total": 1796.57, "avg": 56.14, "max": 48.45, "min": 66.41, "cnt": 32}, "fwd-compute":{"total": 1793.56, "avg": 56.05, "max": 48.38, "min": 66.33, "cnt": 32}, "batch-generator":{"total": 38.23, "avg": 1.19, "max": 0.70, "min": 2.57, "cnt": 32}, "fwd-embedding":{"total": 0.54, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1742.70, "avg": 54.46, "max": 47.31, "min": 64.43, "cnt": 32}, "fwd-layernorm":{"total": 9.38, "avg": 0.07, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 105.83, "avg": 0.83, "max": 0.74, "min": 1.45, "cnt": 128}, "fwd-misc":{"total": 20.15, "avg": 0.16, "max": 0.11, "min": 0.33, "cnt": 128}, "fwd-MLP":{"total": 1586.80, "avg": 12.40, "max": 10.34, "min": 20.32, "cnt": 128}, "MoE_L0_fwd":{"total": 467.38, "avg": 14.61, "max": 10.94, "min": 20.09, "cnt": 32}, "MoEMLP":{"total": 1570.23, "avg": 12.27, "max": 10.23, "min": 20.04, "cnt": 128}, "MoE_L1_fwd":{"total": 389.47, "avg": 12.17, "max": 10.27, "min": 16.30, "cnt": 32}, "MoE_L2_fwd":{"total": 372.25, "avg": 11.63, "max": 10.65, "min": 14.31, "cnt": 32}, "MoE_L3_fwd":{"total": 347.07, "avg": 10.85, "max": 10.34, "min": 12.48, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 4.20, "avg": 2.10, "max": 0.91, "min": 3.28, "cnt": 2}, "forward-send-backward-recv":{"total": 181.51, "avg": 6.05, "max": 1.22, "min": 105.53, "cnt": 30}, "backward-compute":{"total": 1510.18, "avg": 47.19, "max": 45.30, "min": 49.19, "cnt": 32}, "MoE_L3_bwd":{"total": 371.47, "avg": 11.61, "max": 10.67, "min": 13.02, "cnt": 32}, "MoE_L2_bwd":{"total": 329.90, "avg": 10.31, "max": 9.68, "min": 11.30, "cnt": 32}, "MoE_L1_bwd":{"total": 280.36, "avg": 8.76, "max": 8.31, "min": 9.23, "cnt": 32}, "MoE_L0_bwd":{"total": 310.66, "avg": 9.71, "max": 9.08, "min": 11.78, "cnt": 32}, "backward-send-forward-recv":{"total": 2955.46, "avg": 101.91, "max": 2.38, "min": 538.38, "cnt": 29}, "backward-send":{"total": 2.99, "avg": 1.00, "max": 0.68, "min": 1.18, "cnt": 3}, "backward-recv":{"total": 133.37, "avg": 66.68, "max": 64.25, "min": 69.12, "cnt": 2}, "backward-params-all-reduce":{"total": 485.77, "avg": 485.77, "max": 485.77, "min": 485.77, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 236.26, "avg": 236.26, "max": 236.26, "min": 236.26, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 196.32, "avg": 196.32, "max": 196.32, "min": 196.32, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.54, "avg": 3.54, "max": 3.54, "min": 3.54, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 105, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 81.08, "avg": 27.03, "max": 1.57, "min": 68.98, "cnt": 3}, "forward-compute":{"total": 1856.63, "avg": 58.02, "max": 50.04, "min": 66.72, "cnt": 32}, "fwd-compute":{"total": 1853.23, "avg": 57.91, "max": 49.97, "min": 66.63, "cnt": 32}, "batch-generator":{"total": 47.07, "avg": 1.47, "max": 0.67, "min": 4.62, "cnt": 32}, "fwd-embedding":{"total": 0.60, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1792.98, "avg": 56.03, "max": 48.98, "min": 64.90, "cnt": 32}, "fwd-layernorm":{"total": 10.12, "avg": 0.08, "max": 0.06, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 111.26, "avg": 0.87, "max": 0.74, "min": 1.84, "cnt": 128}, "fwd-misc":{"total": 21.50, "avg": 0.17, "max": 0.11, "min": 0.41, "cnt": 128}, "fwd-MLP":{"total": 1628.46, "avg": 12.72, "max": 10.32, "min": 20.69, "cnt": 128}, "MoE_L0_fwd":{"total": 480.76, "avg": 15.02, "max": 11.27, "min": 20.61, "cnt": 32}, "MoEMLP":{"total": 1611.57, "avg": 12.59, "max": 10.21, "min": 20.56, "cnt": 128}, "MoE_L1_fwd":{"total": 398.01, "avg": 12.44, "max": 10.73, "min": 17.39, "cnt": 32}, "MoE_L2_fwd":{"total": 388.95, "avg": 12.15, "max": 10.91, "min": 16.54, "cnt": 32}, "MoE_L3_fwd":{"total": 350.03, "avg": 10.94, "max": 10.25, "min": 12.32, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.61, "avg": 0.02, "max": 0.02, "min": 0.04, "cnt": 32}, "forward-send":{"total": 1.59, "avg": 0.80, "max": 0.69, "min": 0.90, "cnt": 2}, "forward-send-backward-recv":{"total": 177.72, "avg": 5.92, "max": 1.08, "min": 103.17, "cnt": 30}, "backward-compute":{"total": 1505.72, "avg": 47.05, "max": 44.86, "min": 49.90, "cnt": 32}, "MoE_L3_bwd":{"total": 365.77, "avg": 11.43, "max": 10.38, "min": 12.91, "cnt": 32}, "MoE_L2_bwd":{"total": 332.55, "avg": 10.39, "max": 9.53, "min": 11.20, "cnt": 32}, "MoE_L1_bwd":{"total": 284.13, "avg": 8.88, "max": 8.27, "min": 11.68, "cnt": 32}, "MoE_L0_bwd":{"total": 303.90, "avg": 9.50, "max": 8.55, "min": 10.08, "cnt": 32}, "backward-send-forward-recv":{"total": 4568.65, "avg": 157.54, "max": 2.08, "min": 610.31, "cnt": 29}, "backward-send":{"total": 3.10, "avg": 1.03, "max": 0.90, "min": 1.17, "cnt": 3}, "backward-recv":{"total": 138.94, "avg": 69.47, "max": 68.44, "min": 70.50, "cnt": 2}, "backward-params-all-reduce":{"total": 491.39, "avg": 491.39, "max": 491.39, "min": 491.39, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 236.48, "avg": 236.48, "max": 236.48, "min": 236.48, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.40, "avg": 3.40, "max": 3.40, "min": 3.40, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 196.53, "avg": 196.53, "max": 196.53, "min": 196.53, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.54, "avg": 3.54, "max": 3.54, "min": 3.54, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 106, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 82.39, "avg": 27.46, "max": 1.80, "min": 73.59, "cnt": 3}, "forward-compute":{"total": 1831.64, "avg": 57.24, "max": 50.40, "min": 66.35, "cnt": 32}, "fwd-compute":{"total": 1828.58, "avg": 57.14, "max": 50.33, "min": 66.26, "cnt": 32}, "batch-generator":{"total": 48.95, "avg": 1.53, "max": 0.72, "min": 3.61, "cnt": 32}, "fwd-embedding":{"total": 0.62, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1766.60, "avg": 55.21, "max": 49.22, "min": 62.58, "cnt": 32}, "fwd-layernorm":{"total": 9.94, "avg": 0.08, "max": 0.06, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 107.67, "avg": 0.84, "max": 0.74, "min": 2.30, "cnt": 128}, "fwd-misc":{"total": 20.75, "avg": 0.16, "max": 0.11, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1607.20, "avg": 12.56, "max": 10.37, "min": 20.26, "cnt": 128}, "MoE_L0_fwd":{"total": 475.06, "avg": 14.85, "max": 11.52, "min": 20.18, "cnt": 32}, "MoEMLP":{"total": 1590.43, "avg": 12.43, "max": 10.26, "min": 20.14, "cnt": 128}, "MoE_L1_fwd":{"total": 383.33, "avg": 11.98, "max": 10.33, "min": 15.77, "cnt": 32}, "MoE_L2_fwd":{"total": 378.31, "avg": 11.82, "max": 10.78, "min": 14.93, "cnt": 32}, "MoE_L3_fwd":{"total": 359.85, "avg": 11.25, "max": 10.30, "min": 13.91, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.61, "avg": 0.80, "max": 0.67, "min": 0.93, "cnt": 2}, "forward-send-backward-recv":{"total": 247.93, "avg": 8.26, "max": 1.33, "min": 177.03, "cnt": 30}, "backward-compute":{"total": 1521.47, "avg": 47.55, "max": 45.85, "min": 49.59, "cnt": 32}, "MoE_L3_bwd":{"total": 364.47, "avg": 11.39, "max": 10.21, "min": 12.37, "cnt": 32}, "MoE_L2_bwd":{"total": 337.92, "avg": 10.56, "max": 9.97, "min": 11.60, "cnt": 32}, "MoE_L1_bwd":{"total": 282.28, "avg": 8.82, "max": 8.44, "min": 9.67, "cnt": 32}, "MoE_L0_bwd":{"total": 318.33, "avg": 9.95, "max": 9.42, "min": 11.77, "cnt": 32}, "backward-send-forward-recv":{"total": 2741.35, "avg": 94.53, "max": 2.18, "min": 432.91, "cnt": 29}, "backward-send":{"total": 2.62, "avg": 0.87, "max": 0.86, "min": 0.88, "cnt": 3}, "backward-recv":{"total": 137.33, "avg": 68.67, "max": 68.39, "min": 68.94, "cnt": 2}, "backward-params-all-reduce":{"total": 486.40, "avg": 486.40, "max": 486.40, "min": 486.40, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 242.96, "avg": 242.96, "max": 242.96, "min": 242.96, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.47, "avg": 3.47, "max": 3.47, "min": 3.47, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 202.98, "avg": 202.98, "max": 202.98, "min": 202.98, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 107, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 83.01, "avg": 27.67, "max": 1.65, "min": 79.68, "cnt": 3}, "forward-compute":{"total": 1830.53, "avg": 57.20, "max": 51.55, "min": 65.40, "cnt": 32}, "fwd-compute":{"total": 1827.43, "avg": 57.11, "max": 51.48, "min": 65.32, "cnt": 32}, "batch-generator":{"total": 37.68, "avg": 1.18, "max": 0.63, "min": 2.06, "cnt": 32}, "fwd-embedding":{"total": 0.58, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1777.58, "avg": 55.55, "max": 49.72, "min": 62.79, "cnt": 32}, "fwd-layernorm":{"total": 9.78, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 105.32, "avg": 0.82, "max": 0.74, "min": 1.44, "cnt": 128}, "fwd-misc":{"total": 20.78, "avg": 0.16, "max": 0.11, "min": 0.38, "cnt": 128}, "fwd-MLP":{"total": 1620.76, "avg": 12.66, "max": 10.19, "min": 22.58, "cnt": 128}, "MoE_L0_fwd":{"total": 497.74, "avg": 15.55, "max": 12.03, "min": 22.43, "cnt": 32}, "MoEMLP":{"total": 1604.10, "avg": 12.53, "max": 10.07, "min": 22.35, "cnt": 128}, "MoE_L1_fwd":{"total": 375.97, "avg": 11.75, "max": 10.69, "min": 15.75, "cnt": 32}, "MoE_L2_fwd":{"total": 378.10, "avg": 11.82, "max": 10.75, "min": 14.32, "cnt": 32}, "MoE_L3_fwd":{"total": 358.36, "avg": 11.20, "max": 10.11, "min": 15.42, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.25, "avg": 0.63, "max": 0.59, "min": 0.66, "cnt": 2}, "forward-send-backward-recv":{"total": 164.71, "avg": 5.49, "max": 1.30, "min": 89.54, "cnt": 30}, "backward-compute":{"total": 1516.79, "avg": 47.40, "max": 45.99, "min": 49.00, "cnt": 32}, "MoE_L3_bwd":{"total": 362.62, "avg": 11.33, "max": 9.99, "min": 12.35, "cnt": 32}, "MoE_L2_bwd":{"total": 336.05, "avg": 10.50, "max": 9.40, "min": 12.35, "cnt": 32}, "MoE_L1_bwd":{"total": 283.14, "avg": 8.85, "max": 8.16, "min": 9.18, "cnt": 32}, "MoE_L0_bwd":{"total": 314.45, "avg": 9.83, "max": 9.33, "min": 10.69, "cnt": 32}, "backward-send-forward-recv":{"total": 2993.95, "avg": 103.24, "max": 1.97, "min": 511.50, "cnt": 29}, "backward-send":{"total": 3.00, "avg": 1.00, "max": 0.89, "min": 1.15, "cnt": 3}, "backward-recv":{"total": 128.93, "avg": 64.47, "max": 59.72, "min": 69.21, "cnt": 2}, "backward-params-all-reduce":{"total": 487.63, "avg": 487.63, "max": 487.63, "min": 487.63, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 230.83, "avg": 230.83, "max": 230.83, "min": 230.83, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 191.05, "avg": 191.05, "max": 191.05, "min": 191.05, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}}}
{"type":"time", "iteration": 108, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 87.10, "avg": 29.03, "max": 1.44, "min": 83.23, "cnt": 3}, "forward-compute":{"total": 1766.09, "avg": 55.19, "max": 49.61, "min": 65.84, "cnt": 32}, "fwd-compute":{"total": 1762.88, "avg": 55.09, "max": 49.52, "min": 65.70, "cnt": 32}, "batch-generator":{"total": 38.56, "avg": 1.21, "max": 0.62, "min": 2.36, "cnt": 32}, "fwd-embedding":{"total": 0.60, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1711.88, "avg": 53.50, "max": 48.11, "min": 63.62, "cnt": 32}, "fwd-layernorm":{"total": 9.72, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 106.33, "avg": 0.83, "max": 0.74, "min": 1.45, "cnt": 128}, "fwd-misc":{"total": 20.28, "avg": 0.16, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1554.97, "avg": 12.15, "max": 10.31, "min": 19.92, "cnt": 128}, "MoE_L0_fwd":{"total": 456.02, "avg": 14.25, "max": 11.45, "min": 19.84, "cnt": 32}, "MoEMLP":{"total": 1538.78, "avg": 12.02, "max": 10.21, "min": 19.80, "cnt": 128}, "MoE_L1_fwd":{"total": 363.30, "avg": 11.35, "max": 10.52, "min": 12.81, "cnt": 32}, "MoE_L2_fwd":{"total": 377.67, "avg": 11.80, "max": 10.89, "min": 17.48, "cnt": 32}, "MoE_L3_fwd":{"total": 347.67, "avg": 10.86, "max": 10.25, "min": 14.81, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 4.94, "avg": 2.47, "max": 0.92, "min": 4.02, "cnt": 2}, "forward-send-backward-recv":{"total": 1004.66, "avg": 33.49, "max": 1.24, "min": 212.80, "cnt": 30}, "backward-compute":{"total": 1519.73, "avg": 47.49, "max": 45.66, "min": 51.38, "cnt": 32}, "MoE_L3_bwd":{"total": 365.95, "avg": 11.44, "max": 10.31, "min": 13.56, "cnt": 32}, "MoE_L2_bwd":{"total": 342.86, "avg": 10.71, "max": 9.97, "min": 11.52, "cnt": 32}, "MoE_L1_bwd":{"total": 282.92, "avg": 8.84, "max": 8.26, "min": 10.08, "cnt": 32}, "MoE_L0_bwd":{"total": 310.44, "avg": 9.70, "max": 9.16, "min": 12.97, "cnt": 32}, "backward-send-forward-recv":{"total": 2287.29, "avg": 78.87, "max": 2.36, "min": 588.27, "cnt": 29}, "backward-send":{"total": 3.08, "avg": 1.03, "max": 0.83, "min": 1.15, "cnt": 3}, "backward-recv":{"total": 304.82, "avg": 152.41, "max": 66.39, "min": 238.43, "cnt": 2}, "backward-params-all-reduce":{"total": 486.74, "avg": 486.74, "max": 486.74, "min": 486.74, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 234.90, "avg": 234.90, "max": 234.90, "min": 234.90, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 194.90, "avg": 194.90, "max": 194.90, "min": 194.90, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.51, "avg": 3.51, "max": 3.51, "min": 3.51, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 109, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 77.18, "avg": 25.73, "max": 1.20, "min": 74.42, "cnt": 3}, "forward-compute":{"total": 1814.42, "avg": 56.70, "max": 48.90, "min": 63.01, "cnt": 32}, "fwd-compute":{"total": 1811.31, "avg": 56.60, "max": 48.84, "min": 62.92, "cnt": 32}, "batch-generator":{"total": 50.65, "avg": 1.58, "max": 0.70, "min": 3.72, "cnt": 32}, "fwd-embedding":{"total": 0.62, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1748.43, "avg": 54.64, "max": 47.85, "min": 60.60, "cnt": 32}, "fwd-layernorm":{"total": 9.65, "avg": 0.08, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 105.83, "avg": 0.83, "max": 0.74, "min": 1.52, "cnt": 128}, "fwd-misc":{"total": 20.58, "avg": 0.16, "max": 0.12, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1591.90, "avg": 12.44, "max": 10.19, "min": 19.94, "cnt": 128}, "MoE_L0_fwd":{"total": 482.66, "avg": 15.08, "max": 11.04, "min": 19.87, "cnt": 32}, "MoEMLP":{"total": 1575.74, "avg": 12.31, "max": 10.08, "min": 19.82, "cnt": 128}, "MoE_L1_fwd":{"total": 376.93, "avg": 11.78, "max": 10.55, "min": 14.42, "cnt": 32}, "MoE_L2_fwd":{"total": 370.12, "avg": 11.57, "max": 10.73, "min": 14.42, "cnt": 32}, "MoE_L3_fwd":{"total": 351.99, "avg": 11.00, "max": 10.12, "min": 16.60, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 11.91, "avg": 5.95, "max": 0.78, "min": 11.13, "cnt": 2}, "forward-send-backward-recv":{"total": 715.17, "avg": 23.84, "max": 1.53, "min": 263.39, "cnt": 30}, "backward-compute":{"total": 1505.16, "avg": 47.04, "max": 45.40, "min": 51.36, "cnt": 32}, "MoE_L3_bwd":{"total": 365.06, "avg": 11.41, "max": 10.86, "min": 13.32, "cnt": 32}, "MoE_L2_bwd":{"total": 326.88, "avg": 10.22, "max": 9.55, "min": 11.16, "cnt": 32}, "MoE_L1_bwd":{"total": 286.23, "avg": 8.94, "max": 8.56, "min": 9.37, "cnt": 32}, "MoE_L0_bwd":{"total": 308.96, "avg": 9.66, "max": 9.08, "min": 12.28, "cnt": 32}, "backward-send-forward-recv":{"total": 3807.18, "avg": 131.28, "max": 2.22, "min": 1044.41, "cnt": 29}, "backward-send":{"total": 2.88, "avg": 0.96, "max": 0.82, "min": 1.20, "cnt": 3}, "backward-recv":{"total": 521.15, "avg": 260.57, "max": 67.29, "min": 453.86, "cnt": 2}, "backward-params-all-reduce":{"total": 484.74, "avg": 484.74, "max": 484.74, "min": 484.74, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 238.49, "avg": 238.49, "max": 238.49, "min": 238.49, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 198.79, "avg": 198.79, "max": 198.79, "min": 198.79, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.33, "avg": 3.33, "max": 3.33, "min": 3.33, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.41, "avg": 3.41, "max": 3.41, "min": 3.41, "cnt": 1}}}
{"type":"time", "iteration": 110, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 345.34, "avg": 115.11, "max": 1.00, "min": 343.00, "cnt": 3}, "forward-compute":{"total": 2023.43, "avg": 63.23, "max": 47.93, "min": 284.46, "cnt": 32}, "fwd-compute":{"total": 2020.38, "avg": 63.14, "max": 47.86, "min": 284.37, "cnt": 32}, "batch-generator":{"total": 42.87, "avg": 1.34, "max": 0.69, "min": 2.42, "cnt": 32}, "fwd-embedding":{"total": 0.64, "avg": 0.02, "max": 0.01, "min": 0.06, "cnt": 32}, "fwd-encoder":{"total": 1964.58, "avg": 61.39, "max": 46.86, "min": 283.21, "cnt": 32}, "fwd-layernorm":{"total": 9.75, "avg": 0.08, "max": 0.06, "min": 0.18, "cnt": 128}, "fwd-attn":{"total": 108.56, "avg": 0.85, "max": 0.74, "min": 1.46, "cnt": 128}, "fwd-misc":{"total": 20.87, "avg": 0.16, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1804.30, "avg": 14.10, "max": 9.38, "min": 129.32, "cnt": 128}, "MoE_L0_fwd":{"total": 584.18, "avg": 18.26, "max": 11.05, "min": 129.24, "cnt": 32}, "MoEMLP":{"total": 1787.62, "avg": 13.97, "max": 9.27, "min": 129.19, "cnt": 128}, "MoE_L1_fwd":{"total": 401.09, "avg": 12.53, "max": 10.60, "min": 16.80, "cnt": 32}, "MoE_L2_fwd":{"total": 363.01, "avg": 11.34, "max": 10.58, "min": 12.84, "cnt": 32}, "MoE_L3_fwd":{"total": 445.41, "avg": 13.92, "max": 9.31, "min": 125.62, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 290.42, "avg": 145.21, "max": 0.87, "min": 289.55, "cnt": 2}, "forward-send-backward-recv":{"total": 541.21, "avg": 18.04, "max": 1.29, "min": 235.68, "cnt": 30}, "backward-compute":{"total": 1426.48, "avg": 44.58, "max": 41.34, "min": 47.04, "cnt": 32}, "MoE_L3_bwd":{"total": 323.54, "avg": 10.11, "max": 8.58, "min": 11.67, "cnt": 32}, "MoE_L2_bwd":{"total": 329.26, "avg": 10.29, "max": 9.32, "min": 12.67, "cnt": 32}, "MoE_L1_bwd":{"total": 288.90, "avg": 9.03, "max": 8.67, "min": 9.40, "cnt": 32}, "MoE_L0_bwd":{"total": 267.65, "avg": 8.36, "max": 7.73, "min": 8.88, "cnt": 32}, "backward-send-forward-recv":{"total": 2606.16, "avg": 89.87, "max": 1.80, "min": 386.33, "cnt": 29}, "backward-send":{"total": 2.80, "avg": 0.93, "max": 0.74, "min": 1.04, "cnt": 3}, "backward-recv":{"total": 119.70, "avg": 59.85, "max": 59.58, "min": 60.13, "cnt": 2}, "backward-params-all-reduce":{"total": 484.65, "avg": 484.65, "max": 484.65, "min": 484.65, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 235.64, "avg": 235.64, "max": 235.64, "min": 235.64, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 195.90, "avg": 195.90, "max": 195.90, "min": 195.90, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.54, "avg": 3.54, "max": 3.54, "min": 3.54, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 111, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 85.96, "avg": 28.65, "max": 1.53, "min": 75.33, "cnt": 3}, "forward-compute":{"total": 1784.50, "avg": 55.77, "max": 49.16, "min": 65.90, "cnt": 32}, "fwd-compute":{"total": 1781.26, "avg": 55.66, "max": 49.09, "min": 65.82, "cnt": 32}, "batch-generator":{"total": 57.26, "avg": 1.79, "max": 0.66, "min": 4.65, "cnt": 32}, "fwd-embedding":{"total": 0.68, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1711.13, "avg": 53.47, "max": 48.05, "min": 60.72, "cnt": 32}, "fwd-layernorm":{"total": 10.35, "avg": 0.08, "max": 0.06, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 110.59, "avg": 0.86, "max": 0.74, "min": 1.69, "cnt": 128}, "fwd-misc":{"total": 22.43, "avg": 0.18, "max": 0.11, "min": 0.38, "cnt": 128}, "fwd-MLP":{"total": 1545.59, "avg": 12.07, "max": 9.79, "min": 17.23, "cnt": 128}, "MoE_L0_fwd":{"total": 434.73, "avg": 13.59, "max": 10.65, "min": 17.11, "cnt": 32}, "MoEMLP":{"total": 1528.30, "avg": 11.94, "max": 9.67, "min": 17.07, "cnt": 128}, "MoE_L1_fwd":{"total": 387.96, "avg": 12.12, "max": 11.10, "min": 16.02, "cnt": 32}, "MoE_L2_fwd":{"total": 383.56, "avg": 11.99, "max": 11.33, "min": 13.97, "cnt": 32}, "MoE_L3_fwd":{"total": 328.47, "avg": 10.26, "max": 9.72, "min": 11.16, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.79, "avg": 0.89, "max": 0.89, "min": 0.90, "cnt": 2}, "forward-send-backward-recv":{"total": 196.49, "avg": 6.55, "max": 1.28, "min": 109.87, "cnt": 30}, "backward-compute":{"total": 1487.76, "avg": 46.49, "max": 45.46, "min": 50.75, "cnt": 32}, "MoE_L3_bwd":{"total": 340.02, "avg": 10.63, "max": 9.73, "min": 15.21, "cnt": 32}, "MoE_L2_bwd":{"total": 349.73, "avg": 10.93, "max": 10.31, "min": 11.68, "cnt": 32}, "MoE_L1_bwd":{"total": 300.51, "avg": 9.39, "max": 8.93, "min": 9.76, "cnt": 32}, "MoE_L0_bwd":{"total": 277.02, "avg": 8.66, "max": 8.23, "min": 8.99, "cnt": 32}, "backward-send-forward-recv":{"total": 2125.68, "avg": 73.30, "max": 2.16, "min": 229.14, "cnt": 29}, "backward-send":{"total": 3.04, "avg": 1.01, "max": 0.96, "min": 1.12, "cnt": 3}, "backward-recv":{"total": 128.44, "avg": 64.22, "max": 55.56, "min": 72.88, "cnt": 2}, "backward-params-all-reduce":{"total": 483.85, "avg": 483.85, "max": 483.85, "min": 483.85, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 237.58, "avg": 237.58, "max": 237.58, "min": 237.58, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 193.45, "avg": 193.45, "max": 193.45, "min": 193.45, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.86, "avg": 6.86, "max": 6.86, "min": 6.86, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 112, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 76.87, "avg": 25.62, "max": 0.83, "min": 74.59, "cnt": 3}, "forward-compute":{"total": 1894.92, "avg": 59.22, "max": 52.07, "min": 70.40, "cnt": 32}, "fwd-compute":{"total": 1891.80, "avg": 59.12, "max": 51.99, "min": 70.31, "cnt": 32}, "batch-generator":{"total": 38.92, "avg": 1.22, "max": 0.75, "min": 2.96, "cnt": 32}, "fwd-embedding":{"total": 0.56, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1840.33, "avg": 57.51, "max": 50.68, "min": 69.12, "cnt": 32}, "fwd-layernorm":{"total": 9.93, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 108.75, "avg": 0.85, "max": 0.75, "min": 1.59, "cnt": 128}, "fwd-misc":{"total": 21.00, "avg": 0.16, "max": 0.12, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1679.41, "avg": 13.12, "max": 9.75, "min": 24.49, "cnt": 128}, "MoE_L0_fwd":{"total": 513.63, "avg": 16.05, "max": 11.73, "min": 24.40, "cnt": 32}, "MoEMLP":{"total": 1662.64, "avg": 12.99, "max": 9.64, "min": 24.36, "cnt": 128}, "MoE_L1_fwd":{"total": 419.41, "avg": 13.11, "max": 11.58, "min": 16.54, "cnt": 32}, "MoE_L2_fwd":{"total": 392.82, "avg": 12.28, "max": 11.43, "min": 15.75, "cnt": 32}, "MoE_L3_fwd":{"total": 342.93, "avg": 10.72, "max": 9.68, "min": 13.63, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.55, "avg": 0.77, "max": 0.53, "min": 1.01, "cnt": 2}, "forward-send-backward-recv":{"total": 497.14, "avg": 16.57, "max": 1.78, "min": 131.21, "cnt": 30}, "backward-compute":{"total": 1501.11, "avg": 46.91, "max": 43.90, "min": 49.15, "cnt": 32}, "MoE_L3_bwd":{"total": 339.80, "avg": 10.62, "max": 9.65, "min": 11.30, "cnt": 32}, "MoE_L2_bwd":{"total": 342.02, "avg": 10.69, "max": 9.79, "min": 11.40, "cnt": 32}, "MoE_L1_bwd":{"total": 319.35, "avg": 9.98, "max": 9.21, "min": 12.70, "cnt": 32}, "MoE_L0_bwd":{"total": 279.39, "avg": 8.73, "max": 8.14, "min": 10.02, "cnt": 32}, "backward-send-forward-recv":{"total": 1727.58, "avg": 59.57, "max": 1.11, "min": 238.57, "cnt": 29}, "backward-send":{"total": 3.35, "avg": 1.12, "max": 1.09, "min": 1.14, "cnt": 3}, "backward-recv":{"total": 319.61, "avg": 159.80, "max": 69.54, "min": 250.06, "cnt": 2}, "backward-params-all-reduce":{"total": 486.10, "avg": 486.10, "max": 486.10, "min": 486.10, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 239.45, "avg": 239.45, "max": 239.45, "min": 239.45, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.41, "avg": 3.41, "max": 3.41, "min": 3.41, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 196.73, "avg": 196.73, "max": 196.73, "min": 196.73, "cnt": 1}, "optimizer-clip-main-grad":{"total": 5.79, "avg": 5.79, "max": 5.79, "min": 5.79, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 113, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 67.74, "avg": 22.58, "max": 1.39, "min": 64.76, "cnt": 3}, "forward-compute":{"total": 1957.44, "avg": 61.17, "max": 49.52, "min": 202.01, "cnt": 32}, "fwd-compute":{"total": 1954.27, "avg": 61.07, "max": 49.45, "min": 201.90, "cnt": 32}, "batch-generator":{"total": 39.59, "avg": 1.24, "max": 0.67, "min": 2.82, "cnt": 32}, "fwd-embedding":{"total": 0.61, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1902.02, "avg": 59.44, "max": 48.37, "min": 200.10, "cnt": 32}, "fwd-layernorm":{"total": 9.96, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 110.68, "avg": 0.86, "max": 0.74, "min": 2.13, "cnt": 128}, "fwd-misc":{"total": 21.75, "avg": 0.17, "max": 0.11, "min": 0.42, "cnt": 128}, "fwd-MLP":{"total": 1738.20, "avg": 13.58, "max": 9.14, "min": 155.45, "cnt": 128}, "MoE_L0_fwd":{"total": 622.23, "avg": 19.44, "max": 10.35, "min": 155.32, "cnt": 32}, "MoEMLP":{"total": 1720.87, "avg": 13.44, "max": 9.04, "min": 155.26, "cnt": 128}, "MoE_L1_fwd":{"total": 409.79, "avg": 12.81, "max": 11.34, "min": 16.46, "cnt": 32}, "MoE_L2_fwd":{"total": 371.83, "avg": 11.62, "max": 10.81, "min": 14.20, "cnt": 32}, "MoE_L3_fwd":{"total": 323.39, "avg": 10.11, "max": 9.08, "min": 12.84, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.98, "avg": 0.99, "max": 0.96, "min": 1.02, "cnt": 2}, "forward-send-backward-recv":{"total": 201.14, "avg": 6.70, "max": 1.75, "min": 98.34, "cnt": 30}, "backward-compute":{"total": 1496.41, "avg": 46.76, "max": 44.21, "min": 48.51, "cnt": 32}, "MoE_L3_bwd":{"total": 335.35, "avg": 10.48, "max": 9.23, "min": 13.47, "cnt": 32}, "MoE_L2_bwd":{"total": 339.48, "avg": 10.61, "max": 9.82, "min": 11.30, "cnt": 32}, "MoE_L1_bwd":{"total": 327.51, "avg": 10.23, "max": 9.75, "min": 10.70, "cnt": 32}, "MoE_L0_bwd":{"total": 277.36, "avg": 8.67, "max": 8.35, "min": 9.08, "cnt": 32}, "backward-send-forward-recv":{"total": 3166.42, "avg": 109.19, "max": 1.81, "min": 710.71, "cnt": 29}, "backward-send":{"total": 2.72, "avg": 0.91, "max": 0.70, "min": 1.11, "cnt": 3}, "backward-recv":{"total": 114.02, "avg": 57.01, "max": 52.57, "min": 61.44, "cnt": 2}, "backward-params-all-reduce":{"total": 491.39, "avg": 491.39, "max": 491.39, "min": 491.39, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.04, "avg": 0.04, "max": 0.04, "min": 0.04, "cnt": 1}, "optimizer":{"total": 231.42, "avg": 231.42, "max": 231.42, "min": 231.42, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 191.64, "avg": 191.64, "max": 191.64, "min": 191.64, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.29, "avg": 3.29, "max": 3.29, "min": 3.29, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.49, "avg": 3.49, "max": 3.49, "min": 3.49, "cnt": 1}}}
{"type":"time", "iteration": 114, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 74.25, "avg": 24.75, "max": 1.31, "min": 66.58, "cnt": 3}, "forward-compute":{"total": 1841.20, "avg": 57.54, "max": 48.84, "min": 67.59, "cnt": 32}, "fwd-compute":{"total": 1837.99, "avg": 57.44, "max": 48.77, "min": 67.52, "cnt": 32}, "batch-generator":{"total": 40.13, "avg": 1.25, "max": 0.66, "min": 2.13, "cnt": 32}, "fwd-embedding":{"total": 0.64, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1784.54, "avg": 55.77, "max": 47.75, "min": 65.71, "cnt": 32}, "fwd-layernorm":{"total": 9.95, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 109.08, "avg": 0.85, "max": 0.74, "min": 1.63, "cnt": 128}, "fwd-misc":{"total": 21.41, "avg": 0.17, "max": 0.11, "min": 0.38, "cnt": 128}, "fwd-MLP":{"total": 1622.81, "avg": 12.68, "max": 9.68, "min": 21.50, "cnt": 128}, "MoE_L0_fwd":{"total": 497.67, "avg": 15.55, "max": 10.42, "min": 21.42, "cnt": 32}, "MoEMLP":{"total": 1606.04, "avg": 12.55, "max": 9.58, "min": 21.38, "cnt": 128}, "MoE_L1_fwd":{"total": 414.23, "avg": 12.94, "max": 11.22, "min": 16.73, "cnt": 32}, "MoE_L2_fwd":{"total": 368.23, "avg": 11.51, "max": 10.66, "min": 15.72, "cnt": 32}, "MoE_L3_fwd":{"total": 332.05, "avg": 10.38, "max": 9.62, "min": 13.32, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.61, "avg": 0.02, "max": 0.02, "min": 0.06, "cnt": 32}, "forward-send":{"total": 2.00, "avg": 1.00, "max": 0.96, "min": 1.04, "cnt": 2}, "forward-send-backward-recv":{"total": 179.81, "avg": 5.99, "max": 1.28, "min": 106.03, "cnt": 30}, "backward-compute":{"total": 1492.03, "avg": 46.63, "max": 45.30, "min": 48.93, "cnt": 32}, "MoE_L3_bwd":{"total": 328.76, "avg": 10.27, "max": 9.37, "min": 11.47, "cnt": 32}, "MoE_L2_bwd":{"total": 337.60, "avg": 10.55, "max": 9.08, "min": 13.17, "cnt": 32}, "MoE_L1_bwd":{"total": 320.96, "avg": 10.03, "max": 9.63, "min": 10.41, "cnt": 32}, "MoE_L0_bwd":{"total": 285.44, "avg": 8.92, "max": 8.35, "min": 11.19, "cnt": 32}, "backward-send-forward-recv":{"total": 2109.91, "avg": 72.76, "max": 2.09, "min": 269.89, "cnt": 29}, "backward-send":{"total": 3.24, "avg": 1.08, "max": 1.05, "min": 1.10, "cnt": 3}, "backward-recv":{"total": 133.48, "avg": 66.74, "max": 64.88, "min": 68.61, "cnt": 2}, "backward-params-all-reduce":{"total": 487.47, "avg": 487.47, "max": 487.47, "min": 487.47, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 232.50, "avg": 232.50, "max": 232.50, "min": 232.50, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 192.64, "avg": 192.64, "max": 192.64, "min": 192.64, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.40, "avg": 3.40, "max": 3.40, "min": 3.40, "cnt": 1}}}
{"type":"time", "iteration": 115, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.12, "avg": 0.12, "max": 0.12, "min": 0.12, "cnt": 1}, "forward-recv":{"total": 75.39, "avg": 25.13, "max": 1.92, "min": 71.36, "cnt": 3}, "forward-compute":{"total": 1844.14, "avg": 57.63, "max": 48.27, "min": 65.99, "cnt": 32}, "fwd-compute":{"total": 1840.97, "avg": 57.53, "max": 48.20, "min": 65.90, "cnt": 32}, "batch-generator":{"total": 48.12, "avg": 1.50, "max": 0.69, "min": 3.39, "cnt": 32}, "fwd-embedding":{"total": 0.61, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1780.54, "avg": 55.64, "max": 47.22, "min": 64.61, "cnt": 32}, "fwd-layernorm":{"total": 10.08, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 108.52, "avg": 0.85, "max": 0.74, "min": 1.59, "cnt": 128}, "fwd-misc":{"total": 21.78, "avg": 0.17, "max": 0.12, "min": 0.53, "cnt": 128}, "fwd-MLP":{"total": 1618.65, "avg": 12.65, "max": 9.68, "min": 20.73, "cnt": 128}, "MoE_L0_fwd":{"total": 487.67, "avg": 15.24, "max": 10.35, "min": 20.65, "cnt": 32}, "MoEMLP":{"total": 1601.69, "avg": 12.51, "max": 9.56, "min": 20.60, "cnt": 128}, "MoE_L1_fwd":{"total": 411.04, "avg": 12.84, "max": 10.96, "min": 17.17, "cnt": 32}, "MoE_L2_fwd":{"total": 373.03, "avg": 11.66, "max": 10.80, "min": 14.60, "cnt": 32}, "MoE_L3_fwd":{"total": 336.21, "avg": 10.51, "max": 9.61, "min": 14.68, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.73, "avg": 0.87, "max": 0.84, "min": 0.89, "cnt": 2}, "forward-send-backward-recv":{"total": 296.91, "avg": 9.90, "max": 1.80, "min": 114.33, "cnt": 30}, "backward-compute":{"total": 1472.52, "avg": 46.02, "max": 44.17, "min": 47.28, "cnt": 32}, "MoE_L3_bwd":{"total": 328.13, "avg": 10.25, "max": 9.17, "min": 11.16, "cnt": 32}, "MoE_L2_bwd":{"total": 330.84, "avg": 10.34, "max": 9.64, "min": 11.08, "cnt": 32}, "MoE_L1_bwd":{"total": 315.06, "avg": 9.85, "max": 9.39, "min": 10.30, "cnt": 32}, "MoE_L0_bwd":{"total": 280.59, "avg": 8.77, "max": 8.50, "min": 9.54, "cnt": 32}, "backward-send-forward-recv":{"total": 3698.72, "avg": 127.54, "max": 2.00, "min": 505.78, "cnt": 29}, "backward-send":{"total": 2.82, "avg": 0.94, "max": 0.68, "min": 1.11, "cnt": 3}, "backward-recv":{"total": 124.49, "avg": 62.24, "max": 57.13, "min": 67.35, "cnt": 2}, "backward-params-all-reduce":{"total": 490.85, "avg": 490.85, "max": 490.85, "min": 490.85, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 262.02, "avg": 262.02, "max": 262.02, "min": 262.02, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 194.47, "avg": 194.47, "max": 194.47, "min": 194.47, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.34, "avg": 3.34, "max": 3.34, "min": 3.34, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.62, "avg": 3.62, "max": 3.62, "min": 3.62, "cnt": 1}}}
{"type":"time", "iteration": 116, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 145.96, "avg": 48.65, "max": 3.23, "min": 136.82, "cnt": 3}, "forward-compute":{"total": 1825.49, "avg": 57.05, "max": 49.26, "min": 65.78, "cnt": 32}, "fwd-compute":{"total": 1822.11, "avg": 56.94, "max": 49.19, "min": 65.69, "cnt": 32}, "batch-generator":{"total": 58.90, "avg": 1.84, "max": 0.73, "min": 3.67, "cnt": 32}, "fwd-embedding":{"total": 0.67, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1749.23, "avg": 54.66, "max": 48.10, "min": 62.21, "cnt": 32}, "fwd-layernorm":{"total": 10.80, "avg": 0.08, "max": 0.06, "min": 0.28, "cnt": 128}, "fwd-attn":{"total": 110.41, "avg": 0.86, "max": 0.74, "min": 2.12, "cnt": 128}, "fwd-misc":{"total": 21.79, "avg": 0.17, "max": 0.12, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1584.18, "avg": 12.38, "max": 9.80, "min": 23.09, "cnt": 128}, "MoE_L0_fwd":{"total": 471.99, "avg": 14.75, "max": 10.81, "min": 22.94, "cnt": 32}, "MoEMLP":{"total": 1567.12, "avg": 12.24, "max": 9.69, "min": 22.86, "cnt": 128}, "MoE_L1_fwd":{"total": 395.10, "avg": 12.35, "max": 11.01, "min": 15.71, "cnt": 32}, "MoE_L2_fwd":{"total": 373.75, "avg": 11.68, "max": 10.84, "min": 15.41, "cnt": 32}, "MoE_L3_fwd":{"total": 332.56, "avg": 10.39, "max": 9.73, "min": 13.92, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.62, "avg": 0.02, "max": 0.02, "min": 0.04, "cnt": 32}, "forward-send":{"total": 1.88, "avg": 0.94, "max": 0.94, "min": 0.95, "cnt": 2}, "forward-send-backward-recv":{"total": 366.35, "avg": 12.21, "max": 1.59, "min": 106.77, "cnt": 30}, "backward-compute":{"total": 1470.14, "avg": 45.94, "max": 44.26, "min": 50.06, "cnt": 32}, "MoE_L3_bwd":{"total": 332.56, "avg": 10.39, "max": 9.50, "min": 14.34, "cnt": 32}, "MoE_L2_bwd":{"total": 340.33, "avg": 10.64, "max": 9.71, "min": 12.16, "cnt": 32}, "MoE_L1_bwd":{"total": 310.70, "avg": 9.71, "max": 9.42, "min": 10.13, "cnt": 32}, "MoE_L0_bwd":{"total": 267.53, "avg": 8.36, "max": 7.92, "min": 8.95, "cnt": 32}, "backward-send-forward-recv":{"total": 5929.18, "avg": 204.45, "max": 1.83, "min": 954.77, "cnt": 29}, "backward-send":{"total": 2.97, "avg": 0.99, "max": 0.89, "min": 1.15, "cnt": 3}, "backward-recv":{"total": 123.06, "avg": 61.53, "max": 56.68, "min": 66.38, "cnt": 2}, "backward-params-all-reduce":{"total": 486.54, "avg": 486.54, "max": 486.54, "min": 486.54, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 233.27, "avg": 233.27, "max": 233.27, "min": 233.27, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.40, "avg": 3.40, "max": 3.40, "min": 3.40, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 193.35, "avg": 193.35, "max": 193.35, "min": 193.35, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.35, "avg": 3.35, "max": 3.35, "min": 3.35, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 117, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 79.08, "avg": 26.36, "max": 1.33, "min": 76.21, "cnt": 3}, "forward-compute":{"total": 1832.45, "avg": 57.26, "max": 49.48, "min": 62.84, "cnt": 32}, "fwd-compute":{"total": 1829.40, "avg": 57.17, "max": 49.38, "min": 62.76, "cnt": 32}, "batch-generator":{"total": 36.20, "avg": 1.13, "max": 0.62, "min": 2.43, "cnt": 32}, "fwd-embedding":{"total": 0.53, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1780.41, "avg": 55.64, "max": 48.06, "min": 61.05, "cnt": 32}, "fwd-layernorm":{"total": 9.56, "avg": 0.07, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 110.07, "avg": 0.86, "max": 0.75, "min": 2.58, "cnt": 128}, "fwd-misc":{"total": 21.59, "avg": 0.17, "max": 0.12, "min": 0.43, "cnt": 128}, "fwd-MLP":{"total": 1618.21, "avg": 12.64, "max": 9.91, "min": 22.30, "cnt": 128}, "MoE_L0_fwd":{"total": 509.84, "avg": 15.93, "max": 10.90, "min": 22.22, "cnt": 32}, "MoEMLP":{"total": 1601.78, "avg": 12.51, "max": 9.81, "min": 22.18, "cnt": 128}, "MoE_L1_fwd":{"total": 403.24, "avg": 12.60, "max": 11.27, "min": 14.32, "cnt": 32}, "MoE_L2_fwd":{"total": 367.80, "avg": 11.49, "max": 10.74, "min": 15.10, "cnt": 32}, "MoE_L3_fwd":{"total": 326.90, "avg": 10.22, "max": 9.84, "min": 11.28, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 3.92, "avg": 1.96, "max": 0.97, "min": 2.95, "cnt": 2}, "forward-send-backward-recv":{"total": 246.18, "avg": 8.21, "max": 1.55, "min": 103.20, "cnt": 30}, "backward-compute":{"total": 1480.76, "avg": 46.27, "max": 43.22, "min": 50.53, "cnt": 32}, "MoE_L3_bwd":{"total": 336.29, "avg": 10.51, "max": 8.23, "min": 12.66, "cnt": 32}, "MoE_L2_bwd":{"total": 332.37, "avg": 10.39, "max": 9.13, "min": 11.88, "cnt": 32}, "MoE_L1_bwd":{"total": 316.02, "avg": 9.88, "max": 9.13, "min": 12.29, "cnt": 32}, "MoE_L0_bwd":{"total": 275.53, "avg": 8.61, "max": 8.00, "min": 9.80, "cnt": 32}, "backward-send-forward-recv":{"total": 2894.38, "avg": 99.81, "max": 1.78, "min": 417.25, "cnt": 29}, "backward-send":{"total": 2.97, "avg": 0.99, "max": 0.95, "min": 1.06, "cnt": 3}, "backward-recv":{"total": 145.19, "avg": 72.60, "max": 70.83, "min": 74.36, "cnt": 2}, "backward-params-all-reduce":{"total": 484.84, "avg": 484.84, "max": 484.84, "min": 484.84, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 249.73, "avg": 249.73, "max": 249.73, "min": 249.73, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.40, "avg": 3.40, "max": 3.40, "min": 3.40, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 209.92, "avg": 209.92, "max": 209.92, "min": 209.92, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.30, "avg": 3.30, "max": 3.30, "min": 3.30, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 118, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 74.52, "avg": 24.84, "max": 1.13, "min": 71.95, "cnt": 3}, "forward-compute":{"total": 1771.77, "avg": 55.37, "max": 49.81, "min": 62.40, "cnt": 32}, "fwd-compute":{"total": 1768.64, "avg": 55.27, "max": 49.72, "min": 62.30, "cnt": 32}, "batch-generator":{"total": 41.48, "avg": 1.30, "max": 0.66, "min": 2.54, "cnt": 32}, "fwd-embedding":{"total": 0.56, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1714.59, "avg": 53.58, "max": 48.49, "min": 61.08, "cnt": 32}, "fwd-layernorm":{"total": 9.63, "avg": 0.08, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 110.05, "avg": 0.86, "max": 0.74, "min": 2.63, "cnt": 128}, "fwd-misc":{"total": 21.09, "avg": 0.16, "max": 0.11, "min": 0.48, "cnt": 128}, "fwd-MLP":{"total": 1552.47, "avg": 12.13, "max": 9.77, "min": 17.56, "cnt": 128}, "MoE_L0_fwd":{"total": 457.96, "avg": 14.31, "max": 10.81, "min": 17.47, "cnt": 32}, "MoEMLP":{"total": 1533.75, "avg": 11.98, "max": 9.67, "min": 17.42, "cnt": 128}, "MoE_L1_fwd":{"total": 388.24, "avg": 12.13, "max": 11.11, "min": 15.04, "cnt": 32}, "MoE_L2_fwd":{"total": 362.21, "avg": 11.32, "max": 10.75, "min": 13.89, "cnt": 32}, "MoE_L3_fwd":{"total": 331.44, "avg": 10.36, "max": 9.70, "min": 12.18, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.43, "avg": 0.72, "max": 0.51, "min": 0.92, "cnt": 2}, "forward-send-backward-recv":{"total": 229.61, "avg": 7.65, "max": 1.76, "min": 99.55, "cnt": 30}, "backward-compute":{"total": 1462.31, "avg": 45.70, "max": 43.68, "min": 47.83, "cnt": 32}, "MoE_L3_bwd":{"total": 331.16, "avg": 10.35, "max": 9.46, "min": 12.49, "cnt": 32}, "MoE_L2_bwd":{"total": 328.54, "avg": 10.27, "max": 9.48, "min": 11.01, "cnt": 32}, "MoE_L1_bwd":{"total": 312.29, "avg": 9.76, "max": 9.18, "min": 10.18, "cnt": 32}, "MoE_L0_bwd":{"total": 270.18, "avg": 8.44, "max": 7.91, "min": 9.03, "cnt": 32}, "backward-send-forward-recv":{"total": 2440.80, "avg": 84.17, "max": 2.07, "min": 305.57, "cnt": 29}, "backward-send":{"total": 3.29, "avg": 1.10, "max": 1.06, "min": 1.14, "cnt": 3}, "backward-recv":{"total": 358.62, "avg": 179.31, "max": 64.11, "min": 294.50, "cnt": 2}, "backward-params-all-reduce":{"total": 486.57, "avg": 486.57, "max": 486.57, "min": 486.57, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 228.97, "avg": 228.97, "max": 228.97, "min": 228.97, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 189.12, "avg": 189.12, "max": 189.12, "min": 189.12, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.26, "avg": 3.26, "max": 3.26, "min": 3.26, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.47, "avg": 3.47, "max": 3.47, "min": 3.47, "cnt": 1}}}
{"type":"time", "iteration": 119, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 73.77, "avg": 24.59, "max": 0.99, "min": 71.25, "cnt": 3}, "forward-compute":{"total": 1812.59, "avg": 56.64, "max": 50.08, "min": 68.07, "cnt": 32}, "fwd-compute":{"total": 1809.48, "avg": 56.55, "max": 50.01, "min": 67.99, "cnt": 32}, "batch-generator":{"total": 37.95, "avg": 1.19, "max": 0.75, "min": 2.02, "cnt": 32}, "fwd-embedding":{"total": 0.60, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1759.23, "avg": 54.98, "max": 48.60, "min": 66.82, "cnt": 32}, "fwd-layernorm":{"total": 10.04, "avg": 0.08, "max": 0.06, "min": 0.24, "cnt": 128}, "fwd-attn":{"total": 109.14, "avg": 0.85, "max": 0.74, "min": 1.74, "cnt": 128}, "fwd-misc":{"total": 21.84, "avg": 0.17, "max": 0.12, "min": 0.64, "cnt": 128}, "fwd-MLP":{"total": 1596.48, "avg": 12.47, "max": 9.78, "min": 22.39, "cnt": 128}, "MoE_L0_fwd":{"total": 483.01, "avg": 15.09, "max": 10.96, "min": 22.31, "cnt": 32}, "MoEMLP":{"total": 1579.27, "avg": 12.34, "max": 9.68, "min": 22.27, "cnt": 128}, "MoE_L1_fwd":{"total": 407.26, "avg": 12.73, "max": 11.35, "min": 17.66, "cnt": 32}, "MoE_L2_fwd":{"total": 366.47, "avg": 11.45, "max": 10.56, "min": 14.34, "cnt": 32}, "MoE_L3_fwd":{"total": 328.81, "avg": 10.28, "max": 9.72, "min": 11.74, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 6.40, "avg": 3.20, "max": 0.92, "min": 5.48, "cnt": 2}, "forward-send-backward-recv":{"total": 225.52, "avg": 7.52, "max": 1.11, "min": 104.32, "cnt": 30}, "backward-compute":{"total": 1490.81, "avg": 46.59, "max": 44.01, "min": 49.00, "cnt": 32}, "MoE_L3_bwd":{"total": 331.11, "avg": 10.35, "max": 9.35, "min": 12.41, "cnt": 32}, "MoE_L2_bwd":{"total": 334.81, "avg": 10.46, "max": 9.69, "min": 11.38, "cnt": 32}, "MoE_L1_bwd":{"total": 324.57, "avg": 10.14, "max": 9.72, "min": 10.79, "cnt": 32}, "MoE_L0_bwd":{"total": 280.83, "avg": 8.78, "max": 8.08, "min": 10.52, "cnt": 32}, "backward-send-forward-recv":{"total": 2054.36, "avg": 70.84, "max": 1.99, "min": 305.48, "cnt": 29}, "backward-send":{"total": 3.33, "avg": 1.11, "max": 1.05, "min": 1.18, "cnt": 3}, "backward-recv":{"total": 157.33, "avg": 78.67, "max": 67.39, "min": 89.94, "cnt": 2}, "backward-params-all-reduce":{"total": 484.11, "avg": 484.11, "max": 484.11, "min": 484.11, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 236.29, "avg": 236.29, "max": 236.29, "min": 236.29, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 191.89, "avg": 191.89, "max": 191.89, "min": 191.89, "cnt": 1}, "optimizer-clip-main-grad":{"total": 5.82, "avg": 5.82, "max": 5.82, "min": 5.82, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 120, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 78.45, "avg": 26.15, "max": 1.33, "min": 75.65, "cnt": 3}, "forward-compute":{"total": 1893.55, "avg": 59.17, "max": 55.49, "min": 63.37, "cnt": 32}, "fwd-compute":{"total": 1889.85, "avg": 59.06, "max": 55.40, "min": 63.25, "cnt": 32}, "batch-generator":{"total": 49.85, "avg": 1.56, "max": 0.67, "min": 4.13, "cnt": 32}, "fwd-embedding":{"total": 0.78, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1826.73, "avg": 57.09, "max": 54.44, "min": 61.42, "cnt": 32}, "fwd-layernorm":{"total": 11.18, "avg": 0.09, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 114.79, "avg": 0.90, "max": 0.74, "min": 1.81, "cnt": 128}, "fwd-misc":{"total": 23.52, "avg": 0.18, "max": 0.11, "min": 0.39, "cnt": 128}, "fwd-MLP":{"total": 1654.31, "avg": 12.92, "max": 9.51, "min": 20.00, "cnt": 128}, "MoE_L0_fwd":{"total": 521.65, "avg": 16.30, "max": 14.36, "min": 19.92, "cnt": 32}, "MoEMLP":{"total": 1636.16, "avg": 12.78, "max": 9.41, "min": 19.88, "cnt": 128}, "MoE_L1_fwd":{"total": 414.32, "avg": 12.95, "max": 11.83, "min": 16.04, "cnt": 32}, "MoE_L2_fwd":{"total": 372.64, "avg": 11.65, "max": 10.48, "min": 14.47, "cnt": 32}, "MoE_L3_fwd":{"total": 334.23, "avg": 10.44, "max": 9.45, "min": 14.54, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 3.09, "avg": 1.54, "max": 0.92, "min": 2.17, "cnt": 2}, "forward-send-backward-recv":{"total": 1754.16, "avg": 58.47, "max": 1.86, "min": 322.83, "cnt": 30}, "backward-compute":{"total": 1490.10, "avg": 46.57, "max": 44.46, "min": 49.65, "cnt": 32}, "MoE_L3_bwd":{"total": 329.87, "avg": 10.31, "max": 9.69, "min": 12.17, "cnt": 32}, "MoE_L2_bwd":{"total": 333.97, "avg": 10.44, "max": 9.82, "min": 11.51, "cnt": 32}, "MoE_L1_bwd":{"total": 323.55, "avg": 10.11, "max": 9.70, "min": 10.40, "cnt": 32}, "MoE_L0_bwd":{"total": 284.05, "avg": 8.88, "max": 8.28, "min": 11.53, "cnt": 32}, "backward-send-forward-recv":{"total": 1502.59, "avg": 51.81, "max": 1.56, "min": 644.80, "cnt": 29}, "backward-send":{"total": 2.75, "avg": 0.92, "max": 0.72, "min": 1.05, "cnt": 3}, "backward-recv":{"total": 294.29, "avg": 147.14, "max": 71.34, "min": 222.95, "cnt": 2}, "backward-params-all-reduce":{"total": 485.91, "avg": 485.91, "max": 485.91, "min": 485.91, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 233.15, "avg": 233.15, "max": 233.15, "min": 233.15, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 192.68, "avg": 192.68, "max": 192.68, "min": 192.68, "cnt": 1}, "optimizer-clip-main-grad":{"total": 4.03, "avg": 4.03, "max": 4.03, "min": 4.03, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 121, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 68.94, "avg": 22.98, "max": 1.44, "min": 65.94, "cnt": 3}, "forward-compute":{"total": 1819.06, "avg": 56.85, "max": 48.35, "min": 64.43, "cnt": 32}, "fwd-compute":{"total": 1815.89, "avg": 56.75, "max": 48.28, "min": 64.29, "cnt": 32}, "batch-generator":{"total": 41.80, "avg": 1.31, "max": 0.64, "min": 2.40, "cnt": 32}, "fwd-embedding":{"total": 0.69, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1761.52, "avg": 55.05, "max": 47.25, "min": 61.99, "cnt": 32}, "fwd-layernorm":{"total": 10.34, "avg": 0.08, "max": 0.06, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 112.52, "avg": 0.88, "max": 0.74, "min": 1.85, "cnt": 128}, "fwd-misc":{"total": 22.50, "avg": 0.18, "max": 0.11, "min": 0.41, "cnt": 128}, "fwd-MLP":{"total": 1594.09, "avg": 12.45, "max": 9.66, "min": 19.83, "cnt": 128}, "MoE_L0_fwd":{"total": 473.75, "avg": 14.80, "max": 11.03, "min": 19.68, "cnt": 32}, "MoEMLP":{"total": 1576.62, "avg": 12.32, "max": 9.56, "min": 19.60, "cnt": 128}, "MoE_L1_fwd":{"total": 404.48, "avg": 12.64, "max": 11.41, "min": 15.27, "cnt": 32}, "MoE_L2_fwd":{"total": 362.90, "avg": 11.34, "max": 10.36, "min": 15.36, "cnt": 32}, "MoE_L3_fwd":{"total": 341.84, "avg": 10.68, "max": 9.60, "min": 15.55, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.56, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 6.94, "avg": 3.47, "max": 1.02, "min": 5.92, "cnt": 2}, "forward-send-backward-recv":{"total": 214.37, "avg": 7.15, "max": 1.74, "min": 108.05, "cnt": 30}, "backward-compute":{"total": 1534.07, "avg": 47.94, "max": 44.22, "min": 101.13, "cnt": 32}, "MoE_L3_bwd":{"total": 385.60, "avg": 12.05, "max": 9.57, "min": 65.04, "cnt": 32}, "MoE_L2_bwd":{"total": 326.48, "avg": 10.20, "max": 9.37, "min": 11.16, "cnt": 32}, "MoE_L1_bwd":{"total": 325.92, "avg": 10.18, "max": 9.52, "min": 12.70, "cnt": 32}, "MoE_L0_bwd":{"total": 277.72, "avg": 8.68, "max": 7.84, "min": 9.42, "cnt": 32}, "backward-send-forward-recv":{"total": 1827.68, "avg": 63.02, "max": 2.30, "min": 273.33, "cnt": 29}, "backward-send":{"total": 3.31, "avg": 1.10, "max": 1.08, "min": 1.12, "cnt": 3}, "backward-recv":{"total": 130.30, "avg": 65.15, "max": 57.22, "min": 73.08, "cnt": 2}, "backward-params-all-reduce":{"total": 486.69, "avg": 486.69, "max": 486.69, "min": 486.69, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 244.60, "avg": 244.60, "max": 244.60, "min": 244.60, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 196.24, "avg": 196.24, "max": 196.24, "min": 196.24, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 122, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 65.77, "avg": 21.92, "max": 1.21, "min": 63.08, "cnt": 3}, "forward-compute":{"total": 1795.25, "avg": 56.10, "max": 49.80, "min": 69.42, "cnt": 32}, "fwd-compute":{"total": 1792.07, "avg": 56.00, "max": 49.73, "min": 69.27, "cnt": 32}, "batch-generator":{"total": 40.45, "avg": 1.26, "max": 0.63, "min": 2.83, "cnt": 32}, "fwd-embedding":{"total": 0.59, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1739.16, "avg": 54.35, "max": 47.87, "min": 67.69, "cnt": 32}, "fwd-layernorm":{"total": 9.68, "avg": 0.08, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 106.17, "avg": 0.83, "max": 0.74, "min": 1.42, "cnt": 128}, "fwd-misc":{"total": 21.28, "avg": 0.17, "max": 0.11, "min": 0.58, "cnt": 128}, "fwd-MLP":{"total": 1580.90, "avg": 12.35, "max": 9.36, "min": 19.56, "cnt": 128}, "MoE_L0_fwd":{"total": 463.79, "avg": 14.49, "max": 10.81, "min": 19.39, "cnt": 32}, "MoEMLP":{"total": 1564.07, "avg": 12.22, "max": 9.26, "min": 19.44, "cnt": 128}, "MoE_L1_fwd":{"total": 395.85, "avg": 12.37, "max": 11.44, "min": 14.80, "cnt": 32}, "MoE_L2_fwd":{"total": 369.93, "avg": 11.56, "max": 10.45, "min": 19.48, "cnt": 32}, "MoE_L3_fwd":{"total": 340.59, "avg": 10.64, "max": 9.30, "min": 16.02, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.64, "avg": 0.02, "max": 0.02, "min": 0.05, "cnt": 32}, "forward-send":{"total": 7.81, "avg": 3.91, "max": 0.89, "min": 6.92, "cnt": 2}, "forward-send-backward-recv":{"total": 165.29, "avg": 5.51, "max": 1.31, "min": 89.18, "cnt": 30}, "backward-compute":{"total": 1482.00, "avg": 46.31, "max": 44.10, "min": 48.04, "cnt": 32}, "MoE_L3_bwd":{"total": 327.59, "avg": 10.24, "max": 9.33, "min": 10.90, "cnt": 32}, "MoE_L2_bwd":{"total": 326.42, "avg": 10.20, "max": 9.49, "min": 10.93, "cnt": 32}, "MoE_L1_bwd":{"total": 327.57, "avg": 10.24, "max": 9.50, "min": 11.04, "cnt": 32}, "MoE_L0_bwd":{"total": 281.32, "avg": 8.79, "max": 8.24, "min": 9.38, "cnt": 32}, "backward-send-forward-recv":{"total": 2570.36, "avg": 88.63, "max": 2.13, "min": 687.40, "cnt": 29}, "backward-send":{"total": 2.74, "avg": 0.91, "max": 0.74, "min": 1.05, "cnt": 3}, "backward-recv":{"total": 134.06, "avg": 67.03, "max": 59.02, "min": 75.04, "cnt": 2}, "backward-params-all-reduce":{"total": 506.71, "avg": 506.71, "max": 506.71, "min": 506.71, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 219.39, "avg": 219.39, "max": 219.39, "min": 219.39, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 179.15, "avg": 179.15, "max": 179.15, "min": 179.15, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.90, "avg": 3.90, "max": 3.90, "min": 3.90, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 123, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 70.38, "avg": 23.46, "max": 1.43, "min": 67.30, "cnt": 3}, "forward-compute":{"total": 1805.87, "avg": 56.43, "max": 49.48, "min": 60.62, "cnt": 32}, "fwd-compute":{"total": 1802.65, "avg": 56.33, "max": 49.41, "min": 60.51, "cnt": 32}, "batch-generator":{"total": 42.21, "avg": 1.32, "max": 0.68, "min": 2.54, "cnt": 32}, "fwd-embedding":{"total": 0.64, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1747.73, "avg": 54.62, "max": 48.28, "min": 59.33, "cnt": 32}, "fwd-layernorm":{"total": 10.33, "avg": 0.08, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 110.54, "avg": 0.86, "max": 0.74, "min": 2.22, "cnt": 128}, "fwd-misc":{"total": 21.86, "avg": 0.17, "max": 0.11, "min": 0.43, "cnt": 128}, "fwd-MLP":{"total": 1583.38, "avg": 12.37, "max": 9.70, "min": 18.95, "cnt": 128}, "MoE_L0_fwd":{"total": 484.41, "avg": 15.14, "max": 11.20, "min": 18.86, "cnt": 32}, "MoEMLP":{"total": 1566.19, "avg": 12.24, "max": 9.57, "min": 18.81, "cnt": 128}, "MoE_L1_fwd":{"total": 410.24, "avg": 12.82, "max": 11.37, "min": 16.97, "cnt": 32}, "MoE_L2_fwd":{"total": 352.86, "avg": 11.03, "max": 10.37, "min": 11.86, "cnt": 32}, "MoE_L3_fwd":{"total": 324.97, "avg": 10.16, "max": 9.61, "min": 12.13, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.89, "avg": 0.94, "max": 0.94, "min": 0.95, "cnt": 2}, "forward-send-backward-recv":{"total": 343.14, "avg": 11.44, "max": 1.70, "min": 105.33, "cnt": 30}, "backward-compute":{"total": 1486.92, "avg": 46.47, "max": 43.93, "min": 47.78, "cnt": 32}, "MoE_L3_bwd":{"total": 324.01, "avg": 10.13, "max": 9.60, "min": 10.78, "cnt": 32}, "MoE_L2_bwd":{"total": 323.18, "avg": 10.10, "max": 8.89, "min": 11.25, "cnt": 32}, "MoE_L1_bwd":{"total": 334.25, "avg": 10.45, "max": 9.45, "min": 12.11, "cnt": 32}, "MoE_L0_bwd":{"total": 287.84, "avg": 9.00, "max": 8.55, "min": 9.65, "cnt": 32}, "backward-send-forward-recv":{"total": 2476.69, "avg": 85.40, "max": 2.27, "min": 394.03, "cnt": 29}, "backward-send":{"total": 3.24, "avg": 1.08, "max": 1.05, "min": 1.10, "cnt": 3}, "backward-recv":{"total": 333.99, "avg": 166.99, "max": 151.96, "min": 182.03, "cnt": 2}, "backward-params-all-reduce":{"total": 482.24, "avg": 482.24, "max": 482.24, "min": 482.24, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 240.70, "avg": 240.70, "max": 240.70, "min": 240.70, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 200.94, "avg": 200.94, "max": 200.94, "min": 200.94, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 124, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 70.41, "avg": 23.47, "max": 1.35, "min": 67.53, "cnt": 3}, "forward-compute":{"total": 1756.32, "avg": 54.88, "max": 49.28, "min": 60.53, "cnt": 32}, "fwd-compute":{"total": 1753.21, "avg": 54.79, "max": 49.20, "min": 60.40, "cnt": 32}, "batch-generator":{"total": 39.27, "avg": 1.23, "max": 0.70, "min": 2.66, "cnt": 32}, "fwd-embedding":{"total": 0.54, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1701.52, "avg": 53.17, "max": 48.04, "min": 58.40, "cnt": 32}, "fwd-layernorm":{"total": 9.51, "avg": 0.07, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 106.93, "avg": 0.84, "max": 0.74, "min": 1.74, "cnt": 128}, "fwd-misc":{"total": 20.59, "avg": 0.16, "max": 0.11, "min": 0.34, "cnt": 128}, "fwd-MLP":{"total": 1543.53, "avg": 12.06, "max": 9.49, "min": 19.38, "cnt": 128}, "MoE_L0_fwd":{"total": 452.42, "avg": 14.14, "max": 10.74, "min": 19.23, "cnt": 32}, "MoEMLP":{"total": 1527.11, "avg": 11.93, "max": 9.38, "min": 19.19, "cnt": 128}, "MoE_L1_fwd":{"total": 405.55, "avg": 12.67, "max": 11.48, "min": 15.93, "cnt": 32}, "MoE_L2_fwd":{"total": 353.72, "avg": 11.05, "max": 10.25, "min": 14.58, "cnt": 32}, "MoE_L3_fwd":{"total": 321.38, "avg": 10.04, "max": 9.42, "min": 11.07, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 4.68, "avg": 2.34, "max": 0.90, "min": 3.78, "cnt": 2}, "forward-send-backward-recv":{"total": 267.40, "avg": 8.91, "max": 1.46, "min": 107.00, "cnt": 30}, "backward-compute":{"total": 1487.84, "avg": 46.49, "max": 44.93, "min": 49.08, "cnt": 32}, "MoE_L3_bwd":{"total": 322.82, "avg": 10.09, "max": 9.36, "min": 12.75, "cnt": 32}, "MoE_L2_bwd":{"total": 319.42, "avg": 9.98, "max": 9.13, "min": 11.30, "cnt": 32}, "MoE_L1_bwd":{"total": 334.70, "avg": 10.46, "max": 10.07, "min": 11.02, "cnt": 32}, "MoE_L0_bwd":{"total": 291.34, "avg": 9.10, "max": 8.57, "min": 9.85, "cnt": 32}, "backward-send-forward-recv":{"total": 3071.31, "avg": 105.91, "max": 2.38, "min": 683.09, "cnt": 29}, "backward-send":{"total": 2.33, "avg": 0.78, "max": 0.67, "min": 0.93, "cnt": 3}, "backward-recv":{"total": 160.60, "avg": 80.30, "max": 65.51, "min": 95.09, "cnt": 2}, "backward-params-all-reduce":{"total": 486.22, "avg": 486.22, "max": 486.22, "min": 486.22, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 235.50, "avg": 235.50, "max": 235.50, "min": 235.50, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 195.45, "avg": 195.45, "max": 195.45, "min": 195.45, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 125, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 75.22, "avg": 25.07, "max": 1.37, "min": 72.39, "cnt": 3}, "forward-compute":{"total": 1808.18, "avg": 56.51, "max": 51.33, "min": 65.03, "cnt": 32}, "fwd-compute":{"total": 1805.05, "avg": 56.41, "max": 51.25, "min": 64.96, "cnt": 32}, "batch-generator":{"total": 51.07, "avg": 1.60, "max": 0.70, "min": 3.35, "cnt": 32}, "fwd-embedding":{"total": 0.67, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1741.23, "avg": 54.41, "max": 49.33, "min": 63.80, "cnt": 32}, "fwd-layernorm":{"total": 10.19, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 111.15, "avg": 0.87, "max": 0.74, "min": 3.10, "cnt": 128}, "fwd-misc":{"total": 21.49, "avg": 0.17, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1577.17, "avg": 12.32, "max": 9.52, "min": 19.28, "cnt": 128}, "MoE_L0_fwd":{"total": 476.75, "avg": 14.90, "max": 10.91, "min": 19.18, "cnt": 32}, "MoEMLP":{"total": 1560.40, "avg": 12.19, "max": 9.40, "min": 19.12, "cnt": 128}, "MoE_L1_fwd":{"total": 402.09, "avg": 12.57, "max": 11.63, "min": 15.70, "cnt": 32}, "MoE_L2_fwd":{"total": 361.11, "avg": 11.28, "max": 10.32, "min": 16.89, "cnt": 32}, "MoE_L3_fwd":{"total": 326.68, "avg": 10.21, "max": 9.45, "min": 13.77, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.72, "avg": 0.86, "max": 0.76, "min": 0.97, "cnt": 2}, "forward-send-backward-recv":{"total": 203.55, "avg": 6.78, "max": 1.04, "min": 99.86, "cnt": 30}, "backward-compute":{"total": 1489.78, "avg": 46.56, "max": 44.60, "min": 49.60, "cnt": 32}, "MoE_L3_bwd":{"total": 322.64, "avg": 10.08, "max": 9.23, "min": 13.16, "cnt": 32}, "MoE_L2_bwd":{"total": 322.63, "avg": 10.08, "max": 9.16, "min": 11.57, "cnt": 32}, "MoE_L1_bwd":{"total": 335.45, "avg": 10.48, "max": 10.01, "min": 13.00, "cnt": 32}, "MoE_L0_bwd":{"total": 290.38, "avg": 9.07, "max": 8.53, "min": 9.81, "cnt": 32}, "backward-send-forward-recv":{"total": 2051.26, "avg": 70.73, "max": 2.03, "min": 240.36, "cnt": 29}, "backward-send":{"total": 2.81, "avg": 0.94, "max": 0.90, "min": 0.97, "cnt": 3}, "backward-recv":{"total": 122.00, "avg": 61.00, "max": 53.11, "min": 68.89, "cnt": 2}, "backward-params-all-reduce":{"total": 484.81, "avg": 484.81, "max": 484.81, "min": 484.81, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 244.36, "avg": 244.36, "max": 244.36, "min": 244.36, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.40, "avg": 3.40, "max": 3.40, "min": 3.40, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 198.58, "avg": 198.58, "max": 198.58, "min": 198.58, "cnt": 1}, "optimizer-clip-main-grad":{"total": 5.76, "avg": 5.76, "max": 5.76, "min": 5.76, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}}}
{"type":"time", "iteration": 126, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 70.92, "avg": 23.64, "max": 1.48, "min": 67.93, "cnt": 3}, "forward-compute":{"total": 1811.42, "avg": 56.61, "max": 47.63, "min": 66.69, "cnt": 32}, "fwd-compute":{"total": 1808.09, "avg": 56.50, "max": 47.56, "min": 66.59, "cnt": 32}, "batch-generator":{"total": 43.00, "avg": 1.34, "max": 0.70, "min": 1.99, "cnt": 32}, "fwd-embedding":{"total": 0.72, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1751.60, "avg": 54.74, "max": 46.56, "min": 65.00, "cnt": 32}, "fwd-layernorm":{"total": 10.83, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 116.90, "avg": 0.91, "max": 0.74, "min": 1.80, "cnt": 128}, "fwd-misc":{"total": 23.05, "avg": 0.18, "max": 0.12, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1577.54, "avg": 12.32, "max": 9.44, "min": 20.13, "cnt": 128}, "MoE_L0_fwd":{"total": 484.80, "avg": 15.15, "max": 10.56, "min": 20.05, "cnt": 32}, "MoEMLP":{"total": 1559.62, "avg": 12.18, "max": 9.34, "min": 20.00, "cnt": 128}, "MoE_L1_fwd":{"total": 397.25, "avg": 12.41, "max": 11.01, "min": 14.42, "cnt": 32}, "MoE_L2_fwd":{"total": 356.54, "avg": 11.14, "max": 10.42, "min": 13.27, "cnt": 32}, "MoE_L3_fwd":{"total": 327.59, "avg": 10.24, "max": 9.37, "min": 15.03, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.91, "avg": 0.96, "max": 0.94, "min": 0.97, "cnt": 2}, "forward-send-backward-recv":{"total": 268.82, "avg": 8.96, "max": 0.99, "min": 109.87, "cnt": 30}, "backward-compute":{"total": 1486.63, "avg": 46.46, "max": 44.40, "min": 50.86, "cnt": 32}, "MoE_L3_bwd":{"total": 332.51, "avg": 10.39, "max": 9.38, "min": 13.44, "cnt": 32}, "MoE_L2_bwd":{"total": 327.84, "avg": 10.25, "max": 9.46, "min": 13.52, "cnt": 32}, "MoE_L1_bwd":{"total": 320.63, "avg": 10.02, "max": 9.16, "min": 11.97, "cnt": 32}, "MoE_L0_bwd":{"total": 285.82, "avg": 8.93, "max": 8.13, "min": 10.49, "cnt": 32}, "backward-send-forward-recv":{"total": 2336.97, "avg": 80.59, "max": 2.03, "min": 300.18, "cnt": 29}, "backward-send":{"total": 2.66, "avg": 0.89, "max": 0.77, "min": 1.11, "cnt": 3}, "backward-recv":{"total": 130.49, "avg": 65.24, "max": 57.09, "min": 73.40, "cnt": 2}, "backward-params-all-reduce":{"total": 486.67, "avg": 486.67, "max": 486.67, "min": 486.67, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 229.50, "avg": 229.50, "max": 229.50, "min": 229.50, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 189.46, "avg": 189.46, "max": 189.46, "min": 189.46, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.69, "avg": 3.69, "max": 3.69, "min": 3.69, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 127, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 73.87, "avg": 24.62, "max": 1.49, "min": 66.84, "cnt": 3}, "forward-compute":{"total": 1774.14, "avg": 55.44, "max": 48.36, "min": 63.69, "cnt": 32}, "fwd-compute":{"total": 1770.90, "avg": 55.34, "max": 48.29, "min": 63.55, "cnt": 32}, "batch-generator":{"total": 40.02, "avg": 1.25, "max": 0.67, "min": 2.61, "cnt": 32}, "fwd-embedding":{"total": 0.64, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1718.54, "avg": 53.70, "max": 47.34, "min": 60.49, "cnt": 32}, "fwd-layernorm":{"total": 9.96, "avg": 0.08, "max": 0.06, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 109.18, "avg": 0.85, "max": 0.74, "min": 2.04, "cnt": 128}, "fwd-misc":{"total": 21.43, "avg": 0.17, "max": 0.11, "min": 0.42, "cnt": 128}, "fwd-MLP":{"total": 1556.84, "avg": 12.16, "max": 9.55, "min": 18.57, "cnt": 128}, "MoE_L0_fwd":{"total": 464.28, "avg": 14.51, "max": 10.94, "min": 18.47, "cnt": 32}, "MoEMLP":{"total": 1540.20, "avg": 12.03, "max": 9.43, "min": 18.42, "cnt": 128}, "MoE_L1_fwd":{"total": 384.62, "avg": 12.02, "max": 10.95, "min": 13.16, "cnt": 32}, "MoE_L2_fwd":{"total": 368.59, "avg": 11.52, "max": 10.80, "min": 15.88, "cnt": 32}, "MoE_L3_fwd":{"total": 328.81, "avg": 10.28, "max": 9.48, "min": 12.58, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.80, "avg": 0.90, "max": 0.82, "min": 0.98, "cnt": 2}, "forward-send-backward-recv":{"total": 386.02, "avg": 12.87, "max": 1.86, "min": 123.57, "cnt": 30}, "backward-compute":{"total": 1483.10, "avg": 46.35, "max": 43.00, "min": 48.84, "cnt": 32}, "MoE_L3_bwd":{"total": 324.68, "avg": 10.15, "max": 9.13, "min": 13.24, "cnt": 32}, "MoE_L2_bwd":{"total": 326.97, "avg": 10.22, "max": 9.29, "min": 11.31, "cnt": 32}, "MoE_L1_bwd":{"total": 324.36, "avg": 10.14, "max": 9.44, "min": 12.16, "cnt": 32}, "MoE_L0_bwd":{"total": 284.78, "avg": 8.90, "max": 8.40, "min": 9.27, "cnt": 32}, "backward-send-forward-recv":{"total": 1802.65, "avg": 62.16, "max": 1.76, "min": 423.95, "cnt": 29}, "backward-send":{"total": 2.66, "avg": 0.89, "max": 0.66, "min": 1.04, "cnt": 3}, "backward-recv":{"total": 330.71, "avg": 165.36, "max": 70.19, "min": 260.53, "cnt": 2}, "backward-params-all-reduce":{"total": 488.02, "avg": 488.02, "max": 488.02, "min": 488.02, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 231.58, "avg": 231.58, "max": 231.58, "min": 231.58, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 191.90, "avg": 191.90, "max": 191.90, "min": 191.90, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.28, "avg": 3.28, "max": 3.28, "min": 3.28, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 128, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 89.67, "avg": 29.89, "max": 1.42, "min": 78.84, "cnt": 3}, "forward-compute":{"total": 1803.86, "avg": 56.37, "max": 48.68, "min": 70.23, "cnt": 32}, "fwd-compute":{"total": 1800.76, "avg": 56.27, "max": 48.61, "min": 70.14, "cnt": 32}, "batch-generator":{"total": 40.20, "avg": 1.26, "max": 0.69, "min": 2.76, "cnt": 32}, "fwd-embedding":{"total": 0.67, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1748.29, "avg": 54.63, "max": 47.52, "min": 68.86, "cnt": 32}, "fwd-layernorm":{"total": 10.05, "avg": 0.08, "max": 0.06, "min": 0.18, "cnt": 128}, "fwd-attn":{"total": 109.30, "avg": 0.85, "max": 0.74, "min": 2.21, "cnt": 128}, "fwd-misc":{"total": 21.35, "avg": 0.17, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1586.32, "avg": 12.39, "max": 9.29, "min": 30.81, "cnt": 128}, "MoE_L0_fwd":{"total": 492.67, "avg": 15.40, "max": 10.82, "min": 30.72, "cnt": 32}, "MoEMLP":{"total": 1569.36, "avg": 12.26, "max": 9.19, "min": 30.68, "cnt": 128}, "MoE_L1_fwd":{"total": 394.89, "avg": 12.34, "max": 11.01, "min": 18.34, "cnt": 32}, "MoE_L2_fwd":{"total": 356.01, "avg": 11.13, "max": 10.45, "min": 12.46, "cnt": 32}, "MoE_L3_fwd":{"total": 332.06, "avg": 10.38, "max": 9.23, "min": 15.63, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.93, "avg": 0.97, "max": 0.94, "min": 0.99, "cnt": 2}, "forward-send-backward-recv":{"total": 233.36, "avg": 7.78, "max": 1.41, "min": 101.52, "cnt": 30}, "backward-compute":{"total": 1488.66, "avg": 46.52, "max": 44.79, "min": 53.57, "cnt": 32}, "MoE_L3_bwd":{"total": 331.89, "avg": 10.37, "max": 9.35, "min": 14.93, "cnt": 32}, "MoE_L2_bwd":{"total": 329.39, "avg": 10.29, "max": 9.31, "min": 12.05, "cnt": 32}, "MoE_L1_bwd":{"total": 323.36, "avg": 10.10, "max": 8.94, "min": 14.06, "cnt": 32}, "MoE_L0_bwd":{"total": 284.07, "avg": 8.88, "max": 8.60, "min": 9.15, "cnt": 32}, "backward-send-forward-recv":{"total": 1797.69, "avg": 61.99, "max": 1.81, "min": 220.81, "cnt": 29}, "backward-send":{"total": 2.73, "avg": 0.91, "max": 0.78, "min": 1.06, "cnt": 3}, "backward-recv":{"total": 158.39, "avg": 79.19, "max": 55.32, "min": 103.07, "cnt": 2}, "backward-params-all-reduce":{"total": 488.79, "avg": 488.79, "max": 488.79, "min": 488.79, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 229.30, "avg": 229.30, "max": 229.30, "min": 229.30, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 189.60, "avg": 189.60, "max": 189.60, "min": 189.60, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.41, "avg": 3.41, "max": 3.41, "min": 3.41, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}}}
{"type":"time", "iteration": 129, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 77.61, "avg": 25.87, "max": 1.42, "min": 72.28, "cnt": 3}, "forward-compute":{"total": 1804.99, "avg": 56.41, "max": 48.12, "min": 63.67, "cnt": 32}, "fwd-compute":{"total": 1801.68, "avg": 56.30, "max": 48.04, "min": 63.59, "cnt": 32}, "batch-generator":{"total": 47.10, "avg": 1.47, "max": 0.73, "min": 3.54, "cnt": 32}, "fwd-embedding":{"total": 0.74, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1741.66, "avg": 54.43, "max": 47.01, "min": 62.35, "cnt": 32}, "fwd-layernorm":{"total": 10.77, "avg": 0.08, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 113.45, "avg": 0.89, "max": 0.74, "min": 2.71, "cnt": 128}, "fwd-misc":{"total": 22.92, "avg": 0.18, "max": 0.12, "min": 0.38, "cnt": 128}, "fwd-MLP":{"total": 1572.03, "avg": 12.28, "max": 9.58, "min": 18.36, "cnt": 128}, "MoE_L0_fwd":{"total": 471.26, "avg": 14.73, "max": 10.55, "min": 18.28, "cnt": 32}, "MoEMLP":{"total": 1554.30, "avg": 12.14, "max": 9.46, "min": 18.22, "cnt": 128}, "MoE_L1_fwd":{"total": 394.59, "avg": 12.33, "max": 10.84, "min": 15.90, "cnt": 32}, "MoE_L2_fwd":{"total": 366.07, "avg": 11.44, "max": 10.62, "min": 15.85, "cnt": 32}, "MoE_L3_fwd":{"total": 328.87, "avg": 10.28, "max": 9.51, "min": 13.91, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.94, "avg": 0.97, "max": 0.92, "min": 1.02, "cnt": 2}, "forward-send-backward-recv":{"total": 186.72, "avg": 6.22, "max": 1.67, "min": 114.48, "cnt": 30}, "backward-compute":{"total": 1487.17, "avg": 46.47, "max": 45.29, "min": 48.27, "cnt": 32}, "MoE_L3_bwd":{"total": 330.72, "avg": 10.34, "max": 9.75, "min": 12.06, "cnt": 32}, "MoE_L2_bwd":{"total": 330.80, "avg": 10.34, "max": 9.59, "min": 11.66, "cnt": 32}, "MoE_L1_bwd":{"total": 320.12, "avg": 10.00, "max": 9.50, "min": 10.44, "cnt": 32}, "MoE_L0_bwd":{"total": 285.80, "avg": 8.93, "max": 8.58, "min": 9.23, "cnt": 32}, "backward-send-forward-recv":{"total": 2692.33, "avg": 92.84, "max": 2.05, "min": 454.45, "cnt": 29}, "backward-send":{"total": 3.27, "avg": 1.09, "max": 1.03, "min": 1.14, "cnt": 3}, "backward-recv":{"total": 134.89, "avg": 67.44, "max": 62.91, "min": 71.98, "cnt": 2}, "backward-params-all-reduce":{"total": 486.19, "avg": 486.19, "max": 486.19, "min": 486.19, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 237.60, "avg": 237.60, "max": 237.60, "min": 237.60, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 190.18, "avg": 190.18, "max": 190.18, "min": 190.18, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.83, "avg": 3.83, "max": 3.83, "min": 3.83, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.41, "avg": 3.41, "max": 3.41, "min": 3.41, "cnt": 1}}}
{"type":"time", "iteration": 130, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 69.81, "avg": 23.27, "max": 1.22, "min": 67.16, "cnt": 3}, "forward-compute":{"total": 1781.61, "avg": 55.68, "max": 48.60, "min": 68.70, "cnt": 32}, "fwd-compute":{"total": 1778.43, "avg": 55.58, "max": 48.53, "min": 68.61, "cnt": 32}, "batch-generator":{"total": 39.91, "avg": 1.25, "max": 0.68, "min": 3.41, "cnt": 32}, "fwd-embedding":{"total": 0.63, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1725.62, "avg": 53.93, "max": 47.37, "min": 67.16, "cnt": 32}, "fwd-layernorm":{"total": 9.94, "avg": 0.08, "max": 0.06, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 107.20, "avg": 0.84, "max": 0.74, "min": 1.65, "cnt": 128}, "fwd-misc":{"total": 21.25, "avg": 0.17, "max": 0.11, "min": 0.42, "cnt": 128}, "fwd-MLP":{"total": 1565.67, "avg": 12.23, "max": 9.42, "min": 20.11, "cnt": 128}, "MoE_L0_fwd":{"total": 476.11, "avg": 14.88, "max": 10.50, "min": 19.98, "cnt": 32}, "MoEMLP":{"total": 1549.03, "avg": 12.10, "max": 9.32, "min": 19.93, "cnt": 128}, "MoE_L1_fwd":{"total": 390.10, "avg": 12.19, "max": 10.73, "min": 16.32, "cnt": 32}, "MoE_L2_fwd":{"total": 359.08, "avg": 11.22, "max": 10.41, "min": 14.15, "cnt": 32}, "MoE_L3_fwd":{"total": 329.86, "avg": 10.31, "max": 9.36, "min": 14.14, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 138.20, "avg": 69.10, "max": 0.95, "min": 137.25, "cnt": 2}, "forward-send-backward-recv":{"total": 615.90, "avg": 20.53, "max": 1.57, "min": 228.73, "cnt": 30}, "backward-compute":{"total": 1479.67, "avg": 46.24, "max": 44.96, "min": 50.32, "cnt": 32}, "MoE_L3_bwd":{"total": 326.01, "avg": 10.19, "max": 9.42, "min": 13.64, "cnt": 32}, "MoE_L2_bwd":{"total": 336.48, "avg": 10.52, "max": 9.95, "min": 11.43, "cnt": 32}, "MoE_L1_bwd":{"total": 316.21, "avg": 9.88, "max": 9.33, "min": 10.30, "cnt": 32}, "MoE_L0_bwd":{"total": 283.84, "avg": 8.87, "max": 7.90, "min": 9.22, "cnt": 32}, "backward-send-forward-recv":{"total": 1837.68, "avg": 63.37, "max": 2.01, "min": 405.11, "cnt": 29}, "backward-send":{"total": 3.07, "avg": 1.02, "max": 0.89, "min": 1.23, "cnt": 3}, "backward-recv":{"total": 135.22, "avg": 67.61, "max": 59.65, "min": 75.57, "cnt": 2}, "backward-params-all-reduce":{"total": 494.75, "avg": 494.75, "max": 494.75, "min": 494.75, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 237.52, "avg": 237.52, "max": 237.52, "min": 237.52, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 184.54, "avg": 184.54, "max": 184.54, "min": 184.54, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.53, "avg": 3.53, "max": 3.53, "min": 3.53, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 131, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 63.69, "avg": 21.23, "max": 4.17, "min": 53.98, "cnt": 3}, "forward-compute":{"total": 1798.68, "avg": 56.21, "max": 48.55, "min": 60.48, "cnt": 32}, "fwd-compute":{"total": 1795.37, "avg": 56.11, "max": 48.47, "min": 60.38, "cnt": 32}, "batch-generator":{"total": 44.32, "avg": 1.39, "max": 0.65, "min": 2.97, "cnt": 32}, "fwd-embedding":{"total": 0.68, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1737.54, "avg": 54.30, "max": 47.31, "min": 58.66, "cnt": 32}, "fwd-layernorm":{"total": 10.36, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 109.91, "avg": 0.86, "max": 0.74, "min": 1.54, "cnt": 128}, "fwd-misc":{"total": 21.98, "avg": 0.17, "max": 0.11, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1573.75, "avg": 12.29, "max": 9.94, "min": 19.77, "cnt": 128}, "MoE_L0_fwd":{"total": 485.35, "avg": 15.17, "max": 10.98, "min": 19.69, "cnt": 32}, "MoEMLP":{"total": 1556.40, "avg": 12.16, "max": 9.82, "min": 19.64, "cnt": 128}, "MoE_L1_fwd":{"total": 386.22, "avg": 12.07, "max": 10.69, "min": 13.69, "cnt": 32}, "MoE_L2_fwd":{"total": 358.47, "avg": 11.20, "max": 10.49, "min": 13.09, "cnt": 32}, "MoE_L3_fwd":{"total": 332.62, "avg": 10.39, "max": 9.87, "min": 12.93, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.62, "avg": 0.02, "max": 0.02, "min": 0.05, "cnt": 32}, "forward-send":{"total": 1.92, "avg": 0.96, "max": 0.91, "min": 1.00, "cnt": 2}, "forward-send-backward-recv":{"total": 301.63, "avg": 10.05, "max": 1.34, "min": 122.14, "cnt": 30}, "backward-compute":{"total": 1488.08, "avg": 46.50, "max": 45.14, "min": 48.95, "cnt": 32}, "MoE_L3_bwd":{"total": 340.80, "avg": 10.65, "max": 9.17, "min": 12.99, "cnt": 32}, "MoE_L2_bwd":{"total": 336.19, "avg": 10.51, "max": 9.80, "min": 12.83, "cnt": 32}, "MoE_L1_bwd":{"total": 310.26, "avg": 9.70, "max": 9.11, "min": 10.02, "cnt": 32}, "MoE_L0_bwd":{"total": 281.74, "avg": 8.80, "max": 8.42, "min": 9.10, "cnt": 32}, "backward-send-forward-recv":{"total": 6767.46, "avg": 233.36, "max": 2.21, "min": 1483.15, "cnt": 29}, "backward-send":{"total": 2.35, "avg": 0.78, "max": 0.62, "min": 1.02, "cnt": 3}, "backward-recv":{"total": 590.43, "avg": 295.21, "max": 69.50, "min": 520.93, "cnt": 2}, "backward-params-all-reduce":{"total": 487.24, "avg": 487.24, "max": 487.24, "min": 487.24, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 229.23, "avg": 229.23, "max": 229.23, "min": 229.23, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.40, "avg": 3.40, "max": 3.40, "min": 3.40, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 189.43, "avg": 189.43, "max": 189.43, "min": 189.43, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}}}
{"type":"time", "iteration": 132, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 73.81, "avg": 24.60, "max": 1.64, "min": 69.78, "cnt": 3}, "forward-compute":{"total": 1792.82, "avg": 56.03, "max": 46.44, "min": 67.25, "cnt": 32}, "fwd-compute":{"total": 1789.55, "avg": 55.92, "max": 46.37, "min": 67.16, "cnt": 32}, "batch-generator":{"total": 43.35, "avg": 1.35, "max": 0.66, "min": 2.18, "cnt": 32}, "fwd-embedding":{"total": 0.70, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1733.36, "avg": 54.17, "max": 45.42, "min": 65.58, "cnt": 32}, "fwd-layernorm":{"total": 10.67, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 114.38, "avg": 0.89, "max": 0.74, "min": 2.77, "cnt": 128}, "fwd-misc":{"total": 22.33, "avg": 0.17, "max": 0.11, "min": 0.48, "cnt": 128}, "fwd-MLP":{"total": 1563.84, "avg": 12.22, "max": 9.36, "min": 27.18, "cnt": 128}, "MoE_L0_fwd":{"total": 505.17, "avg": 15.79, "max": 10.27, "min": 27.10, "cnt": 32}, "MoEMLP":{"total": 1546.68, "avg": 12.08, "max": 9.26, "min": 27.05, "cnt": 128}, "MoE_L1_fwd":{"total": 376.43, "avg": 11.76, "max": 10.52, "min": 12.88, "cnt": 32}, "MoE_L2_fwd":{"total": 352.30, "avg": 11.01, "max": 10.24, "min": 12.38, "cnt": 32}, "MoE_L3_fwd":{"total": 319.06, "avg": 9.97, "max": 9.30, "min": 11.25, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.56, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 3.60, "avg": 1.80, "max": 0.94, "min": 2.67, "cnt": 2}, "forward-send-backward-recv":{"total": 211.83, "avg": 7.06, "max": 1.79, "min": 108.39, "cnt": 30}, "backward-compute":{"total": 1655.48, "avg": 51.73, "max": 43.94, "min": 233.73, "cnt": 32}, "MoE_L3_bwd":{"total": 335.12, "avg": 10.47, "max": 9.37, "min": 11.18, "cnt": 32}, "MoE_L2_bwd":{"total": 332.46, "avg": 10.39, "max": 9.83, "min": 11.21, "cnt": 32}, "MoE_L1_bwd":{"total": 306.78, "avg": 9.59, "max": 9.21, "min": 10.39, "cnt": 32}, "MoE_L0_bwd":{"total": 466.07, "avg": 14.56, "max": 8.19, "min": 197.07, "cnt": 32}, "backward-send-forward-recv":{"total": 8691.81, "avg": 299.72, "max": 2.26, "min": 1914.63, "cnt": 29}, "backward-send":{"total": 2.46, "avg": 0.82, "max": 0.52, "min": 1.08, "cnt": 3}, "backward-recv":{"total": 609.36, "avg": 304.68, "max": 303.35, "min": 306.01, "cnt": 2}, "backward-params-all-reduce":{"total": 484.43, "avg": 484.43, "max": 484.43, "min": 484.43, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 235.06, "avg": 235.06, "max": 235.06, "min": 235.06, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 194.92, "avg": 194.92, "max": 194.92, "min": 194.92, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.73, "avg": 3.73, "max": 3.73, "min": 3.73, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.47, "avg": 3.47, "max": 3.47, "min": 3.47, "cnt": 1}}}
{"type":"time", "iteration": 133, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 784.51, "avg": 261.50, "max": 193.17, "min": 357.79, "cnt": 3}, "forward-compute":{"total": 1845.16, "avg": 57.66, "max": 50.70, "min": 62.43, "cnt": 32}, "fwd-compute":{"total": 1842.01, "avg": 57.56, "max": 50.63, "min": 62.34, "cnt": 32}, "batch-generator":{"total": 45.09, "avg": 1.41, "max": 0.70, "min": 2.43, "cnt": 32}, "fwd-embedding":{"total": 0.66, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1783.89, "avg": 55.75, "max": 49.59, "min": 60.91, "cnt": 32}, "fwd-layernorm":{"total": 10.64, "avg": 0.08, "max": 0.06, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 114.15, "avg": 0.89, "max": 0.74, "min": 2.16, "cnt": 128}, "fwd-misc":{"total": 22.25, "avg": 0.17, "max": 0.11, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1615.03, "avg": 12.62, "max": 9.72, "min": 21.39, "cnt": 128}, "MoE_L0_fwd":{"total": 515.18, "avg": 16.10, "max": 12.15, "min": 21.31, "cnt": 32}, "MoEMLP":{"total": 1597.90, "avg": 12.48, "max": 9.62, "min": 21.27, "cnt": 128}, "MoE_L1_fwd":{"total": 399.66, "avg": 12.49, "max": 11.06, "min": 14.26, "cnt": 32}, "MoE_L2_fwd":{"total": 359.96, "avg": 11.25, "max": 10.59, "min": 12.96, "cnt": 32}, "MoE_L3_fwd":{"total": 329.41, "avg": 10.29, "max": 9.66, "min": 11.23, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.90, "avg": 0.95, "max": 0.87, "min": 1.03, "cnt": 2}, "forward-send-backward-recv":{"total": 582.53, "avg": 19.42, "max": 1.60, "min": 216.60, "cnt": 30}, "backward-compute":{"total": 1500.85, "avg": 46.90, "max": 44.65, "min": 48.13, "cnt": 32}, "MoE_L3_bwd":{"total": 333.17, "avg": 10.41, "max": 9.87, "min": 10.99, "cnt": 32}, "MoE_L2_bwd":{"total": 340.91, "avg": 10.65, "max": 9.88, "min": 11.72, "cnt": 32}, "MoE_L1_bwd":{"total": 324.73, "avg": 10.15, "max": 9.80, "min": 10.38, "cnt": 32}, "MoE_L0_bwd":{"total": 286.57, "avg": 8.96, "max": 8.10, "min": 9.50, "cnt": 32}, "backward-send-forward-recv":{"total": 7922.50, "avg": 273.19, "max": 1.67, "min": 1651.20, "cnt": 29}, "backward-send":{"total": 2.79, "avg": 0.93, "max": 0.63, "min": 1.21, "cnt": 3}, "backward-recv":{"total": 150.39, "avg": 75.19, "max": 70.93, "min": 79.46, "cnt": 2}, "backward-params-all-reduce":{"total": 485.61, "avg": 485.61, "max": 485.61, "min": 485.61, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 240.04, "avg": 240.04, "max": 240.04, "min": 240.04, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 192.58, "avg": 192.58, "max": 192.58, "min": 192.58, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.16, "avg": 6.16, "max": 6.16, "min": 6.16, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 134, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.12, "avg": 0.12, "max": 0.12, "min": 0.12, "cnt": 1}, "forward-recv":{"total": 65.53, "avg": 21.84, "max": 1.28, "min": 62.74, "cnt": 3}, "forward-compute":{"total": 1786.23, "avg": 55.82, "max": 48.11, "min": 72.00, "cnt": 32}, "fwd-compute":{"total": 1782.70, "avg": 55.71, "max": 48.03, "min": 71.87, "cnt": 32}, "batch-generator":{"total": 44.50, "avg": 1.39, "max": 0.65, "min": 2.63, "cnt": 32}, "fwd-embedding":{"total": 0.72, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1725.25, "avg": 53.91, "max": 46.99, "min": 69.72, "cnt": 32}, "fwd-layernorm":{"total": 10.87, "avg": 0.08, "max": 0.06, "min": 0.22, "cnt": 128}, "fwd-attn":{"total": 115.02, "avg": 0.90, "max": 0.74, "min": 2.71, "cnt": 128}, "fwd-misc":{"total": 23.21, "avg": 0.18, "max": 0.11, "min": 0.41, "cnt": 128}, "fwd-MLP":{"total": 1553.53, "avg": 12.14, "max": 9.85, "min": 20.18, "cnt": 128}, "MoE_L0_fwd":{"total": 441.48, "avg": 13.80, "max": 10.23, "min": 20.03, "cnt": 32}, "MoEMLP":{"total": 1535.61, "avg": 12.00, "max": 9.75, "min": 19.99, "cnt": 128}, "MoE_L1_fwd":{"total": 370.40, "avg": 11.58, "max": 10.43, "min": 13.63, "cnt": 32}, "MoE_L2_fwd":{"total": 379.38, "avg": 11.86, "max": 10.45, "min": 17.45, "cnt": 32}, "MoE_L3_fwd":{"total": 350.97, "avg": 10.97, "max": 9.79, "min": 20.04, "cnt": 32}, "fwd-pooler":{"total": 0.36, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 3.09, "avg": 1.55, "max": 0.96, "min": 2.13, "cnt": 2}, "forward-send-backward-recv":{"total": 331.44, "avg": 11.05, "max": 1.72, "min": 120.51, "cnt": 30}, "backward-compute":{"total": 1468.48, "avg": 45.89, "max": 44.18, "min": 48.51, "cnt": 32}, "MoE_L3_bwd":{"total": 338.75, "avg": 10.59, "max": 10.00, "min": 12.68, "cnt": 32}, "MoE_L2_bwd":{"total": 328.31, "avg": 10.26, "max": 8.97, "min": 10.82, "cnt": 32}, "MoE_L1_bwd":{"total": 305.09, "avg": 9.53, "max": 9.09, "min": 11.65, "cnt": 32}, "MoE_L0_bwd":{"total": 277.14, "avg": 8.66, "max": 8.14, "min": 9.16, "cnt": 32}, "backward-send-forward-recv":{"total": 1375.51, "avg": 47.43, "max": 2.24, "min": 185.22, "cnt": 29}, "backward-send":{"total": 2.74, "avg": 0.91, "max": 0.78, "min": 1.03, "cnt": 3}, "backward-recv":{"total": 279.77, "avg": 139.89, "max": 71.32, "min": 208.45, "cnt": 2}, "backward-params-all-reduce":{"total": 483.78, "avg": 483.78, "max": 483.78, "min": 483.78, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 233.40, "avg": 233.40, "max": 233.40, "min": 233.40, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 193.56, "avg": 193.56, "max": 193.56, "min": 193.56, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.31, "avg": 3.31, "max": 3.31, "min": 3.31, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 135, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 76.59, "avg": 25.53, "max": 0.75, "min": 74.35, "cnt": 3}, "forward-compute":{"total": 1788.37, "avg": 55.89, "max": 48.80, "min": 62.41, "cnt": 32}, "fwd-compute":{"total": 1785.07, "avg": 55.78, "max": 48.72, "min": 62.33, "cnt": 32}, "batch-generator":{"total": 57.26, "avg": 1.79, "max": 0.67, "min": 9.77, "cnt": 32}, "fwd-embedding":{"total": 0.66, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1714.79, "avg": 53.59, "max": 47.63, "min": 60.08, "cnt": 32}, "fwd-layernorm":{"total": 10.36, "avg": 0.08, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 111.51, "avg": 0.87, "max": 0.74, "min": 2.52, "cnt": 128}, "fwd-misc":{"total": 22.64, "avg": 0.18, "max": 0.12, "min": 0.42, "cnt": 128}, "fwd-MLP":{"total": 1548.37, "avg": 12.10, "max": 10.10, "min": 20.46, "cnt": 128}, "MoE_L0_fwd":{"total": 450.66, "avg": 14.08, "max": 10.62, "min": 20.37, "cnt": 32}, "MoEMLP":{"total": 1531.00, "avg": 11.96, "max": 9.98, "min": 20.32, "cnt": 128}, "MoE_L1_fwd":{"total": 383.56, "avg": 11.99, "max": 10.71, "min": 14.29, "cnt": 32}, "MoE_L2_fwd":{"total": 366.38, "avg": 11.45, "max": 10.76, "min": 13.19, "cnt": 32}, "MoE_L3_fwd":{"total": 336.76, "avg": 10.52, "max": 10.03, "min": 11.26, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 4.35, "avg": 2.17, "max": 0.95, "min": 3.40, "cnt": 2}, "forward-send-backward-recv":{"total": 220.83, "avg": 7.36, "max": 1.72, "min": 105.34, "cnt": 30}, "backward-compute":{"total": 1497.40, "avg": 46.79, "max": 44.40, "min": 49.51, "cnt": 32}, "MoE_L3_bwd":{"total": 354.53, "avg": 11.08, "max": 9.48, "min": 13.71, "cnt": 32}, "MoE_L2_bwd":{"total": 334.80, "avg": 10.46, "max": 9.46, "min": 11.76, "cnt": 32}, "MoE_L1_bwd":{"total": 310.98, "avg": 9.72, "max": 9.25, "min": 10.16, "cnt": 32}, "MoE_L0_bwd":{"total": 278.76, "avg": 8.71, "max": 8.22, "min": 9.12, "cnt": 32}, "backward-send-forward-recv":{"total": 2431.04, "avg": 83.83, "max": 1.98, "min": 463.47, "cnt": 29}, "backward-send":{"total": 3.12, "avg": 1.04, "max": 0.99, "min": 1.09, "cnt": 3}, "backward-recv":{"total": 296.48, "avg": 148.24, "max": 74.30, "min": 222.18, "cnt": 2}, "backward-params-all-reduce":{"total": 491.85, "avg": 491.85, "max": 491.85, "min": 491.85, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 230.95, "avg": 230.95, "max": 230.95, "min": 230.95, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 184.50, "avg": 184.50, "max": 184.50, "min": 184.50, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}}}
{"type":"time", "iteration": 136, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 65.51, "avg": 21.84, "max": 0.86, "min": 63.02, "cnt": 3}, "forward-compute":{"total": 1823.16, "avg": 56.97, "max": 48.27, "min": 67.30, "cnt": 32}, "fwd-compute":{"total": 1820.00, "avg": 56.88, "max": 48.20, "min": 67.22, "cnt": 32}, "batch-generator":{"total": 42.53, "avg": 1.33, "max": 0.64, "min": 2.36, "cnt": 32}, "fwd-embedding":{"total": 0.64, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1765.23, "avg": 55.16, "max": 47.23, "min": 65.93, "cnt": 32}, "fwd-layernorm":{"total": 10.15, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 110.43, "avg": 0.86, "max": 0.74, "min": 2.22, "cnt": 128}, "fwd-misc":{"total": 22.16, "avg": 0.17, "max": 0.11, "min": 0.55, "cnt": 128}, "fwd-MLP":{"total": 1600.50, "avg": 12.50, "max": 9.77, "min": 18.22, "cnt": 128}, "MoE_L0_fwd":{"total": 461.69, "avg": 14.43, "max": 11.04, "min": 18.15, "cnt": 32}, "MoEMLP":{"total": 1583.33, "avg": 12.37, "max": 9.67, "min": 18.10, "cnt": 128}, "MoE_L1_fwd":{"total": 387.78, "avg": 12.12, "max": 10.37, "min": 14.12, "cnt": 32}, "MoE_L2_fwd":{"total": 384.78, "avg": 12.02, "max": 10.79, "min": 16.22, "cnt": 32}, "MoE_L3_fwd":{"total": 355.40, "avg": 11.11, "max": 9.71, "min": 17.01, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 13.11, "avg": 6.56, "max": 0.86, "min": 12.25, "cnt": 2}, "forward-send-backward-recv":{"total": 242.49, "avg": 8.08, "max": 1.50, "min": 104.02, "cnt": 30}, "backward-compute":{"total": 1510.02, "avg": 47.19, "max": 44.79, "min": 48.64, "cnt": 32}, "MoE_L3_bwd":{"total": 360.74, "avg": 11.27, "max": 10.35, "min": 11.83, "cnt": 32}, "MoE_L2_bwd":{"total": 339.88, "avg": 10.62, "max": 9.80, "min": 12.00, "cnt": 32}, "MoE_L1_bwd":{"total": 309.22, "avg": 9.66, "max": 9.28, "min": 10.25, "cnt": 32}, "MoE_L0_bwd":{"total": 282.98, "avg": 8.84, "max": 8.25, "min": 9.60, "cnt": 32}, "backward-send-forward-recv":{"total": 3170.68, "avg": 109.33, "max": 1.40, "min": 735.17, "cnt": 29}, "backward-send":{"total": 3.43, "avg": 1.14, "max": 1.01, "min": 1.25, "cnt": 3}, "backward-recv":{"total": 126.96, "avg": 63.48, "max": 58.83, "min": 68.13, "cnt": 2}, "backward-params-all-reduce":{"total": 488.43, "avg": 488.43, "max": 488.43, "min": 488.43, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 234.43, "avg": 234.43, "max": 234.43, "min": 234.43, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 194.71, "avg": 194.71, "max": 194.71, "min": 194.71, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.33, "avg": 3.33, "max": 3.33, "min": 3.33, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 137, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 78.28, "avg": 26.09, "max": 1.47, "min": 75.29, "cnt": 3}, "forward-compute":{"total": 1810.40, "avg": 56.57, "max": 47.78, "min": 63.37, "cnt": 32}, "fwd-compute":{"total": 1806.67, "avg": 56.46, "max": 47.72, "min": 63.26, "cnt": 32}, "batch-generator":{"total": 45.11, "avg": 1.41, "max": 0.66, "min": 1.85, "cnt": 32}, "fwd-embedding":{"total": 0.84, "avg": 0.03, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1747.98, "avg": 54.62, "max": 46.76, "min": 61.31, "cnt": 32}, "fwd-layernorm":{"total": 11.63, "avg": 0.09, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 117.49, "avg": 0.92, "max": 0.74, "min": 1.79, "cnt": 128}, "fwd-misc":{"total": 23.99, "avg": 0.19, "max": 0.12, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1571.09, "avg": 12.27, "max": 9.91, "min": 18.66, "cnt": 128}, "MoE_L0_fwd":{"total": 461.53, "avg": 14.42, "max": 10.30, "min": 18.42, "cnt": 32}, "MoEMLP":{"total": 1552.17, "avg": 12.13, "max": 9.81, "min": 18.38, "cnt": 128}, "MoE_L1_fwd":{"total": 392.39, "avg": 12.26, "max": 10.73, "min": 15.40, "cnt": 32}, "MoE_L2_fwd":{"total": 362.99, "avg": 11.34, "max": 10.56, "min": 15.26, "cnt": 32}, "MoE_L3_fwd":{"total": 342.15, "avg": 10.69, "max": 9.85, "min": 14.80, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 6.59, "avg": 3.29, "max": 0.89, "min": 5.70, "cnt": 2}, "forward-send-backward-recv":{"total": 1966.27, "avg": 65.54, "max": 1.87, "min": 543.48, "cnt": 30}, "backward-compute":{"total": 1522.62, "avg": 47.58, "max": 44.27, "min": 88.87, "cnt": 32}, "MoE_L3_bwd":{"total": 386.60, "avg": 12.08, "max": 9.55, "min": 54.68, "cnt": 32}, "MoE_L2_bwd":{"total": 331.44, "avg": 10.36, "max": 8.83, "min": 11.84, "cnt": 32}, "MoE_L1_bwd":{"total": 305.01, "avg": 9.53, "max": 9.03, "min": 10.09, "cnt": 32}, "MoE_L0_bwd":{"total": 279.35, "avg": 8.73, "max": 8.15, "min": 10.37, "cnt": 32}, "backward-send-forward-recv":{"total": 415.06, "avg": 14.31, "max": 1.90, "min": 113.29, "cnt": 29}, "backward-send":{"total": 3.05, "avg": 1.02, "max": 0.90, "min": 1.09, "cnt": 3}, "backward-recv":{"total": 333.75, "avg": 166.87, "max": 74.94, "min": 258.81, "cnt": 2}, "backward-params-all-reduce":{"total": 485.20, "avg": 485.20, "max": 485.20, "min": 485.20, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 238.98, "avg": 238.98, "max": 238.98, "min": 238.98, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 190.91, "avg": 190.91, "max": 190.91, "min": 190.91, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.69, "avg": 6.69, "max": 6.69, "min": 6.69, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}}}
{"type":"time", "iteration": 138, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 62.28, "avg": 20.76, "max": 1.14, "min": 59.60, "cnt": 3}, "forward-compute":{"total": 1831.81, "avg": 57.24, "max": 48.19, "min": 67.60, "cnt": 32}, "fwd-compute":{"total": 1828.60, "avg": 57.14, "max": 48.12, "min": 67.52, "cnt": 32}, "batch-generator":{"total": 40.80, "avg": 1.27, "max": 0.67, "min": 2.12, "cnt": 32}, "fwd-embedding":{"total": 0.67, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1775.07, "avg": 55.47, "max": 47.12, "min": 66.33, "cnt": 32}, "fwd-layernorm":{"total": 10.07, "avg": 0.08, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 109.08, "avg": 0.85, "max": 0.74, "min": 2.09, "cnt": 128}, "fwd-misc":{"total": 21.41, "avg": 0.17, "max": 0.11, "min": 0.41, "cnt": 128}, "fwd-MLP":{"total": 1613.31, "avg": 12.60, "max": 9.93, "min": 21.56, "cnt": 128}, "MoE_L0_fwd":{"total": 496.63, "avg": 15.52, "max": 10.34, "min": 21.47, "cnt": 32}, "MoEMLP":{"total": 1596.34, "avg": 12.47, "max": 9.83, "min": 21.42, "cnt": 128}, "MoE_L1_fwd":{"total": 396.75, "avg": 12.40, "max": 10.86, "min": 15.24, "cnt": 32}, "MoE_L2_fwd":{"total": 369.47, "avg": 11.55, "max": 10.85, "min": 13.94, "cnt": 32}, "MoE_L3_fwd":{"total": 339.67, "avg": 10.61, "max": 9.87, "min": 12.00, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.56, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 11.39, "avg": 5.69, "max": 0.93, "min": 10.46, "cnt": 2}, "forward-send-backward-recv":{"total": 247.18, "avg": 8.24, "max": 1.34, "min": 110.02, "cnt": 30}, "backward-compute":{"total": 1477.88, "avg": 46.18, "max": 44.09, "min": 47.87, "cnt": 32}, "MoE_L3_bwd":{"total": 346.40, "avg": 10.82, "max": 9.56, "min": 13.09, "cnt": 32}, "MoE_L2_bwd":{"total": 335.93, "avg": 10.50, "max": 9.75, "min": 11.63, "cnt": 32}, "MoE_L1_bwd":{"total": 304.94, "avg": 9.53, "max": 9.22, "min": 9.94, "cnt": 32}, "MoE_L0_bwd":{"total": 273.18, "avg": 8.54, "max": 8.13, "min": 8.92, "cnt": 32}, "backward-send-forward-recv":{"total": 2065.31, "avg": 71.22, "max": 1.18, "min": 271.44, "cnt": 29}, "backward-send":{"total": 2.51, "avg": 0.84, "max": 0.64, "min": 1.14, "cnt": 3}, "backward-recv":{"total": 126.77, "avg": 63.39, "max": 55.89, "min": 70.88, "cnt": 2}, "backward-params-all-reduce":{"total": 488.43, "avg": 488.43, "max": 488.43, "min": 488.43, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 232.41, "avg": 232.41, "max": 232.41, "min": 232.41, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 192.55, "avg": 192.55, "max": 192.55, "min": 192.55, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 139, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 68.54, "avg": 22.85, "max": 1.43, "min": 65.64, "cnt": 3}, "forward-compute":{"total": 1839.65, "avg": 57.49, "max": 48.67, "min": 65.75, "cnt": 32}, "fwd-compute":{"total": 1836.27, "avg": 57.38, "max": 48.60, "min": 65.66, "cnt": 32}, "batch-generator":{"total": 50.62, "avg": 1.58, "max": 0.73, "min": 4.33, "cnt": 32}, "fwd-embedding":{"total": 0.66, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1773.07, "avg": 55.41, "max": 47.54, "min": 64.42, "cnt": 32}, "fwd-layernorm":{"total": 10.28, "avg": 0.08, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 108.32, "avg": 0.85, "max": 0.74, "min": 1.49, "cnt": 128}, "fwd-misc":{"total": 21.55, "avg": 0.17, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1611.34, "avg": 12.59, "max": 10.06, "min": 18.70, "cnt": 128}, "MoE_L0_fwd":{"total": 487.04, "avg": 15.22, "max": 10.59, "min": 18.62, "cnt": 32}, "MoEMLP":{"total": 1594.23, "avg": 12.45, "max": 9.95, "min": 18.57, "cnt": 128}, "MoE_L1_fwd":{"total": 396.01, "avg": 12.38, "max": 11.01, "min": 16.42, "cnt": 32}, "MoE_L2_fwd":{"total": 374.49, "avg": 11.70, "max": 10.94, "min": 17.18, "cnt": 32}, "MoE_L3_fwd":{"total": 343.04, "avg": 10.72, "max": 9.99, "min": 11.48, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.56, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.89, "avg": 0.95, "max": 0.94, "min": 0.95, "cnt": 2}, "forward-send-backward-recv":{"total": 1643.70, "avg": 54.79, "max": 1.88, "min": 319.97, "cnt": 30}, "backward-compute":{"total": 1468.79, "avg": 45.90, "max": 43.94, "min": 49.58, "cnt": 32}, "MoE_L3_bwd":{"total": 336.90, "avg": 10.53, "max": 9.44, "min": 11.19, "cnt": 32}, "MoE_L2_bwd":{"total": 334.75, "avg": 10.46, "max": 9.66, "min": 11.21, "cnt": 32}, "MoE_L1_bwd":{"total": 303.72, "avg": 9.49, "max": 8.90, "min": 12.45, "cnt": 32}, "MoE_L0_bwd":{"total": 273.95, "avg": 8.56, "max": 8.21, "min": 9.17, "cnt": 32}, "backward-send-forward-recv":{"total": 3294.87, "avg": 113.62, "max": 1.43, "min": 863.74, "cnt": 29}, "backward-send":{"total": 2.62, "avg": 0.87, "max": 0.64, "min": 1.27, "cnt": 3}, "backward-recv":{"total": 286.97, "avg": 143.49, "max": 86.58, "min": 200.39, "cnt": 2}, "backward-params-all-reduce":{"total": 487.46, "avg": 487.46, "max": 487.46, "min": 487.46, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 231.24, "avg": 231.24, "max": 231.24, "min": 231.24, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 191.23, "avg": 191.23, "max": 191.23, "min": 191.23, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.59, "avg": 3.59, "max": 3.59, "min": 3.59, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}}}
{"type":"time", "iteration": 140, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 80.47, "avg": 26.82, "max": 1.40, "min": 77.44, "cnt": 3}, "forward-compute":{"total": 1811.57, "avg": 56.61, "max": 49.30, "min": 61.50, "cnt": 32}, "fwd-compute":{"total": 1808.25, "avg": 56.51, "max": 49.23, "min": 61.40, "cnt": 32}, "batch-generator":{"total": 45.23, "avg": 1.41, "max": 0.67, "min": 2.84, "cnt": 32}, "fwd-embedding":{"total": 0.68, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1749.00, "avg": 54.66, "max": 48.21, "min": 59.70, "cnt": 32}, "fwd-layernorm":{"total": 10.64, "avg": 0.08, "max": 0.06, "min": 0.24, "cnt": 128}, "fwd-attn":{"total": 113.42, "avg": 0.89, "max": 0.74, "min": 3.27, "cnt": 128}, "fwd-misc":{"total": 22.34, "avg": 0.17, "max": 0.11, "min": 0.45, "cnt": 128}, "fwd-MLP":{"total": 1580.00, "avg": 12.34, "max": 10.03, "min": 19.21, "cnt": 128}, "MoE_L0_fwd":{"total": 469.79, "avg": 14.68, "max": 10.91, "min": 19.13, "cnt": 32}, "MoEMLP":{"total": 1562.29, "avg": 12.21, "max": 9.91, "min": 19.08, "cnt": 128}, "MoE_L1_fwd":{"total": 392.88, "avg": 12.28, "max": 10.98, "min": 14.33, "cnt": 32}, "MoE_L2_fwd":{"total": 366.65, "avg": 11.46, "max": 10.81, "min": 13.44, "cnt": 32}, "MoE_L3_fwd":{"total": 339.40, "avg": 10.61, "max": 9.95, "min": 11.53, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 6.42, "avg": 3.21, "max": 0.89, "min": 5.53, "cnt": 2}, "forward-send-backward-recv":{"total": 235.49, "avg": 7.85, "max": 1.58, "min": 107.64, "cnt": 30}, "backward-compute":{"total": 1469.27, "avg": 45.91, "max": 44.67, "min": 46.97, "cnt": 32}, "MoE_L3_bwd":{"total": 337.34, "avg": 10.54, "max": 9.14, "min": 11.22, "cnt": 32}, "MoE_L2_bwd":{"total": 336.32, "avg": 10.51, "max": 9.81, "min": 11.12, "cnt": 32}, "MoE_L1_bwd":{"total": 303.36, "avg": 9.48, "max": 9.20, "min": 9.68, "cnt": 32}, "MoE_L0_bwd":{"total": 270.46, "avg": 8.45, "max": 7.98, "min": 8.84, "cnt": 32}, "backward-send-forward-recv":{"total": 2612.54, "avg": 90.09, "max": 1.54, "min": 419.52, "cnt": 29}, "backward-send":{"total": 3.15, "avg": 1.05, "max": 0.97, "min": 1.15, "cnt": 3}, "backward-recv":{"total": 504.61, "avg": 252.31, "max": 69.26, "min": 435.35, "cnt": 2}, "backward-params-all-reduce":{"total": 487.05, "avg": 487.05, "max": 487.05, "min": 487.05, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 234.93, "avg": 234.93, "max": 234.93, "min": 234.93, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.40, "avg": 3.40, "max": 3.40, "min": 3.40, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 195.20, "avg": 195.20, "max": 195.20, "min": 195.20, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}}}
{"type":"time", "iteration": 141, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 66.30, "avg": 22.10, "max": 1.54, "min": 63.20, "cnt": 3}, "forward-compute":{"total": 1843.80, "avg": 57.62, "max": 49.86, "min": 64.22, "cnt": 32}, "fwd-compute":{"total": 1840.02, "avg": 57.50, "max": 49.79, "min": 64.09, "cnt": 32}, "batch-generator":{"total": 47.35, "avg": 1.48, "max": 0.67, "min": 3.41, "cnt": 32}, "fwd-embedding":{"total": 0.75, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1778.07, "avg": 55.56, "max": 48.79, "min": 61.63, "cnt": 32}, "fwd-layernorm":{"total": 11.52, "avg": 0.09, "max": 0.06, "min": 0.29, "cnt": 128}, "fwd-attn":{"total": 118.87, "avg": 0.93, "max": 0.74, "min": 3.91, "cnt": 128}, "fwd-misc":{"total": 23.36, "avg": 0.18, "max": 0.11, "min": 0.46, "cnt": 128}, "fwd-MLP":{"total": 1599.99, "avg": 12.50, "max": 10.16, "min": 19.13, "cnt": 128}, "MoE_L0_fwd":{"total": 465.82, "avg": 14.56, "max": 10.75, "min": 19.05, "cnt": 32}, "MoEMLP":{"total": 1581.35, "avg": 12.35, "max": 10.05, "min": 19.01, "cnt": 128}, "MoE_L1_fwd":{"total": 393.89, "avg": 12.31, "max": 11.09, "min": 14.86, "cnt": 32}, "MoE_L2_fwd":{"total": 378.48, "avg": 11.83, "max": 11.13, "min": 13.03, "cnt": 32}, "MoE_L3_fwd":{"total": 349.84, "avg": 10.93, "max": 10.09, "min": 13.35, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.62, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 5.62, "avg": 2.81, "max": 0.80, "min": 4.82, "cnt": 2}, "forward-send-backward-recv":{"total": 702.47, "avg": 23.42, "max": 1.77, "min": 148.87, "cnt": 30}, "backward-compute":{"total": 1489.86, "avg": 46.56, "max": 45.43, "min": 48.81, "cnt": 32}, "MoE_L3_bwd":{"total": 342.06, "avg": 10.69, "max": 9.92, "min": 11.43, "cnt": 32}, "MoE_L2_bwd":{"total": 339.12, "avg": 10.60, "max": 9.74, "min": 11.36, "cnt": 32}, "MoE_L1_bwd":{"total": 309.64, "avg": 9.68, "max": 9.27, "min": 10.82, "cnt": 32}, "MoE_L0_bwd":{"total": 277.42, "avg": 8.67, "max": 8.19, "min": 10.20, "cnt": 32}, "backward-send-forward-recv":{"total": 1266.01, "avg": 43.66, "max": 1.29, "min": 445.74, "cnt": 29}, "backward-send":{"total": 3.34, "avg": 1.11, "max": 1.06, "min": 1.17, "cnt": 3}, "backward-recv":{"total": 143.73, "avg": 71.86, "max": 71.62, "min": 72.11, "cnt": 2}, "backward-params-all-reduce":{"total": 491.75, "avg": 491.75, "max": 491.75, "min": 491.75, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 227.75, "avg": 227.75, "max": 227.75, "min": 227.75, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.41, "avg": 3.41, "max": 3.41, "min": 3.41, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 188.04, "avg": 188.04, "max": 188.04, "min": 188.04, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.30, "avg": 3.30, "max": 3.30, "min": 3.30, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 142, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 77.88, "avg": 25.96, "max": 1.55, "min": 73.73, "cnt": 3}, "forward-compute":{"total": 3149.34, "avg": 98.42, "max": 50.10, "min": 1378.82, "cnt": 32}, "fwd-compute":{"total": 3145.83, "avg": 98.31, "max": 50.03, "min": 1378.74, "cnt": 32}, "batch-generator":{"total": 46.43, "avg": 1.45, "max": 0.76, "min": 3.30, "cnt": 32}, "fwd-embedding":{"total": 0.72, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 3086.12, "avg": 96.44, "max": 48.94, "min": 1377.54, "cnt": 32}, "fwd-layernorm":{"total": 10.99, "avg": 0.09, "max": 0.06, "min": 0.32, "cnt": 128}, "fwd-attn":{"total": 118.95, "avg": 0.93, "max": 0.74, "min": 4.28, "cnt": 128}, "fwd-misc":{"total": 24.30, "avg": 0.19, "max": 0.11, "min": 0.77, "cnt": 128}, "fwd-MLP":{"total": 2908.80, "avg": 22.73, "max": 10.22, "min": 1338.74, "cnt": 128}, "MoE_L0_fwd":{"total": 1788.09, "avg": 55.88, "max": 11.17, "min": 1338.63, "cnt": 32}, "MoEMLP":{"total": 2890.42, "avg": 22.58, "max": 10.11, "min": 1338.57, "cnt": 128}, "MoE_L1_fwd":{"total": 389.95, "avg": 12.19, "max": 10.87, "min": 13.85, "cnt": 32}, "MoE_L2_fwd":{"total": 368.43, "avg": 11.51, "max": 10.69, "min": 14.39, "cnt": 32}, "MoE_L3_fwd":{"total": 350.52, "avg": 10.95, "max": 10.15, "min": 18.79, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.65, "avg": 0.83, "max": 0.64, "min": 1.01, "cnt": 2}, "forward-send-backward-recv":{"total": 245.59, "avg": 8.19, "max": 1.40, "min": 103.47, "cnt": 30}, "backward-compute":{"total": 1474.49, "avg": 46.08, "max": 44.16, "min": 49.36, "cnt": 32}, "MoE_L3_bwd":{"total": 336.32, "avg": 10.51, "max": 9.72, "min": 13.68, "cnt": 32}, "MoE_L2_bwd":{"total": 337.43, "avg": 10.54, "max": 9.70, "min": 11.23, "cnt": 32}, "MoE_L1_bwd":{"total": 307.49, "avg": 9.61, "max": 9.15, "min": 13.00, "cnt": 32}, "MoE_L0_bwd":{"total": 275.95, "avg": 8.62, "max": 7.95, "min": 9.31, "cnt": 32}, "backward-send-forward-recv":{"total": 3279.05, "avg": 113.07, "max": 1.92, "min": 556.85, "cnt": 29}, "backward-send":{"total": 2.79, "avg": 0.93, "max": 0.79, "min": 1.12, "cnt": 3}, "backward-recv":{"total": 156.25, "avg": 78.12, "max": 77.78, "min": 78.46, "cnt": 2}, "backward-params-all-reduce":{"total": 491.45, "avg": 491.45, "max": 491.45, "min": 491.45, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 223.75, "avg": 223.75, "max": 223.75, "min": 223.75, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.41, "avg": 3.41, "max": 3.41, "min": 3.41, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 183.89, "avg": 183.89, "max": 183.89, "min": 183.89, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.36, "avg": 3.36, "max": 3.36, "min": 3.36, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 143, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 76.58, "avg": 25.53, "max": 1.04, "min": 73.92, "cnt": 3}, "forward-compute":{"total": 1849.70, "avg": 57.80, "max": 51.83, "min": 66.52, "cnt": 32}, "fwd-compute":{"total": 1846.22, "avg": 57.69, "max": 51.75, "min": 66.39, "cnt": 32}, "batch-generator":{"total": 43.98, "avg": 1.37, "max": 0.70, "min": 4.73, "cnt": 32}, "fwd-embedding":{"total": 0.71, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1788.77, "avg": 55.90, "max": 49.37, "min": 64.02, "cnt": 32}, "fwd-layernorm":{"total": 10.81, "avg": 0.08, "max": 0.06, "min": 0.37, "cnt": 128}, "fwd-attn":{"total": 108.70, "avg": 0.85, "max": 0.74, "min": 1.47, "cnt": 128}, "fwd-misc":{"total": 21.80, "avg": 0.17, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1625.77, "avg": 12.70, "max": 10.04, "min": 21.29, "cnt": 128}, "MoE_L0_fwd":{"total": 488.46, "avg": 15.26, "max": 10.68, "min": 21.21, "cnt": 32}, "MoEMLP":{"total": 1608.46, "avg": 12.57, "max": 9.94, "min": 21.16, "cnt": 128}, "MoE_L1_fwd":{"total": 406.39, "avg": 12.70, "max": 11.15, "min": 19.00, "cnt": 32}, "MoE_L2_fwd":{"total": 372.84, "avg": 11.65, "max": 10.69, "min": 14.24, "cnt": 32}, "MoE_L3_fwd":{"total": 347.16, "avg": 10.85, "max": 9.98, "min": 11.87, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.65, "avg": 0.02, "max": 0.02, "min": 0.08, "cnt": 32}, "forward-send":{"total": 1.91, "avg": 0.95, "max": 0.94, "min": 0.96, "cnt": 2}, "forward-send-backward-recv":{"total": 1012.25, "avg": 33.74, "max": 1.91, "min": 162.59, "cnt": 30}, "backward-compute":{"total": 1474.97, "avg": 46.09, "max": 43.97, "min": 51.50, "cnt": 32}, "MoE_L3_bwd":{"total": 334.03, "avg": 10.44, "max": 9.56, "min": 12.35, "cnt": 32}, "MoE_L2_bwd":{"total": 337.44, "avg": 10.54, "max": 9.24, "min": 16.44, "cnt": 32}, "MoE_L1_bwd":{"total": 303.67, "avg": 9.49, "max": 9.04, "min": 10.01, "cnt": 32}, "MoE_L0_bwd":{"total": 276.33, "avg": 8.64, "max": 8.23, "min": 9.26, "cnt": 32}, "backward-send-forward-recv":{"total": 721.23, "avg": 24.87, "max": 1.58, "min": 221.28, "cnt": 29}, "backward-send":{"total": 3.22, "avg": 1.07, "max": 0.99, "min": 1.17, "cnt": 3}, "backward-recv":{"total": 191.41, "avg": 95.71, "max": 78.02, "min": 113.40, "cnt": 2}, "backward-params-all-reduce":{"total": 485.10, "avg": 485.10, "max": 485.10, "min": 485.10, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 235.22, "avg": 235.22, "max": 235.22, "min": 235.22, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.41, "avg": 3.41, "max": 3.41, "min": 3.41, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 194.22, "avg": 194.22, "max": 194.22, "min": 194.22, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.56, "avg": 3.56, "max": 3.56, "min": 3.56, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.48, "avg": 3.48, "max": 3.48, "min": 3.48, "cnt": 1}}}
{"type":"time", "iteration": 144, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 74.64, "avg": 24.88, "max": 1.36, "min": 70.38, "cnt": 3}, "forward-compute":{"total": 1788.91, "avg": 55.90, "max": 48.42, "min": 66.51, "cnt": 32}, "fwd-compute":{"total": 1785.41, "avg": 55.79, "max": 48.36, "min": 66.43, "cnt": 32}, "batch-generator":{"total": 45.46, "avg": 1.42, "max": 0.67, "min": 3.71, "cnt": 32}, "fwd-embedding":{"total": 0.68, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1726.49, "avg": 53.95, "max": 47.40, "min": 65.28, "cnt": 32}, "fwd-layernorm":{"total": 10.49, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 111.83, "avg": 0.87, "max": 0.74, "min": 2.55, "cnt": 128}, "fwd-misc":{"total": 21.77, "avg": 0.17, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1560.57, "avg": 12.19, "max": 9.88, "min": 19.84, "cnt": 128}, "MoE_L0_fwd":{"total": 454.85, "avg": 14.21, "max": 10.66, "min": 19.76, "cnt": 32}, "MoEMLP":{"total": 1543.18, "avg": 12.06, "max": 9.77, "min": 19.72, "cnt": 128}, "MoE_L1_fwd":{"total": 384.41, "avg": 12.01, "max": 10.73, "min": 16.31, "cnt": 32}, "MoE_L2_fwd":{"total": 367.27, "avg": 11.48, "max": 10.76, "min": 12.69, "cnt": 32}, "MoE_L3_fwd":{"total": 343.06, "avg": 10.72, "max": 9.81, "min": 16.59, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.63, "avg": 0.02, "max": 0.02, "min": 0.06, "cnt": 32}, "forward-send":{"total": 5.92, "avg": 2.96, "max": 1.04, "min": 4.88, "cnt": 2}, "forward-send-backward-recv":{"total": 582.97, "avg": 19.43, "max": 0.92, "min": 204.11, "cnt": 30}, "backward-compute":{"total": 1481.61, "avg": 46.30, "max": 44.38, "min": 49.92, "cnt": 32}, "MoE_L3_bwd":{"total": 336.44, "avg": 10.51, "max": 9.49, "min": 12.27, "cnt": 32}, "MoE_L2_bwd":{"total": 339.69, "avg": 10.62, "max": 9.49, "min": 11.43, "cnt": 32}, "MoE_L1_bwd":{"total": 307.41, "avg": 9.61, "max": 9.19, "min": 12.38, "cnt": 32}, "MoE_L0_bwd":{"total": 277.00, "avg": 8.66, "max": 8.25, "min": 9.32, "cnt": 32}, "backward-send-forward-recv":{"total": 1212.67, "avg": 41.82, "max": 1.34, "min": 209.50, "cnt": 29}, "backward-send":{"total": 2.34, "avg": 0.78, "max": 0.54, "min": 1.15, "cnt": 3}, "backward-recv":{"total": 139.51, "avg": 69.76, "max": 65.80, "min": 73.71, "cnt": 2}, "backward-params-all-reduce":{"total": 482.89, "avg": 482.89, "max": 482.89, "min": 482.89, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 235.37, "avg": 235.37, "max": 235.37, "min": 235.37, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 195.63, "avg": 195.63, "max": 195.63, "min": 195.63, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.29, "avg": 3.29, "max": 3.29, "min": 3.29, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 145, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 78.61, "avg": 26.20, "max": 1.49, "min": 73.34, "cnt": 3}, "forward-compute":{"total": 1789.53, "avg": 55.92, "max": 47.03, "min": 62.12, "cnt": 32}, "fwd-compute":{"total": 1786.22, "avg": 55.82, "max": 46.96, "min": 61.99, "cnt": 32}, "batch-generator":{"total": 42.21, "avg": 1.32, "max": 0.67, "min": 2.83, "cnt": 32}, "fwd-embedding":{"total": 0.73, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1731.10, "avg": 54.10, "max": 45.98, "min": 59.82, "cnt": 32}, "fwd-layernorm":{"total": 10.92, "avg": 0.09, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 115.94, "avg": 0.91, "max": 0.74, "min": 2.33, "cnt": 128}, "fwd-misc":{"total": 23.24, "avg": 0.18, "max": 0.11, "min": 0.66, "cnt": 128}, "fwd-MLP":{"total": 1558.03, "avg": 12.17, "max": 9.58, "min": 18.74, "cnt": 128}, "MoE_L0_fwd":{"total": 454.80, "avg": 14.21, "max": 10.07, "min": 18.59, "cnt": 32}, "MoEMLP":{"total": 1540.11, "avg": 12.03, "max": 9.47, "min": 18.50, "cnt": 128}, "MoE_L1_fwd":{"total": 388.94, "avg": 12.15, "max": 10.65, "min": 13.71, "cnt": 32}, "MoE_L2_fwd":{"total": 372.30, "avg": 11.63, "max": 10.58, "min": 17.46, "cnt": 32}, "MoE_L3_fwd":{"total": 330.62, "avg": 10.33, "max": 9.51, "min": 11.48, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 3.77, "avg": 1.88, "max": 0.89, "min": 2.88, "cnt": 2}, "forward-send-backward-recv":{"total": 380.52, "avg": 12.68, "max": 1.66, "min": 110.74, "cnt": 30}, "backward-compute":{"total": 1467.23, "avg": 45.85, "max": 44.05, "min": 47.89, "cnt": 32}, "MoE_L3_bwd":{"total": 337.71, "avg": 10.55, "max": 10.08, "min": 12.78, "cnt": 32}, "MoE_L2_bwd":{"total": 338.41, "avg": 10.58, "max": 9.74, "min": 11.68, "cnt": 32}, "MoE_L1_bwd":{"total": 305.04, "avg": 9.53, "max": 9.10, "min": 10.17, "cnt": 32}, "MoE_L0_bwd":{"total": 270.49, "avg": 8.45, "max": 7.85, "min": 8.91, "cnt": 32}, "backward-send-forward-recv":{"total": 1377.80, "avg": 47.51, "max": 2.01, "min": 316.56, "cnt": 29}, "backward-send":{"total": 2.72, "avg": 0.91, "max": 0.69, "min": 1.19, "cnt": 3}, "backward-recv":{"total": 140.90, "avg": 70.45, "max": 69.36, "min": 71.54, "cnt": 2}, "backward-params-all-reduce":{"total": 488.64, "avg": 488.64, "max": 488.64, "min": 488.64, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 238.35, "avg": 238.35, "max": 238.35, "min": 238.35, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.49, "avg": 3.49, "max": 3.49, "min": 3.49, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 193.50, "avg": 193.50, "max": 193.50, "min": 193.50, "cnt": 1}, "optimizer-clip-main-grad":{"total": 5.86, "avg": 5.86, "max": 5.86, "min": 5.86, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 146, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 77.68, "avg": 25.89, "max": 1.58, "min": 73.19, "cnt": 3}, "forward-compute":{"total": 2003.38, "avg": 62.61, "max": 49.05, "min": 224.37, "cnt": 32}, "fwd-compute":{"total": 2000.15, "avg": 62.50, "max": 48.98, "min": 224.19, "cnt": 32}, "batch-generator":{"total": 41.94, "avg": 1.31, "max": 0.70, "min": 2.45, "cnt": 32}, "fwd-embedding":{"total": 0.67, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1945.30, "avg": 60.79, "max": 47.98, "min": 221.64, "cnt": 32}, "fwd-layernorm":{"total": 10.24, "avg": 0.08, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 111.54, "avg": 0.87, "max": 0.74, "min": 2.21, "cnt": 128}, "fwd-misc":{"total": 21.90, "avg": 0.17, "max": 0.12, "min": 0.43, "cnt": 128}, "fwd-MLP":{"total": 1779.53, "avg": 13.90, "max": 9.74, "min": 182.93, "cnt": 128}, "MoE_L0_fwd":{"total": 654.72, "avg": 20.46, "max": 10.57, "min": 182.78, "cnt": 32}, "MoEMLP":{"total": 1762.29, "avg": 13.77, "max": 9.64, "min": 182.70, "cnt": 128}, "MoE_L1_fwd":{"total": 396.47, "avg": 12.39, "max": 10.88, "min": 17.42, "cnt": 32}, "MoE_L2_fwd":{"total": 372.12, "avg": 11.63, "max": 10.72, "min": 17.61, "cnt": 32}, "MoE_L3_fwd":{"total": 345.20, "avg": 10.79, "max": 9.67, "min": 15.03, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.72, "avg": 0.86, "max": 0.80, "min": 0.92, "cnt": 2}, "forward-send-backward-recv":{"total": 195.73, "avg": 6.52, "max": 1.58, "min": 110.65, "cnt": 30}, "backward-compute":{"total": 1490.77, "avg": 46.59, "max": 43.26, "min": 48.68, "cnt": 32}, "MoE_L3_bwd":{"total": 340.04, "avg": 10.63, "max": 9.83, "min": 12.60, "cnt": 32}, "MoE_L2_bwd":{"total": 342.77, "avg": 10.71, "max": 9.46, "min": 13.06, "cnt": 32}, "MoE_L1_bwd":{"total": 310.95, "avg": 9.72, "max": 9.24, "min": 10.13, "cnt": 32}, "MoE_L0_bwd":{"total": 276.03, "avg": 8.63, "max": 7.60, "min": 10.22, "cnt": 32}, "backward-send-forward-recv":{"total": 2286.53, "avg": 78.85, "max": 1.41, "min": 494.20, "cnt": 29}, "backward-send":{"total": 2.27, "avg": 0.76, "max": 0.56, "min": 0.86, "cnt": 3}, "backward-recv":{"total": 142.71, "avg": 71.35, "max": 69.11, "min": 73.60, "cnt": 2}, "backward-params-all-reduce":{"total": 485.87, "avg": 485.87, "max": 485.87, "min": 485.87, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 229.36, "avg": 229.36, "max": 229.36, "min": 229.36, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 189.43, "avg": 189.43, "max": 189.43, "min": 189.43, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.32, "avg": 3.32, "max": 3.32, "min": 3.32, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 147, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 68.55, "avg": 22.85, "max": 1.44, "min": 65.10, "cnt": 3}, "forward-compute":{"total": 1803.20, "avg": 56.35, "max": 49.41, "min": 61.97, "cnt": 32}, "fwd-compute":{"total": 1799.66, "avg": 56.24, "max": 49.34, "min": 61.84, "cnt": 32}, "batch-generator":{"total": 43.13, "avg": 1.35, "max": 0.67, "min": 2.58, "cnt": 32}, "fwd-embedding":{"total": 0.76, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1743.28, "avg": 54.48, "max": 48.37, "min": 59.83, "cnt": 32}, "fwd-layernorm":{"total": 10.94, "avg": 0.09, "max": 0.06, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 115.35, "avg": 0.90, "max": 0.74, "min": 2.43, "cnt": 128}, "fwd-misc":{"total": 23.21, "avg": 0.18, "max": 0.11, "min": 0.51, "cnt": 128}, "fwd-MLP":{"total": 1570.52, "avg": 12.27, "max": 9.70, "min": 18.60, "cnt": 128}, "MoE_L0_fwd":{"total": 454.92, "avg": 14.22, "max": 10.29, "min": 18.49, "cnt": 32}, "MoEMLP":{"total": 1552.53, "avg": 12.13, "max": 9.60, "min": 18.44, "cnt": 128}, "MoE_L1_fwd":{"total": 390.43, "avg": 12.20, "max": 10.98, "min": 15.85, "cnt": 32}, "MoE_L2_fwd":{"total": 371.23, "avg": 11.60, "max": 10.78, "min": 13.93, "cnt": 32}, "MoE_L3_fwd":{"total": 342.54, "avg": 10.70, "max": 9.64, "min": 18.48, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 5.41, "avg": 2.70, "max": 0.89, "min": 4.52, "cnt": 2}, "forward-send-backward-recv":{"total": 426.06, "avg": 14.20, "max": 1.74, "min": 110.93, "cnt": 30}, "backward-compute":{"total": 1479.38, "avg": 46.23, "max": 45.04, "min": 48.62, "cnt": 32}, "MoE_L3_bwd":{"total": 338.03, "avg": 10.56, "max": 9.62, "min": 13.19, "cnt": 32}, "MoE_L2_bwd":{"total": 336.34, "avg": 10.51, "max": 9.94, "min": 11.52, "cnt": 32}, "MoE_L1_bwd":{"total": 309.69, "avg": 9.68, "max": 9.38, "min": 10.28, "cnt": 32}, "MoE_L0_bwd":{"total": 274.61, "avg": 8.58, "max": 8.25, "min": 8.91, "cnt": 32}, "backward-send-forward-recv":{"total": 1278.06, "avg": 44.07, "max": 1.64, "min": 250.76, "cnt": 29}, "backward-send":{"total": 2.46, "avg": 0.82, "max": 0.58, "min": 1.04, "cnt": 3}, "backward-recv":{"total": 135.33, "avg": 67.67, "max": 64.80, "min": 70.53, "cnt": 2}, "backward-params-all-reduce":{"total": 486.06, "avg": 486.06, "max": 486.06, "min": 486.06, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 226.04, "avg": 226.04, "max": 226.04, "min": 226.04, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 186.21, "avg": 186.21, "max": 186.21, "min": 186.21, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.66, "avg": 3.66, "max": 3.66, "min": 3.66, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 148, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 74.87, "avg": 24.96, "max": 0.72, "min": 72.44, "cnt": 3}, "forward-compute":{"total": 1831.39, "avg": 57.23, "max": 48.33, "min": 67.95, "cnt": 32}, "fwd-compute":{"total": 1828.07, "avg": 57.13, "max": 48.26, "min": 67.84, "cnt": 32}, "batch-generator":{"total": 45.21, "avg": 1.41, "max": 0.68, "min": 3.50, "cnt": 32}, "fwd-embedding":{"total": 0.62, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1770.10, "avg": 55.32, "max": 47.27, "min": 66.13, "cnt": 32}, "fwd-layernorm":{"total": 9.79, "avg": 0.08, "max": 0.06, "min": 0.18, "cnt": 128}, "fwd-attn":{"total": 108.43, "avg": 0.85, "max": 0.74, "min": 2.03, "cnt": 128}, "fwd-misc":{"total": 21.37, "avg": 0.17, "max": 0.11, "min": 0.39, "cnt": 128}, "fwd-MLP":{"total": 1609.25, "avg": 12.57, "max": 9.44, "min": 24.11, "cnt": 128}, "MoE_L0_fwd":{"total": 467.56, "avg": 14.61, "max": 10.27, "min": 24.03, "cnt": 32}, "MoEMLP":{"total": 1592.48, "avg": 12.44, "max": 9.34, "min": 23.97, "cnt": 128}, "MoE_L1_fwd":{"total": 403.57, "avg": 12.61, "max": 10.87, "min": 16.06, "cnt": 32}, "MoE_L2_fwd":{"total": 377.65, "avg": 11.80, "max": 10.57, "min": 15.62, "cnt": 32}, "MoE_L3_fwd":{"total": 349.82, "avg": 10.93, "max": 9.38, "min": 14.96, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.63, "avg": 0.02, "max": 0.02, "min": 0.05, "cnt": 32}, "forward-send":{"total": 10.45, "avg": 5.22, "max": 0.87, "min": 9.58, "cnt": 2}, "forward-send-backward-recv":{"total": 1092.60, "avg": 36.42, "max": 1.18, "min": 170.08, "cnt": 30}, "backward-compute":{"total": 1492.75, "avg": 46.65, "max": 45.16, "min": 49.67, "cnt": 32}, "MoE_L3_bwd":{"total": 345.56, "avg": 10.80, "max": 9.76, "min": 13.38, "cnt": 32}, "MoE_L2_bwd":{"total": 332.82, "avg": 10.40, "max": 9.08, "min": 11.24, "cnt": 32}, "MoE_L1_bwd":{"total": 313.71, "avg": 9.80, "max": 9.53, "min": 10.60, "cnt": 32}, "MoE_L0_bwd":{"total": 279.22, "avg": 8.73, "max": 8.16, "min": 9.86, "cnt": 32}, "backward-send-forward-recv":{"total": 1511.93, "avg": 52.14, "max": 1.25, "min": 530.44, "cnt": 29}, "backward-send":{"total": 2.41, "avg": 0.80, "max": 0.70, "min": 1.00, "cnt": 3}, "backward-recv":{"total": 139.84, "avg": 69.92, "max": 69.12, "min": 70.72, "cnt": 2}, "backward-params-all-reduce":{"total": 486.91, "avg": 486.91, "max": 486.91, "min": 486.91, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 229.46, "avg": 229.46, "max": 229.46, "min": 229.46, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 189.36, "avg": 189.36, "max": 189.36, "min": 189.36, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.64, "avg": 3.64, "max": 3.64, "min": 3.64, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 149, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 428.06, "avg": 142.69, "max": 1.24, "min": 425.17, "cnt": 3}, "forward-compute":{"total": 1860.77, "avg": 58.15, "max": 51.29, "min": 63.52, "cnt": 32}, "fwd-compute":{"total": 1857.43, "avg": 58.04, "max": 51.21, "min": 63.41, "cnt": 32}, "batch-generator":{"total": 39.26, "avg": 1.23, "max": 0.72, "min": 1.81, "cnt": 32}, "fwd-embedding":{"total": 0.66, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1805.67, "avg": 56.43, "max": 50.17, "min": 61.65, "cnt": 32}, "fwd-layernorm":{"total": 10.25, "avg": 0.08, "max": 0.06, "min": 0.18, "cnt": 128}, "fwd-attn":{"total": 112.53, "avg": 0.88, "max": 0.74, "min": 2.00, "cnt": 128}, "fwd-misc":{"total": 22.61, "avg": 0.18, "max": 0.12, "min": 0.41, "cnt": 128}, "fwd-MLP":{"total": 1638.52, "avg": 12.80, "max": 10.09, "min": 17.87, "cnt": 128}, "MoE_L0_fwd":{"total": 486.09, "avg": 15.19, "max": 10.73, "min": 17.75, "cnt": 32}, "MoEMLP":{"total": 1621.26, "avg": 12.67, "max": 9.98, "min": 17.71, "cnt": 128}, "MoE_L1_fwd":{"total": 417.90, "avg": 13.06, "max": 11.24, "min": 16.75, "cnt": 32}, "MoE_L2_fwd":{"total": 377.07, "avg": 11.78, "max": 11.19, "min": 12.60, "cnt": 32}, "MoE_L3_fwd":{"total": 346.58, "avg": 10.83, "max": 10.02, "min": 13.46, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.61, "avg": 0.02, "max": 0.02, "min": 0.04, "cnt": 32}, "forward-send":{"total": 11.40, "avg": 5.70, "max": 0.89, "min": 10.50, "cnt": 2}, "forward-send-backward-recv":{"total": 1213.72, "avg": 40.46, "max": 1.69, "min": 217.83, "cnt": 30}, "backward-compute":{"total": 1506.72, "avg": 47.08, "max": 44.80, "min": 49.81, "cnt": 32}, "MoE_L3_bwd":{"total": 343.28, "avg": 10.73, "max": 9.95, "min": 11.93, "cnt": 32}, "MoE_L2_bwd":{"total": 349.32, "avg": 10.92, "max": 10.14, "min": 13.78, "cnt": 32}, "MoE_L1_bwd":{"total": 323.90, "avg": 10.12, "max": 9.45, "min": 12.24, "cnt": 32}, "MoE_L0_bwd":{"total": 277.51, "avg": 8.67, "max": 8.06, "min": 9.27, "cnt": 32}, "backward-send-forward-recv":{"total": 1320.83, "avg": 45.55, "max": 1.50, "min": 510.70, "cnt": 29}, "backward-send":{"total": 2.69, "avg": 0.90, "max": 0.77, "min": 1.14, "cnt": 3}, "backward-recv":{"total": 292.33, "avg": 146.16, "max": 70.81, "min": 221.52, "cnt": 2}, "backward-params-all-reduce":{"total": 484.69, "avg": 484.69, "max": 484.69, "min": 484.69, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 233.78, "avg": 233.78, "max": 233.78, "min": 233.78, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 193.60, "avg": 193.60, "max": 193.60, "min": 193.60, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.63, "avg": 3.63, "max": 3.63, "min": 3.63, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 150, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 83.11, "avg": 27.70, "max": 1.59, "min": 72.56, "cnt": 3}, "forward-compute":{"total": 1893.59, "avg": 59.17, "max": 49.79, "min": 66.45, "cnt": 32}, "fwd-compute":{"total": 1889.73, "avg": 59.05, "max": 49.73, "min": 66.31, "cnt": 32}, "batch-generator":{"total": 49.91, "avg": 1.56, "max": 0.67, "min": 2.77, "cnt": 32}, "fwd-embedding":{"total": 0.83, "avg": 0.03, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1825.51, "avg": 57.05, "max": 48.76, "min": 64.01, "cnt": 32}, "fwd-layernorm":{"total": 11.56, "avg": 0.09, "max": 0.06, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 117.24, "avg": 0.92, "max": 0.74, "min": 1.56, "cnt": 128}, "fwd-misc":{"total": 23.90, "avg": 0.19, "max": 0.11, "min": 0.42, "cnt": 128}, "fwd-MLP":{"total": 1648.91, "avg": 12.88, "max": 9.96, "min": 20.74, "cnt": 128}, "MoE_L0_fwd":{"total": 494.41, "avg": 15.45, "max": 10.82, "min": 20.64, "cnt": 32}, "MoEMLP":{"total": 1629.87, "avg": 12.73, "max": 9.86, "min": 20.57, "cnt": 128}, "MoE_L1_fwd":{"total": 409.73, "avg": 12.80, "max": 11.33, "min": 17.32, "cnt": 32}, "MoE_L2_fwd":{"total": 382.71, "avg": 11.96, "max": 10.90, "min": 16.64, "cnt": 32}, "MoE_L3_fwd":{"total": 349.91, "avg": 10.93, "max": 9.90, "min": 14.48, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.84, "avg": 0.92, "max": 0.85, "min": 0.99, "cnt": 2}, "forward-send-backward-recv":{"total": 1050.28, "avg": 35.01, "max": 1.13, "min": 135.08, "cnt": 30}, "backward-compute":{"total": 1499.72, "avg": 46.87, "max": 45.12, "min": 49.27, "cnt": 32}, "MoE_L3_bwd":{"total": 341.22, "avg": 10.66, "max": 9.34, "min": 12.86, "cnt": 32}, "MoE_L2_bwd":{"total": 339.85, "avg": 10.62, "max": 9.77, "min": 11.29, "cnt": 32}, "MoE_L1_bwd":{"total": 321.76, "avg": 10.05, "max": 9.40, "min": 10.63, "cnt": 32}, "MoE_L0_bwd":{"total": 277.25, "avg": 8.66, "max": 8.06, "min": 8.97, "cnt": 32}, "backward-send-forward-recv":{"total": 799.81, "avg": 27.58, "max": 1.27, "min": 538.37, "cnt": 29}, "backward-send":{"total": 3.32, "avg": 1.11, "max": 1.08, "min": 1.15, "cnt": 3}, "backward-recv":{"total": 311.98, "avg": 155.99, "max": 61.64, "min": 250.34, "cnt": 2}, "backward-params-all-reduce":{"total": 486.34, "avg": 486.34, "max": 486.34, "min": 486.34, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 232.32, "avg": 232.32, "max": 232.32, "min": 232.32, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 192.50, "avg": 192.50, "max": 192.50, "min": 192.50, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 151, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 69.69, "avg": 23.23, "max": 1.19, "min": 66.96, "cnt": 3}, "forward-compute":{"total": 1833.20, "avg": 57.29, "max": 48.69, "min": 65.46, "cnt": 32}, "fwd-compute":{"total": 1829.67, "avg": 57.18, "max": 48.62, "min": 65.34, "cnt": 32}, "batch-generator":{"total": 41.53, "avg": 1.30, "max": 0.66, "min": 2.15, "cnt": 32}, "fwd-embedding":{"total": 0.69, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1774.62, "avg": 55.46, "max": 47.66, "min": 63.62, "cnt": 32}, "fwd-layernorm":{"total": 10.68, "avg": 0.08, "max": 0.06, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 115.21, "avg": 0.90, "max": 0.74, "min": 2.79, "cnt": 128}, "fwd-misc":{"total": 23.16, "avg": 0.18, "max": 0.12, "min": 0.39, "cnt": 128}, "fwd-MLP":{"total": 1602.58, "avg": 12.52, "max": 9.91, "min": 18.99, "cnt": 128}, "MoE_L0_fwd":{"total": 467.86, "avg": 14.62, "max": 10.66, "min": 18.86, "cnt": 32}, "MoEMLP":{"total": 1584.34, "avg": 12.38, "max": 9.80, "min": 18.82, "cnt": 128}, "MoE_L1_fwd":{"total": 401.83, "avg": 12.56, "max": 11.18, "min": 15.71, "cnt": 32}, "MoE_L2_fwd":{"total": 379.92, "avg": 11.87, "max": 10.92, "min": 16.93, "cnt": 32}, "MoE_L3_fwd":{"total": 341.27, "avg": 10.66, "max": 9.84, "min": 13.27, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 2.97, "avg": 1.49, "max": 0.99, "min": 1.98, "cnt": 2}, "forward-send-backward-recv":{"total": 200.87, "avg": 6.70, "max": 1.04, "min": 111.31, "cnt": 30}, "backward-compute":{"total": 1531.42, "avg": 47.86, "max": 44.12, "min": 56.22, "cnt": 32}, "MoE_L3_bwd":{"total": 360.44, "avg": 11.26, "max": 9.11, "min": 20.18, "cnt": 32}, "MoE_L2_bwd":{"total": 342.79, "avg": 10.71, "max": 9.13, "min": 12.77, "cnt": 32}, "MoE_L1_bwd":{"total": 327.71, "avg": 10.24, "max": 9.76, "min": 10.67, "cnt": 32}, "MoE_L0_bwd":{"total": 281.00, "avg": 8.78, "max": 8.29, "min": 9.11, "cnt": 32}, "backward-send-forward-recv":{"total": 1753.71, "avg": 60.47, "max": 2.06, "min": 352.96, "cnt": 29}, "backward-send":{"total": 2.87, "avg": 0.96, "max": 0.89, "min": 0.99, "cnt": 3}, "backward-recv":{"total": 141.75, "avg": 70.88, "max": 69.75, "min": 72.00, "cnt": 2}, "backward-params-all-reduce":{"total": 490.57, "avg": 490.57, "max": 490.57, "min": 490.57, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 230.39, "avg": 230.39, "max": 230.39, "min": 230.39, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 190.57, "avg": 190.57, "max": 190.57, "min": 190.57, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.36, "avg": 3.36, "max": 3.36, "min": 3.36, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 152, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 67.48, "avg": 22.49, "max": 1.38, "min": 64.55, "cnt": 3}, "forward-compute":{"total": 1797.75, "avg": 56.18, "max": 47.90, "min": 65.88, "cnt": 32}, "fwd-compute":{"total": 1794.64, "avg": 56.08, "max": 47.83, "min": 65.81, "cnt": 32}, "batch-generator":{"total": 41.69, "avg": 1.30, "max": 0.64, "min": 2.58, "cnt": 32}, "fwd-embedding":{"total": 0.71, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1740.26, "avg": 54.38, "max": 46.88, "min": 62.76, "cnt": 32}, "fwd-layernorm":{"total": 10.42, "avg": 0.08, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 111.48, "avg": 0.87, "max": 0.74, "min": 2.47, "cnt": 128}, "fwd-misc":{"total": 21.89, "avg": 0.17, "max": 0.11, "min": 0.40, "cnt": 128}, "fwd-MLP":{"total": 1574.65, "avg": 12.30, "max": 9.89, "min": 19.54, "cnt": 128}, "MoE_L0_fwd":{"total": 458.87, "avg": 14.34, "max": 10.38, "min": 19.43, "cnt": 32}, "MoEMLP":{"total": 1557.58, "avg": 12.17, "max": 9.78, "min": 19.36, "cnt": 128}, "MoE_L1_fwd":{"total": 390.33, "avg": 12.20, "max": 11.01, "min": 14.16, "cnt": 32}, "MoE_L2_fwd":{"total": 369.26, "avg": 11.54, "max": 10.71, "min": 12.89, "cnt": 32}, "MoE_L3_fwd":{"total": 345.46, "avg": 10.80, "max": 9.82, "min": 13.23, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.56, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 11.60, "avg": 5.80, "max": 1.00, "min": 10.60, "cnt": 2}, "forward-send-backward-recv":{"total": 206.20, "avg": 6.87, "max": 1.57, "min": 132.46, "cnt": 30}, "backward-compute":{"total": 1508.04, "avg": 47.13, "max": 44.37, "min": 50.45, "cnt": 32}, "MoE_L3_bwd":{"total": 351.18, "avg": 10.97, "max": 10.23, "min": 11.70, "cnt": 32}, "MoE_L2_bwd":{"total": 334.60, "avg": 10.46, "max": 9.82, "min": 11.06, "cnt": 32}, "MoE_L1_bwd":{"total": 327.41, "avg": 10.23, "max": 9.29, "min": 13.59, "cnt": 32}, "MoE_L0_bwd":{"total": 274.35, "avg": 8.57, "max": 8.00, "min": 11.77, "cnt": 32}, "backward-send-forward-recv":{"total": 2718.72, "avg": 93.75, "max": 1.72, "min": 358.62, "cnt": 29}, "backward-send":{"total": 2.72, "avg": 0.91, "max": 0.81, "min": 0.97, "cnt": 3}, "backward-recv":{"total": 139.11, "avg": 69.56, "max": 68.75, "min": 70.37, "cnt": 2}, "backward-params-all-reduce":{"total": 484.51, "avg": 484.51, "max": 484.51, "min": 484.51, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 233.96, "avg": 233.96, "max": 233.96, "min": 233.96, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 193.97, "avg": 193.97, "max": 193.97, "min": 193.97, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.59, "avg": 3.59, "max": 3.59, "min": 3.59, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 153, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 76.81, "avg": 25.60, "max": 1.19, "min": 74.23, "cnt": 3}, "forward-compute":{"total": 1820.02, "avg": 56.88, "max": 49.10, "min": 65.56, "cnt": 32}, "fwd-compute":{"total": 1816.26, "avg": 56.76, "max": 49.04, "min": 65.47, "cnt": 32}, "batch-generator":{"total": 47.38, "avg": 1.48, "max": 0.65, "min": 2.70, "cnt": 32}, "fwd-embedding":{"total": 0.83, "avg": 0.03, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1754.75, "avg": 54.84, "max": 48.00, "min": 63.76, "cnt": 32}, "fwd-layernorm":{"total": 11.56, "avg": 0.09, "max": 0.06, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 118.48, "avg": 0.93, "max": 0.74, "min": 1.97, "cnt": 128}, "fwd-misc":{"total": 24.65, "avg": 0.19, "max": 0.12, "min": 0.39, "cnt": 128}, "fwd-MLP":{"total": 1575.66, "avg": 12.31, "max": 10.02, "min": 20.30, "cnt": 128}, "MoE_L0_fwd":{"total": 454.32, "avg": 14.20, "max": 10.30, "min": 20.20, "cnt": 32}, "MoEMLP":{"total": 1556.34, "avg": 12.16, "max": 9.91, "min": 20.16, "cnt": 128}, "MoE_L1_fwd":{"total": 397.45, "avg": 12.42, "max": 11.04, "min": 16.08, "cnt": 32}, "MoE_L2_fwd":{"total": 367.29, "avg": 11.48, "max": 10.79, "min": 12.70, "cnt": 32}, "MoE_L3_fwd":{"total": 344.28, "avg": 10.76, "max": 9.95, "min": 11.97, "cnt": 32}, "fwd-pooler":{"total": 0.36, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.63, "avg": 0.02, "max": 0.02, "min": 0.05, "cnt": 32}, "forward-send":{"total": 2.64, "avg": 1.32, "max": 1.01, "min": 1.63, "cnt": 2}, "forward-send-backward-recv":{"total": 682.79, "avg": 22.76, "max": 1.71, "min": 179.23, "cnt": 30}, "backward-compute":{"total": 1507.22, "avg": 47.10, "max": 45.39, "min": 52.16, "cnt": 32}, "MoE_L3_bwd":{"total": 350.59, "avg": 10.96, "max": 10.19, "min": 13.19, "cnt": 32}, "MoE_L2_bwd":{"total": 340.95, "avg": 10.65, "max": 9.80, "min": 12.99, "cnt": 32}, "MoE_L1_bwd":{"total": 320.23, "avg": 10.01, "max": 9.64, "min": 10.48, "cnt": 32}, "MoE_L0_bwd":{"total": 275.69, "avg": 8.62, "max": 7.99, "min": 9.01, "cnt": 32}, "backward-send-forward-recv":{"total": 954.84, "avg": 32.93, "max": 2.27, "min": 190.33, "cnt": 29}, "backward-send":{"total": 3.03, "avg": 1.01, "max": 0.82, "min": 1.15, "cnt": 3}, "backward-recv":{"total": 155.12, "avg": 77.56, "max": 70.45, "min": 84.67, "cnt": 2}, "backward-params-all-reduce":{"total": 525.14, "avg": 525.14, "max": 525.14, "min": 525.14, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 244.29, "avg": 244.29, "max": 244.29, "min": 244.29, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 191.24, "avg": 191.24, "max": 191.24, "min": 191.24, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.83, "avg": 6.83, "max": 6.83, "min": 6.83, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 154, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 74.36, "avg": 24.79, "max": 1.38, "min": 67.73, "cnt": 3}, "forward-compute":{"total": 1795.66, "avg": 56.11, "max": 49.56, "min": 63.24, "cnt": 32}, "fwd-compute":{"total": 1792.32, "avg": 56.01, "max": 49.48, "min": 63.11, "cnt": 32}, "batch-generator":{"total": 40.90, "avg": 1.28, "max": 0.66, "min": 1.88, "cnt": 32}, "fwd-embedding":{"total": 0.70, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1738.66, "avg": 54.33, "max": 48.50, "min": 60.95, "cnt": 32}, "fwd-layernorm":{"total": 10.36, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 110.63, "avg": 0.86, "max": 0.74, "min": 1.82, "cnt": 128}, "fwd-misc":{"total": 22.21, "avg": 0.17, "max": 0.12, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1573.71, "avg": 12.29, "max": 9.98, "min": 19.16, "cnt": 128}, "MoE_L0_fwd":{"total": 447.06, "avg": 13.97, "max": 10.61, "min": 19.08, "cnt": 32}, "MoEMLP":{"total": 1556.44, "avg": 12.16, "max": 9.88, "min": 19.03, "cnt": 128}, "MoE_L1_fwd":{"total": 395.26, "avg": 12.35, "max": 11.07, "min": 14.45, "cnt": 32}, "MoE_L2_fwd":{"total": 366.69, "avg": 11.46, "max": 10.64, "min": 13.48, "cnt": 32}, "MoE_L3_fwd":{"total": 353.77, "avg": 11.06, "max": 9.91, "min": 16.89, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 3.63, "avg": 1.81, "max": 1.02, "min": 2.60, "cnt": 2}, "forward-send-backward-recv":{"total": 342.42, "avg": 11.41, "max": 1.73, "min": 105.84, "cnt": 30}, "backward-compute":{"total": 1591.25, "avg": 49.73, "max": 44.77, "min": 132.65, "cnt": 32}, "MoE_L3_bwd":{"total": 431.88, "avg": 13.50, "max": 10.28, "min": 92.90, "cnt": 32}, "MoE_L2_bwd":{"total": 345.24, "avg": 10.79, "max": 9.87, "min": 14.67, "cnt": 32}, "MoE_L1_bwd":{"total": 321.08, "avg": 10.03, "max": 9.55, "min": 10.55, "cnt": 32}, "MoE_L0_bwd":{"total": 274.87, "avg": 8.59, "max": 7.70, "min": 9.68, "cnt": 32}, "backward-send-forward-recv":{"total": 1160.95, "avg": 40.03, "max": 1.89, "min": 244.10, "cnt": 29}, "backward-send":{"total": 3.26, "avg": 1.09, "max": 0.91, "min": 1.33, "cnt": 3}, "backward-recv":{"total": 143.75, "avg": 71.88, "max": 69.28, "min": 74.47, "cnt": 2}, "backward-params-all-reduce":{"total": 488.55, "avg": 488.55, "max": 488.55, "min": 488.55, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.04, "avg": 0.04, "max": 0.04, "min": 0.04, "cnt": 1}, "optimizer":{"total": 236.85, "avg": 236.85, "max": 236.85, "min": 236.85, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 192.12, "avg": 192.12, "max": 192.12, "min": 192.12, "cnt": 1}, "optimizer-clip-main-grad":{"total": 9.04, "avg": 9.04, "max": 9.04, "min": 9.04, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 155, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 66.68, "avg": 22.23, "max": 1.20, "min": 63.88, "cnt": 3}, "forward-compute":{"total": 1786.57, "avg": 55.83, "max": 48.71, "min": 64.35, "cnt": 32}, "fwd-compute":{"total": 1783.39, "avg": 55.73, "max": 48.62, "min": 64.22, "cnt": 32}, "batch-generator":{"total": 41.97, "avg": 1.31, "max": 0.66, "min": 2.76, "cnt": 32}, "fwd-embedding":{"total": 0.62, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1728.85, "avg": 54.03, "max": 47.59, "min": 62.24, "cnt": 32}, "fwd-layernorm":{"total": 9.90, "avg": 0.08, "max": 0.06, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 109.61, "avg": 0.86, "max": 0.74, "min": 1.89, "cnt": 128}, "fwd-misc":{"total": 20.78, "avg": 0.16, "max": 0.11, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1567.62, "avg": 12.25, "max": 10.00, "min": 19.13, "cnt": 128}, "MoE_L0_fwd":{"total": 456.09, "avg": 14.25, "max": 10.26, "min": 19.05, "cnt": 32}, "MoEMLP":{"total": 1550.84, "avg": 12.12, "max": 9.90, "min": 19.00, "cnt": 128}, "MoE_L1_fwd":{"total": 394.98, "avg": 12.34, "max": 10.91, "min": 16.78, "cnt": 32}, "MoE_L2_fwd":{"total": 367.75, "avg": 11.49, "max": 10.75, "min": 13.61, "cnt": 32}, "MoE_L3_fwd":{"total": 338.11, "avg": 10.57, "max": 9.93, "min": 11.83, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 14.86, "avg": 7.43, "max": 0.89, "min": 13.97, "cnt": 2}, "forward-send-backward-recv":{"total": 542.73, "avg": 18.09, "max": 1.74, "min": 303.25, "cnt": 30}, "backward-compute":{"total": 1495.29, "avg": 46.73, "max": 43.94, "min": 49.19, "cnt": 32}, "MoE_L3_bwd":{"total": 347.37, "avg": 10.86, "max": 9.42, "min": 12.71, "cnt": 32}, "MoE_L2_bwd":{"total": 337.43, "avg": 10.54, "max": 10.08, "min": 11.64, "cnt": 32}, "MoE_L1_bwd":{"total": 317.07, "avg": 9.91, "max": 9.32, "min": 10.35, "cnt": 32}, "MoE_L0_bwd":{"total": 276.42, "avg": 8.64, "max": 8.24, "min": 8.94, "cnt": 32}, "backward-send-forward-recv":{"total": 4054.69, "avg": 139.82, "max": 2.24, "min": 1268.21, "cnt": 29}, "backward-send":{"total": 3.06, "avg": 1.02, "max": 0.92, "min": 1.11, "cnt": 3}, "backward-recv":{"total": 315.97, "avg": 157.98, "max": 66.42, "min": 249.54, "cnt": 2}, "backward-params-all-reduce":{"total": 485.41, "avg": 485.41, "max": 485.41, "min": 485.41, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 233.68, "avg": 233.68, "max": 233.68, "min": 233.68, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 193.79, "avg": 193.79, "max": 193.79, "min": 193.79, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 156, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 74.58, "avg": 24.86, "max": 1.17, "min": 72.15, "cnt": 3}, "forward-compute":{"total": 1845.22, "avg": 57.66, "max": 50.03, "min": 63.57, "cnt": 32}, "fwd-compute":{"total": 1841.65, "avg": 57.55, "max": 49.95, "min": 63.46, "cnt": 32}, "batch-generator":{"total": 41.59, "avg": 1.30, "max": 0.69, "min": 2.41, "cnt": 32}, "fwd-embedding":{"total": 0.70, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1786.09, "avg": 55.82, "max": 48.89, "min": 61.56, "cnt": 32}, "fwd-layernorm":{"total": 10.86, "avg": 0.08, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 112.86, "avg": 0.88, "max": 0.74, "min": 1.59, "cnt": 128}, "fwd-misc":{"total": 23.11, "avg": 0.18, "max": 0.12, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1616.04, "avg": 12.63, "max": 9.94, "min": 18.26, "cnt": 128}, "MoE_L0_fwd":{"total": 489.76, "avg": 15.31, "max": 11.11, "min": 18.16, "cnt": 32}, "MoEMLP":{"total": 1597.81, "avg": 12.48, "max": 9.83, "min": 18.11, "cnt": 128}, "MoE_L1_fwd":{"total": 399.12, "avg": 12.47, "max": 10.95, "min": 15.65, "cnt": 32}, "MoE_L2_fwd":{"total": 372.15, "avg": 11.63, "max": 10.91, "min": 15.76, "cnt": 32}, "MoE_L3_fwd":{"total": 343.40, "avg": 10.73, "max": 9.87, "min": 13.47, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.65, "avg": 0.02, "max": 0.02, "min": 0.04, "cnt": 32}, "forward-send":{"total": 2.91, "avg": 1.45, "max": 0.80, "min": 2.11, "cnt": 2}, "forward-send-backward-recv":{"total": 475.99, "avg": 15.87, "max": 1.68, "min": 109.19, "cnt": 30}, "backward-compute":{"total": 1503.99, "avg": 47.00, "max": 45.20, "min": 48.93, "cnt": 32}, "MoE_L3_bwd":{"total": 352.29, "avg": 11.01, "max": 10.23, "min": 13.07, "cnt": 32}, "MoE_L2_bwd":{"total": 341.08, "avg": 10.66, "max": 9.87, "min": 11.43, "cnt": 32}, "MoE_L1_bwd":{"total": 319.65, "avg": 9.99, "max": 9.51, "min": 10.38, "cnt": 32}, "MoE_L0_bwd":{"total": 274.26, "avg": 8.57, "max": 8.13, "min": 8.94, "cnt": 32}, "backward-send-forward-recv":{"total": 1011.03, "avg": 34.86, "max": 1.28, "min": 186.74, "cnt": 29}, "backward-send":{"total": 3.01, "avg": 1.00, "max": 0.70, "min": 1.16, "cnt": 3}, "backward-recv":{"total": 156.77, "avg": 78.39, "max": 73.75, "min": 83.02, "cnt": 2}, "backward-params-all-reduce":{"total": 485.86, "avg": 485.86, "max": 485.86, "min": 485.86, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 231.44, "avg": 231.44, "max": 231.44, "min": 231.44, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 191.63, "avg": 191.63, "max": 191.63, "min": 191.63, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.40, "avg": 3.40, "max": 3.40, "min": 3.40, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 157, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 88.53, "avg": 29.51, "max": 1.48, "min": 85.39, "cnt": 3}, "forward-compute":{"total": 1843.65, "avg": 57.61, "max": 48.65, "min": 66.65, "cnt": 32}, "fwd-compute":{"total": 1840.03, "avg": 57.50, "max": 48.58, "min": 66.52, "cnt": 32}, "batch-generator":{"total": 44.49, "avg": 1.39, "max": 0.63, "min": 2.79, "cnt": 32}, "fwd-embedding":{"total": 0.74, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1781.68, "avg": 55.68, "max": 47.63, "min": 64.47, "cnt": 32}, "fwd-layernorm":{"total": 10.99, "avg": 0.09, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 114.20, "avg": 0.89, "max": 0.74, "min": 1.50, "cnt": 128}, "fwd-misc":{"total": 23.74, "avg": 0.19, "max": 0.11, "min": 0.38, "cnt": 128}, "fwd-MLP":{"total": 1609.69, "avg": 12.58, "max": 9.99, "min": 18.03, "cnt": 128}, "MoE_L0_fwd":{"total": 473.23, "avg": 14.79, "max": 10.64, "min": 17.84, "cnt": 32}, "MoEMLP":{"total": 1591.34, "avg": 12.43, "max": 9.88, "min": 17.79, "cnt": 128}, "MoE_L1_fwd":{"total": 407.22, "avg": 12.73, "max": 10.96, "min": 16.25, "cnt": 32}, "MoE_L2_fwd":{"total": 372.29, "avg": 11.63, "max": 10.65, "min": 15.72, "cnt": 32}, "MoE_L3_fwd":{"total": 345.14, "avg": 10.79, "max": 9.92, "min": 15.50, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.87, "avg": 0.93, "max": 0.85, "min": 1.01, "cnt": 2}, "forward-send-backward-recv":{"total": 1045.56, "avg": 34.85, "max": 1.32, "min": 337.77, "cnt": 30}, "backward-compute":{"total": 1490.08, "avg": 46.57, "max": 43.87, "min": 47.63, "cnt": 32}, "MoE_L3_bwd":{"total": 345.23, "avg": 10.79, "max": 9.25, "min": 12.43, "cnt": 32}, "MoE_L2_bwd":{"total": 335.86, "avg": 10.50, "max": 9.41, "min": 11.11, "cnt": 32}, "MoE_L1_bwd":{"total": 322.35, "avg": 10.07, "max": 9.62, "min": 10.64, "cnt": 32}, "MoE_L0_bwd":{"total": 271.39, "avg": 8.48, "max": 7.97, "min": 8.75, "cnt": 32}, "backward-send-forward-recv":{"total": 833.16, "avg": 28.73, "max": 1.81, "min": 236.22, "cnt": 29}, "backward-send":{"total": 2.56, "avg": 0.85, "max": 0.64, "min": 0.97, "cnt": 3}, "backward-recv":{"total": 149.36, "avg": 74.68, "max": 72.40, "min": 76.97, "cnt": 2}, "backward-params-all-reduce":{"total": 491.52, "avg": 491.52, "max": 491.52, "min": 491.52, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 230.84, "avg": 230.84, "max": 230.84, "min": 230.84, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 185.41, "avg": 185.41, "max": 185.41, "min": 185.41, "cnt": 1}, "optimizer-clip-main-grad":{"total": 5.82, "avg": 5.82, "max": 5.82, "min": 5.82, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 158, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 64.78, "avg": 21.59, "max": 1.32, "min": 62.02, "cnt": 3}, "forward-compute":{"total": 1834.93, "avg": 57.34, "max": 51.03, "min": 62.25, "cnt": 32}, "fwd-compute":{"total": 1831.58, "avg": 57.24, "max": 50.96, "min": 62.16, "cnt": 32}, "batch-generator":{"total": 47.12, "avg": 1.47, "max": 0.73, "min": 3.63, "cnt": 32}, "fwd-embedding":{"total": 0.70, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1771.57, "avg": 55.36, "max": 49.76, "min": 60.75, "cnt": 32}, "fwd-layernorm":{"total": 10.35, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 109.39, "avg": 0.85, "max": 0.74, "min": 1.49, "cnt": 128}, "fwd-misc":{"total": 21.91, "avg": 0.17, "max": 0.12, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1608.25, "avg": 12.56, "max": 10.15, "min": 18.96, "cnt": 128}, "MoE_L0_fwd":{"total": 481.29, "avg": 15.04, "max": 10.44, "min": 18.88, "cnt": 32}, "MoEMLP":{"total": 1591.19, "avg": 12.43, "max": 10.04, "min": 18.83, "cnt": 128}, "MoE_L1_fwd":{"total": 405.38, "avg": 12.67, "max": 11.57, "min": 14.60, "cnt": 32}, "MoE_L2_fwd":{"total": 366.35, "avg": 11.45, "max": 10.54, "min": 13.55, "cnt": 32}, "MoE_L3_fwd":{"total": 344.49, "avg": 10.77, "max": 10.08, "min": 12.23, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.99, "avg": 1.00, "max": 0.94, "min": 1.06, "cnt": 2}, "forward-send-backward-recv":{"total": 397.27, "avg": 13.24, "max": 1.80, "min": 98.76, "cnt": 30}, "backward-compute":{"total": 1495.68, "avg": 46.74, "max": 43.52, "min": 49.33, "cnt": 32}, "MoE_L3_bwd":{"total": 348.65, "avg": 10.90, "max": 8.94, "min": 14.45, "cnt": 32}, "MoE_L2_bwd":{"total": 329.31, "avg": 10.29, "max": 9.06, "min": 11.20, "cnt": 32}, "MoE_L1_bwd":{"total": 323.85, "avg": 10.12, "max": 9.49, "min": 11.98, "cnt": 32}, "MoE_L0_bwd":{"total": 276.99, "avg": 8.66, "max": 8.18, "min": 11.60, "cnt": 32}, "backward-send-forward-recv":{"total": 1033.99, "avg": 35.65, "max": 2.05, "min": 201.00, "cnt": 29}, "backward-send":{"total": 2.88, "avg": 0.96, "max": 0.93, "min": 1.01, "cnt": 3}, "backward-recv":{"total": 145.19, "avg": 72.59, "max": 60.93, "min": 84.26, "cnt": 2}, "backward-params-all-reduce":{"total": 490.62, "avg": 490.62, "max": 490.62, "min": 490.62, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 231.26, "avg": 231.26, "max": 231.26, "min": 231.26, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 191.34, "avg": 191.34, "max": 191.34, "min": 191.34, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.60, "avg": 3.60, "max": 3.60, "min": 3.60, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.41, "avg": 3.41, "max": 3.41, "min": 3.41, "cnt": 1}}}
{"type":"time", "iteration": 159, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 75.58, "avg": 25.19, "max": 1.24, "min": 72.85, "cnt": 3}, "forward-compute":{"total": 1839.72, "avg": 57.49, "max": 48.67, "min": 65.14, "cnt": 32}, "fwd-compute":{"total": 1836.48, "avg": 57.39, "max": 48.60, "min": 65.05, "cnt": 32}, "batch-generator":{"total": 41.96, "avg": 1.31, "max": 0.71, "min": 2.43, "cnt": 32}, "fwd-embedding":{"total": 0.66, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1781.28, "avg": 55.67, "max": 47.53, "min": 63.84, "cnt": 32}, "fwd-layernorm":{"total": 10.36, "avg": 0.08, "max": 0.06, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 113.82, "avg": 0.89, "max": 0.74, "min": 1.92, "cnt": 128}, "fwd-misc":{"total": 22.72, "avg": 0.18, "max": 0.12, "min": 0.48, "cnt": 128}, "fwd-MLP":{"total": 1611.86, "avg": 12.59, "max": 10.19, "min": 20.90, "cnt": 128}, "MoE_L0_fwd":{"total": 474.67, "avg": 14.83, "max": 10.69, "min": 20.82, "cnt": 32}, "MoEMLP":{"total": 1594.26, "avg": 12.46, "max": 10.07, "min": 20.77, "cnt": 128}, "MoE_L1_fwd":{"total": 405.33, "avg": 12.67, "max": 11.11, "min": 16.59, "cnt": 32}, "MoE_L2_fwd":{"total": 371.27, "avg": 11.60, "max": 10.64, "min": 16.55, "cnt": 32}, "MoE_L3_fwd":{"total": 349.45, "avg": 10.92, "max": 10.12, "min": 15.49, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 12.63, "avg": 6.32, "max": 0.84, "min": 11.80, "cnt": 2}, "forward-send-backward-recv":{"total": 222.17, "avg": 7.41, "max": 1.54, "min": 96.36, "cnt": 30}, "backward-compute":{"total": 1501.59, "avg": 46.92, "max": 45.45, "min": 48.82, "cnt": 32}, "MoE_L3_bwd":{"total": 354.55, "avg": 11.08, "max": 10.32, "min": 12.94, "cnt": 32}, "MoE_L2_bwd":{"total": 333.00, "avg": 10.41, "max": 9.33, "min": 11.23, "cnt": 32}, "MoE_L1_bwd":{"total": 320.53, "avg": 10.02, "max": 9.53, "min": 11.71, "cnt": 32}, "MoE_L0_bwd":{"total": 277.00, "avg": 8.66, "max": 8.18, "min": 8.98, "cnt": 32}, "backward-send-forward-recv":{"total": 1803.16, "avg": 62.18, "max": 2.21, "min": 335.01, "cnt": 29}, "backward-send":{"total": 3.15, "avg": 1.05, "max": 0.96, "min": 1.20, "cnt": 3}, "backward-recv":{"total": 135.72, "avg": 67.86, "max": 60.40, "min": 75.32, "cnt": 2}, "backward-params-all-reduce":{"total": 489.64, "avg": 489.64, "max": 489.64, "min": 489.64, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 231.82, "avg": 231.82, "max": 231.82, "min": 231.82, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 192.05, "avg": 192.05, "max": 192.05, "min": 192.05, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.35, "avg": 3.35, "max": 3.35, "min": 3.35, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 160, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 183.61, "avg": 61.20, "max": 1.00, "min": 180.97, "cnt": 3}, "forward-compute":{"total": 1831.24, "avg": 57.23, "max": 52.08, "min": 68.16, "cnt": 32}, "fwd-compute":{"total": 1827.84, "avg": 57.12, "max": 52.00, "min": 68.07, "cnt": 32}, "batch-generator":{"total": 53.81, "avg": 1.68, "max": 0.66, "min": 5.88, "cnt": 32}, "fwd-embedding":{"total": 0.79, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1760.79, "avg": 55.02, "max": 50.29, "min": 66.93, "cnt": 32}, "fwd-layernorm":{"total": 11.07, "avg": 0.09, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 112.88, "avg": 0.88, "max": 0.74, "min": 1.58, "cnt": 128}, "fwd-misc":{"total": 22.66, "avg": 0.18, "max": 0.12, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1591.62, "avg": 12.43, "max": 10.03, "min": 19.84, "cnt": 128}, "MoE_L0_fwd":{"total": 459.97, "avg": 14.37, "max": 11.02, "min": 19.76, "cnt": 32}, "MoEMLP":{"total": 1573.69, "avg": 12.29, "max": 9.92, "min": 19.71, "cnt": 128}, "MoE_L1_fwd":{"total": 396.57, "avg": 12.39, "max": 11.48, "min": 13.61, "cnt": 32}, "MoE_L2_fwd":{"total": 372.72, "avg": 11.65, "max": 10.57, "min": 16.38, "cnt": 32}, "MoE_L3_fwd":{"total": 350.94, "avg": 10.97, "max": 9.96, "min": 15.67, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 9.19, "avg": 4.59, "max": 0.74, "min": 8.45, "cnt": 2}, "forward-send-backward-recv":{"total": 395.40, "avg": 13.18, "max": 1.77, "min": 221.46, "cnt": 30}, "backward-compute":{"total": 1509.81, "avg": 47.18, "max": 44.45, "min": 49.83, "cnt": 32}, "MoE_L3_bwd":{"total": 363.74, "avg": 11.37, "max": 10.16, "min": 12.39, "cnt": 32}, "MoE_L2_bwd":{"total": 328.12, "avg": 10.25, "max": 8.80, "min": 11.14, "cnt": 32}, "MoE_L1_bwd":{"total": 318.93, "avg": 9.97, "max": 9.38, "min": 11.20, "cnt": 32}, "MoE_L0_bwd":{"total": 278.24, "avg": 8.69, "max": 8.01, "min": 10.57, "cnt": 32}, "backward-send-forward-recv":{"total": 1292.59, "avg": 44.57, "max": 1.58, "min": 210.49, "cnt": 29}, "backward-send":{"total": 2.78, "avg": 0.93, "max": 0.73, "min": 1.16, "cnt": 3}, "backward-recv":{"total": 140.80, "avg": 70.40, "max": 62.08, "min": 78.72, "cnt": 2}, "backward-params-all-reduce":{"total": 484.70, "avg": 484.70, "max": 484.70, "min": 484.70, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 231.22, "avg": 231.22, "max": 231.22, "min": 231.22, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 191.37, "avg": 191.37, "max": 191.37, "min": 191.37, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.41, "avg": 3.41, "max": 3.41, "min": 3.41, "cnt": 1}}}
{"type":"time", "iteration": 161, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 68.78, "avg": 22.93, "max": 1.45, "min": 65.76, "cnt": 3}, "forward-compute":{"total": 1872.74, "avg": 58.52, "max": 49.01, "min": 64.86, "cnt": 32}, "fwd-compute":{"total": 1869.37, "avg": 58.42, "max": 48.93, "min": 64.72, "cnt": 32}, "batch-generator":{"total": 48.33, "avg": 1.51, "max": 0.68, "min": 4.22, "cnt": 32}, "fwd-embedding":{"total": 0.78, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1807.47, "avg": 56.48, "max": 47.86, "min": 62.62, "cnt": 32}, "fwd-layernorm":{"total": 10.77, "avg": 0.08, "max": 0.06, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 113.78, "avg": 0.89, "max": 0.74, "min": 1.68, "cnt": 128}, "fwd-misc":{"total": 22.90, "avg": 0.18, "max": 0.11, "min": 0.40, "cnt": 128}, "fwd-MLP":{"total": 1637.25, "avg": 12.79, "max": 10.03, "min": 19.56, "cnt": 128}, "MoE_L0_fwd":{"total": 488.25, "avg": 15.26, "max": 10.40, "min": 19.48, "cnt": 32}, "MoEMLP":{"total": 1619.04, "avg": 12.65, "max": 9.92, "min": 19.44, "cnt": 128}, "MoE_L1_fwd":{"total": 410.53, "avg": 12.83, "max": 11.22, "min": 15.13, "cnt": 32}, "MoE_L2_fwd":{"total": 368.92, "avg": 11.53, "max": 10.76, "min": 15.09, "cnt": 32}, "MoE_L3_fwd":{"total": 357.97, "avg": 11.19, "max": 9.96, "min": 15.42, "cnt": 32}, "fwd-pooler":{"total": 0.36, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.56, "avg": 0.78, "max": 0.68, "min": 0.89, "cnt": 2}, "forward-send-backward-recv":{"total": 228.28, "avg": 7.61, "max": 1.42, "min": 109.45, "cnt": 30}, "backward-compute":{"total": 1491.36, "avg": 46.60, "max": 44.87, "min": 48.54, "cnt": 32}, "MoE_L3_bwd":{"total": 356.66, "avg": 11.15, "max": 9.61, "min": 13.18, "cnt": 32}, "MoE_L2_bwd":{"total": 329.13, "avg": 10.29, "max": 9.19, "min": 11.03, "cnt": 32}, "MoE_L1_bwd":{"total": 314.19, "avg": 9.82, "max": 9.39, "min": 10.28, "cnt": 32}, "MoE_L0_bwd":{"total": 272.17, "avg": 8.51, "max": 8.09, "min": 9.12, "cnt": 32}, "backward-send-forward-recv":{"total": 1396.01, "avg": 48.14, "max": 0.96, "min": 234.91, "cnt": 29}, "backward-send":{"total": 2.73, "avg": 0.91, "max": 0.82, "min": 1.05, "cnt": 3}, "backward-recv":{"total": 142.76, "avg": 71.38, "max": 68.68, "min": 74.08, "cnt": 2}, "backward-params-all-reduce":{"total": 484.42, "avg": 484.42, "max": 484.42, "min": 484.42, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 232.44, "avg": 232.44, "max": 232.44, "min": 232.44, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 192.69, "avg": 192.69, "max": 192.69, "min": 192.69, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 162, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 77.12, "avg": 25.71, "max": 2.14, "min": 71.39, "cnt": 3}, "forward-compute":{"total": 1819.96, "avg": 56.87, "max": 50.02, "min": 62.55, "cnt": 32}, "fwd-compute":{"total": 1816.83, "avg": 56.78, "max": 49.94, "min": 62.45, "cnt": 32}, "batch-generator":{"total": 42.51, "avg": 1.33, "max": 0.67, "min": 2.62, "cnt": 32}, "fwd-embedding":{"total": 0.61, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1762.01, "avg": 55.06, "max": 48.79, "min": 60.97, "cnt": 32}, "fwd-layernorm":{"total": 10.08, "avg": 0.08, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 109.38, "avg": 0.85, "max": 0.74, "min": 1.86, "cnt": 128}, "fwd-misc":{"total": 21.64, "avg": 0.17, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1598.89, "avg": 12.49, "max": 10.22, "min": 17.98, "cnt": 128}, "MoE_L0_fwd":{"total": 474.63, "avg": 14.83, "max": 10.89, "min": 17.81, "cnt": 32}, "MoEMLP":{"total": 1581.61, "avg": 12.36, "max": 10.11, "min": 17.70, "cnt": 128}, "MoE_L1_fwd":{"total": 398.72, "avg": 12.46, "max": 11.07, "min": 13.85, "cnt": 32}, "MoE_L2_fwd":{"total": 359.78, "avg": 11.24, "max": 10.49, "min": 14.48, "cnt": 32}, "MoE_L3_fwd":{"total": 354.87, "avg": 11.09, "max": 10.16, "min": 15.59, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 4.25, "avg": 2.13, "max": 0.92, "min": 3.33, "cnt": 2}, "forward-send-backward-recv":{"total": 492.26, "avg": 16.41, "max": 1.76, "min": 130.05, "cnt": 30}, "backward-compute":{"total": 1493.51, "avg": 46.67, "max": 44.24, "min": 49.95, "cnt": 32}, "MoE_L3_bwd":{"total": 354.21, "avg": 11.07, "max": 9.68, "min": 13.96, "cnt": 32}, "MoE_L2_bwd":{"total": 329.89, "avg": 10.31, "max": 9.16, "min": 11.08, "cnt": 32}, "MoE_L1_bwd":{"total": 316.89, "avg": 9.90, "max": 9.35, "min": 13.22, "cnt": 32}, "MoE_L0_bwd":{"total": 274.83, "avg": 8.59, "max": 8.10, "min": 8.89, "cnt": 32}, "backward-send-forward-recv":{"total": 2197.27, "avg": 75.77, "max": 1.55, "min": 331.62, "cnt": 29}, "backward-send":{"total": 3.33, "avg": 1.11, "max": 1.04, "min": 1.15, "cnt": 3}, "backward-recv":{"total": 134.26, "avg": 67.13, "max": 65.13, "min": 69.13, "cnt": 2}, "backward-params-all-reduce":{"total": 489.19, "avg": 489.19, "max": 489.19, "min": 489.19, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 232.16, "avg": 232.16, "max": 232.16, "min": 232.16, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 191.86, "avg": 191.86, "max": 191.86, "min": 191.86, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.95, "avg": 3.95, "max": 3.95, "min": 3.95, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 163, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 72.91, "avg": 24.30, "max": 1.22, "min": 70.08, "cnt": 3}, "forward-compute":{"total": 1844.28, "avg": 57.63, "max": 50.43, "min": 62.58, "cnt": 32}, "fwd-compute":{"total": 1840.58, "avg": 57.52, "max": 50.35, "min": 62.50, "cnt": 32}, "batch-generator":{"total": 49.35, "avg": 1.54, "max": 0.69, "min": 3.43, "cnt": 32}, "fwd-embedding":{"total": 0.81, "avg": 0.03, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1777.00, "avg": 55.53, "max": 49.11, "min": 60.03, "cnt": 32}, "fwd-layernorm":{"total": 11.44, "avg": 0.09, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 116.58, "avg": 0.91, "max": 0.74, "min": 1.56, "cnt": 128}, "fwd-misc":{"total": 23.74, "avg": 0.19, "max": 0.12, "min": 0.53, "cnt": 128}, "fwd-MLP":{"total": 1601.68, "avg": 12.51, "max": 10.25, "min": 17.73, "cnt": 128}, "MoE_L0_fwd":{"total": 462.73, "avg": 14.46, "max": 10.23, "min": 17.65, "cnt": 32}, "MoEMLP":{"total": 1583.19, "avg": 12.37, "max": 10.14, "min": 17.60, "cnt": 128}, "MoE_L1_fwd":{"total": 403.53, "avg": 12.61, "max": 11.20, "min": 14.76, "cnt": 32}, "MoE_L2_fwd":{"total": 368.94, "avg": 11.53, "max": 10.68, "min": 15.07, "cnt": 32}, "MoE_L3_fwd":{"total": 354.71, "avg": 11.08, "max": 10.19, "min": 12.96, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 7.88, "avg": 3.94, "max": 0.80, "min": 7.08, "cnt": 2}, "forward-send-backward-recv":{"total": 692.78, "avg": 23.09, "max": 1.94, "min": 134.15, "cnt": 30}, "backward-compute":{"total": 1496.89, "avg": 46.78, "max": 44.25, "min": 50.25, "cnt": 32}, "MoE_L3_bwd":{"total": 347.20, "avg": 10.85, "max": 9.61, "min": 12.42, "cnt": 32}, "MoE_L2_bwd":{"total": 338.58, "avg": 10.58, "max": 9.46, "min": 11.16, "cnt": 32}, "MoE_L1_bwd":{"total": 313.55, "avg": 9.80, "max": 9.23, "min": 11.62, "cnt": 32}, "MoE_L0_bwd":{"total": 280.83, "avg": 8.78, "max": 8.25, "min": 12.37, "cnt": 32}, "backward-send-forward-recv":{"total": 588.09, "avg": 20.28, "max": 2.10, "min": 159.88, "cnt": 29}, "backward-send":{"total": 2.62, "avg": 0.87, "max": 0.79, "min": 0.98, "cnt": 3}, "backward-recv":{"total": 177.60, "avg": 88.80, "max": 87.94, "min": 89.67, "cnt": 2}, "backward-params-all-reduce":{"total": 481.18, "avg": 481.18, "max": 481.18, "min": 481.18, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 247.38, "avg": 247.38, "max": 247.38, "min": 247.38, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 201.08, "avg": 201.08, "max": 201.08, "min": 201.08, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.58, "avg": 3.58, "max": 3.58, "min": 3.58, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}}}
{"type":"time", "iteration": 164, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 60.54, "avg": 20.18, "max": 1.55, "min": 57.42, "cnt": 3}, "forward-compute":{"total": 1858.41, "avg": 58.08, "max": 49.50, "min": 66.83, "cnt": 32}, "fwd-compute":{"total": 1854.88, "avg": 57.96, "max": 49.43, "min": 66.68, "cnt": 32}, "batch-generator":{"total": 42.82, "avg": 1.34, "max": 0.66, "min": 2.08, "cnt": 32}, "fwd-embedding":{"total": 0.78, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1798.64, "avg": 56.21, "max": 48.48, "min": 64.52, "cnt": 32}, "fwd-layernorm":{"total": 11.00, "avg": 0.09, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 113.68, "avg": 0.89, "max": 0.74, "min": 1.81, "cnt": 128}, "fwd-misc":{"total": 22.96, "avg": 0.18, "max": 0.11, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1628.32, "avg": 12.72, "max": 10.45, "min": 20.83, "cnt": 128}, "MoE_L0_fwd":{"total": 482.81, "avg": 15.09, "max": 10.43, "min": 20.68, "cnt": 32}, "MoEMLP":{"total": 1610.02, "avg": 12.58, "max": 10.34, "min": 20.58, "cnt": 128}, "MoE_L1_fwd":{"total": 408.85, "avg": 12.78, "max": 11.22, "min": 15.34, "cnt": 32}, "MoE_L2_fwd":{"total": 368.05, "avg": 11.50, "max": 10.53, "min": 15.29, "cnt": 32}, "MoE_L3_fwd":{"total": 356.93, "avg": 11.15, "max": 10.38, "min": 14.47, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.59, "avg": 0.80, "max": 0.75, "min": 0.85, "cnt": 2}, "forward-send-backward-recv":{"total": 834.45, "avg": 27.81, "max": 1.77, "min": 137.88, "cnt": 30}, "backward-compute":{"total": 1497.57, "avg": 46.80, "max": 44.70, "min": 48.22, "cnt": 32}, "MoE_L3_bwd":{"total": 355.37, "avg": 11.11, "max": 9.89, "min": 12.10, "cnt": 32}, "MoE_L2_bwd":{"total": 332.44, "avg": 10.39, "max": 9.76, "min": 11.07, "cnt": 32}, "MoE_L1_bwd":{"total": 311.42, "avg": 9.73, "max": 9.25, "min": 10.27, "cnt": 32}, "MoE_L0_bwd":{"total": 280.01, "avg": 8.75, "max": 8.28, "min": 9.35, "cnt": 32}, "backward-send-forward-recv":{"total": 330.76, "avg": 11.41, "max": 1.32, "min": 133.43, "cnt": 29}, "backward-send":{"total": 2.39, "avg": 0.80, "max": 0.73, "min": 0.92, "cnt": 3}, "backward-recv":{"total": 153.86, "avg": 76.93, "max": 74.78, "min": 79.08, "cnt": 2}, "backward-params-all-reduce":{"total": 490.70, "avg": 490.70, "max": 490.70, "min": 490.70, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 233.78, "avg": 233.78, "max": 233.78, "min": 233.78, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 191.44, "avg": 191.44, "max": 191.44, "min": 191.44, "cnt": 1}, "optimizer-clip-main-grad":{"total": 5.89, "avg": 5.89, "max": 5.89, "min": 5.89, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}}}
{"type":"time", "iteration": 165, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 65.48, "avg": 21.83, "max": 1.27, "min": 58.76, "cnt": 3}, "forward-compute":{"total": 2062.49, "avg": 64.45, "max": 49.83, "min": 243.98, "cnt": 32}, "fwd-compute":{"total": 2059.05, "avg": 64.35, "max": 49.76, "min": 243.90, "cnt": 32}, "batch-generator":{"total": 44.11, "avg": 1.38, "max": 0.70, "min": 2.21, "cnt": 32}, "fwd-embedding":{"total": 0.80, "avg": 0.02, "max": 0.01, "min": 0.06, "cnt": 32}, "fwd-encoder":{"total": 2001.33, "avg": 62.54, "max": 48.11, "min": 241.59, "cnt": 32}, "fwd-layernorm":{"total": 11.02, "avg": 0.09, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 116.25, "avg": 0.91, "max": 0.74, "min": 2.68, "cnt": 128}, "fwd-misc":{"total": 22.63, "avg": 0.18, "max": 0.11, "min": 0.38, "cnt": 128}, "fwd-MLP":{"total": 1828.52, "avg": 14.29, "max": 9.96, "min": 194.28, "cnt": 128}, "MoE_L0_fwd":{"total": 500.92, "avg": 15.65, "max": 9.88, "min": 21.15, "cnt": 32}, "MoEMLP":{"total": 1810.36, "avg": 14.14, "max": 9.84, "min": 194.13, "cnt": 128}, "MoE_L1_fwd":{"total": 408.76, "avg": 12.77, "max": 11.16, "min": 14.99, "cnt": 32}, "MoE_L2_fwd":{"total": 544.46, "avg": 17.01, "max": 10.48, "min": 194.18, "cnt": 32}, "MoE_L3_fwd":{"total": 362.72, "avg": 11.33, "max": 10.33, "min": 12.22, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 2.02, "avg": 1.01, "max": 1.00, "min": 1.02, "cnt": 2}, "forward-send-backward-recv":{"total": 424.54, "avg": 14.15, "max": 1.70, "min": 102.56, "cnt": 30}, "backward-compute":{"total": 1484.43, "avg": 46.39, "max": 45.04, "min": 48.07, "cnt": 32}, "MoE_L3_bwd":{"total": 338.59, "avg": 10.58, "max": 9.65, "min": 11.55, "cnt": 32}, "MoE_L2_bwd":{"total": 335.06, "avg": 10.47, "max": 9.55, "min": 11.93, "cnt": 32}, "MoE_L1_bwd":{"total": 313.74, "avg": 9.80, "max": 9.30, "min": 10.93, "cnt": 32}, "MoE_L0_bwd":{"total": 280.85, "avg": 8.78, "max": 8.25, "min": 10.21, "cnt": 32}, "backward-send-forward-recv":{"total": 1366.77, "avg": 47.13, "max": 0.98, "min": 522.19, "cnt": 29}, "backward-send":{"total": 2.65, "avg": 0.88, "max": 0.81, "min": 1.01, "cnt": 3}, "backward-recv":{"total": 137.79, "avg": 68.90, "max": 66.72, "min": 71.07, "cnt": 2}, "backward-params-all-reduce":{"total": 485.64, "avg": 485.64, "max": 485.64, "min": 485.64, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 236.58, "avg": 236.58, "max": 236.58, "min": 236.58, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 196.83, "avg": 196.83, "max": 196.83, "min": 196.83, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.34, "avg": 3.34, "max": 3.34, "min": 3.34, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.48, "avg": 3.48, "max": 3.48, "min": 3.48, "cnt": 1}}}
{"type":"time", "iteration": 166, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 81.69, "avg": 27.23, "max": 5.31, "min": 68.59, "cnt": 3}, "forward-compute":{"total": 1819.26, "avg": 56.85, "max": 49.01, "min": 64.15, "cnt": 32}, "fwd-compute":{"total": 1815.86, "avg": 56.75, "max": 48.93, "min": 64.07, "cnt": 32}, "batch-generator":{"total": 42.95, "avg": 1.34, "max": 0.68, "min": 2.50, "cnt": 32}, "fwd-embedding":{"total": 0.74, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1759.80, "avg": 54.99, "max": 47.78, "min": 62.92, "cnt": 32}, "fwd-layernorm":{"total": 10.56, "avg": 0.08, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 112.32, "avg": 0.88, "max": 0.74, "min": 1.93, "cnt": 128}, "fwd-misc":{"total": 22.44, "avg": 0.18, "max": 0.12, "min": 0.40, "cnt": 128}, "fwd-MLP":{"total": 1592.24, "avg": 12.44, "max": 10.11, "min": 25.76, "cnt": 128}, "MoE_L0_fwd":{"total": 488.34, "avg": 15.26, "max": 10.14, "min": 25.69, "cnt": 32}, "MoEMLP":{"total": 1574.75, "avg": 12.30, "max": 10.01, "min": 25.64, "cnt": 128}, "MoE_L1_fwd":{"total": 394.13, "avg": 12.32, "max": 11.15, "min": 15.13, "cnt": 32}, "MoE_L2_fwd":{"total": 345.36, "avg": 10.79, "max": 10.31, "min": 11.55, "cnt": 32}, "MoE_L3_fwd":{"total": 353.30, "avg": 11.04, "max": 10.05, "min": 14.05, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.72, "avg": 0.86, "max": 0.75, "min": 0.97, "cnt": 2}, "forward-send-backward-recv":{"total": 336.08, "avg": 11.20, "max": 1.77, "min": 120.05, "cnt": 30}, "backward-compute":{"total": 1492.76, "avg": 46.65, "max": 43.08, "min": 50.36, "cnt": 32}, "MoE_L3_bwd":{"total": 351.90, "avg": 11.00, "max": 8.69, "min": 13.18, "cnt": 32}, "MoE_L2_bwd":{"total": 323.95, "avg": 10.12, "max": 9.31, "min": 11.81, "cnt": 32}, "MoE_L1_bwd":{"total": 319.48, "avg": 9.98, "max": 9.34, "min": 11.43, "cnt": 32}, "MoE_L0_bwd":{"total": 279.80, "avg": 8.74, "max": 8.37, "min": 9.17, "cnt": 32}, "backward-send-forward-recv":{"total": 1815.04, "avg": 62.59, "max": 1.47, "min": 541.79, "cnt": 29}, "backward-send":{"total": 3.25, "avg": 1.08, "max": 1.06, "min": 1.11, "cnt": 3}, "backward-recv":{"total": 130.12, "avg": 65.06, "max": 64.54, "min": 65.58, "cnt": 2}, "backward-params-all-reduce":{"total": 495.21, "avg": 495.21, "max": 495.21, "min": 495.21, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 233.17, "avg": 233.17, "max": 233.17, "min": 233.17, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 193.28, "avg": 193.28, "max": 193.28, "min": 193.28, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}}}
{"type":"time", "iteration": 167, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 86.04, "avg": 28.68, "max": 1.18, "min": 76.41, "cnt": 3}, "forward-compute":{"total": 1791.38, "avg": 55.98, "max": 48.73, "min": 58.87, "cnt": 32}, "fwd-compute":{"total": 1787.92, "avg": 55.87, "max": 48.66, "min": 58.76, "cnt": 32}, "batch-generator":{"total": 39.72, "avg": 1.24, "max": 0.66, "min": 1.85, "cnt": 32}, "fwd-embedding":{"total": 0.69, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1734.89, "avg": 54.22, "max": 47.61, "min": 57.34, "cnt": 32}, "fwd-layernorm":{"total": 10.59, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 111.43, "avg": 0.87, "max": 0.74, "min": 1.63, "cnt": 128}, "fwd-misc":{"total": 21.66, "avg": 0.17, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1569.08, "avg": 12.26, "max": 10.25, "min": 17.84, "cnt": 128}, "MoE_L0_fwd":{"total": 465.17, "avg": 14.54, "max": 10.95, "min": 17.76, "cnt": 32}, "MoEMLP":{"total": 1551.72, "avg": 12.12, "max": 10.14, "min": 17.71, "cnt": 128}, "MoE_L1_fwd":{"total": 391.83, "avg": 12.24, "max": 11.08, "min": 13.69, "cnt": 32}, "MoE_L2_fwd":{"total": 353.51, "avg": 11.05, "max": 10.39, "min": 12.04, "cnt": 32}, "MoE_L3_fwd":{"total": 347.57, "avg": 10.86, "max": 10.18, "min": 12.22, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 5.12, "avg": 2.56, "max": 0.74, "min": 4.38, "cnt": 2}, "forward-send-backward-recv":{"total": 790.78, "avg": 26.36, "max": 1.74, "min": 133.79, "cnt": 30}, "backward-compute":{"total": 1487.82, "avg": 46.49, "max": 44.71, "min": 48.23, "cnt": 32}, "MoE_L3_bwd":{"total": 341.29, "avg": 10.67, "max": 9.61, "min": 11.73, "cnt": 32}, "MoE_L2_bwd":{"total": 334.15, "avg": 10.44, "max": 9.70, "min": 11.70, "cnt": 32}, "MoE_L1_bwd":{"total": 314.84, "avg": 9.84, "max": 9.27, "min": 10.53, "cnt": 32}, "MoE_L0_bwd":{"total": 284.45, "avg": 8.89, "max": 8.42, "min": 9.38, "cnt": 32}, "backward-send-forward-recv":{"total": 479.90, "avg": 16.55, "max": 1.20, "min": 207.05, "cnt": 29}, "backward-send":{"total": 2.70, "avg": 0.90, "max": 0.82, "min": 0.97, "cnt": 3}, "backward-recv":{"total": 192.81, "avg": 96.41, "max": 71.52, "min": 121.29, "cnt": 2}, "backward-params-all-reduce":{"total": 487.98, "avg": 487.98, "max": 487.98, "min": 487.98, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 236.98, "avg": 236.98, "max": 236.98, "min": 236.98, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 197.02, "avg": 197.02, "max": 197.02, "min": 197.02, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.56, "avg": 3.56, "max": 3.56, "min": 3.56, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}}}
{"type":"time", "iteration": 168, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 75.46, "avg": 25.15, "max": 1.24, "min": 72.74, "cnt": 3}, "forward-compute":{"total": 1826.75, "avg": 57.09, "max": 49.51, "min": 61.79, "cnt": 32}, "fwd-compute":{"total": 1823.47, "avg": 56.98, "max": 49.38, "min": 61.70, "cnt": 32}, "batch-generator":{"total": 36.02, "avg": 1.13, "max": 0.66, "min": 1.84, "cnt": 32}, "fwd-embedding":{"total": 0.68, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1774.46, "avg": 55.45, "max": 48.28, "min": 60.33, "cnt": 32}, "fwd-layernorm":{"total": 9.93, "avg": 0.08, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 108.99, "avg": 0.85, "max": 0.74, "min": 1.53, "cnt": 128}, "fwd-misc":{"total": 20.97, "avg": 0.16, "max": 0.11, "min": 0.45, "cnt": 128}, "fwd-MLP":{"total": 1613.30, "avg": 12.60, "max": 10.31, "min": 18.11, "cnt": 128}, "MoE_L0_fwd":{"total": 481.66, "avg": 15.05, "max": 10.96, "min": 18.02, "cnt": 32}, "MoEMLP":{"total": 1596.57, "avg": 12.47, "max": 10.19, "min": 17.97, "cnt": 128}, "MoE_L1_fwd":{"total": 406.96, "avg": 12.72, "max": 11.20, "min": 16.92, "cnt": 32}, "MoE_L2_fwd":{"total": 348.99, "avg": 10.91, "max": 10.24, "min": 12.34, "cnt": 32}, "MoE_L3_fwd":{"total": 365.09, "avg": 11.41, "max": 10.66, "min": 14.20, "cnt": 32}, "fwd-pooler":{"total": 0.39, "avg": 0.01, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-loss-func":{"total": 0.61, "avg": 0.02, "max": 0.02, "min": 0.04, "cnt": 32}, "forward-send":{"total": 2.99, "avg": 1.50, "max": 0.73, "min": 2.26, "cnt": 2}, "forward-send-backward-recv":{"total": 419.04, "avg": 13.97, "max": 1.66, "min": 119.33, "cnt": 30}, "backward-compute":{"total": 1499.42, "avg": 46.86, "max": 44.43, "min": 49.94, "cnt": 32}, "MoE_L3_bwd":{"total": 369.49, "avg": 11.55, "max": 10.68, "min": 13.84, "cnt": 32}, "MoE_L2_bwd":{"total": 316.37, "avg": 9.89, "max": 9.03, "min": 10.87, "cnt": 32}, "MoE_L1_bwd":{"total": 313.43, "avg": 9.79, "max": 9.35, "min": 10.26, "cnt": 32}, "MoE_L0_bwd":{"total": 283.42, "avg": 8.86, "max": 8.10, "min": 11.79, "cnt": 32}, "backward-send-forward-recv":{"total": 506.08, "avg": 17.45, "max": 1.09, "min": 101.39, "cnt": 29}, "backward-send":{"total": 2.48, "avg": 0.83, "max": 0.68, "min": 1.03, "cnt": 3}, "backward-recv":{"total": 155.56, "avg": 77.78, "max": 74.83, "min": 80.73, "cnt": 2}, "backward-params-all-reduce":{"total": 482.36, "avg": 482.36, "max": 482.36, "min": 482.36, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 241.79, "avg": 241.79, "max": 241.79, "min": 241.79, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 201.36, "avg": 201.36, "max": 201.36, "min": 201.36, "cnt": 1}, "optimizer-clip-main-grad":{"total": 4.00, "avg": 4.00, "max": 4.00, "min": 4.00, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.41, "avg": 3.41, "max": 3.41, "min": 3.41, "cnt": 1}}}
{"type":"time", "iteration": 169, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 70.18, "avg": 23.39, "max": 1.30, "min": 67.30, "cnt": 3}, "forward-compute":{"total": 1818.15, "avg": 56.82, "max": 47.83, "min": 63.70, "cnt": 32}, "fwd-compute":{"total": 1814.77, "avg": 56.71, "max": 47.76, "min": 63.57, "cnt": 32}, "batch-generator":{"total": 44.42, "avg": 1.39, "max": 0.66, "min": 3.86, "cnt": 32}, "fwd-embedding":{"total": 0.77, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1757.00, "avg": 54.91, "max": 46.78, "min": 61.57, "cnt": 32}, "fwd-layernorm":{"total": 10.91, "avg": 0.09, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 113.43, "avg": 0.89, "max": 0.75, "min": 1.49, "cnt": 128}, "fwd-misc":{"total": 22.86, "avg": 0.18, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1587.14, "avg": 12.40, "max": 10.11, "min": 18.08, "cnt": 128}, "MoE_L0_fwd":{"total": 480.63, "avg": 15.02, "max": 10.04, "min": 17.98, "cnt": 32}, "MoEMLP":{"total": 1569.29, "avg": 12.26, "max": 9.99, "min": 17.92, "cnt": 128}, "MoE_L1_fwd":{"total": 397.60, "avg": 12.43, "max": 10.86, "min": 13.82, "cnt": 32}, "MoE_L2_fwd":{"total": 348.50, "avg": 10.89, "max": 10.09, "min": 15.17, "cnt": 32}, "MoE_L3_fwd":{"total": 349.11, "avg": 10.91, "max": 10.30, "min": 12.68, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 5.13, "avg": 2.56, "max": 0.96, "min": 4.17, "cnt": 2}, "forward-send-backward-recv":{"total": 429.84, "avg": 14.33, "max": 1.33, "min": 130.74, "cnt": 30}, "backward-compute":{"total": 1485.98, "avg": 46.44, "max": 44.48, "min": 48.89, "cnt": 32}, "MoE_L3_bwd":{"total": 357.45, "avg": 11.17, "max": 9.91, "min": 12.86, "cnt": 32}, "MoE_L2_bwd":{"total": 310.20, "avg": 9.69, "max": 9.01, "min": 10.78, "cnt": 32}, "MoE_L1_bwd":{"total": 316.48, "avg": 9.89, "max": 9.27, "min": 11.83, "cnt": 32}, "MoE_L0_bwd":{"total": 282.93, "avg": 8.84, "max": 8.40, "min": 9.23, "cnt": 32}, "backward-send-forward-recv":{"total": 883.50, "avg": 30.47, "max": 0.96, "min": 159.04, "cnt": 29}, "backward-send":{"total": 2.88, "avg": 0.96, "max": 0.79, "min": 1.20, "cnt": 3}, "backward-recv":{"total": 140.45, "avg": 70.23, "max": 64.03, "min": 76.42, "cnt": 2}, "backward-params-all-reduce":{"total": 486.85, "avg": 486.85, "max": 486.85, "min": 486.85, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 235.08, "avg": 235.08, "max": 235.08, "min": 235.08, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 195.25, "avg": 195.25, "max": 195.25, "min": 195.25, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 170, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 87.88, "avg": 29.29, "max": 1.68, "min": 79.43, "cnt": 3}, "forward-compute":{"total": 1850.94, "avg": 57.84, "max": 49.22, "min": 64.55, "cnt": 32}, "fwd-compute":{"total": 1847.27, "avg": 57.73, "max": 49.15, "min": 64.42, "cnt": 32}, "batch-generator":{"total": 43.57, "avg": 1.36, "max": 0.64, "min": 1.89, "cnt": 32}, "fwd-embedding":{"total": 0.90, "avg": 0.03, "max": 0.01, "min": 0.10, "cnt": 32}, "fwd-encoder":{"total": 1790.05, "avg": 55.94, "max": 48.10, "min": 62.40, "cnt": 32}, "fwd-layernorm":{"total": 11.28, "avg": 0.09, "max": 0.06, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 115.98, "avg": 0.91, "max": 0.75, "min": 2.21, "cnt": 128}, "fwd-misc":{"total": 22.92, "avg": 0.18, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1616.99, "avg": 12.63, "max": 10.25, "min": 18.76, "cnt": 128}, "MoE_L0_fwd":{"total": 480.32, "avg": 15.01, "max": 11.18, "min": 18.69, "cnt": 32}, "MoEMLP":{"total": 1598.59, "avg": 12.49, "max": 10.14, "min": 18.64, "cnt": 128}, "MoE_L1_fwd":{"total": 405.97, "avg": 12.69, "max": 11.00, "min": 15.82, "cnt": 32}, "MoE_L2_fwd":{"total": 346.63, "avg": 10.83, "max": 10.18, "min": 12.25, "cnt": 32}, "MoE_L3_fwd":{"total": 372.38, "avg": 11.64, "max": 10.28, "min": 16.81, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 7.49, "avg": 3.74, "max": 0.85, "min": 6.64, "cnt": 2}, "forward-send-backward-recv":{"total": 632.27, "avg": 21.08, "max": 1.94, "min": 106.12, "cnt": 30}, "backward-compute":{"total": 1499.18, "avg": 46.85, "max": 44.58, "min": 48.60, "cnt": 32}, "MoE_L3_bwd":{"total": 366.53, "avg": 11.45, "max": 10.20, "min": 13.91, "cnt": 32}, "MoE_L2_bwd":{"total": 314.88, "avg": 9.84, "max": 8.65, "min": 11.54, "cnt": 32}, "MoE_L1_bwd":{"total": 312.29, "avg": 9.76, "max": 9.36, "min": 11.54, "cnt": 32}, "MoE_L0_bwd":{"total": 285.58, "avg": 8.92, "max": 8.43, "min": 9.51, "cnt": 32}, "backward-send-forward-recv":{"total": 214.21, "avg": 7.39, "max": 0.98, "min": 72.34, "cnt": 29}, "backward-send":{"total": 3.06, "avg": 1.02, "max": 0.67, "min": 1.33, "cnt": 3}, "backward-recv":{"total": 217.03, "avg": 108.52, "max": 67.12, "min": 149.91, "cnt": 2}, "backward-params-all-reduce":{"total": 481.85, "avg": 481.85, "max": 481.85, "min": 481.85, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 232.91, "avg": 232.91, "max": 232.91, "min": 232.91, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 193.24, "avg": 193.24, "max": 193.24, "min": 193.24, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.33, "avg": 3.33, "max": 3.33, "min": 3.33, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}}}
{"type":"time", "iteration": 171, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 75.77, "avg": 25.26, "max": 1.22, "min": 72.90, "cnt": 3}, "forward-compute":{"total": 1821.56, "avg": 56.92, "max": 48.54, "min": 64.02, "cnt": 32}, "fwd-compute":{"total": 1818.00, "avg": 56.81, "max": 48.46, "min": 63.89, "cnt": 32}, "batch-generator":{"total": 40.93, "avg": 1.28, "max": 0.72, "min": 1.76, "cnt": 32}, "fwd-embedding":{"total": 0.77, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1763.64, "avg": 55.11, "max": 47.32, "min": 61.89, "cnt": 32}, "fwd-layernorm":{"total": 11.13, "avg": 0.09, "max": 0.06, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 112.83, "avg": 0.88, "max": 0.75, "min": 1.53, "cnt": 128}, "fwd-misc":{"total": 23.45, "avg": 0.18, "max": 0.12, "min": 0.55, "cnt": 128}, "fwd-MLP":{"total": 1593.19, "avg": 12.45, "max": 10.05, "min": 20.03, "cnt": 128}, "MoE_L0_fwd":{"total": 483.65, "avg": 15.11, "max": 10.80, "min": 19.95, "cnt": 32}, "MoEMLP":{"total": 1575.09, "avg": 12.31, "max": 9.94, "min": 19.90, "cnt": 128}, "MoE_L1_fwd":{"total": 401.68, "avg": 12.55, "max": 10.87, "min": 17.88, "cnt": 32}, "MoE_L2_fwd":{"total": 338.48, "avg": 10.58, "max": 9.98, "min": 11.74, "cnt": 32}, "MoE_L3_fwd":{"total": 357.86, "avg": 11.18, "max": 10.25, "min": 15.32, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 9.79, "avg": 4.89, "max": 1.01, "min": 8.78, "cnt": 2}, "forward-send-backward-recv":{"total": 709.24, "avg": 23.64, "max": 1.69, "min": 117.22, "cnt": 30}, "backward-compute":{"total": 1474.88, "avg": 46.09, "max": 43.95, "min": 48.89, "cnt": 32}, "MoE_L3_bwd":{"total": 350.82, "avg": 10.96, "max": 10.19, "min": 14.32, "cnt": 32}, "MoE_L2_bwd":{"total": 314.03, "avg": 9.81, "max": 8.94, "min": 10.49, "cnt": 32}, "MoE_L1_bwd":{"total": 314.58, "avg": 9.83, "max": 9.19, "min": 10.45, "cnt": 32}, "MoE_L0_bwd":{"total": 281.96, "avg": 8.81, "max": 8.41, "min": 9.15, "cnt": 32}, "backward-send-forward-recv":{"total": 196.04, "avg": 6.76, "max": 1.55, "min": 68.22, "cnt": 29}, "backward-send":{"total": 2.95, "avg": 0.98, "max": 0.91, "min": 1.05, "cnt": 3}, "backward-recv":{"total": 174.69, "avg": 87.34, "max": 74.13, "min": 100.56, "cnt": 2}, "backward-params-all-reduce":{"total": 486.82, "avg": 486.82, "max": 486.82, "min": 486.82, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 248.09, "avg": 248.09, "max": 248.09, "min": 248.09, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 203.11, "avg": 203.11, "max": 203.11, "min": 203.11, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.92, "avg": 3.92, "max": 3.92, "min": 3.92, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.41, "avg": 3.41, "max": 3.41, "min": 3.41, "cnt": 1}}}
{"type":"time", "iteration": 172, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 81.30, "avg": 27.10, "max": 1.69, "min": 70.49, "cnt": 3}, "forward-compute":{"total": 1788.01, "avg": 55.88, "max": 49.20, "min": 60.85, "cnt": 32}, "fwd-compute":{"total": 1784.59, "avg": 55.77, "max": 49.13, "min": 60.73, "cnt": 32}, "batch-generator":{"total": 42.11, "avg": 1.32, "max": 0.69, "min": 2.15, "cnt": 32}, "fwd-embedding":{"total": 0.69, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1729.60, "avg": 54.05, "max": 47.59, "min": 58.60, "cnt": 32}, "fwd-layernorm":{"total": 10.37, "avg": 0.08, "max": 0.06, "min": 0.18, "cnt": 128}, "fwd-attn":{"total": 111.14, "avg": 0.87, "max": 0.74, "min": 1.87, "cnt": 128}, "fwd-misc":{"total": 21.89, "avg": 0.17, "max": 0.11, "min": 0.55, "cnt": 128}, "fwd-MLP":{"total": 1564.49, "avg": 12.22, "max": 9.94, "min": 18.89, "cnt": 128}, "MoE_L0_fwd":{"total": 466.80, "avg": 14.59, "max": 10.46, "min": 18.81, "cnt": 32}, "MoEMLP":{"total": 1547.57, "avg": 12.09, "max": 9.83, "min": 18.75, "cnt": 128}, "MoE_L1_fwd":{"total": 394.88, "avg": 12.34, "max": 11.31, "min": 14.62, "cnt": 32}, "MoE_L2_fwd":{"total": 335.99, "avg": 10.50, "max": 9.87, "min": 11.57, "cnt": 32}, "MoE_L3_fwd":{"total": 356.18, "avg": 11.13, "max": 10.60, "min": 12.56, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.56, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.87, "avg": 0.93, "max": 0.91, "min": 0.96, "cnt": 2}, "forward-send-backward-recv":{"total": 560.22, "avg": 18.67, "max": 1.71, "min": 102.64, "cnt": 30}, "backward-compute":{"total": 1489.12, "avg": 46.53, "max": 44.57, "min": 49.68, "cnt": 32}, "MoE_L3_bwd":{"total": 355.47, "avg": 11.11, "max": 10.27, "min": 13.66, "cnt": 32}, "MoE_L2_bwd":{"total": 314.60, "avg": 9.83, "max": 8.59, "min": 11.08, "cnt": 32}, "MoE_L1_bwd":{"total": 325.58, "avg": 10.17, "max": 9.45, "min": 12.92, "cnt": 32}, "MoE_L0_bwd":{"total": 282.82, "avg": 8.84, "max": 8.52, "min": 10.21, "cnt": 32}, "backward-send-forward-recv":{"total": 970.98, "avg": 33.48, "max": 1.64, "min": 128.67, "cnt": 29}, "backward-send":{"total": 2.64, "avg": 0.88, "max": 0.62, "min": 1.07, "cnt": 3}, "backward-recv":{"total": 288.59, "avg": 144.29, "max": 78.38, "min": 210.21, "cnt": 2}, "backward-params-all-reduce":{"total": 485.75, "avg": 485.75, "max": 485.75, "min": 485.75, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 236.40, "avg": 236.40, "max": 236.40, "min": 236.40, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 196.21, "avg": 196.21, "max": 196.21, "min": 196.21, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.70, "avg": 3.70, "max": 3.70, "min": 3.70, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 173, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 65.14, "avg": 21.71, "max": 1.46, "min": 62.12, "cnt": 3}, "forward-compute":{"total": 1789.28, "avg": 55.91, "max": 49.02, "min": 65.85, "cnt": 32}, "fwd-compute":{"total": 1785.88, "avg": 55.81, "max": 48.95, "min": 65.77, "cnt": 32}, "batch-generator":{"total": 39.75, "avg": 1.24, "max": 0.71, "min": 2.17, "cnt": 32}, "fwd-embedding":{"total": 0.72, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1732.65, "avg": 54.15, "max": 47.95, "min": 64.23, "cnt": 32}, "fwd-layernorm":{"total": 10.88, "avg": 0.08, "max": 0.06, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 112.98, "avg": 0.88, "max": 0.75, "min": 1.49, "cnt": 128}, "fwd-misc":{"total": 22.52, "avg": 0.18, "max": 0.11, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1562.99, "avg": 12.21, "max": 9.99, "min": 18.88, "cnt": 128}, "MoE_L0_fwd":{"total": 450.91, "avg": 14.09, "max": 10.83, "min": 18.75, "cnt": 32}, "MoEMLP":{"total": 1544.85, "avg": 12.07, "max": 9.87, "min": 18.67, "cnt": 128}, "MoE_L1_fwd":{"total": 387.36, "avg": 12.11, "max": 11.12, "min": 14.07, "cnt": 32}, "MoE_L2_fwd":{"total": 354.87, "avg": 11.09, "max": 9.91, "min": 17.33, "cnt": 32}, "MoE_L3_fwd":{"total": 358.31, "avg": 11.20, "max": 10.33, "min": 12.88, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.65, "avg": 0.83, "max": 0.75, "min": 0.90, "cnt": 2}, "forward-send-backward-recv":{"total": 575.24, "avg": 19.17, "max": 1.79, "min": 135.69, "cnt": 30}, "backward-compute":{"total": 1487.78, "avg": 46.49, "max": 44.92, "min": 48.74, "cnt": 32}, "MoE_L3_bwd":{"total": 357.09, "avg": 11.16, "max": 10.65, "min": 12.22, "cnt": 32}, "MoE_L2_bwd":{"total": 308.37, "avg": 9.64, "max": 9.25, "min": 10.13, "cnt": 32}, "MoE_L1_bwd":{"total": 319.24, "avg": 9.98, "max": 9.55, "min": 11.36, "cnt": 32}, "MoE_L0_bwd":{"total": 282.58, "avg": 8.83, "max": 8.28, "min": 9.98, "cnt": 32}, "backward-send-forward-recv":{"total": 739.09, "avg": 25.49, "max": 1.69, "min": 90.94, "cnt": 29}, "backward-send":{"total": 3.01, "avg": 1.00, "max": 0.80, "min": 1.18, "cnt": 3}, "backward-recv":{"total": 128.03, "avg": 64.02, "max": 61.67, "min": 66.36, "cnt": 2}, "backward-params-all-reduce":{"total": 489.84, "avg": 489.84, "max": 489.84, "min": 489.84, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 227.53, "avg": 227.53, "max": 227.53, "min": 227.53, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 187.79, "avg": 187.79, "max": 187.79, "min": 187.79, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.35, "avg": 3.35, "max": 3.35, "min": 3.35, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 174, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 68.22, "avg": 22.74, "max": 1.20, "min": 65.41, "cnt": 3}, "forward-compute":{"total": 1815.93, "avg": 56.75, "max": 48.64, "min": 64.08, "cnt": 32}, "fwd-compute":{"total": 1812.39, "avg": 56.64, "max": 48.58, "min": 63.95, "cnt": 32}, "batch-generator":{"total": 40.97, "avg": 1.28, "max": 0.71, "min": 1.76, "cnt": 32}, "fwd-embedding":{"total": 0.77, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1757.65, "avg": 54.93, "max": 47.57, "min": 61.77, "cnt": 32}, "fwd-layernorm":{"total": 10.90, "avg": 0.09, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 115.32, "avg": 0.90, "max": 0.75, "min": 2.05, "cnt": 128}, "fwd-misc":{"total": 22.86, "avg": 0.18, "max": 0.12, "min": 0.38, "cnt": 128}, "fwd-MLP":{"total": 1585.93, "avg": 12.39, "max": 10.17, "min": 18.18, "cnt": 128}, "MoE_L0_fwd":{"total": 476.19, "avg": 14.88, "max": 10.61, "min": 18.11, "cnt": 32}, "MoEMLP":{"total": 1568.01, "avg": 12.25, "max": 10.05, "min": 18.05, "cnt": 128}, "MoE_L1_fwd":{"total": 401.54, "avg": 12.55, "max": 11.17, "min": 16.15, "cnt": 32}, "MoE_L2_fwd":{"total": 339.30, "avg": 10.60, "max": 10.10, "min": 11.82, "cnt": 32}, "MoE_L3_fwd":{"total": 357.52, "avg": 11.17, "max": 10.45, "min": 11.97, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 3.57, "avg": 1.78, "max": 0.96, "min": 2.61, "cnt": 2}, "forward-send-backward-recv":{"total": 850.56, "avg": 28.35, "max": 1.87, "min": 146.17, "cnt": 30}, "backward-compute":{"total": 1572.49, "avg": 49.14, "max": 44.63, "min": 132.72, "cnt": 32}, "MoE_L3_bwd":{"total": 354.37, "avg": 11.07, "max": 10.14, "min": 13.93, "cnt": 32}, "MoE_L2_bwd":{"total": 395.82, "avg": 12.37, "max": 8.70, "min": 95.54, "cnt": 32}, "MoE_L1_bwd":{"total": 321.56, "avg": 10.05, "max": 9.53, "min": 13.40, "cnt": 32}, "MoE_L0_bwd":{"total": 280.95, "avg": 8.78, "max": 8.11, "min": 10.33, "cnt": 32}, "backward-send-forward-recv":{"total": 357.68, "avg": 12.33, "max": 1.06, "min": 101.11, "cnt": 29}, "backward-send":{"total": 2.80, "avg": 0.93, "max": 0.74, "min": 1.03, "cnt": 3}, "backward-recv":{"total": 215.26, "avg": 107.63, "max": 71.11, "min": 144.15, "cnt": 2}, "backward-params-all-reduce":{"total": 486.41, "avg": 486.41, "max": 486.41, "min": 486.41, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 231.43, "avg": 231.43, "max": 231.43, "min": 231.43, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.40, "avg": 3.40, "max": 3.40, "min": 3.40, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 191.26, "avg": 191.26, "max": 191.26, "min": 191.26, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.66, "avg": 3.66, "max": 3.66, "min": 3.66, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 175, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 75.45, "avg": 25.15, "max": 2.78, "min": 64.76, "cnt": 3}, "forward-compute":{"total": 1810.64, "avg": 56.58, "max": 47.98, "min": 68.91, "cnt": 32}, "fwd-compute":{"total": 1807.22, "avg": 56.48, "max": 47.92, "min": 68.77, "cnt": 32}, "batch-generator":{"total": 40.76, "avg": 1.27, "max": 0.72, "min": 1.72, "cnt": 32}, "fwd-embedding":{"total": 0.71, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1753.50, "avg": 54.80, "max": 46.85, "min": 66.57, "cnt": 32}, "fwd-layernorm":{"total": 10.57, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 112.21, "avg": 0.88, "max": 0.74, "min": 1.48, "cnt": 128}, "fwd-misc":{"total": 22.14, "avg": 0.17, "max": 0.12, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1586.55, "avg": 12.39, "max": 10.07, "min": 17.66, "cnt": 128}, "MoE_L0_fwd":{"total": 468.33, "avg": 14.64, "max": 10.45, "min": 17.57, "cnt": 32}, "MoEMLP":{"total": 1569.05, "avg": 12.26, "max": 9.95, "min": 17.50, "cnt": 128}, "MoE_L1_fwd":{"total": 402.79, "avg": 12.59, "max": 11.09, "min": 16.41, "cnt": 32}, "MoE_L2_fwd":{"total": 340.58, "avg": 10.64, "max": 9.99, "min": 14.89, "cnt": 32}, "MoE_L3_fwd":{"total": 363.79, "avg": 11.37, "max": 10.39, "min": 13.12, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 3.33, "avg": 1.66, "max": 0.88, "min": 2.45, "cnt": 2}, "forward-send-backward-recv":{"total": 924.75, "avg": 30.83, "max": 1.84, "min": 173.14, "cnt": 30}, "backward-compute":{"total": 1474.38, "avg": 46.07, "max": 44.31, "min": 48.38, "cnt": 32}, "MoE_L3_bwd":{"total": 355.29, "avg": 11.10, "max": 9.89, "min": 12.05, "cnt": 32}, "MoE_L2_bwd":{"total": 304.00, "avg": 9.50, "max": 8.50, "min": 11.84, "cnt": 32}, "MoE_L1_bwd":{"total": 319.49, "avg": 9.98, "max": 9.14, "min": 11.70, "cnt": 32}, "MoE_L0_bwd":{"total": 278.49, "avg": 8.70, "max": 8.30, "min": 9.29, "cnt": 32}, "backward-send-forward-recv":{"total": 516.00, "avg": 17.79, "max": 1.33, "min": 96.24, "cnt": 29}, "backward-send":{"total": 2.97, "avg": 0.99, "max": 0.91, "min": 1.12, "cnt": 3}, "backward-recv":{"total": 154.06, "avg": 77.03, "max": 72.72, "min": 81.35, "cnt": 2}, "backward-params-all-reduce":{"total": 485.91, "avg": 485.91, "max": 485.91, "min": 485.91, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 227.45, "avg": 227.45, "max": 227.45, "min": 227.45, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 187.60, "avg": 187.60, "max": 187.60, "min": 187.60, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 176, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 72.31, "avg": 24.10, "max": 1.17, "min": 69.69, "cnt": 3}, "forward-compute":{"total": 1808.78, "avg": 56.52, "max": 49.52, "min": 61.63, "cnt": 32}, "fwd-compute":{"total": 1805.18, "avg": 56.41, "max": 49.45, "min": 61.49, "cnt": 32}, "batch-generator":{"total": 52.73, "avg": 1.65, "max": 0.62, "min": 3.66, "cnt": 32}, "fwd-embedding":{"total": 0.69, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1739.36, "avg": 54.35, "max": 48.50, "min": 59.44, "cnt": 32}, "fwd-layernorm":{"total": 10.44, "avg": 0.08, "max": 0.05, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 110.47, "avg": 0.86, "max": 0.74, "min": 1.71, "cnt": 128}, "fwd-misc":{"total": 22.16, "avg": 0.17, "max": 0.11, "min": 0.39, "cnt": 128}, "fwd-MLP":{"total": 1574.26, "avg": 12.30, "max": 10.02, "min": 18.10, "cnt": 128}, "MoE_L0_fwd":{"total": 460.63, "avg": 14.39, "max": 11.16, "min": 18.03, "cnt": 32}, "MoEMLP":{"total": 1557.00, "avg": 12.16, "max": 9.92, "min": 17.98, "cnt": 128}, "MoE_L1_fwd":{"total": 402.95, "avg": 12.59, "max": 11.19, "min": 16.77, "cnt": 32}, "MoE_L2_fwd":{"total": 341.31, "avg": 10.67, "max": 9.96, "min": 12.09, "cnt": 32}, "MoE_L3_fwd":{"total": 358.43, "avg": 11.20, "max": 10.37, "min": 15.47, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 4.28, "avg": 2.14, "max": 0.87, "min": 3.41, "cnt": 2}, "forward-send-backward-recv":{"total": 309.73, "avg": 10.32, "max": 1.84, "min": 120.93, "cnt": 30}, "backward-compute":{"total": 1501.22, "avg": 46.91, "max": 45.48, "min": 59.85, "cnt": 32}, "MoE_L3_bwd":{"total": 374.84, "avg": 11.71, "max": 10.50, "min": 27.41, "cnt": 32}, "MoE_L2_bwd":{"total": 312.35, "avg": 9.76, "max": 8.84, "min": 12.74, "cnt": 32}, "MoE_L1_bwd":{"total": 314.67, "avg": 9.83, "max": 9.18, "min": 11.00, "cnt": 32}, "MoE_L0_bwd":{"total": 280.03, "avg": 8.75, "max": 8.12, "min": 9.06, "cnt": 32}, "backward-send-forward-recv":{"total": 2004.23, "avg": 69.11, "max": 1.66, "min": 600.43, "cnt": 29}, "backward-send":{"total": 1.97, "avg": 0.66, "max": 0.56, "min": 0.71, "cnt": 3}, "backward-recv":{"total": 155.37, "avg": 77.69, "max": 77.24, "min": 78.14, "cnt": 2}, "backward-params-all-reduce":{"total": 483.69, "avg": 483.69, "max": 483.69, "min": 483.69, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 235.05, "avg": 235.05, "max": 235.05, "min": 235.05, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 195.08, "avg": 195.08, "max": 195.08, "min": 195.08, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.54, "avg": 3.54, "max": 3.54, "min": 3.54, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 177, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 92.15, "avg": 30.72, "max": 1.53, "min": 85.09, "cnt": 3}, "forward-compute":{"total": 1809.62, "avg": 56.55, "max": 49.93, "min": 61.67, "cnt": 32}, "fwd-compute":{"total": 1806.25, "avg": 56.45, "max": 49.86, "min": 61.57, "cnt": 32}, "batch-generator":{"total": 39.78, "avg": 1.24, "max": 0.71, "min": 2.44, "cnt": 32}, "fwd-embedding":{"total": 0.72, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1753.51, "avg": 54.80, "max": 48.69, "min": 60.28, "cnt": 32}, "fwd-layernorm":{"total": 10.34, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 110.90, "avg": 0.87, "max": 0.74, "min": 1.50, "cnt": 128}, "fwd-misc":{"total": 21.67, "avg": 0.17, "max": 0.12, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1588.82, "avg": 12.41, "max": 10.00, "min": 19.63, "cnt": 128}, "MoE_L0_fwd":{"total": 468.55, "avg": 14.64, "max": 11.32, "min": 19.55, "cnt": 32}, "MoEMLP":{"total": 1571.47, "avg": 12.28, "max": 9.88, "min": 19.51, "cnt": 128}, "MoE_L1_fwd":{"total": 399.93, "avg": 12.50, "max": 11.36, "min": 15.34, "cnt": 32}, "MoE_L2_fwd":{"total": 343.20, "avg": 10.72, "max": 9.93, "min": 15.70, "cnt": 32}, "MoE_L3_fwd":{"total": 366.08, "avg": 11.44, "max": 10.53, "min": 17.77, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 2.32, "avg": 1.16, "max": 0.89, "min": 1.43, "cnt": 2}, "forward-send-backward-recv":{"total": 359.12, "avg": 11.97, "max": 1.61, "min": 100.31, "cnt": 30}, "backward-compute":{"total": 1487.59, "avg": 46.49, "max": 44.75, "min": 48.97, "cnt": 32}, "MoE_L3_bwd":{"total": 359.15, "avg": 11.22, "max": 10.23, "min": 12.67, "cnt": 32}, "MoE_L2_bwd":{"total": 313.43, "avg": 9.79, "max": 8.78, "min": 11.51, "cnt": 32}, "MoE_L1_bwd":{"total": 319.57, "avg": 9.99, "max": 9.43, "min": 10.61, "cnt": 32}, "MoE_L0_bwd":{"total": 280.44, "avg": 8.76, "max": 8.17, "min": 9.19, "cnt": 32}, "backward-send-forward-recv":{"total": 575.29, "avg": 19.84, "max": 1.33, "min": 91.13, "cnt": 29}, "backward-send":{"total": 3.27, "avg": 1.09, "max": 1.05, "min": 1.16, "cnt": 3}, "backward-recv":{"total": 152.92, "avg": 76.46, "max": 72.67, "min": 80.25, "cnt": 2}, "backward-params-all-reduce":{"total": 483.07, "avg": 483.07, "max": 483.07, "min": 483.07, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 236.05, "avg": 236.05, "max": 236.05, "min": 236.05, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 190.94, "avg": 190.94, "max": 190.94, "min": 190.94, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.11, "avg": 6.11, "max": 6.11, "min": 6.11, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}}}
{"type":"time", "iteration": 178, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 71.03, "avg": 23.68, "max": 1.47, "min": 65.02, "cnt": 3}, "forward-compute":{"total": 1786.62, "avg": 55.83, "max": 48.23, "min": 63.15, "cnt": 32}, "fwd-compute":{"total": 1783.38, "avg": 55.73, "max": 48.16, "min": 63.06, "cnt": 32}, "batch-generator":{"total": 43.01, "avg": 1.34, "max": 0.65, "min": 3.13, "cnt": 32}, "fwd-embedding":{"total": 0.66, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1728.06, "avg": 54.00, "max": 46.96, "min": 61.59, "cnt": 32}, "fwd-layernorm":{"total": 10.23, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 110.08, "avg": 0.86, "max": 0.74, "min": 1.51, "cnt": 128}, "fwd-misc":{"total": 21.72, "avg": 0.17, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1564.55, "avg": 12.22, "max": 9.97, "min": 19.27, "cnt": 128}, "MoE_L0_fwd":{"total": 469.38, "avg": 14.67, "max": 10.24, "min": 19.18, "cnt": 32}, "MoEMLP":{"total": 1547.51, "avg": 12.09, "max": 9.87, "min": 19.13, "cnt": 128}, "MoE_L1_fwd":{"total": 391.61, "avg": 12.24, "max": 11.00, "min": 14.14, "cnt": 32}, "MoE_L2_fwd":{"total": 342.03, "avg": 10.69, "max": 9.91, "min": 13.35, "cnt": 32}, "MoE_L3_fwd":{"total": 350.74, "avg": 10.96, "max": 10.23, "min": 14.90, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.04, "cnt": 32}, "forward-send":{"total": 9.63, "avg": 4.81, "max": 0.92, "min": 8.71, "cnt": 2}, "forward-send-backward-recv":{"total": 658.31, "avg": 21.94, "max": 1.91, "min": 120.91, "cnt": 30}, "backward-compute":{"total": 1496.00, "avg": 46.75, "max": 44.76, "min": 51.58, "cnt": 32}, "MoE_L3_bwd":{"total": 351.36, "avg": 10.98, "max": 10.23, "min": 12.42, "cnt": 32}, "MoE_L2_bwd":{"total": 324.23, "avg": 10.13, "max": 9.00, "min": 14.97, "cnt": 32}, "MoE_L1_bwd":{"total": 320.88, "avg": 10.03, "max": 9.56, "min": 13.39, "cnt": 32}, "MoE_L0_bwd":{"total": 282.83, "avg": 8.84, "max": 8.14, "min": 11.10, "cnt": 32}, "backward-send-forward-recv":{"total": 2226.30, "avg": 76.77, "max": 1.02, "min": 705.79, "cnt": 29}, "backward-send":{"total": 2.83, "avg": 0.94, "max": 0.80, "min": 1.04, "cnt": 3}, "backward-recv":{"total": 803.37, "avg": 401.68, "max": 318.71, "min": 484.66, "cnt": 2}, "backward-params-all-reduce":{"total": 485.80, "avg": 485.80, "max": 485.80, "min": 485.80, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 238.54, "avg": 238.54, "max": 238.54, "min": 238.54, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.40, "avg": 3.40, "max": 3.40, "min": 3.40, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 196.07, "avg": 196.07, "max": 196.07, "min": 196.07, "cnt": 1}, "optimizer-clip-main-grad":{"total": 5.66, "avg": 5.66, "max": 5.66, "min": 5.66, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 179, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 68.42, "avg": 22.81, "max": 1.36, "min": 65.57, "cnt": 3}, "forward-compute":{"total": 1778.69, "avg": 55.58, "max": 50.26, "min": 63.43, "cnt": 32}, "fwd-compute":{"total": 1775.48, "avg": 55.48, "max": 50.18, "min": 63.29, "cnt": 32}, "batch-generator":{"total": 40.55, "avg": 1.27, "max": 0.65, "min": 2.13, "cnt": 32}, "fwd-embedding":{"total": 0.63, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1722.10, "avg": 53.82, "max": 48.57, "min": 61.04, "cnt": 32}, "fwd-layernorm":{"total": 9.68, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 106.91, "avg": 0.84, "max": 0.74, "min": 1.50, "cnt": 128}, "fwd-misc":{"total": 20.31, "avg": 0.16, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1564.14, "avg": 12.22, "max": 10.00, "min": 18.98, "cnt": 128}, "MoE_L0_fwd":{"total": 456.06, "avg": 14.25, "max": 10.27, "min": 18.91, "cnt": 32}, "MoEMLP":{"total": 1547.43, "avg": 12.09, "max": 9.89, "min": 18.86, "cnt": 128}, "MoE_L1_fwd":{"total": 390.69, "avg": 12.21, "max": 11.02, "min": 14.62, "cnt": 32}, "MoE_L2_fwd":{"total": 340.11, "avg": 10.63, "max": 9.93, "min": 13.27, "cnt": 32}, "MoE_L3_fwd":{"total": 366.53, "avg": 11.45, "max": 10.45, "min": 16.08, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 3.03, "avg": 1.51, "max": 1.02, "min": 2.00, "cnt": 2}, "forward-send-backward-recv":{"total": 336.39, "avg": 11.21, "max": 1.66, "min": 110.29, "cnt": 30}, "backward-compute":{"total": 1495.90, "avg": 46.75, "max": 45.02, "min": 50.41, "cnt": 32}, "MoE_L3_bwd":{"total": 356.79, "avg": 11.15, "max": 10.14, "min": 14.84, "cnt": 32}, "MoE_L2_bwd":{"total": 317.48, "avg": 9.92, "max": 9.20, "min": 13.01, "cnt": 32}, "MoE_L1_bwd":{"total": 323.25, "avg": 10.10, "max": 9.40, "min": 13.53, "cnt": 32}, "MoE_L0_bwd":{"total": 281.16, "avg": 8.79, "max": 8.50, "min": 9.18, "cnt": 32}, "backward-send-forward-recv":{"total": 1209.03, "avg": 41.69, "max": 0.95, "min": 280.86, "cnt": 29}, "backward-send":{"total": 2.11, "avg": 0.70, "max": 0.53, "min": 0.87, "cnt": 3}, "backward-recv":{"total": 142.08, "avg": 71.04, "max": 68.50, "min": 73.58, "cnt": 2}, "backward-params-all-reduce":{"total": 488.19, "avg": 488.19, "max": 488.19, "min": 488.19, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 230.94, "avg": 230.94, "max": 230.94, "min": 230.94, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 191.25, "avg": 191.25, "max": 191.25, "min": 191.25, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.29, "avg": 3.29, "max": 3.29, "min": 3.29, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 180, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 88.81, "avg": 29.60, "max": 1.35, "min": 86.06, "cnt": 3}, "forward-compute":{"total": 1939.36, "avg": 60.60, "max": 50.31, "min": 206.49, "cnt": 32}, "fwd-compute":{"total": 1936.16, "avg": 60.50, "max": 50.24, "min": 206.40, "cnt": 32}, "batch-generator":{"total": 39.17, "avg": 1.22, "max": 0.68, "min": 1.73, "cnt": 32}, "fwd-embedding":{"total": 0.65, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1884.71, "avg": 58.90, "max": 48.77, "min": 205.19, "cnt": 32}, "fwd-layernorm":{"total": 10.14, "avg": 0.08, "max": 0.06, "min": 0.18, "cnt": 128}, "fwd-attn":{"total": 109.84, "avg": 0.86, "max": 0.74, "min": 1.48, "cnt": 128}, "fwd-misc":{"total": 21.49, "avg": 0.17, "max": 0.11, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1722.01, "avg": 13.45, "max": 10.12, "min": 146.12, "cnt": 128}, "MoE_L0_fwd":{"total": 482.07, "avg": 15.06, "max": 10.95, "min": 18.74, "cnt": 32}, "MoEMLP":{"total": 1705.16, "avg": 13.32, "max": 10.01, "min": 146.00, "cnt": 128}, "MoE_L1_fwd":{"total": 496.28, "avg": 15.51, "max": 10.22, "min": 146.04, "cnt": 32}, "MoE_L2_fwd":{"total": 361.66, "avg": 11.30, "max": 10.05, "min": 26.76, "cnt": 32}, "MoE_L3_fwd":{"total": 371.37, "avg": 11.61, "max": 10.58, "min": 16.69, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 4.58, "avg": 2.29, "max": 0.60, "min": 3.98, "cnt": 2}, "forward-send-backward-recv":{"total": 751.04, "avg": 25.03, "max": 1.70, "min": 113.67, "cnt": 30}, "backward-compute":{"total": 1441.04, "avg": 45.03, "max": 42.49, "min": 47.29, "cnt": 32}, "MoE_L3_bwd":{"total": 363.15, "avg": 11.35, "max": 9.80, "min": 12.41, "cnt": 32}, "MoE_L2_bwd":{"total": 313.48, "avg": 9.80, "max": 8.84, "min": 10.71, "cnt": 32}, "MoE_L1_bwd":{"total": 270.15, "avg": 8.44, "max": 7.91, "min": 9.17, "cnt": 32}, "MoE_L0_bwd":{"total": 276.74, "avg": 8.65, "max": 8.17, "min": 8.85, "cnt": 32}, "backward-send-forward-recv":{"total": 579.66, "avg": 19.99, "max": 1.42, "min": 134.77, "cnt": 29}, "backward-send":{"total": 2.32, "avg": 0.77, "max": 0.70, "min": 0.87, "cnt": 3}, "backward-recv":{"total": 146.37, "avg": 73.18, "max": 72.47, "min": 73.89, "cnt": 2}, "backward-params-all-reduce":{"total": 485.13, "avg": 485.13, "max": 485.13, "min": 485.13, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 239.28, "avg": 239.28, "max": 239.28, "min": 239.28, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 199.65, "avg": 199.65, "max": 199.65, "min": 199.65, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.27, "avg": 3.27, "max": 3.27, "min": 3.27, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 181, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 74.64, "avg": 24.88, "max": 1.33, "min": 71.76, "cnt": 3}, "forward-compute":{"total": 1776.62, "avg": 55.52, "max": 46.51, "min": 66.97, "cnt": 32}, "fwd-compute":{"total": 1773.18, "avg": 55.41, "max": 46.44, "min": 66.61, "cnt": 32}, "batch-generator":{"total": 41.10, "avg": 1.28, "max": 0.69, "min": 2.57, "cnt": 32}, "fwd-embedding":{"total": 0.64, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1718.74, "avg": 53.71, "max": 45.31, "min": 63.36, "cnt": 32}, "fwd-layernorm":{"total": 10.14, "avg": 0.08, "max": 0.06, "min": 0.24, "cnt": 128}, "fwd-attn":{"total": 109.59, "avg": 0.86, "max": 0.74, "min": 1.90, "cnt": 128}, "fwd-misc":{"total": 21.31, "avg": 0.17, "max": 0.11, "min": 0.40, "cnt": 128}, "fwd-MLP":{"total": 1555.99, "avg": 12.16, "max": 9.79, "min": 19.00, "cnt": 128}, "MoE_L0_fwd":{"total": 463.35, "avg": 14.48, "max": 10.25, "min": 18.92, "cnt": 32}, "MoEMLP":{"total": 1538.67, "avg": 12.02, "max": 9.68, "min": 18.86, "cnt": 128}, "MoE_L1_fwd":{"total": 362.90, "avg": 11.34, "max": 9.72, "min": 14.10, "cnt": 32}, "MoE_L2_fwd":{"total": 352.68, "avg": 11.02, "max": 10.15, "min": 15.28, "cnt": 32}, "MoE_L3_fwd":{"total": 365.88, "avg": 11.43, "max": 10.54, "min": 15.09, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 5.67, "avg": 2.83, "max": 0.95, "min": 4.72, "cnt": 2}, "forward-send-backward-recv":{"total": 572.44, "avg": 19.08, "max": 1.35, "min": 198.90, "cnt": 30}, "backward-compute":{"total": 1462.59, "avg": 45.71, "max": 43.40, "min": 47.30, "cnt": 32}, "MoE_L3_bwd":{"total": 376.61, "avg": 11.77, "max": 10.32, "min": 13.10, "cnt": 32}, "MoE_L2_bwd":{"total": 316.57, "avg": 9.89, "max": 9.16, "min": 11.63, "cnt": 32}, "MoE_L1_bwd":{"total": 268.67, "avg": 8.40, "max": 7.89, "min": 9.13, "cnt": 32}, "MoE_L0_bwd":{"total": 278.26, "avg": 8.70, "max": 8.15, "min": 10.27, "cnt": 32}, "backward-send-forward-recv":{"total": 1580.67, "avg": 54.51, "max": 1.92, "min": 386.30, "cnt": 29}, "backward-send":{"total": 2.63, "avg": 0.88, "max": 0.82, "min": 0.92, "cnt": 3}, "backward-recv":{"total": 122.71, "avg": 61.35, "max": 55.81, "min": 66.90, "cnt": 2}, "backward-params-all-reduce":{"total": 489.14, "avg": 489.14, "max": 489.14, "min": 489.14, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 233.30, "avg": 233.30, "max": 233.30, "min": 233.30, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 193.61, "avg": 193.61, "max": 193.61, "min": 193.61, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.27, "avg": 3.27, "max": 3.27, "min": 3.27, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 182, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 71.51, "avg": 23.84, "max": 1.45, "min": 68.57, "cnt": 3}, "forward-compute":{"total": 1820.30, "avg": 56.88, "max": 48.85, "min": 65.15, "cnt": 32}, "fwd-compute":{"total": 1817.01, "avg": 56.78, "max": 48.77, "min": 65.03, "cnt": 32}, "batch-generator":{"total": 40.46, "avg": 1.26, "max": 0.69, "min": 3.13, "cnt": 32}, "fwd-embedding":{"total": 0.66, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1763.55, "avg": 55.11, "max": 47.74, "min": 62.96, "cnt": 32}, "fwd-layernorm":{"total": 10.17, "avg": 0.08, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 106.86, "avg": 0.83, "max": 0.74, "min": 1.45, "cnt": 128}, "fwd-misc":{"total": 20.97, "avg": 0.16, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1604.22, "avg": 12.53, "max": 10.17, "min": 18.55, "cnt": 128}, "MoE_L0_fwd":{"total": 498.05, "avg": 15.56, "max": 11.55, "min": 18.46, "cnt": 32}, "MoEMLP":{"total": 1587.48, "avg": 12.40, "max": 10.07, "min": 18.39, "cnt": 128}, "MoE_L1_fwd":{"total": 373.37, "avg": 11.67, "max": 10.11, "min": 13.49, "cnt": 32}, "MoE_L2_fwd":{"total": 351.02, "avg": 10.97, "max": 10.40, "min": 14.59, "cnt": 32}, "MoE_L3_fwd":{"total": 371.15, "avg": 11.60, "max": 10.56, "min": 14.07, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.68, "avg": 0.84, "max": 0.78, "min": 0.90, "cnt": 2}, "forward-send-backward-recv":{"total": 1271.71, "avg": 42.39, "max": 1.89, "min": 181.94, "cnt": 30}, "backward-compute":{"total": 1433.08, "avg": 44.78, "max": 42.89, "min": 46.95, "cnt": 32}, "MoE_L3_bwd":{"total": 354.86, "avg": 11.09, "max": 10.17, "min": 13.51, "cnt": 32}, "MoE_L2_bwd":{"total": 315.04, "avg": 9.85, "max": 9.33, "min": 10.60, "cnt": 32}, "MoE_L1_bwd":{"total": 268.31, "avg": 8.38, "max": 7.56, "min": 10.37, "cnt": 32}, "MoE_L0_bwd":{"total": 277.24, "avg": 8.66, "max": 8.34, "min": 9.38, "cnt": 32}, "backward-send-forward-recv":{"total": 490.62, "avg": 16.92, "max": 1.12, "min": 111.74, "cnt": 29}, "backward-send":{"total": 2.89, "avg": 0.96, "max": 0.76, "min": 1.15, "cnt": 3}, "backward-recv":{"total": 157.54, "avg": 78.77, "max": 77.86, "min": 79.68, "cnt": 2}, "backward-params-all-reduce":{"total": 483.67, "avg": 483.67, "max": 483.67, "min": 483.67, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 234.39, "avg": 234.39, "max": 234.39, "min": 234.39, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 194.55, "avg": 194.55, "max": 194.55, "min": 194.55, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.35, "avg": 3.35, "max": 3.35, "min": 3.35, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}}}
{"type":"time", "iteration": 183, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 66.50, "avg": 22.17, "max": 1.14, "min": 63.84, "cnt": 3}, "forward-compute":{"total": 1783.75, "avg": 55.74, "max": 49.21, "min": 64.20, "cnt": 32}, "fwd-compute":{"total": 1780.67, "avg": 55.65, "max": 49.10, "min": 64.07, "cnt": 32}, "batch-generator":{"total": 38.82, "avg": 1.21, "max": 0.67, "min": 2.10, "cnt": 32}, "fwd-embedding":{"total": 0.61, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1729.34, "avg": 54.04, "max": 47.48, "min": 62.19, "cnt": 32}, "fwd-layernorm":{"total": 9.59, "avg": 0.07, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 106.48, "avg": 0.83, "max": 0.74, "min": 1.46, "cnt": 128}, "fwd-misc":{"total": 20.39, "avg": 0.16, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1572.16, "avg": 12.28, "max": 10.07, "min": 19.28, "cnt": 128}, "MoE_L0_fwd":{"total": 471.54, "avg": 14.74, "max": 10.32, "min": 19.20, "cnt": 32}, "MoEMLP":{"total": 1555.78, "avg": 12.15, "max": 9.96, "min": 19.16, "cnt": 128}, "MoE_L1_fwd":{"total": 369.07, "avg": 11.53, "max": 10.00, "min": 15.11, "cnt": 32}, "MoE_L2_fwd":{"total": 360.05, "avg": 11.25, "max": 10.24, "min": 14.71, "cnt": 32}, "MoE_L3_fwd":{"total": 361.10, "avg": 11.28, "max": 10.22, "min": 14.06, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 5.18, "avg": 2.59, "max": 0.97, "min": 4.21, "cnt": 2}, "forward-send-backward-recv":{"total": 824.78, "avg": 27.49, "max": 1.73, "min": 124.80, "cnt": 30}, "backward-compute":{"total": 1447.13, "avg": 45.22, "max": 44.16, "min": 48.13, "cnt": 32}, "MoE_L3_bwd":{"total": 360.52, "avg": 11.27, "max": 10.27, "min": 14.88, "cnt": 32}, "MoE_L2_bwd":{"total": 322.00, "avg": 10.06, "max": 9.38, "min": 10.79, "cnt": 32}, "MoE_L1_bwd":{"total": 270.31, "avg": 8.45, "max": 8.00, "min": 10.34, "cnt": 32}, "MoE_L0_bwd":{"total": 275.79, "avg": 8.62, "max": 8.19, "min": 8.94, "cnt": 32}, "backward-send-forward-recv":{"total": 1838.33, "avg": 63.39, "max": 1.02, "min": 392.18, "cnt": 29}, "backward-send":{"total": 2.55, "avg": 0.85, "max": 0.69, "min": 1.14, "cnt": 3}, "backward-recv":{"total": 290.40, "avg": 145.20, "max": 82.95, "min": 207.45, "cnt": 2}, "backward-params-all-reduce":{"total": 486.46, "avg": 486.46, "max": 486.46, "min": 486.46, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 239.87, "avg": 239.87, "max": 239.87, "min": 239.87, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 200.12, "avg": 200.12, "max": 200.12, "min": 200.12, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.32, "avg": 3.32, "max": 3.32, "min": 3.32, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}}}
{"type":"time", "iteration": 184, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 81.42, "avg": 27.14, "max": 1.09, "min": 78.87, "cnt": 3}, "forward-compute":{"total": 1786.44, "avg": 55.83, "max": 48.41, "min": 62.05, "cnt": 32}, "fwd-compute":{"total": 1783.11, "avg": 55.72, "max": 48.34, "min": 61.92, "cnt": 32}, "batch-generator":{"total": 40.28, "avg": 1.26, "max": 0.62, "min": 2.20, "cnt": 32}, "fwd-embedding":{"total": 0.72, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1729.05, "avg": 54.03, "max": 47.32, "min": 59.97, "cnt": 32}, "fwd-layernorm":{"total": 10.50, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 112.61, "avg": 0.88, "max": 0.74, "min": 2.84, "cnt": 128}, "fwd-misc":{"total": 21.91, "avg": 0.17, "max": 0.12, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1561.68, "avg": 12.20, "max": 9.79, "min": 17.69, "cnt": 128}, "MoE_L0_fwd":{"total": 473.58, "avg": 14.80, "max": 11.34, "min": 17.53, "cnt": 32}, "MoEMLP":{"total": 1543.98, "avg": 12.06, "max": 9.67, "min": 17.48, "cnt": 128}, "MoE_L1_fwd":{"total": 367.04, "avg": 11.47, "max": 9.71, "min": 13.44, "cnt": 32}, "MoE_L2_fwd":{"total": 347.01, "avg": 10.84, "max": 10.11, "min": 11.60, "cnt": 32}, "MoE_L3_fwd":{"total": 362.72, "avg": 11.33, "max": 10.75, "min": 12.34, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.86, "avg": 0.93, "max": 0.85, "min": 1.01, "cnt": 2}, "forward-send-backward-recv":{"total": 457.29, "avg": 15.24, "max": 1.77, "min": 119.34, "cnt": 30}, "backward-compute":{"total": 1459.41, "avg": 45.61, "max": 43.70, "min": 48.60, "cnt": 32}, "MoE_L3_bwd":{"total": 364.07, "avg": 11.38, "max": 10.54, "min": 12.66, "cnt": 32}, "MoE_L2_bwd":{"total": 325.13, "avg": 10.16, "max": 9.63, "min": 12.32, "cnt": 32}, "MoE_L1_bwd":{"total": 272.96, "avg": 8.53, "max": 8.00, "min": 9.57, "cnt": 32}, "MoE_L0_bwd":{"total": 278.10, "avg": 8.69, "max": 8.36, "min": 9.83, "cnt": 32}, "backward-send-forward-recv":{"total": 772.64, "avg": 26.64, "max": 1.91, "min": 129.47, "cnt": 29}, "backward-send":{"total": 2.44, "avg": 0.81, "max": 0.75, "min": 0.93, "cnt": 3}, "backward-recv":{"total": 149.07, "avg": 74.54, "max": 72.91, "min": 76.16, "cnt": 2}, "backward-params-all-reduce":{"total": 488.20, "avg": 488.20, "max": 488.20, "min": 488.20, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 234.62, "avg": 234.62, "max": 234.62, "min": 234.62, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 194.77, "avg": 194.77, "max": 194.77, "min": 194.77, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.59, "avg": 3.59, "max": 3.59, "min": 3.59, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 185, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 94.96, "avg": 31.65, "max": 1.19, "min": 92.12, "cnt": 3}, "forward-compute":{"total": 2002.50, "avg": 62.58, "max": 48.48, "min": 244.27, "cnt": 32}, "fwd-compute":{"total": 1999.24, "avg": 62.48, "max": 48.41, "min": 244.13, "cnt": 32}, "batch-generator":{"total": 43.71, "avg": 1.37, "max": 0.68, "min": 3.68, "cnt": 32}, "fwd-embedding":{"total": 0.64, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1942.52, "avg": 60.70, "max": 47.31, "min": 241.31, "cnt": 32}, "fwd-layernorm":{"total": 10.30, "avg": 0.08, "max": 0.06, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 110.50, "avg": 0.86, "max": 0.74, "min": 1.88, "cnt": 128}, "fwd-misc":{"total": 21.70, "avg": 0.17, "max": 0.12, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1778.19, "avg": 13.89, "max": 9.81, "min": 142.23, "cnt": 128}, "MoE_L0_fwd":{"total": 538.69, "avg": 16.83, "max": 10.57, "min": 69.82, "cnt": 32}, "MoEMLP":{"total": 1760.94, "avg": 13.76, "max": 9.71, "min": 142.09, "cnt": 128}, "MoE_L1_fwd":{"total": 506.87, "avg": 15.84, "max": 9.74, "min": 142.14, "cnt": 32}, "MoE_L2_fwd":{"total": 355.37, "avg": 11.11, "max": 10.29, "min": 14.20, "cnt": 32}, "MoE_L3_fwd":{"total": 366.30, "avg": 11.45, "max": 10.71, "min": 13.02, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 12.51, "avg": 6.25, "max": 0.85, "min": 11.65, "cnt": 2}, "forward-send-backward-recv":{"total": 354.54, "avg": 11.82, "max": 1.70, "min": 109.71, "cnt": 30}, "backward-compute":{"total": 1450.36, "avg": 45.32, "max": 42.29, "min": 47.61, "cnt": 32}, "MoE_L3_bwd":{"total": 360.18, "avg": 11.26, "max": 10.38, "min": 12.80, "cnt": 32}, "MoE_L2_bwd":{"total": 320.00, "avg": 10.00, "max": 9.30, "min": 10.67, "cnt": 32}, "MoE_L1_bwd":{"total": 272.15, "avg": 8.50, "max": 7.28, "min": 8.91, "cnt": 32}, "MoE_L0_bwd":{"total": 277.37, "avg": 8.67, "max": 8.03, "min": 9.92, "cnt": 32}, "backward-send-forward-recv":{"total": 1461.28, "avg": 50.39, "max": 1.19, "min": 391.25, "cnt": 29}, "backward-send":{"total": 2.84, "avg": 0.95, "max": 0.78, "min": 1.09, "cnt": 3}, "backward-recv":{"total": 143.90, "avg": 71.95, "max": 70.72, "min": 73.18, "cnt": 2}, "backward-params-all-reduce":{"total": 484.78, "avg": 484.78, "max": 484.78, "min": 484.78, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 229.01, "avg": 229.01, "max": 229.01, "min": 229.01, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 189.12, "avg": 189.12, "max": 189.12, "min": 189.12, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.47, "avg": 3.47, "max": 3.47, "min": 3.47, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 186, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.11, "avg": 0.11, "max": 0.11, "min": 0.11, "cnt": 1}, "forward-recv":{"total": 70.51, "avg": 23.50, "max": 1.35, "min": 67.67, "cnt": 3}, "forward-compute":{"total": 1835.78, "avg": 57.37, "max": 50.08, "min": 62.63, "cnt": 32}, "fwd-compute":{"total": 1832.31, "avg": 57.26, "max": 50.01, "min": 62.54, "cnt": 32}, "batch-generator":{"total": 46.79, "avg": 1.46, "max": 0.70, "min": 5.45, "cnt": 32}, "fwd-embedding":{"total": 0.80, "avg": 0.03, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1771.40, "avg": 55.36, "max": 48.90, "min": 61.25, "cnt": 32}, "fwd-layernorm":{"total": 11.21, "avg": 0.09, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 119.26, "avg": 0.93, "max": 0.74, "min": 3.14, "cnt": 128}, "fwd-misc":{"total": 24.10, "avg": 0.19, "max": 0.12, "min": 0.52, "cnt": 128}, "fwd-MLP":{"total": 1592.79, "avg": 12.44, "max": 10.58, "min": 19.08, "cnt": 128}, "MoE_L0_fwd":{"total": 489.57, "avg": 15.30, "max": 10.84, "min": 18.94, "cnt": 32}, "MoEMLP":{"total": 1573.78, "avg": 12.30, "max": 10.45, "min": 18.86, "cnt": 128}, "MoE_L1_fwd":{"total": 372.18, "avg": 11.63, "max": 10.50, "min": 13.53, "cnt": 32}, "MoE_L2_fwd":{"total": 359.62, "avg": 11.24, "max": 10.55, "min": 12.90, "cnt": 32}, "MoE_L3_fwd":{"total": 359.27, "avg": 11.23, "max": 10.62, "min": 11.89, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 11.79, "avg": 5.89, "max": 1.02, "min": 10.77, "cnt": 2}, "forward-send-backward-recv":{"total": 534.67, "avg": 17.82, "max": 1.83, "min": 104.61, "cnt": 30}, "backward-compute":{"total": 1496.53, "avg": 46.77, "max": 44.56, "min": 52.02, "cnt": 32}, "MoE_L3_bwd":{"total": 395.95, "avg": 12.37, "max": 11.00, "min": 15.89, "cnt": 32}, "MoE_L2_bwd":{"total": 328.77, "avg": 10.27, "max": 9.37, "min": 13.08, "cnt": 32}, "MoE_L1_bwd":{"total": 275.12, "avg": 8.60, "max": 7.73, "min": 10.81, "cnt": 32}, "MoE_L0_bwd":{"total": 280.85, "avg": 8.78, "max": 8.41, "min": 9.03, "cnt": 32}, "backward-send-forward-recv":{"total": 703.25, "avg": 24.25, "max": 1.05, "min": 231.73, "cnt": 29}, "backward-send":{"total": 1.95, "avg": 0.65, "max": 0.49, "min": 0.94, "cnt": 3}, "backward-recv":{"total": 148.85, "avg": 74.42, "max": 73.36, "min": 75.48, "cnt": 2}, "backward-params-all-reduce":{"total": 485.05, "avg": 485.05, "max": 485.05, "min": 485.05, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 229.44, "avg": 229.44, "max": 229.44, "min": 229.44, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 189.50, "avg": 189.50, "max": 189.50, "min": 189.50, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.59, "avg": 3.59, "max": 3.59, "min": 3.59, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 187, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 81.86, "avg": 27.29, "max": 1.37, "min": 70.16, "cnt": 3}, "forward-compute":{"total": 1829.87, "avg": 57.18, "max": 48.07, "min": 62.00, "cnt": 32}, "fwd-compute":{"total": 1826.00, "avg": 57.06, "max": 47.99, "min": 61.87, "cnt": 32}, "batch-generator":{"total": 45.46, "avg": 1.42, "max": 0.66, "min": 1.77, "cnt": 32}, "fwd-embedding":{"total": 0.85, "avg": 0.03, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1766.44, "avg": 55.20, "max": 46.87, "min": 60.20, "cnt": 32}, "fwd-layernorm":{"total": 11.71, "avg": 0.09, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 119.94, "avg": 0.94, "max": 0.74, "min": 1.51, "cnt": 128}, "fwd-misc":{"total": 23.96, "avg": 0.19, "max": 0.11, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1586.85, "avg": 12.40, "max": 10.05, "min": 17.62, "cnt": 128}, "MoE_L0_fwd":{"total": 477.39, "avg": 14.92, "max": 10.84, "min": 17.53, "cnt": 32}, "MoEMLP":{"total": 1567.74, "avg": 12.25, "max": 9.95, "min": 17.49, "cnt": 128}, "MoE_L1_fwd":{"total": 379.56, "avg": 11.86, "max": 9.98, "min": 15.80, "cnt": 32}, "MoE_L2_fwd":{"total": 350.17, "avg": 10.94, "max": 10.37, "min": 11.79, "cnt": 32}, "MoE_L3_fwd":{"total": 367.47, "avg": 11.48, "max": 10.42, "min": 17.54, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.73, "avg": 0.87, "max": 0.81, "min": 0.92, "cnt": 2}, "forward-send-backward-recv":{"total": 689.56, "avg": 22.99, "max": 1.07, "min": 106.40, "cnt": 30}, "backward-compute":{"total": 1469.32, "avg": 45.92, "max": 43.47, "min": 50.84, "cnt": 32}, "MoE_L3_bwd":{"total": 365.06, "avg": 11.41, "max": 9.72, "min": 16.70, "cnt": 32}, "MoE_L2_bwd":{"total": 329.05, "avg": 10.28, "max": 9.07, "min": 11.66, "cnt": 32}, "MoE_L1_bwd":{"total": 278.95, "avg": 8.72, "max": 8.09, "min": 9.29, "cnt": 32}, "MoE_L0_bwd":{"total": 279.73, "avg": 8.74, "max": 8.12, "min": 9.21, "cnt": 32}, "backward-send-forward-recv":{"total": 333.05, "avg": 11.48, "max": 1.42, "min": 260.48, "cnt": 29}, "backward-send":{"total": 2.83, "avg": 0.94, "max": 0.80, "min": 1.02, "cnt": 3}, "backward-recv":{"total": 151.43, "avg": 75.71, "max": 75.69, "min": 75.74, "cnt": 2}, "backward-params-all-reduce":{"total": 482.88, "avg": 482.88, "max": 482.88, "min": 482.88, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 236.31, "avg": 236.31, "max": 236.31, "min": 236.31, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 196.46, "avg": 196.46, "max": 196.46, "min": 196.46, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.48, "avg": 3.48, "max": 3.48, "min": 3.48, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.48, "avg": 3.48, "max": 3.48, "min": 3.48, "cnt": 1}}}
{"type":"time", "iteration": 188, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 75.53, "avg": 25.18, "max": 1.38, "min": 72.74, "cnt": 3}, "forward-compute":{"total": 1789.13, "avg": 55.91, "max": 49.81, "min": 64.15, "cnt": 32}, "fwd-compute":{"total": 1785.08, "avg": 55.78, "max": 49.71, "min": 64.07, "cnt": 32}, "batch-generator":{"total": 44.68, "avg": 1.40, "max": 0.82, "min": 1.91, "cnt": 32}, "fwd-embedding":{"total": 0.78, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1726.65, "avg": 53.96, "max": 48.45, "min": 62.58, "cnt": 32}, "fwd-layernorm":{"total": 11.15, "avg": 0.09, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 116.62, "avg": 0.91, "max": 0.74, "min": 2.48, "cnt": 128}, "fwd-misc":{"total": 23.60, "avg": 0.18, "max": 0.12, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1552.25, "avg": 12.13, "max": 10.09, "min": 22.15, "cnt": 128}, "MoE_L0_fwd":{"total": 462.24, "avg": 14.44, "max": 11.15, "min": 22.07, "cnt": 32}, "MoEMLP":{"total": 1534.12, "avg": 11.99, "max": 9.98, "min": 22.03, "cnt": 128}, "MoE_L1_fwd":{"total": 365.17, "avg": 11.41, "max": 10.02, "min": 14.48, "cnt": 32}, "MoE_L2_fwd":{"total": 353.81, "avg": 11.06, "max": 10.33, "min": 11.83, "cnt": 32}, "MoE_L3_fwd":{"total": 359.51, "avg": 11.23, "max": 10.50, "min": 12.16, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.67, "avg": 0.02, "max": 0.02, "min": 0.10, "cnt": 32}, "forward-send":{"total": 9.56, "avg": 4.78, "max": 0.98, "min": 8.58, "cnt": 2}, "forward-send-backward-recv":{"total": 469.76, "avg": 15.66, "max": 1.24, "min": 127.61, "cnt": 30}, "backward-compute":{"total": 1477.24, "avg": 46.16, "max": 44.82, "min": 47.78, "cnt": 32}, "MoE_L3_bwd":{"total": 367.39, "avg": 11.48, "max": 10.71, "min": 13.34, "cnt": 32}, "MoE_L2_bwd":{"total": 328.14, "avg": 10.25, "max": 9.58, "min": 11.02, "cnt": 32}, "MoE_L1_bwd":{"total": 280.42, "avg": 8.76, "max": 8.21, "min": 9.87, "cnt": 32}, "MoE_L0_bwd":{"total": 283.66, "avg": 8.86, "max": 8.51, "min": 9.84, "cnt": 32}, "backward-send-forward-recv":{"total": 722.35, "avg": 24.91, "max": 2.02, "min": 120.09, "cnt": 29}, "backward-send":{"total": 3.12, "avg": 1.04, "max": 0.94, "min": 1.10, "cnt": 3}, "backward-recv":{"total": 129.60, "avg": 64.80, "max": 61.23, "min": 68.37, "cnt": 2}, "backward-params-all-reduce":{"total": 485.50, "avg": 485.50, "max": 485.50, "min": 485.50, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 232.78, "avg": 232.78, "max": 232.78, "min": 232.78, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 192.85, "avg": 192.85, "max": 192.85, "min": 192.85, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.49, "avg": 3.49, "max": 3.49, "min": 3.49, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 189, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 67.57, "avg": 22.52, "max": 1.30, "min": 64.90, "cnt": 3}, "forward-compute":{"total": 1796.07, "avg": 56.13, "max": 50.57, "min": 60.50, "cnt": 32}, "fwd-compute":{"total": 1792.60, "avg": 56.02, "max": 50.50, "min": 60.42, "cnt": 32}, "batch-generator":{"total": 41.83, "avg": 1.31, "max": 0.68, "min": 1.82, "cnt": 32}, "fwd-embedding":{"total": 0.74, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1737.50, "avg": 54.30, "max": 49.49, "min": 59.31, "cnt": 32}, "fwd-layernorm":{"total": 10.62, "avg": 0.08, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 112.33, "avg": 0.88, "max": 0.74, "min": 1.51, "cnt": 128}, "fwd-misc":{"total": 21.78, "avg": 0.17, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1570.37, "avg": 12.27, "max": 10.12, "min": 20.96, "cnt": 128}, "MoE_L0_fwd":{"total": 464.86, "avg": 14.53, "max": 11.06, "min": 20.76, "cnt": 32}, "MoEMLP":{"total": 1552.62, "avg": 12.13, "max": 10.02, "min": 20.71, "cnt": 128}, "MoE_L1_fwd":{"total": 369.13, "avg": 11.54, "max": 10.06, "min": 13.57, "cnt": 32}, "MoE_L2_fwd":{"total": 352.47, "avg": 11.01, "max": 10.24, "min": 12.97, "cnt": 32}, "MoE_L3_fwd":{"total": 372.58, "avg": 11.64, "max": 10.51, "min": 16.41, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 2.91, "avg": 1.46, "max": 0.75, "min": 2.16, "cnt": 2}, "forward-send-backward-recv":{"total": 423.70, "avg": 14.12, "max": 1.08, "min": 115.12, "cnt": 30}, "backward-compute":{"total": 1475.19, "avg": 46.10, "max": 44.28, "min": 48.24, "cnt": 32}, "MoE_L3_bwd":{"total": 374.32, "avg": 11.70, "max": 10.59, "min": 15.25, "cnt": 32}, "MoE_L2_bwd":{"total": 323.80, "avg": 10.12, "max": 9.11, "min": 11.26, "cnt": 32}, "MoE_L1_bwd":{"total": 278.64, "avg": 8.71, "max": 8.26, "min": 10.01, "cnt": 32}, "MoE_L0_bwd":{"total": 284.61, "avg": 8.89, "max": 8.38, "min": 9.75, "cnt": 32}, "backward-send-forward-recv":{"total": 1019.65, "avg": 35.16, "max": 1.90, "min": 565.04, "cnt": 29}, "backward-send":{"total": 3.40, "avg": 1.13, "max": 1.11, "min": 1.17, "cnt": 3}, "backward-recv":{"total": 195.04, "avg": 97.52, "max": 69.81, "min": 125.22, "cnt": 2}, "backward-params-all-reduce":{"total": 487.93, "avg": 487.93, "max": 487.93, "min": 487.93, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 231.16, "avg": 231.16, "max": 231.16, "min": 231.16, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 191.42, "avg": 191.42, "max": 191.42, "min": 191.42, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.48, "avg": 3.48, "max": 3.48, "min": 3.48, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 190, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 91.36, "avg": 30.45, "max": 1.37, "min": 88.56, "cnt": 3}, "forward-compute":{"total": 1904.83, "avg": 59.53, "max": 47.77, "min": 201.50, "cnt": 32}, "fwd-compute":{"total": 1901.59, "avg": 59.42, "max": 47.70, "min": 201.42, "cnt": 32}, "batch-generator":{"total": 46.88, "avg": 1.47, "max": 0.66, "min": 4.26, "cnt": 32}, "fwd-embedding":{"total": 0.71, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1841.74, "avg": 57.55, "max": 46.68, "min": 200.26, "cnt": 32}, "fwd-layernorm":{"total": 10.69, "avg": 0.08, "max": 0.06, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 113.51, "avg": 0.89, "max": 0.74, "min": 2.18, "cnt": 128}, "fwd-misc":{"total": 22.01, "avg": 0.17, "max": 0.11, "min": 0.46, "cnt": 128}, "fwd-MLP":{"total": 1673.57, "avg": 13.07, "max": 9.59, "min": 154.65, "cnt": 128}, "MoE_L0_fwd":{"total": 449.00, "avg": 14.03, "max": 10.67, "min": 18.55, "cnt": 32}, "MoEMLP":{"total": 1656.35, "avg": 12.94, "max": 9.48, "min": 154.54, "cnt": 128}, "MoE_L1_fwd":{"total": 374.71, "avg": 11.71, "max": 9.96, "min": 17.11, "cnt": 32}, "MoE_L2_fwd":{"total": 479.06, "avg": 14.97, "max": 9.52, "min": 154.58, "cnt": 32}, "MoE_L3_fwd":{"total": 359.88, "avg": 11.25, "max": 10.47, "min": 17.39, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 8.65, "avg": 4.33, "max": 0.90, "min": 7.75, "cnt": 2}, "forward-send-backward-recv":{"total": 343.60, "avg": 11.45, "max": 1.81, "min": 122.01, "cnt": 30}, "backward-compute":{"total": 1439.72, "avg": 44.99, "max": 43.40, "min": 46.28, "cnt": 32}, "MoE_L3_bwd":{"total": 368.27, "avg": 11.51, "max": 10.86, "min": 13.12, "cnt": 32}, "MoE_L2_bwd":{"total": 288.43, "avg": 9.01, "max": 8.39, "min": 9.67, "cnt": 32}, "MoE_L1_bwd":{"total": 280.41, "avg": 8.76, "max": 8.27, "min": 9.35, "cnt": 32}, "MoE_L0_bwd":{"total": 285.37, "avg": 8.92, "max": 8.36, "min": 9.43, "cnt": 32}, "backward-send-forward-recv":{"total": 2848.80, "avg": 98.23, "max": 2.05, "min": 469.26, "cnt": 29}, "backward-send":{"total": 3.46, "avg": 1.15, "max": 0.97, "min": 1.43, "cnt": 3}, "backward-recv":{"total": 152.87, "avg": 76.43, "max": 74.97, "min": 77.89, "cnt": 2}, "backward-params-all-reduce":{"total": 480.40, "avg": 480.40, "max": 480.40, "min": 480.40, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 236.75, "avg": 236.75, "max": 236.75, "min": 236.75, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 196.83, "avg": 196.83, "max": 196.83, "min": 196.83, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.62, "avg": 3.62, "max": 3.62, "min": 3.62, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 191, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 91.00, "avg": 30.33, "max": 3.23, "min": 77.45, "cnt": 3}, "forward-compute":{"total": 1823.91, "avg": 57.00, "max": 48.16, "min": 67.41, "cnt": 32}, "fwd-compute":{"total": 1820.15, "avg": 56.88, "max": 48.09, "min": 67.29, "cnt": 32}, "batch-generator":{"total": 48.65, "avg": 1.52, "max": 0.69, "min": 3.18, "cnt": 32}, "fwd-embedding":{"total": 0.77, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1755.85, "avg": 54.87, "max": 47.04, "min": 66.19, "cnt": 32}, "fwd-layernorm":{"total": 11.16, "avg": 0.09, "max": 0.06, "min": 0.24, "cnt": 128}, "fwd-attn":{"total": 113.13, "avg": 0.88, "max": 0.74, "min": 1.49, "cnt": 128}, "fwd-misc":{"total": 22.92, "avg": 0.18, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1585.19, "avg": 12.38, "max": 9.78, "min": 19.02, "cnt": 128}, "MoE_L0_fwd":{"total": 466.29, "avg": 14.57, "max": 10.90, "min": 18.90, "cnt": 32}, "MoEMLP":{"total": 1566.73, "avg": 12.24, "max": 9.67, "min": 18.81, "cnt": 128}, "MoE_L1_fwd":{"total": 381.52, "avg": 11.92, "max": 10.33, "min": 16.03, "cnt": 32}, "MoE_L2_fwd":{"total": 348.03, "avg": 10.88, "max": 9.71, "min": 16.24, "cnt": 32}, "MoE_L3_fwd":{"total": 377.61, "avg": 11.80, "max": 10.16, "min": 16.99, "cnt": 32}, "fwd-pooler":{"total": 0.38, "avg": 0.01, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-loss-func":{"total": 0.66, "avg": 0.02, "max": 0.02, "min": 0.06, "cnt": 32}, "forward-send":{"total": 1.73, "avg": 0.87, "max": 0.86, "min": 0.88, "cnt": 2}, "forward-send-backward-recv":{"total": 374.25, "avg": 12.47, "max": 1.43, "min": 113.11, "cnt": 30}, "backward-compute":{"total": 1466.05, "avg": 45.81, "max": 43.63, "min": 48.22, "cnt": 32}, "MoE_L3_bwd":{"total": 384.82, "avg": 12.03, "max": 11.26, "min": 13.03, "cnt": 32}, "MoE_L2_bwd":{"total": 295.97, "avg": 9.25, "max": 8.40, "min": 11.89, "cnt": 32}, "MoE_L1_bwd":{"total": 282.59, "avg": 8.83, "max": 7.99, "min": 10.21, "cnt": 32}, "MoE_L0_bwd":{"total": 285.26, "avg": 8.91, "max": 8.45, "min": 9.36, "cnt": 32}, "backward-send-forward-recv":{"total": 673.63, "avg": 23.23, "max": 1.09, "min": 118.19, "cnt": 29}, "backward-send":{"total": 2.72, "avg": 0.91, "max": 0.77, "min": 1.03, "cnt": 3}, "backward-recv":{"total": 139.20, "avg": 69.60, "max": 59.09, "min": 80.11, "cnt": 2}, "backward-params-all-reduce":{"total": 487.06, "avg": 487.06, "max": 487.06, "min": 487.06, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 238.53, "avg": 238.53, "max": 238.53, "min": 238.53, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 190.43, "avg": 190.43, "max": 190.43, "min": 190.43, "cnt": 1}, "optimizer-clip-main-grad":{"total": 9.32, "avg": 9.32, "max": 9.32, "min": 9.32, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}}}
{"type":"time", "iteration": 192, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 71.04, "avg": 23.68, "max": 1.63, "min": 61.69, "cnt": 3}, "forward-compute":{"total": 1811.61, "avg": 56.61, "max": 46.62, "min": 69.00, "cnt": 32}, "fwd-compute":{"total": 1807.91, "avg": 56.50, "max": 46.55, "min": 68.85, "cnt": 32}, "batch-generator":{"total": 47.27, "avg": 1.48, "max": 0.65, "min": 3.35, "cnt": 32}, "fwd-embedding":{"total": 0.78, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1746.83, "avg": 54.59, "max": 45.57, "min": 66.51, "cnt": 32}, "fwd-layernorm":{"total": 10.91, "avg": 0.09, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 115.39, "avg": 0.90, "max": 0.74, "min": 1.84, "cnt": 128}, "fwd-misc":{"total": 22.82, "avg": 0.18, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1574.91, "avg": 12.30, "max": 9.72, "min": 19.46, "cnt": 128}, "MoE_L0_fwd":{"total": 469.35, "avg": 14.67, "max": 10.52, "min": 19.34, "cnt": 32}, "MoEMLP":{"total": 1556.76, "avg": 12.16, "max": 9.62, "min": 19.30, "cnt": 128}, "MoE_L1_fwd":{"total": 382.24, "avg": 11.94, "max": 10.36, "min": 17.21, "cnt": 32}, "MoE_L2_fwd":{"total": 347.15, "avg": 10.85, "max": 9.66, "min": 15.91, "cnt": 32}, "MoE_L3_fwd":{"total": 364.68, "avg": 11.40, "max": 10.24, "min": 14.71, "cnt": 32}, "fwd-pooler":{"total": 0.36, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.61, "avg": 0.02, "max": 0.02, "min": 0.05, "cnt": 32}, "forward-send":{"total": 1.83, "avg": 0.91, "max": 0.84, "min": 0.98, "cnt": 2}, "forward-send-backward-recv":{"total": 547.18, "avg": 18.24, "max": 1.80, "min": 108.83, "cnt": 30}, "backward-compute":{"total": 1449.35, "avg": 45.29, "max": 43.71, "min": 47.52, "cnt": 32}, "MoE_L3_bwd":{"total": 371.91, "avg": 11.62, "max": 10.02, "min": 13.43, "cnt": 32}, "MoE_L2_bwd":{"total": 288.42, "avg": 9.01, "max": 8.09, "min": 9.74, "cnt": 32}, "MoE_L1_bwd":{"total": 283.15, "avg": 8.85, "max": 8.40, "min": 9.76, "cnt": 32}, "MoE_L0_bwd":{"total": 286.54, "avg": 8.95, "max": 8.48, "min": 9.52, "cnt": 32}, "backward-send-forward-recv":{"total": 1088.87, "avg": 37.55, "max": 1.93, "min": 385.08, "cnt": 29}, "backward-send":{"total": 2.13, "avg": 0.71, "max": 0.48, "min": 0.84, "cnt": 3}, "backward-recv":{"total": 156.17, "avg": 78.08, "max": 77.31, "min": 78.86, "cnt": 2}, "backward-params-all-reduce":{"total": 483.50, "avg": 483.50, "max": 483.50, "min": 483.50, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 235.19, "avg": 235.19, "max": 235.19, "min": 235.19, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 195.45, "avg": 195.45, "max": 195.45, "min": 195.45, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.30, "avg": 3.30, "max": 3.30, "min": 3.30, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 193, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 73.81, "avg": 24.60, "max": 4.90, "min": 61.78, "cnt": 3}, "forward-compute":{"total": 1801.42, "avg": 56.29, "max": 48.85, "min": 64.01, "cnt": 32}, "fwd-compute":{"total": 1797.64, "avg": 56.18, "max": 48.77, "min": 63.92, "cnt": 32}, "batch-generator":{"total": 46.76, "avg": 1.46, "max": 0.75, "min": 2.09, "cnt": 32}, "fwd-embedding":{"total": 0.85, "avg": 0.03, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1736.63, "avg": 54.27, "max": 47.65, "min": 62.45, "cnt": 32}, "fwd-layernorm":{"total": 11.88, "avg": 0.09, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 118.83, "avg": 0.93, "max": 0.74, "min": 1.98, "cnt": 128}, "fwd-misc":{"total": 24.30, "avg": 0.19, "max": 0.12, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1557.19, "avg": 12.17, "max": 9.78, "min": 19.54, "cnt": 128}, "MoE_L0_fwd":{"total": 476.65, "avg": 14.90, "max": 10.56, "min": 19.44, "cnt": 32}, "MoEMLP":{"total": 1537.84, "avg": 12.01, "max": 9.67, "min": 19.39, "cnt": 128}, "MoE_L1_fwd":{"total": 376.86, "avg": 11.78, "max": 10.29, "min": 15.29, "cnt": 32}, "MoE_L2_fwd":{"total": 336.15, "avg": 10.50, "max": 9.71, "min": 13.00, "cnt": 32}, "MoE_L3_fwd":{"total": 355.15, "avg": 11.10, "max": 10.50, "min": 12.00, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.65, "avg": 0.83, "max": 0.77, "min": 0.88, "cnt": 2}, "forward-send-backward-recv":{"total": 816.31, "avg": 27.21, "max": 10.75, "min": 118.04, "cnt": 30}, "backward-compute":{"total": 1448.33, "avg": 45.26, "max": 43.20, "min": 49.13, "cnt": 32}, "MoE_L3_bwd":{"total": 366.79, "avg": 11.46, "max": 10.59, "min": 12.47, "cnt": 32}, "MoE_L2_bwd":{"total": 292.25, "avg": 9.13, "max": 8.73, "min": 10.11, "cnt": 32}, "MoE_L1_bwd":{"total": 284.07, "avg": 8.88, "max": 8.43, "min": 9.53, "cnt": 32}, "MoE_L0_bwd":{"total": 284.60, "avg": 8.89, "max": 7.93, "min": 11.14, "cnt": 32}, "backward-send-forward-recv":{"total": 62.70, "avg": 2.16, "max": 1.16, "min": 2.45, "cnt": 29}, "backward-send":{"total": 2.45, "avg": 0.82, "max": 0.62, "min": 1.03, "cnt": 3}, "backward-recv":{"total": 153.26, "avg": 76.63, "max": 70.07, "min": 83.19, "cnt": 2}, "backward-params-all-reduce":{"total": 486.47, "avg": 486.47, "max": 486.47, "min": 486.47, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 234.71, "avg": 234.71, "max": 234.71, "min": 234.71, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 194.98, "avg": 194.98, "max": 194.98, "min": 194.98, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.26, "avg": 3.26, "max": 3.26, "min": 3.26, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 194, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 71.14, "avg": 23.71, "max": 3.42, "min": 63.34, "cnt": 3}, "forward-compute":{"total": 1728.71, "avg": 54.02, "max": 46.58, "min": 64.30, "cnt": 32}, "fwd-compute":{"total": 1725.58, "avg": 53.92, "max": 46.51, "min": 64.16, "cnt": 32}, "batch-generator":{"total": 40.89, "avg": 1.28, "max": 0.65, "min": 3.36, "cnt": 32}, "fwd-embedding":{"total": 0.56, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1672.51, "avg": 52.27, "max": 45.44, "min": 61.87, "cnt": 32}, "fwd-layernorm":{"total": 9.62, "avg": 0.08, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 107.73, "avg": 0.84, "max": 0.74, "min": 1.53, "cnt": 128}, "fwd-misc":{"total": 20.71, "avg": 0.16, "max": 0.11, "min": 0.46, "cnt": 128}, "fwd-MLP":{"total": 1513.60, "avg": 11.82, "max": 9.70, "min": 19.37, "cnt": 128}, "MoE_L0_fwd":{"total": 446.94, "avg": 13.97, "max": 10.49, "min": 19.28, "cnt": 32}, "MoEMLP":{"total": 1497.03, "avg": 11.70, "max": 9.60, "min": 19.23, "cnt": 128}, "MoE_L1_fwd":{"total": 366.71, "avg": 11.46, "max": 9.87, "min": 17.15, "cnt": 32}, "MoE_L2_fwd":{"total": 329.04, "avg": 10.28, "max": 9.64, "min": 11.22, "cnt": 32}, "MoE_L3_fwd":{"total": 360.39, "avg": 11.26, "max": 10.25, "min": 16.44, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 2.62, "avg": 1.31, "max": 0.96, "min": 1.67, "cnt": 2}, "forward-send-backward-recv":{"total": 233.13, "avg": 7.77, "max": 0.90, "min": 122.75, "cnt": 30}, "backward-compute":{"total": 1447.15, "avg": 45.22, "max": 42.73, "min": 46.73, "cnt": 32}, "MoE_L3_bwd":{"total": 376.78, "avg": 11.77, "max": 11.12, "min": 12.92, "cnt": 32}, "MoE_L2_bwd":{"total": 290.89, "avg": 9.09, "max": 8.31, "min": 9.59, "cnt": 32}, "MoE_L1_bwd":{"total": 280.59, "avg": 8.77, "max": 8.20, "min": 10.13, "cnt": 32}, "MoE_L0_bwd":{"total": 279.36, "avg": 8.73, "max": 8.16, "min": 9.37, "cnt": 32}, "backward-send-forward-recv":{"total": 2191.68, "avg": 75.58, "max": 1.65, "min": 769.26, "cnt": 29}, "backward-send":{"total": 3.02, "avg": 1.01, "max": 0.95, "min": 1.04, "cnt": 3}, "backward-recv":{"total": 142.87, "avg": 71.44, "max": 62.69, "min": 80.19, "cnt": 2}, "backward-params-all-reduce":{"total": 484.36, "avg": 484.36, "max": 484.36, "min": 484.36, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 236.67, "avg": 236.67, "max": 236.67, "min": 236.67, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 197.00, "avg": 197.00, "max": 197.00, "min": 197.00, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}}}
{"type":"time", "iteration": 195, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 87.90, "avg": 29.30, "max": 2.47, "min": 77.19, "cnt": 3}, "forward-compute":{"total": 1767.81, "avg": 55.24, "max": 48.08, "min": 62.24, "cnt": 32}, "fwd-compute":{"total": 1764.10, "avg": 55.13, "max": 47.99, "min": 62.11, "cnt": 32}, "batch-generator":{"total": 46.80, "avg": 1.46, "max": 0.67, "min": 1.84, "cnt": 32}, "fwd-embedding":{"total": 0.82, "avg": 0.03, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1703.61, "avg": 53.24, "max": 46.83, "min": 59.85, "cnt": 32}, "fwd-layernorm":{"total": 11.24, "avg": 0.09, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 117.91, "avg": 0.92, "max": 0.74, "min": 1.51, "cnt": 128}, "fwd-misc":{"total": 23.23, "avg": 0.18, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1527.61, "avg": 11.93, "max": 9.57, "min": 17.68, "cnt": 128}, "MoE_L0_fwd":{"total": 449.47, "avg": 14.05, "max": 10.52, "min": 17.61, "cnt": 32}, "MoEMLP":{"total": 1509.52, "avg": 11.79, "max": 9.46, "min": 17.56, "cnt": 128}, "MoE_L1_fwd":{"total": 370.74, "avg": 11.59, "max": 10.26, "min": 15.74, "cnt": 32}, "MoE_L2_fwd":{"total": 336.93, "avg": 10.53, "max": 9.50, "min": 15.63, "cnt": 32}, "MoE_L3_fwd":{"total": 358.98, "avg": 11.22, "max": 10.22, "min": 13.63, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.67, "avg": 0.84, "max": 0.76, "min": 0.91, "cnt": 2}, "forward-send-backward-recv":{"total": 522.55, "avg": 17.42, "max": 1.87, "min": 104.16, "cnt": 30}, "backward-compute":{"total": 1427.49, "avg": 44.61, "max": 42.52, "min": 46.01, "cnt": 32}, "MoE_L3_bwd":{"total": 360.14, "avg": 11.25, "max": 10.36, "min": 12.16, "cnt": 32}, "MoE_L2_bwd":{"total": 293.41, "avg": 9.17, "max": 8.19, "min": 10.72, "cnt": 32}, "MoE_L1_bwd":{"total": 278.02, "avg": 8.69, "max": 8.10, "min": 8.98, "cnt": 32}, "MoE_L0_bwd":{"total": 275.35, "avg": 8.60, "max": 8.10, "min": 9.07, "cnt": 32}, "backward-send-forward-recv":{"total": 544.86, "avg": 18.79, "max": 2.24, "min": 154.14, "cnt": 29}, "backward-send":{"total": 3.32, "avg": 1.11, "max": 1.09, "min": 1.13, "cnt": 3}, "backward-recv":{"total": 156.67, "avg": 78.33, "max": 77.39, "min": 79.28, "cnt": 2}, "backward-params-all-reduce":{"total": 489.09, "avg": 489.09, "max": 489.09, "min": 489.09, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 234.30, "avg": 234.30, "max": 234.30, "min": 234.30, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 189.22, "avg": 189.22, "max": 189.22, "min": 189.22, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.28, "avg": 3.28, "max": 3.28, "min": 3.28, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 196, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 89.80, "avg": 29.93, "max": 7.82, "min": 68.68, "cnt": 3}, "forward-compute":{"total": 1790.24, "avg": 55.95, "max": 47.41, "min": 65.85, "cnt": 32}, "fwd-compute":{"total": 1786.69, "avg": 55.83, "max": 47.35, "min": 65.75, "cnt": 32}, "batch-generator":{"total": 48.87, "avg": 1.53, "max": 0.67, "min": 3.10, "cnt": 32}, "fwd-embedding":{"total": 0.80, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1723.44, "avg": 53.86, "max": 46.25, "min": 63.23, "cnt": 32}, "fwd-layernorm":{"total": 11.40, "avg": 0.09, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 114.74, "avg": 0.90, "max": 0.74, "min": 1.49, "cnt": 128}, "fwd-misc":{"total": 23.55, "avg": 0.18, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1550.13, "avg": 12.11, "max": 9.53, "min": 18.47, "cnt": 128}, "MoE_L0_fwd":{"total": 458.16, "avg": 14.32, "max": 10.62, "min": 18.39, "cnt": 32}, "MoEMLP":{"total": 1531.62, "avg": 11.97, "max": 9.41, "min": 18.34, "cnt": 128}, "MoE_L1_fwd":{"total": 362.75, "avg": 11.34, "max": 10.21, "min": 12.81, "cnt": 32}, "MoE_L2_fwd":{"total": 344.43, "avg": 10.76, "max": 9.46, "min": 15.30, "cnt": 32}, "MoE_L3_fwd":{"total": 373.05, "avg": 11.66, "max": 10.53, "min": 16.23, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.73, "avg": 0.86, "max": 0.86, "min": 0.87, "cnt": 2}, "forward-send-backward-recv":{"total": 652.01, "avg": 21.73, "max": 1.78, "min": 126.04, "cnt": 30}, "backward-compute":{"total": 1434.85, "avg": 44.84, "max": 43.32, "min": 46.40, "cnt": 32}, "MoE_L3_bwd":{"total": 362.21, "avg": 11.32, "max": 10.55, "min": 12.17, "cnt": 32}, "MoE_L2_bwd":{"total": 300.10, "avg": 9.38, "max": 8.42, "min": 10.45, "cnt": 32}, "MoE_L1_bwd":{"total": 281.75, "avg": 8.80, "max": 8.33, "min": 9.27, "cnt": 32}, "MoE_L0_bwd":{"total": 273.21, "avg": 8.54, "max": 7.93, "min": 9.08, "cnt": 32}, "backward-send-forward-recv":{"total": 1751.10, "avg": 60.38, "max": 1.98, "min": 627.66, "cnt": 29}, "backward-send":{"total": 2.64, "avg": 0.88, "max": 0.81, "min": 0.98, "cnt": 3}, "backward-recv":{"total": 147.65, "avg": 73.83, "max": 69.57, "min": 78.08, "cnt": 2}, "backward-params-all-reduce":{"total": 485.40, "avg": 485.40, "max": 485.40, "min": 485.40, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 233.88, "avg": 233.88, "max": 233.88, "min": 233.88, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 194.07, "avg": 194.07, "max": 194.07, "min": 194.07, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 197, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 74.32, "avg": 24.77, "max": 1.49, "min": 71.30, "cnt": 3}, "forward-compute":{"total": 1789.35, "avg": 55.92, "max": 48.95, "min": 67.43, "cnt": 32}, "fwd-compute":{"total": 1785.88, "avg": 55.81, "max": 48.88, "min": 67.32, "cnt": 32}, "batch-generator":{"total": 42.00, "avg": 1.31, "max": 0.68, "min": 1.79, "cnt": 32}, "fwd-embedding":{"total": 0.72, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1730.42, "avg": 54.08, "max": 47.88, "min": 65.84, "cnt": 32}, "fwd-layernorm":{"total": 10.72, "avg": 0.08, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 114.12, "avg": 0.89, "max": 0.74, "min": 2.48, "cnt": 128}, "fwd-misc":{"total": 23.03, "avg": 0.18, "max": 0.12, "min": 0.40, "cnt": 128}, "fwd-MLP":{"total": 1559.91, "avg": 12.19, "max": 9.88, "min": 20.92, "cnt": 128}, "MoE_L0_fwd":{"total": 463.52, "avg": 14.48, "max": 10.85, "min": 20.83, "cnt": 32}, "MoEMLP":{"total": 1542.14, "avg": 12.05, "max": 9.77, "min": 20.77, "cnt": 128}, "MoE_L1_fwd":{"total": 380.83, "avg": 11.90, "max": 10.14, "min": 19.18, "cnt": 32}, "MoE_L2_fwd":{"total": 335.74, "avg": 10.49, "max": 9.81, "min": 11.27, "cnt": 32}, "MoE_L3_fwd":{"total": 368.54, "avg": 11.52, "max": 10.41, "min": 17.26, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.92, "avg": 0.96, "max": 0.90, "min": 1.02, "cnt": 2}, "forward-send-backward-recv":{"total": 528.22, "avg": 17.61, "max": 1.79, "min": 136.58, "cnt": 30}, "backward-compute":{"total": 1449.42, "avg": 45.29, "max": 43.16, "min": 47.08, "cnt": 32}, "MoE_L3_bwd":{"total": 362.34, "avg": 11.32, "max": 10.57, "min": 12.84, "cnt": 32}, "MoE_L2_bwd":{"total": 306.03, "avg": 9.56, "max": 8.80, "min": 11.43, "cnt": 32}, "MoE_L1_bwd":{"total": 285.77, "avg": 8.93, "max": 8.25, "min": 10.64, "cnt": 32}, "MoE_L0_bwd":{"total": 276.89, "avg": 8.65, "max": 8.10, "min": 10.37, "cnt": 32}, "backward-send-forward-recv":{"total": 603.17, "avg": 20.80, "max": 1.70, "min": 99.84, "cnt": 29}, "backward-send":{"total": 3.08, "avg": 1.03, "max": 0.91, "min": 1.14, "cnt": 3}, "backward-recv":{"total": 148.76, "avg": 74.38, "max": 71.92, "min": 76.84, "cnt": 2}, "backward-params-all-reduce":{"total": 489.32, "avg": 489.32, "max": 489.32, "min": 489.32, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 228.12, "avg": 228.12, "max": 228.12, "min": 228.12, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 188.55, "avg": 188.55, "max": 188.55, "min": 188.55, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.25, "avg": 3.25, "max": 3.25, "min": 3.25, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 198, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 75.73, "avg": 25.24, "max": 2.23, "min": 70.49, "cnt": 3}, "forward-compute":{"total": 1796.51, "avg": 56.14, "max": 48.08, "min": 63.00, "cnt": 32}, "fwd-compute":{"total": 1792.77, "avg": 56.02, "max": 48.01, "min": 62.87, "cnt": 32}, "batch-generator":{"total": 46.09, "avg": 1.44, "max": 0.66, "min": 1.89, "cnt": 32}, "fwd-embedding":{"total": 0.80, "avg": 0.03, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1732.70, "avg": 54.15, "max": 46.87, "min": 60.74, "cnt": 32}, "fwd-layernorm":{"total": 11.55, "avg": 0.09, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 118.68, "avg": 0.93, "max": 0.74, "min": 1.90, "cnt": 128}, "fwd-misc":{"total": 24.27, "avg": 0.19, "max": 0.12, "min": 0.42, "cnt": 128}, "fwd-MLP":{"total": 1553.80, "avg": 12.14, "max": 9.77, "min": 19.04, "cnt": 128}, "MoE_L0_fwd":{"total": 469.29, "avg": 14.67, "max": 11.09, "min": 18.95, "cnt": 32}, "MoEMLP":{"total": 1535.14, "avg": 11.99, "max": 9.65, "min": 18.90, "cnt": 128}, "MoE_L1_fwd":{"total": 377.12, "avg": 11.78, "max": 10.06, "min": 15.04, "cnt": 32}, "MoE_L2_fwd":{"total": 339.95, "avg": 10.62, "max": 9.69, "min": 12.47, "cnt": 32}, "MoE_L3_fwd":{"total": 355.57, "avg": 11.11, "max": 10.18, "min": 12.85, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 7.20, "avg": 3.60, "max": 0.86, "min": 6.34, "cnt": 2}, "forward-send-backward-recv":{"total": 762.25, "avg": 25.41, "max": 1.89, "min": 139.53, "cnt": 30}, "backward-compute":{"total": 1442.85, "avg": 45.09, "max": 43.09, "min": 47.33, "cnt": 32}, "MoE_L3_bwd":{"total": 367.67, "avg": 11.49, "max": 10.56, "min": 12.84, "cnt": 32}, "MoE_L2_bwd":{"total": 303.97, "avg": 9.50, "max": 8.76, "min": 10.30, "cnt": 32}, "MoE_L1_bwd":{"total": 282.82, "avg": 8.84, "max": 8.24, "min": 9.21, "cnt": 32}, "MoE_L0_bwd":{"total": 272.49, "avg": 8.52, "max": 8.05, "min": 9.90, "cnt": 32}, "backward-send-forward-recv":{"total": 1205.44, "avg": 41.57, "max": 2.19, "min": 367.60, "cnt": 29}, "backward-send":{"total": 3.42, "avg": 1.14, "max": 1.00, "min": 1.25, "cnt": 3}, "backward-recv":{"total": 229.82, "avg": 114.91, "max": 75.88, "min": 153.94, "cnt": 2}, "backward-params-all-reduce":{"total": 484.85, "avg": 484.85, "max": 484.85, "min": 484.85, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 235.77, "avg": 235.77, "max": 235.77, "min": 235.77, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 192.23, "avg": 192.23, "max": 192.23, "min": 192.23, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.33, "avg": 3.33, "max": 3.33, "min": 3.33, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 199, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.11, "avg": 0.11, "max": 0.11, "min": 0.11, "cnt": 1}, "forward-recv":{"total": 71.72, "avg": 23.91, "max": 1.64, "min": 68.43, "cnt": 3}, "forward-compute":{"total": 1785.29, "avg": 55.79, "max": 47.53, "min": 62.29, "cnt": 32}, "fwd-compute":{"total": 1781.77, "avg": 55.68, "max": 47.46, "min": 62.19, "cnt": 32}, "batch-generator":{"total": 45.11, "avg": 1.41, "max": 0.68, "min": 1.80, "cnt": 32}, "fwd-embedding":{"total": 0.70, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1723.46, "avg": 53.86, "max": 46.46, "min": 60.70, "cnt": 32}, "fwd-layernorm":{"total": 10.57, "avg": 0.08, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 113.07, "avg": 0.88, "max": 0.74, "min": 2.04, "cnt": 128}, "fwd-misc":{"total": 22.67, "avg": 0.18, "max": 0.11, "min": 0.39, "cnt": 128}, "fwd-MLP":{"total": 1554.84, "avg": 12.15, "max": 10.09, "min": 18.07, "cnt": 128}, "MoE_L0_fwd":{"total": 464.80, "avg": 14.53, "max": 10.49, "min": 17.98, "cnt": 32}, "MoEMLP":{"total": 1537.21, "avg": 12.01, "max": 9.97, "min": 17.94, "cnt": 128}, "MoE_L1_fwd":{"total": 381.00, "avg": 11.91, "max": 10.35, "min": 16.08, "cnt": 32}, "MoE_L2_fwd":{"total": 336.71, "avg": 10.52, "max": 10.01, "min": 12.40, "cnt": 32}, "MoE_L3_fwd":{"total": 361.24, "avg": 11.29, "max": 10.13, "min": 16.28, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.81, "avg": 0.91, "max": 0.87, "min": 0.95, "cnt": 2}, "forward-send-backward-recv":{"total": 350.50, "avg": 11.68, "max": 1.62, "min": 118.31, "cnt": 30}, "backward-compute":{"total": 1443.83, "avg": 45.12, "max": 43.19, "min": 48.79, "cnt": 32}, "MoE_L3_bwd":{"total": 365.06, "avg": 11.41, "max": 10.71, "min": 13.44, "cnt": 32}, "MoE_L2_bwd":{"total": 305.50, "avg": 9.55, "max": 8.75, "min": 13.67, "cnt": 32}, "MoE_L1_bwd":{"total": 281.81, "avg": 8.81, "max": 8.06, "min": 10.14, "cnt": 32}, "MoE_L0_bwd":{"total": 270.90, "avg": 8.47, "max": 7.96, "min": 9.21, "cnt": 32}, "backward-send-forward-recv":{"total": 1101.30, "avg": 37.98, "max": 1.89, "min": 240.29, "cnt": 29}, "backward-send":{"total": 3.44, "avg": 1.15, "max": 1.04, "min": 1.31, "cnt": 3}, "backward-recv":{"total": 146.50, "avg": 73.25, "max": 70.67, "min": 75.82, "cnt": 2}, "backward-params-all-reduce":{"total": 491.27, "avg": 491.27, "max": 491.27, "min": 491.27, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 228.25, "avg": 228.25, "max": 228.25, "min": 228.25, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 187.88, "avg": 187.88, "max": 187.88, "min": 187.88, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.82, "avg": 3.82, "max": 3.82, "min": 3.82, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 200, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 87.32, "avg": 29.11, "max": 1.31, "min": 84.39, "cnt": 3}, "forward-compute":{"total": 1830.15, "avg": 57.19, "max": 51.86, "min": 62.22, "cnt": 32}, "fwd-compute":{"total": 1826.49, "avg": 57.08, "max": 51.79, "min": 62.12, "cnt": 32}, "batch-generator":{"total": 42.75, "avg": 1.34, "max": 0.74, "min": 2.39, "cnt": 32}, "fwd-embedding":{"total": 0.75, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1769.00, "avg": 55.28, "max": 49.93, "min": 60.71, "cnt": 32}, "fwd-layernorm":{"total": 10.87, "avg": 0.08, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 113.33, "avg": 0.89, "max": 0.74, "min": 1.69, "cnt": 128}, "fwd-misc":{"total": 22.63, "avg": 0.18, "max": 0.11, "min": 0.34, "cnt": 128}, "fwd-MLP":{"total": 1599.34, "avg": 12.49, "max": 10.01, "min": 19.84, "cnt": 128}, "MoE_L0_fwd":{"total": 490.48, "avg": 15.33, "max": 11.06, "min": 19.69, "cnt": 32}, "MoEMLP":{"total": 1581.46, "avg": 12.36, "max": 9.90, "min": 19.61, "cnt": 128}, "MoE_L1_fwd":{"total": 382.82, "avg": 11.96, "max": 10.29, "min": 15.29, "cnt": 32}, "MoE_L2_fwd":{"total": 345.56, "avg": 10.80, "max": 9.94, "min": 14.39, "cnt": 32}, "MoE_L3_fwd":{"total": 369.21, "avg": 11.54, "max": 10.40, "min": 16.02, "cnt": 32}, "fwd-pooler":{"total": 0.36, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.61, "avg": 0.02, "max": 0.02, "min": 0.05, "cnt": 32}, "forward-send":{"total": 11.85, "avg": 5.92, "max": 1.01, "min": 10.84, "cnt": 2}, "forward-send-backward-recv":{"total": 760.55, "avg": 25.35, "max": 1.91, "min": 117.95, "cnt": 30}, "backward-compute":{"total": 1427.38, "avg": 44.61, "max": 42.89, "min": 46.74, "cnt": 32}, "MoE_L3_bwd":{"total": 357.93, "avg": 11.19, "max": 10.23, "min": 12.03, "cnt": 32}, "MoE_L2_bwd":{"total": 293.79, "avg": 9.18, "max": 8.33, "min": 10.87, "cnt": 32}, "MoE_L1_bwd":{"total": 285.68, "avg": 8.93, "max": 8.53, "min": 9.42, "cnt": 32}, "MoE_L0_bwd":{"total": 269.16, "avg": 8.41, "max": 7.88, "min": 9.59, "cnt": 32}, "backward-send-forward-recv":{"total": 113.99, "avg": 3.93, "max": 1.08, "min": 27.73, "cnt": 29}, "backward-send":{"total": 2.74, "avg": 0.91, "max": 0.90, "min": 0.93, "cnt": 3}, "backward-recv":{"total": 159.10, "avg": 79.55, "max": 77.94, "min": 81.16, "cnt": 2}, "backward-params-all-reduce":{"total": 484.20, "avg": 484.20, "max": 484.20, "min": 484.20, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 233.26, "avg": 233.26, "max": 233.26, "min": 233.26, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 191.51, "avg": 191.51, "max": 191.51, "min": 191.51, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.48, "avg": 3.48, "max": 3.48, "min": 3.48, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
