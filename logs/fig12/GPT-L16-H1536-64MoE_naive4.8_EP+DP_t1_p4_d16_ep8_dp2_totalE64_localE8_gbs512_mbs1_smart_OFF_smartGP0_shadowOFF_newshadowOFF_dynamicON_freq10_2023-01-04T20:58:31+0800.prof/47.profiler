{"type":"time", "iteration": -1, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 7571.30, "avg": 7571.30, "max": 7571.30, "min": 7571.30, "cnt": 1}, "train/valid/test-data-iterators-setup":{"total": 13495.36, "avg": 13495.36, "max": 13495.36, "min": 13495.36, "cnt": 1}}}
{"type":"time", "iteration": 1, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.89, "avg": 0.89, "max": 0.89, "min": 0.89, "cnt": 1}, "forward-recv":{"total": 5648.15, "avg": 2824.07, "max": 0.93, "min": 5647.22, "cnt": 2}, "forward-compute":{"total": 3630.07, "avg": 113.44, "max": 55.51, "min": 1581.42, "cnt": 32}, "fwd-compute":{"total": 3625.93, "avg": 113.31, "max": 55.40, "min": 1581.24, "cnt": 32}, "batch-generator":{"total": 74.55, "avg": 2.33, "max": 0.88, "min": 9.10, "cnt": 32}, "fwd-embedding":{"total": 0.66, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 3535.38, "avg": 110.48, "max": 53.57, "min": 1571.12, "cnt": 32}, "fwd-layernorm":{"total": 11.97, "avg": 0.09, "max": 0.06, "min": 0.56, "cnt": 128}, "fwd-attn":{"total": 812.23, "avg": 6.35, "max": 0.75, "min": 667.38, "cnt": 128}, "fwd-misc":{"total": 478.76, "avg": 3.74, "max": 0.12, "min": 454.95, "cnt": 128}, "fwd-MLP":{"total": 2202.33, "avg": 17.21, "max": 11.19, "min": 385.12, "cnt": 128}, "MoE_L0_fwd":{"total": 930.51, "avg": 29.08, "max": 11.90, "min": 384.85, "cnt": 32}, "MoEMLP":{"total": 2182.71, "avg": 17.05, "max": 11.08, "min": 384.69, "cnt": 128}, "MoE_L1_fwd":{"total": 442.57, "avg": 13.83, "max": 11.53, "min": 22.48, "cnt": 32}, "MoE_L2_fwd":{"total": 418.00, "avg": 13.06, "max": 11.20, "min": 19.79, "cnt": 32}, "MoE_L3_fwd":{"total": 398.57, "avg": 12.46, "max": 11.12, "min": 16.40, "cnt": 32}, "fwd-pooler":{"total": 0.40, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.73, "avg": 0.02, "max": 0.02, "min": 0.06, "cnt": 32}, "forward-send":{"total": 90.27, "avg": 90.27, "max": 90.27, "min": 90.27, "cnt": 1}, "forward-send-backward-recv":{"total": 2899.20, "avg": 93.52, "max": 1.46, "min": 2471.76, "cnt": 31}, "backward-compute":{"total": 1953.50, "avg": 61.05, "max": 46.17, "min": 429.67, "cnt": 32}, "MoE_L3_bwd":{"total": 418.42, "avg": 13.08, "max": 11.20, "min": 23.86, "cnt": 32}, "MoE_L2_bwd":{"total": 338.47, "avg": 10.58, "max": 9.81, "min": 12.41, "cnt": 32}, "MoE_L1_bwd":{"total": 303.18, "avg": 9.47, "max": 8.84, "min": 12.17, "cnt": 32}, "MoE_L0_bwd":{"total": 298.31, "avg": 9.32, "max": 8.74, "min": 12.62, "cnt": 32}, "backward-send-forward-recv":{"total": 9185.60, "avg": 306.19, "max": 1.45, "min": 989.33, "cnt": 30}, "backward-send":{"total": 1.94, "avg": 0.97, "max": 0.90, "min": 1.04, "cnt": 2}, "backward-recv":{"total": 87.14, "avg": 87.14, "max": 87.14, "min": 87.14, "cnt": 1}, "backward-params-all-reduce":{"total": 799.90, "avg": 799.90, "max": 799.90, "min": 799.90, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.04, "avg": 0.04, "max": 0.04, "min": 0.04, "cnt": 1}, "optimizer":{"total": 602.65, "avg": 602.65, "max": 602.65, "min": 602.65, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 378.04, "avg": 378.04, "max": 378.04, "min": 378.04, "cnt": 1}, "optimizer-clip-main-grad":{"total": 7.48, "avg": 7.48, "max": 7.48, "min": 7.48, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.80, "avg": 3.80, "max": 3.80, "min": 3.80, "cnt": 1}}}
{"type":"time", "iteration": 2, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.11, "avg": 0.11, "max": 0.11, "min": 0.11, "cnt": 1}, "forward-recv":{"total": 142.00, "avg": 71.00, "max": 9.15, "min": 132.85, "cnt": 2}, "forward-compute":{"total": 2079.59, "avg": 64.99, "max": 59.07, "min": 78.99, "cnt": 32}, "fwd-compute":{"total": 2075.78, "avg": 64.87, "max": 58.97, "min": 78.89, "cnt": 32}, "batch-generator":{"total": 58.82, "avg": 1.84, "max": 0.85, "min": 3.87, "cnt": 32}, "fwd-embedding":{"total": 0.74, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 2001.53, "avg": 62.55, "max": 56.50, "min": 76.89, "cnt": 32}, "fwd-layernorm":{"total": 11.93, "avg": 0.09, "max": 0.06, "min": 0.27, "cnt": 128}, "fwd-attn":{"total": 117.82, "avg": 0.92, "max": 0.75, "min": 1.91, "cnt": 128}, "fwd-misc":{"total": 24.97, "avg": 0.20, "max": 0.12, "min": 0.47, "cnt": 128}, "fwd-MLP":{"total": 1821.18, "avg": 14.23, "max": 10.53, "min": 33.85, "cnt": 128}, "MoE_L0_fwd":{"total": 612.54, "avg": 19.14, "max": 14.14, "min": 33.76, "cnt": 32}, "MoEMLP":{"total": 1801.93, "avg": 14.08, "max": 10.39, "min": 33.71, "cnt": 128}, "MoE_L1_fwd":{"total": 373.58, "avg": 11.67, "max": 10.44, "min": 13.64, "cnt": 32}, "MoE_L2_fwd":{"total": 409.62, "avg": 12.80, "max": 11.73, "min": 14.40, "cnt": 32}, "MoE_L3_fwd":{"total": 413.13, "avg": 12.91, "max": 12.12, "min": 18.16, "cnt": 32}, "fwd-pooler":{"total": 0.38, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.62, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 0.97, "avg": 0.97, "max": 0.97, "min": 0.97, "cnt": 1}, "forward-send-backward-recv":{"total": 326.89, "avg": 10.54, "max": 1.77, "min": 62.65, "cnt": 31}, "backward-compute":{"total": 1786.46, "avg": 55.83, "max": 52.67, "min": 58.83, "cnt": 32}, "MoE_L3_bwd":{"total": 430.01, "avg": 13.44, "max": 12.14, "min": 15.07, "cnt": 32}, "MoE_L2_bwd":{"total": 402.80, "avg": 12.59, "max": 11.73, "min": 13.74, "cnt": 32}, "MoE_L1_bwd":{"total": 332.80, "avg": 10.40, "max": 9.52, "min": 11.22, "cnt": 32}, "MoE_L0_bwd":{"total": 401.94, "avg": 12.56, "max": 11.51, "min": 13.72, "cnt": 32}, "backward-send-forward-recv":{"total": 9654.43, "avg": 321.81, "max": 1.29, "min": 1681.51, "cnt": 30}, "backward-send":{"total": 2.16, "avg": 1.08, "max": 1.03, "min": 1.14, "cnt": 2}, "backward-recv":{"total": 72.96, "avg": 72.96, "max": 72.96, "min": 72.96, "cnt": 1}, "backward-params-all-reduce":{"total": 495.70, "avg": 495.70, "max": 495.70, "min": 495.70, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 293.37, "avg": 293.37, "max": 293.37, "min": 293.37, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.40, "avg": 3.40, "max": 3.40, "min": 3.40, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 248.28, "avg": 248.28, "max": 248.28, "min": 248.28, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.83, "avg": 6.83, "max": 6.83, "min": 6.83, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.51, "avg": 3.51, "max": 3.51, "min": 3.51, "cnt": 1}}}
{"type":"time", "iteration": 3, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 150.71, "avg": 75.35, "max": 8.18, "min": 142.52, "cnt": 2}, "forward-compute":{"total": 2231.21, "avg": 69.73, "max": 54.11, "min": 185.79, "cnt": 32}, "fwd-compute":{"total": 2227.66, "avg": 69.61, "max": 54.02, "min": 185.70, "cnt": 32}, "batch-generator":{"total": 54.37, "avg": 1.70, "max": 0.78, "min": 4.26, "cnt": 32}, "fwd-embedding":{"total": 0.65, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 2159.32, "avg": 67.48, "max": 52.89, "min": 183.95, "cnt": 32}, "fwd-layernorm":{"total": 11.50, "avg": 0.09, "max": 0.06, "min": 0.23, "cnt": 128}, "fwd-attn":{"total": 114.28, "avg": 0.89, "max": 0.75, "min": 1.81, "cnt": 128}, "fwd-misc":{"total": 23.93, "avg": 0.19, "max": 0.12, "min": 0.43, "cnt": 128}, "fwd-MLP":{"total": 1984.40, "avg": 15.50, "max": 11.16, "min": 137.07, "cnt": 128}, "MoE_L0_fwd":{"total": 741.78, "avg": 23.18, "max": 11.29, "min": 136.96, "cnt": 32}, "MoEMLP":{"total": 1964.94, "avg": 15.35, "max": 11.03, "min": 136.91, "cnt": 128}, "MoE_L1_fwd":{"total": 405.70, "avg": 12.68, "max": 11.08, "min": 16.46, "cnt": 32}, "MoE_L2_fwd":{"total": 411.17, "avg": 12.85, "max": 11.69, "min": 16.38, "cnt": 32}, "MoE_L3_fwd":{"total": 413.17, "avg": 12.91, "max": 12.19, "min": 15.47, "cnt": 32}, "fwd-pooler":{"total": 0.36, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.61, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 0.98, "avg": 0.98, "max": 0.98, "min": 0.98, "cnt": 1}, "forward-send-backward-recv":{"total": 623.67, "avg": 20.12, "max": 0.91, "min": 135.78, "cnt": 31}, "backward-compute":{"total": 1759.55, "avg": 54.99, "max": 50.45, "min": 60.70, "cnt": 32}, "MoE_L3_bwd":{"total": 437.23, "avg": 13.66, "max": 12.31, "min": 15.82, "cnt": 32}, "MoE_L2_bwd":{"total": 418.35, "avg": 13.07, "max": 11.88, "min": 16.72, "cnt": 32}, "MoE_L1_bwd":{"total": 360.58, "avg": 11.27, "max": 10.44, "min": 13.87, "cnt": 32}, "MoE_L0_bwd":{"total": 328.55, "avg": 10.27, "max": 9.74, "min": 10.94, "cnt": 32}, "backward-send-forward-recv":{"total": 9143.00, "avg": 304.77, "max": 2.27, "min": 1125.85, "cnt": 30}, "backward-send":{"total": 1.99, "avg": 1.00, "max": 0.89, "min": 1.10, "cnt": 2}, "backward-recv":{"total": 80.72, "avg": 80.72, "max": 80.72, "min": 80.72, "cnt": 1}, "backward-params-all-reduce":{"total": 493.42, "avg": 493.42, "max": 493.42, "min": 493.42, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 304.49, "avg": 304.49, "max": 304.49, "min": 304.49, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.40, "avg": 3.40, "max": 3.40, "min": 3.40, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 259.49, "avg": 259.49, "max": 259.49, "min": 259.49, "cnt": 1}, "optimizer-clip-main-grad":{"total": 7.57, "avg": 7.57, "max": 7.57, "min": 7.57, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.47, "avg": 3.47, "max": 3.47, "min": 3.47, "cnt": 1}}}
{"type":"time", "iteration": 4, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 144.55, "avg": 72.27, "max": 4.53, "min": 140.02, "cnt": 2}, "forward-compute":{"total": 2123.94, "avg": 66.37, "max": 58.11, "min": 75.22, "cnt": 32}, "fwd-compute":{"total": 2120.24, "avg": 66.26, "max": 58.02, "min": 75.12, "cnt": 32}, "batch-generator":{"total": 62.59, "avg": 1.96, "max": 0.76, "min": 4.90, "cnt": 32}, "fwd-embedding":{"total": 0.77, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 2042.21, "avg": 63.82, "max": 56.63, "min": 73.83, "cnt": 32}, "fwd-layernorm":{"total": 12.36, "avg": 0.10, "max": 0.06, "min": 0.24, "cnt": 128}, "fwd-attn":{"total": 119.29, "avg": 0.93, "max": 0.75, "min": 1.78, "cnt": 128}, "fwd-misc":{"total": 25.22, "avg": 0.20, "max": 0.12, "min": 0.45, "cnt": 128}, "fwd-MLP":{"total": 1858.74, "avg": 14.52, "max": 11.83, "min": 27.88, "cnt": 128}, "MoE_L0_fwd":{"total": 569.79, "avg": 17.81, "max": 12.27, "min": 27.77, "cnt": 32}, "MoEMLP":{"total": 1838.66, "avg": 14.36, "max": 11.71, "min": 27.72, "cnt": 128}, "MoE_L1_fwd":{"total": 424.99, "avg": 13.28, "max": 11.90, "min": 15.25, "cnt": 32}, "MoE_L2_fwd":{"total": 396.59, "avg": 12.39, "max": 11.75, "min": 15.01, "cnt": 32}, "MoE_L3_fwd":{"total": 454.58, "avg": 14.21, "max": 13.61, "min": 16.06, "cnt": 32}, "fwd-pooler":{"total": 0.39, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.64, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 0.99, "avg": 0.99, "max": 0.99, "min": 0.99, "cnt": 1}, "forward-send-backward-recv":{"total": 325.81, "avg": 10.51, "max": 1.49, "min": 94.53, "cnt": 31}, "backward-compute":{"total": 1880.56, "avg": 58.77, "max": 56.52, "min": 61.80, "cnt": 32}, "MoE_L3_bwd":{"total": 517.92, "avg": 16.18, "max": 15.29, "min": 19.64, "cnt": 32}, "MoE_L2_bwd":{"total": 392.17, "avg": 12.26, "max": 11.83, "min": 13.01, "cnt": 32}, "MoE_L1_bwd":{"total": 390.86, "avg": 12.21, "max": 11.69, "min": 12.59, "cnt": 32}, "MoE_L0_bwd":{"total": 366.05, "avg": 11.44, "max": 10.76, "min": 12.49, "cnt": 32}, "backward-send-forward-recv":{"total": 8032.22, "avg": 267.74, "max": 1.97, "min": 1122.81, "cnt": 30}, "backward-send":{"total": 2.13, "avg": 1.06, "max": 1.06, "min": 1.07, "cnt": 2}, "backward-recv":{"total": 66.86, "avg": 66.86, "max": 66.86, "min": 66.86, "cnt": 1}, "backward-params-all-reduce":{"total": 494.16, "avg": 494.16, "max": 494.16, "min": 494.16, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 293.71, "avg": 293.71, "max": 293.71, "min": 293.71, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 248.96, "avg": 248.96, "max": 248.96, "min": 248.96, "cnt": 1}, "optimizer-clip-main-grad":{"total": 7.22, "avg": 7.22, "max": 7.22, "min": 7.22, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.53, "avg": 3.53, "max": 3.53, "min": 3.53, "cnt": 1}}}
{"type":"time", "iteration": 5, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 135.14, "avg": 67.57, "max": 1.08, "min": 134.05, "cnt": 2}, "forward-compute":{"total": 2058.01, "avg": 64.31, "max": 57.07, "min": 73.66, "cnt": 32}, "fwd-compute":{"total": 2054.35, "avg": 64.20, "max": 56.98, "min": 73.57, "cnt": 32}, "batch-generator":{"total": 54.49, "avg": 1.70, "max": 0.74, "min": 4.06, "cnt": 32}, "fwd-embedding":{"total": 0.70, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1984.84, "avg": 62.03, "max": 55.80, "min": 71.89, "cnt": 32}, "fwd-layernorm":{"total": 11.42, "avg": 0.09, "max": 0.06, "min": 0.24, "cnt": 128}, "fwd-attn":{"total": 113.77, "avg": 0.89, "max": 0.75, "min": 1.81, "cnt": 128}, "fwd-misc":{"total": 24.44, "avg": 0.19, "max": 0.12, "min": 0.59, "cnt": 128}, "fwd-MLP":{"total": 1810.03, "avg": 14.14, "max": 11.45, "min": 22.45, "cnt": 128}, "MoE_L0_fwd":{"total": 530.87, "avg": 16.59, "max": 12.72, "min": 22.29, "cnt": 32}, "MoEMLP":{"total": 1790.33, "avg": 13.99, "max": 11.33, "min": 22.12, "cnt": 128}, "MoE_L1_fwd":{"total": 403.78, "avg": 12.62, "max": 11.37, "min": 15.04, "cnt": 32}, "MoE_L2_fwd":{"total": 410.06, "avg": 12.81, "max": 12.05, "min": 17.52, "cnt": 32}, "MoE_L3_fwd":{"total": 452.86, "avg": 14.15, "max": 13.53, "min": 15.59, "cnt": 32}, "fwd-pooler":{"total": 0.39, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.69, "avg": 0.02, "max": 0.02, "min": 0.04, "cnt": 32}, "forward-send":{"total": 1.18, "avg": 1.18, "max": 1.18, "min": 1.18, "cnt": 1}, "forward-send-backward-recv":{"total": 781.62, "avg": 25.21, "max": 1.32, "min": 241.38, "cnt": 31}, "backward-compute":{"total": 1910.51, "avg": 59.70, "max": 55.85, "min": 64.42, "cnt": 32}, "MoE_L3_bwd":{"total": 521.55, "avg": 16.30, "max": 15.16, "min": 19.58, "cnt": 32}, "MoE_L2_bwd":{"total": 402.91, "avg": 12.59, "max": 12.01, "min": 13.63, "cnt": 32}, "MoE_L1_bwd":{"total": 367.69, "avg": 11.49, "max": 10.77, "min": 11.84, "cnt": 32}, "MoE_L0_bwd":{"total": 400.28, "avg": 12.51, "max": 11.72, "min": 12.96, "cnt": 32}, "backward-send-forward-recv":{"total": 8234.25, "avg": 274.48, "max": 1.31, "min": 1549.13, "cnt": 30}, "backward-send":{"total": 2.00, "avg": 1.00, "max": 0.96, "min": 1.04, "cnt": 2}, "backward-recv":{"total": 65.69, "avg": 65.69, "max": 65.69, "min": 65.69, "cnt": 1}, "backward-params-all-reduce":{"total": 492.67, "avg": 492.67, "max": 492.67, "min": 492.67, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 298.40, "avg": 298.40, "max": 298.40, "min": 298.40, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.40, "avg": 3.40, "max": 3.40, "min": 3.40, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 254.10, "avg": 254.10, "max": 254.10, "min": 254.10, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.90, "avg": 6.90, "max": 6.90, "min": 6.90, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 6, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.10, "avg": 0.10, "max": 0.10, "min": 0.10, "cnt": 1}, "forward-recv":{"total": 132.67, "avg": 66.34, "max": 1.11, "min": 131.56, "cnt": 2}, "forward-compute":{"total": 1977.97, "avg": 61.81, "max": 57.14, "min": 66.42, "cnt": 32}, "fwd-compute":{"total": 1974.50, "avg": 61.70, "max": 57.06, "min": 66.33, "cnt": 32}, "batch-generator":{"total": 52.46, "avg": 1.64, "max": 0.79, "min": 3.72, "cnt": 32}, "fwd-embedding":{"total": 0.62, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1908.31, "avg": 59.63, "max": 55.05, "min": 64.45, "cnt": 32}, "fwd-layernorm":{"total": 10.76, "avg": 0.08, "max": 0.06, "min": 0.22, "cnt": 128}, "fwd-attn":{"total": 107.69, "avg": 0.84, "max": 0.75, "min": 1.56, "cnt": 128}, "fwd-misc":{"total": 22.26, "avg": 0.17, "max": 0.11, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1743.89, "avg": 13.62, "max": 11.43, "min": 21.49, "cnt": 128}, "MoE_L0_fwd":{"total": 523.67, "avg": 16.36, "max": 13.42, "min": 21.40, "cnt": 32}, "MoEMLP":{"total": 1725.78, "avg": 13.48, "max": 11.30, "min": 21.35, "cnt": 128}, "MoE_L1_fwd":{"total": 393.77, "avg": 12.31, "max": 11.35, "min": 13.45, "cnt": 32}, "MoE_L2_fwd":{"total": 425.32, "avg": 13.29, "max": 12.92, "min": 13.98, "cnt": 32}, "MoE_L3_fwd":{"total": 389.62, "avg": 12.18, "max": 11.57, "min": 13.90, "cnt": 32}, "fwd-pooler":{"total": 0.39, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.64, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 0.89, "avg": 0.89, "max": 0.89, "min": 0.89, "cnt": 1}, "forward-send-backward-recv":{"total": 1965.30, "avg": 63.40, "max": 1.04, "min": 357.67, "cnt": 31}, "backward-compute":{"total": 1898.16, "avg": 59.32, "max": 54.96, "min": 63.73, "cnt": 32}, "MoE_L3_bwd":{"total": 425.96, "avg": 13.31, "max": 12.12, "min": 16.02, "cnt": 32}, "MoE_L2_bwd":{"total": 457.97, "avg": 14.31, "max": 13.30, "min": 15.46, "cnt": 32}, "MoE_L1_bwd":{"total": 369.33, "avg": 11.54, "max": 10.87, "min": 12.10, "cnt": 32}, "MoE_L0_bwd":{"total": 422.50, "avg": 13.20, "max": 12.45, "min": 14.40, "cnt": 32}, "backward-send-forward-recv":{"total": 5676.26, "avg": 189.21, "max": 1.02, "min": 820.29, "cnt": 30}, "backward-send":{"total": 1.53, "avg": 0.76, "max": 0.76, "min": 0.77, "cnt": 2}, "backward-recv":{"total": 304.87, "avg": 304.87, "max": 304.87, "min": 304.87, "cnt": 1}, "backward-params-all-reduce":{"total": 494.16, "avg": 494.16, "max": 494.16, "min": 494.16, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 313.77, "avg": 313.77, "max": 313.77, "min": 313.77, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 269.40, "avg": 269.40, "max": 269.40, "min": 269.40, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.95, "avg": 6.95, "max": 6.95, "min": 6.95, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.52, "avg": 3.52, "max": 3.52, "min": 3.52, "cnt": 1}}}
{"type":"time", "iteration": 7, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 1120.26, "avg": 560.13, "max": 1.28, "min": 1118.98, "cnt": 2}, "forward-compute":{"total": 1968.16, "avg": 61.50, "max": 54.95, "min": 73.07, "cnt": 32}, "fwd-compute":{"total": 1965.20, "avg": 61.41, "max": 54.87, "min": 72.99, "cnt": 32}, "batch-generator":{"total": 38.59, "avg": 1.21, "max": 0.77, "min": 3.05, "cnt": 32}, "fwd-embedding":{"total": 0.46, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1914.20, "avg": 59.82, "max": 53.59, "min": 71.05, "cnt": 32}, "fwd-layernorm":{"total": 9.52, "avg": 0.07, "max": 0.06, "min": 0.29, "cnt": 128}, "fwd-attn":{"total": 104.43, "avg": 0.82, "max": 0.75, "min": 2.29, "cnt": 128}, "fwd-misc":{"total": 21.04, "avg": 0.16, "max": 0.12, "min": 0.47, "cnt": 128}, "fwd-MLP":{"total": 1756.40, "avg": 13.72, "max": 10.66, "min": 27.33, "cnt": 128}, "MoE_L0_fwd":{"total": 454.39, "avg": 14.20, "max": 10.58, "min": 27.25, "cnt": 32}, "MoEMLP":{"total": 1739.15, "avg": 13.59, "max": 10.53, "min": 27.20, "cnt": 128}, "MoE_L1_fwd":{"total": 431.19, "avg": 13.47, "max": 12.12, "min": 16.28, "cnt": 32}, "MoE_L2_fwd":{"total": 460.34, "avg": 14.39, "max": 13.24, "min": 16.45, "cnt": 32}, "MoE_L3_fwd":{"total": 399.49, "avg": 12.48, "max": 11.48, "min": 15.03, "cnt": 32}, "fwd-pooler":{"total": 0.37, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.62, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 0.95, "avg": 0.95, "max": 0.95, "min": 0.95, "cnt": 1}, "forward-send-backward-recv":{"total": 137.71, "avg": 4.44, "max": 1.45, "min": 75.90, "cnt": 31}, "backward-compute":{"total": 1879.61, "avg": 58.74, "max": 55.10, "min": 61.64, "cnt": 32}, "MoE_L3_bwd":{"total": 432.65, "avg": 13.52, "max": 12.58, "min": 15.38, "cnt": 32}, "MoE_L2_bwd":{"total": 503.13, "avg": 15.72, "max": 14.68, "min": 19.17, "cnt": 32}, "MoE_L1_bwd":{"total": 384.58, "avg": 12.02, "max": 11.38, "min": 12.84, "cnt": 32}, "MoE_L0_bwd":{"total": 337.11, "avg": 10.53, "max": 9.78, "min": 10.99, "cnt": 32}, "backward-send-forward-recv":{"total": 7031.69, "avg": 234.39, "max": 2.53, "min": 657.56, "cnt": 30}, "backward-send":{"total": 2.25, "avg": 1.12, "max": 0.99, "min": 1.25, "cnt": 2}, "backward-recv":{"total": 64.61, "avg": 64.61, "max": 64.61, "min": 64.61, "cnt": 1}, "backward-params-all-reduce":{"total": 505.75, "avg": 505.75, "max": 505.75, "min": 505.75, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 307.76, "avg": 307.76, "max": 307.76, "min": 307.76, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 263.69, "avg": 263.69, "max": 263.69, "min": 263.69, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.82, "avg": 6.82, "max": 6.82, "min": 6.82, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 8, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.10, "avg": 0.10, "max": 0.10, "min": 0.10, "cnt": 1}, "forward-recv":{"total": 146.14, "avg": 73.07, "max": 1.21, "min": 144.92, "cnt": 2}, "forward-compute":{"total": 2061.95, "avg": 64.44, "max": 56.28, "min": 74.68, "cnt": 32}, "fwd-compute":{"total": 2058.22, "avg": 64.32, "max": 56.20, "min": 74.58, "cnt": 32}, "batch-generator":{"total": 51.64, "avg": 1.61, "max": 0.74, "min": 3.23, "cnt": 32}, "fwd-embedding":{"total": 0.67, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1992.03, "avg": 62.25, "max": 55.11, "min": 71.25, "cnt": 32}, "fwd-layernorm":{"total": 11.37, "avg": 0.09, "max": 0.06, "min": 0.29, "cnt": 128}, "fwd-attn":{"total": 115.67, "avg": 0.90, "max": 0.74, "min": 2.30, "cnt": 128}, "fwd-misc":{"total": 24.05, "avg": 0.19, "max": 0.12, "min": 0.44, "cnt": 128}, "fwd-MLP":{"total": 1815.90, "avg": 14.19, "max": 11.17, "min": 24.69, "cnt": 128}, "MoE_L0_fwd":{"total": 527.78, "avg": 16.49, "max": 12.13, "min": 24.54, "cnt": 32}, "MoEMLP":{"total": 1796.61, "avg": 14.04, "max": 11.05, "min": 24.45, "cnt": 128}, "MoE_L1_fwd":{"total": 404.15, "avg": 12.63, "max": 11.10, "min": 14.77, "cnt": 32}, "MoE_L2_fwd":{"total": 491.02, "avg": 15.34, "max": 14.69, "min": 17.94, "cnt": 32}, "MoE_L3_fwd":{"total": 380.55, "avg": 11.89, "max": 11.14, "min": 17.61, "cnt": 32}, "fwd-pooler":{"total": 0.38, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.63, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.05, "avg": 1.05, "max": 1.05, "min": 1.05, "cnt": 1}, "forward-send-backward-recv":{"total": 1432.39, "avg": 46.21, "max": 1.61, "min": 267.71, "cnt": 31}, "backward-compute":{"total": 1962.93, "avg": 61.34, "max": 58.59, "min": 67.43, "cnt": 32}, "MoE_L3_bwd":{"total": 415.35, "avg": 12.98, "max": 11.78, "min": 17.21, "cnt": 32}, "MoE_L2_bwd":{"total": 581.79, "avg": 18.18, "max": 17.25, "min": 19.23, "cnt": 32}, "MoE_L1_bwd":{"total": 374.56, "avg": 11.71, "max": 10.91, "min": 12.94, "cnt": 32}, "MoE_L0_bwd":{"total": 373.10, "avg": 11.66, "max": 10.91, "min": 12.24, "cnt": 32}, "backward-send-forward-recv":{"total": 5670.63, "avg": 189.02, "max": 1.25, "min": 568.19, "cnt": 30}, "backward-send":{"total": 1.95, "avg": 0.97, "max": 0.94, "min": 1.01, "cnt": 2}, "backward-recv":{"total": 57.45, "avg": 57.45, "max": 57.45, "min": 57.45, "cnt": 1}, "backward-params-all-reduce":{"total": 492.16, "avg": 492.16, "max": 492.16, "min": 492.16, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 311.44, "avg": 311.44, "max": 311.44, "min": 311.44, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 267.14, "avg": 267.14, "max": 267.14, "min": 267.14, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.91, "avg": 6.91, "max": 6.91, "min": 6.91, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.50, "avg": 3.50, "max": 3.50, "min": 3.50, "cnt": 1}}}
{"type":"time", "iteration": 9, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.11, "avg": 0.11, "max": 0.11, "min": 0.11, "cnt": 1}, "forward-recv":{"total": 136.97, "avg": 68.48, "max": 1.05, "min": 135.92, "cnt": 2}, "forward-compute":{"total": 1992.11, "avg": 62.25, "max": 55.73, "min": 77.51, "cnt": 32}, "fwd-compute":{"total": 1988.22, "avg": 62.13, "max": 55.63, "min": 77.41, "cnt": 32}, "batch-generator":{"total": 49.34, "avg": 1.54, "max": 0.77, "min": 3.21, "cnt": 32}, "fwd-embedding":{"total": 0.66, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1924.34, "avg": 60.14, "max": 54.24, "min": 73.82, "cnt": 32}, "fwd-layernorm":{"total": 11.24, "avg": 0.09, "max": 0.06, "min": 0.25, "cnt": 128}, "fwd-attn":{"total": 112.80, "avg": 0.88, "max": 0.76, "min": 1.95, "cnt": 128}, "fwd-misc":{"total": 23.35, "avg": 0.18, "max": 0.12, "min": 0.43, "cnt": 128}, "fwd-MLP":{"total": 1752.31, "avg": 13.69, "max": 11.60, "min": 24.98, "cnt": 128}, "MoE_L0_fwd":{"total": 520.03, "avg": 16.25, "max": 12.94, "min": 24.89, "cnt": 32}, "MoEMLP":{"total": 1733.15, "avg": 13.54, "max": 11.46, "min": 24.83, "cnt": 128}, "MoE_L1_fwd":{"total": 414.66, "avg": 12.96, "max": 12.07, "min": 15.83, "cnt": 32}, "MoE_L2_fwd":{"total": 404.66, "avg": 12.65, "max": 11.52, "min": 16.17, "cnt": 32}, "MoE_L3_fwd":{"total": 400.71, "avg": 12.52, "max": 11.74, "min": 19.05, "cnt": 32}, "fwd-pooler":{"total": 0.38, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.70, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.13, "avg": 1.13, "max": 1.13, "min": 1.13, "cnt": 1}, "forward-send-backward-recv":{"total": 2351.89, "avg": 75.87, "max": 1.73, "min": 522.36, "cnt": 31}, "backward-compute":{"total": 1740.94, "avg": 54.40, "max": 51.72, "min": 57.02, "cnt": 32}, "MoE_L3_bwd":{"total": 411.81, "avg": 12.87, "max": 11.50, "min": 15.53, "cnt": 32}, "MoE_L2_bwd":{"total": 371.42, "avg": 11.61, "max": 10.49, "min": 13.02, "cnt": 32}, "MoE_L1_bwd":{"total": 362.45, "avg": 11.33, "max": 10.90, "min": 12.50, "cnt": 32}, "MoE_L0_bwd":{"total": 374.05, "avg": 11.69, "max": 11.12, "min": 12.44, "cnt": 32}, "backward-send-forward-recv":{"total": 3722.57, "avg": 124.09, "max": 1.41, "min": 552.69, "cnt": 30}, "backward-send":{"total": 2.21, "avg": 1.11, "max": 1.04, "min": 1.17, "cnt": 2}, "backward-recv":{"total": 114.98, "avg": 114.98, "max": 114.98, "min": 114.98, "cnt": 1}, "backward-params-all-reduce":{"total": 489.01, "avg": 489.01, "max": 489.01, "min": 489.01, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 265.79, "avg": 265.79, "max": 265.79, "min": 265.79, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 255.32, "avg": 255.32, "max": 255.32, "min": 255.32, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.99, "avg": 6.99, "max": 6.99, "min": 6.99, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}}}
{"type":"time", "iteration": 10, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.16, "avg": 0.16, "max": 0.16, "min": 0.16, "cnt": 1}, "forward-recv":{"total": 1966.03, "avg": 983.02, "max": 0.98, "min": 1965.05, "cnt": 2}, "forward-compute":{"total": 3489.90, "avg": 109.06, "max": 51.38, "min": 1695.19, "cnt": 32}, "fwd-compute":{"total": 3486.29, "avg": 108.95, "max": 51.29, "min": 1695.04, "cnt": 32}, "batch-generator":{"total": 52.58, "avg": 1.64, "max": 0.86, "min": 2.80, "cnt": 32}, "fwd-embedding":{"total": 0.68, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 3418.46, "avg": 106.83, "max": 49.87, "min": 1693.51, "cnt": 32}, "fwd-layernorm":{"total": 11.21, "avg": 0.09, "max": 0.06, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 113.56, "avg": 0.89, "max": 0.75, "min": 1.80, "cnt": 128}, "fwd-misc":{"total": 23.57, "avg": 0.18, "max": 0.12, "min": 0.41, "cnt": 128}, "fwd-MLP":{"total": 3244.90, "avg": 25.35, "max": 10.32, "min": 1256.95, "cnt": 128}, "MoE_L0_fwd":{"total": 1699.09, "avg": 53.10, "max": 10.87, "min": 1256.85, "cnt": 32}, "MoEMLP":{"total": 3225.68, "avg": 25.20, "max": 10.20, "min": 1256.79, "cnt": 128}, "MoE_L1_fwd":{"total": 598.94, "avg": 18.72, "max": 10.28, "min": 238.58, "cnt": 32}, "MoE_L2_fwd":{"total": 527.82, "avg": 16.49, "max": 10.25, "min": 179.35, "cnt": 32}, "MoE_L3_fwd":{"total": 406.97, "avg": 12.72, "max": 11.39, "min": 16.41, "cnt": 32}, "fwd-pooler":{"total": 0.41, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.70, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 0.91, "avg": 0.91, "max": 0.91, "min": 0.91, "cnt": 1}, "forward-send-backward-recv":{"total": 894.75, "avg": 28.86, "max": 1.41, "min": 148.72, "cnt": 31}, "backward-compute":{"total": 1511.63, "avg": 47.24, "max": 44.89, "min": 50.26, "cnt": 32}, "MoE_L3_bwd":{"total": 407.35, "avg": 12.73, "max": 11.63, "min": 15.63, "cnt": 32}, "MoE_L2_bwd":{"total": 314.52, "avg": 9.83, "max": 8.83, "min": 12.98, "cnt": 32}, "MoE_L1_bwd":{"total": 287.39, "avg": 8.98, "max": 8.46, "min": 10.46, "cnt": 32}, "MoE_L0_bwd":{"total": 285.50, "avg": 8.92, "max": 8.44, "min": 9.98, "cnt": 32}, "backward-send-forward-recv":{"total": 4580.90, "avg": 152.70, "max": 1.38, "min": 534.69, "cnt": 30}, "backward-send":{"total": 2.45, "avg": 1.22, "max": 1.17, "min": 1.27, "cnt": 2}, "backward-recv":{"total": 83.21, "avg": 83.21, "max": 83.21, "min": 83.21, "cnt": 1}, "backward-params-all-reduce":{"total": 495.49, "avg": 495.49, "max": 495.49, "min": 495.49, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "optimizer":{"total": 277.00, "avg": 277.00, "max": 277.00, "min": 277.00, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 245.83, "avg": 245.83, "max": 245.83, "min": 245.83, "cnt": 1}, "optimizer-clip-main-grad":{"total": 7.52, "avg": 7.52, "max": 7.52, "min": 7.52, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}}}
{"type":"time", "iteration": 11, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 131.46, "avg": 65.73, "max": 5.04, "min": 126.42, "cnt": 2}, "forward-compute":{"total": 1881.20, "avg": 58.79, "max": 52.99, "min": 65.30, "cnt": 32}, "fwd-compute":{"total": 1877.27, "avg": 58.66, "max": 52.91, "min": 65.22, "cnt": 32}, "batch-generator":{"total": 70.47, "avg": 2.20, "max": 0.80, "min": 4.77, "cnt": 32}, "fwd-embedding":{"total": 0.74, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1791.23, "avg": 55.98, "max": 49.97, "min": 60.43, "cnt": 32}, "fwd-layernorm":{"total": 12.47, "avg": 0.10, "max": 0.06, "min": 0.65, "cnt": 128}, "fwd-attn":{"total": 118.27, "avg": 0.92, "max": 0.75, "min": 1.91, "cnt": 128}, "fwd-misc":{"total": 25.81, "avg": 0.20, "max": 0.13, "min": 0.55, "cnt": 128}, "fwd-MLP":{"total": 1608.87, "avg": 12.57, "max": 10.46, "min": 17.97, "cnt": 128}, "MoE_L0_fwd":{"total": 457.95, "avg": 14.31, "max": 11.53, "min": 17.78, "cnt": 32}, "MoEMLP":{"total": 1588.99, "avg": 12.41, "max": 10.33, "min": 17.67, "cnt": 128}, "MoE_L1_fwd":{"total": 381.63, "avg": 11.93, "max": 10.43, "min": 15.00, "cnt": 32}, "MoE_L2_fwd":{"total": 354.42, "avg": 11.08, "max": 10.38, "min": 12.73, "cnt": 32}, "MoE_L3_fwd":{"total": 402.36, "avg": 12.57, "max": 11.35, "min": 15.45, "cnt": 32}, "fwd-pooler":{"total": 0.41, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.70, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 0.84, "avg": 0.84, "max": 0.84, "min": 0.84, "cnt": 1}, "forward-send-backward-recv":{"total": 2974.73, "avg": 95.96, "max": 1.69, "min": 650.16, "cnt": 31}, "backward-compute":{"total": 1515.41, "avg": 47.36, "max": 44.75, "min": 49.70, "cnt": 32}, "MoE_L3_bwd":{"total": 413.61, "avg": 12.93, "max": 12.16, "min": 15.97, "cnt": 32}, "MoE_L2_bwd":{"total": 306.47, "avg": 9.58, "max": 8.43, "min": 10.95, "cnt": 32}, "MoE_L1_bwd":{"total": 284.65, "avg": 8.90, "max": 8.39, "min": 9.54, "cnt": 32}, "MoE_L0_bwd":{"total": 286.83, "avg": 8.96, "max": 8.22, "min": 10.80, "cnt": 32}, "backward-send-forward-recv":{"total": 4081.31, "avg": 136.04, "max": 2.22, "min": 461.17, "cnt": 30}, "backward-send":{"total": 2.07, "avg": 1.04, "max": 0.97, "min": 1.10, "cnt": 2}, "backward-recv":{"total": 79.75, "avg": 79.75, "max": 79.75, "min": 79.75, "cnt": 1}, "backward-params-all-reduce":{"total": 490.75, "avg": 490.75, "max": 490.75, "min": 490.75, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 258.92, "avg": 258.92, "max": 258.92, "min": 258.92, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.40, "avg": 3.40, "max": 3.40, "min": 3.40, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 248.53, "avg": 248.53, "max": 248.53, "min": 248.53, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.80, "avg": 6.80, "max": 6.80, "min": 6.80, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}}}
{"type":"time", "iteration": 12, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.13, "avg": 0.13, "max": 0.13, "min": 0.13, "cnt": 1}, "forward-recv":{"total": 142.18, "avg": 71.09, "max": 4.78, "min": 137.40, "cnt": 2}, "forward-compute":{"total": 1861.23, "avg": 58.16, "max": 50.64, "min": 67.56, "cnt": 32}, "fwd-compute":{"total": 1856.15, "avg": 58.00, "max": 50.56, "min": 67.46, "cnt": 32}, "batch-generator":{"total": 55.61, "avg": 1.74, "max": 0.75, "min": 3.23, "cnt": 32}, "fwd-embedding":{"total": 0.62, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1786.64, "avg": 55.83, "max": 49.08, "min": 65.54, "cnt": 32}, "fwd-layernorm":{"total": 10.79, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 109.99, "avg": 0.86, "max": 0.75, "min": 1.77, "cnt": 128}, "fwd-misc":{"total": 22.46, "avg": 0.18, "max": 0.12, "min": 0.43, "cnt": 128}, "fwd-MLP":{"total": 1619.25, "avg": 12.65, "max": 9.92, "min": 22.93, "cnt": 128}, "MoE_L0_fwd":{"total": 479.47, "avg": 14.98, "max": 10.91, "min": 22.78, "cnt": 32}, "MoEMLP":{"total": 1600.96, "avg": 12.51, "max": 9.79, "min": 22.70, "cnt": 128}, "MoE_L1_fwd":{"total": 380.43, "avg": 11.89, "max": 9.84, "min": 14.68, "cnt": 32}, "MoE_L2_fwd":{"total": 348.40, "avg": 10.89, "max": 10.10, "min": 11.73, "cnt": 32}, "MoE_L3_fwd":{"total": 399.39, "avg": 12.48, "max": 11.58, "min": 18.19, "cnt": 32}, "fwd-pooler":{"total": 0.38, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 2.05, "avg": 0.06, "max": 0.02, "min": 1.43, "cnt": 32}, "forward-send":{"total": 0.94, "avg": 0.94, "max": 0.94, "min": 0.94, "cnt": 1}, "forward-send-backward-recv":{"total": 1755.89, "avg": 56.64, "max": 0.95, "min": 375.44, "cnt": 31}, "backward-compute":{"total": 1515.10, "avg": 47.35, "max": 43.85, "min": 51.02, "cnt": 32}, "MoE_L3_bwd":{"total": 419.87, "avg": 13.12, "max": 12.08, "min": 17.31, "cnt": 32}, "MoE_L2_bwd":{"total": 301.06, "avg": 9.41, "max": 7.94, "min": 10.95, "cnt": 32}, "MoE_L1_bwd":{"total": 288.13, "avg": 9.00, "max": 8.38, "min": 11.73, "cnt": 32}, "MoE_L0_bwd":{"total": 281.81, "avg": 8.81, "max": 8.30, "min": 9.99, "cnt": 32}, "backward-send-forward-recv":{"total": 4721.46, "avg": 157.38, "max": 1.29, "min": 514.18, "cnt": 30}, "backward-send":{"total": 1.99, "avg": 0.99, "max": 0.82, "min": 1.17, "cnt": 2}, "backward-recv":{"total": 145.86, "avg": 145.86, "max": 145.86, "min": 145.86, "cnt": 1}, "backward-params-all-reduce":{"total": 485.89, "avg": 485.89, "max": 485.89, "min": 485.89, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "optimizer":{"total": 258.78, "avg": 258.78, "max": 258.78, "min": 258.78, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.41, "avg": 3.41, "max": 3.41, "min": 3.41, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 248.38, "avg": 248.38, "max": 248.38, "min": 248.38, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.77, "avg": 6.77, "max": 6.77, "min": 6.77, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}}}
{"type":"time", "iteration": 13, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.12, "avg": 0.12, "max": 0.12, "min": 0.12, "cnt": 1}, "forward-recv":{"total": 135.32, "avg": 67.66, "max": 1.33, "min": 133.98, "cnt": 2}, "forward-compute":{"total": 1845.26, "avg": 57.66, "max": 50.29, "min": 70.20, "cnt": 32}, "fwd-compute":{"total": 1841.72, "avg": 57.55, "max": 50.20, "min": 70.11, "cnt": 32}, "batch-generator":{"total": 46.20, "avg": 1.44, "max": 0.81, "min": 3.17, "cnt": 32}, "fwd-embedding":{"total": 0.63, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1781.45, "avg": 55.67, "max": 48.92, "min": 68.53, "cnt": 32}, "fwd-layernorm":{"total": 11.03, "avg": 0.09, "max": 0.06, "min": 0.22, "cnt": 128}, "fwd-attn":{"total": 114.05, "avg": 0.89, "max": 0.75, "min": 2.89, "cnt": 128}, "fwd-misc":{"total": 23.71, "avg": 0.19, "max": 0.12, "min": 0.41, "cnt": 128}, "fwd-MLP":{"total": 1607.93, "avg": 12.56, "max": 10.24, "min": 28.83, "cnt": 128}, "MoE_L0_fwd":{"total": 481.23, "avg": 15.04, "max": 11.20, "min": 28.72, "cnt": 32}, "MoEMLP":{"total": 1588.65, "avg": 12.41, "max": 10.11, "min": 28.67, "cnt": 128}, "MoE_L1_fwd":{"total": 375.40, "avg": 11.73, "max": 10.45, "min": 14.45, "cnt": 32}, "MoE_L2_fwd":{"total": 349.69, "avg": 10.93, "max": 10.16, "min": 12.01, "cnt": 32}, "MoE_L3_fwd":{"total": 389.23, "avg": 12.16, "max": 11.42, "min": 13.30, "cnt": 32}, "fwd-pooler":{"total": 0.37, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.68, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 0.86, "avg": 0.86, "max": 0.86, "min": 0.86, "cnt": 1}, "forward-send-backward-recv":{"total": 1414.73, "avg": 45.64, "max": 1.00, "min": 170.79, "cnt": 31}, "backward-compute":{"total": 1496.36, "avg": 46.76, "max": 45.36, "min": 48.28, "cnt": 32}, "MoE_L3_bwd":{"total": 408.28, "avg": 12.76, "max": 11.83, "min": 14.14, "cnt": 32}, "MoE_L2_bwd":{"total": 303.27, "avg": 9.48, "max": 8.55, "min": 10.79, "cnt": 32}, "MoE_L1_bwd":{"total": 284.11, "avg": 8.88, "max": 8.35, "min": 9.42, "cnt": 32}, "MoE_L0_bwd":{"total": 279.87, "avg": 8.75, "max": 8.30, "min": 9.10, "cnt": 32}, "backward-send-forward-recv":{"total": 6002.66, "avg": 200.09, "max": 2.42, "min": 1578.85, "cnt": 30}, "backward-send":{"total": 2.43, "avg": 1.21, "max": 1.16, "min": 1.27, "cnt": 2}, "backward-recv":{"total": 83.78, "avg": 83.78, "max": 83.78, "min": 83.78, "cnt": 1}, "backward-params-all-reduce":{"total": 498.53, "avg": 498.53, "max": 498.53, "min": 498.53, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 296.54, "avg": 296.54, "max": 296.54, "min": 296.54, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.40, "avg": 3.40, "max": 3.40, "min": 3.40, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 252.21, "avg": 252.21, "max": 252.21, "min": 252.21, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.81, "avg": 6.81, "max": 6.81, "min": 6.81, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.52, "avg": 3.52, "max": 3.52, "min": 3.52, "cnt": 1}}}
{"type":"time", "iteration": 14, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 124.85, "avg": 62.42, "max": 0.88, "min": 123.96, "cnt": 2}, "forward-compute":{"total": 1934.95, "avg": 60.47, "max": 52.97, "min": 71.56, "cnt": 32}, "fwd-compute":{"total": 1931.52, "avg": 60.36, "max": 52.88, "min": 71.47, "cnt": 32}, "batch-generator":{"total": 55.30, "avg": 1.73, "max": 0.83, "min": 3.64, "cnt": 32}, "fwd-embedding":{"total": 0.59, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1862.64, "avg": 58.21, "max": 51.64, "min": 69.50, "cnt": 32}, "fwd-layernorm":{"total": 10.70, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 110.96, "avg": 0.87, "max": 0.75, "min": 1.49, "cnt": 128}, "fwd-misc":{"total": 22.79, "avg": 0.18, "max": 0.12, "min": 0.41, "cnt": 128}, "fwd-MLP":{"total": 1694.05, "avg": 13.23, "max": 10.96, "min": 22.90, "cnt": 128}, "MoE_L0_fwd":{"total": 498.41, "avg": 15.58, "max": 11.85, "min": 22.81, "cnt": 32}, "MoEMLP":{"total": 1675.71, "avg": 13.09, "max": 10.84, "min": 22.76, "cnt": 128}, "MoE_L1_fwd":{"total": 413.83, "avg": 12.93, "max": 11.43, "min": 16.81, "cnt": 32}, "MoE_L2_fwd":{"total": 398.56, "avg": 12.46, "max": 11.93, "min": 16.25, "cnt": 32}, "MoE_L3_fwd":{"total": 371.56, "avg": 11.61, "max": 10.88, "min": 14.63, "cnt": 32}, "fwd-pooler":{"total": 0.37, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.65, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 0.83, "avg": 0.83, "max": 0.83, "min": 0.83, "cnt": 1}, "forward-send-backward-recv":{"total": 458.65, "avg": 14.80, "max": 1.55, "min": 103.47, "cnt": 31}, "backward-compute":{"total": 1768.38, "avg": 55.26, "max": 52.31, "min": 56.48, "cnt": 32}, "MoE_L3_bwd":{"total": 403.13, "avg": 12.60, "max": 11.80, "min": 13.72, "cnt": 32}, "MoE_L2_bwd":{"total": 397.60, "avg": 12.43, "max": 11.73, "min": 13.56, "cnt": 32}, "MoE_L1_bwd":{"total": 371.32, "avg": 11.60, "max": 10.76, "min": 12.26, "cnt": 32}, "MoE_L0_bwd":{"total": 376.81, "avg": 11.78, "max": 11.20, "min": 12.46, "cnt": 32}, "backward-send-forward-recv":{"total": 5803.08, "avg": 193.44, "max": 2.26, "min": 847.78, "cnt": 30}, "backward-send":{"total": 1.92, "avg": 0.96, "max": 0.82, "min": 1.10, "cnt": 2}, "backward-recv":{"total": 65.20, "avg": 65.20, "max": 65.20, "min": 65.20, "cnt": 1}, "backward-params-all-reduce":{"total": 493.31, "avg": 493.31, "max": 493.31, "min": 493.31, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 299.04, "avg": 299.04, "max": 299.04, "min": 299.04, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 254.83, "avg": 254.83, "max": 254.83, "min": 254.83, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.97, "avg": 6.97, "max": 6.97, "min": 6.97, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 15, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.11, "avg": 0.11, "max": 0.11, "min": 0.11, "cnt": 1}, "forward-recv":{"total": 130.44, "avg": 65.22, "max": 0.83, "min": 129.62, "cnt": 2}, "forward-compute":{"total": 1975.91, "avg": 61.75, "max": 54.82, "min": 68.53, "cnt": 32}, "fwd-compute":{"total": 1972.49, "avg": 61.64, "max": 54.73, "min": 68.45, "cnt": 32}, "batch-generator":{"total": 44.65, "avg": 1.40, "max": 0.68, "min": 3.28, "cnt": 32}, "fwd-embedding":{"total": 0.67, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1913.38, "avg": 59.79, "max": 53.51, "min": 67.41, "cnt": 32}, "fwd-layernorm":{"total": 10.77, "avg": 0.08, "max": 0.06, "min": 0.26, "cnt": 128}, "fwd-attn":{"total": 112.23, "avg": 0.88, "max": 0.75, "min": 1.84, "cnt": 128}, "fwd-misc":{"total": 23.26, "avg": 0.18, "max": 0.12, "min": 0.44, "cnt": 128}, "fwd-MLP":{"total": 1742.57, "avg": 13.61, "max": 11.39, "min": 24.90, "cnt": 128}, "MoE_L0_fwd":{"total": 527.83, "avg": 16.49, "max": 12.94, "min": 24.78, "cnt": 32}, "MoEMLP":{"total": 1723.87, "avg": 13.47, "max": 11.27, "min": 24.73, "cnt": 128}, "MoE_L1_fwd":{"total": 390.80, "avg": 12.21, "max": 11.31, "min": 13.59, "cnt": 32}, "MoE_L2_fwd":{"total": 408.26, "avg": 12.76, "max": 12.05, "min": 16.93, "cnt": 32}, "MoE_L3_fwd":{"total": 403.79, "avg": 12.62, "max": 11.49, "min": 18.90, "cnt": 32}, "fwd-pooler":{"total": 0.38, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.65, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 0.66, "avg": 0.66, "max": 0.66, "min": 0.66, "cnt": 1}, "forward-send-backward-recv":{"total": 1509.46, "avg": 48.69, "max": 0.97, "min": 348.34, "cnt": 31}, "backward-compute":{"total": 1811.46, "avg": 56.61, "max": 54.01, "min": 58.88, "cnt": 32}, "MoE_L3_bwd":{"total": 436.27, "avg": 13.63, "max": 11.99, "min": 15.83, "cnt": 32}, "MoE_L2_bwd":{"total": 406.55, "avg": 12.70, "max": 12.07, "min": 13.49, "cnt": 32}, "MoE_L1_bwd":{"total": 357.16, "avg": 11.16, "max": 10.40, "min": 12.43, "cnt": 32}, "MoE_L0_bwd":{"total": 395.22, "avg": 12.35, "max": 11.57, "min": 13.56, "cnt": 32}, "backward-send-forward-recv":{"total": 3567.79, "avg": 118.93, "max": 0.98, "min": 747.40, "cnt": 30}, "backward-send":{"total": 2.11, "avg": 1.05, "max": 1.01, "min": 1.09, "cnt": 2}, "backward-recv":{"total": 325.59, "avg": 325.59, "max": 325.59, "min": 325.59, "cnt": 1}, "backward-params-all-reduce":{"total": 491.97, "avg": 491.97, "max": 491.97, "min": 491.97, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.04, "avg": 0.04, "max": 0.04, "min": 0.04, "cnt": 1}, "optimizer":{"total": 295.40, "avg": 295.40, "max": 295.40, "min": 295.40, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 250.77, "avg": 250.77, "max": 250.77, "min": 250.77, "cnt": 1}, "optimizer-clip-main-grad":{"total": 7.23, "avg": 7.23, "max": 7.23, "min": 7.23, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.50, "avg": 3.50, "max": 3.50, "min": 3.50, "cnt": 1}}}
{"type":"time", "iteration": 16, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 136.74, "avg": 68.37, "max": 0.86, "min": 135.88, "cnt": 2}, "forward-compute":{"total": 1979.40, "avg": 61.86, "max": 54.84, "min": 72.02, "cnt": 32}, "fwd-compute":{"total": 1976.26, "avg": 61.76, "max": 54.76, "min": 71.93, "cnt": 32}, "batch-generator":{"total": 41.33, "avg": 1.29, "max": 0.76, "min": 2.80, "cnt": 32}, "fwd-embedding":{"total": 0.52, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1920.94, "avg": 60.03, "max": 53.45, "min": 69.33, "cnt": 32}, "fwd-layernorm":{"total": 9.93, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 105.50, "avg": 0.82, "max": 0.75, "min": 1.56, "cnt": 128}, "fwd-misc":{"total": 21.55, "avg": 0.17, "max": 0.12, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1760.55, "avg": 13.75, "max": 11.61, "min": 26.42, "cnt": 128}, "MoE_L0_fwd":{"total": 526.50, "avg": 16.45, "max": 11.90, "min": 26.33, "cnt": 32}, "MoEMLP":{"total": 1742.55, "avg": 13.61, "max": 11.46, "min": 26.28, "cnt": 128}, "MoE_L1_fwd":{"total": 411.24, "avg": 12.85, "max": 11.51, "min": 16.41, "cnt": 32}, "MoE_L2_fwd":{"total": 395.85, "avg": 12.37, "max": 11.81, "min": 14.40, "cnt": 32}, "MoE_L3_fwd":{"total": 415.45, "avg": 12.98, "max": 11.93, "min": 21.74, "cnt": 32}, "fwd-pooler":{"total": 0.39, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.64, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 0.62, "avg": 0.62, "max": 0.62, "min": 0.62, "cnt": 1}, "forward-send-backward-recv":{"total": 563.79, "avg": 18.19, "max": 0.89, "min": 199.99, "cnt": 31}, "backward-compute":{"total": 1823.10, "avg": 56.97, "max": 53.60, "min": 58.75, "cnt": 32}, "MoE_L3_bwd":{"total": 444.25, "avg": 13.88, "max": 12.63, "min": 16.24, "cnt": 32}, "MoE_L2_bwd":{"total": 402.34, "avg": 12.57, "max": 11.80, "min": 13.52, "cnt": 32}, "MoE_L1_bwd":{"total": 367.87, "avg": 11.50, "max": 10.77, "min": 13.14, "cnt": 32}, "MoE_L0_bwd":{"total": 391.53, "avg": 12.24, "max": 11.60, "min": 12.72, "cnt": 32}, "backward-send-forward-recv":{"total": 5927.20, "avg": 197.57, "max": 1.76, "min": 1330.75, "cnt": 30}, "backward-send":{"total": 2.18, "avg": 1.09, "max": 1.07, "min": 1.11, "cnt": 2}, "backward-recv":{"total": 65.20, "avg": 65.20, "max": 65.20, "min": 65.20, "cnt": 1}, "backward-params-all-reduce":{"total": 490.82, "avg": 490.82, "max": 490.82, "min": 490.82, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 299.99, "avg": 299.99, "max": 299.99, "min": 299.99, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 255.98, "avg": 255.98, "max": 255.98, "min": 255.98, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.63, "avg": 6.63, "max": 6.63, "min": 6.63, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.47, "avg": 3.47, "max": 3.47, "min": 3.47, "cnt": 1}}}
{"type":"time", "iteration": 17, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 123.76, "avg": 61.88, "max": 3.20, "min": 120.56, "cnt": 2}, "forward-compute":{"total": 1924.18, "avg": 60.13, "max": 52.82, "min": 64.74, "cnt": 32}, "fwd-compute":{"total": 1920.94, "avg": 60.03, "max": 52.75, "min": 64.65, "cnt": 32}, "batch-generator":{"total": 45.88, "avg": 1.43, "max": 0.82, "min": 2.50, "cnt": 32}, "fwd-embedding":{"total": 0.64, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1860.80, "avg": 58.15, "max": 51.39, "min": 62.92, "cnt": 32}, "fwd-layernorm":{"total": 10.74, "avg": 0.08, "max": 0.06, "min": 0.23, "cnt": 128}, "fwd-attn":{"total": 110.23, "avg": 0.86, "max": 0.75, "min": 1.88, "cnt": 128}, "fwd-misc":{"total": 23.02, "avg": 0.18, "max": 0.12, "min": 0.44, "cnt": 128}, "fwd-MLP":{"total": 1692.79, "avg": 13.22, "max": 11.21, "min": 21.10, "cnt": 128}, "MoE_L0_fwd":{"total": 520.05, "avg": 16.25, "max": 12.11, "min": 21.01, "cnt": 32}, "MoEMLP":{"total": 1673.89, "avg": 13.08, "max": 11.09, "min": 20.95, "cnt": 128}, "MoE_L1_fwd":{"total": 397.86, "avg": 12.43, "max": 11.29, "min": 14.85, "cnt": 32}, "MoE_L2_fwd":{"total": 395.96, "avg": 12.37, "max": 11.43, "min": 14.29, "cnt": 32}, "MoE_L3_fwd":{"total": 366.84, "avg": 11.46, "max": 11.13, "min": 12.19, "cnt": 32}, "fwd-pooler":{"total": 0.38, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.65, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.01, "avg": 1.01, "max": 1.01, "min": 1.01, "cnt": 1}, "forward-send-backward-recv":{"total": 1387.70, "avg": 44.76, "max": 1.41, "min": 340.80, "cnt": 31}, "backward-compute":{"total": 1762.27, "avg": 55.07, "max": 53.19, "min": 57.84, "cnt": 32}, "MoE_L3_bwd":{"total": 400.73, "avg": 12.52, "max": 11.44, "min": 15.47, "cnt": 32}, "MoE_L2_bwd":{"total": 403.74, "avg": 12.62, "max": 11.28, "min": 14.07, "cnt": 32}, "MoE_L1_bwd":{"total": 352.40, "avg": 11.01, "max": 10.46, "min": 11.59, "cnt": 32}, "MoE_L0_bwd":{"total": 385.62, "avg": 12.05, "max": 11.25, "min": 12.70, "cnt": 32}, "backward-send-forward-recv":{"total": 4954.15, "avg": 165.14, "max": 2.01, "min": 675.51, "cnt": 30}, "backward-send":{"total": 1.52, "avg": 0.76, "max": 0.51, "min": 1.01, "cnt": 2}, "backward-recv":{"total": 396.99, "avg": 396.99, "max": 396.99, "min": 396.99, "cnt": 1}, "backward-params-all-reduce":{"total": 489.40, "avg": 489.40, "max": 489.40, "min": 489.40, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 300.33, "avg": 300.33, "max": 300.33, "min": 300.33, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 256.23, "avg": 256.23, "max": 256.23, "min": 256.23, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.81, "avg": 6.81, "max": 6.81, "min": 6.81, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 18, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 147.45, "avg": 73.73, "max": 5.50, "min": 141.96, "cnt": 2}, "forward-compute":{"total": 1882.21, "avg": 58.82, "max": 54.15, "min": 64.81, "cnt": 32}, "fwd-compute":{"total": 1878.33, "avg": 58.70, "max": 54.06, "min": 64.72, "cnt": 32}, "batch-generator":{"total": 54.62, "avg": 1.71, "max": 0.71, "min": 3.95, "cnt": 32}, "fwd-embedding":{"total": 0.61, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1810.18, "avg": 56.57, "max": 51.59, "min": 63.45, "cnt": 32}, "fwd-layernorm":{"total": 10.77, "avg": 0.08, "max": 0.06, "min": 0.23, "cnt": 128}, "fwd-attn":{"total": 109.92, "avg": 0.86, "max": 0.75, "min": 2.00, "cnt": 128}, "fwd-misc":{"total": 22.75, "avg": 0.18, "max": 0.12, "min": 0.51, "cnt": 128}, "fwd-MLP":{"total": 1642.99, "avg": 12.84, "max": 10.98, "min": 21.98, "cnt": 128}, "MoE_L0_fwd":{"total": 493.68, "avg": 15.43, "max": 12.18, "min": 21.89, "cnt": 32}, "MoEMLP":{"total": 1624.51, "avg": 12.69, "max": 10.85, "min": 21.84, "cnt": 128}, "MoE_L1_fwd":{"total": 383.99, "avg": 12.00, "max": 10.90, "min": 13.91, "cnt": 32}, "MoE_L2_fwd":{"total": 387.47, "avg": 12.11, "max": 11.43, "min": 14.38, "cnt": 32}, "MoE_L3_fwd":{"total": 366.09, "avg": 11.44, "max": 11.03, "min": 12.40, "cnt": 32}, "fwd-pooler":{"total": 0.36, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.64, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 0.68, "avg": 0.68, "max": 0.68, "min": 0.68, "cnt": 1}, "forward-send-backward-recv":{"total": 159.41, "avg": 5.14, "max": 1.31, "min": 66.01, "cnt": 31}, "backward-compute":{"total": 1743.22, "avg": 54.48, "max": 51.39, "min": 56.79, "cnt": 32}, "MoE_L3_bwd":{"total": 396.57, "avg": 12.39, "max": 11.74, "min": 13.97, "cnt": 32}, "MoE_L2_bwd":{"total": 402.01, "avg": 12.56, "max": 11.64, "min": 15.39, "cnt": 32}, "MoE_L1_bwd":{"total": 341.24, "avg": 10.66, "max": 9.91, "min": 11.21, "cnt": 32}, "MoE_L0_bwd":{"total": 381.92, "avg": 11.94, "max": 11.27, "min": 13.69, "cnt": 32}, "backward-send-forward-recv":{"total": 7353.69, "avg": 245.12, "max": 2.32, "min": 1043.66, "cnt": 30}, "backward-send":{"total": 1.30, "avg": 0.65, "max": 0.47, "min": 0.83, "cnt": 2}, "backward-recv":{"total": 66.52, "avg": 66.52, "max": 66.52, "min": 66.52, "cnt": 1}, "backward-params-all-reduce":{"total": 491.70, "avg": 491.70, "max": 491.70, "min": 491.70, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 306.07, "avg": 306.07, "max": 306.07, "min": 306.07, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.40, "avg": 3.40, "max": 3.40, "min": 3.40, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 261.82, "avg": 261.82, "max": 261.82, "min": 261.82, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.88, "avg": 6.88, "max": 6.88, "min": 6.88, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.49, "avg": 3.49, "max": 3.49, "min": 3.49, "cnt": 1}}}
{"type":"time", "iteration": 19, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 134.22, "avg": 67.11, "max": 1.43, "min": 132.79, "cnt": 2}, "forward-compute":{"total": 1925.05, "avg": 60.16, "max": 53.78, "min": 73.07, "cnt": 32}, "fwd-compute":{"total": 1921.71, "avg": 60.05, "max": 53.67, "min": 72.98, "cnt": 32}, "batch-generator":{"total": 48.64, "avg": 1.52, "max": 0.68, "min": 2.59, "cnt": 32}, "fwd-embedding":{"total": 0.56, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1859.36, "avg": 58.11, "max": 51.39, "min": 70.73, "cnt": 32}, "fwd-layernorm":{"total": 10.50, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 109.24, "avg": 0.85, "max": 0.75, "min": 1.49, "cnt": 128}, "fwd-misc":{"total": 23.97, "avg": 0.19, "max": 0.12, "min": 1.75, "cnt": 128}, "fwd-MLP":{"total": 1691.68, "avg": 13.22, "max": 11.05, "min": 28.33, "cnt": 128}, "MoE_L0_fwd":{"total": 517.85, "avg": 16.18, "max": 12.26, "min": 28.26, "cnt": 32}, "MoEMLP":{"total": 1673.32, "avg": 13.07, "max": 10.94, "min": 28.22, "cnt": 128}, "MoE_L1_fwd":{"total": 399.43, "avg": 12.48, "max": 11.02, "min": 15.95, "cnt": 32}, "MoE_L2_fwd":{"total": 389.22, "avg": 12.16, "max": 11.56, "min": 13.49, "cnt": 32}, "MoE_L3_fwd":{"total": 373.49, "avg": 11.67, "max": 10.98, "min": 16.65, "cnt": 32}, "fwd-pooler":{"total": 0.37, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.64, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.03, "avg": 1.03, "max": 1.03, "min": 1.03, "cnt": 1}, "forward-send-backward-recv":{"total": 223.62, "avg": 7.21, "max": 1.39, "min": 60.34, "cnt": 31}, "backward-compute":{"total": 1740.53, "avg": 54.39, "max": 51.56, "min": 57.71, "cnt": 32}, "MoE_L3_bwd":{"total": 399.13, "avg": 12.47, "max": 11.70, "min": 14.05, "cnt": 32}, "MoE_L2_bwd":{"total": 394.62, "avg": 12.33, "max": 11.56, "min": 13.43, "cnt": 32}, "MoE_L1_bwd":{"total": 346.37, "avg": 10.82, "max": 10.31, "min": 11.62, "cnt": 32}, "MoE_L0_bwd":{"total": 380.71, "avg": 11.90, "max": 11.12, "min": 12.28, "cnt": 32}, "backward-send-forward-recv":{"total": 5319.03, "avg": 177.30, "max": 2.44, "min": 824.70, "cnt": 30}, "backward-send":{"total": 1.97, "avg": 0.99, "max": 0.88, "min": 1.10, "cnt": 2}, "backward-recv":{"total": 62.28, "avg": 62.28, "max": 62.28, "min": 62.28, "cnt": 1}, "backward-params-all-reduce":{"total": 495.04, "avg": 495.04, "max": 495.04, "min": 495.04, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 298.55, "avg": 298.55, "max": 298.55, "min": 298.55, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 254.22, "avg": 254.22, "max": 254.22, "min": 254.22, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.81, "avg": 6.81, "max": 6.81, "min": 6.81, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.48, "avg": 3.48, "max": 3.48, "min": 3.48, "cnt": 1}}}
{"type":"time", "iteration": 20, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 1151.99, "avg": 575.99, "max": 1.38, "min": 1150.61, "cnt": 2}, "forward-compute":{"total": 1962.69, "avg": 61.33, "max": 56.19, "min": 75.54, "cnt": 32}, "fwd-compute":{"total": 1958.29, "avg": 61.20, "max": 56.10, "min": 74.53, "cnt": 32}, "batch-generator":{"total": 48.29, "avg": 1.51, "max": 0.84, "min": 3.09, "cnt": 32}, "fwd-embedding":{"total": 0.62, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1896.24, "avg": 59.26, "max": 53.88, "min": 72.36, "cnt": 32}, "fwd-layernorm":{"total": 10.90, "avg": 0.09, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 112.24, "avg": 0.88, "max": 0.75, "min": 1.48, "cnt": 128}, "fwd-misc":{"total": 23.21, "avg": 0.18, "max": 0.12, "min": 0.38, "cnt": 128}, "fwd-MLP":{"total": 1725.16, "avg": 13.48, "max": 11.09, "min": 23.23, "cnt": 128}, "MoE_L0_fwd":{"total": 532.25, "avg": 16.63, "max": 12.43, "min": 23.09, "cnt": 32}, "MoEMLP":{"total": 1706.41, "avg": 13.33, "max": 10.98, "min": 23.00, "cnt": 128}, "MoE_L1_fwd":{"total": 420.32, "avg": 13.14, "max": 11.50, "min": 18.13, "cnt": 32}, "MoE_L2_fwd":{"total": 383.15, "avg": 11.97, "max": 11.11, "min": 14.65, "cnt": 32}, "MoE_L3_fwd":{"total": 377.39, "avg": 11.79, "max": 11.02, "min": 18.12, "cnt": 32}, "fwd-pooler":{"total": 0.37, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 1.35, "avg": 0.04, "max": 0.02, "min": 0.75, "cnt": 32}, "forward-send":{"total": 0.93, "avg": 0.93, "max": 0.93, "min": 0.93, "cnt": 1}, "forward-send-backward-recv":{"total": 398.87, "avg": 12.87, "max": 1.47, "min": 195.99, "cnt": 31}, "backward-compute":{"total": 1742.57, "avg": 54.46, "max": 50.66, "min": 56.39, "cnt": 32}, "MoE_L3_bwd":{"total": 400.83, "avg": 12.53, "max": 11.40, "min": 13.90, "cnt": 32}, "MoE_L2_bwd":{"total": 377.70, "avg": 11.80, "max": 10.14, "min": 12.87, "cnt": 32}, "MoE_L1_bwd":{"total": 369.10, "avg": 11.53, "max": 10.83, "min": 12.69, "cnt": 32}, "MoE_L0_bwd":{"total": 374.74, "avg": 11.71, "max": 10.87, "min": 12.68, "cnt": 32}, "backward-send-forward-recv":{"total": 6357.01, "avg": 211.90, "max": 1.51, "min": 840.20, "cnt": 30}, "backward-send":{"total": 1.96, "avg": 0.98, "max": 0.92, "min": 1.04, "cnt": 2}, "backward-recv":{"total": 71.96, "avg": 71.96, "max": 71.96, "min": 71.96, "cnt": 1}, "backward-params-all-reduce":{"total": 490.47, "avg": 490.47, "max": 490.47, "min": 490.47, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 301.12, "avg": 301.12, "max": 301.12, "min": 301.12, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 256.89, "avg": 256.89, "max": 256.89, "min": 256.89, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.84, "avg": 6.84, "max": 6.84, "min": 6.84, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.48, "avg": 3.48, "max": 3.48, "min": 3.48, "cnt": 1}}}
{"type":"time", "iteration": 21, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.12, "avg": 0.12, "max": 0.12, "min": 0.12, "cnt": 1}, "forward-recv":{"total": 128.16, "avg": 64.08, "max": 1.27, "min": 126.89, "cnt": 2}, "forward-compute":{"total": 1918.88, "avg": 59.96, "max": 53.01, "min": 69.23, "cnt": 32}, "fwd-compute":{"total": 1915.28, "avg": 59.85, "max": 52.93, "min": 69.15, "cnt": 32}, "batch-generator":{"total": 49.63, "avg": 1.55, "max": 0.75, "min": 3.39, "cnt": 32}, "fwd-embedding":{"total": 0.71, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1851.35, "avg": 57.85, "max": 51.68, "min": 66.74, "cnt": 32}, "fwd-layernorm":{"total": 11.04, "avg": 0.09, "max": 0.06, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 110.25, "avg": 0.86, "max": 0.75, "min": 1.54, "cnt": 128}, "fwd-misc":{"total": 23.33, "avg": 0.18, "max": 0.12, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1682.52, "avg": 13.14, "max": 10.65, "min": 19.27, "cnt": 128}, "MoE_L0_fwd":{"total": 483.40, "avg": 15.11, "max": 11.66, "min": 19.19, "cnt": 32}, "MoEMLP":{"total": 1663.46, "avg": 13.00, "max": 10.52, "min": 19.14, "cnt": 128}, "MoE_L1_fwd":{"total": 385.93, "avg": 12.06, "max": 10.57, "min": 15.49, "cnt": 32}, "MoE_L2_fwd":{"total": 423.14, "avg": 13.22, "max": 11.37, "min": 18.13, "cnt": 32}, "MoE_L3_fwd":{"total": 377.89, "avg": 11.81, "max": 11.06, "min": 17.31, "cnt": 32}, "fwd-pooler":{"total": 0.37, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.63, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.00, "avg": 1.00, "max": 1.00, "min": 1.00, "cnt": 1}, "forward-send-backward-recv":{"total": 728.50, "avg": 23.50, "max": 1.36, "min": 179.64, "cnt": 31}, "backward-compute":{"total": 1752.28, "avg": 54.76, "max": 51.43, "min": 57.82, "cnt": 32}, "MoE_L3_bwd":{"total": 405.75, "avg": 12.68, "max": 11.72, "min": 15.99, "cnt": 32}, "MoE_L2_bwd":{"total": 392.29, "avg": 12.26, "max": 11.30, "min": 14.22, "cnt": 32}, "MoE_L1_bwd":{"total": 342.83, "avg": 10.71, "max": 9.72, "min": 13.57, "cnt": 32}, "MoE_L0_bwd":{"total": 395.24, "avg": 12.35, "max": 11.22, "min": 12.99, "cnt": 32}, "backward-send-forward-recv":{"total": 3748.40, "avg": 124.95, "max": 1.70, "min": 454.07, "cnt": 30}, "backward-send":{"total": 2.08, "avg": 1.04, "max": 0.93, "min": 1.15, "cnt": 2}, "backward-recv":{"total": 70.70, "avg": 70.70, "max": 70.70, "min": 70.70, "cnt": 1}, "backward-params-all-reduce":{"total": 490.83, "avg": 490.83, "max": 490.83, "min": 490.83, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "optimizer":{"total": 295.11, "avg": 295.11, "max": 295.11, "min": 295.11, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 250.79, "avg": 250.79, "max": 250.79, "min": 250.79, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.92, "avg": 6.92, "max": 6.92, "min": 6.92, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.47, "avg": 3.47, "max": 3.47, "min": 3.47, "cnt": 1}}}
{"type":"time", "iteration": 22, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 131.73, "avg": 65.87, "max": 7.62, "min": 124.11, "cnt": 2}, "forward-compute":{"total": 1878.19, "avg": 58.69, "max": 53.44, "min": 68.98, "cnt": 32}, "fwd-compute":{"total": 1874.79, "avg": 58.59, "max": 53.32, "min": 68.84, "cnt": 32}, "batch-generator":{"total": 43.87, "avg": 1.37, "max": 0.82, "min": 2.85, "cnt": 32}, "fwd-embedding":{"total": 0.60, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1817.68, "avg": 56.80, "max": 51.54, "min": 66.66, "cnt": 32}, "fwd-layernorm":{"total": 10.29, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 108.66, "avg": 0.85, "max": 0.75, "min": 1.53, "cnt": 128}, "fwd-misc":{"total": 21.94, "avg": 0.17, "max": 0.12, "min": 0.38, "cnt": 128}, "fwd-MLP":{"total": 1653.20, "avg": 12.92, "max": 10.58, "min": 21.88, "cnt": 128}, "MoE_L0_fwd":{"total": 473.35, "avg": 14.79, "max": 11.37, "min": 21.80, "cnt": 32}, "MoEMLP":{"total": 1635.11, "avg": 12.77, "max": 10.44, "min": 21.75, "cnt": 128}, "MoE_L1_fwd":{"total": 391.86, "avg": 12.25, "max": 10.49, "min": 16.01, "cnt": 32}, "MoE_L2_fwd":{"total": 410.81, "avg": 12.84, "max": 11.37, "min": 17.18, "cnt": 32}, "MoE_L3_fwd":{"total": 365.56, "avg": 11.42, "max": 10.74, "min": 18.07, "cnt": 32}, "fwd-pooler":{"total": 0.37, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.63, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 0.80, "avg": 0.80, "max": 0.80, "min": 0.80, "cnt": 1}, "forward-send-backward-recv":{"total": 443.71, "avg": 14.31, "max": 1.75, "min": 154.44, "cnt": 31}, "backward-compute":{"total": 1733.00, "avg": 54.16, "max": 51.01, "min": 56.91, "cnt": 32}, "MoE_L3_bwd":{"total": 398.17, "avg": 12.44, "max": 11.68, "min": 15.40, "cnt": 32}, "MoE_L2_bwd":{"total": 389.73, "avg": 12.18, "max": 11.62, "min": 12.89, "cnt": 32}, "MoE_L1_bwd":{"total": 343.56, "avg": 10.74, "max": 9.98, "min": 13.58, "cnt": 32}, "MoE_L0_bwd":{"total": 386.00, "avg": 12.06, "max": 10.39, "min": 12.73, "cnt": 32}, "backward-send-forward-recv":{"total": 5157.17, "avg": 171.91, "max": 2.29, "min": 618.13, "cnt": 30}, "backward-send":{"total": 2.11, "avg": 1.06, "max": 0.93, "min": 1.18, "cnt": 2}, "backward-recv":{"total": 72.21, "avg": 72.21, "max": 72.21, "min": 72.21, "cnt": 1}, "backward-params-all-reduce":{"total": 523.22, "avg": 523.22, "max": 523.22, "min": 523.22, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 299.54, "avg": 299.54, "max": 299.54, "min": 299.54, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 255.40, "avg": 255.40, "max": 255.40, "min": 255.40, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.91, "avg": 6.91, "max": 6.91, "min": 6.91, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 23, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 134.08, "avg": 67.04, "max": 0.89, "min": 133.19, "cnt": 2}, "forward-compute":{"total": 1877.50, "avg": 58.67, "max": 53.19, "min": 66.98, "cnt": 32}, "fwd-compute":{"total": 1874.23, "avg": 58.57, "max": 53.10, "min": 66.83, "cnt": 32}, "batch-generator":{"total": 51.85, "avg": 1.62, "max": 0.72, "min": 4.73, "cnt": 32}, "fwd-embedding":{"total": 0.55, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1809.29, "avg": 56.54, "max": 50.48, "min": 62.14, "cnt": 32}, "fwd-layernorm":{"total": 9.96, "avg": 0.08, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 107.29, "avg": 0.84, "max": 0.75, "min": 1.91, "cnt": 128}, "fwd-misc":{"total": 21.59, "avg": 0.17, "max": 0.12, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1647.43, "avg": 12.87, "max": 10.53, "min": 20.04, "cnt": 128}, "MoE_L0_fwd":{"total": 480.52, "avg": 15.02, "max": 11.03, "min": 19.96, "cnt": 32}, "MoEMLP":{"total": 1629.87, "avg": 12.73, "max": 10.41, "min": 19.91, "cnt": 128}, "MoE_L1_fwd":{"total": 401.46, "avg": 12.55, "max": 10.45, "min": 15.24, "cnt": 32}, "MoE_L2_fwd":{"total": 391.11, "avg": 12.22, "max": 11.20, "min": 15.58, "cnt": 32}, "MoE_L3_fwd":{"total": 363.14, "avg": 11.35, "max": 10.80, "min": 12.53, "cnt": 32}, "fwd-pooler":{"total": 0.38, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.63, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 0.81, "avg": 0.81, "max": 0.81, "min": 0.81, "cnt": 1}, "forward-send-backward-recv":{"total": 375.55, "avg": 12.11, "max": 1.36, "min": 137.67, "cnt": 31}, "backward-compute":{"total": 1710.55, "avg": 53.45, "max": 50.21, "min": 54.70, "cnt": 32}, "MoE_L3_bwd":{"total": 391.02, "avg": 12.22, "max": 11.62, "min": 13.11, "cnt": 32}, "MoE_L2_bwd":{"total": 385.05, "avg": 12.03, "max": 11.51, "min": 12.83, "cnt": 32}, "MoE_L1_bwd":{"total": 350.82, "avg": 10.96, "max": 9.83, "min": 11.58, "cnt": 32}, "MoE_L0_bwd":{"total": 365.84, "avg": 11.43, "max": 10.34, "min": 12.67, "cnt": 32}, "backward-send-forward-recv":{"total": 3907.23, "avg": 130.24, "max": 2.51, "min": 395.30, "cnt": 30}, "backward-send":{"total": 2.09, "avg": 1.04, "max": 0.98, "min": 1.11, "cnt": 2}, "backward-recv":{"total": 379.40, "avg": 379.40, "max": 379.40, "min": 379.40, "cnt": 1}, "backward-params-all-reduce":{"total": 491.21, "avg": 491.21, "max": 491.21, "min": 491.21, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 305.11, "avg": 305.11, "max": 305.11, "min": 305.11, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.40, "avg": 3.40, "max": 3.40, "min": 3.40, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 260.78, "avg": 260.78, "max": 260.78, "min": 260.78, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.83, "avg": 6.83, "max": 6.83, "min": 6.83, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 24, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 127.99, "avg": 64.00, "max": 1.15, "min": 126.84, "cnt": 2}, "forward-compute":{"total": 1873.24, "avg": 58.54, "max": 51.92, "min": 64.78, "cnt": 32}, "fwd-compute":{"total": 1869.26, "avg": 58.41, "max": 51.83, "min": 64.70, "cnt": 32}, "batch-generator":{"total": 45.07, "avg": 1.41, "max": 0.73, "min": 2.64, "cnt": 32}, "fwd-embedding":{"total": 0.72, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1809.45, "avg": 56.55, "max": 50.45, "min": 63.45, "cnt": 32}, "fwd-layernorm":{"total": 11.86, "avg": 0.09, "max": 0.06, "min": 0.24, "cnt": 128}, "fwd-attn":{"total": 116.87, "avg": 0.91, "max": 0.75, "min": 2.19, "cnt": 128}, "fwd-misc":{"total": 25.29, "avg": 0.20, "max": 0.12, "min": 0.48, "cnt": 128}, "fwd-MLP":{"total": 1629.54, "avg": 12.73, "max": 10.08, "min": 19.15, "cnt": 128}, "MoE_L0_fwd":{"total": 480.34, "avg": 15.01, "max": 11.63, "min": 19.06, "cnt": 32}, "MoEMLP":{"total": 1609.17, "avg": 12.57, "max": 9.95, "min": 19.01, "cnt": 128}, "MoE_L1_fwd":{"total": 365.94, "avg": 11.44, "max": 9.99, "min": 13.46, "cnt": 32}, "MoE_L2_fwd":{"total": 394.80, "avg": 12.34, "max": 11.13, "min": 14.52, "cnt": 32}, "MoE_L3_fwd":{"total": 375.36, "avg": 11.73, "max": 11.03, "min": 18.34, "cnt": 32}, "fwd-pooler":{"total": 0.38, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.65, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 0.97, "avg": 0.97, "max": 0.97, "min": 0.97, "cnt": 1}, "forward-send-backward-recv":{"total": 3242.87, "avg": 104.61, "max": 1.89, "min": 428.94, "cnt": 31}, "backward-compute":{"total": 1705.49, "avg": 53.30, "max": 50.64, "min": 56.40, "cnt": 32}, "MoE_L3_bwd":{"total": 401.79, "avg": 12.56, "max": 11.55, "min": 14.69, "cnt": 32}, "MoE_L2_bwd":{"total": 374.42, "avg": 11.70, "max": 10.29, "min": 12.83, "cnt": 32}, "MoE_L1_bwd":{"total": 319.92, "avg": 10.00, "max": 9.41, "min": 11.36, "cnt": 32}, "MoE_L0_bwd":{"total": 388.80, "avg": 12.15, "max": 10.99, "min": 12.68, "cnt": 32}, "backward-send-forward-recv":{"total": 1291.76, "avg": 43.06, "max": 1.99, "min": 208.00, "cnt": 30}, "backward-send":{"total": 2.19, "avg": 1.09, "max": 1.06, "min": 1.13, "cnt": 2}, "backward-recv":{"total": 274.27, "avg": 274.27, "max": 274.27, "min": 274.27, "cnt": 1}, "backward-params-all-reduce":{"total": 490.71, "avg": 490.71, "max": 490.71, "min": 490.71, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 303.74, "avg": 303.74, "max": 303.74, "min": 303.74, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 259.56, "avg": 259.56, "max": 259.56, "min": 259.56, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.79, "avg": 6.79, "max": 6.79, "min": 6.79, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.49, "avg": 3.49, "max": 3.49, "min": 3.49, "cnt": 1}}}
{"type":"time", "iteration": 25, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 132.67, "avg": 66.34, "max": 0.75, "min": 131.92, "cnt": 2}, "forward-compute":{"total": 1896.43, "avg": 59.26, "max": 52.53, "min": 69.39, "cnt": 32}, "fwd-compute":{"total": 1892.73, "avg": 59.15, "max": 52.44, "min": 69.28, "cnt": 32}, "batch-generator":{"total": 42.74, "avg": 1.34, "max": 0.80, "min": 1.98, "cnt": 32}, "fwd-embedding":{"total": 0.67, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1835.45, "avg": 57.36, "max": 51.11, "min": 67.77, "cnt": 32}, "fwd-layernorm":{"total": 11.26, "avg": 0.09, "max": 0.06, "min": 0.22, "cnt": 128}, "fwd-attn":{"total": 112.25, "avg": 0.88, "max": 0.75, "min": 1.95, "cnt": 128}, "fwd-misc":{"total": 23.69, "avg": 0.19, "max": 0.12, "min": 0.43, "cnt": 128}, "fwd-MLP":{"total": 1663.05, "avg": 12.99, "max": 10.34, "min": 24.19, "cnt": 128}, "MoE_L0_fwd":{"total": 497.54, "avg": 15.55, "max": 11.84, "min": 24.09, "cnt": 32}, "MoEMLP":{"total": 1644.04, "avg": 12.84, "max": 10.23, "min": 24.04, "cnt": 128}, "MoE_L1_fwd":{"total": 375.07, "avg": 11.72, "max": 10.27, "min": 15.17, "cnt": 32}, "MoE_L2_fwd":{"total": 399.07, "avg": 12.47, "max": 11.65, "min": 14.34, "cnt": 32}, "MoE_L3_fwd":{"total": 379.33, "avg": 11.85, "max": 11.08, "min": 15.90, "cnt": 32}, "fwd-pooler":{"total": 0.38, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.66, "avg": 0.02, "max": 0.02, "min": 0.05, "cnt": 32}, "forward-send":{"total": 0.80, "avg": 0.80, "max": 0.80, "min": 0.80, "cnt": 1}, "forward-send-backward-recv":{"total": 1467.60, "avg": 47.34, "max": 1.22, "min": 354.21, "cnt": 31}, "backward-compute":{"total": 1731.97, "avg": 54.12, "max": 50.07, "min": 56.46, "cnt": 32}, "MoE_L3_bwd":{"total": 395.22, "avg": 12.35, "max": 11.29, "min": 13.51, "cnt": 32}, "MoE_L2_bwd":{"total": 387.98, "avg": 12.12, "max": 11.29, "min": 13.14, "cnt": 32}, "MoE_L1_bwd":{"total": 334.30, "avg": 10.45, "max": 9.63, "min": 13.12, "cnt": 32}, "MoE_L0_bwd":{"total": 396.24, "avg": 12.38, "max": 11.54, "min": 12.74, "cnt": 32}, "backward-send-forward-recv":{"total": 4134.97, "avg": 137.83, "max": 2.31, "min": 943.69, "cnt": 30}, "backward-send":{"total": 2.09, "avg": 1.05, "max": 0.98, "min": 1.11, "cnt": 2}, "backward-recv":{"total": 67.12, "avg": 67.12, "max": 67.12, "min": 67.12, "cnt": 1}, "backward-params-all-reduce":{"total": 492.60, "avg": 492.60, "max": 492.60, "min": 492.60, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 299.15, "avg": 299.15, "max": 299.15, "min": 299.15, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 254.95, "avg": 254.95, "max": 254.95, "min": 254.95, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.84, "avg": 6.84, "max": 6.84, "min": 6.84, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.49, "avg": 3.49, "max": 3.49, "min": 3.49, "cnt": 1}}}
{"type":"time", "iteration": 26, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 125.60, "avg": 62.80, "max": 1.39, "min": 124.21, "cnt": 2}, "forward-compute":{"total": 1930.36, "avg": 60.32, "max": 52.69, "min": 102.62, "cnt": 32}, "fwd-compute":{"total": 1927.09, "avg": 60.22, "max": 52.61, "min": 102.53, "cnt": 32}, "batch-generator":{"total": 49.11, "avg": 1.53, "max": 0.80, "min": 3.08, "cnt": 32}, "fwd-embedding":{"total": 0.52, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1864.96, "avg": 58.28, "max": 51.43, "min": 99.45, "cnt": 32}, "fwd-layernorm":{"total": 10.82, "avg": 0.08, "max": 0.06, "min": 0.42, "cnt": 128}, "fwd-attn":{"total": 107.90, "avg": 0.84, "max": 0.74, "min": 2.19, "cnt": 128}, "fwd-misc":{"total": 22.43, "avg": 0.18, "max": 0.12, "min": 0.42, "cnt": 128}, "fwd-MLP":{"total": 1699.20, "avg": 13.28, "max": 10.44, "min": 57.11, "cnt": 128}, "MoE_L0_fwd":{"total": 543.96, "avg": 17.00, "max": 11.70, "min": 57.01, "cnt": 32}, "MoEMLP":{"total": 1681.59, "avg": 13.14, "max": 10.30, "min": 56.95, "cnt": 128}, "MoE_L1_fwd":{"total": 370.81, "avg": 11.59, "max": 10.36, "min": 13.12, "cnt": 32}, "MoE_L2_fwd":{"total": 411.02, "avg": 12.84, "max": 11.70, "min": 17.10, "cnt": 32}, "MoE_L3_fwd":{"total": 362.27, "avg": 11.32, "max": 10.90, "min": 12.74, "cnt": 32}, "fwd-pooler":{"total": 0.36, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.64, "avg": 0.02, "max": 0.02, "min": 0.04, "cnt": 32}, "forward-send":{"total": 0.96, "avg": 0.96, "max": 0.96, "min": 0.96, "cnt": 1}, "forward-send-backward-recv":{"total": 204.87, "avg": 6.61, "max": 1.18, "min": 64.56, "cnt": 31}, "backward-compute":{"total": 1737.63, "avg": 54.30, "max": 51.67, "min": 56.59, "cnt": 32}, "MoE_L3_bwd":{"total": 394.77, "avg": 12.34, "max": 11.52, "min": 13.66, "cnt": 32}, "MoE_L2_bwd":{"total": 388.75, "avg": 12.15, "max": 11.69, "min": 13.36, "cnt": 32}, "MoE_L1_bwd":{"total": 338.92, "avg": 10.59, "max": 9.97, "min": 12.69, "cnt": 32}, "MoE_L0_bwd":{"total": 397.44, "avg": 12.42, "max": 11.63, "min": 13.48, "cnt": 32}, "backward-send-forward-recv":{"total": 6317.44, "avg": 210.58, "max": 2.09, "min": 1065.46, "cnt": 30}, "backward-send":{"total": 1.89, "avg": 0.95, "max": 0.92, "min": 0.98, "cnt": 2}, "backward-recv":{"total": 68.87, "avg": 68.87, "max": 68.87, "min": 68.87, "cnt": 1}, "backward-params-all-reduce":{"total": 489.59, "avg": 489.59, "max": 489.59, "min": 489.59, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 347.75, "avg": 347.75, "max": 347.75, "min": 347.75, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.40, "avg": 3.40, "max": 3.40, "min": 3.40, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 303.54, "avg": 303.54, "max": 303.54, "min": 303.54, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.83, "avg": 6.83, "max": 6.83, "min": 6.83, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.48, "avg": 3.48, "max": 3.48, "min": 3.48, "cnt": 1}}}
{"type":"time", "iteration": 27, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 142.78, "avg": 71.39, "max": 3.95, "min": 138.83, "cnt": 2}, "forward-compute":{"total": 1883.33, "avg": 58.85, "max": 53.34, "min": 68.62, "cnt": 32}, "fwd-compute":{"total": 1879.66, "avg": 58.74, "max": 53.26, "min": 68.48, "cnt": 32}, "batch-generator":{"total": 61.85, "avg": 1.93, "max": 0.76, "min": 3.59, "cnt": 32}, "fwd-embedding":{"total": 0.77, "avg": 0.02, "max": 0.01, "min": 0.10, "cnt": 32}, "fwd-encoder":{"total": 1802.48, "avg": 56.33, "max": 52.08, "min": 64.40, "cnt": 32}, "fwd-layernorm":{"total": 10.83, "avg": 0.08, "max": 0.06, "min": 0.25, "cnt": 128}, "fwd-attn":{"total": 110.27, "avg": 0.86, "max": 0.74, "min": 1.89, "cnt": 128}, "fwd-misc":{"total": 22.96, "avg": 0.18, "max": 0.12, "min": 0.41, "cnt": 128}, "fwd-MLP":{"total": 1634.68, "avg": 12.77, "max": 10.51, "min": 22.60, "cnt": 128}, "MoE_L0_fwd":{"total": 482.00, "avg": 15.06, "max": 11.75, "min": 22.45, "cnt": 32}, "MoEMLP":{"total": 1616.43, "avg": 12.63, "max": 10.38, "min": 22.37, "cnt": 128}, "MoE_L1_fwd":{"total": 364.18, "avg": 11.38, "max": 10.43, "min": 13.70, "cnt": 32}, "MoE_L2_fwd":{"total": 412.67, "avg": 12.90, "max": 12.16, "min": 15.19, "cnt": 32}, "MoE_L3_fwd":{"total": 364.23, "avg": 11.38, "max": 10.87, "min": 14.44, "cnt": 32}, "fwd-pooler":{"total": 0.38, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.62, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 0.92, "avg": 0.92, "max": 0.92, "min": 0.92, "cnt": 1}, "forward-send-backward-recv":{"total": 243.15, "avg": 7.84, "max": 1.55, "min": 81.63, "cnt": 31}, "backward-compute":{"total": 1743.82, "avg": 54.49, "max": 51.47, "min": 57.55, "cnt": 32}, "MoE_L3_bwd":{"total": 388.95, "avg": 12.15, "max": 10.78, "min": 15.83, "cnt": 32}, "MoE_L2_bwd":{"total": 396.08, "avg": 12.38, "max": 10.92, "min": 14.31, "cnt": 32}, "MoE_L1_bwd":{"total": 338.01, "avg": 10.56, "max": 9.70, "min": 11.36, "cnt": 32}, "MoE_L0_bwd":{"total": 403.82, "avg": 12.62, "max": 11.98, "min": 14.34, "cnt": 32}, "backward-send-forward-recv":{"total": 4307.09, "avg": 143.57, "max": 2.16, "min": 391.66, "cnt": 30}, "backward-send":{"total": 1.88, "avg": 0.94, "max": 0.85, "min": 1.02, "cnt": 2}, "backward-recv":{"total": 70.44, "avg": 70.44, "max": 70.44, "min": 70.44, "cnt": 1}, "backward-params-all-reduce":{"total": 491.39, "avg": 491.39, "max": 491.39, "min": 491.39, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.04, "avg": 0.04, "max": 0.04, "min": 0.04, "cnt": 1}, "optimizer":{"total": 298.20, "avg": 298.20, "max": 298.20, "min": 298.20, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 253.51, "avg": 253.51, "max": 253.51, "min": 253.51, "cnt": 1}, "optimizer-clip-main-grad":{"total": 7.20, "avg": 7.20, "max": 7.20, "min": 7.20, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.47, "avg": 3.47, "max": 3.47, "min": 3.47, "cnt": 1}}}
{"type":"time", "iteration": 28, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.10, "avg": 0.10, "max": 0.10, "min": 0.10, "cnt": 1}, "forward-recv":{"total": 136.22, "avg": 68.11, "max": 1.04, "min": 135.18, "cnt": 2}, "forward-compute":{"total": 1884.32, "avg": 58.89, "max": 53.37, "min": 65.34, "cnt": 32}, "fwd-compute":{"total": 1880.77, "avg": 58.77, "max": 53.29, "min": 65.19, "cnt": 32}, "batch-generator":{"total": 45.50, "avg": 1.42, "max": 0.72, "min": 2.52, "cnt": 32}, "fwd-embedding":{"total": 0.64, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1820.63, "avg": 56.89, "max": 51.96, "min": 62.65, "cnt": 32}, "fwd-layernorm":{"total": 11.55, "avg": 0.09, "max": 0.06, "min": 0.86, "cnt": 128}, "fwd-attn":{"total": 113.24, "avg": 0.88, "max": 0.75, "min": 1.66, "cnt": 128}, "fwd-misc":{"total": 22.72, "avg": 0.18, "max": 0.12, "min": 0.38, "cnt": 128}, "fwd-MLP":{"total": 1648.25, "avg": 12.88, "max": 10.58, "min": 19.82, "cnt": 128}, "MoE_L0_fwd":{"total": 495.32, "avg": 15.48, "max": 12.20, "min": 19.72, "cnt": 32}, "MoEMLP":{"total": 1627.48, "avg": 12.71, "max": 10.45, "min": 19.66, "cnt": 128}, "MoE_L1_fwd":{"total": 366.27, "avg": 11.45, "max": 10.50, "min": 13.50, "cnt": 32}, "MoE_L2_fwd":{"total": 407.50, "avg": 12.73, "max": 11.58, "min": 15.25, "cnt": 32}, "MoE_L3_fwd":{"total": 365.32, "avg": 11.42, "max": 10.93, "min": 13.29, "cnt": 32}, "fwd-pooler":{"total": 0.39, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.65, "avg": 0.02, "max": 0.02, "min": 0.06, "cnt": 32}, "forward-send":{"total": 0.98, "avg": 0.98, "max": 0.98, "min": 0.98, "cnt": 1}, "forward-send-backward-recv":{"total": 1396.93, "avg": 45.06, "max": 1.45, "min": 418.01, "cnt": 31}, "backward-compute":{"total": 1734.35, "avg": 54.20, "max": 49.82, "min": 57.81, "cnt": 32}, "MoE_L3_bwd":{"total": 387.24, "avg": 12.10, "max": 10.88, "min": 15.25, "cnt": 32}, "MoE_L2_bwd":{"total": 385.76, "avg": 12.05, "max": 11.10, "min": 14.03, "cnt": 32}, "MoE_L1_bwd":{"total": 337.13, "avg": 10.54, "max": 9.56, "min": 11.78, "cnt": 32}, "MoE_L0_bwd":{"total": 407.41, "avg": 12.73, "max": 11.67, "min": 13.08, "cnt": 32}, "backward-send-forward-recv":{"total": 4032.38, "avg": 134.41, "max": 1.72, "min": 616.31, "cnt": 30}, "backward-send":{"total": 2.22, "avg": 1.11, "max": 1.11, "min": 1.11, "cnt": 2}, "backward-recv":{"total": 70.70, "avg": 70.70, "max": 70.70, "min": 70.70, "cnt": 1}, "backward-params-all-reduce":{"total": 488.38, "avg": 488.38, "max": 488.38, "min": 488.38, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 303.14, "avg": 303.14, "max": 303.14, "min": 303.14, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.41, "avg": 3.41, "max": 3.41, "min": 3.41, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 256.31, "avg": 256.31, "max": 256.31, "min": 256.31, "cnt": 1}, "optimizer-clip-main-grad":{"total": 9.30, "avg": 9.30, "max": 9.30, "min": 9.30, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.49, "avg": 3.49, "max": 3.49, "min": 3.49, "cnt": 1}}}
{"type":"time", "iteration": 29, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.10, "avg": 0.10, "max": 0.10, "min": 0.10, "cnt": 1}, "forward-recv":{"total": 140.26, "avg": 70.13, "max": 3.66, "min": 136.61, "cnt": 2}, "forward-compute":{"total": 1917.81, "avg": 59.93, "max": 54.21, "min": 67.81, "cnt": 32}, "fwd-compute":{"total": 1914.33, "avg": 59.82, "max": 54.13, "min": 67.72, "cnt": 32}, "batch-generator":{"total": 46.57, "avg": 1.46, "max": 0.79, "min": 2.54, "cnt": 32}, "fwd-embedding":{"total": 0.60, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1854.13, "avg": 57.94, "max": 52.49, "min": 66.22, "cnt": 32}, "fwd-layernorm":{"total": 10.85, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 112.07, "avg": 0.88, "max": 0.75, "min": 1.95, "cnt": 128}, "fwd-misc":{"total": 23.22, "avg": 0.18, "max": 0.12, "min": 0.43, "cnt": 128}, "fwd-MLP":{"total": 1683.58, "avg": 13.15, "max": 10.41, "min": 21.62, "cnt": 128}, "MoE_L0_fwd":{"total": 499.37, "avg": 15.61, "max": 12.60, "min": 21.45, "cnt": 32}, "MoEMLP":{"total": 1664.73, "avg": 13.01, "max": 10.29, "min": 21.36, "cnt": 128}, "MoE_L1_fwd":{"total": 376.39, "avg": 11.76, "max": 10.33, "min": 13.88, "cnt": 32}, "MoE_L2_fwd":{"total": 407.79, "avg": 12.74, "max": 11.69, "min": 17.21, "cnt": 32}, "MoE_L3_fwd":{"total": 387.96, "avg": 12.12, "max": 11.43, "min": 14.71, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.63, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 0.95, "avg": 0.95, "max": 0.95, "min": 0.95, "cnt": 1}, "forward-send-backward-recv":{"total": 382.21, "avg": 12.33, "max": 1.10, "min": 173.18, "cnt": 31}, "backward-compute":{"total": 1749.59, "avg": 54.67, "max": 51.23, "min": 56.51, "cnt": 32}, "MoE_L3_bwd":{"total": 402.47, "avg": 12.58, "max": 11.54, "min": 14.58, "cnt": 32}, "MoE_L2_bwd":{"total": 379.98, "avg": 11.87, "max": 11.12, "min": 12.82, "cnt": 32}, "MoE_L1_bwd":{"total": 335.98, "avg": 10.50, "max": 9.49, "min": 10.96, "cnt": 32}, "MoE_L0_bwd":{"total": 409.70, "avg": 12.80, "max": 11.82, "min": 14.86, "cnt": 32}, "backward-send-forward-recv":{"total": 3679.17, "avg": 122.64, "max": 2.42, "min": 487.95, "cnt": 30}, "backward-send":{"total": 1.77, "avg": 0.89, "max": 0.79, "min": 0.98, "cnt": 2}, "backward-recv":{"total": 68.43, "avg": 68.43, "max": 68.43, "min": 68.43, "cnt": 1}, "backward-params-all-reduce":{"total": 496.74, "avg": 496.74, "max": 496.74, "min": 496.74, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 295.06, "avg": 295.06, "max": 295.06, "min": 295.06, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 250.90, "avg": 250.90, "max": 250.90, "min": 250.90, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.92, "avg": 6.92, "max": 6.92, "min": 6.92, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.53, "avg": 3.53, "max": 3.53, "min": 3.53, "cnt": 1}}}
{"type":"time", "iteration": 30, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 633.20, "avg": 316.60, "max": 0.90, "min": 632.30, "cnt": 2}, "forward-compute":{"total": 1980.76, "avg": 61.90, "max": 54.61, "min": 79.64, "cnt": 32}, "fwd-compute":{"total": 1976.89, "avg": 61.78, "max": 54.49, "min": 79.54, "cnt": 32}, "batch-generator":{"total": 58.71, "avg": 1.83, "max": 0.87, "min": 4.87, "cnt": 32}, "fwd-embedding":{"total": 0.77, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1903.20, "avg": 59.47, "max": 52.74, "min": 77.95, "cnt": 32}, "fwd-layernorm":{"total": 11.65, "avg": 0.09, "max": 0.06, "min": 0.24, "cnt": 128}, "fwd-attn":{"total": 119.36, "avg": 0.93, "max": 0.75, "min": 2.76, "cnt": 128}, "fwd-misc":{"total": 24.88, "avg": 0.19, "max": 0.12, "min": 0.50, "cnt": 128}, "fwd-MLP":{"total": 1722.18, "avg": 13.45, "max": 10.50, "min": 35.67, "cnt": 128}, "MoE_L0_fwd":{"total": 556.28, "avg": 17.38, "max": 12.12, "min": 35.58, "cnt": 32}, "MoEMLP":{"total": 1702.95, "avg": 13.30, "max": 10.37, "min": 35.53, "cnt": 128}, "MoE_L1_fwd":{"total": 376.42, "avg": 11.76, "max": 10.42, "min": 14.04, "cnt": 32}, "MoE_L2_fwd":{"total": 393.10, "avg": 12.28, "max": 11.51, "min": 17.27, "cnt": 32}, "MoE_L3_fwd":{"total": 384.12, "avg": 12.00, "max": 11.22, "min": 14.34, "cnt": 32}, "fwd-pooler":{"total": 0.37, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.64, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.01, "avg": 1.01, "max": 1.01, "min": 1.01, "cnt": 1}, "forward-send-backward-recv":{"total": 1897.68, "avg": 61.22, "max": 1.60, "min": 398.19, "cnt": 31}, "backward-compute":{"total": 1740.11, "avg": 54.38, "max": 52.30, "min": 55.36, "cnt": 32}, "MoE_L3_bwd":{"total": 397.36, "avg": 12.42, "max": 11.86, "min": 13.21, "cnt": 32}, "MoE_L2_bwd":{"total": 385.82, "avg": 12.06, "max": 11.62, "min": 12.89, "cnt": 32}, "MoE_L1_bwd":{"total": 341.47, "avg": 10.67, "max": 10.01, "min": 11.08, "cnt": 32}, "MoE_L0_bwd":{"total": 403.76, "avg": 12.62, "max": 12.14, "min": 13.06, "cnt": 32}, "backward-send-forward-recv":{"total": 2362.87, "avg": 78.76, "max": 1.21, "min": 419.72, "cnt": 30}, "backward-send":{"total": 1.91, "avg": 0.96, "max": 0.96, "min": 0.96, "cnt": 2}, "backward-recv":{"total": 402.30, "avg": 402.30, "max": 402.30, "min": 402.30, "cnt": 1}, "backward-params-all-reduce":{"total": 502.10, "avg": 502.10, "max": 502.10, "min": 502.10, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 283.37, "avg": 283.37, "max": 283.37, "min": 283.37, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 239.18, "avg": 239.18, "max": 239.18, "min": 239.18, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.83, "avg": 6.83, "max": 6.83, "min": 6.83, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.48, "avg": 3.48, "max": 3.48, "min": 3.48, "cnt": 1}}}
{"type":"time", "iteration": 31, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 127.39, "avg": 63.69, "max": 1.35, "min": 126.04, "cnt": 2}, "forward-compute":{"total": 1915.30, "avg": 59.85, "max": 53.50, "min": 65.58, "cnt": 32}, "fwd-compute":{"total": 1911.53, "avg": 59.74, "max": 53.42, "min": 65.44, "cnt": 32}, "batch-generator":{"total": 50.37, "avg": 1.57, "max": 0.73, "min": 3.57, "cnt": 32}, "fwd-embedding":{"total": 0.75, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1845.94, "avg": 57.69, "max": 51.26, "min": 63.34, "cnt": 32}, "fwd-layernorm":{"total": 11.95, "avg": 0.09, "max": 0.06, "min": 0.38, "cnt": 128}, "fwd-attn":{"total": 119.15, "avg": 0.93, "max": 0.75, "min": 3.44, "cnt": 128}, "fwd-misc":{"total": 25.53, "avg": 0.20, "max": 0.12, "min": 0.63, "cnt": 128}, "fwd-MLP":{"total": 1663.00, "avg": 12.99, "max": 10.45, "min": 21.75, "cnt": 128}, "MoE_L0_fwd":{"total": 503.42, "avg": 15.73, "max": 12.27, "min": 21.64, "cnt": 32}, "MoEMLP":{"total": 1643.11, "avg": 12.84, "max": 10.33, "min": 21.58, "cnt": 128}, "MoE_L1_fwd":{"total": 373.08, "avg": 11.66, "max": 10.38, "min": 14.67, "cnt": 32}, "MoE_L2_fwd":{"total": 396.01, "avg": 12.38, "max": 11.46, "min": 13.71, "cnt": 32}, "MoE_L3_fwd":{"total": 377.73, "avg": 11.80, "max": 11.17, "min": 13.45, "cnt": 32}, "fwd-pooler":{"total": 0.37, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.66, "avg": 0.02, "max": 0.02, "min": 0.04, "cnt": 32}, "forward-send":{"total": 0.90, "avg": 0.90, "max": 0.90, "min": 0.90, "cnt": 1}, "forward-send-backward-recv":{"total": 302.50, "avg": 9.76, "max": 1.52, "min": 71.69, "cnt": 31}, "backward-compute":{"total": 1741.87, "avg": 54.43, "max": 53.14, "min": 58.01, "cnt": 32}, "MoE_L3_bwd":{"total": 404.58, "avg": 12.64, "max": 12.00, "min": 14.80, "cnt": 32}, "MoE_L2_bwd":{"total": 380.57, "avg": 11.89, "max": 11.22, "min": 13.96, "cnt": 32}, "MoE_L1_bwd":{"total": 328.40, "avg": 10.26, "max": 9.66, "min": 11.87, "cnt": 32}, "MoE_L0_bwd":{"total": 412.15, "avg": 12.88, "max": 12.27, "min": 13.36, "cnt": 32}, "backward-send-forward-recv":{"total": 4079.69, "avg": 135.99, "max": 2.18, "min": 508.46, "cnt": 30}, "backward-send":{"total": 1.85, "avg": 0.93, "max": 0.79, "min": 1.07, "cnt": 2}, "backward-recv":{"total": 82.05, "avg": 82.05, "max": 82.05, "min": 82.05, "cnt": 1}, "backward-params-all-reduce":{"total": 490.52, "avg": 490.52, "max": 490.52, "min": 490.52, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.04, "avg": 0.04, "max": 0.04, "min": 0.04, "cnt": 1}, "optimizer":{"total": 293.35, "avg": 293.35, "max": 293.35, "min": 293.35, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.40, "avg": 3.40, "max": 3.40, "min": 3.40, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 249.06, "avg": 249.06, "max": 249.06, "min": 249.06, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.80, "avg": 6.80, "max": 6.80, "min": 6.80, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.52, "avg": 3.52, "max": 3.52, "min": 3.52, "cnt": 1}}}
{"type":"time", "iteration": 32, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 130.16, "avg": 65.08, "max": 0.74, "min": 129.42, "cnt": 2}, "forward-compute":{"total": 1872.72, "avg": 58.52, "max": 52.47, "min": 62.89, "cnt": 32}, "fwd-compute":{"total": 1869.09, "avg": 58.41, "max": 52.39, "min": 62.61, "cnt": 32}, "batch-generator":{"total": 54.24, "avg": 1.69, "max": 0.77, "min": 3.06, "cnt": 32}, "fwd-embedding":{"total": 0.66, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1800.80, "avg": 56.27, "max": 51.13, "min": 60.31, "cnt": 32}, "fwd-layernorm":{"total": 11.17, "avg": 0.09, "max": 0.06, "min": 0.29, "cnt": 128}, "fwd-attn":{"total": 112.05, "avg": 0.88, "max": 0.75, "min": 2.26, "cnt": 128}, "fwd-misc":{"total": 23.55, "avg": 0.18, "max": 0.12, "min": 0.45, "cnt": 128}, "fwd-MLP":{"total": 1629.24, "avg": 12.73, "max": 10.33, "min": 17.64, "cnt": 128}, "MoE_L0_fwd":{"total": 475.04, "avg": 14.85, "max": 11.89, "min": 17.55, "cnt": 32}, "MoEMLP":{"total": 1610.54, "avg": 12.58, "max": 10.21, "min": 17.49, "cnt": 128}, "MoE_L1_fwd":{"total": 371.33, "avg": 11.60, "max": 10.26, "min": 13.70, "cnt": 32}, "MoE_L2_fwd":{"total": 395.29, "avg": 12.35, "max": 11.42, "min": 15.04, "cnt": 32}, "MoE_L3_fwd":{"total": 375.67, "avg": 11.74, "max": 11.23, "min": 13.54, "cnt": 32}, "fwd-pooler":{"total": 0.36, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.62, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.16, "avg": 1.16, "max": 1.16, "min": 1.16, "cnt": 1}, "forward-send-backward-recv":{"total": 668.61, "avg": 21.57, "max": 1.89, "min": 244.78, "cnt": 31}, "backward-compute":{"total": 1740.67, "avg": 54.40, "max": 51.22, "min": 57.30, "cnt": 32}, "MoE_L3_bwd":{"total": 399.49, "avg": 12.48, "max": 11.53, "min": 13.93, "cnt": 32}, "MoE_L2_bwd":{"total": 387.80, "avg": 12.12, "max": 11.46, "min": 13.94, "cnt": 32}, "MoE_L1_bwd":{"total": 326.29, "avg": 10.20, "max": 9.65, "min": 10.74, "cnt": 32}, "MoE_L0_bwd":{"total": 414.24, "avg": 12.95, "max": 12.51, "min": 14.11, "cnt": 32}, "backward-send-forward-recv":{"total": 3915.82, "avg": 130.53, "max": 1.98, "min": 453.88, "cnt": 30}, "backward-send":{"total": 1.98, "avg": 0.99, "max": 0.95, "min": 1.03, "cnt": 2}, "backward-recv":{"total": 67.90, "avg": 67.90, "max": 67.90, "min": 67.90, "cnt": 1}, "backward-params-all-reduce":{"total": 492.90, "avg": 492.90, "max": 492.90, "min": 492.90, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 288.49, "avg": 288.49, "max": 288.49, "min": 288.49, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.41, "avg": 3.41, "max": 3.41, "min": 3.41, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 243.98, "avg": 243.98, "max": 243.98, "min": 243.98, "cnt": 1}, "optimizer-clip-main-grad":{"total": 7.23, "avg": 7.23, "max": 7.23, "min": 7.23, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.49, "avg": 3.49, "max": 3.49, "min": 3.49, "cnt": 1}}}
{"type":"time", "iteration": 33, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 139.48, "avg": 69.74, "max": 1.30, "min": 138.18, "cnt": 2}, "forward-compute":{"total": 1861.88, "avg": 58.18, "max": 53.26, "min": 65.71, "cnt": 32}, "fwd-compute":{"total": 1858.19, "avg": 58.07, "max": 53.18, "min": 65.61, "cnt": 32}, "batch-generator":{"total": 45.66, "avg": 1.43, "max": 0.85, "min": 2.71, "cnt": 32}, "fwd-embedding":{"total": 0.62, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1797.72, "avg": 56.18, "max": 51.82, "min": 64.03, "cnt": 32}, "fwd-layernorm":{"total": 11.40, "avg": 0.09, "max": 0.06, "min": 0.31, "cnt": 128}, "fwd-attn":{"total": 117.09, "avg": 0.91, "max": 0.75, "min": 2.95, "cnt": 128}, "fwd-misc":{"total": 25.16, "avg": 0.20, "max": 0.12, "min": 0.56, "cnt": 128}, "fwd-MLP":{"total": 1618.04, "avg": 12.64, "max": 10.44, "min": 22.98, "cnt": 128}, "MoE_L0_fwd":{"total": 455.51, "avg": 14.23, "max": 11.78, "min": 22.89, "cnt": 32}, "MoEMLP":{"total": 1597.54, "avg": 12.48, "max": 10.30, "min": 22.84, "cnt": 128}, "MoE_L1_fwd":{"total": 363.80, "avg": 11.37, "max": 10.35, "min": 13.65, "cnt": 32}, "MoE_L2_fwd":{"total": 408.12, "avg": 12.75, "max": 12.01, "min": 14.00, "cnt": 32}, "MoE_L3_fwd":{"total": 377.48, "avg": 11.80, "max": 11.21, "min": 16.39, "cnt": 32}, "fwd-pooler":{"total": 0.39, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.67, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.12, "avg": 1.12, "max": 1.12, "min": 1.12, "cnt": 1}, "forward-send-backward-recv":{"total": 1216.50, "avg": 39.24, "max": 1.63, "min": 256.55, "cnt": 31}, "backward-compute":{"total": 1746.34, "avg": 54.57, "max": 50.79, "min": 57.32, "cnt": 32}, "MoE_L3_bwd":{"total": 403.30, "avg": 12.60, "max": 11.51, "min": 13.72, "cnt": 32}, "MoE_L2_bwd":{"total": 389.84, "avg": 12.18, "max": 11.54, "min": 14.44, "cnt": 32}, "MoE_L1_bwd":{"total": 336.76, "avg": 10.52, "max": 10.10, "min": 11.68, "cnt": 32}, "MoE_L0_bwd":{"total": 400.13, "avg": 12.50, "max": 11.41, "min": 13.26, "cnt": 32}, "backward-send-forward-recv":{"total": 2894.96, "avg": 96.50, "max": 2.03, "min": 644.75, "cnt": 30}, "backward-send":{"total": 2.01, "avg": 1.00, "max": 0.90, "min": 1.11, "cnt": 2}, "backward-recv":{"total": 370.59, "avg": 370.59, "max": 370.59, "min": 370.59, "cnt": 1}, "backward-params-all-reduce":{"total": 488.81, "avg": 488.81, "max": 488.81, "min": 488.81, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 302.04, "avg": 302.04, "max": 302.04, "min": 302.04, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.41, "avg": 3.41, "max": 3.41, "min": 3.41, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 257.46, "avg": 257.46, "max": 257.46, "min": 257.46, "cnt": 1}, "optimizer-clip-main-grad":{"total": 7.12, "avg": 7.12, "max": 7.12, "min": 7.12, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.47, "avg": 3.47, "max": 3.47, "min": 3.47, "cnt": 1}}}
{"type":"time", "iteration": 34, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 138.51, "avg": 69.26, "max": 0.99, "min": 137.52, "cnt": 2}, "forward-compute":{"total": 1856.77, "avg": 58.02, "max": 52.58, "min": 66.12, "cnt": 32}, "fwd-compute":{"total": 1853.41, "avg": 57.92, "max": 52.49, "min": 65.95, "cnt": 32}, "batch-generator":{"total": 52.09, "avg": 1.63, "max": 0.83, "min": 3.13, "cnt": 32}, "fwd-embedding":{"total": 0.64, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1786.25, "avg": 55.82, "max": 51.13, "min": 63.50, "cnt": 32}, "fwd-layernorm":{"total": 11.36, "avg": 0.09, "max": 0.06, "min": 0.23, "cnt": 128}, "fwd-attn":{"total": 115.30, "avg": 0.90, "max": 0.75, "min": 1.78, "cnt": 128}, "fwd-misc":{"total": 25.00, "avg": 0.20, "max": 0.13, "min": 0.43, "cnt": 128}, "fwd-MLP":{"total": 1608.80, "avg": 12.57, "max": 10.34, "min": 18.03, "cnt": 128}, "MoE_L0_fwd":{"total": 442.60, "avg": 13.83, "max": 10.90, "min": 17.92, "cnt": 32}, "MoEMLP":{"total": 1588.32, "avg": 12.41, "max": 10.20, "min": 17.86, "cnt": 128}, "MoE_L1_fwd":{"total": 363.73, "avg": 11.37, "max": 10.25, "min": 12.82, "cnt": 32}, "MoE_L2_fwd":{"total": 414.07, "avg": 12.94, "max": 11.55, "min": 16.08, "cnt": 32}, "MoE_L3_fwd":{"total": 375.45, "avg": 11.73, "max": 11.27, "min": 14.49, "cnt": 32}, "fwd-pooler":{"total": 0.39, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.69, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.12, "avg": 1.12, "max": 1.12, "min": 1.12, "cnt": 1}, "forward-send-backward-recv":{"total": 234.83, "avg": 7.58, "max": 1.29, "min": 86.61, "cnt": 31}, "backward-compute":{"total": 1724.85, "avg": 53.90, "max": 51.36, "min": 55.86, "cnt": 32}, "MoE_L3_bwd":{"total": 401.15, "avg": 12.54, "max": 12.01, "min": 14.58, "cnt": 32}, "MoE_L2_bwd":{"total": 384.56, "avg": 12.02, "max": 11.11, "min": 14.17, "cnt": 32}, "MoE_L1_bwd":{"total": 342.70, "avg": 10.71, "max": 10.14, "min": 11.94, "cnt": 32}, "MoE_L0_bwd":{"total": 379.32, "avg": 11.85, "max": 10.10, "min": 12.50, "cnt": 32}, "backward-send-forward-recv":{"total": 3658.23, "avg": 121.94, "max": 1.96, "min": 367.08, "cnt": 30}, "backward-send":{"total": 1.97, "avg": 0.99, "max": 0.89, "min": 1.08, "cnt": 2}, "backward-recv":{"total": 67.91, "avg": 67.91, "max": 67.91, "min": 67.91, "cnt": 1}, "backward-params-all-reduce":{"total": 491.90, "avg": 491.90, "max": 491.90, "min": 491.90, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 291.77, "avg": 291.77, "max": 291.77, "min": 291.77, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 247.61, "avg": 247.61, "max": 247.61, "min": 247.61, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.82, "avg": 6.82, "max": 6.82, "min": 6.82, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.51, "avg": 3.51, "max": 3.51, "min": 3.51, "cnt": 1}}}
{"type":"time", "iteration": 35, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 124.62, "avg": 62.31, "max": 1.17, "min": 123.44, "cnt": 2}, "forward-compute":{"total": 1832.75, "avg": 57.27, "max": 52.17, "min": 66.51, "cnt": 32}, "fwd-compute":{"total": 1829.47, "avg": 57.17, "max": 52.09, "min": 66.34, "cnt": 32}, "batch-generator":{"total": 43.76, "avg": 1.37, "max": 0.76, "min": 2.81, "cnt": 32}, "fwd-embedding":{"total": 0.60, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1772.52, "avg": 55.39, "max": 50.77, "min": 63.58, "cnt": 32}, "fwd-layernorm":{"total": 10.56, "avg": 0.08, "max": 0.06, "min": 0.22, "cnt": 128}, "fwd-attn":{"total": 109.78, "avg": 0.86, "max": 0.75, "min": 1.66, "cnt": 128}, "fwd-misc":{"total": 22.38, "avg": 0.17, "max": 0.12, "min": 0.42, "cnt": 128}, "fwd-MLP":{"total": 1605.82, "avg": 12.55, "max": 10.29, "min": 19.81, "cnt": 128}, "MoE_L0_fwd":{"total": 455.87, "avg": 14.25, "max": 11.22, "min": 19.71, "cnt": 32}, "MoEMLP":{"total": 1587.50, "avg": 12.40, "max": 10.16, "min": 19.65, "cnt": 128}, "MoE_L1_fwd":{"total": 361.13, "avg": 11.29, "max": 10.21, "min": 12.70, "cnt": 32}, "MoE_L2_fwd":{"total": 404.73, "avg": 12.65, "max": 11.37, "min": 15.54, "cnt": 32}, "MoE_L3_fwd":{"total": 372.43, "avg": 11.64, "max": 11.25, "min": 12.85, "cnt": 32}, "fwd-pooler":{"total": 0.37, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.61, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 0.99, "avg": 0.99, "max": 0.99, "min": 0.99, "cnt": 1}, "forward-send-backward-recv":{"total": 465.28, "avg": 15.01, "max": 1.48, "min": 194.72, "cnt": 31}, "backward-compute":{"total": 1722.20, "avg": 53.82, "max": 51.47, "min": 55.44, "cnt": 32}, "MoE_L3_bwd":{"total": 399.28, "avg": 12.48, "max": 11.90, "min": 13.58, "cnt": 32}, "MoE_L2_bwd":{"total": 379.72, "avg": 11.87, "max": 11.07, "min": 13.14, "cnt": 32}, "MoE_L1_bwd":{"total": 333.80, "avg": 10.43, "max": 10.04, "min": 10.96, "cnt": 32}, "MoE_L0_bwd":{"total": 387.43, "avg": 12.11, "max": 11.32, "min": 13.38, "cnt": 32}, "backward-send-forward-recv":{"total": 4498.50, "avg": 149.95, "max": 2.13, "min": 517.02, "cnt": 30}, "backward-send":{"total": 2.00, "avg": 1.00, "max": 0.85, "min": 1.15, "cnt": 2}, "backward-recv":{"total": 75.10, "avg": 75.10, "max": 75.10, "min": 75.10, "cnt": 1}, "backward-params-all-reduce":{"total": 491.15, "avg": 491.15, "max": 491.15, "min": 491.15, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.04, "avg": 0.04, "max": 0.04, "min": 0.04, "cnt": 1}, "optimizer":{"total": 299.17, "avg": 299.17, "max": 299.17, "min": 299.17, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 254.98, "avg": 254.98, "max": 254.98, "min": 254.98, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.78, "avg": 6.78, "max": 6.78, "min": 6.78, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.48, "avg": 3.48, "max": 3.48, "min": 3.48, "cnt": 1}}}
{"type":"time", "iteration": 36, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 126.25, "avg": 63.13, "max": 3.76, "min": 122.49, "cnt": 2}, "forward-compute":{"total": 1868.78, "avg": 58.40, "max": 53.68, "min": 65.11, "cnt": 32}, "fwd-compute":{"total": 1865.11, "avg": 58.28, "max": 53.59, "min": 64.75, "cnt": 32}, "batch-generator":{"total": 47.21, "avg": 1.48, "max": 0.72, "min": 2.88, "cnt": 32}, "fwd-embedding":{"total": 0.64, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1804.00, "avg": 56.38, "max": 52.36, "min": 61.33, "cnt": 32}, "fwd-layernorm":{"total": 10.97, "avg": 0.09, "max": 0.06, "min": 0.24, "cnt": 128}, "fwd-attn":{"total": 112.14, "avg": 0.88, "max": 0.75, "min": 1.93, "cnt": 128}, "fwd-misc":{"total": 23.23, "avg": 0.18, "max": 0.12, "min": 0.41, "cnt": 128}, "fwd-MLP":{"total": 1633.27, "avg": 12.76, "max": 10.30, "min": 18.54, "cnt": 128}, "MoE_L0_fwd":{"total": 461.91, "avg": 14.43, "max": 11.22, "min": 18.46, "cnt": 32}, "MoEMLP":{"total": 1614.35, "avg": 12.61, "max": 10.17, "min": 18.41, "cnt": 128}, "MoE_L1_fwd":{"total": 365.05, "avg": 11.41, "max": 10.21, "min": 14.59, "cnt": 32}, "MoE_L2_fwd":{"total": 412.18, "avg": 12.88, "max": 12.15, "min": 14.86, "cnt": 32}, "MoE_L3_fwd":{"total": 382.06, "avg": 11.94, "max": 11.19, "min": 14.64, "cnt": 32}, "fwd-pooler":{"total": 0.38, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.65, "avg": 0.02, "max": 0.02, "min": 0.04, "cnt": 32}, "forward-send":{"total": 0.84, "avg": 0.84, "max": 0.84, "min": 0.84, "cnt": 1}, "forward-send-backward-recv":{"total": 659.04, "avg": 21.26, "max": 1.34, "min": 295.33, "cnt": 31}, "backward-compute":{"total": 1733.48, "avg": 54.17, "max": 51.76, "min": 56.57, "cnt": 32}, "MoE_L3_bwd":{"total": 399.62, "avg": 12.49, "max": 11.69, "min": 13.80, "cnt": 32}, "MoE_L2_bwd":{"total": 392.50, "avg": 12.27, "max": 11.44, "min": 14.19, "cnt": 32}, "MoE_L1_bwd":{"total": 334.40, "avg": 10.45, "max": 10.08, "min": 10.95, "cnt": 32}, "MoE_L0_bwd":{"total": 394.79, "avg": 12.34, "max": 11.68, "min": 13.97, "cnt": 32}, "backward-send-forward-recv":{"total": 3634.63, "avg": 121.15, "max": 2.16, "min": 422.69, "cnt": 30}, "backward-send":{"total": 2.07, "avg": 1.04, "max": 1.01, "min": 1.06, "cnt": 2}, "backward-recv":{"total": 244.26, "avg": 244.26, "max": 244.26, "min": 244.26, "cnt": 1}, "backward-params-all-reduce":{"total": 487.12, "avg": 487.12, "max": 487.12, "min": 487.12, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 307.10, "avg": 307.10, "max": 307.10, "min": 307.10, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 262.84, "avg": 262.84, "max": 262.84, "min": 262.84, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.90, "avg": 6.90, "max": 6.90, "min": 6.90, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.48, "avg": 3.48, "max": 3.48, "min": 3.48, "cnt": 1}}}
{"type":"time", "iteration": 37, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 131.87, "avg": 65.93, "max": 1.64, "min": 130.23, "cnt": 2}, "forward-compute":{"total": 1844.40, "avg": 57.64, "max": 51.66, "min": 71.36, "cnt": 32}, "fwd-compute":{"total": 1840.99, "avg": 57.53, "max": 51.58, "min": 71.28, "cnt": 32}, "batch-generator":{"total": 51.29, "avg": 1.60, "max": 0.72, "min": 4.13, "cnt": 32}, "fwd-embedding":{"total": 0.68, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1776.17, "avg": 55.51, "max": 50.38, "min": 69.36, "cnt": 32}, "fwd-layernorm":{"total": 11.13, "avg": 0.09, "max": 0.06, "min": 0.24, "cnt": 128}, "fwd-attn":{"total": 111.72, "avg": 0.87, "max": 0.75, "min": 2.55, "cnt": 128}, "fwd-misc":{"total": 23.45, "avg": 0.18, "max": 0.12, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1605.72, "avg": 12.54, "max": 10.16, "min": 23.60, "cnt": 128}, "MoE_L0_fwd":{"total": 452.56, "avg": 14.14, "max": 11.25, "min": 23.52, "cnt": 32}, "MoEMLP":{"total": 1586.68, "avg": 12.40, "max": 10.03, "min": 23.47, "cnt": 128}, "MoE_L1_fwd":{"total": 357.32, "avg": 11.17, "max": 10.08, "min": 13.51, "cnt": 32}, "MoE_L2_fwd":{"total": 411.32, "avg": 12.85, "max": 11.96, "min": 15.98, "cnt": 32}, "MoE_L3_fwd":{"total": 372.33, "avg": 11.64, "max": 11.04, "min": 14.06, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.63, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 0.94, "avg": 0.94, "max": 0.94, "min": 0.94, "cnt": 1}, "forward-send-backward-recv":{"total": 1857.58, "avg": 59.92, "max": 1.84, "min": 287.93, "cnt": 31}, "backward-compute":{"total": 1724.47, "avg": 53.89, "max": 50.79, "min": 56.64, "cnt": 32}, "MoE_L3_bwd":{"total": 397.34, "avg": 12.42, "max": 11.72, "min": 12.96, "cnt": 32}, "MoE_L2_bwd":{"total": 382.49, "avg": 11.95, "max": 11.14, "min": 12.97, "cnt": 32}, "MoE_L1_bwd":{"total": 333.04, "avg": 10.41, "max": 9.93, "min": 11.59, "cnt": 32}, "MoE_L0_bwd":{"total": 396.01, "avg": 12.38, "max": 11.41, "min": 15.12, "cnt": 32}, "backward-send-forward-recv":{"total": 2575.57, "avg": 85.85, "max": 2.16, "min": 560.43, "cnt": 30}, "backward-send":{"total": 1.96, "avg": 0.98, "max": 0.98, "min": 0.98, "cnt": 2}, "backward-recv":{"total": 69.94, "avg": 69.94, "max": 69.94, "min": 69.94, "cnt": 1}, "backward-params-all-reduce":{"total": 496.15, "avg": 496.15, "max": 496.15, "min": 496.15, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 306.12, "avg": 306.12, "max": 306.12, "min": 306.12, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 253.54, "avg": 253.54, "max": 253.54, "min": 253.54, "cnt": 1}, "optimizer-clip-main-grad":{"total": 11.07, "avg": 11.07, "max": 11.07, "min": 11.07, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.54, "avg": 3.54, "max": 3.54, "min": 3.54, "cnt": 1}}}
{"type":"time", "iteration": 38, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.13, "avg": 0.13, "max": 0.13, "min": 0.13, "cnt": 1}, "forward-recv":{"total": 127.18, "avg": 63.59, "max": 0.86, "min": 126.31, "cnt": 2}, "forward-compute":{"total": 1842.81, "avg": 57.59, "max": 51.23, "min": 66.49, "cnt": 32}, "fwd-compute":{"total": 1839.36, "avg": 57.48, "max": 51.15, "min": 66.40, "cnt": 32}, "batch-generator":{"total": 42.27, "avg": 1.32, "max": 0.75, "min": 3.54, "cnt": 32}, "fwd-embedding":{"total": 0.56, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1783.16, "avg": 55.72, "max": 50.06, "min": 64.54, "cnt": 32}, "fwd-layernorm":{"total": 10.91, "avg": 0.09, "max": 0.06, "min": 0.22, "cnt": 128}, "fwd-attn":{"total": 111.08, "avg": 0.87, "max": 0.75, "min": 1.84, "cnt": 128}, "fwd-misc":{"total": 23.73, "avg": 0.19, "max": 0.12, "min": 0.60, "cnt": 128}, "fwd-MLP":{"total": 1611.93, "avg": 12.59, "max": 10.23, "min": 18.13, "cnt": 128}, "MoE_L0_fwd":{"total": 459.70, "avg": 14.37, "max": 11.07, "min": 17.99, "cnt": 32}, "MoEMLP":{"total": 1592.61, "avg": 12.44, "max": 10.11, "min": 17.92, "cnt": 128}, "MoE_L1_fwd":{"total": 365.86, "avg": 11.43, "max": 10.15, "min": 15.23, "cnt": 32}, "MoE_L2_fwd":{"total": 402.48, "avg": 12.58, "max": 11.89, "min": 15.25, "cnt": 32}, "MoE_L3_fwd":{"total": 371.57, "avg": 11.61, "max": 11.15, "min": 14.34, "cnt": 32}, "fwd-pooler":{"total": 0.38, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.70, "avg": 0.02, "max": 0.02, "min": 0.06, "cnt": 32}, "forward-send":{"total": 1.16, "avg": 1.16, "max": 1.16, "min": 1.16, "cnt": 1}, "forward-send-backward-recv":{"total": 186.29, "avg": 6.01, "max": 1.31, "min": 81.33, "cnt": 31}, "backward-compute":{"total": 1713.85, "avg": 53.56, "max": 50.12, "min": 55.40, "cnt": 32}, "MoE_L3_bwd":{"total": 398.52, "avg": 12.45, "max": 11.48, "min": 14.06, "cnt": 32}, "MoE_L2_bwd":{"total": 373.74, "avg": 11.68, "max": 10.83, "min": 12.57, "cnt": 32}, "MoE_L1_bwd":{"total": 328.13, "avg": 10.25, "max": 9.59, "min": 10.58, "cnt": 32}, "MoE_L0_bwd":{"total": 392.19, "avg": 12.26, "max": 11.73, "min": 13.34, "cnt": 32}, "backward-send-forward-recv":{"total": 3681.96, "avg": 122.73, "max": 2.13, "min": 309.99, "cnt": 30}, "backward-send":{"total": 2.10, "avg": 1.05, "max": 0.95, "min": 1.15, "cnt": 2}, "backward-recv":{"total": 73.74, "avg": 73.74, "max": 73.74, "min": 73.74, "cnt": 1}, "backward-params-all-reduce":{"total": 488.07, "avg": 488.07, "max": 488.07, "min": 488.07, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 371.83, "avg": 371.83, "max": 371.83, "min": 371.83, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 326.48, "avg": 326.48, "max": 326.48, "min": 326.48, "cnt": 1}, "optimizer-clip-main-grad":{"total": 9.04, "avg": 9.04, "max": 9.04, "min": 9.04, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.52, "avg": 3.52, "max": 3.52, "min": 3.52, "cnt": 1}}}
{"type":"time", "iteration": 39, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 129.16, "avg": 64.58, "max": 1.32, "min": 127.84, "cnt": 2}, "forward-compute":{"total": 1884.52, "avg": 58.89, "max": 51.14, "min": 66.57, "cnt": 32}, "fwd-compute":{"total": 1880.78, "avg": 58.77, "max": 51.06, "min": 66.44, "cnt": 32}, "batch-generator":{"total": 53.03, "avg": 1.66, "max": 0.77, "min": 4.19, "cnt": 32}, "fwd-embedding":{"total": 0.69, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1813.57, "avg": 56.67, "max": 49.94, "min": 64.50, "cnt": 32}, "fwd-layernorm":{"total": 12.45, "avg": 0.10, "max": 0.06, "min": 1.08, "cnt": 128}, "fwd-attn":{"total": 116.06, "avg": 0.91, "max": 0.75, "min": 2.47, "cnt": 128}, "fwd-misc":{"total": 24.41, "avg": 0.19, "max": 0.11, "min": 0.48, "cnt": 128}, "fwd-MLP":{"total": 1635.48, "avg": 12.78, "max": 10.30, "min": 21.87, "cnt": 128}, "MoE_L0_fwd":{"total": 480.66, "avg": 15.02, "max": 11.12, "min": 21.71, "cnt": 32}, "MoEMLP":{"total": 1616.10, "avg": 12.63, "max": 10.18, "min": 21.63, "cnt": 128}, "MoE_L1_fwd":{"total": 360.98, "avg": 11.28, "max": 10.22, "min": 13.99, "cnt": 32}, "MoE_L2_fwd":{"total": 410.66, "avg": 12.83, "max": 12.00, "min": 15.31, "cnt": 32}, "MoE_L3_fwd":{"total": 370.70, "avg": 11.58, "max": 11.12, "min": 15.17, "cnt": 32}, "fwd-pooler":{"total": 0.36, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.61, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 0.98, "avg": 0.98, "max": 0.98, "min": 0.98, "cnt": 1}, "forward-send-backward-recv":{"total": 1548.00, "avg": 49.94, "max": 1.39, "min": 273.76, "cnt": 31}, "backward-compute":{"total": 1727.86, "avg": 54.00, "max": 51.12, "min": 55.52, "cnt": 32}, "MoE_L3_bwd":{"total": 401.74, "avg": 12.55, "max": 12.11, "min": 13.39, "cnt": 32}, "MoE_L2_bwd":{"total": 381.69, "avg": 11.93, "max": 11.18, "min": 12.57, "cnt": 32}, "MoE_L1_bwd":{"total": 333.27, "avg": 10.41, "max": 9.96, "min": 11.53, "cnt": 32}, "MoE_L0_bwd":{"total": 389.31, "avg": 12.17, "max": 11.20, "min": 12.66, "cnt": 32}, "backward-send-forward-recv":{"total": 3648.69, "avg": 121.62, "max": 1.86, "min": 1139.33, "cnt": 30}, "backward-send":{"total": 2.03, "avg": 1.02, "max": 0.89, "min": 1.14, "cnt": 2}, "backward-recv":{"total": 142.26, "avg": 142.26, "max": 142.26, "min": 142.26, "cnt": 1}, "backward-params-all-reduce":{"total": 484.98, "avg": 484.98, "max": 484.98, "min": 484.98, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 316.41, "avg": 316.41, "max": 316.41, "min": 316.41, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 262.84, "avg": 262.84, "max": 262.84, "min": 262.84, "cnt": 1}, "optimizer-clip-main-grad":{"total": 7.10, "avg": 7.10, "max": 7.10, "min": 7.10, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.51, "avg": 3.51, "max": 3.51, "min": 3.51, "cnt": 1}}}
{"type":"time", "iteration": 40, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 437.37, "avg": 218.68, "max": 1.43, "min": 435.94, "cnt": 2}, "forward-compute":{"total": 1889.84, "avg": 59.06, "max": 53.11, "min": 65.02, "cnt": 32}, "fwd-compute":{"total": 1886.13, "avg": 58.94, "max": 53.01, "min": 64.92, "cnt": 32}, "batch-generator":{"total": 49.33, "avg": 1.54, "max": 0.74, "min": 2.55, "cnt": 32}, "fwd-embedding":{"total": 0.75, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1822.78, "avg": 56.96, "max": 51.22, "min": 63.61, "cnt": 32}, "fwd-layernorm":{"total": 11.53, "avg": 0.09, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 113.58, "avg": 0.89, "max": 0.75, "min": 1.55, "cnt": 128}, "fwd-misc":{"total": 23.79, "avg": 0.19, "max": 0.12, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1648.78, "avg": 12.88, "max": 10.30, "min": 19.31, "cnt": 128}, "MoE_L0_fwd":{"total": 485.04, "avg": 15.16, "max": 11.19, "min": 19.18, "cnt": 32}, "MoEMLP":{"total": 1629.53, "avg": 12.73, "max": 10.16, "min": 19.10, "cnt": 128}, "MoE_L1_fwd":{"total": 360.04, "avg": 11.25, "max": 10.21, "min": 12.90, "cnt": 32}, "MoE_L2_fwd":{"total": 419.04, "avg": 13.10, "max": 12.35, "min": 14.68, "cnt": 32}, "MoE_L3_fwd":{"total": 372.30, "avg": 11.63, "max": 11.05, "min": 13.98, "cnt": 32}, "fwd-pooler":{"total": 0.38, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.63, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.02, "avg": 1.02, "max": 1.02, "min": 1.02, "cnt": 1}, "forward-send-backward-recv":{"total": 3453.23, "avg": 111.39, "max": 1.40, "min": 476.36, "cnt": 31}, "backward-compute":{"total": 1754.94, "avg": 54.84, "max": 51.57, "min": 58.44, "cnt": 32}, "MoE_L3_bwd":{"total": 417.56, "avg": 13.05, "max": 12.07, "min": 17.17, "cnt": 32}, "MoE_L2_bwd":{"total": 398.39, "avg": 12.45, "max": 11.60, "min": 13.76, "cnt": 32}, "MoE_L1_bwd":{"total": 328.53, "avg": 10.27, "max": 9.66, "min": 10.61, "cnt": 32}, "MoE_L0_bwd":{"total": 391.76, "avg": 12.24, "max": 11.60, "min": 14.69, "cnt": 32}, "backward-send-forward-recv":{"total": 2579.72, "avg": 85.99, "max": 1.86, "min": 473.72, "cnt": 30}, "backward-send":{"total": 1.99, "avg": 0.99, "max": 0.86, "min": 1.12, "cnt": 2}, "backward-recv":{"total": 393.46, "avg": 393.46, "max": 393.46, "min": 393.46, "cnt": 1}, "backward-params-all-reduce":{"total": 489.37, "avg": 489.37, "max": 489.37, "min": 489.37, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 295.39, "avg": 295.39, "max": 295.39, "min": 295.39, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 250.73, "avg": 250.73, "max": 250.73, "min": 250.73, "cnt": 1}, "optimizer-clip-main-grad":{"total": 7.23, "avg": 7.23, "max": 7.23, "min": 7.23, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.50, "avg": 3.50, "max": 3.50, "min": 3.50, "cnt": 1}}}
{"type":"time", "iteration": 41, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.10, "avg": 0.10, "max": 0.10, "min": 0.10, "cnt": 1}, "forward-recv":{"total": 127.10, "avg": 63.55, "max": 1.29, "min": 125.82, "cnt": 2}, "forward-compute":{"total": 1861.46, "avg": 58.17, "max": 52.72, "min": 63.48, "cnt": 32}, "fwd-compute":{"total": 1857.93, "avg": 58.06, "max": 52.62, "min": 63.38, "cnt": 32}, "batch-generator":{"total": 47.33, "avg": 1.48, "max": 0.82, "min": 4.05, "cnt": 32}, "fwd-embedding":{"total": 0.67, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1795.77, "avg": 56.12, "max": 51.19, "min": 60.63, "cnt": 32}, "fwd-layernorm":{"total": 11.43, "avg": 0.09, "max": 0.06, "min": 0.24, "cnt": 128}, "fwd-attn":{"total": 116.04, "avg": 0.91, "max": 0.75, "min": 1.87, "cnt": 128}, "fwd-misc":{"total": 24.23, "avg": 0.19, "max": 0.12, "min": 0.43, "cnt": 128}, "fwd-MLP":{"total": 1618.37, "avg": 12.64, "max": 10.55, "min": 17.25, "cnt": 128}, "MoE_L0_fwd":{"total": 439.05, "avg": 13.72, "max": 10.98, "min": 17.17, "cnt": 32}, "MoEMLP":{"total": 1598.52, "avg": 12.49, "max": 10.41, "min": 17.12, "cnt": 128}, "MoE_L1_fwd":{"total": 365.05, "avg": 11.41, "max": 10.46, "min": 13.58, "cnt": 32}, "MoE_L2_fwd":{"total": 427.77, "avg": 13.37, "max": 12.54, "min": 14.99, "cnt": 32}, "MoE_L3_fwd":{"total": 373.71, "avg": 11.68, "max": 11.09, "min": 17.04, "cnt": 32}, "fwd-pooler":{"total": 0.38, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.65, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.17, "avg": 1.17, "max": 1.17, "min": 1.17, "cnt": 1}, "forward-send-backward-recv":{"total": 1381.02, "avg": 44.55, "max": 1.30, "min": 306.45, "cnt": 31}, "backward-compute":{"total": 1744.38, "avg": 54.51, "max": 51.86, "min": 56.12, "cnt": 32}, "MoE_L3_bwd":{"total": 399.70, "avg": 12.49, "max": 11.47, "min": 14.39, "cnt": 32}, "MoE_L2_bwd":{"total": 409.94, "avg": 12.81, "max": 11.66, "min": 13.84, "cnt": 32}, "MoE_L1_bwd":{"total": 333.11, "avg": 10.41, "max": 9.93, "min": 11.05, "cnt": 32}, "MoE_L0_bwd":{"total": 384.14, "avg": 12.00, "max": 11.22, "min": 12.78, "cnt": 32}, "backward-send-forward-recv":{"total": 3057.83, "avg": 101.93, "max": 2.06, "min": 507.08, "cnt": 30}, "backward-send":{"total": 2.03, "avg": 1.01, "max": 0.96, "min": 1.07, "cnt": 2}, "backward-recv":{"total": 71.88, "avg": 71.88, "max": 71.88, "min": 71.88, "cnt": 1}, "backward-params-all-reduce":{"total": 487.89, "avg": 487.89, "max": 487.89, "min": 487.89, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.04, "avg": 0.04, "max": 0.04, "min": 0.04, "cnt": 1}, "optimizer":{"total": 297.63, "avg": 297.63, "max": 297.63, "min": 297.63, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 253.27, "avg": 253.27, "max": 253.27, "min": 253.27, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.84, "avg": 6.84, "max": 6.84, "min": 6.84, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.48, "avg": 3.48, "max": 3.48, "min": 3.48, "cnt": 1}}}
{"type":"time", "iteration": 42, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 133.03, "avg": 66.52, "max": 5.01, "min": 128.02, "cnt": 2}, "forward-compute":{"total": 1852.69, "avg": 57.90, "max": 51.83, "min": 64.03, "cnt": 32}, "fwd-compute":{"total": 1849.19, "avg": 57.79, "max": 51.74, "min": 63.94, "cnt": 32}, "batch-generator":{"total": 44.03, "avg": 1.38, "max": 0.80, "min": 2.40, "cnt": 32}, "fwd-embedding":{"total": 0.56, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1791.75, "avg": 55.99, "max": 50.49, "min": 62.32, "cnt": 32}, "fwd-layernorm":{"total": 10.32, "avg": 0.08, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 108.31, "avg": 0.85, "max": 0.75, "min": 1.54, "cnt": 128}, "fwd-misc":{"total": 23.13, "avg": 0.18, "max": 0.12, "min": 0.52, "cnt": 128}, "fwd-MLP":{"total": 1625.61, "avg": 12.70, "max": 10.37, "min": 20.97, "cnt": 128}, "MoE_L0_fwd":{"total": 466.18, "avg": 14.57, "max": 10.90, "min": 20.87, "cnt": 32}, "MoEMLP":{"total": 1607.58, "avg": 12.56, "max": 10.26, "min": 20.83, "cnt": 128}, "MoE_L1_fwd":{"total": 371.34, "avg": 11.60, "max": 10.30, "min": 14.06, "cnt": 32}, "MoE_L2_fwd":{"total": 400.71, "avg": 12.52, "max": 10.95, "min": 13.77, "cnt": 32}, "MoE_L3_fwd":{"total": 375.88, "avg": 11.75, "max": 11.18, "min": 14.12, "cnt": 32}, "fwd-pooler":{"total": 0.36, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.62, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 0.89, "avg": 0.89, "max": 0.89, "min": 0.89, "cnt": 1}, "forward-send-backward-recv":{"total": 730.94, "avg": 23.58, "max": 1.87, "min": 204.74, "cnt": 31}, "backward-compute":{"total": 1723.82, "avg": 53.87, "max": 51.44, "min": 56.87, "cnt": 32}, "MoE_L3_bwd":{"total": 396.09, "avg": 12.38, "max": 11.74, "min": 13.04, "cnt": 32}, "MoE_L2_bwd":{"total": 393.98, "avg": 12.31, "max": 11.28, "min": 15.19, "cnt": 32}, "MoE_L1_bwd":{"total": 340.65, "avg": 10.65, "max": 9.93, "min": 11.59, "cnt": 32}, "MoE_L0_bwd":{"total": 375.20, "avg": 11.73, "max": 10.67, "min": 12.67, "cnt": 32}, "backward-send-forward-recv":{"total": 4429.99, "avg": 147.67, "max": 2.03, "min": 799.44, "cnt": 30}, "backward-send":{"total": 1.99, "avg": 0.99, "max": 0.96, "min": 1.03, "cnt": 2}, "backward-recv":{"total": 74.53, "avg": 74.53, "max": 74.53, "min": 74.53, "cnt": 1}, "backward-params-all-reduce":{"total": 493.09, "avg": 493.09, "max": 493.09, "min": 493.09, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 291.30, "avg": 291.30, "max": 291.30, "min": 291.30, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.40, "avg": 3.40, "max": 3.40, "min": 3.40, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 247.13, "avg": 247.13, "max": 247.13, "min": 247.13, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.82, "avg": 6.82, "max": 6.82, "min": 6.82, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 43, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 137.03, "avg": 68.52, "max": 6.68, "min": 130.36, "cnt": 2}, "forward-compute":{"total": 1880.98, "avg": 58.78, "max": 52.42, "min": 67.01, "cnt": 32}, "fwd-compute":{"total": 1876.75, "avg": 58.65, "max": 52.34, "min": 66.89, "cnt": 32}, "batch-generator":{"total": 44.99, "avg": 1.41, "max": 0.80, "min": 3.18, "cnt": 32}, "fwd-embedding":{"total": 0.63, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1817.58, "avg": 56.80, "max": 51.16, "min": 65.02, "cnt": 32}, "fwd-layernorm":{"total": 10.61, "avg": 0.08, "max": 0.06, "min": 0.29, "cnt": 128}, "fwd-attn":{"total": 110.52, "avg": 0.86, "max": 0.75, "min": 2.34, "cnt": 128}, "fwd-misc":{"total": 23.69, "avg": 0.19, "max": 0.11, "min": 0.80, "cnt": 128}, "fwd-MLP":{"total": 1648.43, "avg": 12.88, "max": 10.64, "min": 23.79, "cnt": 128}, "MoE_L0_fwd":{"total": 483.33, "avg": 15.10, "max": 11.27, "min": 23.68, "cnt": 32}, "MoEMLP":{"total": 1629.69, "avg": 12.73, "max": 10.50, "min": 23.62, "cnt": 128}, "MoE_L1_fwd":{"total": 378.16, "avg": 11.82, "max": 10.55, "min": 14.83, "cnt": 32}, "MoE_L2_fwd":{"total": 390.69, "avg": 12.21, "max": 10.92, "min": 13.81, "cnt": 32}, "MoE_L3_fwd":{"total": 384.34, "avg": 12.01, "max": 11.30, "min": 16.17, "cnt": 32}, "fwd-pooler":{"total": 0.39, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.75, "avg": 0.02, "max": 0.02, "min": 0.10, "cnt": 32}, "forward-send":{"total": 0.66, "avg": 0.66, "max": 0.66, "min": 0.66, "cnt": 1}, "forward-send-backward-recv":{"total": 219.40, "avg": 7.08, "max": 1.40, "min": 55.59, "cnt": 31}, "backward-compute":{"total": 1715.76, "avg": 53.62, "max": 51.21, "min": 55.50, "cnt": 32}, "MoE_L3_bwd":{"total": 398.02, "avg": 12.44, "max": 11.28, "min": 14.49, "cnt": 32}, "MoE_L2_bwd":{"total": 383.43, "avg": 11.98, "max": 11.09, "min": 13.24, "cnt": 32}, "MoE_L1_bwd":{"total": 337.58, "avg": 10.55, "max": 9.72, "min": 11.61, "cnt": 32}, "MoE_L0_bwd":{"total": 379.71, "avg": 11.87, "max": 11.07, "min": 12.69, "cnt": 32}, "backward-send-forward-recv":{"total": 4138.79, "avg": 137.96, "max": 1.73, "min": 719.74, "cnt": 30}, "backward-send":{"total": 2.19, "avg": 1.09, "max": 1.01, "min": 1.18, "cnt": 2}, "backward-recv":{"total": 91.48, "avg": 91.48, "max": 91.48, "min": 91.48, "cnt": 1}, "backward-params-all-reduce":{"total": 491.37, "avg": 491.37, "max": 491.37, "min": 491.37, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 303.56, "avg": 303.56, "max": 303.56, "min": 303.56, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.40, "avg": 3.40, "max": 3.40, "min": 3.40, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 259.01, "avg": 259.01, "max": 259.01, "min": 259.01, "cnt": 1}, "optimizer-clip-main-grad":{"total": 7.08, "avg": 7.08, "max": 7.08, "min": 7.08, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.47, "avg": 3.47, "max": 3.47, "min": 3.47, "cnt": 1}}}
{"type":"time", "iteration": 44, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 142.50, "avg": 71.25, "max": 7.65, "min": 134.86, "cnt": 2}, "forward-compute":{"total": 1830.04, "avg": 57.19, "max": 51.78, "min": 67.57, "cnt": 32}, "fwd-compute":{"total": 1826.81, "avg": 57.09, "max": 51.70, "min": 67.47, "cnt": 32}, "batch-generator":{"total": 40.81, "avg": 1.28, "max": 0.74, "min": 2.02, "cnt": 32}, "fwd-embedding":{"total": 0.55, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1772.50, "avg": 55.39, "max": 49.83, "min": 65.85, "cnt": 32}, "fwd-layernorm":{"total": 9.95, "avg": 0.08, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 105.84, "avg": 0.83, "max": 0.75, "min": 1.53, "cnt": 128}, "fwd-misc":{"total": 21.74, "avg": 0.17, "max": 0.12, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1611.61, "avg": 12.59, "max": 10.17, "min": 18.63, "cnt": 128}, "MoE_L0_fwd":{"total": 453.96, "avg": 14.19, "max": 11.36, "min": 18.55, "cnt": 32}, "MoEMLP":{"total": 1593.42, "avg": 12.45, "max": 10.03, "min": 18.50, "cnt": 128}, "MoE_L1_fwd":{"total": 365.47, "avg": 11.42, "max": 10.08, "min": 15.98, "cnt": 32}, "MoE_L2_fwd":{"total": 390.03, "avg": 12.19, "max": 10.87, "min": 15.59, "cnt": 32}, "MoE_L3_fwd":{"total": 390.47, "avg": 12.20, "max": 11.22, "min": 17.78, "cnt": 32}, "fwd-pooler":{"total": 0.39, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.68, "avg": 0.02, "max": 0.02, "min": 0.06, "cnt": 32}, "forward-send":{"total": 0.98, "avg": 0.98, "max": 0.98, "min": 0.98, "cnt": 1}, "forward-send-backward-recv":{"total": 183.83, "avg": 5.93, "max": 1.50, "min": 55.20, "cnt": 31}, "backward-compute":{"total": 1713.33, "avg": 53.54, "max": 50.65, "min": 54.99, "cnt": 32}, "MoE_L3_bwd":{"total": 402.34, "avg": 12.57, "max": 11.98, "min": 13.49, "cnt": 32}, "MoE_L2_bwd":{"total": 369.00, "avg": 11.53, "max": 10.86, "min": 12.51, "cnt": 32}, "MoE_L1_bwd":{"total": 330.95, "avg": 10.34, "max": 9.72, "min": 11.93, "cnt": 32}, "MoE_L0_bwd":{"total": 376.48, "avg": 11.77, "max": 10.38, "min": 12.23, "cnt": 32}, "backward-send-forward-recv":{"total": 4861.17, "avg": 162.04, "max": 2.44, "min": 1025.96, "cnt": 30}, "backward-send":{"total": 1.90, "avg": 0.95, "max": 0.94, "min": 0.96, "cnt": 2}, "backward-recv":{"total": 71.58, "avg": 71.58, "max": 71.58, "min": 71.58, "cnt": 1}, "backward-params-all-reduce":{"total": 492.45, "avg": 492.45, "max": 492.45, "min": 492.45, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 301.01, "avg": 301.01, "max": 301.01, "min": 301.01, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 256.97, "avg": 256.97, "max": 256.97, "min": 256.97, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.76, "avg": 6.76, "max": 6.76, "min": 6.76, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 45, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 137.74, "avg": 68.87, "max": 8.26, "min": 129.48, "cnt": 2}, "forward-compute":{"total": 1838.29, "avg": 57.45, "max": 51.90, "min": 65.36, "cnt": 32}, "fwd-compute":{"total": 1835.08, "avg": 57.35, "max": 51.82, "min": 65.28, "cnt": 32}, "batch-generator":{"total": 43.76, "avg": 1.37, "max": 0.78, "min": 2.41, "cnt": 32}, "fwd-embedding":{"total": 0.54, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1778.69, "avg": 55.58, "max": 50.57, "min": 62.79, "cnt": 32}, "fwd-layernorm":{"total": 9.79, "avg": 0.08, "max": 0.06, "min": 0.18, "cnt": 128}, "fwd-attn":{"total": 104.75, "avg": 0.82, "max": 0.74, "min": 1.45, "cnt": 128}, "fwd-misc":{"total": 21.34, "avg": 0.17, "max": 0.12, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1619.92, "avg": 12.66, "max": 10.76, "min": 19.09, "cnt": 128}, "MoE_L0_fwd":{"total": 454.36, "avg": 14.20, "max": 11.45, "min": 19.01, "cnt": 32}, "MoEMLP":{"total": 1602.32, "avg": 12.52, "max": 10.62, "min": 18.96, "cnt": 128}, "MoE_L1_fwd":{"total": 395.46, "avg": 12.36, "max": 10.67, "min": 16.15, "cnt": 32}, "MoE_L2_fwd":{"total": 384.61, "avg": 12.02, "max": 11.03, "min": 14.15, "cnt": 32}, "MoE_L3_fwd":{"total": 374.26, "avg": 11.70, "max": 11.12, "min": 13.17, "cnt": 32}, "fwd-pooler":{"total": 0.36, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.63, "avg": 0.02, "max": 0.02, "min": 0.04, "cnt": 32}, "forward-send":{"total": 0.75, "avg": 0.75, "max": 0.75, "min": 0.75, "cnt": 1}, "forward-send-backward-recv":{"total": 161.04, "avg": 5.19, "max": 0.99, "min": 67.32, "cnt": 31}, "backward-compute":{"total": 1739.76, "avg": 54.37, "max": 51.12, "min": 58.16, "cnt": 32}, "MoE_L3_bwd":{"total": 408.49, "avg": 12.77, "max": 11.98, "min": 15.90, "cnt": 32}, "MoE_L2_bwd":{"total": 392.00, "avg": 12.25, "max": 11.47, "min": 15.44, "cnt": 32}, "MoE_L1_bwd":{"total": 357.82, "avg": 11.18, "max": 9.67, "min": 11.99, "cnt": 32}, "MoE_L0_bwd":{"total": 366.05, "avg": 11.44, "max": 10.76, "min": 12.36, "cnt": 32}, "backward-send-forward-recv":{"total": 5210.24, "avg": 173.67, "max": 2.32, "min": 712.47, "cnt": 30}, "backward-send":{"total": 1.83, "avg": 0.92, "max": 0.89, "min": 0.94, "cnt": 2}, "backward-recv":{"total": 72.02, "avg": 72.02, "max": 72.02, "min": 72.02, "cnt": 1}, "backward-params-all-reduce":{"total": 488.39, "avg": 488.39, "max": 488.39, "min": 488.39, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 308.74, "avg": 308.74, "max": 308.74, "min": 308.74, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 264.54, "avg": 264.54, "max": 264.54, "min": 264.54, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.83, "avg": 6.83, "max": 6.83, "min": 6.83, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 46, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 129.95, "avg": 64.98, "max": 3.54, "min": 126.41, "cnt": 2}, "forward-compute":{"total": 1830.22, "avg": 57.19, "max": 51.92, "min": 61.87, "cnt": 32}, "fwd-compute":{"total": 1827.09, "avg": 57.10, "max": 51.84, "min": 61.79, "cnt": 32}, "batch-generator":{"total": 39.55, "avg": 1.24, "max": 0.73, "min": 1.89, "cnt": 32}, "fwd-embedding":{"total": 0.56, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1774.52, "avg": 55.45, "max": 50.75, "min": 60.55, "cnt": 32}, "fwd-layernorm":{"total": 10.22, "avg": 0.08, "max": 0.06, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 105.99, "avg": 0.83, "max": 0.75, "min": 1.54, "cnt": 128}, "fwd-misc":{"total": 22.21, "avg": 0.17, "max": 0.12, "min": 0.59, "cnt": 128}, "fwd-MLP":{"total": 1612.70, "avg": 12.60, "max": 11.06, "min": 19.17, "cnt": 128}, "MoE_L0_fwd":{"total": 472.51, "avg": 14.77, "max": 11.56, "min": 19.06, "cnt": 32}, "MoEMLP":{"total": 1594.68, "avg": 12.46, "max": 10.92, "min": 19.01, "cnt": 128}, "MoE_L1_fwd":{"total": 391.09, "avg": 12.22, "max": 11.08, "min": 13.62, "cnt": 32}, "MoE_L2_fwd":{"total": 366.47, "avg": 11.45, "max": 10.97, "min": 13.63, "cnt": 32}, "MoE_L3_fwd":{"total": 371.13, "avg": 11.60, "max": 11.11, "min": 12.77, "cnt": 32}, "fwd-pooler":{"total": 0.37, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.64, "avg": 0.02, "max": 0.02, "min": 0.05, "cnt": 32}, "forward-send":{"total": 0.97, "avg": 0.97, "max": 0.97, "min": 0.97, "cnt": 1}, "forward-send-backward-recv":{"total": 968.02, "avg": 31.23, "max": 1.31, "min": 121.41, "cnt": 31}, "backward-compute":{"total": 1724.68, "avg": 53.90, "max": 50.92, "min": 55.92, "cnt": 32}, "MoE_L3_bwd":{"total": 394.03, "avg": 12.31, "max": 11.59, "min": 13.51, "cnt": 32}, "MoE_L2_bwd":{"total": 385.27, "avg": 12.04, "max": 11.39, "min": 13.47, "cnt": 32}, "MoE_L1_bwd":{"total": 366.01, "avg": 11.44, "max": 11.18, "min": 12.18, "cnt": 32}, "MoE_L0_bwd":{"total": 359.62, "avg": 11.24, "max": 10.29, "min": 12.72, "cnt": 32}, "backward-send-forward-recv":{"total": 3144.24, "avg": 104.81, "max": 2.38, "min": 423.55, "cnt": 30}, "backward-send":{"total": 2.26, "avg": 1.13, "max": 0.93, "min": 1.33, "cnt": 2}, "backward-recv":{"total": 99.74, "avg": 99.74, "max": 99.74, "min": 99.74, "cnt": 1}, "backward-params-all-reduce":{"total": 490.74, "avg": 490.74, "max": 490.74, "min": 490.74, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 298.61, "avg": 298.61, "max": 298.61, "min": 298.61, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 254.28, "avg": 254.28, "max": 254.28, "min": 254.28, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.88, "avg": 6.88, "max": 6.88, "min": 6.88, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 47, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 127.80, "avg": 63.90, "max": 1.49, "min": 126.31, "cnt": 2}, "forward-compute":{"total": 1865.82, "avg": 58.31, "max": 53.17, "min": 63.66, "cnt": 32}, "fwd-compute":{"total": 1862.51, "avg": 58.20, "max": 53.09, "min": 63.56, "cnt": 32}, "batch-generator":{"total": 46.39, "avg": 1.45, "max": 0.75, "min": 2.35, "cnt": 32}, "fwd-embedding":{"total": 0.60, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1802.96, "avg": 56.34, "max": 51.96, "min": 61.87, "cnt": 32}, "fwd-layernorm":{"total": 10.11, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 107.25, "avg": 0.84, "max": 0.75, "min": 1.50, "cnt": 128}, "fwd-misc":{"total": 21.69, "avg": 0.17, "max": 0.12, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1641.04, "avg": 12.82, "max": 11.10, "min": 18.39, "cnt": 128}, "MoE_L0_fwd":{"total": 461.61, "avg": 14.43, "max": 11.66, "min": 18.29, "cnt": 32}, "MoEMLP":{"total": 1623.61, "avg": 12.68, "max": 10.97, "min": 18.25, "cnt": 128}, "MoE_L1_fwd":{"total": 427.02, "avg": 13.34, "max": 11.98, "min": 17.05, "cnt": 32}, "MoE_L2_fwd":{"total": 364.01, "avg": 11.38, "max": 11.02, "min": 12.34, "cnt": 32}, "MoE_L3_fwd":{"total": 377.37, "avg": 11.79, "max": 11.08, "min": 14.21, "cnt": 32}, "fwd-pooler":{"total": 0.37, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.61, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 0.92, "avg": 0.92, "max": 0.92, "min": 0.92, "cnt": 1}, "forward-send-backward-recv":{"total": 1025.13, "avg": 33.07, "max": 1.20, "min": 299.86, "cnt": 31}, "backward-compute":{"total": 1742.84, "avg": 54.46, "max": 52.20, "min": 55.66, "cnt": 32}, "MoE_L3_bwd":{"total": 391.37, "avg": 12.23, "max": 11.53, "min": 13.41, "cnt": 32}, "MoE_L2_bwd":{"total": 380.06, "avg": 11.88, "max": 10.96, "min": 12.54, "cnt": 32}, "MoE_L1_bwd":{"total": 394.32, "avg": 12.32, "max": 11.19, "min": 13.21, "cnt": 32}, "MoE_L0_bwd":{"total": 351.07, "avg": 10.97, "max": 10.55, "min": 11.23, "cnt": 32}, "backward-send-forward-recv":{"total": 3993.55, "avg": 133.12, "max": 2.01, "min": 663.11, "cnt": 30}, "backward-send":{"total": 2.12, "avg": 1.06, "max": 1.03, "min": 1.08, "cnt": 2}, "backward-recv":{"total": 149.88, "avg": 149.88, "max": 149.88, "min": 149.88, "cnt": 1}, "backward-params-all-reduce":{"total": 487.87, "avg": 487.87, "max": 487.87, "min": 487.87, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 296.64, "avg": 296.64, "max": 296.64, "min": 296.64, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 252.50, "avg": 252.50, "max": 252.50, "min": 252.50, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.82, "avg": 6.82, "max": 6.82, "min": 6.82, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.47, "avg": 3.47, "max": 3.47, "min": 3.47, "cnt": 1}}}
{"type":"time", "iteration": 48, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 144.53, "avg": 72.26, "max": 5.78, "min": 138.75, "cnt": 2}, "forward-compute":{"total": 1905.42, "avg": 59.54, "max": 52.23, "min": 66.71, "cnt": 32}, "fwd-compute":{"total": 1901.78, "avg": 59.43, "max": 52.15, "min": 66.59, "cnt": 32}, "batch-generator":{"total": 48.05, "avg": 1.50, "max": 0.74, "min": 2.89, "cnt": 32}, "fwd-embedding":{"total": 0.68, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1839.19, "avg": 57.47, "max": 51.00, "min": 63.41, "cnt": 32}, "fwd-layernorm":{"total": 11.21, "avg": 0.09, "max": 0.06, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 113.68, "avg": 0.89, "max": 0.75, "min": 1.79, "cnt": 128}, "fwd-misc":{"total": 23.11, "avg": 0.18, "max": 0.12, "min": 0.41, "cnt": 128}, "fwd-MLP":{"total": 1666.18, "avg": 13.02, "max": 10.79, "min": 18.64, "cnt": 128}, "MoE_L0_fwd":{"total": 486.17, "avg": 15.19, "max": 11.74, "min": 18.56, "cnt": 32}, "MoEMLP":{"total": 1647.04, "avg": 12.87, "max": 10.69, "min": 18.52, "cnt": 128}, "MoE_L1_fwd":{"total": 402.59, "avg": 12.58, "max": 11.37, "min": 13.87, "cnt": 32}, "MoE_L2_fwd":{"total": 400.64, "avg": 12.52, "max": 11.88, "min": 14.96, "cnt": 32}, "MoE_L3_fwd":{"total": 364.52, "avg": 11.39, "max": 10.73, "min": 14.94, "cnt": 32}, "fwd-pooler":{"total": 0.37, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.66, "avg": 0.02, "max": 0.02, "min": 0.05, "cnt": 32}, "forward-send":{"total": 1.00, "avg": 1.00, "max": 1.00, "min": 1.00, "cnt": 1}, "forward-send-backward-recv":{"total": 2028.94, "avg": 65.45, "max": 1.41, "min": 325.71, "cnt": 31}, "backward-compute":{"total": 1697.67, "avg": 53.05, "max": 51.62, "min": 54.88, "cnt": 32}, "MoE_L3_bwd":{"total": 397.83, "avg": 12.43, "max": 11.33, "min": 14.24, "cnt": 32}, "MoE_L2_bwd":{"total": 410.77, "avg": 12.84, "max": 11.77, "min": 13.92, "cnt": 32}, "MoE_L1_bwd":{"total": 326.42, "avg": 10.20, "max": 9.39, "min": 10.96, "cnt": 32}, "MoE_L0_bwd":{"total": 343.64, "avg": 10.74, "max": 9.91, "min": 11.62, "cnt": 32}, "backward-send-forward-recv":{"total": 3109.71, "avg": 103.66, "max": 2.15, "min": 722.95, "cnt": 30}, "backward-send":{"total": 2.22, "avg": 1.11, "max": 1.05, "min": 1.16, "cnt": 2}, "backward-recv":{"total": 208.16, "avg": 208.16, "max": 208.16, "min": 208.16, "cnt": 1}, "backward-params-all-reduce":{"total": 489.02, "avg": 489.02, "max": 489.02, "min": 489.02, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 300.58, "avg": 300.58, "max": 300.58, "min": 300.58, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 249.06, "avg": 249.06, "max": 249.06, "min": 249.06, "cnt": 1}, "optimizer-clip-main-grad":{"total": 7.38, "avg": 7.38, "max": 7.38, "min": 7.38, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.49, "avg": 3.49, "max": 3.49, "min": 3.49, "cnt": 1}}}
{"type":"time", "iteration": 49, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 119.98, "avg": 59.99, "max": 1.19, "min": 118.79, "cnt": 2}, "forward-compute":{"total": 1945.77, "avg": 60.81, "max": 52.64, "min": 70.08, "cnt": 32}, "fwd-compute":{"total": 1942.20, "avg": 60.69, "max": 52.55, "min": 69.99, "cnt": 32}, "batch-generator":{"total": 49.53, "avg": 1.55, "max": 0.76, "min": 3.16, "cnt": 32}, "fwd-embedding":{"total": 0.75, "avg": 0.02, "max": 0.01, "min": 0.06, "cnt": 32}, "fwd-encoder":{"total": 1877.96, "avg": 58.69, "max": 51.28, "min": 68.21, "cnt": 32}, "fwd-layernorm":{"total": 11.85, "avg": 0.09, "max": 0.06, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 118.46, "avg": 0.93, "max": 0.75, "min": 1.78, "cnt": 128}, "fwd-misc":{"total": 24.94, "avg": 0.19, "max": 0.12, "min": 0.42, "cnt": 128}, "fwd-MLP":{"total": 1696.40, "avg": 13.25, "max": 10.76, "min": 27.51, "cnt": 128}, "MoE_L0_fwd":{"total": 533.86, "avg": 16.68, "max": 11.50, "min": 27.36, "cnt": 32}, "MoEMLP":{"total": 1675.86, "avg": 13.09, "max": 10.64, "min": 27.30, "cnt": 128}, "MoE_L1_fwd":{"total": 399.34, "avg": 12.48, "max": 11.15, "min": 15.61, "cnt": 32}, "MoE_L2_fwd":{"total": 363.28, "avg": 11.35, "max": 10.69, "min": 13.18, "cnt": 32}, "MoE_L3_fwd":{"total": 386.90, "avg": 12.09, "max": 11.55, "min": 14.98, "cnt": 32}, "fwd-pooler":{"total": 0.39, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.64, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.00, "avg": 1.00, "max": 1.00, "min": 1.00, "cnt": 1}, "forward-send-backward-recv":{"total": 769.39, "avg": 24.82, "max": 1.26, "min": 437.43, "cnt": 31}, "backward-compute":{"total": 1712.53, "avg": 53.52, "max": 50.89, "min": 55.98, "cnt": 32}, "MoE_L3_bwd":{"total": 416.83, "avg": 13.03, "max": 12.21, "min": 15.31, "cnt": 32}, "MoE_L2_bwd":{"total": 365.29, "avg": 11.42, "max": 10.52, "min": 11.91, "cnt": 32}, "MoE_L1_bwd":{"total": 359.85, "avg": 11.25, "max": 10.87, "min": 11.65, "cnt": 32}, "MoE_L0_bwd":{"total": 356.24, "avg": 11.13, "max": 10.59, "min": 13.11, "cnt": 32}, "backward-send-forward-recv":{"total": 3407.12, "avg": 113.57, "max": 2.20, "min": 589.78, "cnt": 30}, "backward-send":{"total": 2.16, "avg": 1.08, "max": 1.06, "min": 1.10, "cnt": 2}, "backward-recv":{"total": 68.02, "avg": 68.02, "max": 68.02, "min": 68.02, "cnt": 1}, "backward-params-all-reduce":{"total": 489.67, "avg": 489.67, "max": 489.67, "min": 489.67, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 287.96, "avg": 287.96, "max": 287.96, "min": 287.96, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 247.65, "avg": 247.65, "max": 247.65, "min": 247.65, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.68, "avg": 3.68, "max": 3.68, "min": 3.68, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.48, "avg": 3.48, "max": 3.48, "min": 3.48, "cnt": 1}}}
{"type":"time", "iteration": 50, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 506.32, "avg": 253.16, "max": 1.11, "min": 505.21, "cnt": 2}, "forward-compute":{"total": 1899.37, "avg": 59.36, "max": 52.84, "min": 70.43, "cnt": 32}, "fwd-compute":{"total": 1896.00, "avg": 59.25, "max": 52.76, "min": 70.30, "cnt": 32}, "batch-generator":{"total": 42.29, "avg": 1.32, "max": 0.79, "min": 2.36, "cnt": 32}, "fwd-embedding":{"total": 0.59, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1840.01, "avg": 57.50, "max": 50.83, "min": 68.12, "cnt": 32}, "fwd-layernorm":{"total": 10.55, "avg": 0.08, "max": 0.06, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 110.06, "avg": 0.86, "max": 0.75, "min": 1.78, "cnt": 128}, "fwd-misc":{"total": 23.54, "avg": 0.18, "max": 0.12, "min": 0.50, "cnt": 128}, "fwd-MLP":{"total": 1671.73, "avg": 13.06, "max": 10.63, "min": 19.45, "cnt": 128}, "MoE_L0_fwd":{"total": 486.25, "avg": 15.20, "max": 11.17, "min": 19.37, "cnt": 32}, "MoEMLP":{"total": 1653.05, "avg": 12.91, "max": 10.51, "min": 19.32, "cnt": 128}, "MoE_L1_fwd":{"total": 409.33, "avg": 12.79, "max": 11.71, "min": 15.39, "cnt": 32}, "MoE_L2_fwd":{"total": 373.38, "avg": 11.67, "max": 10.55, "min": 18.05, "cnt": 32}, "MoE_L3_fwd":{"total": 390.93, "avg": 12.22, "max": 11.45, "min": 15.17, "cnt": 32}, "fwd-pooler":{"total": 0.37, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.65, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.03, "avg": 1.03, "max": 1.03, "min": 1.03, "cnt": 1}, "forward-send-backward-recv":{"total": 470.28, "avg": 15.17, "max": 1.32, "min": 153.49, "cnt": 31}, "backward-compute":{"total": 1679.80, "avg": 52.49, "max": 50.08, "min": 55.96, "cnt": 32}, "MoE_L3_bwd":{"total": 414.99, "avg": 12.97, "max": 12.10, "min": 15.10, "cnt": 32}, "MoE_L2_bwd":{"total": 358.72, "avg": 11.21, "max": 10.09, "min": 11.99, "cnt": 32}, "MoE_L1_bwd":{"total": 364.94, "avg": 11.40, "max": 10.53, "min": 13.75, "cnt": 32}, "MoE_L0_bwd":{"total": 323.66, "avg": 10.11, "max": 9.49, "min": 10.51, "cnt": 32}, "backward-send-forward-recv":{"total": 3347.37, "avg": 111.58, "max": 2.18, "min": 404.80, "cnt": 30}, "backward-send":{"total": 2.07, "avg": 1.04, "max": 0.97, "min": 1.10, "cnt": 2}, "backward-recv":{"total": 67.22, "avg": 67.22, "max": 67.22, "min": 67.22, "cnt": 1}, "backward-params-all-reduce":{"total": 494.47, "avg": 494.47, "max": 494.47, "min": 494.47, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 283.70, "avg": 283.70, "max": 283.70, "min": 283.70, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 243.76, "avg": 243.76, "max": 243.76, "min": 243.76, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.36, "avg": 3.36, "max": 3.36, "min": 3.36, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.48, "avg": 3.48, "max": 3.48, "min": 3.48, "cnt": 1}}}
{"type":"time", "iteration": 51, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 142.90, "avg": 71.45, "max": 10.95, "min": 131.95, "cnt": 2}, "forward-compute":{"total": 1892.37, "avg": 59.14, "max": 51.61, "min": 68.56, "cnt": 32}, "fwd-compute":{"total": 1889.11, "avg": 59.03, "max": 51.53, "min": 68.47, "cnt": 32}, "batch-generator":{"total": 47.57, "avg": 1.49, "max": 0.70, "min": 3.74, "cnt": 32}, "fwd-embedding":{"total": 0.60, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1828.25, "avg": 57.13, "max": 50.31, "min": 67.27, "cnt": 32}, "fwd-layernorm":{"total": 10.25, "avg": 0.08, "max": 0.06, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 106.61, "avg": 0.83, "max": 0.75, "min": 1.50, "cnt": 128}, "fwd-misc":{"total": 21.70, "avg": 0.17, "max": 0.12, "min": 0.40, "cnt": 128}, "fwd-MLP":{"total": 1666.22, "avg": 13.02, "max": 10.35, "min": 20.50, "cnt": 128}, "MoE_L0_fwd":{"total": 488.75, "avg": 15.27, "max": 11.30, "min": 20.42, "cnt": 32}, "MoEMLP":{"total": 1647.99, "avg": 12.87, "max": 10.23, "min": 20.37, "cnt": 128}, "MoE_L1_fwd":{"total": 419.19, "avg": 13.10, "max": 11.62, "min": 17.17, "cnt": 32}, "MoE_L2_fwd":{"total": 346.87, "avg": 10.84, "max": 10.27, "min": 11.89, "cnt": 32}, "MoE_L3_fwd":{"total": 399.69, "avg": 12.49, "max": 11.92, "min": 13.87, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.65, "avg": 0.02, "max": 0.02, "min": 0.05, "cnt": 32}, "forward-send":{"total": 0.95, "avg": 0.95, "max": 0.95, "min": 0.95, "cnt": 1}, "forward-send-backward-recv":{"total": 722.50, "avg": 23.31, "max": 1.24, "min": 185.92, "cnt": 31}, "backward-compute":{"total": 1700.98, "avg": 53.16, "max": 50.14, "min": 55.40, "cnt": 32}, "MoE_L3_bwd":{"total": 420.17, "avg": 13.13, "max": 12.21, "min": 14.90, "cnt": 32}, "MoE_L2_bwd":{"total": 349.99, "avg": 10.94, "max": 9.70, "min": 11.79, "cnt": 32}, "MoE_L1_bwd":{"total": 359.82, "avg": 11.24, "max": 10.74, "min": 13.63, "cnt": 32}, "MoE_L0_bwd":{"total": 349.09, "avg": 10.91, "max": 9.97, "min": 11.34, "cnt": 32}, "backward-send-forward-recv":{"total": 2592.46, "avg": 86.42, "max": 2.31, "min": 257.36, "cnt": 30}, "backward-send":{"total": 1.91, "avg": 0.95, "max": 0.92, "min": 0.98, "cnt": 2}, "backward-recv":{"total": 308.99, "avg": 308.99, "max": 308.99, "min": 308.99, "cnt": 1}, "backward-params-all-reduce":{"total": 490.05, "avg": 490.05, "max": 490.05, "min": 490.05, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 291.82, "avg": 291.82, "max": 291.82, "min": 291.82, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 245.94, "avg": 245.94, "max": 245.94, "min": 245.94, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.51, "avg": 3.51, "max": 3.51, "min": 3.51, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.60, "avg": 3.60, "max": 3.60, "min": 3.60, "cnt": 1}}}
{"type":"time", "iteration": 52, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 134.29, "avg": 67.14, "max": 14.29, "min": 119.99, "cnt": 2}, "forward-compute":{"total": 1910.56, "avg": 59.70, "max": 53.02, "min": 64.47, "cnt": 32}, "fwd-compute":{"total": 1906.98, "avg": 59.59, "max": 52.92, "min": 64.36, "cnt": 32}, "batch-generator":{"total": 47.14, "avg": 1.47, "max": 0.84, "min": 2.34, "cnt": 32}, "fwd-embedding":{"total": 0.68, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1845.69, "avg": 57.68, "max": 51.39, "min": 62.69, "cnt": 32}, "fwd-layernorm":{"total": 11.11, "avg": 0.09, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 113.42, "avg": 0.89, "max": 0.75, "min": 1.79, "cnt": 128}, "fwd-misc":{"total": 23.67, "avg": 0.18, "max": 0.12, "min": 0.41, "cnt": 128}, "fwd-MLP":{"total": 1672.94, "avg": 13.07, "max": 10.65, "min": 21.89, "cnt": 128}, "MoE_L0_fwd":{"total": 516.65, "avg": 16.15, "max": 11.49, "min": 21.78, "cnt": 32}, "MoEMLP":{"total": 1654.09, "avg": 12.92, "max": 10.54, "min": 21.72, "cnt": 128}, "MoE_L1_fwd":{"total": 392.88, "avg": 12.28, "max": 11.13, "min": 16.91, "cnt": 32}, "MoE_L2_fwd":{"total": 361.90, "avg": 11.31, "max": 10.58, "min": 13.14, "cnt": 32}, "MoE_L3_fwd":{"total": 389.53, "avg": 12.17, "max": 11.55, "min": 13.73, "cnt": 32}, "fwd-pooler":{"total": 0.39, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.61, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.62, "avg": 1.62, "max": 1.62, "min": 1.62, "cnt": 1}, "forward-send-backward-recv":{"total": 1253.66, "avg": 40.44, "max": 1.40, "min": 284.84, "cnt": 31}, "backward-compute":{"total": 1632.40, "avg": 51.01, "max": 48.06, "min": 54.77, "cnt": 32}, "MoE_L3_bwd":{"total": 418.55, "avg": 13.08, "max": 11.65, "min": 16.62, "cnt": 32}, "MoE_L2_bwd":{"total": 368.08, "avg": 11.50, "max": 10.89, "min": 12.56, "cnt": 32}, "MoE_L1_bwd":{"total": 308.07, "avg": 9.63, "max": 8.68, "min": 11.07, "cnt": 32}, "MoE_L0_bwd":{"total": 326.73, "avg": 10.21, "max": 9.80, "min": 11.66, "cnt": 32}, "backward-send-forward-recv":{"total": 4168.52, "avg": 138.95, "max": 2.00, "min": 947.50, "cnt": 30}, "backward-send":{"total": 2.09, "avg": 1.05, "max": 1.00, "min": 1.10, "cnt": 2}, "backward-recv":{"total": 129.08, "avg": 129.08, "max": 129.08, "min": 129.08, "cnt": 1}, "backward-params-all-reduce":{"total": 489.18, "avg": 489.18, "max": 489.18, "min": 489.18, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 283.85, "avg": 283.85, "max": 283.85, "min": 283.85, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 243.93, "avg": 243.93, "max": 243.93, "min": 243.93, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 53, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 126.39, "avg": 63.20, "max": 0.94, "min": 125.45, "cnt": 2}, "forward-compute":{"total": 1911.09, "avg": 59.72, "max": 53.37, "min": 63.90, "cnt": 32}, "fwd-compute":{"total": 1907.45, "avg": 59.61, "max": 53.29, "min": 63.80, "cnt": 32}, "batch-generator":{"total": 48.36, "avg": 1.51, "max": 0.74, "min": 3.14, "cnt": 32}, "fwd-embedding":{"total": 0.78, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1843.97, "avg": 57.62, "max": 51.26, "min": 60.86, "cnt": 32}, "fwd-layernorm":{"total": 11.67, "avg": 0.09, "max": 0.06, "min": 0.22, "cnt": 128}, "fwd-attn":{"total": 118.27, "avg": 0.92, "max": 0.75, "min": 3.14, "cnt": 128}, "fwd-misc":{"total": 24.28, "avg": 0.19, "max": 0.12, "min": 0.39, "cnt": 128}, "fwd-MLP":{"total": 1663.97, "avg": 13.00, "max": 10.86, "min": 18.47, "cnt": 128}, "MoE_L0_fwd":{"total": 483.75, "avg": 15.12, "max": 11.16, "min": 18.26, "cnt": 32}, "MoEMLP":{"total": 1644.36, "avg": 12.85, "max": 10.76, "min": 18.21, "cnt": 128}, "MoE_L1_fwd":{"total": 389.50, "avg": 12.17, "max": 10.94, "min": 15.61, "cnt": 32}, "MoE_L2_fwd":{"total": 366.58, "avg": 11.46, "max": 10.79, "min": 12.65, "cnt": 32}, "MoE_L3_fwd":{"total": 411.54, "avg": 12.86, "max": 12.29, "min": 13.73, "cnt": 32}, "fwd-pooler":{"total": 0.39, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.63, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 0.78, "avg": 0.78, "max": 0.78, "min": 0.78, "cnt": 1}, "forward-send-backward-recv":{"total": 2821.47, "avg": 91.02, "max": 1.57, "min": 376.95, "cnt": 31}, "backward-compute":{"total": 1604.66, "avg": 50.15, "max": 47.64, "min": 54.78, "cnt": 32}, "MoE_L3_bwd":{"total": 445.13, "avg": 13.91, "max": 12.63, "min": 18.05, "cnt": 32}, "MoE_L2_bwd":{"total": 346.13, "avg": 10.82, "max": 9.84, "min": 13.82, "cnt": 32}, "MoE_L1_bwd":{"total": 292.47, "avg": 9.14, "max": 8.74, "min": 9.63, "cnt": 32}, "MoE_L0_bwd":{"total": 304.05, "avg": 9.50, "max": 8.88, "min": 11.08, "cnt": 32}, "backward-send-forward-recv":{"total": 1506.41, "avg": 50.21, "max": 1.36, "min": 623.16, "cnt": 30}, "backward-send":{"total": 2.02, "avg": 1.01, "max": 0.89, "min": 1.13, "cnt": 2}, "backward-recv":{"total": 68.93, "avg": 68.93, "max": 68.93, "min": 68.93, "cnt": 1}, "backward-params-all-reduce":{"total": 489.10, "avg": 489.10, "max": 489.10, "min": 489.10, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 282.30, "avg": 282.30, "max": 282.30, "min": 282.30, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 242.41, "avg": 242.41, "max": 242.41, "min": 242.41, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.29, "avg": 3.29, "max": 3.29, "min": 3.29, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.48, "avg": 3.48, "max": 3.48, "min": 3.48, "cnt": 1}}}
{"type":"time", "iteration": 54, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 123.09, "avg": 61.54, "max": 0.87, "min": 122.21, "cnt": 2}, "forward-compute":{"total": 1809.95, "avg": 56.56, "max": 50.06, "min": 63.17, "cnt": 32}, "fwd-compute":{"total": 1806.63, "avg": 56.46, "max": 49.96, "min": 63.07, "cnt": 32}, "batch-generator":{"total": 44.83, "avg": 1.40, "max": 0.74, "min": 2.93, "cnt": 32}, "fwd-embedding":{"total": 0.62, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1746.64, "avg": 54.58, "max": 48.48, "min": 61.33, "cnt": 32}, "fwd-layernorm":{"total": 10.45, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 110.10, "avg": 0.86, "max": 0.75, "min": 1.48, "cnt": 128}, "fwd-misc":{"total": 22.02, "avg": 0.17, "max": 0.12, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1580.28, "avg": 12.35, "max": 10.54, "min": 20.16, "cnt": 128}, "MoE_L0_fwd":{"total": 469.98, "avg": 14.69, "max": 11.03, "min": 20.05, "cnt": 32}, "MoEMLP":{"total": 1562.44, "avg": 12.21, "max": 10.43, "min": 19.99, "cnt": 128}, "MoE_L1_fwd":{"total": 378.66, "avg": 11.83, "max": 10.47, "min": 15.20, "cnt": 32}, "MoE_L2_fwd":{"total": 363.69, "avg": 11.37, "max": 10.57, "min": 13.26, "cnt": 32}, "MoE_L3_fwd":{"total": 356.64, "avg": 11.15, "max": 10.56, "min": 14.61, "cnt": 32}, "fwd-pooler":{"total": 0.36, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.63, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.04, "avg": 1.04, "max": 1.04, "min": 1.04, "cnt": 1}, "forward-send-backward-recv":{"total": 245.57, "avg": 7.92, "max": 1.22, "min": 70.48, "cnt": 31}, "backward-compute":{"total": 1551.89, "avg": 48.50, "max": 45.75, "min": 50.40, "cnt": 32}, "MoE_L3_bwd":{"total": 368.80, "avg": 11.53, "max": 10.46, "min": 13.90, "cnt": 32}, "MoE_L2_bwd":{"total": 364.59, "avg": 11.39, "max": 10.37, "min": 12.32, "cnt": 32}, "MoE_L1_bwd":{"total": 295.88, "avg": 9.25, "max": 8.67, "min": 11.00, "cnt": 32}, "MoE_L0_bwd":{"total": 304.10, "avg": 9.50, "max": 8.79, "min": 10.38, "cnt": 32}, "backward-send-forward-recv":{"total": 3877.28, "avg": 129.24, "max": 2.31, "min": 429.92, "cnt": 30}, "backward-send":{"total": 2.03, "avg": 1.01, "max": 1.01, "min": 1.02, "cnt": 2}, "backward-recv":{"total": 66.34, "avg": 66.34, "max": 66.34, "min": 66.34, "cnt": 1}, "backward-params-all-reduce":{"total": 490.60, "avg": 490.60, "max": 490.60, "min": 490.60, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 284.00, "avg": 284.00, "max": 284.00, "min": 284.00, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 244.17, "avg": 244.17, "max": 244.17, "min": 244.17, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.23, "avg": 3.23, "max": 3.23, "min": 3.23, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.48, "avg": 3.48, "max": 3.48, "min": 3.48, "cnt": 1}}}
{"type":"time", "iteration": 55, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 133.78, "avg": 66.89, "max": 1.19, "min": 132.59, "cnt": 2}, "forward-compute":{"total": 1776.95, "avg": 55.53, "max": 50.20, "min": 63.57, "cnt": 32}, "fwd-compute":{"total": 1773.52, "avg": 55.42, "max": 50.11, "min": 63.45, "cnt": 32}, "batch-generator":{"total": 45.42, "avg": 1.42, "max": 0.79, "min": 2.09, "cnt": 32}, "fwd-embedding":{"total": 0.64, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1713.19, "avg": 53.54, "max": 48.79, "min": 61.31, "cnt": 32}, "fwd-layernorm":{"total": 10.98, "avg": 0.09, "max": 0.06, "min": 0.22, "cnt": 128}, "fwd-attn":{"total": 114.82, "avg": 0.90, "max": 0.75, "min": 2.46, "cnt": 128}, "fwd-misc":{"total": 23.34, "avg": 0.18, "max": 0.14, "min": 0.43, "cnt": 128}, "fwd-MLP":{"total": 1539.40, "avg": 12.03, "max": 9.88, "min": 19.04, "cnt": 128}, "MoE_L0_fwd":{"total": 458.71, "avg": 14.33, "max": 10.68, "min": 18.94, "cnt": 32}, "MoEMLP":{"total": 1520.46, "avg": 11.88, "max": 9.74, "min": 18.89, "cnt": 128}, "MoE_L1_fwd":{"total": 359.39, "avg": 11.23, "max": 10.48, "min": 12.58, "cnt": 32}, "MoE_L2_fwd":{"total": 370.10, "avg": 11.57, "max": 10.57, "min": 14.41, "cnt": 32}, "MoE_L3_fwd":{"total": 339.20, "avg": 10.60, "max": 9.79, "min": 18.92, "cnt": 32}, "fwd-pooler":{"total": 0.39, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.64, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 0.99, "avg": 0.99, "max": 0.99, "min": 0.99, "cnt": 1}, "forward-send-backward-recv":{"total": 624.08, "avg": 20.13, "max": 1.51, "min": 104.42, "cnt": 31}, "backward-compute":{"total": 1533.32, "avg": 47.92, "max": 44.84, "min": 51.29, "cnt": 32}, "MoE_L3_bwd":{"total": 329.21, "avg": 10.29, "max": 9.60, "min": 12.39, "cnt": 32}, "MoE_L2_bwd":{"total": 378.95, "avg": 11.84, "max": 10.93, "min": 15.18, "cnt": 32}, "MoE_L1_bwd":{"total": 291.01, "avg": 9.09, "max": 8.49, "min": 9.67, "cnt": 32}, "MoE_L0_bwd":{"total": 309.34, "avg": 9.67, "max": 8.75, "min": 10.72, "cnt": 32}, "backward-send-forward-recv":{"total": 3156.79, "avg": 105.23, "max": 2.27, "min": 292.89, "cnt": 30}, "backward-send":{"total": 1.82, "avg": 0.91, "max": 0.62, "min": 1.21, "cnt": 2}, "backward-recv":{"total": 153.22, "avg": 153.22, "max": 153.22, "min": 153.22, "cnt": 1}, "backward-params-all-reduce":{"total": 489.06, "avg": 489.06, "max": 489.06, "min": 489.06, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 290.55, "avg": 290.55, "max": 290.55, "min": 290.55, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.40, "avg": 3.40, "max": 3.40, "min": 3.40, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 239.56, "avg": 239.56, "max": 239.56, "min": 239.56, "cnt": 1}, "optimizer-clip-main-grad":{"total": 7.50, "avg": 7.50, "max": 7.50, "min": 7.50, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.53, "avg": 3.53, "max": 3.53, "min": 3.53, "cnt": 1}}}
{"type":"time", "iteration": 56, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.10, "avg": 0.10, "max": 0.10, "min": 0.10, "cnt": 1}, "forward-recv":{"total": 127.42, "avg": 63.71, "max": 1.78, "min": 125.64, "cnt": 2}, "forward-compute":{"total": 1845.13, "avg": 57.66, "max": 51.80, "min": 65.14, "cnt": 32}, "fwd-compute":{"total": 1840.22, "avg": 57.51, "max": 50.54, "min": 64.99, "cnt": 32}, "batch-generator":{"total": 55.79, "avg": 1.74, "max": 0.72, "min": 3.82, "cnt": 32}, "fwd-embedding":{"total": 0.68, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1769.05, "avg": 55.28, "max": 49.29, "min": 62.26, "cnt": 32}, "fwd-layernorm":{"total": 11.68, "avg": 0.09, "max": 0.06, "min": 0.23, "cnt": 128}, "fwd-attn":{"total": 116.69, "avg": 0.91, "max": 0.75, "min": 2.73, "cnt": 128}, "fwd-misc":{"total": 24.56, "avg": 0.19, "max": 0.12, "min": 0.42, "cnt": 128}, "fwd-MLP":{"total": 1590.53, "avg": 12.43, "max": 9.73, "min": 17.71, "cnt": 128}, "MoE_L0_fwd":{"total": 477.10, "avg": 14.91, "max": 11.86, "min": 17.61, "cnt": 32}, "MoEMLP":{"total": 1570.62, "avg": 12.27, "max": 9.60, "min": 17.56, "cnt": 128}, "MoE_L1_fwd":{"total": 362.81, "avg": 11.34, "max": 10.31, "min": 15.12, "cnt": 32}, "MoE_L2_fwd":{"total": 402.07, "avg": 12.56, "max": 11.11, "min": 16.69, "cnt": 32}, "MoE_L3_fwd":{"total": 336.00, "avg": 10.50, "max": 9.64, "min": 14.27, "cnt": 32}, "fwd-pooler":{"total": 0.39, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 1.79, "avg": 0.06, "max": 0.02, "min": 1.14, "cnt": 32}, "forward-send":{"total": 1.18, "avg": 1.18, "max": 1.18, "min": 1.18, "cnt": 1}, "forward-send-backward-recv":{"total": 557.49, "avg": 17.98, "max": 1.25, "min": 135.08, "cnt": 31}, "backward-compute":{"total": 1552.61, "avg": 48.52, "max": 46.32, "min": 50.35, "cnt": 32}, "MoE_L3_bwd":{"total": 326.64, "avg": 10.21, "max": 9.20, "min": 11.37, "cnt": 32}, "MoE_L2_bwd":{"total": 382.88, "avg": 11.96, "max": 11.12, "min": 12.51, "cnt": 32}, "MoE_L1_bwd":{"total": 286.57, "avg": 8.96, "max": 8.43, "min": 9.26, "cnt": 32}, "MoE_L0_bwd":{"total": 327.62, "avg": 10.24, "max": 9.71, "min": 11.76, "cnt": 32}, "backward-send-forward-recv":{"total": 3771.05, "avg": 125.70, "max": 2.14, "min": 682.04, "cnt": 30}, "backward-send":{"total": 2.35, "avg": 1.17, "max": 1.17, "min": 1.18, "cnt": 2}, "backward-recv":{"total": 128.51, "avg": 128.51, "max": 128.51, "min": 128.51, "cnt": 1}, "backward-params-all-reduce":{"total": 489.26, "avg": 489.26, "max": 489.26, "min": 489.26, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 285.96, "avg": 285.96, "max": 285.96, "min": 285.96, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 245.83, "avg": 245.83, "max": 245.83, "min": 245.83, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.56, "avg": 3.56, "max": 3.56, "min": 3.56, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 57, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 119.63, "avg": 59.81, "max": 0.71, "min": 118.92, "cnt": 2}, "forward-compute":{"total": 1853.91, "avg": 57.93, "max": 49.38, "min": 74.88, "cnt": 32}, "fwd-compute":{"total": 1850.47, "avg": 57.83, "max": 49.30, "min": 74.79, "cnt": 32}, "batch-generator":{"total": 55.06, "avg": 1.72, "max": 0.73, "min": 3.77, "cnt": 32}, "fwd-embedding":{"total": 0.67, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1781.89, "avg": 55.68, "max": 48.10, "min": 72.23, "cnt": 32}, "fwd-layernorm":{"total": 11.08, "avg": 0.09, "max": 0.06, "min": 0.24, "cnt": 128}, "fwd-attn":{"total": 110.16, "avg": 0.86, "max": 0.75, "min": 1.66, "cnt": 128}, "fwd-misc":{"total": 22.80, "avg": 0.18, "max": 0.12, "min": 0.43, "cnt": 128}, "fwd-MLP":{"total": 1613.50, "avg": 12.61, "max": 9.82, "min": 29.37, "cnt": 128}, "MoE_L0_fwd":{"total": 493.01, "avg": 15.41, "max": 11.32, "min": 29.28, "cnt": 32}, "MoEMLP":{"total": 1595.14, "avg": 12.46, "max": 9.69, "min": 29.23, "cnt": 128}, "MoE_L1_fwd":{"total": 385.76, "avg": 12.05, "max": 10.31, "min": 16.06, "cnt": 32}, "MoE_L2_fwd":{"total": 385.94, "avg": 12.06, "max": 11.25, "min": 14.76, "cnt": 32}, "MoE_L3_fwd":{"total": 337.15, "avg": 10.54, "max": 9.74, "min": 14.66, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.61, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 0.97, "avg": 0.97, "max": 0.97, "min": 0.97, "cnt": 1}, "forward-send-backward-recv":{"total": 936.79, "avg": 30.22, "max": 1.80, "min": 199.66, "cnt": 31}, "backward-compute":{"total": 1568.67, "avg": 49.02, "max": 46.14, "min": 51.30, "cnt": 32}, "MoE_L3_bwd":{"total": 326.49, "avg": 10.20, "max": 9.57, "min": 11.24, "cnt": 32}, "MoE_L2_bwd":{"total": 391.66, "avg": 12.24, "max": 11.49, "min": 14.75, "cnt": 32}, "MoE_L1_bwd":{"total": 296.84, "avg": 9.28, "max": 8.93, "min": 9.59, "cnt": 32}, "MoE_L0_bwd":{"total": 328.23, "avg": 10.26, "max": 9.58, "min": 11.76, "cnt": 32}, "backward-send-forward-recv":{"total": 4095.11, "avg": 136.50, "max": 1.63, "min": 865.67, "cnt": 30}, "backward-send":{"total": 2.12, "avg": 1.06, "max": 1.00, "min": 1.13, "cnt": 2}, "backward-recv":{"total": 77.26, "avg": 77.26, "max": 77.26, "min": 77.26, "cnt": 1}, "backward-params-all-reduce":{"total": 494.34, "avg": 494.34, "max": 494.34, "min": 494.34, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 283.68, "avg": 283.68, "max": 283.68, "min": 283.68, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.48, "avg": 3.48, "max": 3.48, "min": 3.48, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 243.64, "avg": 243.64, "max": 243.64, "min": 243.64, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.27, "avg": 3.27, "max": 3.27, "min": 3.27, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.47, "avg": 3.47, "max": 3.47, "min": 3.47, "cnt": 1}}}
{"type":"time", "iteration": 58, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 130.24, "avg": 65.12, "max": 1.21, "min": 129.03, "cnt": 2}, "forward-compute":{"total": 1841.06, "avg": 57.53, "max": 50.68, "min": 64.93, "cnt": 32}, "fwd-compute":{"total": 1837.51, "avg": 57.42, "max": 50.61, "min": 64.85, "cnt": 32}, "batch-generator":{"total": 56.27, "avg": 1.76, "max": 0.71, "min": 3.99, "cnt": 32}, "fwd-embedding":{"total": 0.70, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1767.60, "avg": 55.24, "max": 49.56, "min": 61.87, "cnt": 32}, "fwd-layernorm":{"total": 10.81, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 111.02, "avg": 0.87, "max": 0.75, "min": 1.51, "cnt": 128}, "fwd-misc":{"total": 22.95, "avg": 0.18, "max": 0.11, "min": 0.54, "cnt": 128}, "fwd-MLP":{"total": 1598.89, "avg": 12.49, "max": 9.90, "min": 20.72, "cnt": 128}, "MoE_L0_fwd":{"total": 494.64, "avg": 15.46, "max": 11.24, "min": 20.64, "cnt": 32}, "MoEMLP":{"total": 1580.65, "avg": 12.35, "max": 9.78, "min": 20.59, "cnt": 128}, "MoE_L1_fwd":{"total": 381.53, "avg": 11.92, "max": 10.53, "min": 14.26, "cnt": 32}, "MoE_L2_fwd":{"total": 378.52, "avg": 11.83, "max": 11.09, "min": 15.19, "cnt": 32}, "MoE_L3_fwd":{"total": 332.62, "avg": 10.39, "max": 9.82, "min": 12.85, "cnt": 32}, "fwd-pooler":{"total": 0.37, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.06, "avg": 1.06, "max": 1.06, "min": 1.06, "cnt": 1}, "forward-send-backward-recv":{"total": 426.97, "avg": 13.77, "max": 1.41, "min": 73.62, "cnt": 31}, "backward-compute":{"total": 1581.78, "avg": 49.43, "max": 46.33, "min": 50.95, "cnt": 32}, "MoE_L3_bwd":{"total": 329.03, "avg": 10.28, "max": 9.26, "min": 12.04, "cnt": 32}, "MoE_L2_bwd":{"total": 383.42, "avg": 11.98, "max": 11.06, "min": 13.16, "cnt": 32}, "MoE_L1_bwd":{"total": 316.15, "avg": 9.88, "max": 9.32, "min": 10.34, "cnt": 32}, "MoE_L0_bwd":{"total": 329.22, "avg": 10.29, "max": 9.72, "min": 11.14, "cnt": 32}, "backward-send-forward-recv":{"total": 4979.95, "avg": 166.00, "max": 2.10, "min": 1054.74, "cnt": 30}, "backward-send":{"total": 2.22, "avg": 1.11, "max": 1.05, "min": 1.17, "cnt": 2}, "backward-recv":{"total": 137.85, "avg": 137.85, "max": 137.85, "min": 137.85, "cnt": 1}, "backward-params-all-reduce":{"total": 495.71, "avg": 495.71, "max": 495.71, "min": 495.71, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 274.69, "avg": 274.69, "max": 274.69, "min": 274.69, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 234.66, "avg": 234.66, "max": 234.66, "min": 234.66, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.48, "avg": 3.48, "max": 3.48, "min": 3.48, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.50, "avg": 3.50, "max": 3.50, "min": 3.50, "cnt": 1}}}
{"type":"time", "iteration": 59, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 145.57, "avg": 72.79, "max": 1.05, "min": 144.52, "cnt": 2}, "forward-compute":{"total": 1792.66, "avg": 56.02, "max": 50.55, "min": 64.89, "cnt": 32}, "fwd-compute":{"total": 1789.26, "avg": 55.91, "max": 50.48, "min": 64.80, "cnt": 32}, "batch-generator":{"total": 43.84, "avg": 1.37, "max": 0.74, "min": 4.15, "cnt": 32}, "fwd-embedding":{"total": 0.63, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1732.15, "avg": 54.13, "max": 49.40, "min": 63.11, "cnt": 32}, "fwd-layernorm":{"total": 10.21, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 108.47, "avg": 0.85, "max": 0.75, "min": 1.48, "cnt": 128}, "fwd-misc":{"total": 21.99, "avg": 0.17, "max": 0.12, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1567.83, "avg": 12.25, "max": 9.77, "min": 23.30, "cnt": 128}, "MoE_L0_fwd":{"total": 479.69, "avg": 14.99, "max": 11.85, "min": 23.21, "cnt": 32}, "MoEMLP":{"total": 1550.02, "avg": 12.11, "max": 9.64, "min": 23.16, "cnt": 128}, "MoE_L1_fwd":{"total": 376.47, "avg": 11.76, "max": 10.78, "min": 13.47, "cnt": 32}, "MoE_L2_fwd":{"total": 373.39, "avg": 11.67, "max": 11.02, "min": 14.08, "cnt": 32}, "MoE_L3_fwd":{"total": 327.01, "avg": 10.22, "max": 9.69, "min": 11.79, "cnt": 32}, "fwd-pooler":{"total": 0.36, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 0.99, "avg": 0.99, "max": 0.99, "min": 0.99, "cnt": 1}, "forward-send-backward-recv":{"total": 1531.44, "avg": 49.40, "max": 1.63, "min": 202.29, "cnt": 31}, "backward-compute":{"total": 1578.64, "avg": 49.33, "max": 46.20, "min": 50.93, "cnt": 32}, "MoE_L3_bwd":{"total": 326.17, "avg": 10.19, "max": 9.40, "min": 11.59, "cnt": 32}, "MoE_L2_bwd":{"total": 379.42, "avg": 11.86, "max": 11.06, "min": 12.57, "cnt": 32}, "MoE_L1_bwd":{"total": 326.38, "avg": 10.20, "max": 9.63, "min": 10.98, "cnt": 32}, "MoE_L0_bwd":{"total": 319.69, "avg": 9.99, "max": 9.31, "min": 10.40, "cnt": 32}, "backward-send-forward-recv":{"total": 3881.52, "avg": 129.38, "max": 2.40, "min": 604.98, "cnt": 30}, "backward-send":{"total": 1.83, "avg": 0.91, "max": 0.81, "min": 1.02, "cnt": 2}, "backward-recv":{"total": 78.22, "avg": 78.22, "max": 78.22, "min": 78.22, "cnt": 1}, "backward-params-all-reduce":{"total": 487.92, "avg": 487.92, "max": 487.92, "min": 487.92, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 289.36, "avg": 289.36, "max": 289.36, "min": 289.36, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.40, "avg": 3.40, "max": 3.40, "min": 3.40, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 249.34, "avg": 249.34, "max": 249.34, "min": 249.34, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.40, "avg": 3.40, "max": 3.40, "min": 3.40, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 60, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 435.22, "avg": 217.61, "max": 0.90, "min": 434.32, "cnt": 2}, "forward-compute":{"total": 2026.70, "avg": 63.33, "max": 47.80, "min": 321.07, "cnt": 32}, "fwd-compute":{"total": 2023.27, "avg": 63.23, "max": 47.72, "min": 320.97, "cnt": 32}, "batch-generator":{"total": 49.48, "avg": 1.55, "max": 0.75, "min": 3.58, "cnt": 32}, "fwd-embedding":{"total": 0.60, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1959.90, "avg": 61.25, "max": 46.44, "min": 319.79, "cnt": 32}, "fwd-layernorm":{"total": 10.72, "avg": 0.08, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 112.84, "avg": 0.88, "max": 0.75, "min": 2.00, "cnt": 128}, "fwd-misc":{"total": 23.37, "avg": 0.18, "max": 0.12, "min": 0.42, "cnt": 128}, "fwd-MLP":{"total": 1787.90, "avg": 13.97, "max": 9.15, "min": 160.02, "cnt": 128}, "MoE_L0_fwd":{"total": 541.91, "avg": 16.93, "max": 9.07, "min": 129.94, "cnt": 32}, "MoEMLP":{"total": 1768.89, "avg": 13.82, "max": 9.02, "min": 159.90, "cnt": 128}, "MoE_L1_fwd":{"total": 518.98, "avg": 16.22, "max": 10.19, "min": 159.94, "cnt": 32}, "MoE_L2_fwd":{"total": 385.54, "avg": 12.05, "max": 11.20, "min": 15.40, "cnt": 32}, "MoE_L3_fwd":{"total": 329.40, "avg": 10.29, "max": 9.73, "min": 12.49, "cnt": 32}, "fwd-pooler":{"total": 0.40, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.69, "avg": 0.02, "max": 0.02, "min": 0.04, "cnt": 32}, "forward-send":{"total": 0.90, "avg": 0.90, "max": 0.90, "min": 0.90, "cnt": 1}, "forward-send-backward-recv":{"total": 1608.89, "avg": 51.90, "max": 1.24, "min": 1363.90, "cnt": 31}, "backward-compute":{"total": 1439.37, "avg": 44.98, "max": 43.50, "min": 45.89, "cnt": 32}, "MoE_L3_bwd":{"total": 322.98, "avg": 10.09, "max": 9.38, "min": 13.08, "cnt": 32}, "MoE_L2_bwd":{"total": 384.46, "avg": 12.01, "max": 11.32, "min": 12.50, "cnt": 32}, "MoE_L1_bwd":{"total": 278.22, "avg": 8.69, "max": 7.89, "min": 9.03, "cnt": 32}, "MoE_L0_bwd":{"total": 235.40, "avg": 7.36, "max": 6.86, "min": 8.26, "cnt": 32}, "backward-send-forward-recv":{"total": 5113.49, "avg": 170.45, "max": 2.31, "min": 934.49, "cnt": 30}, "backward-send":{"total": 2.40, "avg": 1.20, "max": 1.17, "min": 1.23, "cnt": 2}, "backward-recv":{"total": 82.31, "avg": 82.31, "max": 82.31, "min": 82.31, "cnt": 1}, "backward-params-all-reduce":{"total": 487.62, "avg": 487.62, "max": 487.62, "min": 487.62, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 289.16, "avg": 289.16, "max": 289.16, "min": 289.16, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 249.13, "avg": 249.13, "max": 249.13, "min": 249.13, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 61, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.10, "avg": 0.10, "max": 0.10, "min": 0.10, "cnt": 1}, "forward-recv":{"total": 142.05, "avg": 71.03, "max": 8.02, "min": 134.04, "cnt": 2}, "forward-compute":{"total": 1731.96, "avg": 54.12, "max": 49.06, "min": 65.35, "cnt": 32}, "fwd-compute":{"total": 1727.60, "avg": 53.99, "max": 48.14, "min": 65.26, "cnt": 32}, "batch-generator":{"total": 45.12, "avg": 1.41, "max": 0.74, "min": 2.62, "cnt": 32}, "fwd-embedding":{"total": 0.64, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1667.14, "avg": 52.10, "max": 46.93, "min": 62.47, "cnt": 32}, "fwd-layernorm":{"total": 11.06, "avg": 0.09, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 112.79, "avg": 0.88, "max": 0.75, "min": 1.79, "cnt": 128}, "fwd-misc":{"total": 23.60, "avg": 0.18, "max": 0.12, "min": 0.46, "cnt": 128}, "fwd-MLP":{"total": 1494.20, "avg": 11.67, "max": 9.83, "min": 19.89, "cnt": 128}, "MoE_L0_fwd":{"total": 409.02, "avg": 12.78, "max": 9.74, "min": 19.73, "cnt": 32}, "MoEMLP":{"total": 1474.72, "avg": 11.52, "max": 9.68, "min": 19.62, "cnt": 128}, "MoE_L1_fwd":{"total": 358.49, "avg": 11.20, "max": 10.33, "min": 12.87, "cnt": 32}, "MoE_L2_fwd":{"total": 369.25, "avg": 11.54, "max": 11.03, "min": 15.37, "cnt": 32}, "MoE_L3_fwd":{"total": 344.89, "avg": 10.78, "max": 10.08, "min": 14.85, "cnt": 32}, "fwd-pooler":{"total": 0.39, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.67, "avg": 0.02, "max": 0.02, "min": 0.06, "cnt": 32}, "forward-send":{"total": 0.45, "avg": 0.45, "max": 0.45, "min": 0.45, "cnt": 1}, "forward-send-backward-recv":{"total": 664.89, "avg": 21.45, "max": 1.45, "min": 189.05, "cnt": 31}, "backward-compute":{"total": 1429.99, "avg": 44.69, "max": 42.17, "min": 46.61, "cnt": 32}, "MoE_L3_bwd":{"total": 339.35, "avg": 10.60, "max": 9.82, "min": 12.66, "cnt": 32}, "MoE_L2_bwd":{"total": 347.23, "avg": 10.85, "max": 9.89, "min": 11.56, "cnt": 32}, "MoE_L1_bwd":{"total": 281.04, "avg": 8.78, "max": 8.29, "min": 9.15, "cnt": 32}, "MoE_L0_bwd":{"total": 239.62, "avg": 7.49, "max": 6.87, "min": 9.27, "cnt": 32}, "backward-send-forward-recv":{"total": 3116.40, "avg": 103.88, "max": 2.44, "min": 345.88, "cnt": 30}, "backward-send":{"total": 1.70, "avg": 0.85, "max": 0.77, "min": 0.93, "cnt": 2}, "backward-recv":{"total": 315.08, "avg": 315.08, "max": 315.08, "min": 315.08, "cnt": 1}, "backward-params-all-reduce":{"total": 487.79, "avg": 487.79, "max": 487.79, "min": 487.79, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 295.29, "avg": 295.29, "max": 295.29, "min": 295.29, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 255.36, "avg": 255.36, "max": 255.36, "min": 255.36, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.30, "avg": 3.30, "max": 3.30, "min": 3.30, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.49, "avg": 3.49, "max": 3.49, "min": 3.49, "cnt": 1}}}
{"type":"time", "iteration": 62, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 137.92, "avg": 68.96, "max": 6.78, "min": 131.14, "cnt": 2}, "forward-compute":{"total": 1785.28, "avg": 55.79, "max": 49.81, "min": 62.51, "cnt": 32}, "fwd-compute":{"total": 1781.66, "avg": 55.68, "max": 49.73, "min": 62.37, "cnt": 32}, "batch-generator":{"total": 47.08, "avg": 1.47, "max": 0.76, "min": 3.39, "cnt": 32}, "fwd-embedding":{"total": 0.67, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1720.09, "avg": 53.75, "max": 48.44, "min": 59.90, "cnt": 32}, "fwd-layernorm":{"total": 11.32, "avg": 0.09, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 115.70, "avg": 0.90, "max": 0.75, "min": 1.92, "cnt": 128}, "fwd-misc":{"total": 24.17, "avg": 0.19, "max": 0.12, "min": 0.46, "cnt": 128}, "fwd-MLP":{"total": 1543.36, "avg": 12.06, "max": 9.98, "min": 20.63, "cnt": 128}, "MoE_L0_fwd":{"total": 438.15, "avg": 13.69, "max": 10.06, "min": 20.52, "cnt": 32}, "MoEMLP":{"total": 1524.37, "avg": 11.91, "max": 9.85, "min": 20.48, "cnt": 128}, "MoE_L1_fwd":{"total": 360.02, "avg": 11.25, "max": 9.90, "min": 14.21, "cnt": 32}, "MoE_L2_fwd":{"total": 378.09, "avg": 11.82, "max": 11.11, "min": 15.98, "cnt": 32}, "MoE_L3_fwd":{"total": 355.06, "avg": 11.10, "max": 10.47, "min": 13.04, "cnt": 32}, "fwd-pooler":{"total": 0.40, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.64, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 0.88, "avg": 0.88, "max": 0.88, "min": 0.88, "cnt": 1}, "forward-send-backward-recv":{"total": 1901.58, "avg": 61.34, "max": 1.47, "min": 303.98, "cnt": 31}, "backward-compute":{"total": 1481.95, "avg": 46.31, "max": 44.15, "min": 48.00, "cnt": 32}, "MoE_L3_bwd":{"total": 361.29, "avg": 11.29, "max": 10.37, "min": 13.40, "cnt": 32}, "MoE_L2_bwd":{"total": 351.53, "avg": 10.99, "max": 10.16, "min": 11.89, "cnt": 32}, "MoE_L1_bwd":{"total": 274.53, "avg": 8.58, "max": 8.02, "min": 8.94, "cnt": 32}, "MoE_L0_bwd":{"total": 269.66, "avg": 8.43, "max": 7.93, "min": 8.83, "cnt": 32}, "backward-send-forward-recv":{"total": 2652.40, "avg": 88.41, "max": 1.78, "min": 545.01, "cnt": 30}, "backward-send":{"total": 1.75, "avg": 0.88, "max": 0.85, "min": 0.90, "cnt": 2}, "backward-recv":{"total": 81.48, "avg": 81.48, "max": 81.48, "min": 81.48, "cnt": 1}, "backward-params-all-reduce":{"total": 485.96, "avg": 485.96, "max": 485.96, "min": 485.96, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 289.64, "avg": 289.64, "max": 289.64, "min": 289.64, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 249.59, "avg": 249.59, "max": 249.59, "min": 249.59, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.41, "avg": 3.41, "max": 3.41, "min": 3.41, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 63, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 130.07, "avg": 65.04, "max": 4.42, "min": 125.65, "cnt": 2}, "forward-compute":{"total": 1784.85, "avg": 55.78, "max": 49.48, "min": 66.42, "cnt": 32}, "fwd-compute":{"total": 1781.27, "avg": 55.66, "max": 49.39, "min": 66.32, "cnt": 32}, "batch-generator":{"total": 47.97, "avg": 1.50, "max": 0.69, "min": 2.60, "cnt": 32}, "fwd-embedding":{"total": 0.63, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1719.04, "avg": 53.72, "max": 48.29, "min": 64.50, "cnt": 32}, "fwd-layernorm":{"total": 11.21, "avg": 0.09, "max": 0.06, "min": 0.22, "cnt": 128}, "fwd-attn":{"total": 116.33, "avg": 0.91, "max": 0.75, "min": 2.35, "cnt": 128}, "fwd-misc":{"total": 23.35, "avg": 0.18, "max": 0.12, "min": 0.46, "cnt": 128}, "fwd-MLP":{"total": 1541.92, "avg": 12.05, "max": 9.76, "min": 21.47, "cnt": 128}, "MoE_L0_fwd":{"total": 448.84, "avg": 14.03, "max": 9.91, "min": 21.27, "cnt": 32}, "MoEMLP":{"total": 1522.75, "avg": 11.90, "max": 9.61, "min": 21.13, "cnt": 128}, "MoE_L1_fwd":{"total": 364.38, "avg": 11.39, "max": 10.19, "min": 13.88, "cnt": 32}, "MoE_L2_fwd":{"total": 375.85, "avg": 11.75, "max": 11.08, "min": 13.30, "cnt": 32}, "MoE_L3_fwd":{"total": 340.63, "avg": 10.64, "max": 9.66, "min": 17.20, "cnt": 32}, "fwd-pooler":{"total": 0.38, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.64, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.25, "avg": 1.25, "max": 1.25, "min": 1.25, "cnt": 1}, "forward-send-backward-recv":{"total": 703.71, "avg": 22.70, "max": 1.65, "min": 144.77, "cnt": 31}, "backward-compute":{"total": 1442.83, "avg": 45.09, "max": 42.92, "min": 47.23, "cnt": 32}, "MoE_L3_bwd":{"total": 336.55, "avg": 10.52, "max": 9.11, "min": 12.50, "cnt": 32}, "MoE_L2_bwd":{"total": 341.61, "avg": 10.68, "max": 9.88, "min": 11.55, "cnt": 32}, "MoE_L1_bwd":{"total": 284.27, "avg": 8.88, "max": 8.57, "min": 9.12, "cnt": 32}, "MoE_L0_bwd":{"total": 253.80, "avg": 7.93, "max": 7.70, "min": 8.33, "cnt": 32}, "backward-send-forward-recv":{"total": 5077.65, "avg": 169.26, "max": 2.31, "min": 662.64, "cnt": 30}, "backward-send":{"total": 1.92, "avg": 0.96, "max": 0.96, "min": 0.97, "cnt": 2}, "backward-recv":{"total": 330.15, "avg": 330.15, "max": 330.15, "min": 330.15, "cnt": 1}, "backward-params-all-reduce":{"total": 485.99, "avg": 485.99, "max": 485.99, "min": 485.99, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 296.86, "avg": 296.86, "max": 296.86, "min": 296.86, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.40, "avg": 3.40, "max": 3.40, "min": 3.40, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 256.45, "avg": 256.45, "max": 256.45, "min": 256.45, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.60, "avg": 3.60, "max": 3.60, "min": 3.60, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.50, "avg": 3.50, "max": 3.50, "min": 3.50, "cnt": 1}}}
{"type":"time", "iteration": 64, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.12, "avg": 0.12, "max": 0.12, "min": 0.12, "cnt": 1}, "forward-recv":{"total": 139.79, "avg": 69.90, "max": 10.67, "min": 129.12, "cnt": 2}, "forward-compute":{"total": 1754.92, "avg": 54.84, "max": 47.44, "min": 63.64, "cnt": 32}, "fwd-compute":{"total": 1751.50, "avg": 54.73, "max": 47.36, "min": 63.53, "cnt": 32}, "batch-generator":{"total": 45.42, "avg": 1.42, "max": 0.76, "min": 2.75, "cnt": 32}, "fwd-embedding":{"total": 0.57, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1691.73, "avg": 52.87, "max": 46.26, "min": 61.93, "cnt": 32}, "fwd-layernorm":{"total": 10.92, "avg": 0.09, "max": 0.06, "min": 0.33, "cnt": 128}, "fwd-attn":{"total": 113.05, "avg": 0.88, "max": 0.75, "min": 2.72, "cnt": 128}, "fwd-misc":{"total": 23.34, "avg": 0.18, "max": 0.11, "min": 0.50, "cnt": 128}, "fwd-MLP":{"total": 1519.11, "avg": 11.87, "max": 9.59, "min": 19.49, "cnt": 128}, "MoE_L0_fwd":{"total": 427.94, "avg": 13.37, "max": 9.48, "min": 19.30, "cnt": 32}, "MoEMLP":{"total": 1500.26, "avg": 11.72, "max": 9.43, "min": 19.20, "cnt": 128}, "MoE_L1_fwd":{"total": 366.69, "avg": 11.46, "max": 10.02, "min": 13.27, "cnt": 32}, "MoE_L2_fwd":{"total": 379.85, "avg": 11.87, "max": 11.06, "min": 14.71, "cnt": 32}, "MoE_L3_fwd":{"total": 332.42, "avg": 10.39, "max": 9.79, "min": 11.96, "cnt": 32}, "fwd-pooler":{"total": 0.37, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.64, "avg": 0.02, "max": 0.02, "min": 0.06, "cnt": 32}, "forward-send":{"total": 1.01, "avg": 1.01, "max": 1.01, "min": 1.01, "cnt": 1}, "forward-send-backward-recv":{"total": 833.19, "avg": 26.88, "max": 0.94, "min": 170.43, "cnt": 31}, "backward-compute":{"total": 1468.35, "avg": 45.89, "max": 44.10, "min": 48.95, "cnt": 32}, "MoE_L3_bwd":{"total": 351.04, "avg": 10.97, "max": 9.28, "min": 14.30, "cnt": 32}, "MoE_L2_bwd":{"total": 351.96, "avg": 11.00, "max": 10.13, "min": 11.66, "cnt": 32}, "MoE_L1_bwd":{"total": 282.64, "avg": 8.83, "max": 8.37, "min": 9.32, "cnt": 32}, "MoE_L0_bwd":{"total": 246.03, "avg": 7.69, "max": 7.14, "min": 8.02, "cnt": 32}, "backward-send-forward-recv":{"total": 4232.07, "avg": 141.07, "max": 1.49, "min": 744.16, "cnt": 30}, "backward-send":{"total": 2.23, "avg": 1.11, "max": 1.06, "min": 1.17, "cnt": 2}, "backward-recv":{"total": 120.41, "avg": 120.41, "max": 120.41, "min": 120.41, "cnt": 1}, "backward-params-all-reduce":{"total": 488.44, "avg": 488.44, "max": 488.44, "min": 488.44, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "optimizer":{"total": 352.86, "avg": 352.86, "max": 352.86, "min": 352.86, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.41, "avg": 3.41, "max": 3.41, "min": 3.41, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 272.27, "avg": 272.27, "max": 272.27, "min": 272.27, "cnt": 1}, "optimizer-clip-main-grad":{"total": 41.96, "avg": 41.96, "max": 41.96, "min": 41.96, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.54, "avg": 3.54, "max": 3.54, "min": 3.54, "cnt": 1}}}
{"type":"time", "iteration": 65, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.10, "avg": 0.10, "max": 0.10, "min": 0.10, "cnt": 1}, "forward-recv":{"total": 120.19, "avg": 60.09, "max": 5.31, "min": 114.87, "cnt": 2}, "forward-compute":{"total": 1695.05, "avg": 52.97, "max": 46.86, "min": 61.58, "cnt": 32}, "fwd-compute":{"total": 1691.83, "avg": 52.87, "max": 46.77, "min": 61.39, "cnt": 32}, "batch-generator":{"total": 40.44, "avg": 1.26, "max": 0.81, "min": 3.24, "cnt": 32}, "fwd-embedding":{"total": 0.49, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1638.33, "avg": 51.20, "max": 45.50, "min": 58.79, "cnt": 32}, "fwd-layernorm":{"total": 9.90, "avg": 0.08, "max": 0.06, "min": 0.32, "cnt": 128}, "fwd-attn":{"total": 107.69, "avg": 0.84, "max": 0.75, "min": 4.52, "cnt": 128}, "fwd-misc":{"total": 21.25, "avg": 0.17, "max": 0.12, "min": 0.49, "cnt": 128}, "fwd-MLP":{"total": 1473.98, "avg": 11.52, "max": 9.55, "min": 19.22, "cnt": 128}, "MoE_L0_fwd":{"total": 404.94, "avg": 12.65, "max": 9.47, "min": 19.13, "cnt": 32}, "MoEMLP":{"total": 1454.50, "avg": 11.36, "max": 9.43, "min": 19.08, "cnt": 128}, "MoE_L1_fwd":{"total": 360.06, "avg": 11.25, "max": 10.17, "min": 13.10, "cnt": 32}, "MoE_L2_fwd":{"total": 356.62, "avg": 11.14, "max": 10.32, "min": 12.99, "cnt": 32}, "MoE_L3_fwd":{"total": 339.05, "avg": 10.60, "max": 9.75, "min": 12.55, "cnt": 32}, "fwd-pooler":{"total": 0.36, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.61, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 0.48, "avg": 0.48, "max": 0.48, "min": 0.48, "cnt": 1}, "forward-send-backward-recv":{"total": 319.62, "avg": 10.31, "max": 1.27, "min": 160.55, "cnt": 31}, "backward-compute":{"total": 1455.79, "avg": 45.49, "max": 43.69, "min": 46.47, "cnt": 32}, "MoE_L3_bwd":{"total": 352.67, "avg": 11.02, "max": 10.15, "min": 11.96, "cnt": 32}, "MoE_L2_bwd":{"total": 342.62, "avg": 10.71, "max": 9.63, "min": 11.85, "cnt": 32}, "MoE_L1_bwd":{"total": 284.90, "avg": 8.90, "max": 8.42, "min": 9.23, "cnt": 32}, "MoE_L0_bwd":{"total": 250.56, "avg": 7.83, "max": 7.26, "min": 8.12, "cnt": 32}, "backward-send-forward-recv":{"total": 4004.70, "avg": 133.49, "max": 2.58, "min": 850.93, "cnt": 30}, "backward-send":{"total": 1.93, "avg": 0.96, "max": 0.90, "min": 1.02, "cnt": 2}, "backward-recv":{"total": 126.15, "avg": 126.15, "max": 126.15, "min": 126.15, "cnt": 1}, "backward-params-all-reduce":{"total": 522.11, "avg": 522.11, "max": 522.11, "min": 522.11, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 281.74, "avg": 281.74, "max": 281.74, "min": 281.74, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.40, "avg": 3.40, "max": 3.40, "min": 3.40, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 241.98, "avg": 241.98, "max": 241.98, "min": 241.98, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.27, "avg": 3.27, "max": 3.27, "min": 3.27, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 66, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.10, "avg": 0.10, "max": 0.10, "min": 0.10, "cnt": 1}, "forward-recv":{"total": 141.19, "avg": 70.59, "max": 1.09, "min": 140.10, "cnt": 2}, "forward-compute":{"total": 1749.80, "avg": 54.68, "max": 48.68, "min": 61.59, "cnt": 32}, "fwd-compute":{"total": 1746.59, "avg": 54.58, "max": 48.59, "min": 61.43, "cnt": 32}, "batch-generator":{"total": 43.64, "avg": 1.36, "max": 0.79, "min": 2.86, "cnt": 32}, "fwd-embedding":{"total": 0.59, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1689.53, "avg": 52.80, "max": 47.26, "min": 59.62, "cnt": 32}, "fwd-layernorm":{"total": 10.20, "avg": 0.08, "max": 0.06, "min": 0.24, "cnt": 128}, "fwd-attn":{"total": 106.94, "avg": 0.84, "max": 0.75, "min": 1.89, "cnt": 128}, "fwd-misc":{"total": 21.83, "avg": 0.17, "max": 0.12, "min": 0.43, "cnt": 128}, "fwd-MLP":{"total": 1526.98, "avg": 11.93, "max": 9.98, "min": 19.53, "cnt": 128}, "MoE_L0_fwd":{"total": 428.60, "avg": 13.39, "max": 9.90, "min": 19.44, "cnt": 32}, "MoEMLP":{"total": 1508.91, "avg": 11.79, "max": 9.85, "min": 19.39, "cnt": 128}, "MoE_L1_fwd":{"total": 365.58, "avg": 11.42, "max": 10.31, "min": 13.93, "cnt": 32}, "MoE_L2_fwd":{"total": 349.32, "avg": 10.92, "max": 10.16, "min": 11.68, "cnt": 32}, "MoE_L3_fwd":{"total": 371.87, "avg": 11.62, "max": 10.67, "min": 14.59, "cnt": 32}, "fwd-pooler":{"total": 0.39, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.67, "avg": 0.02, "max": 0.02, "min": 0.05, "cnt": 32}, "forward-send":{"total": 1.01, "avg": 1.01, "max": 1.01, "min": 1.01, "cnt": 1}, "forward-send-backward-recv":{"total": 196.57, "avg": 6.34, "max": 1.36, "min": 54.99, "cnt": 31}, "backward-compute":{"total": 1460.90, "avg": 45.65, "max": 43.68, "min": 47.18, "cnt": 32}, "MoE_L3_bwd":{"total": 378.30, "avg": 11.82, "max": 10.88, "min": 13.72, "cnt": 32}, "MoE_L2_bwd":{"total": 320.79, "avg": 10.02, "max": 9.36, "min": 10.77, "cnt": 32}, "MoE_L1_bwd":{"total": 285.18, "avg": 8.91, "max": 8.33, "min": 9.20, "cnt": 32}, "MoE_L0_bwd":{"total": 251.85, "avg": 7.87, "max": 7.23, "min": 8.80, "cnt": 32}, "backward-send-forward-recv":{"total": 3422.59, "avg": 114.09, "max": 2.53, "min": 395.39, "cnt": 30}, "backward-send":{"total": 2.29, "avg": 1.14, "max": 1.11, "min": 1.18, "cnt": 2}, "backward-recv":{"total": 76.55, "avg": 76.55, "max": 76.55, "min": 76.55, "cnt": 1}, "backward-params-all-reduce":{"total": 489.17, "avg": 489.17, "max": 489.17, "min": 489.17, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 289.36, "avg": 289.36, "max": 289.36, "min": 289.36, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 249.24, "avg": 249.24, "max": 249.24, "min": 249.24, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.49, "avg": 3.49, "max": 3.49, "min": 3.49, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.51, "avg": 3.51, "max": 3.51, "min": 3.51, "cnt": 1}}}
{"type":"time", "iteration": 67, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 123.43, "avg": 61.71, "max": 1.12, "min": 122.31, "cnt": 2}, "forward-compute":{"total": 1805.62, "avg": 56.43, "max": 49.72, "min": 64.65, "cnt": 32}, "fwd-compute":{"total": 1802.05, "avg": 56.31, "max": 49.63, "min": 64.54, "cnt": 32}, "batch-generator":{"total": 43.12, "avg": 1.35, "max": 0.80, "min": 1.93, "cnt": 32}, "fwd-embedding":{"total": 0.71, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1743.83, "avg": 54.49, "max": 48.46, "min": 63.16, "cnt": 32}, "fwd-layernorm":{"total": 11.34, "avg": 0.09, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 111.76, "avg": 0.87, "max": 0.75, "min": 1.51, "cnt": 128}, "fwd-misc":{"total": 23.80, "avg": 0.19, "max": 0.12, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1571.41, "avg": 12.28, "max": 10.14, "min": 19.45, "cnt": 128}, "MoE_L0_fwd":{"total": 440.64, "avg": 13.77, "max": 10.04, "min": 19.37, "cnt": 32}, "MoEMLP":{"total": 1552.01, "avg": 12.13, "max": 9.98, "min": 19.32, "cnt": 128}, "MoE_L1_fwd":{"total": 364.93, "avg": 11.40, "max": 10.15, "min": 13.38, "cnt": 32}, "MoE_L2_fwd":{"total": 351.19, "avg": 10.97, "max": 10.36, "min": 13.30, "cnt": 32}, "MoE_L3_fwd":{"total": 402.34, "avg": 12.57, "max": 11.95, "min": 17.85, "cnt": 32}, "fwd-pooler":{"total": 0.38, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.66, "avg": 0.02, "max": 0.02, "min": 0.06, "cnt": 32}, "forward-send":{"total": 0.97, "avg": 0.97, "max": 0.97, "min": 0.97, "cnt": 1}, "forward-send-backward-recv":{"total": 1682.85, "avg": 54.29, "max": 1.38, "min": 348.65, "cnt": 31}, "backward-compute":{"total": 1502.83, "avg": 46.96, "max": 45.09, "min": 49.75, "cnt": 32}, "MoE_L3_bwd":{"total": 428.47, "avg": 13.39, "max": 12.54, "min": 16.30, "cnt": 32}, "MoE_L2_bwd":{"total": 321.44, "avg": 10.04, "max": 9.23, "min": 11.16, "cnt": 32}, "MoE_L1_bwd":{"total": 284.84, "avg": 8.90, "max": 8.25, "min": 9.19, "cnt": 32}, "MoE_L0_bwd":{"total": 251.85, "avg": 7.87, "max": 7.65, "min": 8.20, "cnt": 32}, "backward-send-forward-recv":{"total": 1340.28, "avg": 44.68, "max": 1.45, "min": 317.81, "cnt": 30}, "backward-send":{"total": 2.10, "avg": 1.05, "max": 0.93, "min": 1.17, "cnt": 2}, "backward-recv":{"total": 229.47, "avg": 229.47, "max": 229.47, "min": 229.47, "cnt": 1}, "backward-params-all-reduce":{"total": 490.63, "avg": 490.63, "max": 490.63, "min": 490.63, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 292.98, "avg": 292.98, "max": 292.98, "min": 292.98, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 252.65, "avg": 252.65, "max": 252.65, "min": 252.65, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.71, "avg": 3.71, "max": 3.71, "min": 3.71, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.51, "avg": 3.51, "max": 3.51, "min": 3.51, "cnt": 1}}}
{"type":"time", "iteration": 68, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 136.38, "avg": 68.19, "max": 2.26, "min": 134.12, "cnt": 2}, "forward-compute":{"total": 1755.71, "avg": 54.87, "max": 49.65, "min": 73.08, "cnt": 32}, "fwd-compute":{"total": 1752.49, "avg": 54.77, "max": 49.57, "min": 72.97, "cnt": 32}, "batch-generator":{"total": 45.74, "avg": 1.43, "max": 0.76, "min": 4.58, "cnt": 32}, "fwd-embedding":{"total": 0.53, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1693.36, "avg": 52.92, "max": 48.28, "min": 67.99, "cnt": 32}, "fwd-layernorm":{"total": 10.24, "avg": 0.08, "max": 0.06, "min": 0.23, "cnt": 128}, "fwd-attn":{"total": 107.12, "avg": 0.84, "max": 0.75, "min": 1.80, "cnt": 128}, "fwd-misc":{"total": 22.11, "avg": 0.17, "max": 0.12, "min": 0.43, "cnt": 128}, "fwd-MLP":{"total": 1529.83, "avg": 11.95, "max": 9.69, "min": 27.09, "cnt": 128}, "MoE_L0_fwd":{"total": 418.26, "avg": 13.07, "max": 9.60, "min": 26.99, "cnt": 32}, "MoEMLP":{"total": 1511.72, "avg": 11.81, "max": 9.55, "min": 26.94, "cnt": 128}, "MoE_L1_fwd":{"total": 359.67, "avg": 11.24, "max": 10.06, "min": 14.39, "cnt": 32}, "MoE_L2_fwd":{"total": 348.31, "avg": 10.88, "max": 10.39, "min": 11.87, "cnt": 32}, "MoE_L3_fwd":{"total": 392.07, "avg": 12.25, "max": 11.59, "min": 14.78, "cnt": 32}, "fwd-pooler":{"total": 0.37, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.64, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 0.96, "avg": 0.96, "max": 0.96, "min": 0.96, "cnt": 1}, "forward-send-backward-recv":{"total": 169.27, "avg": 5.46, "max": 1.33, "min": 66.43, "cnt": 31}, "backward-compute":{"total": 1504.85, "avg": 47.03, "max": 44.99, "min": 49.96, "cnt": 32}, "MoE_L3_bwd":{"total": 419.57, "avg": 13.11, "max": 12.07, "min": 15.48, "cnt": 32}, "MoE_L2_bwd":{"total": 323.53, "avg": 10.11, "max": 9.49, "min": 10.67, "cnt": 32}, "MoE_L1_bwd":{"total": 286.32, "avg": 8.95, "max": 8.31, "min": 9.37, "cnt": 32}, "MoE_L0_bwd":{"total": 249.74, "avg": 7.80, "max": 7.22, "min": 8.39, "cnt": 32}, "backward-send-forward-recv":{"total": 4163.54, "avg": 138.78, "max": 2.12, "min": 949.07, "cnt": 30}, "backward-send":{"total": 1.98, "avg": 0.99, "max": 0.98, "min": 1.00, "cnt": 2}, "backward-recv":{"total": 71.37, "avg": 71.37, "max": 71.37, "min": 71.37, "cnt": 1}, "backward-params-all-reduce":{"total": 490.65, "avg": 490.65, "max": 490.65, "min": 490.65, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 287.85, "avg": 287.85, "max": 287.85, "min": 287.85, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.40, "avg": 3.40, "max": 3.40, "min": 3.40, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 247.84, "avg": 247.84, "max": 247.84, "min": 247.84, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.54, "avg": 3.54, "max": 3.54, "min": 3.54, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.48, "avg": 3.48, "max": 3.48, "min": 3.48, "cnt": 1}}}
{"type":"time", "iteration": 69, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 141.73, "avg": 70.87, "max": 1.41, "min": 140.32, "cnt": 2}, "forward-compute":{"total": 1782.02, "avg": 55.69, "max": 49.74, "min": 61.11, "cnt": 32}, "fwd-compute":{"total": 1778.73, "avg": 55.59, "max": 49.64, "min": 61.02, "cnt": 32}, "batch-generator":{"total": 48.53, "avg": 1.52, "max": 0.73, "min": 3.03, "cnt": 32}, "fwd-embedding":{"total": 0.57, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1716.45, "avg": 53.64, "max": 48.01, "min": 59.07, "cnt": 32}, "fwd-layernorm":{"total": 10.72, "avg": 0.08, "max": 0.06, "min": 0.24, "cnt": 128}, "fwd-attn":{"total": 109.73, "avg": 0.86, "max": 0.75, "min": 1.63, "cnt": 128}, "fwd-misc":{"total": 22.80, "avg": 0.18, "max": 0.12, "min": 0.44, "cnt": 128}, "fwd-MLP":{"total": 1548.73, "avg": 12.10, "max": 9.97, "min": 18.90, "cnt": 128}, "MoE_L0_fwd":{"total": 420.81, "avg": 13.15, "max": 9.86, "min": 18.79, "cnt": 32}, "MoEMLP":{"total": 1529.77, "avg": 11.95, "max": 9.80, "min": 18.74, "cnt": 128}, "MoE_L1_fwd":{"total": 363.60, "avg": 11.36, "max": 10.35, "min": 13.90, "cnt": 32}, "MoE_L2_fwd":{"total": 352.19, "avg": 11.01, "max": 10.48, "min": 14.38, "cnt": 32}, "MoE_L3_fwd":{"total": 400.05, "avg": 12.50, "max": 11.50, "min": 17.10, "cnt": 32}, "fwd-pooler":{"total": 0.39, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.66, "avg": 0.02, "max": 0.02, "min": 0.04, "cnt": 32}, "forward-send":{"total": 1.01, "avg": 1.01, "max": 1.01, "min": 1.01, "cnt": 1}, "forward-send-backward-recv":{"total": 159.54, "avg": 5.15, "max": 1.39, "min": 65.83, "cnt": 31}, "backward-compute":{"total": 1504.81, "avg": 47.03, "max": 45.13, "min": 48.96, "cnt": 32}, "MoE_L3_bwd":{"total": 413.65, "avg": 12.93, "max": 12.02, "min": 15.02, "cnt": 32}, "MoE_L2_bwd":{"total": 334.45, "avg": 10.45, "max": 9.76, "min": 11.80, "cnt": 32}, "MoE_L1_bwd":{"total": 289.14, "avg": 9.04, "max": 8.52, "min": 9.58, "cnt": 32}, "MoE_L0_bwd":{"total": 246.96, "avg": 7.72, "max": 6.78, "min": 8.14, "cnt": 32}, "backward-send-forward-recv":{"total": 4005.68, "avg": 133.52, "max": 2.21, "min": 433.09, "cnt": 30}, "backward-send":{"total": 2.21, "avg": 1.10, "max": 1.06, "min": 1.14, "cnt": 2}, "backward-recv":{"total": 68.84, "avg": 68.84, "max": 68.84, "min": 68.84, "cnt": 1}, "backward-params-all-reduce":{"total": 487.39, "avg": 487.39, "max": 487.39, "min": 487.39, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 290.44, "avg": 290.44, "max": 290.44, "min": 290.44, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 250.56, "avg": 250.56, "max": 250.56, "min": 250.56, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.36, "avg": 3.36, "max": 3.36, "min": 3.36, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 70, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 559.65, "avg": 279.82, "max": 1.18, "min": 558.47, "cnt": 2}, "forward-compute":{"total": 1968.76, "avg": 61.52, "max": 49.76, "min": 209.86, "cnt": 32}, "fwd-compute":{"total": 1965.19, "avg": 61.41, "max": 49.67, "min": 209.73, "cnt": 32}, "batch-generator":{"total": 46.60, "avg": 1.46, "max": 0.77, "min": 2.08, "cnt": 32}, "fwd-embedding":{"total": 0.73, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1904.56, "avg": 59.52, "max": 47.64, "min": 208.58, "cnt": 32}, "fwd-layernorm":{"total": 11.55, "avg": 0.09, "max": 0.06, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 115.15, "avg": 0.90, "max": 0.75, "min": 1.72, "cnt": 128}, "fwd-misc":{"total": 24.16, "avg": 0.19, "max": 0.12, "min": 0.43, "cnt": 128}, "fwd-MLP":{"total": 1727.47, "avg": 13.50, "max": 9.45, "min": 153.07, "cnt": 128}, "MoE_L0_fwd":{"total": 463.43, "avg": 14.48, "max": 9.37, "min": 21.74, "cnt": 32}, "MoEMLP":{"total": 1708.07, "avg": 13.34, "max": 9.32, "min": 152.94, "cnt": 128}, "MoE_L1_fwd":{"total": 371.21, "avg": 11.60, "max": 10.49, "min": 14.75, "cnt": 32}, "MoE_L2_fwd":{"total": 484.61, "avg": 15.14, "max": 10.11, "min": 152.99, "cnt": 32}, "MoE_L3_fwd":{"total": 395.97, "avg": 12.37, "max": 11.56, "min": 20.59, "cnt": 32}, "fwd-pooler":{"total": 0.37, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.64, "avg": 0.02, "max": 0.02, "min": 0.04, "cnt": 32}, "forward-send":{"total": 0.99, "avg": 0.99, "max": 0.99, "min": 0.99, "cnt": 1}, "forward-send-backward-recv":{"total": 281.99, "avg": 9.10, "max": 1.45, "min": 76.17, "cnt": 31}, "backward-compute":{"total": 1462.01, "avg": 45.69, "max": 43.98, "min": 48.62, "cnt": 32}, "MoE_L3_bwd":{"total": 412.98, "avg": 12.91, "max": 12.26, "min": 13.77, "cnt": 32}, "MoE_L2_bwd":{"total": 298.67, "avg": 9.33, "max": 8.32, "min": 12.86, "cnt": 32}, "MoE_L1_bwd":{"total": 283.93, "avg": 8.87, "max": 8.26, "min": 9.41, "cnt": 32}, "MoE_L0_bwd":{"total": 248.55, "avg": 7.77, "max": 7.40, "min": 8.24, "cnt": 32}, "backward-send-forward-recv":{"total": 3232.72, "avg": 107.76, "max": 2.04, "min": 487.42, "cnt": 30}, "backward-send":{"total": 2.55, "avg": 1.28, "max": 1.25, "min": 1.30, "cnt": 2}, "backward-recv":{"total": 80.73, "avg": 80.73, "max": 80.73, "min": 80.73, "cnt": 1}, "backward-params-all-reduce":{"total": 493.83, "avg": 493.83, "max": 493.83, "min": 493.83, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 279.33, "avg": 279.33, "max": 279.33, "min": 279.33, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 239.58, "avg": 239.58, "max": 239.58, "min": 239.58, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.21, "avg": 3.21, "max": 3.21, "min": 3.21, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.55, "avg": 3.55, "max": 3.55, "min": 3.55, "cnt": 1}}}
{"type":"time", "iteration": 71, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 125.19, "avg": 62.60, "max": 1.08, "min": 124.12, "cnt": 2}, "forward-compute":{"total": 1771.24, "avg": 55.35, "max": 49.23, "min": 64.63, "cnt": 32}, "fwd-compute":{"total": 1768.05, "avg": 55.25, "max": 49.14, "min": 64.51, "cnt": 32}, "batch-generator":{"total": 40.82, "avg": 1.28, "max": 0.78, "min": 2.16, "cnt": 32}, "fwd-embedding":{"total": 0.56, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1713.87, "avg": 53.56, "max": 47.75, "min": 62.54, "cnt": 32}, "fwd-layernorm":{"total": 10.36, "avg": 0.08, "max": 0.06, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 109.84, "avg": 0.86, "max": 0.75, "min": 1.62, "cnt": 128}, "fwd-misc":{"total": 22.04, "avg": 0.17, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1547.67, "avg": 12.09, "max": 9.75, "min": 17.82, "cnt": 128}, "MoE_L0_fwd":{"total": 428.10, "avg": 13.38, "max": 9.67, "min": 17.72, "cnt": 32}, "MoEMLP":{"total": 1529.15, "avg": 11.95, "max": 9.62, "min": 17.66, "cnt": 128}, "MoE_L1_fwd":{"total": 360.22, "avg": 11.26, "max": 9.85, "min": 15.58, "cnt": 32}, "MoE_L2_fwd":{"total": 354.65, "avg": 11.08, "max": 10.21, "min": 15.59, "cnt": 32}, "MoE_L3_fwd":{"total": 392.82, "avg": 12.28, "max": 11.48, "min": 15.19, "cnt": 32}, "fwd-pooler":{"total": 0.37, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.62, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.03, "avg": 1.03, "max": 1.03, "min": 1.03, "cnt": 1}, "forward-send-backward-recv":{"total": 692.91, "avg": 22.35, "max": 1.32, "min": 167.42, "cnt": 31}, "backward-compute":{"total": 1476.57, "avg": 46.14, "max": 44.31, "min": 47.94, "cnt": 32}, "MoE_L3_bwd":{"total": 421.49, "avg": 13.17, "max": 12.60, "min": 14.42, "cnt": 32}, "MoE_L2_bwd":{"total": 304.54, "avg": 9.52, "max": 8.86, "min": 10.19, "cnt": 32}, "MoE_L1_bwd":{"total": 262.31, "avg": 8.20, "max": 7.71, "min": 9.48, "cnt": 32}, "MoE_L0_bwd":{"total": 262.51, "avg": 8.20, "max": 7.79, "min": 8.81, "cnt": 32}, "backward-send-forward-recv":{"total": 2652.23, "avg": 88.41, "max": 2.21, "min": 257.44, "cnt": 30}, "backward-send":{"total": 2.37, "avg": 1.19, "max": 1.16, "min": 1.21, "cnt": 2}, "backward-recv":{"total": 69.05, "avg": 69.05, "max": 69.05, "min": 69.05, "cnt": 1}, "backward-params-all-reduce":{"total": 490.82, "avg": 490.82, "max": 490.82, "min": 490.82, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 277.75, "avg": 277.75, "max": 277.75, "min": 277.75, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 237.67, "avg": 237.67, "max": 237.67, "min": 237.67, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.63, "avg": 3.63, "max": 3.63, "min": 3.63, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.52, "avg": 3.52, "max": 3.52, "min": 3.52, "cnt": 1}}}
{"type":"time", "iteration": 72, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 130.55, "avg": 65.27, "max": 1.32, "min": 129.23, "cnt": 2}, "forward-compute":{"total": 1757.22, "avg": 54.91, "max": 48.36, "min": 61.59, "cnt": 32}, "fwd-compute":{"total": 1753.99, "avg": 54.81, "max": 48.27, "min": 61.46, "cnt": 32}, "batch-generator":{"total": 43.32, "avg": 1.35, "max": 0.75, "min": 2.91, "cnt": 32}, "fwd-embedding":{"total": 0.59, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1697.86, "avg": 53.06, "max": 46.40, "min": 59.19, "cnt": 32}, "fwd-layernorm":{"total": 10.15, "avg": 0.08, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 107.54, "avg": 0.84, "max": 0.75, "min": 1.47, "cnt": 128}, "fwd-misc":{"total": 22.03, "avg": 0.17, "max": 0.12, "min": 0.67, "cnt": 128}, "fwd-MLP":{"total": 1535.45, "avg": 12.00, "max": 9.89, "min": 19.05, "cnt": 128}, "MoE_L0_fwd":{"total": 424.27, "avg": 13.26, "max": 9.80, "min": 17.95, "cnt": 32}, "MoEMLP":{"total": 1517.20, "avg": 11.85, "max": 9.76, "min": 18.93, "cnt": 128}, "MoE_L1_fwd":{"total": 360.87, "avg": 11.28, "max": 9.95, "min": 15.99, "cnt": 32}, "MoE_L2_fwd":{"total": 349.01, "avg": 10.91, "max": 9.98, "min": 14.62, "cnt": 32}, "MoE_L3_fwd":{"total": 389.55, "avg": 12.17, "max": 11.42, "min": 18.97, "cnt": 32}, "fwd-pooler":{"total": 0.36, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 0.90, "avg": 0.90, "max": 0.90, "min": 0.90, "cnt": 1}, "forward-send-backward-recv":{"total": 616.95, "avg": 19.90, "max": 1.18, "min": 158.94, "cnt": 31}, "backward-compute":{"total": 1452.53, "avg": 45.39, "max": 44.04, "min": 46.44, "cnt": 32}, "MoE_L3_bwd":{"total": 403.59, "avg": 12.61, "max": 11.54, "min": 13.90, "cnt": 32}, "MoE_L2_bwd":{"total": 304.07, "avg": 9.50, "max": 8.70, "min": 10.20, "cnt": 32}, "MoE_L1_bwd":{"total": 264.21, "avg": 8.26, "max": 7.90, "min": 8.77, "cnt": 32}, "MoE_L0_bwd":{"total": 258.20, "avg": 8.07, "max": 7.59, "min": 8.70, "cnt": 32}, "backward-send-forward-recv":{"total": 2713.22, "avg": 90.44, "max": 1.72, "min": 300.25, "cnt": 30}, "backward-send":{"total": 1.76, "avg": 0.88, "max": 0.75, "min": 1.01, "cnt": 2}, "backward-recv":{"total": 267.39, "avg": 267.39, "max": 267.39, "min": 267.39, "cnt": 1}, "backward-params-all-reduce":{"total": 489.11, "avg": 489.11, "max": 489.11, "min": 489.11, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 284.47, "avg": 284.47, "max": 284.47, "min": 284.47, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 244.63, "avg": 244.63, "max": 244.63, "min": 244.63, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 73, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 120.24, "avg": 60.12, "max": 1.12, "min": 119.12, "cnt": 2}, "forward-compute":{"total": 1755.00, "avg": 54.84, "max": 49.39, "min": 60.79, "cnt": 32}, "fwd-compute":{"total": 1751.66, "avg": 54.74, "max": 49.30, "min": 60.66, "cnt": 32}, "batch-generator":{"total": 43.42, "avg": 1.36, "max": 0.71, "min": 2.49, "cnt": 32}, "fwd-embedding":{"total": 0.67, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1694.66, "avg": 52.96, "max": 48.02, "min": 58.53, "cnt": 32}, "fwd-layernorm":{"total": 10.66, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 107.80, "avg": 0.84, "max": 0.75, "min": 1.49, "cnt": 128}, "fwd-misc":{"total": 22.46, "avg": 0.18, "max": 0.12, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1529.52, "avg": 11.95, "max": 10.03, "min": 18.21, "cnt": 128}, "MoE_L0_fwd":{"total": 429.82, "avg": 13.43, "max": 10.36, "min": 18.13, "cnt": 32}, "MoEMLP":{"total": 1511.03, "avg": 11.80, "max": 9.91, "min": 18.08, "cnt": 128}, "MoE_L1_fwd":{"total": 363.89, "avg": 11.37, "max": 9.95, "min": 13.38, "cnt": 32}, "MoE_L2_fwd":{"total": 339.96, "avg": 10.62, "max": 10.15, "min": 12.37, "cnt": 32}, "MoE_L3_fwd":{"total": 384.11, "avg": 12.00, "max": 11.07, "min": 15.45, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.62, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 0.91, "avg": 0.91, "max": 0.91, "min": 0.91, "cnt": 1}, "forward-send-backward-recv":{"total": 2883.75, "avg": 93.02, "max": 1.78, "min": 681.57, "cnt": 31}, "backward-compute":{"total": 1454.87, "avg": 45.46, "max": 43.78, "min": 48.66, "cnt": 32}, "MoE_L3_bwd":{"total": 394.02, "avg": 12.31, "max": 11.58, "min": 13.64, "cnt": 32}, "MoE_L2_bwd":{"total": 293.68, "avg": 9.18, "max": 8.28, "min": 11.69, "cnt": 32}, "MoE_L1_bwd":{"total": 276.63, "avg": 8.64, "max": 8.12, "min": 9.86, "cnt": 32}, "MoE_L0_bwd":{"total": 261.83, "avg": 8.18, "max": 7.61, "min": 9.00, "cnt": 32}, "backward-send-forward-recv":{"total": 2046.93, "avg": 68.23, "max": 1.90, "min": 316.40, "cnt": 30}, "backward-send":{"total": 1.81, "avg": 0.90, "max": 0.85, "min": 0.96, "cnt": 2}, "backward-recv":{"total": 68.96, "avg": 68.96, "max": 68.96, "min": 68.96, "cnt": 1}, "backward-params-all-reduce":{"total": 489.65, "avg": 489.65, "max": 489.65, "min": 489.65, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.04, "avg": 0.04, "max": 0.04, "min": 0.04, "cnt": 1}, "optimizer":{"total": 276.72, "avg": 276.72, "max": 276.72, "min": 276.72, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 236.50, "avg": 236.50, "max": 236.50, "min": 236.50, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.58, "avg": 3.58, "max": 3.58, "min": 3.58, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.49, "avg": 3.49, "max": 3.49, "min": 3.49, "cnt": 1}}}
{"type":"time", "iteration": 74, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 129.98, "avg": 64.99, "max": 6.41, "min": 123.57, "cnt": 2}, "forward-compute":{"total": 1802.03, "avg": 56.31, "max": 48.73, "min": 63.73, "cnt": 32}, "fwd-compute":{"total": 1798.24, "avg": 56.20, "max": 48.64, "min": 63.61, "cnt": 32}, "batch-generator":{"total": 48.01, "avg": 1.50, "max": 0.85, "min": 2.22, "cnt": 32}, "fwd-embedding":{"total": 0.77, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1734.40, "avg": 54.20, "max": 47.36, "min": 61.43, "cnt": 32}, "fwd-layernorm":{"total": 12.14, "avg": 0.09, "max": 0.06, "min": 0.24, "cnt": 128}, "fwd-attn":{"total": 121.37, "avg": 0.95, "max": 0.75, "min": 1.97, "cnt": 128}, "fwd-misc":{"total": 26.16, "avg": 0.20, "max": 0.12, "min": 0.44, "cnt": 128}, "fwd-MLP":{"total": 1548.16, "avg": 12.10, "max": 10.02, "min": 18.84, "cnt": 128}, "MoE_L0_fwd":{"total": 433.56, "avg": 13.55, "max": 9.92, "min": 18.74, "cnt": 32}, "MoEMLP":{"total": 1527.34, "avg": 11.93, "max": 9.86, "min": 18.69, "cnt": 128}, "MoE_L1_fwd":{"total": 369.65, "avg": 11.55, "max": 10.40, "min": 13.60, "cnt": 32}, "MoE_L2_fwd":{"total": 342.62, "avg": 10.71, "max": 9.99, "min": 14.31, "cnt": 32}, "MoE_L3_fwd":{"total": 389.21, "avg": 12.16, "max": 11.59, "min": 15.47, "cnt": 32}, "fwd-pooler":{"total": 0.39, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.68, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 0.93, "avg": 0.93, "max": 0.93, "min": 0.93, "cnt": 1}, "forward-send-backward-recv":{"total": 2756.40, "avg": 88.92, "max": 1.50, "min": 383.30, "cnt": 31}, "backward-compute":{"total": 1498.30, "avg": 46.82, "max": 44.00, "min": 48.64, "cnt": 32}, "MoE_L3_bwd":{"total": 422.32, "avg": 13.20, "max": 12.36, "min": 14.67, "cnt": 32}, "MoE_L2_bwd":{"total": 299.57, "avg": 9.36, "max": 8.56, "min": 10.14, "cnt": 32}, "MoE_L1_bwd":{"total": 285.21, "avg": 8.91, "max": 8.35, "min": 10.51, "cnt": 32}, "MoE_L0_bwd":{"total": 271.65, "avg": 8.49, "max": 8.00, "min": 8.98, "cnt": 32}, "backward-send-forward-recv":{"total": 1147.30, "avg": 38.24, "max": 2.05, "min": 191.56, "cnt": 30}, "backward-send":{"total": 2.22, "avg": 1.11, "max": 1.07, "min": 1.15, "cnt": 2}, "backward-recv":{"total": 72.70, "avg": 72.70, "max": 72.70, "min": 72.70, "cnt": 1}, "backward-params-all-reduce":{"total": 493.32, "avg": 493.32, "max": 493.32, "min": 493.32, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 277.65, "avg": 277.65, "max": 277.65, "min": 277.65, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 237.73, "avg": 237.73, "max": 237.73, "min": 237.73, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.41, "avg": 3.41, "max": 3.41, "min": 3.41, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.47, "avg": 3.47, "max": 3.47, "min": 3.47, "cnt": 1}}}
{"type":"time", "iteration": 75, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 125.64, "avg": 62.82, "max": 4.30, "min": 121.34, "cnt": 2}, "forward-compute":{"total": 1764.72, "avg": 55.15, "max": 48.24, "min": 63.28, "cnt": 32}, "fwd-compute":{"total": 1761.14, "avg": 55.04, "max": 48.16, "min": 62.93, "cnt": 32}, "batch-generator":{"total": 57.08, "avg": 1.78, "max": 0.73, "min": 6.13, "cnt": 32}, "fwd-embedding":{"total": 0.67, "avg": 0.02, "max": 0.01, "min": 0.06, "cnt": 32}, "fwd-encoder":{"total": 1690.25, "avg": 52.82, "max": 47.09, "min": 60.51, "cnt": 32}, "fwd-layernorm":{"total": 10.89, "avg": 0.09, "max": 0.06, "min": 0.27, "cnt": 128}, "fwd-attn":{"total": 109.46, "avg": 0.86, "max": 0.75, "min": 2.13, "cnt": 128}, "fwd-misc":{"total": 22.58, "avg": 0.18, "max": 0.12, "min": 0.50, "cnt": 128}, "fwd-MLP":{"total": 1523.27, "avg": 11.90, "max": 10.14, "min": 17.89, "cnt": 128}, "MoE_L0_fwd":{"total": 422.20, "avg": 13.19, "max": 10.34, "min": 16.75, "cnt": 32}, "MoEMLP":{"total": 1503.52, "avg": 11.75, "max": 10.02, "min": 17.73, "cnt": 128}, "MoE_L1_fwd":{"total": 358.52, "avg": 11.20, "max": 10.07, "min": 13.70, "cnt": 32}, "MoE_L2_fwd":{"total": 350.86, "avg": 10.96, "max": 10.23, "min": 16.38, "cnt": 32}, "MoE_L3_fwd":{"total": 378.61, "avg": 11.83, "max": 11.03, "min": 17.77, "cnt": 32}, "fwd-pooler":{"total": 0.37, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.64, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 0.95, "avg": 0.95, "max": 0.95, "min": 0.95, "cnt": 1}, "forward-send-backward-recv":{"total": 580.39, "avg": 18.72, "max": 1.39, "min": 112.73, "cnt": 31}, "backward-compute":{"total": 1467.34, "avg": 45.85, "max": 42.90, "min": 47.80, "cnt": 32}, "MoE_L3_bwd":{"total": 395.47, "avg": 12.36, "max": 11.49, "min": 14.09, "cnt": 32}, "MoE_L2_bwd":{"total": 299.96, "avg": 9.37, "max": 8.58, "min": 11.95, "cnt": 32}, "MoE_L1_bwd":{"total": 278.54, "avg": 8.70, "max": 8.30, "min": 9.04, "cnt": 32}, "MoE_L0_bwd":{"total": 270.33, "avg": 8.45, "max": 8.06, "min": 9.79, "cnt": 32}, "backward-send-forward-recv":{"total": 3176.87, "avg": 105.90, "max": 2.35, "min": 462.68, "cnt": 30}, "backward-send":{"total": 2.19, "avg": 1.10, "max": 0.95, "min": 1.25, "cnt": 2}, "backward-recv":{"total": 76.47, "avg": 76.47, "max": 76.47, "min": 76.47, "cnt": 1}, "backward-params-all-reduce":{"total": 490.87, "avg": 490.87, "max": 490.87, "min": 490.87, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 280.79, "avg": 280.79, "max": 280.79, "min": 280.79, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 240.35, "avg": 240.35, "max": 240.35, "min": 240.35, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.61, "avg": 3.61, "max": 3.61, "min": 3.61, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.50, "avg": 3.50, "max": 3.50, "min": 3.50, "cnt": 1}}}
{"type":"time", "iteration": 76, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 131.00, "avg": 65.50, "max": 1.03, "min": 129.97, "cnt": 2}, "forward-compute":{"total": 1798.27, "avg": 56.20, "max": 50.61, "min": 66.07, "cnt": 32}, "fwd-compute":{"total": 1794.73, "avg": 56.09, "max": 50.52, "min": 65.98, "cnt": 32}, "batch-generator":{"total": 46.01, "avg": 1.44, "max": 0.79, "min": 2.85, "cnt": 32}, "fwd-embedding":{"total": 0.64, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1734.45, "avg": 54.20, "max": 48.73, "min": 63.60, "cnt": 32}, "fwd-layernorm":{"total": 11.01, "avg": 0.09, "max": 0.06, "min": 0.22, "cnt": 128}, "fwd-attn":{"total": 111.72, "avg": 0.87, "max": 0.75, "min": 1.81, "cnt": 128}, "fwd-misc":{"total": 23.19, "avg": 0.18, "max": 0.12, "min": 0.45, "cnt": 128}, "fwd-MLP":{"total": 1563.53, "avg": 12.22, "max": 10.15, "min": 21.00, "cnt": 128}, "MoE_L0_fwd":{"total": 443.95, "avg": 13.87, "max": 10.35, "min": 20.83, "cnt": 32}, "MoEMLP":{"total": 1544.72, "avg": 12.07, "max": 10.02, "min": 20.78, "cnt": 128}, "MoE_L1_fwd":{"total": 364.72, "avg": 11.40, "max": 10.07, "min": 14.05, "cnt": 32}, "MoE_L2_fwd":{"total": 345.33, "avg": 10.79, "max": 10.23, "min": 13.35, "cnt": 32}, "MoE_L3_fwd":{"total": 397.73, "avg": 12.43, "max": 11.55, "min": 14.50, "cnt": 32}, "fwd-pooler":{"total": 0.38, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.68, "avg": 0.02, "max": 0.02, "min": 0.07, "cnt": 32}, "forward-send":{"total": 1.11, "avg": 1.11, "max": 1.11, "min": 1.11, "cnt": 1}, "forward-send-backward-recv":{"total": 277.94, "avg": 8.97, "max": 1.40, "min": 62.45, "cnt": 31}, "backward-compute":{"total": 1491.33, "avg": 46.60, "max": 44.88, "min": 49.42, "cnt": 32}, "MoE_L3_bwd":{"total": 423.38, "avg": 13.23, "max": 11.97, "min": 15.61, "cnt": 32}, "MoE_L2_bwd":{"total": 302.37, "avg": 9.45, "max": 8.48, "min": 12.35, "cnt": 32}, "MoE_L1_bwd":{"total": 280.50, "avg": 8.77, "max": 8.35, "min": 10.80, "cnt": 32}, "MoE_L0_bwd":{"total": 266.38, "avg": 8.32, "max": 7.52, "min": 8.60, "cnt": 32}, "backward-send-forward-recv":{"total": 3675.31, "avg": 122.51, "max": 1.56, "min": 415.61, "cnt": 30}, "backward-send":{"total": 1.92, "avg": 0.96, "max": 0.95, "min": 0.97, "cnt": 2}, "backward-recv":{"total": 138.94, "avg": 138.94, "max": 138.94, "min": 138.94, "cnt": 1}, "backward-params-all-reduce":{"total": 489.27, "avg": 489.27, "max": 489.27, "min": 489.27, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 279.60, "avg": 279.60, "max": 279.60, "min": 279.60, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.40, "avg": 3.40, "max": 3.40, "min": 3.40, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 239.65, "avg": 239.65, "max": 239.65, "min": 239.65, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.49, "avg": 3.49, "max": 3.49, "min": 3.49, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.47, "avg": 3.47, "max": 3.47, "min": 3.47, "cnt": 1}}}
{"type":"time", "iteration": 77, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 121.48, "avg": 60.74, "max": 0.90, "min": 120.58, "cnt": 2}, "forward-compute":{"total": 1751.68, "avg": 54.74, "max": 47.95, "min": 62.30, "cnt": 32}, "fwd-compute":{"total": 1748.44, "avg": 54.64, "max": 47.86, "min": 62.21, "cnt": 32}, "batch-generator":{"total": 48.76, "avg": 1.52, "max": 0.73, "min": 4.88, "cnt": 32}, "fwd-embedding":{"total": 0.58, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1686.50, "avg": 52.70, "max": 46.77, "min": 61.11, "cnt": 32}, "fwd-layernorm":{"total": 10.01, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 107.47, "avg": 0.84, "max": 0.75, "min": 1.49, "cnt": 128}, "fwd-misc":{"total": 21.36, "avg": 0.17, "max": 0.12, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1524.89, "avg": 11.91, "max": 9.89, "min": 19.16, "cnt": 128}, "MoE_L0_fwd":{"total": 441.36, "avg": 13.79, "max": 10.23, "min": 19.06, "cnt": 32}, "MoEMLP":{"total": 1507.58, "avg": 11.78, "max": 9.76, "min": 19.01, "cnt": 128}, "MoE_L1_fwd":{"total": 359.29, "avg": 11.23, "max": 9.91, "min": 13.35, "cnt": 32}, "MoE_L2_fwd":{"total": 339.88, "avg": 10.62, "max": 9.81, "min": 13.40, "cnt": 32}, "MoE_L3_fwd":{"total": 373.39, "avg": 11.67, "max": 11.14, "min": 14.35, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.62, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.64, "avg": 1.64, "max": 1.64, "min": 1.64, "cnt": 1}, "forward-send-backward-recv":{"total": 332.26, "avg": 10.72, "max": 1.44, "min": 85.30, "cnt": 31}, "backward-compute":{"total": 1500.09, "avg": 46.88, "max": 44.25, "min": 48.25, "cnt": 32}, "MoE_L3_bwd":{"total": 410.55, "avg": 12.83, "max": 11.79, "min": 14.01, "cnt": 32}, "MoE_L2_bwd":{"total": 308.11, "avg": 9.63, "max": 8.98, "min": 10.60, "cnt": 32}, "MoE_L1_bwd":{"total": 274.79, "avg": 8.59, "max": 8.14, "min": 9.11, "cnt": 32}, "MoE_L0_bwd":{"total": 261.78, "avg": 8.18, "max": 7.85, "min": 8.61, "cnt": 32}, "backward-send-forward-recv":{"total": 5147.91, "avg": 171.60, "max": 2.22, "min": 847.84, "cnt": 30}, "backward-send":{"total": 1.77, "avg": 0.89, "max": 0.82, "min": 0.96, "cnt": 2}, "backward-recv":{"total": 72.45, "avg": 72.45, "max": 72.45, "min": 72.45, "cnt": 1}, "backward-params-all-reduce":{"total": 495.95, "avg": 495.95, "max": 495.95, "min": 495.95, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 273.66, "avg": 273.66, "max": 273.66, "min": 273.66, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 233.29, "avg": 233.29, "max": 233.29, "min": 233.29, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.72, "avg": 3.72, "max": 3.72, "min": 3.72, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.48, "avg": 3.48, "max": 3.48, "min": 3.48, "cnt": 1}}}
{"type":"time", "iteration": 78, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.12, "avg": 0.12, "max": 0.12, "min": 0.12, "cnt": 1}, "forward-recv":{"total": 133.96, "avg": 66.98, "max": 1.06, "min": 132.90, "cnt": 2}, "forward-compute":{"total": 1779.18, "avg": 55.60, "max": 50.18, "min": 63.85, "cnt": 32}, "fwd-compute":{"total": 1775.48, "avg": 55.48, "max": 50.10, "min": 63.75, "cnt": 32}, "batch-generator":{"total": 49.05, "avg": 1.53, "max": 0.72, "min": 2.99, "cnt": 32}, "fwd-embedding":{"total": 0.78, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1712.08, "avg": 53.50, "max": 48.31, "min": 62.06, "cnt": 32}, "fwd-layernorm":{"total": 11.72, "avg": 0.09, "max": 0.06, "min": 0.23, "cnt": 128}, "fwd-attn":{"total": 117.55, "avg": 0.92, "max": 0.75, "min": 1.83, "cnt": 128}, "fwd-misc":{"total": 24.73, "avg": 0.19, "max": 0.12, "min": 0.49, "cnt": 128}, "fwd-MLP":{"total": 1532.41, "avg": 11.97, "max": 9.92, "min": 21.79, "cnt": 128}, "MoE_L0_fwd":{"total": 450.05, "avg": 14.06, "max": 10.66, "min": 21.64, "cnt": 32}, "MoEMLP":{"total": 1512.87, "avg": 11.82, "max": 9.80, "min": 21.56, "cnt": 128}, "MoE_L1_fwd":{"total": 355.92, "avg": 11.12, "max": 10.07, "min": 12.49, "cnt": 32}, "MoE_L2_fwd":{"total": 341.49, "avg": 10.67, "max": 9.85, "min": 13.67, "cnt": 32}, "MoE_L3_fwd":{"total": 372.55, "avg": 11.64, "max": 10.86, "min": 13.57, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.62, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 0.97, "avg": 0.97, "max": 0.97, "min": 0.97, "cnt": 1}, "forward-send-backward-recv":{"total": 2582.39, "avg": 83.30, "max": 1.87, "min": 405.44, "cnt": 31}, "backward-compute":{"total": 1454.53, "avg": 45.45, "max": 43.63, "min": 50.04, "cnt": 32}, "MoE_L3_bwd":{"total": 400.70, "avg": 12.52, "max": 11.15, "min": 17.69, "cnt": 32}, "MoE_L2_bwd":{"total": 306.38, "avg": 9.57, "max": 8.94, "min": 10.54, "cnt": 32}, "MoE_L1_bwd":{"total": 281.25, "avg": 8.79, "max": 8.33, "min": 10.39, "cnt": 32}, "MoE_L0_bwd":{"total": 252.88, "avg": 7.90, "max": 6.78, "min": 8.28, "cnt": 32}, "backward-send-forward-recv":{"total": 1182.72, "avg": 39.42, "max": 1.87, "min": 423.43, "cnt": 30}, "backward-send":{"total": 1.95, "avg": 0.97, "max": 0.84, "min": 1.11, "cnt": 2}, "backward-recv":{"total": 79.94, "avg": 79.94, "max": 79.94, "min": 79.94, "cnt": 1}, "backward-params-all-reduce":{"total": 488.01, "avg": 488.01, "max": 488.01, "min": 488.01, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "optimizer":{"total": 281.85, "avg": 281.85, "max": 281.85, "min": 281.85, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 241.64, "avg": 241.64, "max": 241.64, "min": 241.64, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.51, "avg": 3.51, "max": 3.51, "min": 3.51, "cnt": 1}}}
{"type":"time", "iteration": 79, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 115.48, "avg": 57.74, "max": 1.12, "min": 114.36, "cnt": 2}, "forward-compute":{"total": 1760.05, "avg": 55.00, "max": 49.47, "min": 60.12, "cnt": 32}, "fwd-compute":{"total": 1756.59, "avg": 54.89, "max": 49.40, "min": 60.04, "cnt": 32}, "batch-generator":{"total": 48.38, "avg": 1.51, "max": 0.86, "min": 2.77, "cnt": 32}, "fwd-embedding":{"total": 0.75, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1693.97, "avg": 52.94, "max": 47.00, "min": 58.71, "cnt": 32}, "fwd-layernorm":{"total": 11.60, "avg": 0.09, "max": 0.06, "min": 0.24, "cnt": 128}, "fwd-attn":{"total": 118.33, "avg": 0.92, "max": 0.75, "min": 3.26, "cnt": 128}, "fwd-misc":{"total": 24.03, "avg": 0.19, "max": 0.12, "min": 0.47, "cnt": 128}, "fwd-MLP":{"total": 1515.38, "avg": 11.84, "max": 10.06, "min": 18.40, "cnt": 128}, "MoE_L0_fwd":{"total": 450.47, "avg": 14.08, "max": 10.70, "min": 18.32, "cnt": 32}, "MoEMLP":{"total": 1496.41, "avg": 11.69, "max": 9.92, "min": 18.27, "cnt": 128}, "MoE_L1_fwd":{"total": 359.85, "avg": 11.25, "max": 10.09, "min": 15.11, "cnt": 32}, "MoE_L2_fwd":{"total": 336.87, "avg": 10.53, "max": 9.98, "min": 13.09, "cnt": 32}, "MoE_L3_fwd":{"total": 356.13, "avg": 11.13, "max": 10.46, "min": 13.50, "cnt": 32}, "fwd-pooler":{"total": 0.36, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.63, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 0.78, "avg": 0.78, "max": 0.78, "min": 0.78, "cnt": 1}, "forward-send-backward-recv":{"total": 1351.33, "avg": 43.59, "max": 1.43, "min": 385.81, "cnt": 31}, "backward-compute":{"total": 1477.78, "avg": 46.18, "max": 42.54, "min": 94.80, "cnt": 32}, "MoE_L3_bwd":{"total": 431.33, "avg": 13.48, "max": 10.59, "min": 62.96, "cnt": 32}, "MoE_L2_bwd":{"total": 290.18, "avg": 9.07, "max": 8.33, "min": 10.25, "cnt": 32}, "MoE_L1_bwd":{"total": 275.87, "avg": 8.62, "max": 8.08, "min": 9.82, "cnt": 32}, "MoE_L0_bwd":{"total": 258.47, "avg": 8.08, "max": 7.58, "min": 8.42, "cnt": 32}, "backward-send-forward-recv":{"total": 1909.94, "avg": 63.66, "max": 2.00, "min": 254.01, "cnt": 30}, "backward-send":{"total": 2.15, "avg": 1.08, "max": 1.04, "min": 1.11, "cnt": 2}, "backward-recv":{"total": 232.17, "avg": 232.17, "max": 232.17, "min": 232.17, "cnt": 1}, "backward-params-all-reduce":{"total": 494.79, "avg": 494.79, "max": 494.79, "min": 494.79, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 350.06, "avg": 350.06, "max": 350.06, "min": 350.06, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 310.19, "avg": 310.19, "max": 310.19, "min": 310.19, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.48, "avg": 3.48, "max": 3.48, "min": 3.48, "cnt": 1}}}
{"type":"time", "iteration": 80, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 373.83, "avg": 186.91, "max": 0.77, "min": 373.06, "cnt": 2}, "forward-compute":{"total": 1774.23, "avg": 55.44, "max": 47.56, "min": 63.73, "cnt": 32}, "fwd-compute":{"total": 1770.64, "avg": 55.33, "max": 47.47, "min": 63.63, "cnt": 32}, "batch-generator":{"total": 46.83, "avg": 1.46, "max": 0.75, "min": 2.03, "cnt": 32}, "fwd-embedding":{"total": 0.74, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1708.49, "avg": 53.39, "max": 45.81, "min": 61.97, "cnt": 32}, "fwd-layernorm":{"total": 11.70, "avg": 0.09, "max": 0.06, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 117.93, "avg": 0.92, "max": 0.75, "min": 1.94, "cnt": 128}, "fwd-misc":{"total": 25.19, "avg": 0.20, "max": 0.12, "min": 0.49, "cnt": 128}, "fwd-MLP":{"total": 1527.77, "avg": 11.94, "max": 9.96, "min": 19.16, "cnt": 128}, "MoE_L0_fwd":{"total": 444.63, "avg": 13.89, "max": 9.93, "min": 19.06, "cnt": 32}, "MoEMLP":{"total": 1507.42, "avg": 11.78, "max": 9.85, "min": 19.00, "cnt": 128}, "MoE_L1_fwd":{"total": 367.52, "avg": 11.49, "max": 10.35, "min": 14.26, "cnt": 32}, "MoE_L2_fwd":{"total": 346.63, "avg": 10.83, "max": 9.96, "min": 15.80, "cnt": 32}, "MoE_L3_fwd":{"total": 356.04, "avg": 11.13, "max": 9.89, "min": 17.55, "cnt": 32}, "fwd-pooler":{"total": 0.40, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.65, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 0.63, "avg": 0.63, "max": 0.63, "min": 0.63, "cnt": 1}, "forward-send-backward-recv":{"total": 1108.86, "avg": 35.77, "max": 1.41, "min": 468.40, "cnt": 31}, "backward-compute":{"total": 1418.26, "avg": 44.32, "max": 43.08, "min": 46.01, "cnt": 32}, "MoE_L3_bwd":{"total": 355.52, "avg": 11.11, "max": 10.51, "min": 11.79, "cnt": 32}, "MoE_L2_bwd":{"total": 300.17, "avg": 9.38, "max": 8.73, "min": 11.86, "cnt": 32}, "MoE_L1_bwd":{"total": 279.61, "avg": 8.74, "max": 8.28, "min": 9.60, "cnt": 32}, "MoE_L0_bwd":{"total": 253.73, "avg": 7.93, "max": 7.46, "min": 8.32, "cnt": 32}, "backward-send-forward-recv":{"total": 2020.04, "avg": 67.33, "max": 2.27, "min": 366.68, "cnt": 30}, "backward-send":{"total": 1.89, "avg": 0.94, "max": 0.86, "min": 1.02, "cnt": 2}, "backward-recv":{"total": 69.83, "avg": 69.83, "max": 69.83, "min": 69.83, "cnt": 1}, "backward-params-all-reduce":{"total": 491.98, "avg": 491.98, "max": 491.98, "min": 491.98, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 272.94, "avg": 272.94, "max": 272.94, "min": 272.94, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.36, "avg": 3.36, "max": 3.36, "min": 3.36, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 232.93, "avg": 232.93, "max": 232.93, "min": 232.93, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.50, "avg": 3.50, "max": 3.50, "min": 3.50, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.56, "avg": 3.56, "max": 3.56, "min": 3.56, "cnt": 1}}}
{"type":"time", "iteration": 81, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.10, "avg": 0.10, "max": 0.10, "min": 0.10, "cnt": 1}, "forward-recv":{"total": 133.42, "avg": 66.71, "max": 8.36, "min": 125.07, "cnt": 2}, "forward-compute":{"total": 1723.51, "avg": 53.86, "max": 47.24, "min": 61.12, "cnt": 32}, "fwd-compute":{"total": 1720.26, "avg": 53.76, "max": 47.16, "min": 61.03, "cnt": 32}, "batch-generator":{"total": 44.71, "avg": 1.40, "max": 0.71, "min": 3.75, "cnt": 32}, "fwd-embedding":{"total": 0.52, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1662.49, "avg": 51.95, "max": 45.94, "min": 58.81, "cnt": 32}, "fwd-layernorm":{"total": 10.01, "avg": 0.08, "max": 0.06, "min": 0.18, "cnt": 128}, "fwd-attn":{"total": 105.63, "avg": 0.83, "max": 0.75, "min": 1.47, "cnt": 128}, "fwd-misc":{"total": 21.57, "avg": 0.17, "max": 0.11, "min": 1.02, "cnt": 128}, "fwd-MLP":{"total": 1502.20, "avg": 11.74, "max": 9.79, "min": 19.66, "cnt": 128}, "MoE_L0_fwd":{"total": 445.94, "avg": 13.94, "max": 10.31, "min": 19.58, "cnt": 32}, "MoEMLP":{"total": 1484.90, "avg": 11.60, "max": 9.68, "min": 19.53, "cnt": 128}, "MoE_L1_fwd":{"total": 350.51, "avg": 10.95, "max": 9.72, "min": 12.16, "cnt": 32}, "MoE_L2_fwd":{"total": 341.90, "avg": 10.68, "max": 10.19, "min": 12.87, "cnt": 32}, "MoE_L3_fwd":{"total": 352.92, "avg": 11.03, "max": 10.24, "min": 14.18, "cnt": 32}, "fwd-pooler":{"total": 0.38, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.62, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 0.97, "avg": 0.97, "max": 0.97, "min": 0.97, "cnt": 1}, "forward-send-backward-recv":{"total": 780.71, "avg": 25.18, "max": 1.84, "min": 151.63, "cnt": 31}, "backward-compute":{"total": 1451.02, "avg": 45.34, "max": 43.43, "min": 49.46, "cnt": 32}, "MoE_L3_bwd":{"total": 368.91, "avg": 11.53, "max": 10.17, "min": 14.19, "cnt": 32}, "MoE_L2_bwd":{"total": 314.36, "avg": 9.82, "max": 8.92, "min": 11.63, "cnt": 32}, "MoE_L1_bwd":{"total": 279.41, "avg": 8.73, "max": 8.32, "min": 9.87, "cnt": 32}, "MoE_L0_bwd":{"total": 266.95, "avg": 8.34, "max": 7.75, "min": 8.94, "cnt": 32}, "backward-send-forward-recv":{"total": 4899.08, "avg": 163.30, "max": 2.38, "min": 1143.15, "cnt": 30}, "backward-send":{"total": 2.14, "avg": 1.07, "max": 0.99, "min": 1.15, "cnt": 2}, "backward-recv":{"total": 65.02, "avg": 65.02, "max": 65.02, "min": 65.02, "cnt": 1}, "backward-params-all-reduce":{"total": 488.87, "avg": 488.87, "max": 488.87, "min": 488.87, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 283.25, "avg": 283.25, "max": 283.25, "min": 283.25, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.41, "avg": 3.41, "max": 3.41, "min": 3.41, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 242.61, "avg": 242.61, "max": 242.61, "min": 242.61, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.41, "avg": 3.41, "max": 3.41, "min": 3.41, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.48, "avg": 3.48, "max": 3.48, "min": 3.48, "cnt": 1}}}
{"type":"time", "iteration": 82, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 118.34, "avg": 59.17, "max": 2.20, "min": 116.14, "cnt": 2}, "forward-compute":{"total": 1776.88, "avg": 55.53, "max": 47.16, "min": 60.92, "cnt": 32}, "fwd-compute":{"total": 1773.53, "avg": 55.42, "max": 47.08, "min": 60.80, "cnt": 32}, "batch-generator":{"total": 49.53, "avg": 1.55, "max": 0.75, "min": 2.77, "cnt": 32}, "fwd-embedding":{"total": 0.57, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1710.84, "avg": 53.46, "max": 45.96, "min": 59.30, "cnt": 32}, "fwd-layernorm":{"total": 10.34, "avg": 0.08, "max": 0.06, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 108.64, "avg": 0.85, "max": 0.75, "min": 2.24, "cnt": 128}, "fwd-misc":{"total": 21.39, "avg": 0.17, "max": 0.11, "min": 0.38, "cnt": 128}, "fwd-MLP":{"total": 1547.06, "avg": 12.09, "max": 9.80, "min": 21.09, "cnt": 128}, "MoE_L0_fwd":{"total": 480.32, "avg": 15.01, "max": 10.65, "min": 21.00, "cnt": 32}, "MoEMLP":{"total": 1529.71, "avg": 11.95, "max": 9.69, "min": 20.96, "cnt": 128}, "MoE_L1_fwd":{"total": 360.52, "avg": 11.27, "max": 9.73, "min": 12.96, "cnt": 32}, "MoE_L2_fwd":{"total": 340.93, "avg": 10.65, "max": 10.12, "min": 12.37, "cnt": 32}, "MoE_L3_fwd":{"total": 354.29, "avg": 11.07, "max": 10.30, "min": 12.90, "cnt": 32}, "fwd-pooler":{"total": 0.36, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.64, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 0.94, "avg": 0.94, "max": 0.94, "min": 0.94, "cnt": 1}, "forward-send-backward-recv":{"total": 794.24, "avg": 25.62, "max": 1.68, "min": 329.61, "cnt": 31}, "backward-compute":{"total": 1456.14, "avg": 45.50, "max": 43.54, "min": 47.07, "cnt": 32}, "MoE_L3_bwd":{"total": 371.13, "avg": 11.60, "max": 10.82, "min": 13.35, "cnt": 32}, "MoE_L2_bwd":{"total": 312.93, "avg": 9.78, "max": 8.79, "min": 10.36, "cnt": 32}, "MoE_L1_bwd":{"total": 281.28, "avg": 8.79, "max": 8.31, "min": 9.90, "cnt": 32}, "MoE_L0_bwd":{"total": 271.17, "avg": 8.47, "max": 7.81, "min": 9.15, "cnt": 32}, "backward-send-forward-recv":{"total": 12083.50, "avg": 402.78, "max": 2.31, "min": 2267.23, "cnt": 30}, "backward-send":{"total": 1.85, "avg": 0.93, "max": 0.92, "min": 0.93, "cnt": 2}, "backward-recv":{"total": 352.65, "avg": 352.65, "max": 352.65, "min": 352.65, "cnt": 1}, "backward-params-all-reduce":{"total": 488.27, "avg": 488.27, "max": 488.27, "min": 488.27, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 280.08, "avg": 280.08, "max": 280.08, "min": 280.08, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.51, "avg": 3.51, "max": 3.51, "min": 3.51, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 240.10, "avg": 240.10, "max": 240.10, "min": 240.10, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.48, "avg": 3.48, "max": 3.48, "min": 3.48, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 83, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.10, "avg": 0.10, "max": 0.10, "min": 0.10, "cnt": 1}, "forward-recv":{"total": 138.21, "avg": 69.10, "max": 1.48, "min": 136.73, "cnt": 2}, "forward-compute":{"total": 1753.31, "avg": 54.79, "max": 49.01, "min": 63.59, "cnt": 32}, "fwd-compute":{"total": 1749.88, "avg": 54.68, "max": 48.92, "min": 63.50, "cnt": 32}, "batch-generator":{"total": 55.60, "avg": 1.74, "max": 0.71, "min": 3.24, "cnt": 32}, "fwd-embedding":{"total": 0.63, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1680.32, "avg": 52.51, "max": 47.72, "min": 61.88, "cnt": 32}, "fwd-layernorm":{"total": 10.79, "avg": 0.08, "max": 0.06, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 110.78, "avg": 0.87, "max": 0.75, "min": 1.78, "cnt": 128}, "fwd-misc":{"total": 22.18, "avg": 0.17, "max": 0.12, "min": 0.43, "cnt": 128}, "fwd-MLP":{"total": 1512.27, "avg": 11.81, "max": 9.97, "min": 21.59, "cnt": 128}, "MoE_L0_fwd":{"total": 462.96, "avg": 14.47, "max": 10.55, "min": 21.41, "cnt": 32}, "MoEMLP":{"total": 1494.27, "avg": 11.67, "max": 9.84, "min": 21.32, "cnt": 128}, "MoE_L1_fwd":{"total": 355.27, "avg": 11.10, "max": 10.02, "min": 14.19, "cnt": 32}, "MoE_L2_fwd":{"total": 331.45, "avg": 10.36, "max": 9.88, "min": 12.25, "cnt": 32}, "MoE_L3_fwd":{"total": 351.21, "avg": 10.98, "max": 10.30, "min": 13.90, "cnt": 32}, "fwd-pooler":{"total": 0.37, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.62, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 0.94, "avg": 0.94, "max": 0.94, "min": 0.94, "cnt": 1}, "forward-send-backward-recv":{"total": 256.69, "avg": 8.28, "max": 1.83, "min": 47.19, "cnt": 31}, "backward-compute":{"total": 1428.48, "avg": 44.64, "max": 41.68, "min": 46.94, "cnt": 32}, "MoE_L3_bwd":{"total": 359.39, "avg": 11.23, "max": 10.20, "min": 12.63, "cnt": 32}, "MoE_L2_bwd":{"total": 299.70, "avg": 9.37, "max": 8.76, "min": 10.04, "cnt": 32}, "MoE_L1_bwd":{"total": 277.14, "avg": 8.66, "max": 7.93, "min": 10.28, "cnt": 32}, "MoE_L0_bwd":{"total": 271.89, "avg": 8.50, "max": 7.99, "min": 8.88, "cnt": 32}, "backward-send-forward-recv":{"total": 13091.80, "avg": 436.39, "max": 2.13, "min": 2475.39, "cnt": 30}, "backward-send":{"total": 2.08, "avg": 1.04, "max": 1.00, "min": 1.08, "cnt": 2}, "backward-recv":{"total": 70.65, "avg": 70.65, "max": 70.65, "min": 70.65, "cnt": 1}, "backward-params-all-reduce":{"total": 491.31, "avg": 491.31, "max": 491.31, "min": 491.31, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 276.99, "avg": 276.99, "max": 276.99, "min": 276.99, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 236.77, "avg": 236.77, "max": 236.77, "min": 236.77, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.56, "avg": 3.56, "max": 3.56, "min": 3.56, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.54, "avg": 3.54, "max": 3.54, "min": 3.54, "cnt": 1}}}
{"type":"time", "iteration": 84, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 128.34, "avg": 64.17, "max": 3.66, "min": 124.68, "cnt": 2}, "forward-compute":{"total": 1750.26, "avg": 54.70, "max": 47.81, "min": 67.37, "cnt": 32}, "fwd-compute":{"total": 1747.18, "avg": 54.60, "max": 47.73, "min": 67.29, "cnt": 32}, "batch-generator":{"total": 45.69, "avg": 1.43, "max": 0.75, "min": 3.32, "cnt": 32}, "fwd-embedding":{"total": 0.52, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1688.61, "avg": 52.77, "max": 45.29, "min": 65.38, "cnt": 32}, "fwd-layernorm":{"total": 10.05, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 105.95, "avg": 0.83, "max": 0.75, "min": 1.67, "cnt": 128}, "fwd-misc":{"total": 21.44, "avg": 0.17, "max": 0.12, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1527.95, "avg": 11.94, "max": 9.94, "min": 21.56, "cnt": 128}, "MoE_L0_fwd":{"total": 457.59, "avg": 14.30, "max": 9.96, "min": 21.44, "cnt": 32}, "MoEMLP":{"total": 1510.58, "avg": 11.80, "max": 9.82, "min": 21.39, "cnt": 128}, "MoE_L1_fwd":{"total": 359.79, "avg": 11.24, "max": 9.88, "min": 15.80, "cnt": 32}, "MoE_L2_fwd":{"total": 351.42, "avg": 10.98, "max": 10.33, "min": 13.34, "cnt": 32}, "MoE_L3_fwd":{"total": 348.14, "avg": 10.88, "max": 9.86, "min": 15.50, "cnt": 32}, "fwd-pooler":{"total": 0.38, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.63, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 0.99, "avg": 0.99, "max": 0.99, "min": 0.99, "cnt": 1}, "forward-send-backward-recv":{"total": 331.74, "avg": 10.70, "max": 1.28, "min": 115.44, "cnt": 31}, "backward-compute":{"total": 1426.86, "avg": 44.59, "max": 42.59, "min": 46.34, "cnt": 32}, "MoE_L3_bwd":{"total": 350.58, "avg": 10.96, "max": 9.94, "min": 12.67, "cnt": 32}, "MoE_L2_bwd":{"total": 309.90, "avg": 9.68, "max": 9.24, "min": 10.37, "cnt": 32}, "MoE_L1_bwd":{"total": 279.29, "avg": 8.73, "max": 8.43, "min": 9.09, "cnt": 32}, "MoE_L0_bwd":{"total": 266.69, "avg": 8.33, "max": 7.86, "min": 9.05, "cnt": 32}, "backward-send-forward-recv":{"total": 8120.47, "avg": 270.68, "max": 1.99, "min": 1150.87, "cnt": 30}, "backward-send":{"total": 1.61, "avg": 0.81, "max": 0.68, "min": 0.93, "cnt": 2}, "backward-recv":{"total": 255.39, "avg": 255.39, "max": 255.39, "min": 255.39, "cnt": 1}, "backward-params-all-reduce":{"total": 490.29, "avg": 490.29, "max": 490.29, "min": 490.29, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 277.55, "avg": 277.55, "max": 277.55, "min": 277.55, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 237.29, "avg": 237.29, "max": 237.29, "min": 237.29, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.85, "avg": 3.85, "max": 3.85, "min": 3.85, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 85, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 140.35, "avg": 70.17, "max": 1.41, "min": 138.94, "cnt": 2}, "forward-compute":{"total": 1717.81, "avg": 53.68, "max": 47.94, "min": 63.30, "cnt": 32}, "fwd-compute":{"total": 1714.63, "avg": 53.58, "max": 47.86, "min": 63.17, "cnt": 32}, "batch-generator":{"total": 38.09, "avg": 1.19, "max": 0.73, "min": 2.32, "cnt": 32}, "fwd-embedding":{"total": 0.53, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1663.13, "avg": 51.97, "max": 46.63, "min": 61.13, "cnt": 32}, "fwd-layernorm":{"total": 10.10, "avg": 0.08, "max": 0.06, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 109.17, "avg": 0.85, "max": 0.75, "min": 1.79, "cnt": 128}, "fwd-misc":{"total": 22.24, "avg": 0.17, "max": 0.12, "min": 0.43, "cnt": 128}, "fwd-MLP":{"total": 1497.29, "avg": 11.70, "max": 9.96, "min": 22.64, "cnt": 128}, "MoE_L0_fwd":{"total": 441.73, "avg": 13.80, "max": 10.25, "min": 22.50, "cnt": 32}, "MoEMLP":{"total": 1478.66, "avg": 11.55, "max": 9.82, "min": 22.45, "cnt": 128}, "MoE_L1_fwd":{"total": 361.88, "avg": 11.31, "max": 9.88, "min": 15.52, "cnt": 32}, "MoE_L2_fwd":{"total": 345.88, "avg": 10.81, "max": 9.99, "min": 15.56, "cnt": 32}, "MoE_L3_fwd":{"total": 335.95, "avg": 10.50, "max": 9.90, "min": 12.55, "cnt": 32}, "fwd-pooler":{"total": 0.40, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.64, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 0.67, "avg": 0.67, "max": 0.67, "min": 0.67, "cnt": 1}, "forward-send-backward-recv":{"total": 187.77, "avg": 6.06, "max": 1.35, "min": 51.97, "cnt": 31}, "backward-compute":{"total": 1429.50, "avg": 44.67, "max": 41.78, "min": 48.14, "cnt": 32}, "MoE_L3_bwd":{"total": 342.21, "avg": 10.69, "max": 9.28, "min": 13.82, "cnt": 32}, "MoE_L2_bwd":{"total": 317.08, "avg": 9.91, "max": 9.37, "min": 13.13, "cnt": 32}, "MoE_L1_bwd":{"total": 278.91, "avg": 8.72, "max": 8.28, "min": 9.20, "cnt": 32}, "MoE_L0_bwd":{"total": 274.64, "avg": 8.58, "max": 8.01, "min": 10.42, "cnt": 32}, "backward-send-forward-recv":{"total": 3185.38, "avg": 106.18, "max": 2.16, "min": 316.98, "cnt": 30}, "backward-send":{"total": 2.28, "avg": 1.14, "max": 0.99, "min": 1.29, "cnt": 2}, "backward-recv":{"total": 71.54, "avg": 71.54, "max": 71.54, "min": 71.54, "cnt": 1}, "backward-params-all-reduce":{"total": 489.87, "avg": 489.87, "max": 489.87, "min": 489.87, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 276.80, "avg": 276.80, "max": 276.80, "min": 276.80, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 236.36, "avg": 236.36, "max": 236.36, "min": 236.36, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.81, "avg": 3.81, "max": 3.81, "min": 3.81, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.53, "avg": 3.53, "max": 3.53, "min": 3.53, "cnt": 1}}}
{"type":"time", "iteration": 86, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.13, "avg": 0.13, "max": 0.13, "min": 0.13, "cnt": 1}, "forward-recv":{"total": 133.27, "avg": 66.63, "max": 2.83, "min": 130.44, "cnt": 2}, "forward-compute":{"total": 1729.15, "avg": 54.04, "max": 48.27, "min": 60.80, "cnt": 32}, "fwd-compute":{"total": 1725.93, "avg": 53.94, "max": 48.18, "min": 60.71, "cnt": 32}, "batch-generator":{"total": 40.82, "avg": 1.28, "max": 0.85, "min": 2.74, "cnt": 32}, "fwd-embedding":{"total": 0.51, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1670.93, "avg": 52.22, "max": 46.83, "min": 58.74, "cnt": 32}, "fwd-layernorm":{"total": 10.02, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 107.74, "avg": 0.84, "max": 0.75, "min": 2.05, "cnt": 128}, "fwd-misc":{"total": 22.14, "avg": 0.17, "max": 0.12, "min": 0.49, "cnt": 128}, "fwd-MLP":{"total": 1507.62, "avg": 11.78, "max": 10.03, "min": 18.98, "cnt": 128}, "MoE_L0_fwd":{"total": 434.71, "avg": 13.58, "max": 10.25, "min": 18.88, "cnt": 32}, "MoEMLP":{"total": 1489.19, "avg": 11.63, "max": 9.91, "min": 18.83, "cnt": 128}, "MoE_L1_fwd":{"total": 367.85, "avg": 11.50, "max": 10.26, "min": 14.14, "cnt": 32}, "MoE_L2_fwd":{"total": 351.43, "avg": 10.98, "max": 10.23, "min": 13.87, "cnt": 32}, "MoE_L3_fwd":{"total": 341.86, "avg": 10.68, "max": 9.95, "min": 15.84, "cnt": 32}, "fwd-pooler":{"total": 0.39, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.70, "avg": 0.02, "max": 0.02, "min": 0.05, "cnt": 32}, "forward-send":{"total": 0.94, "avg": 0.94, "max": 0.94, "min": 0.94, "cnt": 1}, "forward-send-backward-recv":{"total": 173.78, "avg": 5.61, "max": 1.32, "min": 59.96, "cnt": 31}, "backward-compute":{"total": 1416.74, "avg": 44.27, "max": 41.26, "min": 45.66, "cnt": 32}, "MoE_L3_bwd":{"total": 338.09, "avg": 10.57, "max": 9.86, "min": 11.62, "cnt": 32}, "MoE_L2_bwd":{"total": 312.04, "avg": 9.75, "max": 9.00, "min": 10.45, "cnt": 32}, "MoE_L1_bwd":{"total": 282.21, "avg": 8.82, "max": 8.13, "min": 9.22, "cnt": 32}, "MoE_L0_bwd":{"total": 265.20, "avg": 8.29, "max": 7.91, "min": 9.36, "cnt": 32}, "backward-send-forward-recv":{"total": 4252.38, "avg": 141.75, "max": 2.52, "min": 504.18, "cnt": 30}, "backward-send":{"total": 2.14, "avg": 1.07, "max": 1.05, "min": 1.09, "cnt": 2}, "backward-recv":{"total": 64.55, "avg": 64.55, "max": 64.55, "min": 64.55, "cnt": 1}, "backward-params-all-reduce":{"total": 494.27, "avg": 494.27, "max": 494.27, "min": 494.27, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 277.89, "avg": 277.89, "max": 277.89, "min": 277.89, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.48, "avg": 3.48, "max": 3.48, "min": 3.48, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 237.76, "avg": 237.76, "max": 237.76, "min": 237.76, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.30, "avg": 3.30, "max": 3.30, "min": 3.30, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.52, "avg": 3.52, "max": 3.52, "min": 3.52, "cnt": 1}}}
{"type":"time", "iteration": 87, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.10, "avg": 0.10, "max": 0.10, "min": 0.10, "cnt": 1}, "forward-recv":{"total": 125.33, "avg": 62.66, "max": 1.82, "min": 123.51, "cnt": 2}, "forward-compute":{"total": 1754.37, "avg": 54.82, "max": 48.19, "min": 62.02, "cnt": 32}, "fwd-compute":{"total": 1750.70, "avg": 54.71, "max": 48.10, "min": 61.85, "cnt": 32}, "batch-generator":{"total": 49.18, "avg": 1.54, "max": 0.90, "min": 2.75, "cnt": 32}, "fwd-embedding":{"total": 0.69, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1686.27, "avg": 52.70, "max": 46.73, "min": 59.66, "cnt": 32}, "fwd-layernorm":{"total": 11.63, "avg": 0.09, "max": 0.06, "min": 0.23, "cnt": 128}, "fwd-attn":{"total": 114.29, "avg": 0.89, "max": 0.75, "min": 1.81, "cnt": 128}, "fwd-misc":{"total": 24.65, "avg": 0.19, "max": 0.12, "min": 0.65, "cnt": 128}, "fwd-MLP":{"total": 1510.09, "avg": 11.80, "max": 10.25, "min": 17.68, "cnt": 128}, "MoE_L0_fwd":{"total": 415.47, "avg": 12.98, "max": 10.25, "min": 17.52, "cnt": 32}, "MoEMLP":{"total": 1490.54, "avg": 11.64, "max": 10.12, "min": 17.45, "cnt": 128}, "MoE_L1_fwd":{"total": 373.46, "avg": 11.67, "max": 10.17, "min": 15.42, "cnt": 32}, "MoE_L2_fwd":{"total": 359.98, "avg": 11.25, "max": 10.37, "min": 15.18, "cnt": 32}, "MoE_L3_fwd":{"total": 348.78, "avg": 10.90, "max": 10.31, "min": 13.03, "cnt": 32}, "fwd-pooler":{"total": 0.39, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.67, "avg": 0.02, "max": 0.02, "min": 0.04, "cnt": 32}, "forward-send":{"total": 0.99, "avg": 0.99, "max": 0.99, "min": 0.99, "cnt": 1}, "forward-send-backward-recv":{"total": 392.78, "avg": 12.67, "max": 1.49, "min": 69.92, "cnt": 31}, "backward-compute":{"total": 1463.37, "avg": 45.73, "max": 43.99, "min": 55.91, "cnt": 32}, "MoE_L3_bwd":{"total": 360.18, "avg": 11.26, "max": 10.38, "min": 19.83, "cnt": 32}, "MoE_L2_bwd":{"total": 319.42, "avg": 9.98, "max": 8.96, "min": 11.61, "cnt": 32}, "MoE_L1_bwd":{"total": 295.72, "avg": 9.24, "max": 8.84, "min": 11.80, "cnt": 32}, "MoE_L0_bwd":{"total": 266.75, "avg": 8.34, "max": 7.75, "min": 8.69, "cnt": 32}, "backward-send-forward-recv":{"total": 2560.12, "avg": 85.34, "max": 1.62, "min": 278.65, "cnt": 30}, "backward-send":{"total": 2.12, "avg": 1.06, "max": 0.97, "min": 1.15, "cnt": 2}, "backward-recv":{"total": 68.37, "avg": 68.37, "max": 68.37, "min": 68.37, "cnt": 1}, "backward-params-all-reduce":{"total": 489.50, "avg": 489.50, "max": 489.50, "min": 489.50, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 279.86, "avg": 279.86, "max": 279.86, "min": 279.86, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 239.54, "avg": 239.54, "max": 239.54, "min": 239.54, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.70, "avg": 3.70, "max": 3.70, "min": 3.70, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.50, "avg": 3.50, "max": 3.50, "min": 3.50, "cnt": 1}}}
{"type":"time", "iteration": 88, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 132.28, "avg": 66.14, "max": 10.96, "min": 121.32, "cnt": 2}, "forward-compute":{"total": 1767.04, "avg": 55.22, "max": 48.80, "min": 61.57, "cnt": 32}, "fwd-compute":{"total": 1763.46, "avg": 55.11, "max": 48.68, "min": 61.48, "cnt": 32}, "batch-generator":{"total": 48.10, "avg": 1.50, "max": 0.85, "min": 2.93, "cnt": 32}, "fwd-embedding":{"total": 0.64, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1700.69, "avg": 53.15, "max": 46.97, "min": 60.03, "cnt": 32}, "fwd-layernorm":{"total": 11.26, "avg": 0.09, "max": 0.06, "min": 0.23, "cnt": 128}, "fwd-attn":{"total": 115.22, "avg": 0.90, "max": 0.75, "min": 2.48, "cnt": 128}, "fwd-misc":{"total": 24.15, "avg": 0.19, "max": 0.12, "min": 0.69, "cnt": 128}, "fwd-MLP":{"total": 1524.65, "avg": 11.91, "max": 10.18, "min": 17.72, "cnt": 128}, "MoE_L0_fwd":{"total": 429.81, "avg": 13.43, "max": 10.10, "min": 17.63, "cnt": 32}, "MoEMLP":{"total": 1504.90, "avg": 11.76, "max": 10.06, "min": 17.57, "cnt": 128}, "MoE_L1_fwd":{"total": 373.87, "avg": 11.68, "max": 10.38, "min": 13.78, "cnt": 32}, "MoE_L2_fwd":{"total": 355.36, "avg": 11.10, "max": 10.48, "min": 15.34, "cnt": 32}, "MoE_L3_fwd":{"total": 353.13, "avg": 11.04, "max": 10.41, "min": 11.99, "cnt": 32}, "fwd-pooler":{"total": 0.39, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.64, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 0.93, "avg": 0.93, "max": 0.93, "min": 0.93, "cnt": 1}, "forward-send-backward-recv":{"total": 1651.74, "avg": 53.28, "max": 1.55, "min": 241.01, "cnt": 31}, "backward-compute":{"total": 1500.04, "avg": 46.88, "max": 43.39, "min": 50.02, "cnt": 32}, "MoE_L3_bwd":{"total": 374.05, "avg": 11.69, "max": 10.92, "min": 14.38, "cnt": 32}, "MoE_L2_bwd":{"total": 324.84, "avg": 10.15, "max": 9.42, "min": 10.90, "cnt": 32}, "MoE_L1_bwd":{"total": 297.96, "avg": 9.31, "max": 8.74, "min": 9.64, "cnt": 32}, "MoE_L0_bwd":{"total": 267.94, "avg": 8.37, "max": 7.90, "min": 8.78, "cnt": 32}, "backward-send-forward-recv":{"total": 2597.77, "avg": 86.59, "max": 1.93, "min": 389.35, "cnt": 30}, "backward-send":{"total": 1.84, "avg": 0.92, "max": 0.88, "min": 0.96, "cnt": 2}, "backward-recv":{"total": 67.19, "avg": 67.19, "max": 67.19, "min": 67.19, "cnt": 1}, "backward-params-all-reduce":{"total": 492.25, "avg": 492.25, "max": 492.25, "min": 492.25, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 275.16, "avg": 275.16, "max": 275.16, "min": 275.16, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 235.21, "avg": 235.21, "max": 235.21, "min": 235.21, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.50, "avg": 3.50, "max": 3.50, "min": 3.50, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.48, "avg": 3.48, "max": 3.48, "min": 3.48, "cnt": 1}}}
{"type":"time", "iteration": 89, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.10, "avg": 0.10, "max": 0.10, "min": 0.10, "cnt": 1}, "forward-recv":{"total": 135.69, "avg": 67.84, "max": 6.54, "min": 129.14, "cnt": 2}, "forward-compute":{"total": 1735.30, "avg": 54.23, "max": 47.86, "min": 61.85, "cnt": 32}, "fwd-compute":{"total": 1731.93, "avg": 54.12, "max": 47.77, "min": 61.74, "cnt": 32}, "batch-generator":{"total": 47.20, "avg": 1.48, "max": 0.75, "min": 3.44, "cnt": 32}, "fwd-embedding":{"total": 0.59, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1671.44, "avg": 52.23, "max": 46.65, "min": 59.40, "cnt": 32}, "fwd-layernorm":{"total": 10.43, "avg": 0.08, "max": 0.06, "min": 0.26, "cnt": 128}, "fwd-attn":{"total": 108.06, "avg": 0.84, "max": 0.75, "min": 2.30, "cnt": 128}, "fwd-misc":{"total": 22.42, "avg": 0.18, "max": 0.11, "min": 0.46, "cnt": 128}, "fwd-MLP":{"total": 1507.29, "avg": 11.78, "max": 9.98, "min": 19.14, "cnt": 128}, "MoE_L0_fwd":{"total": 440.45, "avg": 13.76, "max": 10.65, "min": 19.04, "cnt": 32}, "MoEMLP":{"total": 1489.38, "avg": 11.64, "max": 9.87, "min": 18.99, "cnt": 128}, "MoE_L1_fwd":{"total": 361.37, "avg": 11.29, "max": 10.21, "min": 13.59, "cnt": 32}, "MoE_L2_fwd":{"total": 340.77, "avg": 10.65, "max": 9.91, "min": 12.26, "cnt": 32}, "MoE_L3_fwd":{"total": 353.35, "avg": 11.04, "max": 10.30, "min": 15.69, "cnt": 32}, "fwd-pooler":{"total": 0.38, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.65, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 0.98, "avg": 0.98, "max": 0.98, "min": 0.98, "cnt": 1}, "forward-send-backward-recv":{"total": 856.03, "avg": 27.61, "max": 1.11, "min": 290.17, "cnt": 31}, "backward-compute":{"total": 1470.38, "avg": 45.95, "max": 43.55, "min": 48.70, "cnt": 32}, "MoE_L3_bwd":{"total": 363.67, "avg": 11.36, "max": 10.67, "min": 12.61, "cnt": 32}, "MoE_L2_bwd":{"total": 310.75, "avg": 9.71, "max": 8.96, "min": 10.46, "cnt": 32}, "MoE_L1_bwd":{"total": 297.29, "avg": 9.29, "max": 8.71, "min": 11.48, "cnt": 32}, "MoE_L0_bwd":{"total": 278.95, "avg": 8.72, "max": 8.01, "min": 10.82, "cnt": 32}, "backward-send-forward-recv":{"total": 4005.38, "avg": 133.51, "max": 1.95, "min": 589.64, "cnt": 30}, "backward-send":{"total": 2.13, "avg": 1.06, "max": 1.03, "min": 1.10, "cnt": 2}, "backward-recv":{"total": 63.50, "avg": 63.50, "max": 63.50, "min": 63.50, "cnt": 1}, "backward-params-all-reduce":{"total": 493.88, "avg": 493.88, "max": 493.88, "min": 493.88, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 283.48, "avg": 283.48, "max": 283.48, "min": 283.48, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.41, "avg": 3.41, "max": 3.41, "min": 3.41, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 237.11, "avg": 237.11, "max": 237.11, "min": 237.11, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.88, "avg": 3.88, "max": 3.88, "min": 3.88, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.50, "avg": 3.50, "max": 3.50, "min": 3.50, "cnt": 1}}}
{"type":"time", "iteration": 90, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 251.26, "avg": 125.63, "max": 1.63, "min": 249.63, "cnt": 2}, "forward-compute":{"total": 1817.38, "avg": 56.79, "max": 49.71, "min": 64.60, "cnt": 32}, "fwd-compute":{"total": 1813.97, "avg": 56.69, "max": 49.63, "min": 64.51, "cnt": 32}, "batch-generator":{"total": 45.16, "avg": 1.41, "max": 0.85, "min": 2.66, "cnt": 32}, "fwd-embedding":{"total": 0.64, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1754.52, "avg": 54.83, "max": 48.41, "min": 62.58, "cnt": 32}, "fwd-layernorm":{"total": 10.92, "avg": 0.09, "max": 0.06, "min": 0.24, "cnt": 128}, "fwd-attn":{"total": 114.90, "avg": 0.90, "max": 0.75, "min": 2.61, "cnt": 128}, "fwd-misc":{"total": 23.72, "avg": 0.19, "max": 0.12, "min": 0.45, "cnt": 128}, "fwd-MLP":{"total": 1580.45, "avg": 12.35, "max": 10.25, "min": 19.73, "cnt": 128}, "MoE_L0_fwd":{"total": 482.31, "avg": 15.07, "max": 10.74, "min": 19.66, "cnt": 32}, "MoEMLP":{"total": 1561.57, "avg": 12.20, "max": 10.14, "min": 19.61, "cnt": 128}, "MoE_L1_fwd":{"total": 371.85, "avg": 11.62, "max": 10.32, "min": 15.86, "cnt": 32}, "MoE_L2_fwd":{"total": 349.29, "avg": 10.92, "max": 10.19, "min": 14.44, "cnt": 32}, "MoE_L3_fwd":{"total": 364.97, "avg": 11.41, "max": 10.18, "min": 16.90, "cnt": 32}, "fwd-pooler":{"total": 0.38, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.70, "avg": 0.02, "max": 0.02, "min": 0.06, "cnt": 32}, "forward-send":{"total": 1.15, "avg": 1.15, "max": 1.15, "min": 1.15, "cnt": 1}, "forward-send-backward-recv":{"total": 282.62, "avg": 9.12, "max": 1.13, "min": 141.22, "cnt": 31}, "backward-compute":{"total": 1484.45, "avg": 46.39, "max": 44.62, "min": 49.01, "cnt": 32}, "MoE_L3_bwd":{"total": 368.00, "avg": 11.50, "max": 10.45, "min": 14.36, "cnt": 32}, "MoE_L2_bwd":{"total": 319.69, "avg": 9.99, "max": 9.35, "min": 11.07, "cnt": 32}, "MoE_L1_bwd":{"total": 283.60, "avg": 8.86, "max": 8.47, "min": 9.39, "cnt": 32}, "MoE_L0_bwd":{"total": 290.57, "avg": 9.08, "max": 8.57, "min": 9.42, "cnt": 32}, "backward-send-forward-recv":{"total": 3358.47, "avg": 111.95, "max": 2.39, "min": 427.69, "cnt": 30}, "backward-send":{"total": 2.21, "avg": 1.11, "max": 1.03, "min": 1.18, "cnt": 2}, "backward-recv":{"total": 70.44, "avg": 70.44, "max": 70.44, "min": 70.44, "cnt": 1}, "backward-params-all-reduce":{"total": 491.34, "avg": 491.34, "max": 491.34, "min": 491.34, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 279.54, "avg": 279.54, "max": 279.54, "min": 279.54, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 239.45, "avg": 239.45, "max": 239.45, "min": 239.45, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.69, "avg": 3.69, "max": 3.69, "min": 3.69, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 91, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 127.11, "avg": 63.56, "max": 1.33, "min": 125.78, "cnt": 2}, "forward-compute":{"total": 1853.67, "avg": 57.93, "max": 50.68, "min": 67.16, "cnt": 32}, "fwd-compute":{"total": 1849.66, "avg": 57.80, "max": 50.61, "min": 67.06, "cnt": 32}, "batch-generator":{"total": 49.79, "avg": 1.56, "max": 0.77, "min": 3.30, "cnt": 32}, "fwd-embedding":{"total": 0.83, "avg": 0.03, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1785.26, "avg": 55.79, "max": 49.34, "min": 65.62, "cnt": 32}, "fwd-layernorm":{"total": 12.27, "avg": 0.10, "max": 0.06, "min": 0.24, "cnt": 128}, "fwd-attn":{"total": 119.97, "avg": 0.94, "max": 0.75, "min": 2.21, "cnt": 128}, "fwd-misc":{"total": 24.79, "avg": 0.19, "max": 0.12, "min": 0.47, "cnt": 128}, "fwd-MLP":{"total": 1602.34, "avg": 12.52, "max": 10.40, "min": 18.48, "cnt": 128}, "MoE_L0_fwd":{"total": 477.53, "avg": 14.92, "max": 11.74, "min": 18.39, "cnt": 32}, "MoEMLP":{"total": 1582.59, "avg": 12.36, "max": 10.28, "min": 18.34, "cnt": 128}, "MoE_L1_fwd":{"total": 380.19, "avg": 11.88, "max": 10.38, "min": 16.16, "cnt": 32}, "MoE_L2_fwd":{"total": 367.34, "avg": 11.48, "max": 10.60, "min": 15.07, "cnt": 32}, "MoE_L3_fwd":{"total": 364.74, "avg": 11.40, "max": 10.33, "min": 15.51, "cnt": 32}, "fwd-pooler":{"total": 0.36, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.64, "avg": 0.02, "max": 0.02, "min": 0.04, "cnt": 32}, "forward-send":{"total": 0.87, "avg": 0.87, "max": 0.87, "min": 0.87, "cnt": 1}, "forward-send-backward-recv":{"total": 2993.99, "avg": 96.58, "max": 1.56, "min": 840.75, "cnt": 31}, "backward-compute":{"total": 1531.76, "avg": 47.87, "max": 46.28, "min": 51.56, "cnt": 32}, "MoE_L3_bwd":{"total": 381.50, "avg": 11.92, "max": 10.75, "min": 14.33, "cnt": 32}, "MoE_L2_bwd":{"total": 348.78, "avg": 10.90, "max": 10.27, "min": 12.70, "cnt": 32}, "MoE_L1_bwd":{"total": 289.56, "avg": 9.05, "max": 8.51, "min": 10.95, "cnt": 32}, "MoE_L0_bwd":{"total": 290.63, "avg": 9.08, "max": 8.65, "min": 9.76, "cnt": 32}, "backward-send-forward-recv":{"total": 1396.53, "avg": 46.55, "max": 1.58, "min": 355.77, "cnt": 30}, "backward-send":{"total": 1.79, "avg": 0.90, "max": 0.89, "min": 0.91, "cnt": 2}, "backward-recv":{"total": 64.49, "avg": 64.49, "max": 64.49, "min": 64.49, "cnt": 1}, "backward-params-all-reduce":{"total": 493.38, "avg": 493.38, "max": 493.38, "min": 493.38, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 272.40, "avg": 272.40, "max": 272.40, "min": 272.40, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.40, "avg": 3.40, "max": 3.40, "min": 3.40, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 232.43, "avg": 232.43, "max": 232.43, "min": 232.43, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.59, "avg": 3.59, "max": 3.59, "min": 3.59, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 92, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 129.35, "avg": 64.68, "max": 1.34, "min": 128.02, "cnt": 2}, "forward-compute":{"total": 1804.55, "avg": 56.39, "max": 48.10, "min": 64.70, "cnt": 32}, "fwd-compute":{"total": 1801.00, "avg": 56.28, "max": 48.01, "min": 64.54, "cnt": 32}, "batch-generator":{"total": 55.83, "avg": 1.74, "max": 0.76, "min": 3.51, "cnt": 32}, "fwd-embedding":{"total": 0.68, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1730.67, "avg": 54.08, "max": 46.91, "min": 62.42, "cnt": 32}, "fwd-layernorm":{"total": 10.98, "avg": 0.09, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 113.98, "avg": 0.89, "max": 0.75, "min": 3.93, "cnt": 128}, "fwd-misc":{"total": 22.98, "avg": 0.18, "max": 0.12, "min": 0.42, "cnt": 128}, "fwd-MLP":{"total": 1558.46, "avg": 12.18, "max": 10.16, "min": 17.54, "cnt": 128}, "MoE_L0_fwd":{"total": 456.15, "avg": 14.25, "max": 10.42, "min": 17.45, "cnt": 32}, "MoEMLP":{"total": 1540.07, "avg": 12.03, "max": 10.04, "min": 17.40, "cnt": 128}, "MoE_L1_fwd":{"total": 379.82, "avg": 11.87, "max": 10.09, "min": 16.99, "cnt": 32}, "MoE_L2_fwd":{"total": 352.26, "avg": 11.01, "max": 10.36, "min": 13.73, "cnt": 32}, "MoE_L3_fwd":{"total": 358.60, "avg": 11.21, "max": 10.50, "min": 14.32, "cnt": 32}, "fwd-pooler":{"total": 0.39, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.70, "avg": 0.02, "max": 0.02, "min": 0.05, "cnt": 32}, "forward-send":{"total": 0.95, "avg": 0.95, "max": 0.95, "min": 0.95, "cnt": 1}, "forward-send-backward-recv":{"total": 1601.10, "avg": 51.65, "max": 1.03, "min": 314.50, "cnt": 31}, "backward-compute":{"total": 1500.09, "avg": 46.88, "max": 44.52, "min": 50.35, "cnt": 32}, "MoE_L3_bwd":{"total": 376.86, "avg": 11.78, "max": 10.68, "min": 14.63, "cnt": 32}, "MoE_L2_bwd":{"total": 321.72, "avg": 10.05, "max": 9.33, "min": 10.89, "cnt": 32}, "MoE_L1_bwd":{"total": 293.87, "avg": 9.18, "max": 8.70, "min": 11.58, "cnt": 32}, "MoE_L0_bwd":{"total": 289.77, "avg": 9.06, "max": 8.65, "min": 9.62, "cnt": 32}, "backward-send-forward-recv":{"total": 3017.48, "avg": 100.58, "max": 2.07, "min": 438.44, "cnt": 30}, "backward-send":{"total": 2.02, "avg": 1.01, "max": 0.98, "min": 1.04, "cnt": 2}, "backward-recv":{"total": 65.04, "avg": 65.04, "max": 65.04, "min": 65.04, "cnt": 1}, "backward-params-all-reduce":{"total": 485.05, "avg": 485.05, "max": 485.05, "min": 485.05, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 285.22, "avg": 285.22, "max": 285.22, "min": 285.22, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 241.05, "avg": 241.05, "max": 241.05, "min": 241.05, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.35, "avg": 3.35, "max": 3.35, "min": 3.35, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 93, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 114.89, "avg": 57.45, "max": 3.81, "min": 111.08, "cnt": 2}, "forward-compute":{"total": 1812.98, "avg": 56.66, "max": 48.98, "min": 64.53, "cnt": 32}, "fwd-compute":{"total": 1809.19, "avg": 56.54, "max": 48.90, "min": 64.39, "cnt": 32}, "batch-generator":{"total": 49.18, "avg": 1.54, "max": 0.76, "min": 2.07, "cnt": 32}, "fwd-embedding":{"total": 0.80, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1745.12, "avg": 54.54, "max": 47.73, "min": 62.32, "cnt": 32}, "fwd-layernorm":{"total": 11.91, "avg": 0.09, "max": 0.06, "min": 0.24, "cnt": 128}, "fwd-attn":{"total": 116.91, "avg": 0.91, "max": 0.75, "min": 1.71, "cnt": 128}, "fwd-misc":{"total": 24.81, "avg": 0.19, "max": 0.12, "min": 0.41, "cnt": 128}, "fwd-MLP":{"total": 1565.07, "avg": 12.23, "max": 10.54, "min": 17.39, "cnt": 128}, "MoE_L0_fwd":{"total": 462.71, "avg": 14.46, "max": 10.70, "min": 17.26, "cnt": 32}, "MoEMLP":{"total": 1545.01, "avg": 12.07, "max": 10.43, "min": 17.21, "cnt": 128}, "MoE_L1_fwd":{"total": 385.73, "avg": 12.05, "max": 10.70, "min": 16.35, "cnt": 32}, "MoE_L2_fwd":{"total": 351.66, "avg": 10.99, "max": 10.51, "min": 12.20, "cnt": 32}, "MoE_L3_fwd":{"total": 352.09, "avg": 11.00, "max": 10.47, "min": 13.35, "cnt": 32}, "fwd-pooler":{"total": 0.38, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.65, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.00, "avg": 1.00, "max": 1.00, "min": 1.00, "cnt": 1}, "forward-send-backward-recv":{"total": 1984.21, "avg": 64.01, "max": 1.61, "min": 235.28, "cnt": 31}, "backward-compute":{"total": 1492.11, "avg": 46.63, "max": 44.46, "min": 48.41, "cnt": 32}, "MoE_L3_bwd":{"total": 365.16, "avg": 11.41, "max": 10.27, "min": 12.58, "cnt": 32}, "MoE_L2_bwd":{"total": 320.54, "avg": 10.02, "max": 9.50, "min": 11.28, "cnt": 32}, "MoE_L1_bwd":{"total": 297.54, "avg": 9.30, "max": 8.79, "min": 9.86, "cnt": 32}, "MoE_L0_bwd":{"total": 297.10, "avg": 9.28, "max": 8.91, "min": 9.63, "cnt": 32}, "backward-send-forward-recv":{"total": 963.34, "avg": 32.11, "max": 1.82, "min": 233.64, "cnt": 30}, "backward-send":{"total": 1.93, "avg": 0.97, "max": 0.93, "min": 1.00, "cnt": 2}, "backward-recv":{"total": 65.54, "avg": 65.54, "max": 65.54, "min": 65.54, "cnt": 1}, "backward-params-all-reduce":{"total": 486.65, "avg": 486.65, "max": 486.65, "min": 486.65, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 278.12, "avg": 278.12, "max": 278.12, "min": 278.12, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 238.26, "avg": 238.26, "max": 238.26, "min": 238.26, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.48, "avg": 3.48, "max": 3.48, "min": 3.48, "cnt": 1}}}
{"type":"time", "iteration": 94, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 120.49, "avg": 60.24, "max": 1.42, "min": 119.07, "cnt": 2}, "forward-compute":{"total": 1777.44, "avg": 55.55, "max": 49.54, "min": 60.49, "cnt": 32}, "fwd-compute":{"total": 1774.01, "avg": 55.44, "max": 49.46, "min": 60.40, "cnt": 32}, "batch-generator":{"total": 41.50, "avg": 1.30, "max": 0.67, "min": 2.13, "cnt": 32}, "fwd-embedding":{"total": 0.58, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1718.28, "avg": 53.70, "max": 48.41, "min": 58.97, "cnt": 32}, "fwd-layernorm":{"total": 10.44, "avg": 0.08, "max": 0.06, "min": 0.22, "cnt": 128}, "fwd-attn":{"total": 108.29, "avg": 0.85, "max": 0.75, "min": 1.84, "cnt": 128}, "fwd-misc":{"total": 21.90, "avg": 0.17, "max": 0.12, "min": 0.42, "cnt": 128}, "fwd-MLP":{"total": 1554.20, "avg": 12.14, "max": 10.34, "min": 20.00, "cnt": 128}, "MoE_L0_fwd":{"total": 453.41, "avg": 14.17, "max": 10.63, "min": 19.92, "cnt": 32}, "MoEMLP":{"total": 1536.09, "avg": 12.00, "max": 10.21, "min": 19.87, "cnt": 128}, "MoE_L1_fwd":{"total": 375.50, "avg": 11.73, "max": 10.32, "min": 14.72, "cnt": 32}, "MoE_L2_fwd":{"total": 360.55, "avg": 11.27, "max": 10.62, "min": 14.00, "cnt": 32}, "MoE_L3_fwd":{"total": 353.15, "avg": 11.04, "max": 10.25, "min": 11.80, "cnt": 32}, "fwd-pooler":{"total": 0.37, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.65, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 0.98, "avg": 0.98, "max": 0.98, "min": 0.98, "cnt": 1}, "forward-send-backward-recv":{"total": 410.23, "avg": 13.23, "max": 1.36, "min": 102.06, "cnt": 31}, "backward-compute":{"total": 1532.50, "avg": 47.89, "max": 44.11, "min": 51.67, "cnt": 32}, "MoE_L3_bwd":{"total": 378.54, "avg": 11.83, "max": 11.03, "min": 15.61, "cnt": 32}, "MoE_L2_bwd":{"total": 332.06, "avg": 10.38, "max": 9.43, "min": 12.03, "cnt": 32}, "MoE_L1_bwd":{"total": 294.75, "avg": 9.21, "max": 8.72, "min": 9.92, "cnt": 32}, "MoE_L0_bwd":{"total": 296.96, "avg": 9.28, "max": 8.81, "min": 9.97, "cnt": 32}, "backward-send-forward-recv":{"total": 2395.57, "avg": 79.85, "max": 2.29, "min": 279.76, "cnt": 30}, "backward-send":{"total": 1.84, "avg": 0.92, "max": 0.76, "min": 1.08, "cnt": 2}, "backward-recv":{"total": 61.47, "avg": 61.47, "max": 61.47, "min": 61.47, "cnt": 1}, "backward-params-all-reduce":{"total": 490.48, "avg": 490.48, "max": 490.48, "min": 490.48, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 291.27, "avg": 291.27, "max": 291.27, "min": 291.27, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 251.48, "avg": 251.48, "max": 251.48, "min": 251.48, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.31, "avg": 3.31, "max": 3.31, "min": 3.31, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 95, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 132.59, "avg": 66.30, "max": 1.28, "min": 131.31, "cnt": 2}, "forward-compute":{"total": 1789.78, "avg": 55.93, "max": 48.66, "min": 67.48, "cnt": 32}, "fwd-compute":{"total": 1786.46, "avg": 55.83, "max": 48.57, "min": 67.39, "cnt": 32}, "batch-generator":{"total": 41.80, "avg": 1.31, "max": 0.73, "min": 2.05, "cnt": 32}, "fwd-embedding":{"total": 0.56, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1731.54, "avg": 54.11, "max": 47.50, "min": 65.18, "cnt": 32}, "fwd-layernorm":{"total": 10.38, "avg": 0.08, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 107.93, "avg": 0.84, "max": 0.75, "min": 1.52, "cnt": 128}, "fwd-misc":{"total": 21.80, "avg": 0.17, "max": 0.12, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1567.83, "avg": 12.25, "max": 10.40, "min": 17.92, "cnt": 128}, "MoE_L0_fwd":{"total": 458.76, "avg": 14.34, "max": 10.59, "min": 17.83, "cnt": 32}, "MoEMLP":{"total": 1549.80, "avg": 12.11, "max": 10.29, "min": 17.77, "cnt": 128}, "MoE_L1_fwd":{"total": 368.98, "avg": 11.53, "max": 10.37, "min": 13.20, "cnt": 32}, "MoE_L2_fwd":{"total": 373.01, "avg": 11.66, "max": 10.88, "min": 16.23, "cnt": 32}, "MoE_L3_fwd":{"total": 355.67, "avg": 11.11, "max": 10.33, "min": 13.36, "cnt": 32}, "fwd-pooler":{"total": 0.38, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.66, "avg": 0.02, "max": 0.02, "min": 0.04, "cnt": 32}, "forward-send":{"total": 0.92, "avg": 0.92, "max": 0.92, "min": 0.92, "cnt": 1}, "forward-send-backward-recv":{"total": 521.66, "avg": 16.83, "max": 1.43, "min": 149.96, "cnt": 31}, "backward-compute":{"total": 1542.10, "avg": 48.19, "max": 45.48, "min": 51.31, "cnt": 32}, "MoE_L3_bwd":{"total": 379.37, "avg": 11.86, "max": 10.60, "min": 13.66, "cnt": 32}, "MoE_L2_bwd":{"total": 341.21, "avg": 10.66, "max": 9.64, "min": 12.66, "cnt": 32}, "MoE_L1_bwd":{"total": 293.38, "avg": 9.17, "max": 8.70, "min": 10.54, "cnt": 32}, "MoE_L0_bwd":{"total": 303.54, "avg": 9.49, "max": 8.67, "min": 11.49, "cnt": 32}, "backward-send-forward-recv":{"total": 2120.23, "avg": 70.67, "max": 2.08, "min": 316.28, "cnt": 30}, "backward-send":{"total": 2.10, "avg": 1.05, "max": 1.02, "min": 1.08, "cnt": 2}, "backward-recv":{"total": 97.17, "avg": 97.17, "max": 97.17, "min": 97.17, "cnt": 1}, "backward-params-all-reduce":{"total": 488.14, "avg": 488.14, "max": 488.14, "min": 488.14, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 279.86, "avg": 279.86, "max": 279.86, "min": 279.86, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 239.94, "avg": 239.94, "max": 239.94, "min": 239.94, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.48, "avg": 3.48, "max": 3.48, "min": 3.48, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 96, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 129.18, "avg": 64.59, "max": 5.83, "min": 123.35, "cnt": 2}, "forward-compute":{"total": 1765.92, "avg": 55.18, "max": 48.51, "min": 61.12, "cnt": 32}, "fwd-compute":{"total": 1762.56, "avg": 55.08, "max": 48.43, "min": 61.00, "cnt": 32}, "batch-generator":{"total": 43.42, "avg": 1.36, "max": 0.78, "min": 2.14, "cnt": 32}, "fwd-embedding":{"total": 0.64, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1705.23, "avg": 53.29, "max": 47.29, "min": 58.67, "cnt": 32}, "fwd-layernorm":{"total": 10.42, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 108.29, "avg": 0.85, "max": 0.75, "min": 1.49, "cnt": 128}, "fwd-misc":{"total": 22.29, "avg": 0.17, "max": 0.12, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1540.48, "avg": 12.03, "max": 10.05, "min": 18.72, "cnt": 128}, "MoE_L0_fwd":{"total": 447.03, "avg": 13.97, "max": 10.61, "min": 18.63, "cnt": 32}, "MoEMLP":{"total": 1522.43, "avg": 11.89, "max": 9.94, "min": 18.59, "cnt": 128}, "MoE_L1_fwd":{"total": 360.63, "avg": 11.27, "max": 9.98, "min": 12.79, "cnt": 32}, "MoE_L2_fwd":{"total": 363.94, "avg": 11.37, "max": 10.82, "min": 13.56, "cnt": 32}, "MoE_L3_fwd":{"total": 357.36, "avg": 11.17, "max": 10.59, "min": 13.24, "cnt": 32}, "fwd-pooler":{"total": 0.37, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.64, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 0.92, "avg": 0.92, "max": 0.92, "min": 0.92, "cnt": 1}, "forward-send-backward-recv":{"total": 141.33, "avg": 4.56, "max": 1.16, "min": 52.56, "cnt": 31}, "backward-compute":{"total": 1537.97, "avg": 48.06, "max": 45.93, "min": 50.74, "cnt": 32}, "MoE_L3_bwd":{"total": 382.22, "avg": 11.94, "max": 11.24, "min": 15.19, "cnt": 32}, "MoE_L2_bwd":{"total": 338.03, "avg": 10.56, "max": 9.85, "min": 11.64, "cnt": 32}, "MoE_L1_bwd":{"total": 291.94, "avg": 9.12, "max": 8.44, "min": 10.44, "cnt": 32}, "MoE_L0_bwd":{"total": 304.66, "avg": 9.52, "max": 9.11, "min": 10.15, "cnt": 32}, "backward-send-forward-recv":{"total": 2672.99, "avg": 89.10, "max": 1.67, "min": 312.52, "cnt": 30}, "backward-send":{"total": 2.07, "avg": 1.04, "max": 1.01, "min": 1.06, "cnt": 2}, "backward-recv":{"total": 68.87, "avg": 68.87, "max": 68.87, "min": 68.87, "cnt": 1}, "backward-params-all-reduce":{"total": 486.33, "avg": 486.33, "max": 486.33, "min": 486.33, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 284.29, "avg": 284.29, "max": 284.29, "min": 284.29, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 244.41, "avg": 244.41, "max": 244.41, "min": 244.41, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.41, "avg": 3.41, "max": 3.41, "min": 3.41, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 97, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 132.46, "avg": 66.23, "max": 1.26, "min": 131.20, "cnt": 2}, "forward-compute":{"total": 1763.62, "avg": 55.11, "max": 48.67, "min": 65.46, "cnt": 32}, "fwd-compute":{"total": 1760.40, "avg": 55.01, "max": 48.57, "min": 65.37, "cnt": 32}, "batch-generator":{"total": 39.61, "avg": 1.24, "max": 0.78, "min": 2.81, "cnt": 32}, "fwd-embedding":{"total": 0.54, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1707.81, "avg": 53.37, "max": 47.18, "min": 63.93, "cnt": 32}, "fwd-layernorm":{"total": 10.08, "avg": 0.08, "max": 0.06, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 107.07, "avg": 0.84, "max": 0.75, "min": 1.55, "cnt": 128}, "fwd-misc":{"total": 21.71, "avg": 0.17, "max": 0.12, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1545.38, "avg": 12.07, "max": 9.87, "min": 21.35, "cnt": 128}, "MoE_L0_fwd":{"total": 456.54, "avg": 14.27, "max": 11.02, "min": 21.20, "cnt": 32}, "MoEMLP":{"total": 1527.19, "avg": 11.93, "max": 9.76, "min": 21.12, "cnt": 128}, "MoE_L1_fwd":{"total": 362.29, "avg": 11.32, "max": 9.80, "min": 13.45, "cnt": 32}, "MoE_L2_fwd":{"total": 356.53, "avg": 11.14, "max": 10.66, "min": 11.99, "cnt": 32}, "MoE_L3_fwd":{"total": 358.34, "avg": 11.20, "max": 10.61, "min": 12.13, "cnt": 32}, "fwd-pooler":{"total": 0.38, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.66, "avg": 0.02, "max": 0.02, "min": 0.04, "cnt": 32}, "forward-send":{"total": 1.02, "avg": 1.02, "max": 1.02, "min": 1.02, "cnt": 1}, "forward-send-backward-recv":{"total": 200.13, "avg": 6.46, "max": 1.70, "min": 55.07, "cnt": 31}, "backward-compute":{"total": 1519.64, "avg": 47.49, "max": 44.49, "min": 51.07, "cnt": 32}, "MoE_L3_bwd":{"total": 382.04, "avg": 11.94, "max": 11.13, "min": 14.69, "cnt": 32}, "MoE_L2_bwd":{"total": 324.72, "avg": 10.15, "max": 9.25, "min": 10.99, "cnt": 32}, "MoE_L1_bwd":{"total": 278.85, "avg": 8.71, "max": 8.21, "min": 10.00, "cnt": 32}, "MoE_L0_bwd":{"total": 315.49, "avg": 9.86, "max": 9.18, "min": 12.42, "cnt": 32}, "backward-send-forward-recv":{"total": 2694.94, "avg": 89.83, "max": 2.20, "min": 652.74, "cnt": 30}, "backward-send":{"total": 2.09, "avg": 1.04, "max": 0.93, "min": 1.16, "cnt": 2}, "backward-recv":{"total": 61.24, "avg": 61.24, "max": 61.24, "min": 61.24, "cnt": 1}, "backward-params-all-reduce":{"total": 491.84, "avg": 491.84, "max": 491.84, "min": 491.84, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 273.52, "avg": 273.52, "max": 273.52, "min": 273.52, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.36, "avg": 3.36, "max": 3.36, "min": 3.36, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 233.81, "avg": 233.81, "max": 233.81, "min": 233.81, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.35, "avg": 3.35, "max": 3.35, "min": 3.35, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 98, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.10, "avg": 0.10, "max": 0.10, "min": 0.10, "cnt": 1}, "forward-recv":{"total": 153.00, "avg": 76.50, "max": 2.25, "min": 150.76, "cnt": 2}, "forward-compute":{"total": 1784.48, "avg": 55.77, "max": 50.07, "min": 61.95, "cnt": 32}, "fwd-compute":{"total": 1781.20, "avg": 55.66, "max": 49.98, "min": 61.86, "cnt": 32}, "batch-generator":{"total": 44.11, "avg": 1.38, "max": 0.73, "min": 2.38, "cnt": 32}, "fwd-embedding":{"total": 0.58, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1723.81, "avg": 53.87, "max": 48.70, "min": 59.62, "cnt": 32}, "fwd-layernorm":{"total": 10.28, "avg": 0.08, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 109.12, "avg": 0.85, "max": 0.75, "min": 1.53, "cnt": 128}, "fwd-misc":{"total": 21.65, "avg": 0.17, "max": 0.12, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1559.11, "avg": 12.18, "max": 10.10, "min": 19.93, "cnt": 128}, "MoE_L0_fwd":{"total": 464.05, "avg": 14.50, "max": 11.10, "min": 19.82, "cnt": 32}, "MoEMLP":{"total": 1541.04, "avg": 12.04, "max": 9.99, "min": 19.77, "cnt": 128}, "MoE_L1_fwd":{"total": 364.92, "avg": 11.40, "max": 10.03, "min": 14.32, "cnt": 32}, "MoE_L2_fwd":{"total": 360.95, "avg": 11.28, "max": 10.59, "min": 11.98, "cnt": 32}, "MoE_L3_fwd":{"total": 357.62, "avg": 11.18, "max": 10.61, "min": 13.61, "cnt": 32}, "fwd-pooler":{"total": 0.37, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.66, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 0.96, "avg": 0.96, "max": 0.96, "min": 0.96, "cnt": 1}, "forward-send-backward-recv":{"total": 539.21, "avg": 17.39, "max": 1.34, "min": 140.45, "cnt": 31}, "backward-compute":{"total": 1518.96, "avg": 47.47, "max": 45.35, "min": 49.91, "cnt": 32}, "MoE_L3_bwd":{"total": 380.13, "avg": 11.88, "max": 10.91, "min": 14.34, "cnt": 32}, "MoE_L2_bwd":{"total": 340.93, "avg": 10.65, "max": 9.68, "min": 11.49, "cnt": 32}, "MoE_L1_bwd":{"total": 279.52, "avg": 8.74, "max": 8.01, "min": 10.58, "cnt": 32}, "MoE_L0_bwd":{"total": 302.92, "avg": 9.47, "max": 9.06, "min": 11.20, "cnt": 32}, "backward-send-forward-recv":{"total": 3194.12, "avg": 106.47, "max": 1.76, "min": 361.48, "cnt": 30}, "backward-send":{"total": 2.08, "avg": 1.04, "max": 1.02, "min": 1.05, "cnt": 2}, "backward-recv":{"total": 67.62, "avg": 67.62, "max": 67.62, "min": 67.62, "cnt": 1}, "backward-params-all-reduce":{"total": 486.29, "avg": 486.29, "max": 486.29, "min": 486.29, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 293.05, "avg": 293.05, "max": 293.05, "min": 293.05, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 253.04, "avg": 253.04, "max": 253.04, "min": 253.04, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.51, "avg": 3.51, "max": 3.51, "min": 3.51, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 99, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 130.35, "avg": 65.17, "max": 2.40, "min": 127.94, "cnt": 2}, "forward-compute":{"total": 1844.07, "avg": 57.63, "max": 49.68, "min": 67.81, "cnt": 32}, "fwd-compute":{"total": 1840.26, "avg": 57.51, "max": 49.60, "min": 67.67, "cnt": 32}, "batch-generator":{"total": 49.23, "avg": 1.54, "max": 0.75, "min": 3.48, "cnt": 32}, "fwd-embedding":{"total": 0.79, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1776.61, "avg": 55.52, "max": 48.48, "min": 65.33, "cnt": 32}, "fwd-layernorm":{"total": 11.82, "avg": 0.09, "max": 0.06, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 116.75, "avg": 0.91, "max": 0.75, "min": 1.58, "cnt": 128}, "fwd-misc":{"total": 24.11, "avg": 0.19, "max": 0.12, "min": 0.38, "cnt": 128}, "fwd-MLP":{"total": 1598.38, "avg": 12.49, "max": 10.22, "min": 21.64, "cnt": 128}, "MoE_L0_fwd":{"total": 477.97, "avg": 14.94, "max": 10.59, "min": 21.46, "cnt": 32}, "MoEMLP":{"total": 1578.78, "avg": 12.33, "max": 10.10, "min": 21.37, "cnt": 128}, "MoE_L1_fwd":{"total": 377.12, "avg": 11.78, "max": 10.14, "min": 16.37, "cnt": 32}, "MoE_L2_fwd":{"total": 374.02, "avg": 11.69, "max": 10.88, "min": 13.57, "cnt": 32}, "MoE_L3_fwd":{"total": 356.75, "avg": 11.15, "max": 10.64, "min": 11.87, "cnt": 32}, "fwd-pooler":{"total": 0.37, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.63, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.00, "avg": 1.00, "max": 1.00, "min": 1.00, "cnt": 1}, "forward-send-backward-recv":{"total": 4223.04, "avg": 136.23, "max": 1.93, "min": 1336.91, "cnt": 31}, "backward-compute":{"total": 1532.97, "avg": 47.91, "max": 45.22, "min": 54.27, "cnt": 32}, "MoE_L3_bwd":{"total": 383.50, "avg": 11.98, "max": 11.05, "min": 18.04, "cnt": 32}, "MoE_L2_bwd":{"total": 355.05, "avg": 11.10, "max": 10.41, "min": 13.30, "cnt": 32}, "MoE_L1_bwd":{"total": 274.63, "avg": 8.58, "max": 8.06, "min": 9.53, "cnt": 32}, "MoE_L0_bwd":{"total": 303.98, "avg": 9.50, "max": 9.04, "min": 10.15, "cnt": 32}, "backward-send-forward-recv":{"total": 1433.46, "avg": 47.78, "max": 1.65, "min": 534.54, "cnt": 30}, "backward-send":{"total": 2.05, "avg": 1.02, "max": 1.01, "min": 1.04, "cnt": 2}, "backward-recv":{"total": 66.94, "avg": 66.94, "max": 66.94, "min": 66.94, "cnt": 1}, "backward-params-all-reduce":{"total": 487.94, "avg": 487.94, "max": 487.94, "min": 487.94, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 281.77, "avg": 281.77, "max": 281.77, "min": 281.77, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 241.95, "avg": 241.95, "max": 241.95, "min": 241.95, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 100, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 402.95, "avg": 201.47, "max": 1.22, "min": 401.73, "cnt": 2}, "forward-compute":{"total": 1913.26, "avg": 59.79, "max": 48.55, "min": 204.52, "cnt": 32}, "fwd-compute":{"total": 1909.50, "avg": 59.67, "max": 48.47, "min": 204.31, "cnt": 32}, "batch-generator":{"total": 51.64, "avg": 1.61, "max": 0.78, "min": 4.95, "cnt": 32}, "fwd-embedding":{"total": 0.79, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1842.71, "avg": 57.58, "max": 46.64, "min": 201.97, "cnt": 32}, "fwd-layernorm":{"total": 11.77, "avg": 0.09, "max": 0.06, "min": 0.22, "cnt": 128}, "fwd-attn":{"total": 117.77, "avg": 0.92, "max": 0.75, "min": 2.27, "cnt": 128}, "fwd-misc":{"total": 23.96, "avg": 0.19, "max": 0.12, "min": 0.52, "cnt": 128}, "fwd-MLP":{"total": 1664.20, "avg": 13.00, "max": 9.25, "min": 160.49, "cnt": 128}, "MoE_L0_fwd":{"total": 558.70, "avg": 17.46, "max": 9.17, "min": 160.40, "cnt": 32}, "MoEMLP":{"total": 1644.92, "avg": 12.85, "max": 9.11, "min": 160.35, "cnt": 128}, "MoE_L1_fwd":{"total": 369.35, "avg": 11.54, "max": 9.99, "min": 14.19, "cnt": 32}, "MoE_L2_fwd":{"total": 367.85, "avg": 11.50, "max": 10.92, "min": 12.82, "cnt": 32}, "MoE_L3_fwd":{"total": 355.96, "avg": 11.12, "max": 10.54, "min": 12.59, "cnt": 32}, "fwd-pooler":{"total": 0.38, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.68, "avg": 0.02, "max": 0.02, "min": 0.07, "cnt": 32}, "forward-send":{"total": 0.73, "avg": 0.73, "max": 0.73, "min": 0.73, "cnt": 1}, "forward-send-backward-recv":{"total": 848.67, "avg": 27.38, "max": 1.89, "min": 186.31, "cnt": 31}, "backward-compute":{"total": 1459.95, "avg": 45.62, "max": 43.71, "min": 47.63, "cnt": 32}, "MoE_L3_bwd":{"total": 373.08, "avg": 11.66, "max": 10.93, "min": 13.10, "cnt": 32}, "MoE_L2_bwd":{"total": 343.78, "avg": 10.74, "max": 10.10, "min": 11.29, "cnt": 32}, "MoE_L1_bwd":{"total": 279.11, "avg": 8.72, "max": 8.14, "min": 9.79, "cnt": 32}, "MoE_L0_bwd":{"total": 243.57, "avg": 7.61, "max": 6.97, "min": 8.25, "cnt": 32}, "backward-send-forward-recv":{"total": 2463.47, "avg": 82.12, "max": 2.20, "min": 697.53, "cnt": 30}, "backward-send":{"total": 2.06, "avg": 1.03, "max": 0.97, "min": 1.09, "cnt": 2}, "backward-recv":{"total": 67.01, "avg": 67.01, "max": 67.01, "min": 67.01, "cnt": 1}, "backward-params-all-reduce":{"total": 489.20, "avg": 489.20, "max": 489.20, "min": 489.20, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 278.04, "avg": 278.04, "max": 278.04, "min": 278.04, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 238.25, "avg": 238.25, "max": 238.25, "min": 238.25, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.41, "avg": 3.41, "max": 3.41, "min": 3.41, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.47, "avg": 3.47, "max": 3.47, "min": 3.47, "cnt": 1}}}
{"type":"time", "iteration": 101, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 142.70, "avg": 71.35, "max": 11.29, "min": 131.42, "cnt": 2}, "forward-compute":{"total": 1773.33, "avg": 55.42, "max": 50.01, "min": 62.60, "cnt": 32}, "fwd-compute":{"total": 1770.10, "avg": 55.32, "max": 49.93, "min": 62.46, "cnt": 32}, "batch-generator":{"total": 40.19, "avg": 1.26, "max": 0.75, "min": 1.90, "cnt": 32}, "fwd-embedding":{"total": 0.55, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1716.96, "avg": 53.66, "max": 48.74, "min": 60.18, "cnt": 32}, "fwd-layernorm":{"total": 10.18, "avg": 0.08, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 107.93, "avg": 0.84, "max": 0.75, "min": 1.47, "cnt": 128}, "fwd-misc":{"total": 21.92, "avg": 0.17, "max": 0.12, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1553.29, "avg": 12.14, "max": 9.98, "min": 17.85, "cnt": 128}, "MoE_L0_fwd":{"total": 445.30, "avg": 13.92, "max": 9.90, "min": 17.75, "cnt": 32}, "MoEMLP":{"total": 1535.28, "avg": 11.99, "max": 9.86, "min": 17.70, "cnt": 128}, "MoE_L1_fwd":{"total": 372.96, "avg": 11.66, "max": 10.23, "min": 15.48, "cnt": 32}, "MoE_L2_fwd":{"total": 363.80, "avg": 11.37, "max": 10.80, "min": 15.46, "cnt": 32}, "MoE_L3_fwd":{"total": 359.76, "avg": 11.24, "max": 10.82, "min": 12.35, "cnt": 32}, "fwd-pooler":{"total": 0.39, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.64, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 0.89, "avg": 0.89, "max": 0.89, "min": 0.89, "cnt": 1}, "forward-send-backward-recv":{"total": 200.53, "avg": 6.47, "max": 1.30, "min": 47.55, "cnt": 31}, "backward-compute":{"total": 1452.44, "avg": 45.39, "max": 42.71, "min": 47.47, "cnt": 32}, "MoE_L3_bwd":{"total": 379.37, "avg": 11.86, "max": 10.84, "min": 13.13, "cnt": 32}, "MoE_L2_bwd":{"total": 331.00, "avg": 10.34, "max": 9.29, "min": 11.15, "cnt": 32}, "MoE_L1_bwd":{"total": 280.54, "avg": 8.77, "max": 8.27, "min": 9.15, "cnt": 32}, "MoE_L0_bwd":{"total": 243.18, "avg": 7.60, "max": 6.98, "min": 8.09, "cnt": 32}, "backward-send-forward-recv":{"total": 2913.50, "avg": 97.12, "max": 1.99, "min": 273.10, "cnt": 30}, "backward-send":{"total": 2.15, "avg": 1.08, "max": 1.05, "min": 1.10, "cnt": 2}, "backward-recv":{"total": 69.31, "avg": 69.31, "max": 69.31, "min": 69.31, "cnt": 1}, "backward-params-all-reduce":{"total": 488.54, "avg": 488.54, "max": 488.54, "min": 488.54, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 281.24, "avg": 281.24, "max": 281.24, "min": 281.24, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 238.87, "avg": 238.87, "max": 238.87, "min": 238.87, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.59, "avg": 3.59, "max": 3.59, "min": 3.59, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 102, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 127.79, "avg": 63.90, "max": 2.10, "min": 125.70, "cnt": 2}, "forward-compute":{"total": 1809.30, "avg": 56.54, "max": 50.36, "min": 59.56, "cnt": 32}, "fwd-compute":{"total": 1805.61, "avg": 56.43, "max": 50.28, "min": 59.47, "cnt": 32}, "batch-generator":{"total": 46.81, "avg": 1.46, "max": 0.71, "min": 2.58, "cnt": 32}, "fwd-embedding":{"total": 0.76, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1744.72, "avg": 54.52, "max": 49.07, "min": 57.80, "cnt": 32}, "fwd-layernorm":{"total": 11.73, "avg": 0.09, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 115.69, "avg": 0.90, "max": 0.75, "min": 1.73, "cnt": 128}, "fwd-misc":{"total": 24.34, "avg": 0.19, "max": 0.12, "min": 0.47, "cnt": 128}, "fwd-MLP":{"total": 1567.63, "avg": 12.25, "max": 10.53, "min": 17.76, "cnt": 128}, "MoE_L0_fwd":{"total": 450.64, "avg": 14.08, "max": 10.86, "min": 17.63, "cnt": 32}, "MoEMLP":{"total": 1548.10, "avg": 12.09, "max": 10.38, "min": 17.55, "cnt": 128}, "MoE_L1_fwd":{"total": 371.08, "avg": 11.60, "max": 10.45, "min": 12.65, "cnt": 32}, "MoE_L2_fwd":{"total": 363.74, "avg": 11.37, "max": 10.75, "min": 12.26, "cnt": 32}, "MoE_L3_fwd":{"total": 369.79, "avg": 11.56, "max": 10.76, "min": 16.36, "cnt": 32}, "fwd-pooler":{"total": 0.37, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.64, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 0.97, "avg": 0.97, "max": 0.97, "min": 0.97, "cnt": 1}, "forward-send-backward-recv":{"total": 1315.84, "avg": 42.45, "max": 1.41, "min": 371.93, "cnt": 31}, "backward-compute":{"total": 1453.54, "avg": 45.42, "max": 42.30, "min": 48.09, "cnt": 32}, "MoE_L3_bwd":{"total": 380.67, "avg": 11.90, "max": 10.77, "min": 14.84, "cnt": 32}, "MoE_L2_bwd":{"total": 338.99, "avg": 10.59, "max": 10.04, "min": 11.19, "cnt": 32}, "MoE_L1_bwd":{"total": 276.57, "avg": 8.64, "max": 8.06, "min": 10.30, "cnt": 32}, "MoE_L0_bwd":{"total": 244.52, "avg": 7.64, "max": 7.13, "min": 8.08, "cnt": 32}, "backward-send-forward-recv":{"total": 2009.69, "avg": 66.99, "max": 1.70, "min": 715.29, "cnt": 30}, "backward-send":{"total": 2.23, "avg": 1.12, "max": 1.08, "min": 1.15, "cnt": 2}, "backward-recv":{"total": 146.23, "avg": 146.23, "max": 146.23, "min": 146.23, "cnt": 1}, "backward-params-all-reduce":{"total": 490.73, "avg": 490.73, "max": 490.73, "min": 490.73, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 279.33, "avg": 279.33, "max": 279.33, "min": 279.33, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 239.47, "avg": 239.47, "max": 239.47, "min": 239.47, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 103, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 128.82, "avg": 64.41, "max": 2.47, "min": 126.35, "cnt": 2}, "forward-compute":{"total": 1801.51, "avg": 56.30, "max": 48.56, "min": 65.68, "cnt": 32}, "fwd-compute":{"total": 1797.71, "avg": 56.18, "max": 48.48, "min": 65.54, "cnt": 32}, "batch-generator":{"total": 51.95, "avg": 1.62, "max": 0.74, "min": 2.51, "cnt": 32}, "fwd-embedding":{"total": 0.76, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1730.84, "avg": 54.09, "max": 47.10, "min": 62.89, "cnt": 32}, "fwd-layernorm":{"total": 11.82, "avg": 0.09, "max": 0.06, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 119.48, "avg": 0.93, "max": 0.75, "min": 3.09, "cnt": 128}, "fwd-misc":{"total": 24.87, "avg": 0.19, "max": 0.12, "min": 0.46, "cnt": 128}, "fwd-MLP":{"total": 1549.30, "avg": 12.10, "max": 9.63, "min": 18.75, "cnt": 128}, "MoE_L0_fwd":{"total": 425.31, "avg": 13.29, "max": 9.54, "min": 18.65, "cnt": 32}, "MoEMLP":{"total": 1529.45, "avg": 11.95, "max": 9.49, "min": 18.59, "cnt": 128}, "MoE_L1_fwd":{"total": 360.33, "avg": 11.26, "max": 9.95, "min": 12.79, "cnt": 32}, "MoE_L2_fwd":{"total": 374.16, "avg": 11.69, "max": 10.79, "min": 15.77, "cnt": 32}, "MoE_L3_fwd":{"total": 377.05, "avg": 11.78, "max": 10.96, "min": 17.66, "cnt": 32}, "fwd-pooler":{"total": 0.38, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.67, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 0.97, "avg": 0.97, "max": 0.97, "min": 0.97, "cnt": 1}, "forward-send-backward-recv":{"total": 1014.19, "avg": 32.72, "max": 1.31, "min": 305.14, "cnt": 31}, "backward-compute":{"total": 1453.71, "avg": 45.43, "max": 42.38, "min": 48.18, "cnt": 32}, "MoE_L3_bwd":{"total": 385.07, "avg": 12.03, "max": 10.62, "min": 14.33, "cnt": 32}, "MoE_L2_bwd":{"total": 336.77, "avg": 10.52, "max": 10.10, "min": 11.44, "cnt": 32}, "MoE_L1_bwd":{"total": 277.07, "avg": 8.66, "max": 7.99, "min": 9.70, "cnt": 32}, "MoE_L0_bwd":{"total": 240.64, "avg": 7.52, "max": 6.77, "min": 8.01, "cnt": 32}, "backward-send-forward-recv":{"total": 2712.19, "avg": 90.41, "max": 1.66, "min": 608.99, "cnt": 30}, "backward-send":{"total": 1.89, "avg": 0.95, "max": 0.92, "min": 0.97, "cnt": 2}, "backward-recv":{"total": 70.37, "avg": 70.37, "max": 70.37, "min": 70.37, "cnt": 1}, "backward-params-all-reduce":{"total": 491.58, "avg": 491.58, "max": 491.58, "min": 491.58, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.10, "avg": 0.10, "max": 0.10, "min": 0.10, "cnt": 1}, "optimizer":{"total": 277.26, "avg": 277.26, "max": 277.26, "min": 277.26, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 5.84, "avg": 5.84, "max": 5.84, "min": 5.84, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 234.64, "avg": 234.64, "max": 234.64, "min": 234.64, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.55, "avg": 3.55, "max": 3.55, "min": 3.55, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.50, "avg": 3.50, "max": 3.50, "min": 3.50, "cnt": 1}}}
{"type":"time", "iteration": 104, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 122.38, "avg": 61.19, "max": 0.94, "min": 121.44, "cnt": 2}, "forward-compute":{"total": 1804.49, "avg": 56.39, "max": 48.54, "min": 66.90, "cnt": 32}, "fwd-compute":{"total": 1801.17, "avg": 56.29, "max": 48.46, "min": 66.81, "cnt": 32}, "batch-generator":{"total": 42.91, "avg": 1.34, "max": 0.78, "min": 2.71, "cnt": 32}, "fwd-embedding":{"total": 0.61, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1744.55, "avg": 54.52, "max": 46.40, "min": 64.84, "cnt": 32}, "fwd-layernorm":{"total": 10.77, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 114.48, "avg": 0.89, "max": 0.75, "min": 3.23, "cnt": 128}, "fwd-misc":{"total": 23.10, "avg": 0.18, "max": 0.12, "min": 0.44, "cnt": 128}, "fwd-MLP":{"total": 1571.72, "avg": 12.28, "max": 9.53, "min": 23.82, "cnt": 128}, "MoE_L0_fwd":{"total": 428.58, "avg": 13.39, "max": 9.45, "min": 23.58, "cnt": 32}, "MoEMLP":{"total": 1553.06, "avg": 12.13, "max": 9.40, "min": 23.53, "cnt": 128}, "MoE_L1_fwd":{"total": 369.51, "avg": 11.55, "max": 9.82, "min": 13.97, "cnt": 32}, "MoE_L2_fwd":{"total": 380.78, "avg": 11.90, "max": 11.10, "min": 14.96, "cnt": 32}, "MoE_L3_fwd":{"total": 381.04, "avg": 11.91, "max": 11.04, "min": 14.07, "cnt": 32}, "fwd-pooler":{"total": 0.37, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.64, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.05, "avg": 1.05, "max": 1.05, "min": 1.05, "cnt": 1}, "forward-send-backward-recv":{"total": 396.67, "avg": 12.80, "max": 1.26, "min": 138.80, "cnt": 31}, "backward-compute":{"total": 1469.97, "avg": 45.94, "max": 43.04, "min": 47.81, "cnt": 32}, "MoE_L3_bwd":{"total": 384.87, "avg": 12.03, "max": 10.67, "min": 14.10, "cnt": 32}, "MoE_L2_bwd":{"total": 351.31, "avg": 10.98, "max": 10.25, "min": 11.92, "cnt": 32}, "MoE_L1_bwd":{"total": 273.19, "avg": 8.54, "max": 8.08, "min": 9.94, "cnt": 32}, "MoE_L0_bwd":{"total": 236.58, "avg": 7.39, "max": 6.81, "min": 7.87, "cnt": 32}, "backward-send-forward-recv":{"total": 2740.34, "avg": 91.34, "max": 2.39, "min": 545.17, "cnt": 30}, "backward-send":{"total": 2.04, "avg": 1.02, "max": 0.92, "min": 1.12, "cnt": 2}, "backward-recv":{"total": 69.96, "avg": 69.96, "max": 69.96, "min": 69.96, "cnt": 1}, "backward-params-all-reduce":{"total": 486.91, "avg": 486.91, "max": 486.91, "min": 486.91, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 282.68, "avg": 282.68, "max": 282.68, "min": 282.68, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 242.59, "avg": 242.59, "max": 242.59, "min": 242.59, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.60, "avg": 3.60, "max": 3.60, "min": 3.60, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.47, "avg": 3.47, "max": 3.47, "min": 3.47, "cnt": 1}}}
{"type":"time", "iteration": 105, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.10, "avg": 0.10, "max": 0.10, "min": 0.10, "cnt": 1}, "forward-recv":{"total": 136.63, "avg": 68.32, "max": 15.73, "min": 120.90, "cnt": 2}, "forward-compute":{"total": 1774.43, "avg": 55.45, "max": 48.88, "min": 62.85, "cnt": 32}, "fwd-compute":{"total": 1770.98, "avg": 55.34, "max": 48.79, "min": 62.72, "cnt": 32}, "batch-generator":{"total": 45.80, "avg": 1.43, "max": 0.72, "min": 3.06, "cnt": 32}, "fwd-embedding":{"total": 0.60, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1711.63, "avg": 53.49, "max": 47.60, "min": 60.56, "cnt": 32}, "fwd-layernorm":{"total": 10.47, "avg": 0.08, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 109.76, "avg": 0.86, "max": 0.75, "min": 1.50, "cnt": 128}, "fwd-misc":{"total": 22.05, "avg": 0.17, "max": 0.12, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1545.67, "avg": 12.08, "max": 9.47, "min": 19.09, "cnt": 128}, "MoE_L0_fwd":{"total": 416.37, "avg": 13.01, "max": 9.38, "min": 19.01, "cnt": 32}, "MoEMLP":{"total": 1527.59, "avg": 11.93, "max": 9.34, "min": 18.96, "cnt": 128}, "MoE_L1_fwd":{"total": 365.80, "avg": 11.43, "max": 9.91, "min": 15.87, "cnt": 32}, "MoE_L2_fwd":{"total": 383.69, "avg": 11.99, "max": 11.27, "min": 14.21, "cnt": 32}, "MoE_L3_fwd":{"total": 368.27, "avg": 11.51, "max": 11.07, "min": 12.32, "cnt": 32}, "fwd-pooler":{"total": 0.37, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.63, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 0.95, "avg": 0.95, "max": 0.95, "min": 0.95, "cnt": 1}, "forward-send-backward-recv":{"total": 204.53, "avg": 6.60, "max": 1.38, "min": 57.57, "cnt": 31}, "backward-compute":{"total": 1492.68, "avg": 46.65, "max": 44.62, "min": 48.16, "cnt": 32}, "MoE_L3_bwd":{"total": 388.83, "avg": 12.15, "max": 10.74, "min": 13.55, "cnt": 32}, "MoE_L2_bwd":{"total": 367.55, "avg": 11.49, "max": 10.91, "min": 12.11, "cnt": 32}, "MoE_L1_bwd":{"total": 268.80, "avg": 8.40, "max": 7.94, "min": 9.29, "cnt": 32}, "MoE_L0_bwd":{"total": 241.89, "avg": 7.56, "max": 7.18, "min": 7.98, "cnt": 32}, "backward-send-forward-recv":{"total": 4602.76, "avg": 153.43, "max": 2.22, "min": 617.96, "cnt": 30}, "backward-send":{"total": 2.07, "avg": 1.04, "max": 1.01, "min": 1.06, "cnt": 2}, "backward-recv":{"total": 71.03, "avg": 71.03, "max": 71.03, "min": 71.03, "cnt": 1}, "backward-params-all-reduce":{"total": 498.23, "avg": 498.23, "max": 498.23, "min": 498.23, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 277.05, "avg": 277.05, "max": 277.05, "min": 277.05, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 236.94, "avg": 236.94, "max": 236.94, "min": 236.94, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.53, "avg": 3.53, "max": 3.53, "min": 3.53, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.52, "avg": 3.52, "max": 3.52, "min": 3.52, "cnt": 1}}}
{"type":"time", "iteration": 106, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 136.56, "avg": 68.28, "max": 10.33, "min": 126.23, "cnt": 2}, "forward-compute":{"total": 1806.08, "avg": 56.44, "max": 50.26, "min": 64.69, "cnt": 32}, "fwd-compute":{"total": 1802.82, "avg": 56.34, "max": 50.18, "min": 64.55, "cnt": 32}, "batch-generator":{"total": 42.56, "avg": 1.33, "max": 0.74, "min": 2.88, "cnt": 32}, "fwd-embedding":{"total": 0.58, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1746.30, "avg": 54.57, "max": 48.91, "min": 62.04, "cnt": 32}, "fwd-layernorm":{"total": 10.20, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 107.46, "avg": 0.84, "max": 0.75, "min": 1.67, "cnt": 128}, "fwd-misc":{"total": 21.85, "avg": 0.17, "max": 0.12, "min": 0.49, "cnt": 128}, "fwd-MLP":{"total": 1583.05, "avg": 12.37, "max": 10.06, "min": 19.78, "cnt": 128}, "MoE_L0_fwd":{"total": 425.65, "avg": 13.30, "max": 9.98, "min": 19.70, "cnt": 32}, "MoEMLP":{"total": 1564.78, "avg": 12.22, "max": 9.94, "min": 19.66, "cnt": 128}, "MoE_L1_fwd":{"total": 377.31, "avg": 11.79, "max": 10.14, "min": 14.30, "cnt": 32}, "MoE_L2_fwd":{"total": 389.09, "avg": 12.16, "max": 11.24, "min": 15.92, "cnt": 32}, "MoE_L3_fwd":{"total": 379.27, "avg": 11.85, "max": 11.05, "min": 14.92, "cnt": 32}, "fwd-pooler":{"total": 0.38, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.65, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 0.90, "avg": 0.90, "max": 0.90, "min": 0.90, "cnt": 1}, "forward-send-backward-recv":{"total": 401.49, "avg": 12.95, "max": 1.46, "min": 130.18, "cnt": 31}, "backward-compute":{"total": 1574.91, "avg": 49.22, "max": 45.68, "min": 121.37, "cnt": 32}, "MoE_L3_bwd":{"total": 393.27, "avg": 12.29, "max": 11.46, "min": 13.77, "cnt": 32}, "MoE_L2_bwd":{"total": 435.54, "avg": 13.61, "max": 10.42, "min": 85.44, "cnt": 32}, "MoE_L1_bwd":{"total": 279.55, "avg": 8.74, "max": 8.13, "min": 9.36, "cnt": 32}, "MoE_L0_bwd":{"total": 246.55, "avg": 7.70, "max": 7.07, "min": 8.40, "cnt": 32}, "backward-send-forward-recv":{"total": 2523.16, "avg": 84.11, "max": 2.10, "min": 316.98, "cnt": 30}, "backward-send":{"total": 2.05, "avg": 1.03, "max": 0.98, "min": 1.07, "cnt": 2}, "backward-recv":{"total": 69.15, "avg": 69.15, "max": 69.15, "min": 69.15, "cnt": 1}, "backward-params-all-reduce":{"total": 487.30, "avg": 487.30, "max": 487.30, "min": 487.30, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 290.95, "avg": 290.95, "max": 290.95, "min": 290.95, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 250.96, "avg": 250.96, "max": 250.96, "min": 250.96, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 107, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 148.36, "avg": 74.18, "max": 8.67, "min": 139.70, "cnt": 2}, "forward-compute":{"total": 1827.14, "avg": 57.10, "max": 50.37, "min": 66.17, "cnt": 32}, "fwd-compute":{"total": 1823.98, "avg": 57.00, "max": 50.28, "min": 66.07, "cnt": 32}, "batch-generator":{"total": 39.61, "avg": 1.24, "max": 0.77, "min": 1.81, "cnt": 32}, "fwd-embedding":{"total": 0.59, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1771.46, "avg": 55.36, "max": 48.99, "min": 64.36, "cnt": 32}, "fwd-layernorm":{"total": 10.16, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 110.54, "avg": 0.86, "max": 0.75, "min": 2.41, "cnt": 128}, "fwd-misc":{"total": 21.97, "avg": 0.17, "max": 0.12, "min": 0.39, "cnt": 128}, "fwd-MLP":{"total": 1605.40, "avg": 12.54, "max": 9.81, "min": 22.69, "cnt": 128}, "MoE_L0_fwd":{"total": 447.83, "avg": 13.99, "max": 9.73, "min": 22.59, "cnt": 32}, "MoEMLP":{"total": 1587.53, "avg": 12.40, "max": 9.68, "min": 22.55, "cnt": 128}, "MoE_L1_fwd":{"total": 391.49, "avg": 12.23, "max": 10.17, "min": 17.63, "cnt": 32}, "MoE_L2_fwd":{"total": 381.69, "avg": 11.93, "max": 11.39, "min": 15.90, "cnt": 32}, "MoE_L3_fwd":{"total": 373.09, "avg": 11.66, "max": 11.21, "min": 13.04, "cnt": 32}, "fwd-pooler":{"total": 0.37, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.66, "avg": 0.02, "max": 0.02, "min": 0.04, "cnt": 32}, "forward-send":{"total": 1.00, "avg": 1.00, "max": 1.00, "min": 1.00, "cnt": 1}, "forward-send-backward-recv":{"total": 191.85, "avg": 6.19, "max": 1.32, "min": 50.62, "cnt": 31}, "backward-compute":{"total": 1504.26, "avg": 47.01, "max": 44.10, "min": 49.76, "cnt": 32}, "MoE_L3_bwd":{"total": 393.31, "avg": 12.29, "max": 11.37, "min": 13.33, "cnt": 32}, "MoE_L2_bwd":{"total": 356.90, "avg": 11.15, "max": 10.39, "min": 13.05, "cnt": 32}, "MoE_L1_bwd":{"total": 281.08, "avg": 8.78, "max": 8.21, "min": 9.49, "cnt": 32}, "MoE_L0_bwd":{"total": 255.98, "avg": 8.00, "max": 7.28, "min": 8.76, "cnt": 32}, "backward-send-forward-recv":{"total": 2928.86, "avg": 97.63, "max": 1.49, "min": 504.23, "cnt": 30}, "backward-send":{"total": 2.17, "avg": 1.09, "max": 1.00, "min": 1.17, "cnt": 2}, "backward-recv":{"total": 67.49, "avg": 67.49, "max": 67.49, "min": 67.49, "cnt": 1}, "backward-params-all-reduce":{"total": 489.37, "avg": 489.37, "max": 489.37, "min": 489.37, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 276.26, "avg": 276.26, "max": 276.26, "min": 276.26, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 236.38, "avg": 236.38, "max": 236.38, "min": 236.38, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.35, "avg": 3.35, "max": 3.35, "min": 3.35, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.48, "avg": 3.48, "max": 3.48, "min": 3.48, "cnt": 1}}}
{"type":"time", "iteration": 108, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 136.52, "avg": 68.26, "max": 0.93, "min": 135.59, "cnt": 2}, "forward-compute":{"total": 1886.66, "avg": 58.96, "max": 50.24, "min": 70.68, "cnt": 32}, "fwd-compute":{"total": 1882.81, "avg": 58.84, "max": 50.16, "min": 70.57, "cnt": 32}, "batch-generator":{"total": 46.71, "avg": 1.46, "max": 0.77, "min": 2.16, "cnt": 32}, "fwd-embedding":{"total": 0.75, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1819.90, "avg": 56.87, "max": 48.23, "min": 68.82, "cnt": 32}, "fwd-layernorm":{"total": 11.76, "avg": 0.09, "max": 0.06, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 119.79, "avg": 0.94, "max": 0.75, "min": 1.87, "cnt": 128}, "fwd-misc":{"total": 25.48, "avg": 0.20, "max": 0.12, "min": 0.51, "cnt": 128}, "fwd-MLP":{"total": 1636.54, "avg": 12.79, "max": 9.82, "min": 18.90, "cnt": 128}, "MoE_L0_fwd":{"total": 445.37, "avg": 13.92, "max": 9.74, "min": 18.77, "cnt": 32}, "MoEMLP":{"total": 1615.91, "avg": 12.62, "max": 9.69, "min": 18.71, "cnt": 128}, "MoE_L1_fwd":{"total": 393.73, "avg": 12.30, "max": 10.55, "min": 14.66, "cnt": 32}, "MoE_L2_fwd":{"total": 395.79, "avg": 12.37, "max": 10.63, "min": 18.62, "cnt": 32}, "MoE_L3_fwd":{"total": 388.42, "avg": 12.14, "max": 10.82, "min": 15.48, "cnt": 32}, "fwd-pooler":{"total": 0.42, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.72, "avg": 0.02, "max": 0.02, "min": 0.07, "cnt": 32}, "forward-send":{"total": 1.04, "avg": 1.04, "max": 1.04, "min": 1.04, "cnt": 1}, "forward-send-backward-recv":{"total": 1082.86, "avg": 34.93, "max": 1.61, "min": 210.65, "cnt": 31}, "backward-compute":{"total": 1497.31, "avg": 46.79, "max": 44.94, "min": 48.49, "cnt": 32}, "MoE_L3_bwd":{"total": 392.70, "avg": 12.27, "max": 11.65, "min": 13.33, "cnt": 32}, "MoE_L2_bwd":{"total": 342.01, "avg": 10.69, "max": 10.13, "min": 11.57, "cnt": 32}, "MoE_L1_bwd":{"total": 286.83, "avg": 8.96, "max": 8.44, "min": 9.32, "cnt": 32}, "MoE_L0_bwd":{"total": 256.53, "avg": 8.02, "max": 7.64, "min": 8.50, "cnt": 32}, "backward-send-forward-recv":{"total": 2076.34, "avg": 69.21, "max": 1.68, "min": 580.30, "cnt": 30}, "backward-send":{"total": 1.75, "avg": 0.88, "max": 0.84, "min": 0.91, "cnt": 2}, "backward-recv":{"total": 239.35, "avg": 239.35, "max": 239.35, "min": 239.35, "cnt": 1}, "backward-params-all-reduce":{"total": 489.95, "avg": 489.95, "max": 489.95, "min": 489.95, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 284.00, "avg": 284.00, "max": 284.00, "min": 284.00, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 243.94, "avg": 243.94, "max": 243.94, "min": 243.94, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.53, "avg": 3.53, "max": 3.53, "min": 3.53, "cnt": 1}}}
{"type":"time", "iteration": 109, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 133.73, "avg": 66.86, "max": 1.22, "min": 132.51, "cnt": 2}, "forward-compute":{"total": 1805.24, "avg": 56.41, "max": 49.81, "min": 65.78, "cnt": 32}, "fwd-compute":{"total": 1801.90, "avg": 56.31, "max": 49.73, "min": 65.69, "cnt": 32}, "batch-generator":{"total": 43.95, "avg": 1.37, "max": 0.78, "min": 3.33, "cnt": 32}, "fwd-embedding":{"total": 0.61, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1744.04, "avg": 54.50, "max": 48.45, "min": 64.52, "cnt": 32}, "fwd-layernorm":{"total": 10.39, "avg": 0.08, "max": 0.06, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 111.41, "avg": 0.87, "max": 0.75, "min": 2.31, "cnt": 128}, "fwd-misc":{"total": 22.94, "avg": 0.18, "max": 0.12, "min": 0.50, "cnt": 128}, "fwd-MLP":{"total": 1575.63, "avg": 12.31, "max": 10.21, "min": 18.57, "cnt": 128}, "MoE_L0_fwd":{"total": 424.96, "avg": 13.28, "max": 10.13, "min": 18.48, "cnt": 32}, "MoEMLP":{"total": 1557.00, "avg": 12.16, "max": 10.08, "min": 18.43, "cnt": 128}, "MoE_L1_fwd":{"total": 387.26, "avg": 12.10, "max": 10.86, "min": 15.15, "cnt": 32}, "MoE_L2_fwd":{"total": 373.04, "avg": 11.66, "max": 10.77, "min": 13.89, "cnt": 32}, "MoE_L3_fwd":{"total": 378.59, "avg": 11.83, "max": 10.93, "min": 16.35, "cnt": 32}, "fwd-pooler":{"total": 0.41, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.64, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.02, "avg": 1.02, "max": 1.02, "min": 1.02, "cnt": 1}, "forward-send-backward-recv":{"total": 2136.61, "avg": 68.92, "max": 1.87, "min": 396.96, "cnt": 31}, "backward-compute":{"total": 1489.71, "avg": 46.55, "max": 44.62, "min": 48.51, "cnt": 32}, "MoE_L3_bwd":{"total": 387.34, "avg": 12.10, "max": 11.07, "min": 14.71, "cnt": 32}, "MoE_L2_bwd":{"total": 341.47, "avg": 10.67, "max": 10.16, "min": 11.26, "cnt": 32}, "MoE_L1_bwd":{"total": 292.93, "avg": 9.15, "max": 8.69, "min": 10.73, "cnt": 32}, "MoE_L0_bwd":{"total": 256.76, "avg": 8.02, "max": 7.30, "min": 8.36, "cnt": 32}, "backward-send-forward-recv":{"total": 2766.08, "avg": 92.20, "max": 1.82, "min": 917.65, "cnt": 30}, "backward-send":{"total": 2.11, "avg": 1.06, "max": 0.98, "min": 1.13, "cnt": 2}, "backward-recv":{"total": 70.03, "avg": 70.03, "max": 70.03, "min": 70.03, "cnt": 1}, "backward-params-all-reduce":{"total": 494.05, "avg": 494.05, "max": 494.05, "min": 494.05, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 276.23, "avg": 276.23, "max": 276.23, "min": 276.23, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 236.48, "avg": 236.48, "max": 236.48, "min": 236.48, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.33, "avg": 3.33, "max": 3.33, "min": 3.33, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 110, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 630.41, "avg": 315.21, "max": 1.46, "min": 628.96, "cnt": 2}, "forward-compute":{"total": 2033.89, "avg": 63.56, "max": 48.69, "min": 340.12, "cnt": 32}, "fwd-compute":{"total": 2030.66, "avg": 63.46, "max": 48.60, "min": 340.02, "cnt": 32}, "batch-generator":{"total": 42.69, "avg": 1.33, "max": 0.82, "min": 2.22, "cnt": 32}, "fwd-embedding":{"total": 0.60, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1974.61, "avg": 61.71, "max": 46.62, "min": 338.65, "cnt": 32}, "fwd-layernorm":{"total": 10.32, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 108.80, "avg": 0.85, "max": 0.75, "min": 1.75, "cnt": 128}, "fwd-misc":{"total": 22.64, "avg": 0.18, "max": 0.12, "min": 0.42, "cnt": 128}, "fwd-MLP":{"total": 1809.46, "avg": 14.14, "max": 9.69, "min": 174.87, "cnt": 128}, "MoE_L0_fwd":{"total": 446.61, "avg": 13.96, "max": 9.88, "min": 19.61, "cnt": 32}, "MoEMLP":{"total": 1791.30, "avg": 13.99, "max": 9.58, "min": 174.73, "cnt": 128}, "MoE_L1_fwd":{"total": 385.53, "avg": 12.05, "max": 10.65, "min": 16.34, "cnt": 32}, "MoE_L2_fwd":{"total": 460.03, "avg": 14.38, "max": 9.95, "min": 126.69, "cnt": 32}, "MoE_L3_fwd":{"total": 505.78, "avg": 15.81, "max": 9.62, "min": 174.78, "cnt": 32}, "fwd-pooler":{"total": 0.38, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.66, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.08, "avg": 1.08, "max": 1.08, "min": 1.08, "cnt": 1}, "forward-send-backward-recv":{"total": 644.02, "avg": 20.77, "max": 1.72, "min": 189.14, "cnt": 31}, "backward-compute":{"total": 1387.36, "avg": 43.35, "max": 39.88, "min": 45.32, "cnt": 32}, "MoE_L3_bwd":{"total": 319.09, "avg": 9.97, "max": 8.30, "min": 10.83, "cnt": 32}, "MoE_L2_bwd":{"total": 305.54, "avg": 9.55, "max": 8.96, "min": 10.86, "cnt": 32}, "MoE_L1_bwd":{"total": 289.96, "avg": 9.06, "max": 8.58, "min": 9.73, "cnt": 32}, "MoE_L0_bwd":{"total": 255.28, "avg": 7.98, "max": 7.38, "min": 9.08, "cnt": 32}, "backward-send-forward-recv":{"total": 2546.84, "avg": 84.89, "max": 1.91, "min": 398.71, "cnt": 30}, "backward-send":{"total": 2.00, "avg": 1.00, "max": 0.93, "min": 1.08, "cnt": 2}, "backward-recv":{"total": 60.46, "avg": 60.46, "max": 60.46, "min": 60.46, "cnt": 1}, "backward-params-all-reduce":{"total": 491.25, "avg": 491.25, "max": 491.25, "min": 491.25, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 274.26, "avg": 274.26, "max": 274.26, "min": 274.26, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.36, "avg": 3.36, "max": 3.36, "min": 3.36, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 234.46, "avg": 234.46, "max": 234.46, "min": 234.46, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.54, "avg": 3.54, "max": 3.54, "min": 3.54, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 111, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 128.28, "avg": 64.14, "max": 2.34, "min": 125.94, "cnt": 2}, "forward-compute":{"total": 1784.09, "avg": 55.75, "max": 49.01, "min": 62.16, "cnt": 32}, "fwd-compute":{"total": 1780.69, "avg": 55.65, "max": 48.92, "min": 62.08, "cnt": 32}, "batch-generator":{"total": 54.97, "avg": 1.72, "max": 0.76, "min": 3.46, "cnt": 32}, "fwd-embedding":{"total": 0.71, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1712.15, "avg": 53.50, "max": 47.65, "min": 60.81, "cnt": 32}, "fwd-layernorm":{"total": 10.81, "avg": 0.08, "max": 0.06, "min": 0.23, "cnt": 128}, "fwd-attn":{"total": 111.76, "avg": 0.87, "max": 0.75, "min": 1.79, "cnt": 128}, "fwd-misc":{"total": 22.80, "avg": 0.18, "max": 0.12, "min": 0.52, "cnt": 128}, "fwd-MLP":{"total": 1542.92, "avg": 12.05, "max": 9.74, "min": 17.46, "cnt": 128}, "MoE_L0_fwd":{"total": 442.25, "avg": 13.82, "max": 9.66, "min": 17.38, "cnt": 32}, "MoEMLP":{"total": 1524.58, "avg": 11.91, "max": 9.61, "min": 17.33, "cnt": 128}, "MoE_L1_fwd":{"total": 398.43, "avg": 12.45, "max": 10.72, "min": 16.96, "cnt": 32}, "MoE_L2_fwd":{"total": 341.38, "avg": 10.67, "max": 10.11, "min": 11.70, "cnt": 32}, "MoE_L3_fwd":{"total": 349.24, "avg": 10.91, "max": 10.08, "min": 11.62, "cnt": 32}, "fwd-pooler":{"total": 0.38, "avg": 0.01, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-loss-func":{"total": 0.61, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 0.75, "avg": 0.75, "max": 0.75, "min": 0.75, "cnt": 1}, "forward-send-backward-recv":{"total": 267.60, "avg": 8.63, "max": 1.33, "min": 57.11, "cnt": 31}, "backward-compute":{"total": 1487.71, "avg": 46.49, "max": 44.63, "min": 48.54, "cnt": 32}, "MoE_L3_bwd":{"total": 349.59, "avg": 10.92, "max": 9.27, "min": 13.43, "cnt": 32}, "MoE_L2_bwd":{"total": 331.76, "avg": 10.37, "max": 9.54, "min": 13.56, "cnt": 32}, "MoE_L1_bwd":{"total": 315.23, "avg": 9.85, "max": 9.24, "min": 10.79, "cnt": 32}, "MoE_L0_bwd":{"total": 272.54, "avg": 8.52, "max": 7.72, "min": 8.85, "cnt": 32}, "backward-send-forward-recv":{"total": 2023.02, "avg": 67.43, "max": 1.42, "min": 236.29, "cnt": 30}, "backward-send":{"total": 2.21, "avg": 1.10, "max": 1.07, "min": 1.14, "cnt": 2}, "backward-recv":{"total": 70.32, "avg": 70.32, "max": 70.32, "min": 70.32, "cnt": 1}, "backward-params-all-reduce":{"total": 489.07, "avg": 489.07, "max": 489.07, "min": 489.07, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 280.52, "avg": 280.52, "max": 280.52, "min": 280.52, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 236.25, "avg": 236.25, "max": 236.25, "min": 236.25, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.85, "avg": 6.85, "max": 6.85, "min": 6.85, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.52, "avg": 3.52, "max": 3.52, "min": 3.52, "cnt": 1}}}
{"type":"time", "iteration": 112, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.12, "avg": 0.12, "max": 0.12, "min": 0.12, "cnt": 1}, "forward-recv":{"total": 145.80, "avg": 72.90, "max": 9.61, "min": 136.19, "cnt": 2}, "forward-compute":{"total": 1748.60, "avg": 54.64, "max": 47.54, "min": 62.86, "cnt": 32}, "fwd-compute":{"total": 1744.94, "avg": 54.53, "max": 47.46, "min": 62.71, "cnt": 32}, "batch-generator":{"total": 44.89, "avg": 1.40, "max": 0.78, "min": 2.69, "cnt": 32}, "fwd-embedding":{"total": 0.70, "avg": 0.02, "max": 0.01, "min": 0.06, "cnt": 32}, "fwd-encoder":{"total": 1685.02, "avg": 52.66, "max": 46.09, "min": 60.87, "cnt": 32}, "fwd-layernorm":{"total": 11.41, "avg": 0.09, "max": 0.06, "min": 0.22, "cnt": 128}, "fwd-attn":{"total": 113.86, "avg": 0.89, "max": 0.75, "min": 2.06, "cnt": 128}, "fwd-misc":{"total": 24.32, "avg": 0.19, "max": 0.12, "min": 0.44, "cnt": 128}, "fwd-MLP":{"total": 1509.59, "avg": 11.79, "max": 9.79, "min": 18.79, "cnt": 128}, "MoE_L0_fwd":{"total": 424.14, "avg": 13.25, "max": 9.71, "min": 18.71, "cnt": 32}, "MoEMLP":{"total": 1489.82, "avg": 11.64, "max": 9.66, "min": 18.66, "cnt": 128}, "MoE_L1_fwd":{"total": 368.12, "avg": 11.50, "max": 10.19, "min": 14.73, "cnt": 32}, "MoE_L2_fwd":{"total": 350.04, "avg": 10.94, "max": 10.17, "min": 12.93, "cnt": 32}, "MoE_L3_fwd":{"total": 354.68, "avg": 11.08, "max": 10.13, "min": 13.58, "cnt": 32}, "fwd-pooler":{"total": 0.40, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.69, "avg": 0.02, "max": 0.02, "min": 0.04, "cnt": 32}, "forward-send":{"total": 0.86, "avg": 0.86, "max": 0.86, "min": 0.86, "cnt": 1}, "forward-send-backward-recv":{"total": 1131.98, "avg": 36.52, "max": 1.31, "min": 146.39, "cnt": 31}, "backward-compute":{"total": 1475.88, "avg": 46.12, "max": 43.78, "min": 48.57, "cnt": 32}, "MoE_L3_bwd":{"total": 350.20, "avg": 10.94, "max": 10.10, "min": 11.83, "cnt": 32}, "MoE_L2_bwd":{"total": 329.28, "avg": 10.29, "max": 9.76, "min": 12.35, "cnt": 32}, "MoE_L1_bwd":{"total": 299.60, "avg": 9.36, "max": 8.68, "min": 12.16, "cnt": 32}, "MoE_L0_bwd":{"total": 277.92, "avg": 8.68, "max": 7.92, "min": 9.10, "cnt": 32}, "backward-send-forward-recv":{"total": 1215.21, "avg": 40.51, "max": 1.61, "min": 190.34, "cnt": 30}, "backward-send":{"total": 1.98, "avg": 0.99, "max": 0.92, "min": 1.06, "cnt": 2}, "backward-recv":{"total": 251.72, "avg": 251.72, "max": 251.72, "min": 251.72, "cnt": 1}, "backward-params-all-reduce":{"total": 489.58, "avg": 489.58, "max": 489.58, "min": 489.58, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "optimizer":{"total": 284.31, "avg": 284.31, "max": 284.31, "min": 284.31, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.40, "avg": 3.40, "max": 3.40, "min": 3.40, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 241.44, "avg": 241.44, "max": 241.44, "min": 241.44, "cnt": 1}, "optimizer-clip-main-grad":{"total": 5.78, "avg": 5.78, "max": 5.78, "min": 5.78, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.47, "avg": 3.47, "max": 3.47, "min": 3.47, "cnt": 1}}}
{"type":"time", "iteration": 113, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 119.32, "avg": 59.66, "max": 3.21, "min": 116.11, "cnt": 2}, "forward-compute":{"total": 1723.54, "avg": 53.86, "max": 47.55, "min": 62.30, "cnt": 32}, "fwd-compute":{"total": 1720.15, "avg": 53.75, "max": 47.42, "min": 62.19, "cnt": 32}, "batch-generator":{"total": 40.00, "avg": 1.25, "max": 0.71, "min": 2.11, "cnt": 32}, "fwd-embedding":{"total": 0.58, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1666.32, "avg": 52.07, "max": 46.01, "min": 60.02, "cnt": 32}, "fwd-layernorm":{"total": 10.50, "avg": 0.08, "max": 0.06, "min": 0.22, "cnt": 128}, "fwd-attn":{"total": 112.24, "avg": 0.88, "max": 0.74, "min": 1.77, "cnt": 128}, "fwd-misc":{"total": 22.34, "avg": 0.17, "max": 0.11, "min": 0.41, "cnt": 128}, "fwd-MLP":{"total": 1496.90, "avg": 11.69, "max": 9.91, "min": 21.80, "cnt": 128}, "MoE_L0_fwd":{"total": 429.76, "avg": 13.43, "max": 10.10, "min": 21.65, "cnt": 32}, "MoEMLP":{"total": 1477.96, "avg": 11.55, "max": 9.78, "min": 21.60, "cnt": 128}, "MoE_L1_fwd":{"total": 376.58, "avg": 11.77, "max": 10.24, "min": 16.87, "cnt": 32}, "MoE_L2_fwd":{"total": 346.12, "avg": 10.82, "max": 9.90, "min": 12.62, "cnt": 32}, "MoE_L3_fwd":{"total": 332.32, "avg": 10.39, "max": 9.84, "min": 11.07, "cnt": 32}, "fwd-pooler":{"total": 0.42, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.68, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.01, "avg": 1.01, "max": 1.01, "min": 1.01, "cnt": 1}, "forward-send-backward-recv":{"total": 211.20, "avg": 6.81, "max": 1.91, "min": 57.36, "cnt": 31}, "backward-compute":{"total": 1469.80, "avg": 45.93, "max": 42.27, "min": 47.62, "cnt": 32}, "MoE_L3_bwd":{"total": 351.71, "avg": 10.99, "max": 9.42, "min": 12.25, "cnt": 32}, "MoE_L2_bwd":{"total": 323.30, "avg": 10.10, "max": 9.51, "min": 10.60, "cnt": 32}, "MoE_L1_bwd":{"total": 297.34, "avg": 9.29, "max": 8.66, "min": 10.30, "cnt": 32}, "MoE_L0_bwd":{"total": 274.88, "avg": 8.59, "max": 8.07, "min": 9.18, "cnt": 32}, "backward-send-forward-recv":{"total": 3371.28, "avg": 112.38, "max": 2.34, "min": 716.07, "cnt": 30}, "backward-send":{"total": 2.05, "avg": 1.02, "max": 0.94, "min": 1.11, "cnt": 2}, "backward-recv":{"total": 60.48, "avg": 60.48, "max": 60.48, "min": 60.48, "cnt": 1}, "backward-params-all-reduce":{"total": 490.29, "avg": 490.29, "max": 490.29, "min": 490.29, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 279.07, "avg": 279.07, "max": 279.07, "min": 279.07, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 239.28, "avg": 239.28, "max": 239.28, "min": 239.28, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.35, "avg": 3.35, "max": 3.35, "min": 3.35, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 114, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 120.46, "avg": 60.23, "max": 3.33, "min": 117.13, "cnt": 2}, "forward-compute":{"total": 1736.44, "avg": 54.26, "max": 47.94, "min": 64.77, "cnt": 32}, "fwd-compute":{"total": 1733.12, "avg": 54.16, "max": 47.85, "min": 64.69, "cnt": 32}, "batch-generator":{"total": 47.34, "avg": 1.48, "max": 0.75, "min": 3.15, "cnt": 32}, "fwd-embedding":{"total": 0.68, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1672.41, "avg": 52.26, "max": 46.42, "min": 62.73, "cnt": 32}, "fwd-layernorm":{"total": 10.87, "avg": 0.08, "max": 0.06, "min": 0.29, "cnt": 128}, "fwd-attn":{"total": 112.92, "avg": 0.88, "max": 0.75, "min": 1.60, "cnt": 128}, "fwd-misc":{"total": 22.84, "avg": 0.18, "max": 0.11, "min": 0.38, "cnt": 128}, "fwd-MLP":{"total": 1501.56, "avg": 11.73, "max": 9.75, "min": 23.47, "cnt": 128}, "MoE_L0_fwd":{"total": 432.69, "avg": 13.52, "max": 10.38, "min": 23.37, "cnt": 32}, "MoEMLP":{"total": 1483.02, "avg": 11.59, "max": 9.63, "min": 23.32, "cnt": 128}, "MoE_L1_fwd":{"total": 380.73, "avg": 11.90, "max": 10.46, "min": 16.07, "cnt": 32}, "MoE_L2_fwd":{"total": 331.20, "avg": 10.35, "max": 9.67, "min": 12.45, "cnt": 32}, "MoE_L3_fwd":{"total": 345.13, "avg": 10.79, "max": 10.06, "min": 13.88, "cnt": 32}, "fwd-pooler":{"total": 0.36, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.62, "avg": 0.02, "max": 0.02, "min": 0.04, "cnt": 32}, "forward-send":{"total": 0.88, "avg": 0.88, "max": 0.88, "min": 0.88, "cnt": 1}, "forward-send-backward-recv":{"total": 201.04, "avg": 6.49, "max": 1.78, "min": 57.40, "cnt": 31}, "backward-compute":{"total": 1442.17, "avg": 45.07, "max": 42.71, "min": 46.54, "cnt": 32}, "MoE_L3_bwd":{"total": 342.94, "avg": 10.72, "max": 9.88, "min": 11.98, "cnt": 32}, "MoE_L2_bwd":{"total": 311.10, "avg": 9.72, "max": 9.18, "min": 11.41, "cnt": 32}, "MoE_L1_bwd":{"total": 295.57, "avg": 9.24, "max": 8.65, "min": 9.86, "cnt": 32}, "MoE_L0_bwd":{"total": 268.75, "avg": 8.40, "max": 7.79, "min": 8.74, "cnt": 32}, "backward-send-forward-recv":{"total": 2213.07, "avg": 73.77, "max": 2.18, "min": 261.04, "cnt": 30}, "backward-send":{"total": 4.17, "avg": 2.08, "max": 1.14, "min": 3.03, "cnt": 2}, "backward-recv":{"total": 69.40, "avg": 69.40, "max": 69.40, "min": 69.40, "cnt": 1}, "backward-params-all-reduce":{"total": 489.79, "avg": 489.79, "max": 489.79, "min": 489.79, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 276.73, "avg": 276.73, "max": 276.73, "min": 276.73, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.49, "avg": 3.49, "max": 3.49, "min": 3.49, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 236.73, "avg": 236.73, "max": 236.73, "min": 236.73, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.33, "avg": 3.33, "max": 3.33, "min": 3.33, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 115, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 126.16, "avg": 63.08, "max": 1.84, "min": 124.33, "cnt": 2}, "forward-compute":{"total": 1807.07, "avg": 56.47, "max": 48.39, "min": 66.10, "cnt": 32}, "fwd-compute":{"total": 1803.46, "avg": 56.36, "max": 48.31, "min": 65.96, "cnt": 32}, "batch-generator":{"total": 52.15, "avg": 1.63, "max": 0.71, "min": 4.63, "cnt": 32}, "fwd-embedding":{"total": 0.71, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1736.62, "avg": 54.27, "max": 47.25, "min": 64.43, "cnt": 32}, "fwd-layernorm":{"total": 11.75, "avg": 0.09, "max": 0.06, "min": 0.25, "cnt": 128}, "fwd-attn":{"total": 119.09, "avg": 0.93, "max": 0.75, "min": 2.23, "cnt": 128}, "fwd-misc":{"total": 24.85, "avg": 0.19, "max": 0.11, "min": 0.43, "cnt": 128}, "fwd-MLP":{"total": 1555.24, "avg": 12.15, "max": 9.52, "min": 20.22, "cnt": 128}, "MoE_L0_fwd":{"total": 462.80, "avg": 14.46, "max": 10.52, "min": 20.14, "cnt": 32}, "MoEMLP":{"total": 1535.08, "avg": 11.99, "max": 9.40, "min": 20.10, "cnt": 128}, "MoE_L1_fwd":{"total": 388.30, "avg": 12.13, "max": 10.59, "min": 14.28, "cnt": 32}, "MoE_L2_fwd":{"total": 329.92, "avg": 10.31, "max": 9.44, "min": 14.81, "cnt": 32}, "MoE_L3_fwd":{"total": 361.47, "avg": 11.30, "max": 10.34, "min": 15.16, "cnt": 32}, "fwd-pooler":{"total": 0.40, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.66, "avg": 0.02, "max": 0.02, "min": 0.05, "cnt": 32}, "forward-send":{"total": 0.98, "avg": 0.98, "max": 0.98, "min": 0.98, "cnt": 1}, "forward-send-backward-recv":{"total": 787.27, "avg": 25.40, "max": 1.29, "min": 202.11, "cnt": 31}, "backward-compute":{"total": 1435.70, "avg": 44.87, "max": 42.30, "min": 46.82, "cnt": 32}, "MoE_L3_bwd":{"total": 348.27, "avg": 10.88, "max": 10.10, "min": 11.69, "cnt": 32}, "MoE_L2_bwd":{"total": 303.12, "avg": 9.47, "max": 8.83, "min": 10.09, "cnt": 32}, "MoE_L1_bwd":{"total": 292.92, "avg": 9.15, "max": 8.48, "min": 10.26, "cnt": 32}, "MoE_L0_bwd":{"total": 267.32, "avg": 8.35, "max": 8.01, "min": 8.67, "cnt": 32}, "backward-send-forward-recv":{"total": 3239.86, "avg": 108.00, "max": 2.32, "min": 467.49, "cnt": 30}, "backward-send":{"total": 2.17, "avg": 1.08, "max": 1.02, "min": 1.15, "cnt": 2}, "backward-recv":{"total": 67.15, "avg": 67.15, "max": 67.15, "min": 67.15, "cnt": 1}, "backward-params-all-reduce":{"total": 494.26, "avg": 494.26, "max": 494.26, "min": 494.26, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 343.60, "avg": 343.60, "max": 343.60, "min": 343.60, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 237.35, "avg": 237.35, "max": 237.35, "min": 237.35, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.30, "avg": 3.30, "max": 3.30, "min": 3.30, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.48, "avg": 3.48, "max": 3.48, "min": 3.48, "cnt": 1}}}
{"type":"time", "iteration": 116, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 193.21, "avg": 96.61, "max": 2.81, "min": 190.40, "cnt": 2}, "forward-compute":{"total": 1793.42, "avg": 56.04, "max": 46.67, "min": 69.83, "cnt": 32}, "fwd-compute":{"total": 1789.85, "avg": 55.93, "max": 46.59, "min": 69.73, "cnt": 32}, "batch-generator":{"total": 55.31, "avg": 1.73, "max": 0.77, "min": 4.84, "cnt": 32}, "fwd-embedding":{"total": 0.76, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1719.90, "avg": 53.75, "max": 45.47, "min": 64.29, "cnt": 32}, "fwd-layernorm":{"total": 12.03, "avg": 0.09, "max": 0.06, "min": 0.22, "cnt": 128}, "fwd-attn":{"total": 118.07, "avg": 0.92, "max": 0.75, "min": 1.81, "cnt": 128}, "fwd-misc":{"total": 24.53, "avg": 0.19, "max": 0.12, "min": 0.43, "cnt": 128}, "fwd-MLP":{"total": 1538.82, "avg": 12.02, "max": 9.20, "min": 18.93, "cnt": 128}, "MoE_L0_fwd":{"total": 447.89, "avg": 14.00, "max": 9.11, "min": 18.84, "cnt": 32}, "MoEMLP":{"total": 1519.31, "avg": 11.87, "max": 9.07, "min": 18.79, "cnt": 128}, "MoE_L1_fwd":{"total": 394.99, "avg": 12.34, "max": 10.29, "min": 16.49, "cnt": 32}, "MoE_L2_fwd":{"total": 328.01, "avg": 10.25, "max": 9.62, "min": 13.68, "cnt": 32}, "MoE_L3_fwd":{"total": 355.62, "avg": 11.11, "max": 10.49, "min": 12.09, "cnt": 32}, "fwd-pooler":{"total": 0.37, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.66, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 0.98, "avg": 0.98, "max": 0.98, "min": 0.98, "cnt": 1}, "forward-send-backward-recv":{"total": 667.48, "avg": 21.53, "max": 1.78, "min": 156.63, "cnt": 31}, "backward-compute":{"total": 1443.55, "avg": 45.11, "max": 43.69, "min": 47.98, "cnt": 32}, "MoE_L3_bwd":{"total": 359.41, "avg": 11.23, "max": 10.11, "min": 12.41, "cnt": 32}, "MoE_L2_bwd":{"total": 303.33, "avg": 9.48, "max": 8.83, "min": 10.71, "cnt": 32}, "MoE_L1_bwd":{"total": 291.92, "avg": 9.12, "max": 8.32, "min": 11.50, "cnt": 32}, "MoE_L0_bwd":{"total": 266.67, "avg": 8.33, "max": 7.79, "min": 8.79, "cnt": 32}, "backward-send-forward-recv":{"total": 5649.80, "avg": 188.33, "max": 2.32, "min": 953.22, "cnt": 30}, "backward-send":{"total": 2.28, "avg": 1.14, "max": 0.87, "min": 1.41, "cnt": 2}, "backward-recv":{"total": 66.80, "avg": 66.80, "max": 66.80, "min": 66.80, "cnt": 1}, "backward-params-all-reduce":{"total": 492.34, "avg": 492.34, "max": 492.34, "min": 492.34, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.04, "avg": 0.04, "max": 0.04, "min": 0.04, "cnt": 1}, "optimizer":{"total": 273.85, "avg": 273.85, "max": 273.85, "min": 273.85, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 233.90, "avg": 233.90, "max": 233.90, "min": 233.90, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.35, "avg": 3.35, "max": 3.35, "min": 3.35, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.51, "avg": 3.51, "max": 3.51, "min": 3.51, "cnt": 1}}}
{"type":"time", "iteration": 117, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.10, "avg": 0.10, "max": 0.10, "min": 0.10, "cnt": 1}, "forward-recv":{"total": 130.28, "avg": 65.14, "max": 1.16, "min": 129.12, "cnt": 2}, "forward-compute":{"total": 1792.50, "avg": 56.02, "max": 49.33, "min": 64.04, "cnt": 32}, "fwd-compute":{"total": 1789.09, "avg": 55.91, "max": 49.25, "min": 63.93, "cnt": 32}, "batch-generator":{"total": 41.36, "avg": 1.29, "max": 0.72, "min": 2.33, "cnt": 32}, "fwd-embedding":{"total": 0.62, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1733.75, "avg": 54.18, "max": 48.05, "min": 62.25, "cnt": 32}, "fwd-layernorm":{"total": 10.43, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 110.41, "avg": 0.86, "max": 0.75, "min": 1.74, "cnt": 128}, "fwd-misc":{"total": 22.36, "avg": 0.17, "max": 0.12, "min": 0.41, "cnt": 128}, "fwd-MLP":{"total": 1566.61, "avg": 12.24, "max": 10.02, "min": 20.88, "cnt": 128}, "MoE_L0_fwd":{"total": 449.17, "avg": 14.04, "max": 9.99, "min": 20.79, "cnt": 32}, "MoEMLP":{"total": 1548.24, "avg": 12.10, "max": 9.91, "min": 20.74, "cnt": 128}, "MoE_L1_fwd":{"total": 391.27, "avg": 12.23, "max": 10.09, "min": 14.89, "cnt": 32}, "MoE_L2_fwd":{"total": 342.02, "avg": 10.69, "max": 9.95, "min": 14.89, "cnt": 32}, "MoE_L3_fwd":{"total": 372.43, "avg": 11.64, "max": 10.46, "min": 19.46, "cnt": 32}, "fwd-pooler":{"total": 0.36, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.64, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.08, "avg": 1.08, "max": 1.08, "min": 1.08, "cnt": 1}, "forward-send-backward-recv":{"total": 677.95, "avg": 21.87, "max": 1.00, "min": 219.89, "cnt": 31}, "backward-compute":{"total": 1467.37, "avg": 45.86, "max": 42.15, "min": 48.05, "cnt": 32}, "MoE_L3_bwd":{"total": 362.98, "avg": 11.34, "max": 10.21, "min": 12.54, "cnt": 32}, "MoE_L2_bwd":{"total": 317.67, "avg": 9.93, "max": 9.15, "min": 11.83, "cnt": 32}, "MoE_L1_bwd":{"total": 281.59, "avg": 8.80, "max": 7.43, "min": 10.79, "cnt": 32}, "MoE_L0_bwd":{"total": 281.75, "avg": 8.80, "max": 7.84, "min": 10.39, "cnt": 32}, "backward-send-forward-recv":{"total": 2496.47, "avg": 83.22, "max": 1.14, "min": 411.96, "cnt": 30}, "backward-send":{"total": 1.55, "avg": 0.78, "max": 0.76, "min": 0.79, "cnt": 2}, "backward-recv":{"total": 73.21, "avg": 73.21, "max": 73.21, "min": 73.21, "cnt": 1}, "backward-params-all-reduce":{"total": 487.34, "avg": 487.34, "max": 487.34, "min": 487.34, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 291.55, "avg": 291.55, "max": 291.55, "min": 291.55, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 251.68, "avg": 251.68, "max": 251.68, "min": 251.68, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.32, "avg": 3.32, "max": 3.32, "min": 3.32, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 118, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 127.79, "avg": 63.89, "max": 0.88, "min": 126.90, "cnt": 2}, "forward-compute":{"total": 1744.86, "avg": 54.53, "max": 48.99, "min": 63.14, "cnt": 32}, "fwd-compute":{"total": 1741.40, "avg": 54.42, "max": 48.89, "min": 63.00, "cnt": 32}, "batch-generator":{"total": 43.69, "avg": 1.37, "max": 0.72, "min": 1.86, "cnt": 32}, "fwd-embedding":{"total": 0.64, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1683.95, "avg": 52.62, "max": 47.14, "min": 60.98, "cnt": 32}, "fwd-layernorm":{"total": 10.69, "avg": 0.08, "max": 0.06, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 110.51, "avg": 0.86, "max": 0.75, "min": 1.49, "cnt": 128}, "fwd-misc":{"total": 22.36, "avg": 0.17, "max": 0.12, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1516.45, "avg": 11.85, "max": 10.04, "min": 16.49, "cnt": 128}, "MoE_L0_fwd":{"total": 426.32, "avg": 13.32, "max": 9.96, "min": 16.36, "cnt": 32}, "MoEMLP":{"total": 1498.16, "avg": 11.70, "max": 9.88, "min": 16.27, "cnt": 128}, "MoE_L1_fwd":{"total": 372.40, "avg": 11.64, "max": 9.94, "min": 14.62, "cnt": 32}, "MoE_L2_fwd":{"total": 351.93, "avg": 11.00, "max": 10.09, "min": 15.48, "cnt": 32}, "MoE_L3_fwd":{"total": 354.24, "avg": 11.07, "max": 10.43, "min": 13.91, "cnt": 32}, "fwd-pooler":{"total": 0.39, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.63, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 0.76, "avg": 0.76, "max": 0.76, "min": 0.76, "cnt": 1}, "forward-send-backward-recv":{"total": 870.22, "avg": 28.07, "max": 1.33, "min": 208.74, "cnt": 31}, "backward-compute":{"total": 1439.73, "avg": 44.99, "max": 41.44, "min": 47.80, "cnt": 32}, "MoE_L3_bwd":{"total": 354.38, "avg": 11.07, "max": 9.54, "min": 13.97, "cnt": 32}, "MoE_L2_bwd":{"total": 311.46, "avg": 9.73, "max": 8.98, "min": 10.22, "cnt": 32}, "MoE_L1_bwd":{"total": 285.29, "avg": 8.92, "max": 8.23, "min": 10.34, "cnt": 32}, "MoE_L0_bwd":{"total": 273.61, "avg": 8.55, "max": 8.17, "min": 9.05, "cnt": 32}, "backward-send-forward-recv":{"total": 1814.22, "avg": 60.47, "max": 2.03, "min": 261.98, "cnt": 30}, "backward-send":{"total": 2.26, "avg": 1.13, "max": 0.84, "min": 1.42, "cnt": 2}, "backward-recv":{"total": 291.90, "avg": 291.90, "max": 291.90, "min": 291.90, "cnt": 1}, "backward-params-all-reduce":{"total": 487.12, "avg": 487.12, "max": 487.12, "min": 487.12, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 278.07, "avg": 278.07, "max": 278.07, "min": 278.07, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 238.14, "avg": 238.14, "max": 238.14, "min": 238.14, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.30, "avg": 3.30, "max": 3.30, "min": 3.30, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.52, "avg": 3.52, "max": 3.52, "min": 3.52, "cnt": 1}}}
{"type":"time", "iteration": 119, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 133.41, "avg": 66.71, "max": 1.51, "min": 131.90, "cnt": 2}, "forward-compute":{"total": 1786.37, "avg": 55.82, "max": 49.07, "min": 63.13, "cnt": 32}, "fwd-compute":{"total": 1783.02, "avg": 55.72, "max": 48.99, "min": 63.05, "cnt": 32}, "batch-generator":{"total": 43.77, "avg": 1.37, "max": 0.79, "min": 2.11, "cnt": 32}, "fwd-embedding":{"total": 0.63, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1725.85, "avg": 53.93, "max": 47.46, "min": 60.89, "cnt": 32}, "fwd-layernorm":{"total": 10.35, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 109.41, "avg": 0.85, "max": 0.75, "min": 1.53, "cnt": 128}, "fwd-misc":{"total": 22.06, "avg": 0.17, "max": 0.12, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1560.67, "avg": 12.19, "max": 10.02, "min": 19.67, "cnt": 128}, "MoE_L0_fwd":{"total": 457.83, "avg": 14.31, "max": 10.01, "min": 19.49, "cnt": 32}, "MoEMLP":{"total": 1542.51, "avg": 12.05, "max": 9.90, "min": 19.44, "cnt": 128}, "MoE_L1_fwd":{"total": 382.81, "avg": 11.96, "max": 10.23, "min": 15.70, "cnt": 32}, "MoE_L2_fwd":{"total": 341.78, "avg": 10.68, "max": 9.94, "min": 12.81, "cnt": 32}, "MoE_L3_fwd":{"total": 366.72, "avg": 11.46, "max": 10.52, "min": 16.00, "cnt": 32}, "fwd-pooler":{"total": 0.37, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.64, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 0.99, "avg": 0.99, "max": 0.99, "min": 0.99, "cnt": 1}, "forward-send-backward-recv":{"total": 384.92, "avg": 12.42, "max": 1.28, "min": 66.22, "cnt": 31}, "backward-compute":{"total": 1448.12, "avg": 45.25, "max": 42.58, "min": 48.20, "cnt": 32}, "MoE_L3_bwd":{"total": 363.46, "avg": 11.36, "max": 10.67, "min": 12.68, "cnt": 32}, "MoE_L2_bwd":{"total": 299.62, "avg": 9.36, "max": 8.63, "min": 10.07, "cnt": 32}, "MoE_L1_bwd":{"total": 280.67, "avg": 8.77, "max": 8.26, "min": 10.61, "cnt": 32}, "MoE_L0_bwd":{"total": 287.15, "avg": 8.97, "max": 8.50, "min": 10.04, "cnt": 32}, "backward-send-forward-recv":{"total": 1948.35, "avg": 64.95, "max": 2.28, "min": 308.43, "cnt": 30}, "backward-send":{"total": 2.07, "avg": 1.04, "max": 1.02, "min": 1.05, "cnt": 2}, "backward-recv":{"total": 69.92, "avg": 69.92, "max": 69.92, "min": 69.92, "cnt": 1}, "backward-params-all-reduce":{"total": 485.99, "avg": 485.99, "max": 485.99, "min": 485.99, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 282.46, "avg": 282.46, "max": 282.46, "min": 282.46, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 238.09, "avg": 238.09, "max": 238.09, "min": 238.09, "cnt": 1}, "optimizer-clip-main-grad":{"total": 5.78, "avg": 5.78, "max": 5.78, "min": 5.78, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.48, "avg": 3.48, "max": 3.48, "min": 3.48, "cnt": 1}}}
{"type":"time", "iteration": 120, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.10, "avg": 0.10, "max": 0.10, "min": 0.10, "cnt": 1}, "forward-recv":{"total": 137.44, "avg": 68.72, "max": 1.46, "min": 135.99, "cnt": 2}, "forward-compute":{"total": 1841.75, "avg": 57.55, "max": 51.57, "min": 65.55, "cnt": 32}, "fwd-compute":{"total": 1837.69, "avg": 57.43, "max": 51.48, "min": 65.43, "cnt": 32}, "batch-generator":{"total": 54.65, "avg": 1.71, "max": 0.77, "min": 2.63, "cnt": 32}, "fwd-embedding":{"total": 0.89, "avg": 0.03, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1767.10, "avg": 55.22, "max": 48.98, "min": 63.14, "cnt": 32}, "fwd-layernorm":{"total": 12.53, "avg": 0.10, "max": 0.06, "min": 0.25, "cnt": 128}, "fwd-attn":{"total": 121.06, "avg": 0.95, "max": 0.75, "min": 1.91, "cnt": 128}, "fwd-misc":{"total": 25.30, "avg": 0.20, "max": 0.12, "min": 0.43, "cnt": 128}, "fwd-MLP":{"total": 1582.02, "avg": 12.36, "max": 9.94, "min": 19.28, "cnt": 128}, "MoE_L0_fwd":{"total": 473.61, "avg": 14.80, "max": 11.21, "min": 19.12, "cnt": 32}, "MoEMLP":{"total": 1561.83, "avg": 12.20, "max": 9.82, "min": 19.02, "cnt": 128}, "MoE_L1_fwd":{"total": 386.13, "avg": 12.07, "max": 10.45, "min": 15.32, "cnt": 32}, "MoE_L2_fwd":{"total": 345.31, "avg": 10.79, "max": 9.86, "min": 16.26, "cnt": 32}, "MoE_L3_fwd":{"total": 364.05, "avg": 11.38, "max": 10.33, "min": 14.25, "cnt": 32}, "fwd-pooler":{"total": 0.37, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.65, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 0.87, "avg": 0.87, "max": 0.87, "min": 0.87, "cnt": 1}, "forward-send-backward-recv":{"total": 2466.61, "avg": 79.57, "max": 1.95, "min": 510.21, "cnt": 31}, "backward-compute":{"total": 1472.88, "avg": 46.03, "max": 42.77, "min": 48.75, "cnt": 32}, "MoE_L3_bwd":{"total": 369.52, "avg": 11.55, "max": 10.63, "min": 12.65, "cnt": 32}, "MoE_L2_bwd":{"total": 296.31, "avg": 9.26, "max": 8.64, "min": 9.89, "cnt": 32}, "MoE_L1_bwd":{"total": 286.72, "avg": 8.96, "max": 8.32, "min": 11.66, "cnt": 32}, "MoE_L0_bwd":{"total": 290.81, "avg": 9.09, "max": 8.30, "min": 9.85, "cnt": 32}, "backward-send-forward-recv":{"total": 822.80, "avg": 27.43, "max": 1.54, "min": 637.34, "cnt": 30}, "backward-send":{"total": 1.86, "avg": 0.93, "max": 0.91, "min": 0.95, "cnt": 2}, "backward-recv":{"total": 222.94, "avg": 222.94, "max": 222.94, "min": 222.94, "cnt": 1}, "backward-params-all-reduce":{"total": 491.97, "avg": 491.97, "max": 491.97, "min": 491.97, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 275.10, "avg": 275.10, "max": 275.10, "min": 275.10, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 234.47, "avg": 234.47, "max": 234.47, "min": 234.47, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.87, "avg": 3.87, "max": 3.87, "min": 3.87, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.54, "avg": 3.54, "max": 3.54, "min": 3.54, "cnt": 1}}}
{"type":"time", "iteration": 121, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 122.70, "avg": 61.35, "max": 0.93, "min": 121.77, "cnt": 2}, "forward-compute":{"total": 1857.52, "avg": 58.05, "max": 49.43, "min": 109.48, "cnt": 32}, "fwd-compute":{"total": 1853.98, "avg": 57.94, "max": 49.34, "min": 109.40, "cnt": 32}, "batch-generator":{"total": 44.80, "avg": 1.40, "max": 0.76, "min": 2.22, "cnt": 32}, "fwd-embedding":{"total": 0.66, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1795.38, "avg": 56.11, "max": 48.14, "min": 107.79, "cnt": 32}, "fwd-layernorm":{"total": 10.92, "avg": 0.09, "max": 0.06, "min": 0.22, "cnt": 128}, "fwd-attn":{"total": 110.85, "avg": 0.87, "max": 0.75, "min": 1.81, "cnt": 128}, "fwd-misc":{"total": 22.85, "avg": 0.18, "max": 0.12, "min": 0.41, "cnt": 128}, "fwd-MLP":{"total": 1626.15, "avg": 12.70, "max": 9.93, "min": 69.14, "cnt": 128}, "MoE_L0_fwd":{"total": 515.39, "avg": 16.11, "max": 11.46, "min": 69.05, "cnt": 32}, "MoEMLP":{"total": 1607.41, "avg": 12.56, "max": 9.80, "min": 68.99, "cnt": 128}, "MoE_L1_fwd":{"total": 382.93, "avg": 11.97, "max": 10.47, "min": 14.39, "cnt": 32}, "MoE_L2_fwd":{"total": 346.92, "avg": 10.84, "max": 9.84, "min": 15.74, "cnt": 32}, "MoE_L3_fwd":{"total": 368.99, "avg": 11.53, "max": 10.37, "min": 16.04, "cnt": 32}, "fwd-pooler":{"total": 0.37, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.68, "avg": 0.02, "max": 0.02, "min": 0.04, "cnt": 32}, "forward-send":{"total": 0.78, "avg": 0.78, "max": 0.78, "min": 0.78, "cnt": 1}, "forward-send-backward-recv":{"total": 296.25, "avg": 9.56, "max": 1.50, "min": 61.60, "cnt": 31}, "backward-compute":{"total": 1474.10, "avg": 46.07, "max": 43.45, "min": 52.42, "cnt": 32}, "MoE_L3_bwd":{"total": 369.30, "avg": 11.54, "max": 10.35, "min": 18.53, "cnt": 32}, "MoE_L2_bwd":{"total": 298.14, "avg": 9.32, "max": 8.52, "min": 11.68, "cnt": 32}, "MoE_L1_bwd":{"total": 289.52, "avg": 9.05, "max": 8.44, "min": 10.25, "cnt": 32}, "MoE_L0_bwd":{"total": 294.01, "avg": 9.19, "max": 8.42, "min": 10.20, "cnt": 32}, "backward-send-forward-recv":{"total": 1728.62, "avg": 57.62, "max": 2.35, "min": 245.83, "cnt": 30}, "backward-send":{"total": 2.25, "avg": 1.13, "max": 1.08, "min": 1.17, "cnt": 2}, "backward-recv":{"total": 72.91, "avg": 72.91, "max": 72.91, "min": 72.91, "cnt": 1}, "backward-params-all-reduce":{"total": 489.76, "avg": 489.76, "max": 489.76, "min": 489.76, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 289.04, "avg": 289.04, "max": 289.04, "min": 289.04, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.41, "avg": 3.41, "max": 3.41, "min": 3.41, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 240.53, "avg": 240.53, "max": 240.53, "min": 240.53, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.41, "avg": 3.41, "max": 3.41, "min": 3.41, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.48, "avg": 3.48, "max": 3.48, "min": 3.48, "cnt": 1}}}
{"type":"time", "iteration": 122, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 116.38, "avg": 58.19, "max": 1.39, "min": 115.00, "cnt": 2}, "forward-compute":{"total": 1817.54, "avg": 56.80, "max": 51.25, "min": 62.77, "cnt": 32}, "fwd-compute":{"total": 1814.06, "avg": 56.69, "max": 51.15, "min": 62.64, "cnt": 32}, "batch-generator":{"total": 48.06, "avg": 1.50, "max": 0.79, "min": 2.39, "cnt": 32}, "fwd-embedding":{"total": 0.64, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1751.73, "avg": 54.74, "max": 49.69, "min": 60.65, "cnt": 32}, "fwd-layernorm":{"total": 11.12, "avg": 0.09, "max": 0.06, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 117.38, "avg": 0.92, "max": 0.75, "min": 3.38, "cnt": 128}, "fwd-misc":{"total": 23.69, "avg": 0.19, "max": 0.12, "min": 0.44, "cnt": 128}, "fwd-MLP":{"total": 1574.62, "avg": 12.30, "max": 9.91, "min": 17.87, "cnt": 128}, "MoE_L0_fwd":{"total": 459.03, "avg": 14.34, "max": 10.88, "min": 17.79, "cnt": 32}, "MoEMLP":{"total": 1555.21, "avg": 12.15, "max": 9.76, "min": 17.74, "cnt": 128}, "MoE_L1_fwd":{"total": 393.74, "avg": 12.30, "max": 10.68, "min": 17.59, "cnt": 32}, "MoE_L2_fwd":{"total": 339.66, "avg": 10.61, "max": 9.82, "min": 12.59, "cnt": 32}, "MoE_L3_fwd":{"total": 369.90, "avg": 11.56, "max": 10.37, "min": 15.81, "cnt": 32}, "fwd-pooler":{"total": 0.39, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.67, "avg": 0.02, "max": 0.02, "min": 0.04, "cnt": 32}, "forward-send":{"total": 0.87, "avg": 0.87, "max": 0.87, "min": 0.87, "cnt": 1}, "forward-send-backward-recv":{"total": 214.35, "avg": 6.91, "max": 1.25, "min": 55.53, "cnt": 31}, "backward-compute":{"total": 1461.59, "avg": 45.67, "max": 43.29, "min": 47.58, "cnt": 32}, "MoE_L3_bwd":{"total": 359.37, "avg": 11.23, "max": 10.54, "min": 12.97, "cnt": 32}, "MoE_L2_bwd":{"total": 295.83, "avg": 9.24, "max": 8.30, "min": 9.93, "cnt": 32}, "MoE_L1_bwd":{"total": 288.15, "avg": 9.00, "max": 8.38, "min": 9.69, "cnt": 32}, "MoE_L0_bwd":{"total": 300.71, "avg": 9.40, "max": 8.73, "min": 10.80, "cnt": 32}, "backward-send-forward-recv":{"total": 2486.78, "avg": 82.89, "max": 1.71, "min": 699.38, "cnt": 30}, "backward-send":{"total": 2.15, "avg": 1.07, "max": 0.95, "min": 1.20, "cnt": 2}, "backward-recv":{"total": 75.13, "avg": 75.13, "max": 75.13, "min": 75.13, "cnt": 1}, "backward-params-all-reduce":{"total": 494.42, "avg": 494.42, "max": 494.42, "min": 494.42, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 278.24, "avg": 278.24, "max": 278.24, "min": 278.24, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 238.70, "avg": 238.70, "max": 238.70, "min": 238.70, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.06, "avg": 3.06, "max": 3.06, "min": 3.06, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.47, "avg": 3.47, "max": 3.47, "min": 3.47, "cnt": 1}}}
{"type":"time", "iteration": 123, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 128.80, "avg": 64.40, "max": 4.94, "min": 123.87, "cnt": 2}, "forward-compute":{"total": 1788.36, "avg": 55.89, "max": 49.91, "min": 60.39, "cnt": 32}, "fwd-compute":{"total": 1784.47, "avg": 55.76, "max": 49.77, "min": 60.25, "cnt": 32}, "batch-generator":{"total": 47.65, "avg": 1.49, "max": 0.75, "min": 2.65, "cnt": 32}, "fwd-embedding":{"total": 0.70, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1721.59, "avg": 53.80, "max": 48.25, "min": 57.90, "cnt": 32}, "fwd-layernorm":{"total": 11.61, "avg": 0.09, "max": 0.06, "min": 0.22, "cnt": 128}, "fwd-attn":{"total": 118.94, "avg": 0.93, "max": 0.75, "min": 2.76, "cnt": 128}, "fwd-misc":{"total": 24.77, "avg": 0.19, "max": 0.12, "min": 0.66, "cnt": 128}, "fwd-MLP":{"total": 1540.64, "avg": 12.04, "max": 9.81, "min": 17.00, "cnt": 128}, "MoE_L0_fwd":{"total": 453.54, "avg": 14.17, "max": 10.31, "min": 16.91, "cnt": 32}, "MoEMLP":{"total": 1520.65, "avg": 11.88, "max": 9.69, "min": 16.85, "cnt": 128}, "MoE_L1_fwd":{"total": 376.96, "avg": 11.78, "max": 10.56, "min": 14.12, "cnt": 32}, "MoE_L2_fwd":{"total": 327.94, "avg": 10.25, "max": 9.74, "min": 12.37, "cnt": 32}, "MoE_L3_fwd":{"total": 369.44, "avg": 11.54, "max": 10.47, "min": 14.02, "cnt": 32}, "fwd-pooler":{"total": 0.41, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.71, "avg": 0.02, "max": 0.02, "min": 0.06, "cnt": 32}, "forward-send":{"total": 0.91, "avg": 0.91, "max": 0.91, "min": 0.91, "cnt": 1}, "forward-send-backward-recv":{"total": 913.38, "avg": 29.46, "max": 1.53, "min": 276.34, "cnt": 31}, "backward-compute":{"total": 1467.48, "avg": 45.86, "max": 43.02, "min": 48.10, "cnt": 32}, "MoE_L3_bwd":{"total": 357.41, "avg": 11.17, "max": 9.94, "min": 13.36, "cnt": 32}, "MoE_L2_bwd":{"total": 293.57, "avg": 9.17, "max": 8.46, "min": 10.19, "cnt": 32}, "MoE_L1_bwd":{"total": 286.74, "avg": 8.96, "max": 8.30, "min": 10.27, "cnt": 32}, "MoE_L0_bwd":{"total": 308.31, "avg": 9.63, "max": 8.59, "min": 12.21, "cnt": 32}, "backward-send-forward-recv":{"total": 1990.43, "avg": 66.35, "max": 1.84, "min": 347.64, "cnt": 30}, "backward-send":{"total": 2.02, "avg": 1.01, "max": 0.92, "min": 1.10, "cnt": 2}, "backward-recv":{"total": 180.67, "avg": 180.67, "max": 180.67, "min": 180.67, "cnt": 1}, "backward-params-all-reduce":{"total": 490.22, "avg": 490.22, "max": 490.22, "min": 490.22, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 280.55, "avg": 280.55, "max": 280.55, "min": 280.55, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.40, "avg": 3.40, "max": 3.40, "min": 3.40, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 240.62, "avg": 240.62, "max": 240.62, "min": 240.62, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 124, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 119.65, "avg": 59.82, "max": 1.47, "min": 118.18, "cnt": 2}, "forward-compute":{"total": 1786.35, "avg": 55.82, "max": 49.56, "min": 64.16, "cnt": 32}, "fwd-compute":{"total": 1782.83, "avg": 55.71, "max": 49.47, "min": 64.08, "cnt": 32}, "batch-generator":{"total": 42.84, "avg": 1.34, "max": 0.75, "min": 2.59, "cnt": 32}, "fwd-embedding":{"total": 0.66, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1723.93, "avg": 53.87, "max": 48.02, "min": 62.07, "cnt": 32}, "fwd-layernorm":{"total": 10.47, "avg": 0.08, "max": 0.06, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 108.86, "avg": 0.85, "max": 0.75, "min": 1.61, "cnt": 128}, "fwd-misc":{"total": 22.33, "avg": 0.17, "max": 0.12, "min": 0.41, "cnt": 128}, "fwd-MLP":{"total": 1558.10, "avg": 12.17, "max": 9.81, "min": 18.92, "cnt": 128}, "MoE_L0_fwd":{"total": 471.01, "avg": 14.72, "max": 11.01, "min": 18.84, "cnt": 32}, "MoEMLP":{"total": 1539.97, "avg": 12.03, "max": 9.69, "min": 18.79, "cnt": 128}, "MoE_L1_fwd":{"total": 381.05, "avg": 11.91, "max": 10.27, "min": 16.28, "cnt": 32}, "MoE_L2_fwd":{"total": 334.86, "avg": 10.46, "max": 9.74, "min": 12.23, "cnt": 32}, "MoE_L3_fwd":{"total": 359.65, "avg": 11.24, "max": 10.24, "min": 16.81, "cnt": 32}, "fwd-pooler":{"total": 0.37, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.68, "avg": 0.02, "max": 0.02, "min": 0.06, "cnt": 32}, "forward-send":{"total": 1.01, "avg": 1.01, "max": 1.01, "min": 1.01, "cnt": 1}, "forward-send-backward-recv":{"total": 870.74, "avg": 28.09, "max": 1.13, "min": 206.68, "cnt": 31}, "backward-compute":{"total": 1451.10, "avg": 45.35, "max": 44.15, "min": 48.44, "cnt": 32}, "MoE_L3_bwd":{"total": 356.99, "avg": 11.16, "max": 10.50, "min": 12.74, "cnt": 32}, "MoE_L2_bwd":{"total": 298.02, "avg": 9.31, "max": 8.53, "min": 11.82, "cnt": 32}, "MoE_L1_bwd":{"total": 284.76, "avg": 8.90, "max": 8.47, "min": 10.60, "cnt": 32}, "MoE_L0_bwd":{"total": 296.74, "avg": 9.27, "max": 8.78, "min": 11.15, "cnt": 32}, "backward-send-forward-recv":{"total": 2446.58, "avg": 81.55, "max": 1.17, "min": 682.03, "cnt": 30}, "backward-send":{"total": 2.23, "avg": 1.11, "max": 1.03, "min": 1.19, "cnt": 2}, "backward-recv":{"total": 94.15, "avg": 94.15, "max": 94.15, "min": 94.15, "cnt": 1}, "backward-params-all-reduce":{"total": 491.54, "avg": 491.54, "max": 491.54, "min": 491.54, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "optimizer":{"total": 276.33, "avg": 276.33, "max": 276.33, "min": 276.33, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 6.00, "avg": 6.00, "max": 6.00, "min": 6.00, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 233.55, "avg": 233.55, "max": 233.55, "min": 233.55, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.36, "avg": 3.36, "max": 3.36, "min": 3.36, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.52, "avg": 3.52, "max": 3.52, "min": 3.52, "cnt": 1}}}
{"type":"time", "iteration": 125, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 137.60, "avg": 68.80, "max": 9.16, "min": 128.44, "cnt": 2}, "forward-compute":{"total": 1773.32, "avg": 55.42, "max": 48.42, "min": 63.81, "cnt": 32}, "fwd-compute":{"total": 1769.91, "avg": 55.31, "max": 48.34, "min": 63.73, "cnt": 32}, "batch-generator":{"total": 43.83, "avg": 1.37, "max": 0.78, "min": 2.79, "cnt": 32}, "fwd-embedding":{"total": 0.59, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1712.02, "avg": 53.50, "max": 47.19, "min": 62.47, "cnt": 32}, "fwd-layernorm":{"total": 10.66, "avg": 0.08, "max": 0.06, "min": 0.27, "cnt": 128}, "fwd-attn":{"total": 112.03, "avg": 0.88, "max": 0.75, "min": 2.17, "cnt": 128}, "fwd-misc":{"total": 22.42, "avg": 0.18, "max": 0.12, "min": 0.55, "cnt": 128}, "fwd-MLP":{"total": 1542.80, "avg": 12.05, "max": 9.86, "min": 20.54, "cnt": 128}, "MoE_L0_fwd":{"total": 462.76, "avg": 14.46, "max": 10.99, "min": 20.43, "cnt": 32}, "MoEMLP":{"total": 1524.55, "avg": 11.91, "max": 9.74, "min": 20.37, "cnt": 128}, "MoE_L1_fwd":{"total": 371.48, "avg": 11.61, "max": 10.31, "min": 16.55, "cnt": 32}, "MoE_L2_fwd":{"total": 332.70, "avg": 10.40, "max": 9.79, "min": 11.91, "cnt": 32}, "MoE_L3_fwd":{"total": 364.24, "avg": 11.38, "max": 10.48, "min": 13.72, "cnt": 32}, "fwd-pooler":{"total": 0.37, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.63, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 0.96, "avg": 0.96, "max": 0.96, "min": 0.96, "cnt": 1}, "forward-send-backward-recv":{"total": 257.84, "avg": 8.32, "max": 1.00, "min": 57.70, "cnt": 31}, "backward-compute":{"total": 1462.38, "avg": 45.70, "max": 43.60, "min": 47.50, "cnt": 32}, "MoE_L3_bwd":{"total": 364.95, "avg": 11.40, "max": 10.61, "min": 12.60, "cnt": 32}, "MoE_L2_bwd":{"total": 294.76, "avg": 9.21, "max": 8.24, "min": 10.54, "cnt": 32}, "MoE_L1_bwd":{"total": 279.63, "avg": 8.74, "max": 8.06, "min": 9.48, "cnt": 32}, "MoE_L0_bwd":{"total": 301.03, "avg": 9.41, "max": 8.98, "min": 10.24, "cnt": 32}, "backward-send-forward-recv":{"total": 2003.10, "avg": 66.77, "max": 1.71, "min": 240.59, "cnt": 30}, "backward-send":{"total": 2.17, "avg": 1.09, "max": 1.01, "min": 1.17, "cnt": 2}, "backward-recv":{"total": 68.06, "avg": 68.06, "max": 68.06, "min": 68.06, "cnt": 1}, "backward-params-all-reduce":{"total": 488.58, "avg": 488.58, "max": 488.58, "min": 488.58, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 286.93, "avg": 286.93, "max": 286.93, "min": 286.93, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.40, "avg": 3.40, "max": 3.40, "min": 3.40, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 240.89, "avg": 240.89, "max": 240.89, "min": 240.89, "cnt": 1}, "optimizer-clip-main-grad":{"total": 5.71, "avg": 5.71, "max": 5.71, "min": 5.71, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.48, "avg": 3.48, "max": 3.48, "min": 3.48, "cnt": 1}}}
{"type":"time", "iteration": 126, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.10, "avg": 0.10, "max": 0.10, "min": 0.10, "cnt": 1}, "forward-recv":{"total": 130.47, "avg": 65.23, "max": 2.41, "min": 128.06, "cnt": 2}, "forward-compute":{"total": 1842.02, "avg": 57.56, "max": 51.00, "min": 66.12, "cnt": 32}, "fwd-compute":{"total": 1838.07, "avg": 57.44, "max": 50.91, "min": 65.97, "cnt": 32}, "batch-generator":{"total": 53.03, "avg": 1.66, "max": 0.88, "min": 2.18, "cnt": 32}, "fwd-embedding":{"total": 0.82, "avg": 0.03, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1769.53, "avg": 55.30, "max": 49.62, "min": 63.20, "cnt": 32}, "fwd-layernorm":{"total": 12.45, "avg": 0.10, "max": 0.06, "min": 0.22, "cnt": 128}, "fwd-attn":{"total": 123.29, "avg": 0.96, "max": 0.75, "min": 1.84, "cnt": 128}, "fwd-misc":{"total": 26.08, "avg": 0.20, "max": 0.12, "min": 0.43, "cnt": 128}, "fwd-MLP":{"total": 1580.78, "avg": 12.35, "max": 9.86, "min": 21.82, "cnt": 128}, "MoE_L0_fwd":{"total": 476.97, "avg": 14.91, "max": 11.20, "min": 21.67, "cnt": 32}, "MoEMLP":{"total": 1559.80, "avg": 12.19, "max": 9.75, "min": 21.59, "cnt": 128}, "MoE_L1_fwd":{"total": 374.30, "avg": 11.70, "max": 10.74, "min": 14.02, "cnt": 32}, "MoE_L2_fwd":{"total": 342.60, "avg": 10.71, "max": 9.79, "min": 15.13, "cnt": 32}, "MoE_L3_fwd":{"total": 373.67, "avg": 11.68, "max": 10.50, "min": 15.49, "cnt": 32}, "fwd-pooler":{"total": 0.39, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.66, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 0.99, "avg": 0.99, "max": 0.99, "min": 0.99, "cnt": 1}, "forward-send-backward-recv":{"total": 772.84, "avg": 24.93, "max": 1.81, "min": 205.47, "cnt": 31}, "backward-compute":{"total": 1448.07, "avg": 45.25, "max": 43.47, "min": 49.91, "cnt": 32}, "MoE_L3_bwd":{"total": 361.10, "avg": 11.28, "max": 10.55, "min": 16.56, "cnt": 32}, "MoE_L2_bwd":{"total": 290.01, "avg": 9.06, "max": 7.74, "min": 10.51, "cnt": 32}, "MoE_L1_bwd":{"total": 274.46, "avg": 8.58, "max": 8.17, "min": 9.94, "cnt": 32}, "MoE_L0_bwd":{"total": 298.94, "avg": 9.34, "max": 8.46, "min": 11.18, "cnt": 32}, "backward-send-forward-recv":{"total": 1790.27, "avg": 59.68, "max": 2.32, "min": 281.42, "cnt": 30}, "backward-send":{"total": 2.15, "avg": 1.07, "max": 0.99, "min": 1.16, "cnt": 2}, "backward-recv":{"total": 73.87, "avg": 73.87, "max": 73.87, "min": 73.87, "cnt": 1}, "backward-params-all-reduce":{"total": 489.88, "avg": 489.88, "max": 489.88, "min": 489.88, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 272.87, "avg": 272.87, "max": 272.87, "min": 272.87, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.40, "avg": 3.40, "max": 3.40, "min": 3.40, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 232.73, "avg": 232.73, "max": 232.73, "min": 232.73, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.47, "avg": 3.47, "max": 3.47, "min": 3.47, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.56, "avg": 3.56, "max": 3.56, "min": 3.56, "cnt": 1}}}
{"type":"time", "iteration": 127, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 119.76, "avg": 59.88, "max": 1.34, "min": 118.42, "cnt": 2}, "forward-compute":{"total": 1768.40, "avg": 55.26, "max": 49.48, "min": 63.16, "cnt": 32}, "fwd-compute":{"total": 1764.98, "avg": 55.16, "max": 49.40, "min": 63.08, "cnt": 32}, "batch-generator":{"total": 39.44, "avg": 1.23, "max": 0.78, "min": 2.19, "cnt": 32}, "fwd-embedding":{"total": 0.66, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1711.72, "avg": 53.49, "max": 48.01, "min": 61.92, "cnt": 32}, "fwd-layernorm":{"total": 10.68, "avg": 0.08, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 109.67, "avg": 0.86, "max": 0.75, "min": 1.49, "cnt": 128}, "fwd-misc":{"total": 22.41, "avg": 0.18, "max": 0.12, "min": 0.34, "cnt": 128}, "fwd-MLP":{"total": 1544.96, "avg": 12.07, "max": 10.07, "min": 20.65, "cnt": 128}, "MoE_L0_fwd":{"total": 457.90, "avg": 14.31, "max": 10.73, "min": 20.57, "cnt": 32}, "MoEMLP":{"total": 1526.37, "avg": 11.92, "max": 9.95, "min": 20.52, "cnt": 128}, "MoE_L1_fwd":{"total": 373.50, "avg": 11.67, "max": 10.50, "min": 15.56, "cnt": 32}, "MoE_L2_fwd":{"total": 343.90, "avg": 10.75, "max": 9.99, "min": 14.69, "cnt": 32}, "MoE_L3_fwd":{"total": 357.74, "avg": 11.18, "max": 10.69, "min": 12.41, "cnt": 32}, "fwd-pooler":{"total": 0.38, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.64, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 0.93, "avg": 0.93, "max": 0.93, "min": 0.93, "cnt": 1}, "forward-send-backward-recv":{"total": 653.55, "avg": 21.08, "max": 1.08, "min": 192.01, "cnt": 31}, "backward-compute":{"total": 1462.95, "avg": 45.72, "max": 43.97, "min": 49.49, "cnt": 32}, "MoE_L3_bwd":{"total": 362.14, "avg": 11.32, "max": 9.95, "min": 15.18, "cnt": 32}, "MoE_L2_bwd":{"total": 304.90, "avg": 9.53, "max": 8.14, "min": 10.80, "cnt": 32}, "MoE_L1_bwd":{"total": 282.63, "avg": 8.83, "max": 8.20, "min": 12.22, "cnt": 32}, "MoE_L0_bwd":{"total": 289.67, "avg": 9.05, "max": 8.60, "min": 9.65, "cnt": 32}, "backward-send-forward-recv":{"total": 1534.61, "avg": 51.15, "max": 1.81, "min": 421.72, "cnt": 30}, "backward-send":{"total": 2.06, "avg": 1.03, "max": 1.01, "min": 1.06, "cnt": 2}, "backward-recv":{"total": 261.28, "avg": 261.28, "max": 261.28, "min": 261.28, "cnt": 1}, "backward-params-all-reduce":{"total": 492.88, "avg": 492.88, "max": 492.88, "min": 492.88, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 275.83, "avg": 275.83, "max": 275.83, "min": 275.83, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 236.03, "avg": 236.03, "max": 236.03, "min": 236.03, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.22, "avg": 3.22, "max": 3.22, "min": 3.22, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.48, "avg": 3.48, "max": 3.48, "min": 3.48, "cnt": 1}}}
{"type":"time", "iteration": 128, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 138.26, "avg": 69.13, "max": 8.02, "min": 130.24, "cnt": 2}, "forward-compute":{"total": 1833.39, "avg": 57.29, "max": 50.31, "min": 67.83, "cnt": 32}, "fwd-compute":{"total": 1829.76, "avg": 57.18, "max": 50.21, "min": 67.70, "cnt": 32}, "batch-generator":{"total": 48.57, "avg": 1.52, "max": 0.81, "min": 2.28, "cnt": 32}, "fwd-embedding":{"total": 0.74, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1766.01, "avg": 55.19, "max": 48.69, "min": 65.25, "cnt": 32}, "fwd-layernorm":{"total": 11.81, "avg": 0.09, "max": 0.06, "min": 0.25, "cnt": 128}, "fwd-attn":{"total": 122.86, "avg": 0.96, "max": 0.74, "min": 2.16, "cnt": 128}, "fwd-misc":{"total": 25.22, "avg": 0.20, "max": 0.12, "min": 0.44, "cnt": 128}, "fwd-MLP":{"total": 1579.73, "avg": 12.34, "max": 10.31, "min": 23.23, "cnt": 128}, "MoE_L0_fwd":{"total": 455.97, "avg": 14.25, "max": 10.88, "min": 23.10, "cnt": 32}, "MoEMLP":{"total": 1558.91, "avg": 12.18, "max": 10.19, "min": 23.05, "cnt": 128}, "MoE_L1_fwd":{"total": 378.55, "avg": 11.83, "max": 10.63, "min": 15.75, "cnt": 32}, "MoE_L2_fwd":{"total": 357.49, "avg": 11.17, "max": 10.23, "min": 15.57, "cnt": 32}, "MoE_L3_fwd":{"total": 374.41, "avg": 11.70, "max": 10.81, "min": 15.73, "cnt": 32}, "fwd-pooler":{"total": 0.41, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.66, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 0.96, "avg": 0.96, "max": 0.96, "min": 0.96, "cnt": 1}, "forward-send-backward-recv":{"total": 361.35, "avg": 11.66, "max": 1.31, "min": 88.25, "cnt": 31}, "backward-compute":{"total": 1464.29, "avg": 45.76, "max": 43.20, "min": 50.78, "cnt": 32}, "MoE_L3_bwd":{"total": 363.77, "avg": 11.37, "max": 9.53, "min": 16.44, "cnt": 32}, "MoE_L2_bwd":{"total": 307.57, "avg": 9.61, "max": 8.99, "min": 10.46, "cnt": 32}, "MoE_L1_bwd":{"total": 287.91, "avg": 9.00, "max": 8.42, "min": 9.26, "cnt": 32}, "MoE_L0_bwd":{"total": 282.85, "avg": 8.84, "max": 8.23, "min": 12.21, "cnt": 32}, "backward-send-forward-recv":{"total": 1619.65, "avg": 53.99, "max": 2.07, "min": 214.20, "cnt": 30}, "backward-send":{"total": 1.84, "avg": 0.92, "max": 0.90, "min": 0.94, "cnt": 2}, "backward-recv":{"total": 104.19, "avg": 104.19, "max": 104.19, "min": 104.19, "cnt": 1}, "backward-params-all-reduce":{"total": 486.45, "avg": 486.45, "max": 486.45, "min": 486.45, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 278.92, "avg": 278.92, "max": 278.92, "min": 278.92, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.40, "avg": 3.40, "max": 3.40, "min": 3.40, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 239.01, "avg": 239.01, "max": 239.01, "min": 239.01, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.41, "avg": 3.41, "max": 3.41, "min": 3.41, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.48, "avg": 3.48, "max": 3.48, "min": 3.48, "cnt": 1}}}
{"type":"time", "iteration": 129, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.10, "avg": 0.10, "max": 0.10, "min": 0.10, "cnt": 1}, "forward-recv":{"total": 132.88, "avg": 66.44, "max": 7.40, "min": 125.48, "cnt": 2}, "forward-compute":{"total": 1773.15, "avg": 55.41, "max": 48.86, "min": 61.86, "cnt": 32}, "fwd-compute":{"total": 1769.64, "avg": 55.30, "max": 48.78, "min": 61.78, "cnt": 32}, "batch-generator":{"total": 45.96, "avg": 1.44, "max": 0.71, "min": 2.75, "cnt": 32}, "fwd-embedding":{"total": 0.72, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1708.27, "avg": 53.38, "max": 47.72, "min": 60.00, "cnt": 32}, "fwd-layernorm":{"total": 11.02, "avg": 0.09, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 113.97, "avg": 0.89, "max": 0.75, "min": 1.66, "cnt": 128}, "fwd-misc":{"total": 22.94, "avg": 0.18, "max": 0.11, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1535.49, "avg": 12.00, "max": 10.42, "min": 18.25, "cnt": 128}, "MoE_L0_fwd":{"total": 444.77, "avg": 13.90, "max": 10.62, "min": 18.10, "cnt": 32}, "MoEMLP":{"total": 1516.87, "avg": 11.85, "max": 10.30, "min": 18.01, "cnt": 128}, "MoE_L1_fwd":{"total": 367.90, "avg": 11.50, "max": 10.46, "min": 14.56, "cnt": 32}, "MoE_L2_fwd":{"total": 350.78, "avg": 10.96, "max": 10.47, "min": 12.40, "cnt": 32}, "MoE_L3_fwd":{"total": 360.20, "avg": 11.26, "max": 10.34, "min": 13.98, "cnt": 32}, "fwd-pooler":{"total": 0.36, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.62, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 0.95, "avg": 0.95, "max": 0.95, "min": 0.95, "cnt": 1}, "forward-send-backward-recv":{"total": 286.45, "avg": 9.24, "max": 1.68, "min": 65.28, "cnt": 31}, "backward-compute":{"total": 1460.60, "avg": 45.64, "max": 44.19, "min": 47.99, "cnt": 32}, "MoE_L3_bwd":{"total": 354.95, "avg": 11.09, "max": 10.06, "min": 12.25, "cnt": 32}, "MoE_L2_bwd":{"total": 319.62, "avg": 9.99, "max": 8.89, "min": 12.66, "cnt": 32}, "MoE_L1_bwd":{"total": 292.28, "avg": 9.13, "max": 8.59, "min": 10.63, "cnt": 32}, "MoE_L0_bwd":{"total": 275.40, "avg": 8.61, "max": 8.08, "min": 10.74, "cnt": 32}, "backward-send-forward-recv":{"total": 2609.35, "avg": 86.98, "max": 2.44, "min": 461.02, "cnt": 30}, "backward-send":{"total": 2.18, "avg": 1.09, "max": 1.03, "min": 1.16, "cnt": 2}, "backward-recv":{"total": 73.26, "avg": 73.26, "max": 73.26, "min": 73.26, "cnt": 1}, "backward-params-all-reduce":{"total": 486.23, "avg": 486.23, "max": 486.23, "min": 486.23, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 285.54, "avg": 285.54, "max": 285.54, "min": 285.54, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 238.06, "avg": 238.06, "max": 238.06, "min": 238.06, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.55, "avg": 3.55, "max": 3.55, "min": 3.55, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.52, "avg": 3.52, "max": 3.52, "min": 3.52, "cnt": 1}}}
{"type":"time", "iteration": 130, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 129.35, "avg": 64.67, "max": 1.19, "min": 128.15, "cnt": 2}, "forward-compute":{"total": 1922.77, "avg": 60.09, "max": 51.69, "min": 191.91, "cnt": 32}, "fwd-compute":{"total": 1919.00, "avg": 59.97, "max": 51.62, "min": 191.80, "cnt": 32}, "batch-generator":{"total": 45.66, "avg": 1.43, "max": 0.78, "min": 2.26, "cnt": 32}, "fwd-embedding":{"total": 0.73, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1858.76, "avg": 58.09, "max": 50.26, "min": 190.53, "cnt": 32}, "fwd-layernorm":{"total": 11.62, "avg": 0.09, "max": 0.06, "min": 0.22, "cnt": 128}, "fwd-attn":{"total": 116.84, "avg": 0.91, "max": 0.74, "min": 1.93, "cnt": 128}, "fwd-misc":{"total": 23.88, "avg": 0.19, "max": 0.12, "min": 0.40, "cnt": 128}, "fwd-MLP":{"total": 1681.12, "avg": 13.13, "max": 10.13, "min": 149.59, "cnt": 128}, "MoE_L0_fwd":{"total": 461.84, "avg": 14.43, "max": 11.73, "min": 18.59, "cnt": 32}, "MoEMLP":{"total": 1661.66, "avg": 12.98, "max": 10.00, "min": 149.45, "cnt": 128}, "MoE_L1_fwd":{"total": 490.65, "avg": 15.33, "max": 10.05, "min": 149.50, "cnt": 32}, "MoE_L2_fwd":{"total": 359.34, "avg": 11.23, "max": 10.67, "min": 12.17, "cnt": 32}, "MoE_L3_fwd":{"total": 356.87, "avg": 11.15, "max": 10.19, "min": 13.32, "cnt": 32}, "fwd-pooler":{"total": 0.37, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.63, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.10, "avg": 1.10, "max": 1.10, "min": 1.10, "cnt": 1}, "forward-send-backward-recv":{"total": 858.99, "avg": 27.71, "max": 1.53, "min": 268.24, "cnt": 31}, "backward-compute":{"total": 1458.75, "avg": 45.59, "max": 43.11, "min": 47.88, "cnt": 32}, "MoE_L3_bwd":{"total": 372.33, "avg": 11.64, "max": 10.66, "min": 13.81, "cnt": 32}, "MoE_L2_bwd":{"total": 326.77, "avg": 10.21, "max": 9.38, "min": 10.96, "cnt": 32}, "MoE_L1_bwd":{"total": 265.79, "avg": 8.31, "max": 7.66, "min": 8.85, "cnt": 32}, "MoE_L0_bwd":{"total": 277.98, "avg": 8.69, "max": 7.91, "min": 9.46, "cnt": 32}, "backward-send-forward-recv":{"total": 1562.09, "avg": 52.07, "max": 2.12, "min": 389.09, "cnt": 30}, "backward-send":{"total": 2.12, "avg": 1.06, "max": 0.89, "min": 1.22, "cnt": 2}, "backward-recv":{"total": 75.10, "avg": 75.10, "max": 75.10, "min": 75.10, "cnt": 1}, "backward-params-all-reduce":{"total": 487.87, "avg": 487.87, "max": 487.87, "min": 487.87, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 292.27, "avg": 292.27, "max": 292.27, "min": 292.27, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.66, "avg": 3.66, "max": 3.66, "min": 3.66, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 237.86, "avg": 237.86, "max": 237.86, "min": 237.86, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.48, "avg": 3.48, "max": 3.48, "min": 3.48, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.50, "avg": 3.50, "max": 3.50, "min": 3.50, "cnt": 1}}}
{"type":"time", "iteration": 131, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.12, "avg": 0.12, "max": 0.12, "min": 0.12, "cnt": 1}, "forward-recv":{"total": 113.05, "avg": 56.53, "max": 7.48, "min": 105.57, "cnt": 2}, "forward-compute":{"total": 1752.42, "avg": 54.76, "max": 48.72, "min": 61.03, "cnt": 32}, "fwd-compute":{"total": 1748.96, "avg": 54.65, "max": 48.63, "min": 60.95, "cnt": 32}, "batch-generator":{"total": 44.89, "avg": 1.40, "max": 0.70, "min": 2.67, "cnt": 32}, "fwd-embedding":{"total": 0.67, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1690.36, "avg": 52.82, "max": 47.45, "min": 59.11, "cnt": 32}, "fwd-layernorm":{"total": 10.63, "avg": 0.08, "max": 0.06, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 111.61, "avg": 0.87, "max": 0.75, "min": 3.29, "cnt": 128}, "fwd-misc":{"total": 21.83, "avg": 0.17, "max": 0.12, "min": 0.43, "cnt": 128}, "fwd-MLP":{"total": 1522.92, "avg": 11.90, "max": 9.99, "min": 20.21, "cnt": 128}, "MoE_L0_fwd":{"total": 469.04, "avg": 14.66, "max": 10.83, "min": 20.13, "cnt": 32}, "MoEMLP":{"total": 1505.32, "avg": 11.76, "max": 9.87, "min": 20.09, "cnt": 128}, "MoE_L1_fwd":{"total": 355.69, "avg": 11.12, "max": 9.91, "min": 13.40, "cnt": 32}, "MoE_L2_fwd":{"total": 347.93, "avg": 10.87, "max": 10.36, "min": 11.24, "cnt": 32}, "MoE_L3_fwd":{"total": 339.08, "avg": 10.60, "max": 10.00, "min": 12.03, "cnt": 32}, "fwd-pooler":{"total": 0.36, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.63, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.02, "avg": 1.02, "max": 1.02, "min": 1.02, "cnt": 1}, "forward-send-backward-recv":{"total": 2926.15, "avg": 94.39, "max": 1.68, "min": 716.53, "cnt": 31}, "backward-compute":{"total": 1483.62, "avg": 46.36, "max": 44.88, "min": 49.00, "cnt": 32}, "MoE_L3_bwd":{"total": 392.08, "avg": 12.25, "max": 11.43, "min": 14.08, "cnt": 32}, "MoE_L2_bwd":{"total": 328.38, "avg": 10.26, "max": 9.55, "min": 10.82, "cnt": 32}, "MoE_L1_bwd":{"total": 267.33, "avg": 8.35, "max": 7.80, "min": 9.22, "cnt": 32}, "MoE_L0_bwd":{"total": 279.49, "avg": 8.73, "max": 8.50, "min": 10.03, "cnt": 32}, "backward-send-forward-recv":{"total": 4617.88, "avg": 153.93, "max": 1.80, "min": 776.00, "cnt": 30}, "backward-send":{"total": 1.96, "avg": 0.98, "max": 0.90, "min": 1.05, "cnt": 2}, "backward-recv":{"total": 69.65, "avg": 69.65, "max": 69.65, "min": 69.65, "cnt": 1}, "backward-params-all-reduce":{"total": 490.53, "avg": 490.53, "max": 490.53, "min": 490.53, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "optimizer":{"total": 272.50, "avg": 272.50, "max": 272.50, "min": 272.50, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.41, "avg": 3.41, "max": 3.41, "min": 3.41, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 232.60, "avg": 232.60, "max": 232.60, "min": 232.60, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.27, "avg": 3.27, "max": 3.27, "min": 3.27, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.47, "avg": 3.47, "max": 3.47, "min": 3.47, "cnt": 1}}}
{"type":"time", "iteration": 132, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.10, "avg": 0.10, "max": 0.10, "min": 0.10, "cnt": 1}, "forward-recv":{"total": 128.30, "avg": 64.15, "max": 0.99, "min": 127.31, "cnt": 2}, "forward-compute":{"total": 1831.94, "avg": 57.25, "max": 50.33, "min": 66.43, "cnt": 32}, "fwd-compute":{"total": 1828.33, "avg": 57.14, "max": 50.19, "min": 66.34, "cnt": 32}, "batch-generator":{"total": 45.49, "avg": 1.42, "max": 0.69, "min": 2.52, "cnt": 32}, "fwd-embedding":{"total": 0.69, "avg": 0.02, "max": 0.01, "min": 0.06, "cnt": 32}, "fwd-encoder":{"total": 1767.47, "avg": 55.23, "max": 48.62, "min": 65.03, "cnt": 32}, "fwd-layernorm":{"total": 11.51, "avg": 0.09, "max": 0.06, "min": 0.24, "cnt": 128}, "fwd-attn":{"total": 114.84, "avg": 0.90, "max": 0.75, "min": 1.77, "cnt": 128}, "fwd-misc":{"total": 23.44, "avg": 0.18, "max": 0.12, "min": 0.42, "cnt": 128}, "fwd-MLP":{"total": 1592.03, "avg": 12.44, "max": 9.99, "min": 19.94, "cnt": 128}, "MoE_L0_fwd":{"total": 497.72, "avg": 15.55, "max": 11.43, "min": 19.83, "cnt": 32}, "MoEMLP":{"total": 1572.78, "avg": 12.29, "max": 9.83, "min": 19.77, "cnt": 128}, "MoE_L1_fwd":{"total": 367.65, "avg": 11.49, "max": 9.89, "min": 14.21, "cnt": 32}, "MoE_L2_fwd":{"total": 360.62, "avg": 11.27, "max": 10.72, "min": 14.88, "cnt": 32}, "MoE_L3_fwd":{"total": 353.83, "avg": 11.06, "max": 10.21, "min": 11.78, "cnt": 32}, "fwd-pooler":{"total": 0.40, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.65, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.09, "avg": 1.09, "max": 1.09, "min": 1.09, "cnt": 1}, "forward-send-backward-recv":{"total": 2665.32, "avg": 85.98, "max": 1.43, "min": 848.33, "cnt": 31}, "backward-compute":{"total": 1471.25, "avg": 45.98, "max": 44.02, "min": 47.73, "cnt": 32}, "MoE_L3_bwd":{"total": 370.52, "avg": 11.58, "max": 9.75, "min": 12.68, "cnt": 32}, "MoE_L2_bwd":{"total": 331.38, "avg": 10.36, "max": 9.18, "min": 11.61, "cnt": 32}, "MoE_L1_bwd":{"total": 267.94, "avg": 8.37, "max": 7.93, "min": 8.90, "cnt": 32}, "MoE_L0_bwd":{"total": 283.33, "avg": 8.85, "max": 8.32, "min": 10.29, "cnt": 32}, "backward-send-forward-recv":{"total": 6587.04, "avg": 219.57, "max": 1.61, "min": 1862.43, "cnt": 30}, "backward-send":{"total": 2.07, "avg": 1.04, "max": 0.85, "min": 1.23, "cnt": 2}, "backward-recv":{"total": 303.13, "avg": 303.13, "max": 303.13, "min": 303.13, "cnt": 1}, "backward-params-all-reduce":{"total": 488.66, "avg": 488.66, "max": 488.66, "min": 488.66, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 278.51, "avg": 278.51, "max": 278.51, "min": 278.51, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.40, "avg": 3.40, "max": 3.40, "min": 3.40, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 238.21, "avg": 238.21, "max": 238.21, "min": 238.21, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.75, "avg": 3.75, "max": 3.75, "min": 3.75, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.47, "avg": 3.47, "max": 3.47, "min": 3.47, "cnt": 1}}}
{"type":"time", "iteration": 133, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.10, "avg": 0.10, "max": 0.10, "min": 0.10, "cnt": 1}, "forward-recv":{"total": 600.69, "avg": 300.34, "max": 251.07, "min": 349.62, "cnt": 2}, "forward-compute":{"total": 1837.76, "avg": 57.43, "max": 50.81, "min": 72.76, "cnt": 32}, "fwd-compute":{"total": 1834.26, "avg": 57.32, "max": 50.73, "min": 72.62, "cnt": 32}, "batch-generator":{"total": 46.16, "avg": 1.44, "max": 0.82, "min": 2.85, "cnt": 32}, "fwd-embedding":{"total": 0.65, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1774.18, "avg": 55.44, "max": 49.18, "min": 70.40, "cnt": 32}, "fwd-layernorm":{"total": 11.06, "avg": 0.09, "max": 0.06, "min": 0.23, "cnt": 128}, "fwd-attn":{"total": 112.85, "avg": 0.88, "max": 0.75, "min": 1.64, "cnt": 128}, "fwd-misc":{"total": 22.50, "avg": 0.18, "max": 0.12, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1603.78, "avg": 12.53, "max": 10.15, "min": 23.09, "cnt": 128}, "MoE_L0_fwd":{"total": 502.68, "avg": 15.71, "max": 12.36, "min": 23.01, "cnt": 32}, "MoEMLP":{"total": 1583.69, "avg": 12.37, "max": 10.02, "min": 22.96, "cnt": 128}, "MoE_L1_fwd":{"total": 376.63, "avg": 11.77, "max": 10.07, "min": 22.03, "cnt": 32}, "MoE_L2_fwd":{"total": 363.37, "avg": 11.36, "max": 10.72, "min": 15.66, "cnt": 32}, "MoE_L3_fwd":{"total": 349.31, "avg": 10.92, "max": 10.36, "min": 11.81, "cnt": 32}, "fwd-pooler":{"total": 0.37, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.64, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 0.86, "avg": 0.86, "max": 0.86, "min": 0.86, "cnt": 1}, "forward-send-backward-recv":{"total": 2354.35, "avg": 75.95, "max": 1.44, "min": 481.25, "cnt": 31}, "backward-compute":{"total": 1473.93, "avg": 46.06, "max": 43.60, "min": 50.25, "cnt": 32}, "MoE_L3_bwd":{"total": 371.63, "avg": 11.61, "max": 10.36, "min": 12.79, "cnt": 32}, "MoE_L2_bwd":{"total": 335.50, "avg": 10.48, "max": 9.57, "min": 13.77, "cnt": 32}, "MoE_L1_bwd":{"total": 265.13, "avg": 8.29, "max": 7.73, "min": 9.02, "cnt": 32}, "MoE_L0_bwd":{"total": 277.34, "avg": 8.67, "max": 8.21, "min": 9.96, "cnt": 32}, "backward-send-forward-recv":{"total": 6388.41, "avg": 212.95, "max": 2.00, "min": 1653.85, "cnt": 30}, "backward-send":{"total": 2.04, "avg": 1.02, "max": 0.94, "min": 1.11, "cnt": 2}, "backward-recv":{"total": 81.08, "avg": 81.08, "max": 81.08, "min": 81.08, "cnt": 1}, "backward-params-all-reduce":{"total": 487.87, "avg": 487.87, "max": 487.87, "min": 487.87, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 286.80, "avg": 286.80, "max": 286.80, "min": 286.80, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 239.14, "avg": 239.14, "max": 239.14, "min": 239.14, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.08, "avg": 6.08, "max": 6.08, "min": 6.08, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.53, "avg": 3.53, "max": 3.53, "min": 3.53, "cnt": 1}}}
{"type":"time", "iteration": 134, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 118.39, "avg": 59.19, "max": 1.37, "min": 117.02, "cnt": 2}, "forward-compute":{"total": 1796.45, "avg": 56.14, "max": 49.25, "min": 63.28, "cnt": 32}, "fwd-compute":{"total": 1792.83, "avg": 56.03, "max": 49.15, "min": 63.15, "cnt": 32}, "batch-generator":{"total": 47.52, "avg": 1.49, "max": 0.79, "min": 1.85, "cnt": 32}, "fwd-embedding":{"total": 0.76, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1730.55, "avg": 54.08, "max": 47.90, "min": 60.91, "cnt": 32}, "fwd-layernorm":{"total": 11.53, "avg": 0.09, "max": 0.06, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 115.01, "avg": 0.90, "max": 0.75, "min": 1.50, "cnt": 128}, "fwd-misc":{"total": 24.07, "avg": 0.19, "max": 0.12, "min": 0.42, "cnt": 128}, "fwd-MLP":{"total": 1554.83, "avg": 12.15, "max": 10.31, "min": 18.09, "cnt": 128}, "MoE_L0_fwd":{"total": 456.65, "avg": 14.27, "max": 10.76, "min": 17.95, "cnt": 32}, "MoEMLP":{"total": 1535.33, "avg": 11.99, "max": 10.19, "min": 17.88, "cnt": 128}, "MoE_L1_fwd":{"total": 366.77, "avg": 11.46, "max": 10.23, "min": 14.62, "cnt": 32}, "MoE_L2_fwd":{"total": 359.46, "avg": 11.23, "max": 10.48, "min": 13.33, "cnt": 32}, "MoE_L3_fwd":{"total": 359.42, "avg": 11.23, "max": 10.42, "min": 13.23, "cnt": 32}, "fwd-pooler":{"total": 0.38, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.62, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 0.99, "avg": 0.99, "max": 0.99, "min": 0.99, "cnt": 1}, "forward-send-backward-recv":{"total": 761.79, "avg": 24.57, "max": 1.11, "min": 159.42, "cnt": 31}, "backward-compute":{"total": 1448.73, "avg": 45.27, "max": 43.13, "min": 49.84, "cnt": 32}, "MoE_L3_bwd":{"total": 356.25, "avg": 11.13, "max": 10.02, "min": 12.69, "cnt": 32}, "MoE_L2_bwd":{"total": 321.29, "avg": 10.04, "max": 9.18, "min": 12.26, "cnt": 32}, "MoE_L1_bwd":{"total": 269.14, "avg": 8.41, "max": 7.73, "min": 10.24, "cnt": 32}, "MoE_L0_bwd":{"total": 276.51, "avg": 8.64, "max": 8.16, "min": 10.04, "cnt": 32}, "backward-send-forward-recv":{"total": 925.68, "avg": 30.86, "max": 2.30, "min": 175.80, "cnt": 30}, "backward-send":{"total": 2.04, "avg": 1.02, "max": 0.96, "min": 1.08, "cnt": 2}, "backward-recv":{"total": 209.50, "avg": 209.50, "max": 209.50, "min": 209.50, "cnt": 1}, "backward-params-all-reduce":{"total": 488.60, "avg": 488.60, "max": 488.60, "min": 488.60, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 275.41, "avg": 275.41, "max": 275.41, "min": 275.41, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 235.57, "avg": 235.57, "max": 235.57, "min": 235.57, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.28, "avg": 3.28, "max": 3.28, "min": 3.28, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.48, "avg": 3.48, "max": 3.48, "min": 3.48, "cnt": 1}}}
{"type":"time", "iteration": 135, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 128.41, "avg": 64.21, "max": 0.97, "min": 127.44, "cnt": 2}, "forward-compute":{"total": 1836.49, "avg": 57.39, "max": 51.81, "min": 66.58, "cnt": 32}, "fwd-compute":{"total": 1833.01, "avg": 57.28, "max": 51.72, "min": 66.49, "cnt": 32}, "batch-generator":{"total": 47.96, "avg": 1.50, "max": 0.75, "min": 3.08, "cnt": 32}, "fwd-embedding":{"total": 0.83, "avg": 0.03, "max": 0.01, "min": 0.16, "cnt": 32}, "fwd-encoder":{"total": 1770.15, "avg": 55.32, "max": 50.47, "min": 65.21, "cnt": 32}, "fwd-layernorm":{"total": 11.10, "avg": 0.09, "max": 0.06, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 113.28, "avg": 0.88, "max": 0.75, "min": 1.86, "cnt": 128}, "fwd-misc":{"total": 23.44, "avg": 0.18, "max": 0.13, "min": 0.40, "cnt": 128}, "fwd-MLP":{"total": 1597.50, "avg": 12.48, "max": 10.38, "min": 18.32, "cnt": 128}, "MoE_L0_fwd":{"total": 477.80, "avg": 14.93, "max": 11.72, "min": 18.23, "cnt": 32}, "MoEMLP":{"total": 1578.93, "avg": 12.34, "max": 10.25, "min": 18.18, "cnt": 128}, "MoE_L1_fwd":{"total": 374.59, "avg": 11.71, "max": 10.30, "min": 15.15, "cnt": 32}, "MoE_L2_fwd":{"total": 367.20, "avg": 11.47, "max": 10.60, "min": 16.29, "cnt": 32}, "MoE_L3_fwd":{"total": 366.14, "avg": 11.44, "max": 10.36, "min": 14.10, "cnt": 32}, "fwd-pooler":{"total": 0.37, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.63, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 0.83, "avg": 0.83, "max": 0.83, "min": 0.83, "cnt": 1}, "forward-send-backward-recv":{"total": 491.38, "avg": 15.85, "max": 1.32, "min": 164.37, "cnt": 31}, "backward-compute":{"total": 1458.58, "avg": 45.58, "max": 43.08, "min": 48.46, "cnt": 32}, "MoE_L3_bwd":{"total": 358.76, "avg": 11.21, "max": 9.95, "min": 12.27, "cnt": 32}, "MoE_L2_bwd":{"total": 331.10, "avg": 10.35, "max": 9.52, "min": 14.20, "cnt": 32}, "MoE_L1_bwd":{"total": 268.65, "avg": 8.40, "max": 7.94, "min": 8.93, "cnt": 32}, "MoE_L0_bwd":{"total": 279.24, "avg": 8.73, "max": 8.26, "min": 10.60, "cnt": 32}, "backward-send-forward-recv":{"total": 2269.49, "avg": 75.65, "max": 2.24, "min": 468.32, "cnt": 30}, "backward-send":{"total": 2.05, "avg": 1.03, "max": 0.94, "min": 1.11, "cnt": 2}, "backward-recv":{"total": 79.86, "avg": 79.86, "max": 79.86, "min": 79.86, "cnt": 1}, "backward-params-all-reduce":{"total": 494.38, "avg": 494.38, "max": 494.38, "min": 494.38, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 276.75, "avg": 276.75, "max": 276.75, "min": 276.75, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 230.23, "avg": 230.23, "max": 230.23, "min": 230.23, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.33, "avg": 3.33, "max": 3.33, "min": 3.33, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.47, "avg": 3.47, "max": 3.47, "min": 3.47, "cnt": 1}}}
{"type":"time", "iteration": 136, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.10, "avg": 0.10, "max": 0.10, "min": 0.10, "cnt": 1}, "forward-recv":{"total": 114.64, "avg": 57.32, "max": 1.71, "min": 112.94, "cnt": 2}, "forward-compute":{"total": 1884.76, "avg": 58.90, "max": 50.81, "min": 125.26, "cnt": 32}, "fwd-compute":{"total": 1881.37, "avg": 58.79, "max": 50.73, "min": 125.18, "cnt": 32}, "batch-generator":{"total": 40.89, "avg": 1.28, "max": 0.70, "min": 1.80, "cnt": 32}, "fwd-embedding":{"total": 0.62, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1826.70, "avg": 57.08, "max": 49.48, "min": 123.36, "cnt": 32}, "fwd-layernorm":{"total": 10.28, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 107.60, "avg": 0.84, "max": 0.75, "min": 1.51, "cnt": 128}, "fwd-misc":{"total": 21.97, "avg": 0.17, "max": 0.12, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1663.44, "avg": 13.00, "max": 10.25, "min": 83.21, "cnt": 128}, "MoE_L0_fwd":{"total": 483.20, "avg": 15.10, "max": 11.44, "min": 26.99, "cnt": 32}, "MoEMLP":{"total": 1645.16, "avg": 12.85, "max": 10.07, "min": 83.06, "cnt": 128}, "MoE_L1_fwd":{"total": 369.53, "avg": 11.55, "max": 10.12, "min": 15.29, "cnt": 32}, "MoE_L2_fwd":{"total": 436.06, "avg": 13.63, "max": 10.50, "min": 83.12, "cnt": 32}, "MoE_L3_fwd":{"total": 362.87, "avg": 11.34, "max": 10.41, "min": 12.89, "cnt": 32}, "fwd-pooler":{"total": 0.39, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.64, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.22, "avg": 1.22, "max": 1.22, "min": 1.22, "cnt": 1}, "forward-send-backward-recv":{"total": 191.61, "avg": 6.18, "max": 1.27, "min": 50.17, "cnt": 31}, "backward-compute":{"total": 1455.56, "avg": 45.49, "max": 43.22, "min": 47.71, "cnt": 32}, "MoE_L3_bwd":{"total": 371.17, "avg": 11.60, "max": 10.28, "min": 14.10, "cnt": 32}, "MoE_L2_bwd":{"total": 323.64, "avg": 10.11, "max": 9.35, "min": 11.01, "cnt": 32}, "MoE_L1_bwd":{"total": 272.07, "avg": 8.50, "max": 7.98, "min": 10.68, "cnt": 32}, "MoE_L0_bwd":{"total": 272.99, "avg": 8.53, "max": 7.96, "min": 8.91, "cnt": 32}, "backward-send-forward-recv":{"total": 3184.92, "avg": 106.16, "max": 2.23, "min": 731.11, "cnt": 30}, "backward-send":{"total": 2.06, "avg": 1.03, "max": 0.99, "min": 1.07, "cnt": 2}, "backward-recv":{"total": 69.80, "avg": 69.80, "max": 69.80, "min": 69.80, "cnt": 1}, "backward-params-all-reduce":{"total": 493.14, "avg": 493.14, "max": 493.14, "min": 493.14, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.06, "avg": 0.06, "max": 0.06, "min": 0.06, "cnt": 1}, "optimizer":{"total": 278.99, "avg": 278.99, "max": 278.99, "min": 278.99, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 238.99, "avg": 238.99, "max": 238.99, "min": 238.99, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.32, "avg": 3.32, "max": 3.32, "min": 3.32, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.49, "avg": 3.49, "max": 3.49, "min": 3.49, "cnt": 1}}}
{"type":"time", "iteration": 137, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 133.36, "avg": 66.68, "max": 1.26, "min": 132.10, "cnt": 2}, "forward-compute":{"total": 1916.87, "avg": 59.90, "max": 51.94, "min": 102.74, "cnt": 32}, "fwd-compute":{"total": 1912.74, "avg": 59.77, "max": 51.87, "min": 102.59, "cnt": 32}, "batch-generator":{"total": 52.63, "avg": 1.64, "max": 0.72, "min": 2.12, "cnt": 32}, "fwd-embedding":{"total": 0.91, "avg": 0.03, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1844.26, "avg": 57.63, "max": 50.77, "min": 99.93, "cnt": 32}, "fwd-layernorm":{"total": 13.14, "avg": 0.10, "max": 0.06, "min": 0.22, "cnt": 128}, "fwd-attn":{"total": 126.99, "avg": 0.99, "max": 0.75, "min": 1.87, "cnt": 128}, "fwd-misc":{"total": 26.65, "avg": 0.21, "max": 0.12, "min": 0.46, "cnt": 128}, "fwd-MLP":{"total": 1649.76, "avg": 12.89, "max": 10.36, "min": 56.52, "cnt": 128}, "MoE_L0_fwd":{"total": 516.94, "avg": 16.15, "max": 11.56, "min": 56.37, "cnt": 32}, "MoEMLP":{"total": 1627.94, "avg": 12.72, "max": 10.24, "min": 56.27, "cnt": 128}, "MoE_L1_fwd":{"total": 367.35, "avg": 11.48, "max": 10.29, "min": 14.81, "cnt": 32}, "MoE_L2_fwd":{"total": 377.75, "avg": 11.80, "max": 10.63, "min": 15.24, "cnt": 32}, "MoE_L3_fwd":{"total": 373.66, "avg": 11.68, "max": 10.79, "min": 15.57, "cnt": 32}, "fwd-pooler":{"total": 0.40, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.69, "avg": 0.02, "max": 0.02, "min": 0.04, "cnt": 32}, "forward-send":{"total": 0.93, "avg": 0.93, "max": 0.93, "min": 0.93, "cnt": 1}, "forward-send-backward-recv":{"total": 2232.89, "avg": 72.03, "max": 1.64, "min": 543.04, "cnt": 31}, "backward-compute":{"total": 1433.66, "avg": 44.80, "max": 43.32, "min": 45.95, "cnt": 32}, "MoE_L3_bwd":{"total": 346.78, "avg": 10.84, "max": 9.81, "min": 11.70, "cnt": 32}, "MoE_L2_bwd":{"total": 328.43, "avg": 10.26, "max": 9.58, "min": 11.29, "cnt": 32}, "MoE_L1_bwd":{"total": 265.61, "avg": 8.30, "max": 7.76, "min": 9.01, "cnt": 32}, "MoE_L0_bwd":{"total": 277.24, "avg": 8.66, "max": 8.24, "min": 9.77, "cnt": 32}, "backward-send-forward-recv":{"total": 287.75, "avg": 9.59, "max": 1.72, "min": 90.50, "cnt": 30}, "backward-send":{"total": 1.77, "avg": 0.89, "max": 0.79, "min": 0.98, "cnt": 2}, "backward-recv":{"total": 76.42, "avg": 76.42, "max": 76.42, "min": 76.42, "cnt": 1}, "backward-params-all-reduce":{"total": 489.94, "avg": 489.94, "max": 489.94, "min": 489.94, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 280.94, "avg": 280.94, "max": 280.94, "min": 280.94, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 232.78, "avg": 232.78, "max": 232.78, "min": 232.78, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.67, "avg": 6.67, "max": 6.67, "min": 6.67, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.49, "avg": 3.49, "max": 3.49, "min": 3.49, "cnt": 1}}}
{"type":"time", "iteration": 138, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 122.80, "avg": 61.40, "max": 1.57, "min": 121.23, "cnt": 2}, "forward-compute":{"total": 1802.61, "avg": 56.33, "max": 49.88, "min": 67.14, "cnt": 32}, "fwd-compute":{"total": 1798.98, "avg": 56.22, "max": 49.80, "min": 67.06, "cnt": 32}, "batch-generator":{"total": 44.49, "avg": 1.39, "max": 0.75, "min": 2.18, "cnt": 32}, "fwd-embedding":{"total": 0.66, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1740.34, "avg": 54.39, "max": 48.69, "min": 65.04, "cnt": 32}, "fwd-layernorm":{"total": 10.71, "avg": 0.08, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 112.32, "avg": 0.88, "max": 0.75, "min": 1.53, "cnt": 128}, "fwd-misc":{"total": 23.15, "avg": 0.18, "max": 0.12, "min": 0.38, "cnt": 128}, "fwd-MLP":{"total": 1569.93, "avg": 12.27, "max": 10.43, "min": 20.47, "cnt": 128}, "MoE_L0_fwd":{"total": 456.16, "avg": 14.25, "max": 10.59, "min": 20.38, "cnt": 32}, "MoEMLP":{"total": 1551.11, "avg": 12.12, "max": 10.31, "min": 20.33, "cnt": 128}, "MoE_L1_fwd":{"total": 364.78, "avg": 11.40, "max": 10.35, "min": 15.23, "cnt": 32}, "MoE_L2_fwd":{"total": 366.25, "avg": 11.45, "max": 10.67, "min": 13.81, "cnt": 32}, "MoE_L3_fwd":{"total": 370.72, "avg": 11.58, "max": 10.76, "min": 15.93, "cnt": 32}, "fwd-pooler":{"total": 0.39, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.67, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.03, "avg": 1.03, "max": 1.03, "min": 1.03, "cnt": 1}, "forward-send-backward-recv":{"total": 260.83, "avg": 8.41, "max": 1.57, "min": 63.53, "cnt": 31}, "backward-compute":{"total": 1460.56, "avg": 45.64, "max": 42.86, "min": 47.69, "cnt": 32}, "MoE_L3_bwd":{"total": 367.49, "avg": 11.48, "max": 10.04, "min": 12.88, "cnt": 32}, "MoE_L2_bwd":{"total": 333.66, "avg": 10.43, "max": 9.98, "min": 12.61, "cnt": 32}, "MoE_L1_bwd":{"total": 269.87, "avg": 8.43, "max": 7.99, "min": 8.96, "cnt": 32}, "MoE_L0_bwd":{"total": 271.36, "avg": 8.48, "max": 7.99, "min": 9.41, "cnt": 32}, "backward-send-forward-recv":{"total": 2053.39, "avg": 68.45, "max": 2.20, "min": 275.72, "cnt": 30}, "backward-send":{"total": 2.00, "avg": 1.00, "max": 0.87, "min": 1.14, "cnt": 2}, "backward-recv":{"total": 70.49, "avg": 70.49, "max": 70.49, "min": 70.49, "cnt": 1}, "backward-params-all-reduce":{"total": 493.74, "avg": 493.74, "max": 493.74, "min": 493.74, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 275.95, "avg": 275.95, "max": 275.95, "min": 275.95, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 236.12, "avg": 236.12, "max": 236.12, "min": 236.12, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 139, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 124.07, "avg": 62.03, "max": 6.29, "min": 117.78, "cnt": 2}, "forward-compute":{"total": 1820.28, "avg": 56.88, "max": 50.00, "min": 66.59, "cnt": 32}, "fwd-compute":{"total": 1816.54, "avg": 56.77, "max": 49.92, "min": 66.46, "cnt": 32}, "batch-generator":{"total": 53.80, "avg": 1.68, "max": 0.74, "min": 3.40, "cnt": 32}, "fwd-embedding":{"total": 0.78, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1748.25, "avg": 54.63, "max": 48.69, "min": 64.20, "cnt": 32}, "fwd-layernorm":{"total": 11.67, "avg": 0.09, "max": 0.06, "min": 0.24, "cnt": 128}, "fwd-attn":{"total": 118.00, "avg": 0.92, "max": 0.75, "min": 1.83, "cnt": 128}, "fwd-misc":{"total": 24.22, "avg": 0.19, "max": 0.12, "min": 0.46, "cnt": 128}, "fwd-MLP":{"total": 1568.40, "avg": 12.25, "max": 10.51, "min": 17.90, "cnt": 128}, "MoE_L0_fwd":{"total": 441.28, "avg": 13.79, "max": 10.59, "min": 16.92, "cnt": 32}, "MoEMLP":{"total": 1546.63, "avg": 12.08, "max": 10.39, "min": 17.77, "cnt": 128}, "MoE_L1_fwd":{"total": 365.53, "avg": 11.42, "max": 10.44, "min": 13.18, "cnt": 32}, "MoE_L2_fwd":{"total": 377.21, "avg": 11.79, "max": 10.54, "min": 17.82, "cnt": 32}, "MoE_L3_fwd":{"total": 369.79, "avg": 11.56, "max": 10.66, "min": 12.46, "cnt": 32}, "fwd-pooler":{"total": 0.38, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.64, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 0.91, "avg": 0.91, "max": 0.91, "min": 0.91, "cnt": 1}, "forward-send-backward-recv":{"total": 2156.21, "avg": 69.56, "max": 1.63, "min": 330.35, "cnt": 31}, "backward-compute":{"total": 1463.53, "avg": 45.74, "max": 44.24, "min": 48.23, "cnt": 32}, "MoE_L3_bwd":{"total": 373.67, "avg": 11.68, "max": 11.00, "min": 14.38, "cnt": 32}, "MoE_L2_bwd":{"total": 334.48, "avg": 10.45, "max": 9.74, "min": 11.50, "cnt": 32}, "MoE_L1_bwd":{"total": 270.51, "avg": 8.45, "max": 7.78, "min": 8.94, "cnt": 32}, "MoE_L0_bwd":{"total": 265.79, "avg": 8.31, "max": 7.76, "min": 9.08, "cnt": 32}, "backward-send-forward-recv":{"total": 2792.43, "avg": 93.08, "max": 2.18, "min": 696.47, "cnt": 30}, "backward-send":{"total": 2.04, "avg": 1.02, "max": 0.92, "min": 1.12, "cnt": 2}, "backward-recv":{"total": 198.25, "avg": 198.25, "max": 198.25, "min": 198.25, "cnt": 1}, "backward-params-all-reduce":{"total": 488.67, "avg": 488.67, "max": 488.67, "min": 488.67, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 277.13, "avg": 277.13, "max": 277.13, "min": 277.13, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 237.09, "avg": 237.09, "max": 237.09, "min": 237.09, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.59, "avg": 3.59, "max": 3.59, "min": 3.59, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 140, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 134.11, "avg": 67.06, "max": 1.36, "min": 132.75, "cnt": 2}, "forward-compute":{"total": 1827.43, "avg": 57.11, "max": 50.92, "min": 68.67, "cnt": 32}, "fwd-compute":{"total": 1823.92, "avg": 57.00, "max": 50.81, "min": 68.58, "cnt": 32}, "batch-generator":{"total": 43.64, "avg": 1.36, "max": 0.73, "min": 2.44, "cnt": 32}, "fwd-embedding":{"total": 0.71, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1765.89, "avg": 55.18, "max": 49.36, "min": 65.73, "cnt": 32}, "fwd-layernorm":{"total": 11.12, "avg": 0.09, "max": 0.06, "min": 0.23, "cnt": 128}, "fwd-attn":{"total": 112.59, "avg": 0.88, "max": 0.75, "min": 1.80, "cnt": 128}, "fwd-misc":{"total": 23.27, "avg": 0.18, "max": 0.12, "min": 0.43, "cnt": 128}, "fwd-MLP":{"total": 1594.33, "avg": 12.46, "max": 10.31, "min": 22.82, "cnt": 128}, "MoE_L0_fwd":{"total": 466.37, "avg": 14.57, "max": 10.74, "min": 22.66, "cnt": 32}, "MoEMLP":{"total": 1575.19, "avg": 12.31, "max": 10.18, "min": 22.56, "cnt": 128}, "MoE_L1_fwd":{"total": 364.90, "avg": 11.40, "max": 10.23, "min": 15.15, "cnt": 32}, "MoE_L2_fwd":{"total": 377.91, "avg": 11.81, "max": 10.98, "min": 15.03, "cnt": 32}, "MoE_L3_fwd":{"total": 372.88, "avg": 11.65, "max": 10.64, "min": 12.83, "cnt": 32}, "fwd-pooler":{"total": 0.38, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.65, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 0.87, "avg": 0.87, "max": 0.87, "min": 0.87, "cnt": 1}, "forward-send-backward-recv":{"total": 1065.15, "avg": 34.36, "max": 1.53, "min": 375.64, "cnt": 31}, "backward-compute":{"total": 1475.10, "avg": 46.10, "max": 43.93, "min": 47.83, "cnt": 32}, "MoE_L3_bwd":{"total": 368.44, "avg": 11.51, "max": 10.58, "min": 12.77, "cnt": 32}, "MoE_L2_bwd":{"total": 339.43, "avg": 10.61, "max": 9.67, "min": 12.37, "cnt": 32}, "MoE_L1_bwd":{"total": 276.59, "avg": 8.64, "max": 8.19, "min": 10.63, "cnt": 32}, "MoE_L0_bwd":{"total": 271.75, "avg": 8.49, "max": 8.17, "min": 8.87, "cnt": 32}, "backward-send-forward-recv":{"total": 2095.60, "avg": 69.85, "max": 1.71, "min": 255.59, "cnt": 30}, "backward-send":{"total": 1.76, "avg": 0.88, "max": 0.82, "min": 0.95, "cnt": 2}, "backward-recv":{"total": 71.84, "avg": 71.84, "max": 71.84, "min": 71.84, "cnt": 1}, "backward-params-all-reduce":{"total": 492.55, "avg": 492.55, "max": 492.55, "min": 492.55, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 277.39, "avg": 277.39, "max": 277.39, "min": 277.39, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 237.61, "avg": 237.61, "max": 237.61, "min": 237.61, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.47, "avg": 3.47, "max": 3.47, "min": 3.47, "cnt": 1}}}
{"type":"time", "iteration": 141, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 118.81, "avg": 59.41, "max": 1.37, "min": 117.44, "cnt": 2}, "forward-compute":{"total": 1906.32, "avg": 59.57, "max": 50.75, "min": 66.60, "cnt": 32}, "fwd-compute":{"total": 1902.63, "avg": 59.46, "max": 50.65, "min": 66.52, "cnt": 32}, "batch-generator":{"total": 44.90, "avg": 1.40, "max": 0.78, "min": 1.82, "cnt": 32}, "fwd-embedding":{"total": 0.78, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1842.73, "avg": 57.59, "max": 49.50, "min": 65.27, "cnt": 32}, "fwd-layernorm":{"total": 11.40, "avg": 0.09, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 114.60, "avg": 0.90, "max": 0.75, "min": 1.50, "cnt": 128}, "fwd-misc":{"total": 23.68, "avg": 0.19, "max": 0.12, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1667.73, "avg": 13.03, "max": 10.41, "min": 18.60, "cnt": 128}, "MoE_L0_fwd":{"total": 492.76, "avg": 15.40, "max": 11.27, "min": 18.50, "cnt": 32}, "MoEMLP":{"total": 1648.54, "avg": 12.88, "max": 10.28, "min": 18.43, "cnt": 128}, "MoE_L1_fwd":{"total": 389.92, "avg": 12.18, "max": 10.33, "min": 15.78, "cnt": 32}, "MoE_L2_fwd":{"total": 398.98, "avg": 12.47, "max": 11.15, "min": 16.68, "cnt": 32}, "MoE_L3_fwd":{"total": 373.79, "avg": 11.68, "max": 10.74, "min": 14.19, "cnt": 32}, "fwd-pooler":{"total": 0.37, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.63, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 0.90, "avg": 0.90, "max": 0.90, "min": 0.90, "cnt": 1}, "forward-send-backward-recv":{"total": 947.11, "avg": 30.55, "max": 1.24, "min": 233.01, "cnt": 31}, "backward-compute":{"total": 1488.62, "avg": 46.52, "max": 44.64, "min": 48.96, "cnt": 32}, "MoE_L3_bwd":{"total": 375.66, "avg": 11.74, "max": 11.12, "min": 12.70, "cnt": 32}, "MoE_L2_bwd":{"total": 340.55, "avg": 10.64, "max": 9.85, "min": 13.33, "cnt": 32}, "MoE_L1_bwd":{"total": 275.27, "avg": 8.60, "max": 8.33, "min": 9.07, "cnt": 32}, "MoE_L0_bwd":{"total": 272.56, "avg": 8.52, "max": 8.06, "min": 9.92, "cnt": 32}, "backward-send-forward-recv":{"total": 938.12, "avg": 31.27, "max": 1.85, "min": 437.48, "cnt": 30}, "backward-send":{"total": 2.11, "avg": 1.06, "max": 0.97, "min": 1.14, "cnt": 2}, "backward-recv":{"total": 72.29, "avg": 72.29, "max": 72.29, "min": 72.29, "cnt": 1}, "backward-params-all-reduce":{"total": 489.25, "avg": 489.25, "max": 489.25, "min": 489.25, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 278.01, "avg": 278.01, "max": 278.01, "min": 278.01, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 238.25, "avg": 238.25, "max": 238.25, "min": 238.25, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.31, "avg": 3.31, "max": 3.31, "min": 3.31, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.48, "avg": 3.48, "max": 3.48, "min": 3.48, "cnt": 1}}}
{"type":"time", "iteration": 142, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 1464.54, "avg": 732.27, "max": 10.34, "min": 1454.20, "cnt": 2}, "forward-compute":{"total": 1844.67, "avg": 57.65, "max": 49.00, "min": 62.35, "cnt": 32}, "fwd-compute":{"total": 1840.94, "avg": 57.53, "max": 48.92, "min": 62.23, "cnt": 32}, "batch-generator":{"total": 46.10, "avg": 1.44, "max": 0.85, "min": 2.52, "cnt": 32}, "fwd-embedding":{"total": 0.70, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1780.32, "avg": 55.64, "max": 47.66, "min": 60.29, "cnt": 32}, "fwd-layernorm":{"total": 11.30, "avg": 0.09, "max": 0.06, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 113.96, "avg": 0.89, "max": 0.75, "min": 1.88, "cnt": 128}, "fwd-misc":{"total": 23.76, "avg": 0.19, "max": 0.12, "min": 0.38, "cnt": 128}, "fwd-MLP":{"total": 1605.59, "avg": 12.54, "max": 10.36, "min": 19.66, "cnt": 128}, "MoE_L0_fwd":{"total": 469.07, "avg": 14.66, "max": 10.34, "min": 19.53, "cnt": 32}, "MoEMLP":{"total": 1586.15, "avg": 12.39, "max": 10.22, "min": 19.46, "cnt": 128}, "MoE_L1_fwd":{"total": 364.53, "avg": 11.39, "max": 10.27, "min": 13.21, "cnt": 32}, "MoE_L2_fwd":{"total": 385.18, "avg": 12.04, "max": 11.12, "min": 16.69, "cnt": 32}, "MoE_L3_fwd":{"total": 374.49, "avg": 11.70, "max": 10.76, "min": 16.36, "cnt": 32}, "fwd-pooler":{"total": 0.39, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.63, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.70, "avg": 1.70, "max": 1.70, "min": 1.70, "cnt": 1}, "forward-send-backward-recv":{"total": 267.43, "avg": 8.63, "max": 1.28, "min": 56.56, "cnt": 31}, "backward-compute":{"total": 1498.32, "avg": 46.82, "max": 43.70, "min": 48.60, "cnt": 32}, "MoE_L3_bwd":{"total": 380.36, "avg": 11.89, "max": 10.76, "min": 13.39, "cnt": 32}, "MoE_L2_bwd":{"total": 337.80, "avg": 10.56, "max": 9.88, "min": 11.32, "cnt": 32}, "MoE_L1_bwd":{"total": 280.00, "avg": 8.75, "max": 8.25, "min": 11.67, "cnt": 32}, "MoE_L0_bwd":{"total": 270.75, "avg": 8.46, "max": 8.02, "min": 8.88, "cnt": 32}, "backward-send-forward-recv":{"total": 3182.05, "avg": 106.07, "max": 2.32, "min": 566.22, "cnt": 30}, "backward-send":{"total": 2.05, "avg": 1.03, "max": 0.92, "min": 1.14, "cnt": 2}, "backward-recv":{"total": 77.51, "avg": 77.51, "max": 77.51, "min": 77.51, "cnt": 1}, "backward-params-all-reduce":{"total": 493.93, "avg": 493.93, "max": 493.93, "min": 493.93, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 268.17, "avg": 268.17, "max": 268.17, "min": 268.17, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 228.14, "avg": 228.14, "max": 228.14, "min": 228.14, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.35, "avg": 3.35, "max": 3.35, "min": 3.35, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.52, "avg": 3.52, "max": 3.52, "min": 3.52, "cnt": 1}}}
{"type":"time", "iteration": 143, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 140.17, "avg": 70.08, "max": 8.38, "min": 131.78, "cnt": 2}, "forward-compute":{"total": 1869.13, "avg": 58.41, "max": 51.89, "min": 66.10, "cnt": 32}, "fwd-compute":{"total": 1865.01, "avg": 58.28, "max": 51.78, "min": 65.85, "cnt": 32}, "batch-generator":{"total": 50.44, "avg": 1.58, "max": 0.87, "min": 2.27, "cnt": 32}, "fwd-embedding":{"total": 0.90, "avg": 0.03, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1797.43, "avg": 56.17, "max": 50.52, "min": 63.24, "cnt": 32}, "fwd-layernorm":{"total": 12.54, "avg": 0.10, "max": 0.06, "min": 0.25, "cnt": 128}, "fwd-attn":{"total": 121.32, "avg": 0.95, "max": 0.75, "min": 1.85, "cnt": 128}, "fwd-misc":{"total": 25.74, "avg": 0.20, "max": 0.12, "min": 0.38, "cnt": 128}, "fwd-MLP":{"total": 1611.16, "avg": 12.59, "max": 10.32, "min": 18.84, "cnt": 128}, "MoE_L0_fwd":{"total": 478.66, "avg": 14.96, "max": 10.61, "min": 18.67, "cnt": 32}, "MoEMLP":{"total": 1590.62, "avg": 12.43, "max": 10.18, "min": 18.58, "cnt": 128}, "MoE_L1_fwd":{"total": 371.58, "avg": 11.61, "max": 10.23, "min": 13.05, "cnt": 32}, "MoE_L2_fwd":{"total": 382.85, "avg": 11.96, "max": 11.21, "min": 15.49, "cnt": 32}, "MoE_L3_fwd":{"total": 364.97, "avg": 11.41, "max": 10.49, "min": 14.83, "cnt": 32}, "fwd-pooler":{"total": 0.39, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.69, "avg": 0.02, "max": 0.02, "min": 0.07, "cnt": 32}, "forward-send":{"total": 0.89, "avg": 0.89, "max": 0.89, "min": 0.89, "cnt": 1}, "forward-send-backward-recv":{"total": 1202.00, "avg": 38.77, "max": 1.39, "min": 195.62, "cnt": 31}, "backward-compute":{"total": 1463.26, "avg": 45.73, "max": 43.78, "min": 48.17, "cnt": 32}, "MoE_L3_bwd":{"total": 355.04, "avg": 11.09, "max": 10.01, "min": 13.83, "cnt": 32}, "MoE_L2_bwd":{"total": 341.50, "avg": 10.67, "max": 9.86, "min": 11.35, "cnt": 32}, "MoE_L1_bwd":{"total": 279.36, "avg": 8.73, "max": 8.34, "min": 10.55, "cnt": 32}, "MoE_L0_bwd":{"total": 273.03, "avg": 8.53, "max": 7.82, "min": 9.14, "cnt": 32}, "backward-send-forward-recv":{"total": 523.25, "avg": 17.44, "max": 2.01, "min": 213.56, "cnt": 30}, "backward-send":{"total": 2.05, "avg": 1.03, "max": 0.76, "min": 1.29, "cnt": 2}, "backward-recv":{"total": 79.85, "avg": 79.85, "max": 79.85, "min": 79.85, "cnt": 1}, "backward-params-all-reduce":{"total": 492.61, "avg": 492.61, "max": 492.61, "min": 492.61, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 276.25, "avg": 276.25, "max": 276.25, "min": 276.25, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 235.27, "avg": 235.27, "max": 235.27, "min": 235.27, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.59, "avg": 3.59, "max": 3.59, "min": 3.59, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 144, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 123.26, "avg": 61.63, "max": 1.13, "min": 122.13, "cnt": 2}, "forward-compute":{"total": 1844.14, "avg": 57.63, "max": 52.28, "min": 62.30, "cnt": 32}, "fwd-compute":{"total": 1840.47, "avg": 57.51, "max": 52.20, "min": 62.15, "cnt": 32}, "batch-generator":{"total": 46.64, "avg": 1.46, "max": 0.72, "min": 3.40, "cnt": 32}, "fwd-embedding":{"total": 0.70, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1779.48, "avg": 55.61, "max": 50.99, "min": 60.28, "cnt": 32}, "fwd-layernorm":{"total": 11.30, "avg": 0.09, "max": 0.06, "min": 0.23, "cnt": 128}, "fwd-attn":{"total": 118.55, "avg": 0.93, "max": 0.75, "min": 2.94, "cnt": 128}, "fwd-misc":{"total": 24.82, "avg": 0.19, "max": 0.12, "min": 0.48, "cnt": 128}, "fwd-MLP":{"total": 1599.63, "avg": 12.50, "max": 10.57, "min": 18.52, "cnt": 128}, "MoE_L0_fwd":{"total": 459.22, "avg": 14.35, "max": 11.12, "min": 18.42, "cnt": 32}, "MoEMLP":{"total": 1579.89, "avg": 12.34, "max": 10.45, "min": 18.37, "cnt": 128}, "MoE_L1_fwd":{"total": 369.89, "avg": 11.56, "max": 10.74, "min": 13.00, "cnt": 32}, "MoE_L2_fwd":{"total": 388.79, "avg": 12.15, "max": 11.27, "min": 13.33, "cnt": 32}, "MoE_L3_fwd":{"total": 369.25, "avg": 11.54, "max": 10.50, "min": 14.81, "cnt": 32}, "fwd-pooler":{"total": 0.38, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.67, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 0.84, "avg": 0.84, "max": 0.84, "min": 0.84, "cnt": 1}, "forward-send-backward-recv":{"total": 714.04, "avg": 23.03, "max": 1.38, "min": 211.70, "cnt": 31}, "backward-compute":{"total": 1467.29, "avg": 45.85, "max": 44.13, "min": 47.19, "cnt": 32}, "MoE_L3_bwd":{"total": 353.46, "avg": 11.05, "max": 9.98, "min": 11.88, "cnt": 32}, "MoE_L2_bwd":{"total": 340.53, "avg": 10.64, "max": 9.78, "min": 11.32, "cnt": 32}, "MoE_L1_bwd":{"total": 280.00, "avg": 8.75, "max": 8.40, "min": 9.58, "cnt": 32}, "MoE_L0_bwd":{"total": 275.85, "avg": 8.62, "max": 8.29, "min": 8.90, "cnt": 32}, "backward-send-forward-recv":{"total": 1014.18, "avg": 33.81, "max": 1.56, "min": 200.71, "cnt": 30}, "backward-send":{"total": 1.96, "avg": 0.98, "max": 0.94, "min": 1.03, "cnt": 2}, "backward-recv":{"total": 73.19, "avg": 73.19, "max": 73.19, "min": 73.19, "cnt": 1}, "backward-params-all-reduce":{"total": 490.12, "avg": 490.12, "max": 490.12, "min": 490.12, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 276.37, "avg": 276.37, "max": 276.37, "min": 276.37, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 236.60, "avg": 236.60, "max": 236.60, "min": 236.60, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.32, "avg": 3.32, "max": 3.32, "min": 3.32, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.47, "avg": 3.47, "max": 3.47, "min": 3.47, "cnt": 1}}}
{"type":"time", "iteration": 145, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 127.07, "avg": 63.53, "max": 1.33, "min": 125.74, "cnt": 2}, "forward-compute":{"total": 1837.32, "avg": 57.42, "max": 49.75, "min": 71.17, "cnt": 32}, "fwd-compute":{"total": 1833.74, "avg": 57.30, "max": 49.67, "min": 71.04, "cnt": 32}, "batch-generator":{"total": 45.78, "avg": 1.43, "max": 0.68, "min": 1.95, "cnt": 32}, "fwd-embedding":{"total": 0.70, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1773.83, "avg": 55.43, "max": 48.64, "min": 68.84, "cnt": 32}, "fwd-layernorm":{"total": 11.12, "avg": 0.09, "max": 0.06, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 115.62, "avg": 0.90, "max": 0.75, "min": 1.50, "cnt": 128}, "fwd-misc":{"total": 23.56, "avg": 0.18, "max": 0.12, "min": 0.45, "cnt": 128}, "fwd-MLP":{"total": 1598.91, "avg": 12.49, "max": 10.23, "min": 19.50, "cnt": 128}, "MoE_L0_fwd":{"total": 471.81, "avg": 14.74, "max": 10.47, "min": 19.00, "cnt": 32}, "MoEMLP":{"total": 1580.04, "avg": 12.34, "max": 10.09, "min": 19.35, "cnt": 128}, "MoE_L1_fwd":{"total": 381.80, "avg": 11.93, "max": 10.15, "min": 19.41, "cnt": 32}, "MoE_L2_fwd":{"total": 376.98, "avg": 11.78, "max": 11.18, "min": 13.06, "cnt": 32}, "MoE_L3_fwd":{"total": 356.30, "avg": 11.13, "max": 10.42, "min": 14.42, "cnt": 32}, "fwd-pooler":{"total": 0.38, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.62, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 0.96, "avg": 0.96, "max": 0.96, "min": 0.96, "cnt": 1}, "forward-send-backward-recv":{"total": 426.51, "avg": 13.76, "max": 1.30, "min": 94.88, "cnt": 31}, "backward-compute":{"total": 1465.82, "avg": 45.81, "max": 43.34, "min": 49.48, "cnt": 32}, "MoE_L3_bwd":{"total": 348.28, "avg": 10.88, "max": 9.65, "min": 12.91, "cnt": 32}, "MoE_L2_bwd":{"total": 344.74, "avg": 10.77, "max": 9.95, "min": 16.09, "cnt": 32}, "MoE_L1_bwd":{"total": 283.32, "avg": 8.85, "max": 8.24, "min": 10.37, "cnt": 32}, "MoE_L0_bwd":{"total": 272.95, "avg": 8.53, "max": 7.89, "min": 9.07, "cnt": 32}, "backward-send-forward-recv":{"total": 1260.77, "avg": 42.03, "max": 1.92, "min": 308.14, "cnt": 30}, "backward-send":{"total": 2.33, "avg": 1.17, "max": 1.15, "min": 1.19, "cnt": 2}, "backward-recv":{"total": 72.04, "avg": 72.04, "max": 72.04, "min": 72.04, "cnt": 1}, "backward-params-all-reduce":{"total": 495.14, "avg": 495.14, "max": 495.14, "min": 495.14, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 277.39, "avg": 277.39, "max": 277.39, "min": 277.39, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 232.47, "avg": 232.47, "max": 232.47, "min": 232.47, "cnt": 1}, "optimizer-clip-main-grad":{"total": 5.88, "avg": 5.88, "max": 5.88, "min": 5.88, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.50, "avg": 3.50, "max": 3.50, "min": 3.50, "cnt": 1}}}
{"type":"time", "iteration": 146, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.13, "avg": 0.13, "max": 0.13, "min": 0.13, "cnt": 1}, "forward-recv":{"total": 132.29, "avg": 66.14, "max": 6.41, "min": 125.88, "cnt": 2}, "forward-compute":{"total": 1800.24, "avg": 56.26, "max": 51.06, "min": 63.54, "cnt": 32}, "fwd-compute":{"total": 1796.86, "avg": 56.15, "max": 50.96, "min": 63.41, "cnt": 32}, "batch-generator":{"total": 44.56, "avg": 1.39, "max": 0.79, "min": 2.05, "cnt": 32}, "fwd-embedding":{"total": 0.64, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1738.65, "avg": 54.33, "max": 49.57, "min": 61.22, "cnt": 32}, "fwd-layernorm":{"total": 10.62, "avg": 0.08, "max": 0.06, "min": 0.22, "cnt": 128}, "fwd-attn":{"total": 110.30, "avg": 0.86, "max": 0.75, "min": 1.73, "cnt": 128}, "fwd-misc":{"total": 21.94, "avg": 0.17, "max": 0.12, "min": 0.38, "cnt": 128}, "fwd-MLP":{"total": 1571.74, "avg": 12.28, "max": 10.16, "min": 20.17, "cnt": 128}, "MoE_L0_fwd":{"total": 461.06, "avg": 14.41, "max": 11.22, "min": 20.09, "cnt": 32}, "MoEMLP":{"total": 1553.66, "avg": 12.14, "max": 10.05, "min": 20.04, "cnt": 128}, "MoE_L1_fwd":{"total": 365.30, "avg": 11.42, "max": 10.51, "min": 13.13, "cnt": 32}, "MoE_L2_fwd":{"total": 384.81, "avg": 12.03, "max": 11.21, "min": 16.30, "cnt": 32}, "MoE_L3_fwd":{"total": 349.04, "avg": 10.91, "max": 10.09, "min": 12.55, "cnt": 32}, "fwd-pooler":{"total": 0.38, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.63, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 0.90, "avg": 0.90, "max": 0.90, "min": 0.90, "cnt": 1}, "forward-send-backward-recv":{"total": 244.35, "avg": 7.88, "max": 0.93, "min": 65.40, "cnt": 31}, "backward-compute":{"total": 1457.22, "avg": 45.54, "max": 42.65, "min": 48.11, "cnt": 32}, "MoE_L3_bwd":{"total": 351.63, "avg": 10.99, "max": 10.00, "min": 12.49, "cnt": 32}, "MoE_L2_bwd":{"total": 338.03, "avg": 10.56, "max": 10.02, "min": 11.72, "cnt": 32}, "MoE_L1_bwd":{"total": 277.82, "avg": 8.68, "max": 8.24, "min": 8.99, "cnt": 32}, "MoE_L0_bwd":{"total": 269.31, "avg": 8.42, "max": 7.71, "min": 8.76, "cnt": 32}, "backward-send-forward-recv":{"total": 2436.74, "avg": 81.22, "max": 2.17, "min": 490.20, "cnt": 30}, "backward-send":{"total": 1.93, "avg": 0.96, "max": 0.93, "min": 1.00, "cnt": 2}, "backward-recv":{"total": 74.91, "avg": 74.91, "max": 74.91, "min": 74.91, "cnt": 1}, "backward-params-all-reduce":{"total": 486.28, "avg": 486.28, "max": 486.28, "min": 486.28, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "optimizer":{"total": 278.38, "avg": 278.38, "max": 278.38, "min": 278.38, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.41, "avg": 3.41, "max": 3.41, "min": 3.41, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 238.21, "avg": 238.21, "max": 238.21, "min": 238.21, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.29, "avg": 3.29, "max": 3.29, "min": 3.29, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.50, "avg": 3.50, "max": 3.50, "min": 3.50, "cnt": 1}}}
{"type":"time", "iteration": 147, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.10, "avg": 0.10, "max": 0.10, "min": 0.10, "cnt": 1}, "forward-recv":{"total": 117.52, "avg": 58.76, "max": 1.25, "min": 116.27, "cnt": 2}, "forward-compute":{"total": 1848.30, "avg": 57.76, "max": 49.84, "min": 66.00, "cnt": 32}, "fwd-compute":{"total": 1844.44, "avg": 57.64, "max": 49.72, "min": 65.85, "cnt": 32}, "batch-generator":{"total": 47.07, "avg": 1.47, "max": 0.80, "min": 2.74, "cnt": 32}, "fwd-embedding":{"total": 0.81, "avg": 0.03, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1782.43, "avg": 55.70, "max": 47.94, "min": 63.69, "cnt": 32}, "fwd-layernorm":{"total": 11.93, "avg": 0.09, "max": 0.06, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 117.31, "avg": 0.92, "max": 0.75, "min": 1.59, "cnt": 128}, "fwd-misc":{"total": 23.99, "avg": 0.19, "max": 0.12, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1603.35, "avg": 12.53, "max": 10.08, "min": 19.27, "cnt": 128}, "MoE_L0_fwd":{"total": 475.19, "avg": 14.85, "max": 10.85, "min": 19.11, "cnt": 32}, "MoEMLP":{"total": 1583.76, "avg": 12.37, "max": 9.95, "min": 19.02, "cnt": 128}, "MoE_L1_fwd":{"total": 373.02, "avg": 11.66, "max": 10.00, "min": 15.21, "cnt": 32}, "MoE_L2_fwd":{"total": 392.67, "avg": 12.27, "max": 10.89, "min": 17.96, "cnt": 32}, "MoE_L3_fwd":{"total": 349.94, "avg": 10.94, "max": 10.08, "min": 12.51, "cnt": 32}, "fwd-pooler":{"total": 0.37, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.64, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 0.95, "avg": 0.95, "max": 0.95, "min": 0.95, "cnt": 1}, "forward-send-backward-recv":{"total": 938.58, "avg": 30.28, "max": 1.70, "min": 218.88, "cnt": 31}, "backward-compute":{"total": 1469.61, "avg": 45.93, "max": 43.20, "min": 49.06, "cnt": 32}, "MoE_L3_bwd":{"total": 354.02, "avg": 11.06, "max": 9.58, "min": 12.29, "cnt": 32}, "MoE_L2_bwd":{"total": 336.12, "avg": 10.50, "max": 9.24, "min": 11.71, "cnt": 32}, "MoE_L1_bwd":{"total": 277.66, "avg": 8.68, "max": 8.10, "min": 10.93, "cnt": 32}, "MoE_L0_bwd":{"total": 275.42, "avg": 8.61, "max": 8.05, "min": 9.87, "cnt": 32}, "backward-send-forward-recv":{"total": 699.27, "avg": 23.31, "max": 2.05, "min": 168.90, "cnt": 30}, "backward-send":{"total": 2.20, "avg": 1.10, "max": 1.08, "min": 1.12, "cnt": 2}, "backward-recv":{"total": 71.61, "avg": 71.61, "max": 71.61, "min": 71.61, "cnt": 1}, "backward-params-all-reduce":{"total": 488.96, "avg": 488.96, "max": 488.96, "min": 488.96, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 271.15, "avg": 271.15, "max": 271.15, "min": 271.15, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 229.90, "avg": 229.90, "max": 229.90, "min": 229.90, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.62, "avg": 3.62, "max": 3.62, "min": 3.62, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.63, "avg": 3.63, "max": 3.63, "min": 3.63, "cnt": 1}}}
{"type":"time", "iteration": 148, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 133.31, "avg": 66.65, "max": 1.09, "min": 132.22, "cnt": 2}, "forward-compute":{"total": 1896.95, "avg": 59.28, "max": 48.44, "min": 70.10, "cnt": 32}, "fwd-compute":{"total": 1893.21, "avg": 59.16, "max": 48.34, "min": 69.98, "cnt": 32}, "batch-generator":{"total": 46.39, "avg": 1.45, "max": 0.80, "min": 2.06, "cnt": 32}, "fwd-embedding":{"total": 0.75, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1831.96, "avg": 57.25, "max": 47.07, "min": 68.06, "cnt": 32}, "fwd-layernorm":{"total": 11.51, "avg": 0.09, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 115.98, "avg": 0.91, "max": 0.75, "min": 1.69, "cnt": 128}, "fwd-misc":{"total": 24.09, "avg": 0.19, "max": 0.12, "min": 0.38, "cnt": 128}, "fwd-MLP":{"total": 1654.39, "avg": 12.92, "max": 10.23, "min": 20.15, "cnt": 128}, "MoE_L0_fwd":{"total": 505.47, "avg": 15.80, "max": 10.81, "min": 20.03, "cnt": 32}, "MoEMLP":{"total": 1634.68, "avg": 12.77, "max": 10.12, "min": 19.98, "cnt": 128}, "MoE_L1_fwd":{"total": 394.85, "avg": 12.34, "max": 10.27, "min": 15.67, "cnt": 32}, "MoE_L2_fwd":{"total": 380.03, "avg": 11.88, "max": 10.80, "min": 15.99, "cnt": 32}, "MoE_L3_fwd":{"total": 361.39, "avg": 11.29, "max": 10.16, "min": 13.99, "cnt": 32}, "fwd-pooler":{"total": 0.38, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.65, "avg": 0.02, "max": 0.02, "min": 0.06, "cnt": 32}, "forward-send":{"total": 0.75, "avg": 0.75, "max": 0.75, "min": 0.75, "cnt": 1}, "forward-send-backward-recv":{"total": 1502.19, "avg": 48.46, "max": 1.89, "min": 176.09, "cnt": 31}, "backward-compute":{"total": 1469.20, "avg": 45.91, "max": 42.33, "min": 48.62, "cnt": 32}, "MoE_L3_bwd":{"total": 360.65, "avg": 11.27, "max": 9.57, "min": 12.93, "cnt": 32}, "MoE_L2_bwd":{"total": 328.78, "avg": 10.27, "max": 9.76, "min": 11.55, "cnt": 32}, "MoE_L1_bwd":{"total": 272.29, "avg": 8.51, "max": 7.80, "min": 9.88, "cnt": 32}, "MoE_L0_bwd":{"total": 278.71, "avg": 8.71, "max": 8.16, "min": 9.95, "cnt": 32}, "backward-send-forward-recv":{"total": 1030.50, "avg": 34.35, "max": 1.42, "min": 537.45, "cnt": 30}, "backward-send":{"total": 2.09, "avg": 1.05, "max": 1.02, "min": 1.07, "cnt": 2}, "backward-recv":{"total": 71.29, "avg": 71.29, "max": 71.29, "min": 71.29, "cnt": 1}, "backward-params-all-reduce":{"total": 492.26, "avg": 492.26, "max": 492.26, "min": 492.26, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 270.57, "avg": 270.57, "max": 270.57, "min": 270.57, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 230.40, "avg": 230.40, "max": 230.40, "min": 230.40, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.59, "avg": 3.59, "max": 3.59, "min": 3.59, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.50, "avg": 3.50, "max": 3.50, "min": 3.50, "cnt": 1}}}
{"type":"time", "iteration": 149, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.10, "avg": 0.10, "max": 0.10, "min": 0.10, "cnt": 1}, "forward-recv":{"total": 485.42, "avg": 242.71, "max": 1.13, "min": 484.29, "cnt": 2}, "forward-compute":{"total": 1854.09, "avg": 57.94, "max": 50.81, "min": 65.05, "cnt": 32}, "fwd-compute":{"total": 1850.19, "avg": 57.82, "max": 50.73, "min": 64.90, "cnt": 32}, "batch-generator":{"total": 49.79, "avg": 1.56, "max": 0.84, "min": 4.03, "cnt": 32}, "fwd-embedding":{"total": 0.81, "avg": 0.03, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1781.27, "avg": 55.66, "max": 49.23, "min": 59.37, "cnt": 32}, "fwd-layernorm":{"total": 12.28, "avg": 0.10, "max": 0.06, "min": 0.36, "cnt": 128}, "fwd-attn":{"total": 122.69, "avg": 0.96, "max": 0.75, "min": 2.19, "cnt": 128}, "fwd-misc":{"total": 25.51, "avg": 0.20, "max": 0.12, "min": 0.45, "cnt": 128}, "fwd-MLP":{"total": 1593.94, "avg": 12.45, "max": 10.42, "min": 17.90, "cnt": 128}, "MoE_L0_fwd":{"total": 484.14, "avg": 15.13, "max": 10.98, "min": 17.74, "cnt": 32}, "MoEMLP":{"total": 1573.19, "avg": 12.29, "max": 10.30, "min": 17.65, "cnt": 128}, "MoE_L1_fwd":{"total": 372.41, "avg": 11.64, "max": 10.34, "min": 13.06, "cnt": 32}, "MoE_L2_fwd":{"total": 362.66, "avg": 11.33, "max": 10.80, "min": 12.14, "cnt": 32}, "MoE_L3_fwd":{"total": 361.47, "avg": 11.30, "max": 10.37, "min": 14.77, "cnt": 32}, "fwd-pooler":{"total": 0.41, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.69, "avg": 0.02, "max": 0.02, "min": 0.04, "cnt": 32}, "forward-send":{"total": 1.13, "avg": 1.13, "max": 1.13, "min": 1.13, "cnt": 1}, "forward-send-backward-recv":{"total": 1458.41, "avg": 47.05, "max": 1.71, "min": 217.44, "cnt": 31}, "backward-compute":{"total": 1462.42, "avg": 45.70, "max": 44.02, "min": 47.57, "cnt": 32}, "MoE_L3_bwd":{"total": 361.71, "avg": 11.30, "max": 10.62, "min": 12.76, "cnt": 32}, "MoE_L2_bwd":{"total": 327.16, "avg": 10.22, "max": 9.37, "min": 11.23, "cnt": 32}, "MoE_L1_bwd":{"total": 278.22, "avg": 8.69, "max": 8.14, "min": 9.08, "cnt": 32}, "MoE_L0_bwd":{"total": 280.18, "avg": 8.76, "max": 8.40, "min": 9.89, "cnt": 32}, "backward-send-forward-recv":{"total": 1249.39, "avg": 41.65, "max": 1.77, "min": 466.06, "cnt": 30}, "backward-send":{"total": 1.90, "avg": 0.95, "max": 0.87, "min": 1.03, "cnt": 2}, "backward-recv":{"total": 72.76, "avg": 72.76, "max": 72.76, "min": 72.76, "cnt": 1}, "backward-params-all-reduce":{"total": 488.64, "avg": 488.64, "max": 488.64, "min": 488.64, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 277.78, "avg": 277.78, "max": 277.78, "min": 277.78, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 237.42, "avg": 237.42, "max": 237.42, "min": 237.42, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.60, "avg": 3.60, "max": 3.60, "min": 3.60, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.50, "avg": 3.50, "max": 3.50, "min": 3.50, "cnt": 1}}}
{"type":"time", "iteration": 150, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 131.72, "avg": 65.86, "max": 6.41, "min": 125.32, "cnt": 2}, "forward-compute":{"total": 1840.47, "avg": 57.51, "max": 52.51, "min": 65.19, "cnt": 32}, "fwd-compute":{"total": 1836.47, "avg": 57.39, "max": 52.42, "min": 65.06, "cnt": 32}, "batch-generator":{"total": 50.42, "avg": 1.58, "max": 0.83, "min": 2.99, "cnt": 32}, "fwd-embedding":{"total": 0.88, "avg": 0.03, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1770.78, "avg": 55.34, "max": 51.17, "min": 62.80, "cnt": 32}, "fwd-layernorm":{"total": 12.25, "avg": 0.10, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 118.54, "avg": 0.93, "max": 0.75, "min": 1.58, "cnt": 128}, "fwd-misc":{"total": 25.20, "avg": 0.20, "max": 0.12, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1588.91, "avg": 12.41, "max": 10.26, "min": 19.78, "cnt": 128}, "MoE_L0_fwd":{"total": 496.51, "avg": 15.52, "max": 12.94, "min": 19.60, "cnt": 32}, "MoEMLP":{"total": 1568.72, "avg": 12.26, "max": 10.14, "min": 19.49, "cnt": 128}, "MoE_L1_fwd":{"total": 372.69, "avg": 11.65, "max": 10.60, "min": 14.72, "cnt": 32}, "MoE_L2_fwd":{"total": 357.23, "avg": 11.16, "max": 10.42, "min": 13.46, "cnt": 32}, "MoE_L3_fwd":{"total": 349.57, "avg": 10.92, "max": 10.18, "min": 16.52, "cnt": 32}, "fwd-pooler":{"total": 0.37, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.64, "avg": 0.02, "max": 0.02, "min": 0.04, "cnt": 32}, "forward-send":{"total": 0.80, "avg": 0.80, "max": 0.80, "min": 0.80, "cnt": 1}, "forward-send-backward-recv":{"total": 1426.65, "avg": 46.02, "max": 1.52, "min": 215.40, "cnt": 31}, "backward-compute":{"total": 1480.09, "avg": 46.25, "max": 43.52, "min": 48.33, "cnt": 32}, "MoE_L3_bwd":{"total": 379.67, "avg": 11.86, "max": 10.74, "min": 14.82, "cnt": 32}, "MoE_L2_bwd":{"total": 323.17, "avg": 10.10, "max": 9.38, "min": 10.69, "cnt": 32}, "MoE_L1_bwd":{"total": 283.14, "avg": 8.85, "max": 8.30, "min": 10.36, "cnt": 32}, "MoE_L0_bwd":{"total": 273.74, "avg": 8.55, "max": 8.12, "min": 9.33, "cnt": 32}, "backward-send-forward-recv":{"total": 461.48, "avg": 15.38, "max": 2.07, "min": 327.95, "cnt": 30}, "backward-send":{"total": 2.13, "avg": 1.07, "max": 0.99, "min": 1.15, "cnt": 2}, "backward-recv":{"total": 249.16, "avg": 249.16, "max": 249.16, "min": 249.16, "cnt": 1}, "backward-params-all-reduce":{"total": 500.05, "avg": 500.05, "max": 500.05, "min": 500.05, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 267.46, "avg": 267.46, "max": 267.46, "min": 267.46, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 227.54, "avg": 227.54, "max": 227.54, "min": 227.54, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.35, "avg": 3.35, "max": 3.35, "min": 3.35, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.48, "avg": 3.48, "max": 3.48, "min": 3.48, "cnt": 1}}}
{"type":"time", "iteration": 151, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 125.00, "avg": 62.50, "max": 1.36, "min": 123.64, "cnt": 2}, "forward-compute":{"total": 1816.99, "avg": 56.78, "max": 50.03, "min": 64.25, "cnt": 32}, "fwd-compute":{"total": 1813.24, "avg": 56.66, "max": 49.94, "min": 64.14, "cnt": 32}, "batch-generator":{"total": 45.83, "avg": 1.43, "max": 0.73, "min": 2.38, "cnt": 32}, "fwd-embedding":{"total": 0.69, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1752.84, "avg": 54.78, "max": 48.47, "min": 62.38, "cnt": 32}, "fwd-layernorm":{"total": 11.37, "avg": 0.09, "max": 0.06, "min": 0.22, "cnt": 128}, "fwd-attn":{"total": 113.02, "avg": 0.88, "max": 0.75, "min": 1.92, "cnt": 128}, "fwd-misc":{"total": 23.20, "avg": 0.18, "max": 0.12, "min": 0.45, "cnt": 128}, "fwd-MLP":{"total": 1580.34, "avg": 12.35, "max": 10.15, "min": 20.80, "cnt": 128}, "MoE_L0_fwd":{"total": 468.68, "avg": 14.65, "max": 11.33, "min": 20.66, "cnt": 32}, "MoEMLP":{"total": 1561.29, "avg": 12.20, "max": 10.03, "min": 20.58, "cnt": 128}, "MoE_L1_fwd":{"total": 374.72, "avg": 11.71, "max": 10.32, "min": 16.64, "cnt": 32}, "MoE_L2_fwd":{"total": 377.11, "avg": 11.78, "max": 10.75, "min": 17.35, "cnt": 32}, "MoE_L3_fwd":{"total": 347.62, "avg": 10.86, "max": 10.07, "min": 11.96, "cnt": 32}, "fwd-pooler":{"total": 0.39, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.64, "avg": 0.02, "max": 0.02, "min": 0.04, "cnt": 32}, "forward-send":{"total": 0.96, "avg": 0.96, "max": 0.96, "min": 0.96, "cnt": 1}, "forward-send-backward-recv":{"total": 391.08, "avg": 12.62, "max": 1.42, "min": 135.09, "cnt": 31}, "backward-compute":{"total": 1478.68, "avg": 46.21, "max": 44.45, "min": 50.78, "cnt": 32}, "MoE_L3_bwd":{"total": 373.11, "avg": 11.66, "max": 10.33, "min": 12.52, "cnt": 32}, "MoE_L2_bwd":{"total": 328.56, "avg": 10.27, "max": 9.62, "min": 13.12, "cnt": 32}, "MoE_L1_bwd":{"total": 284.61, "avg": 8.89, "max": 8.29, "min": 10.15, "cnt": 32}, "MoE_L0_bwd":{"total": 274.74, "avg": 8.59, "max": 8.06, "min": 10.72, "cnt": 32}, "backward-send-forward-recv":{"total": 1596.99, "avg": 53.23, "max": 1.81, "min": 348.80, "cnt": 30}, "backward-send":{"total": 2.14, "avg": 1.07, "max": 0.93, "min": 1.21, "cnt": 2}, "backward-recv":{"total": 71.65, "avg": 71.65, "max": 71.65, "min": 71.65, "cnt": 1}, "backward-params-all-reduce":{"total": 492.59, "avg": 492.59, "max": 492.59, "min": 492.59, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 278.62, "avg": 278.62, "max": 278.62, "min": 278.62, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 238.70, "avg": 238.70, "max": 238.70, "min": 238.70, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.27, "avg": 3.27, "max": 3.27, "min": 3.27, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.48, "avg": 3.48, "max": 3.48, "min": 3.48, "cnt": 1}}}
{"type":"time", "iteration": 152, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 116.81, "avg": 58.41, "max": 1.24, "min": 115.58, "cnt": 2}, "forward-compute":{"total": 1823.87, "avg": 57.00, "max": 51.25, "min": 65.02, "cnt": 32}, "fwd-compute":{"total": 1820.21, "avg": 56.88, "max": 51.17, "min": 64.92, "cnt": 32}, "batch-generator":{"total": 47.70, "avg": 1.49, "max": 0.77, "min": 2.99, "cnt": 32}, "fwd-embedding":{"total": 0.63, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1757.95, "avg": 54.94, "max": 49.08, "min": 63.33, "cnt": 32}, "fwd-layernorm":{"total": 10.90, "avg": 0.09, "max": 0.06, "min": 0.23, "cnt": 128}, "fwd-attn":{"total": 111.98, "avg": 0.87, "max": 0.75, "min": 1.82, "cnt": 128}, "fwd-misc":{"total": 23.18, "avg": 0.18, "max": 0.12, "min": 0.41, "cnt": 128}, "fwd-MLP":{"total": 1587.08, "avg": 12.40, "max": 9.95, "min": 20.19, "cnt": 128}, "MoE_L0_fwd":{"total": 459.34, "avg": 14.35, "max": 10.58, "min": 20.09, "cnt": 32}, "MoEMLP":{"total": 1567.00, "avg": 12.24, "max": 9.83, "min": 20.03, "cnt": 128}, "MoE_L1_fwd":{"total": 365.27, "avg": 11.41, "max": 10.49, "min": 14.20, "cnt": 32}, "MoE_L2_fwd":{"total": 383.92, "avg": 12.00, "max": 10.97, "min": 16.10, "cnt": 32}, "MoE_L3_fwd":{"total": 365.37, "avg": 11.42, "max": 9.88, "min": 15.27, "cnt": 32}, "fwd-pooler":{"total": 0.39, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.69, "avg": 0.02, "max": 0.02, "min": 0.05, "cnt": 32}, "forward-send":{"total": 0.98, "avg": 0.98, "max": 0.98, "min": 0.98, "cnt": 1}, "forward-send-backward-recv":{"total": 454.21, "avg": 14.65, "max": 1.19, "min": 78.33, "cnt": 31}, "backward-compute":{"total": 1460.82, "avg": 45.65, "max": 43.40, "min": 47.74, "cnt": 32}, "MoE_L3_bwd":{"total": 347.64, "avg": 10.86, "max": 10.03, "min": 13.16, "cnt": 32}, "MoE_L2_bwd":{"total": 334.00, "avg": 10.44, "max": 9.87, "min": 12.34, "cnt": 32}, "MoE_L1_bwd":{"total": 278.74, "avg": 8.71, "max": 8.17, "min": 9.62, "cnt": 32}, "MoE_L0_bwd":{"total": 272.23, "avg": 8.51, "max": 8.16, "min": 9.56, "cnt": 32}, "backward-send-forward-recv":{"total": 2461.53, "avg": 82.05, "max": 2.04, "min": 346.12, "cnt": 30}, "backward-send":{"total": 1.75, "avg": 0.87, "max": 0.69, "min": 1.06, "cnt": 2}, "backward-recv":{"total": 73.34, "avg": 73.34, "max": 73.34, "min": 73.34, "cnt": 1}, "backward-params-all-reduce":{"total": 489.26, "avg": 489.26, "max": 489.26, "min": 489.26, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 276.72, "avg": 276.72, "max": 276.72, "min": 276.72, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 236.60, "avg": 236.60, "max": 236.60, "min": 236.60, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.57, "avg": 3.57, "max": 3.57, "min": 3.57, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.47, "avg": 3.47, "max": 3.47, "min": 3.47, "cnt": 1}}}
{"type":"time", "iteration": 153, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.13, "avg": 0.13, "max": 0.13, "min": 0.13, "cnt": 1}, "forward-recv":{"total": 125.47, "avg": 62.73, "max": 1.25, "min": 124.22, "cnt": 2}, "forward-compute":{"total": 1865.73, "avg": 58.30, "max": 49.70, "min": 68.28, "cnt": 32}, "fwd-compute":{"total": 1862.04, "avg": 58.19, "max": 49.60, "min": 68.15, "cnt": 32}, "batch-generator":{"total": 48.88, "avg": 1.53, "max": 0.78, "min": 2.53, "cnt": 32}, "fwd-embedding":{"total": 0.78, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1798.06, "avg": 56.19, "max": 48.34, "min": 65.59, "cnt": 32}, "fwd-layernorm":{"total": 11.37, "avg": 0.09, "max": 0.06, "min": 0.22, "cnt": 128}, "fwd-attn":{"total": 114.70, "avg": 0.90, "max": 0.75, "min": 1.81, "cnt": 128}, "fwd-misc":{"total": 23.48, "avg": 0.18, "max": 0.12, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1623.77, "avg": 12.69, "max": 10.15, "min": 20.46, "cnt": 128}, "MoE_L0_fwd":{"total": 494.37, "avg": 15.45, "max": 10.89, "min": 20.28, "cnt": 32}, "MoEMLP":{"total": 1604.53, "avg": 12.54, "max": 10.03, "min": 20.20, "cnt": 128}, "MoE_L1_fwd":{"total": 381.35, "avg": 11.92, "max": 10.37, "min": 14.60, "cnt": 32}, "MoE_L2_fwd":{"total": 375.56, "avg": 11.74, "max": 11.04, "min": 13.64, "cnt": 32}, "MoE_L3_fwd":{"total": 360.14, "avg": 11.25, "max": 10.08, "min": 14.22, "cnt": 32}, "fwd-pooler":{"total": 0.36, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.62, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.01, "avg": 1.01, "max": 1.01, "min": 1.01, "cnt": 1}, "forward-send-backward-recv":{"total": 722.04, "avg": 23.29, "max": 1.53, "min": 175.93, "cnt": 31}, "backward-compute":{"total": 1527.87, "avg": 47.75, "max": 41.90, "min": 127.74, "cnt": 32}, "MoE_L3_bwd":{"total": 346.76, "avg": 10.84, "max": 9.53, "min": 15.19, "cnt": 32}, "MoE_L2_bwd":{"total": 328.96, "avg": 10.28, "max": 9.22, "min": 12.68, "cnt": 32}, "MoE_L1_bwd":{"total": 283.48, "avg": 8.86, "max": 8.06, "min": 10.17, "cnt": 32}, "MoE_L0_bwd":{"total": 351.66, "avg": 10.99, "max": 7.86, "min": 90.38, "cnt": 32}, "backward-send-forward-recv":{"total": 816.02, "avg": 27.20, "max": 1.92, "min": 185.97, "cnt": 30}, "backward-send":{"total": 2.09, "avg": 1.05, "max": 0.92, "min": 1.17, "cnt": 2}, "backward-recv":{"total": 86.56, "avg": 86.56, "max": 86.56, "min": 86.56, "cnt": 1}, "backward-params-all-reduce":{"total": 488.29, "avg": 488.29, "max": 488.29, "min": 488.29, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.04, "avg": 0.04, "max": 0.04, "min": 0.04, "cnt": 1}, "optimizer":{"total": 331.81, "avg": 331.81, "max": 331.81, "min": 331.81, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 278.64, "avg": 278.64, "max": 278.64, "min": 278.64, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.65, "avg": 6.65, "max": 6.65, "min": 6.65, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.48, "avg": 3.48, "max": 3.48, "min": 3.48, "cnt": 1}}}
{"type":"time", "iteration": 154, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 122.01, "avg": 61.01, "max": 1.23, "min": 120.78, "cnt": 2}, "forward-compute":{"total": 1837.80, "avg": 57.43, "max": 51.14, "min": 67.87, "cnt": 32}, "fwd-compute":{"total": 1834.12, "avg": 57.32, "max": 51.03, "min": 67.78, "cnt": 32}, "batch-generator":{"total": 46.31, "avg": 1.45, "max": 0.83, "min": 1.95, "cnt": 32}, "fwd-embedding":{"total": 0.75, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1773.40, "avg": 55.42, "max": 49.28, "min": 66.44, "cnt": 32}, "fwd-layernorm":{"total": 11.51, "avg": 0.09, "max": 0.06, "min": 0.25, "cnt": 128}, "fwd-attn":{"total": 117.17, "avg": 0.92, "max": 0.75, "min": 2.07, "cnt": 128}, "fwd-misc":{"total": 23.57, "avg": 0.18, "max": 0.12, "min": 0.49, "cnt": 128}, "fwd-MLP":{"total": 1596.10, "avg": 12.47, "max": 10.05, "min": 21.47, "cnt": 128}, "MoE_L0_fwd":{"total": 492.41, "avg": 15.39, "max": 11.46, "min": 21.19, "cnt": 32}, "MoEMLP":{"total": 1576.79, "avg": 12.32, "max": 9.94, "min": 21.09, "cnt": 128}, "MoE_L1_fwd":{"total": 370.96, "avg": 11.59, "max": 10.31, "min": 15.09, "cnt": 32}, "MoE_L2_fwd":{"total": 380.72, "avg": 11.90, "max": 11.08, "min": 16.08, "cnt": 32}, "MoE_L3_fwd":{"total": 339.73, "avg": 10.62, "max": 9.98, "min": 11.83, "cnt": 32}, "fwd-pooler":{"total": 0.38, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.64, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.06, "avg": 1.06, "max": 1.06, "min": 1.06, "cnt": 1}, "forward-send-backward-recv":{"total": 644.68, "avg": 20.80, "max": 1.42, "min": 164.18, "cnt": 31}, "backward-compute":{"total": 1445.07, "avg": 45.16, "max": 43.87, "min": 46.40, "cnt": 32}, "MoE_L3_bwd":{"total": 336.61, "avg": 10.52, "max": 9.80, "min": 11.77, "cnt": 32}, "MoE_L2_bwd":{"total": 335.21, "avg": 10.48, "max": 9.87, "min": 11.12, "cnt": 32}, "MoE_L1_bwd":{"total": 277.40, "avg": 8.67, "max": 8.28, "min": 9.20, "cnt": 32}, "MoE_L0_bwd":{"total": 281.71, "avg": 8.80, "max": 8.22, "min": 10.41, "cnt": 32}, "backward-send-forward-recv":{"total": 935.79, "avg": 31.19, "max": 2.08, "min": 236.81, "cnt": 30}, "backward-send":{"total": 1.81, "avg": 0.90, "max": 0.88, "min": 0.93, "cnt": 2}, "backward-recv":{"total": 76.14, "avg": 76.14, "max": 76.14, "min": 76.14, "cnt": 1}, "backward-params-all-reduce":{"total": 489.02, "avg": 489.02, "max": 489.02, "min": 489.02, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 285.37, "avg": 285.37, "max": 285.37, "min": 285.37, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 240.50, "avg": 240.50, "max": 240.50, "min": 240.50, "cnt": 1}, "optimizer-clip-main-grad":{"total": 9.08, "avg": 9.08, "max": 9.08, "min": 9.08, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.47, "avg": 3.47, "max": 3.47, "min": 3.47, "cnt": 1}}}
{"type":"time", "iteration": 155, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.10, "avg": 0.10, "max": 0.10, "min": 0.10, "cnt": 1}, "forward-recv":{"total": 122.09, "avg": 61.04, "max": 0.89, "min": 121.20, "cnt": 2}, "forward-compute":{"total": 1830.54, "avg": 57.20, "max": 49.01, "min": 68.11, "cnt": 32}, "fwd-compute":{"total": 1826.93, "avg": 57.09, "max": 48.92, "min": 68.00, "cnt": 32}, "batch-generator":{"total": 42.45, "avg": 1.33, "max": 0.69, "min": 2.07, "cnt": 32}, "fwd-embedding":{"total": 0.65, "avg": 0.02, "max": 0.01, "min": 0.06, "cnt": 32}, "fwd-encoder":{"total": 1770.12, "avg": 55.32, "max": 47.64, "min": 66.09, "cnt": 32}, "fwd-layernorm":{"total": 10.76, "avg": 0.08, "max": 0.06, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 112.02, "avg": 0.88, "max": 0.75, "min": 1.81, "cnt": 128}, "fwd-misc":{"total": 23.23, "avg": 0.18, "max": 0.12, "min": 0.42, "cnt": 128}, "fwd-MLP":{"total": 1599.86, "avg": 12.50, "max": 10.05, "min": 20.19, "cnt": 128}, "MoE_L0_fwd":{"total": 490.27, "avg": 15.32, "max": 11.02, "min": 20.11, "cnt": 32}, "MoEMLP":{"total": 1580.91, "avg": 12.35, "max": 9.93, "min": 20.06, "cnt": 128}, "MoE_L1_fwd":{"total": 367.77, "avg": 11.49, "max": 9.97, "min": 14.51, "cnt": 32}, "MoE_L2_fwd":{"total": 374.66, "avg": 11.71, "max": 10.92, "min": 14.93, "cnt": 32}, "MoE_L3_fwd":{"total": 355.07, "avg": 11.10, "max": 10.04, "min": 16.99, "cnt": 32}, "fwd-pooler":{"total": 0.38, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.66, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.56, "avg": 1.56, "max": 1.56, "min": 1.56, "cnt": 1}, "forward-send-backward-recv":{"total": 650.92, "avg": 21.00, "max": 1.50, "min": 364.72, "cnt": 31}, "backward-compute":{"total": 1472.27, "avg": 46.01, "max": 43.36, "min": 50.33, "cnt": 32}, "MoE_L3_bwd":{"total": 348.37, "avg": 10.89, "max": 9.93, "min": 12.27, "cnt": 32}, "MoE_L2_bwd":{"total": 339.00, "avg": 10.59, "max": 9.69, "min": 14.07, "cnt": 32}, "MoE_L1_bwd":{"total": 274.55, "avg": 8.58, "max": 8.08, "min": 9.28, "cnt": 32}, "MoE_L0_bwd":{"total": 288.33, "avg": 9.01, "max": 8.40, "min": 11.07, "cnt": 32}, "backward-send-forward-recv":{"total": 3899.61, "avg": 129.99, "max": 1.82, "min": 1263.71, "cnt": 30}, "backward-send":{"total": 1.94, "avg": 0.97, "max": 0.96, "min": 0.98, "cnt": 2}, "backward-recv":{"total": 250.09, "avg": 250.09, "max": 250.09, "min": 250.09, "cnt": 1}, "backward-params-all-reduce":{"total": 485.74, "avg": 485.74, "max": 485.74, "min": 485.74, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 281.68, "avg": 281.68, "max": 281.68, "min": 281.68, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 241.56, "avg": 241.56, "max": 241.56, "min": 241.56, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.50, "avg": 3.50, "max": 3.50, "min": 3.50, "cnt": 1}}}
{"type":"time", "iteration": 156, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 132.48, "avg": 66.24, "max": 1.32, "min": 131.15, "cnt": 2}, "forward-compute":{"total": 1840.10, "avg": 57.50, "max": 51.02, "min": 61.00, "cnt": 32}, "fwd-compute":{"total": 1836.54, "avg": 57.39, "max": 50.94, "min": 60.92, "cnt": 32}, "batch-generator":{"total": 44.50, "avg": 1.39, "max": 0.77, "min": 2.35, "cnt": 32}, "fwd-embedding":{"total": 0.71, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1777.72, "avg": 55.55, "max": 49.80, "min": 59.67, "cnt": 32}, "fwd-layernorm":{"total": 11.26, "avg": 0.09, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 114.03, "avg": 0.89, "max": 0.75, "min": 1.67, "cnt": 128}, "fwd-misc":{"total": 23.25, "avg": 0.18, "max": 0.12, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1604.18, "avg": 12.53, "max": 10.26, "min": 19.01, "cnt": 128}, "MoE_L0_fwd":{"total": 497.18, "avg": 15.54, "max": 11.61, "min": 18.93, "cnt": 32}, "MoEMLP":{"total": 1585.07, "avg": 12.38, "max": 10.14, "min": 18.88, "cnt": 128}, "MoE_L1_fwd":{"total": 371.92, "avg": 11.62, "max": 10.62, "min": 13.75, "cnt": 32}, "MoE_L2_fwd":{"total": 379.99, "avg": 11.87, "max": 10.98, "min": 15.06, "cnt": 32}, "MoE_L3_fwd":{"total": 342.82, "avg": 10.71, "max": 10.18, "min": 11.82, "cnt": 32}, "fwd-pooler":{"total": 0.39, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.63, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.05, "avg": 1.05, "max": 1.05, "min": 1.05, "cnt": 1}, "forward-send-backward-recv":{"total": 768.59, "avg": 24.79, "max": 1.60, "min": 175.89, "cnt": 31}, "backward-compute":{"total": 1476.01, "avg": 46.13, "max": 44.29, "min": 47.40, "cnt": 32}, "MoE_L3_bwd":{"total": 354.68, "avg": 11.08, "max": 10.39, "min": 12.77, "cnt": 32}, "MoE_L2_bwd":{"total": 341.94, "avg": 10.69, "max": 10.11, "min": 11.39, "cnt": 32}, "MoE_L1_bwd":{"total": 285.88, "avg": 8.93, "max": 8.60, "min": 9.83, "cnt": 32}, "MoE_L0_bwd":{"total": 283.98, "avg": 8.87, "max": 8.48, "min": 9.17, "cnt": 32}, "backward-send-forward-recv":{"total": 719.97, "avg": 24.00, "max": 1.70, "min": 169.89, "cnt": 30}, "backward-send":{"total": 2.16, "avg": 1.08, "max": 1.04, "min": 1.13, "cnt": 2}, "backward-recv":{"total": 83.71, "avg": 83.71, "max": 83.71, "min": 83.71, "cnt": 1}, "backward-params-all-reduce":{"total": 491.92, "avg": 491.92, "max": 491.92, "min": 491.92, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 273.40, "avg": 273.40, "max": 273.40, "min": 273.40, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 233.53, "avg": 233.53, "max": 233.53, "min": 233.53, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.33, "avg": 3.33, "max": 3.33, "min": 3.33, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.48, "avg": 3.48, "max": 3.48, "min": 3.48, "cnt": 1}}}
{"type":"time", "iteration": 157, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 148.66, "avg": 74.33, "max": 4.82, "min": 143.84, "cnt": 2}, "forward-compute":{"total": 1876.80, "avg": 58.65, "max": 52.31, "min": 64.91, "cnt": 32}, "fwd-compute":{"total": 1872.71, "avg": 58.52, "max": 52.20, "min": 64.77, "cnt": 32}, "batch-generator":{"total": 51.13, "avg": 1.60, "max": 0.75, "min": 1.99, "cnt": 32}, "fwd-embedding":{"total": 0.89, "avg": 0.03, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1806.28, "avg": 56.45, "max": 50.02, "min": 62.75, "cnt": 32}, "fwd-layernorm":{"total": 12.51, "avg": 0.10, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 120.88, "avg": 0.94, "max": 0.75, "min": 1.82, "cnt": 128}, "fwd-misc":{"total": 26.18, "avg": 0.20, "max": 0.12, "min": 0.53, "cnt": 128}, "fwd-MLP":{"total": 1620.11, "avg": 12.66, "max": 10.27, "min": 18.83, "cnt": 128}, "MoE_L0_fwd":{"total": 504.10, "avg": 15.75, "max": 11.34, "min": 18.68, "cnt": 32}, "MoEMLP":{"total": 1599.35, "avg": 12.49, "max": 10.15, "min": 18.60, "cnt": 128}, "MoE_L1_fwd":{"total": 364.81, "avg": 11.40, "max": 10.27, "min": 13.42, "cnt": 32}, "MoE_L2_fwd":{"total": 377.55, "avg": 11.80, "max": 11.01, "min": 16.57, "cnt": 32}, "MoE_L3_fwd":{"total": 360.45, "avg": 11.26, "max": 10.20, "min": 15.77, "cnt": 32}, "fwd-pooler":{"total": 0.38, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.63, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 0.92, "avg": 0.92, "max": 0.92, "min": 0.92, "cnt": 1}, "forward-send-backward-recv":{"total": 1330.29, "avg": 42.91, "max": 1.76, "min": 338.48, "cnt": 31}, "backward-compute":{"total": 1463.89, "avg": 45.75, "max": 44.17, "min": 50.96, "cnt": 32}, "MoE_L3_bwd":{"total": 355.51, "avg": 11.11, "max": 10.52, "min": 17.77, "cnt": 32}, "MoE_L2_bwd":{"total": 342.08, "avg": 10.69, "max": 9.68, "min": 11.80, "cnt": 32}, "MoE_L1_bwd":{"total": 279.42, "avg": 8.73, "max": 8.20, "min": 9.44, "cnt": 32}, "MoE_L0_bwd":{"total": 276.46, "avg": 8.64, "max": 8.18, "min": 9.85, "cnt": 32}, "backward-send-forward-recv":{"total": 511.74, "avg": 17.06, "max": 2.00, "min": 239.42, "cnt": 30}, "backward-send":{"total": 1.86, "avg": 0.93, "max": 0.87, "min": 0.99, "cnt": 2}, "backward-recv":{"total": 72.42, "avg": 72.42, "max": 72.42, "min": 72.42, "cnt": 1}, "backward-params-all-reduce":{"total": 493.63, "avg": 493.63, "max": 493.63, "min": 493.63, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 274.53, "avg": 274.53, "max": 274.53, "min": 274.53, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 229.07, "avg": 229.07, "max": 229.07, "min": 229.07, "cnt": 1}, "optimizer-clip-main-grad":{"total": 5.78, "avg": 5.78, "max": 5.78, "min": 5.78, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.47, "avg": 3.47, "max": 3.47, "min": 3.47, "cnt": 1}}}
{"type":"time", "iteration": 158, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 130.29, "avg": 65.15, "max": 6.57, "min": 123.72, "cnt": 2}, "forward-compute":{"total": 1834.71, "avg": 57.33, "max": 50.64, "min": 64.53, "cnt": 32}, "fwd-compute":{"total": 1830.96, "avg": 57.22, "max": 50.56, "min": 64.38, "cnt": 32}, "batch-generator":{"total": 51.39, "avg": 1.61, "max": 0.72, "min": 3.24, "cnt": 32}, "fwd-embedding":{"total": 0.83, "avg": 0.03, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1764.31, "avg": 55.13, "max": 49.21, "min": 61.74, "cnt": 32}, "fwd-layernorm":{"total": 12.18, "avg": 0.10, "max": 0.06, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 117.91, "avg": 0.92, "max": 0.75, "min": 1.79, "cnt": 128}, "fwd-misc":{"total": 24.83, "avg": 0.19, "max": 0.12, "min": 0.42, "cnt": 128}, "fwd-MLP":{"total": 1583.20, "avg": 12.37, "max": 10.31, "min": 17.48, "cnt": 128}, "MoE_L0_fwd":{"total": 466.45, "avg": 14.58, "max": 11.05, "min": 17.29, "cnt": 32}, "MoEMLP":{"total": 1563.21, "avg": 12.21, "max": 10.18, "min": 17.25, "cnt": 128}, "MoE_L1_fwd":{"total": 369.12, "avg": 11.53, "max": 10.23, "min": 15.91, "cnt": 32}, "MoE_L2_fwd":{"total": 379.68, "avg": 11.87, "max": 10.95, "min": 13.59, "cnt": 32}, "MoE_L3_fwd":{"total": 355.14, "avg": 11.10, "max": 10.28, "min": 12.77, "cnt": 32}, "fwd-pooler":{"total": 0.39, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.65, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 0.92, "avg": 0.92, "max": 0.92, "min": 0.92, "cnt": 1}, "forward-send-backward-recv":{"total": 574.75, "avg": 18.54, "max": 1.34, "min": 111.77, "cnt": 31}, "backward-compute":{"total": 1478.55, "avg": 46.20, "max": 44.32, "min": 51.94, "cnt": 32}, "MoE_L3_bwd":{"total": 360.28, "avg": 11.26, "max": 10.18, "min": 12.57, "cnt": 32}, "MoE_L2_bwd":{"total": 336.81, "avg": 10.53, "max": 9.95, "min": 11.99, "cnt": 32}, "MoE_L1_bwd":{"total": 271.01, "avg": 8.47, "max": 7.78, "min": 8.86, "cnt": 32}, "MoE_L0_bwd":{"total": 279.67, "avg": 8.74, "max": 8.21, "min": 13.39, "cnt": 32}, "backward-send-forward-recv":{"total": 824.41, "avg": 27.48, "max": 1.45, "min": 173.80, "cnt": 30}, "backward-send":{"total": 1.82, "avg": 0.91, "max": 0.82, "min": 1.00, "cnt": 2}, "backward-recv":{"total": 83.05, "avg": 83.05, "max": 83.05, "min": 83.05, "cnt": 1}, "backward-params-all-reduce":{"total": 487.28, "avg": 487.28, "max": 487.28, "min": 487.28, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 279.52, "avg": 279.52, "max": 279.52, "min": 279.52, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 239.42, "avg": 239.42, "max": 239.42, "min": 239.42, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.58, "avg": 3.58, "max": 3.58, "min": 3.58, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.48, "avg": 3.48, "max": 3.48, "min": 3.48, "cnt": 1}}}
{"type":"time", "iteration": 159, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.10, "avg": 0.10, "max": 0.10, "min": 0.10, "cnt": 1}, "forward-recv":{"total": 140.33, "avg": 70.17, "max": 1.22, "min": 139.12, "cnt": 2}, "forward-compute":{"total": 1841.37, "avg": 57.54, "max": 50.72, "min": 62.88, "cnt": 32}, "fwd-compute":{"total": 1837.95, "avg": 57.44, "max": 50.63, "min": 62.75, "cnt": 32}, "batch-generator":{"total": 43.45, "avg": 1.36, "max": 0.78, "min": 2.14, "cnt": 32}, "fwd-embedding":{"total": 0.64, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1780.85, "avg": 55.65, "max": 49.10, "min": 60.46, "cnt": 32}, "fwd-layernorm":{"total": 10.69, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 109.98, "avg": 0.86, "max": 0.74, "min": 1.55, "cnt": 128}, "fwd-misc":{"total": 22.05, "avg": 0.17, "max": 0.12, "min": 0.38, "cnt": 128}, "fwd-MLP":{"total": 1614.64, "avg": 12.61, "max": 10.07, "min": 20.25, "cnt": 128}, "MoE_L0_fwd":{"total": 496.46, "avg": 15.51, "max": 10.92, "min": 20.17, "cnt": 32}, "MoEMLP":{"total": 1596.41, "avg": 12.47, "max": 9.95, "min": 20.12, "cnt": 128}, "MoE_L1_fwd":{"total": 377.18, "avg": 11.79, "max": 10.28, "min": 15.91, "cnt": 32}, "MoE_L2_fwd":{"total": 377.72, "avg": 11.80, "max": 11.07, "min": 15.39, "cnt": 32}, "MoE_L3_fwd":{"total": 351.67, "avg": 10.99, "max": 9.99, "min": 14.35, "cnt": 32}, "fwd-pooler":{"total": 0.37, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.64, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.14, "avg": 1.14, "max": 1.14, "min": 1.14, "cnt": 1}, "forward-send-backward-recv":{"total": 323.34, "avg": 10.43, "max": 1.56, "min": 54.61, "cnt": 31}, "backward-compute":{"total": 1460.64, "avg": 45.64, "max": 42.96, "min": 46.88, "cnt": 32}, "MoE_L3_bwd":{"total": 342.53, "avg": 10.70, "max": 9.49, "min": 12.04, "cnt": 32}, "MoE_L2_bwd":{"total": 333.86, "avg": 10.43, "max": 9.87, "min": 11.24, "cnt": 32}, "MoE_L1_bwd":{"total": 278.26, "avg": 8.70, "max": 8.12, "min": 10.29, "cnt": 32}, "MoE_L0_bwd":{"total": 285.02, "avg": 8.91, "max": 8.48, "min": 9.59, "cnt": 32}, "backward-send-forward-recv":{"total": 1697.80, "avg": 56.59, "max": 1.89, "min": 324.35, "cnt": 30}, "backward-send":{"total": 2.06, "avg": 1.03, "max": 1.01, "min": 1.05, "cnt": 2}, "backward-recv":{"total": 75.78, "avg": 75.78, "max": 75.78, "min": 75.78, "cnt": 1}, "backward-params-all-reduce":{"total": 490.35, "avg": 490.35, "max": 490.35, "min": 490.35, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 278.94, "avg": 278.94, "max": 278.94, "min": 278.94, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 239.15, "avg": 239.15, "max": 239.15, "min": 239.15, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.25, "avg": 3.25, "max": 3.25, "min": 3.25, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 160, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 251.18, "avg": 125.59, "max": 1.02, "min": 250.16, "cnt": 2}, "forward-compute":{"total": 1844.88, "avg": 57.65, "max": 51.92, "min": 64.41, "cnt": 32}, "fwd-compute":{"total": 1841.15, "avg": 57.54, "max": 51.84, "min": 64.31, "cnt": 32}, "batch-generator":{"total": 49.49, "avg": 1.55, "max": 0.84, "min": 2.80, "cnt": 32}, "fwd-embedding":{"total": 0.75, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1777.31, "avg": 55.54, "max": 49.98, "min": 62.86, "cnt": 32}, "fwd-layernorm":{"total": 11.54, "avg": 0.09, "max": 0.06, "min": 0.24, "cnt": 128}, "fwd-attn":{"total": 119.20, "avg": 0.93, "max": 0.75, "min": 1.88, "cnt": 128}, "fwd-misc":{"total": 24.02, "avg": 0.19, "max": 0.12, "min": 0.52, "cnt": 128}, "fwd-MLP":{"total": 1597.31, "avg": 12.48, "max": 10.02, "min": 20.10, "cnt": 128}, "MoE_L0_fwd":{"total": 501.82, "avg": 15.68, "max": 11.70, "min": 19.98, "cnt": 32}, "MoEMLP":{"total": 1578.01, "avg": 12.33, "max": 9.91, "min": 19.91, "cnt": 128}, "MoE_L1_fwd":{"total": 370.10, "avg": 11.57, "max": 10.42, "min": 15.27, "cnt": 32}, "MoE_L2_fwd":{"total": 371.46, "avg": 11.61, "max": 10.99, "min": 13.04, "cnt": 32}, "MoE_L3_fwd":{"total": 341.54, "avg": 10.67, "max": 9.95, "min": 12.98, "cnt": 32}, "fwd-pooler":{"total": 0.38, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.65, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.64, "avg": 1.64, "max": 1.64, "min": 1.64, "cnt": 1}, "forward-send-backward-recv":{"total": 441.87, "avg": 14.25, "max": 1.47, "min": 177.12, "cnt": 31}, "backward-compute":{"total": 1473.62, "avg": 46.05, "max": 43.46, "min": 50.23, "cnt": 32}, "MoE_L3_bwd":{"total": 342.56, "avg": 10.70, "max": 9.59, "min": 12.03, "cnt": 32}, "MoE_L2_bwd":{"total": 343.83, "avg": 10.74, "max": 9.78, "min": 12.51, "cnt": 32}, "MoE_L1_bwd":{"total": 282.11, "avg": 8.82, "max": 8.31, "min": 10.06, "cnt": 32}, "MoE_L0_bwd":{"total": 288.88, "avg": 9.03, "max": 8.68, "min": 9.34, "cnt": 32}, "backward-send-forward-recv":{"total": 1221.22, "avg": 40.71, "max": 2.16, "min": 215.43, "cnt": 30}, "backward-send":{"total": 2.00, "avg": 1.00, "max": 0.98, "min": 1.02, "cnt": 2}, "backward-recv":{"total": 77.60, "avg": 77.60, "max": 77.60, "min": 77.60, "cnt": 1}, "backward-params-all-reduce":{"total": 490.46, "avg": 490.46, "max": 490.46, "min": 490.46, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 273.39, "avg": 273.39, "max": 273.39, "min": 273.39, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 233.40, "avg": 233.40, "max": 233.40, "min": 233.40, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.31, "avg": 3.31, "max": 3.31, "min": 3.31, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.54, "avg": 3.54, "max": 3.54, "min": 3.54, "cnt": 1}}}
{"type":"time", "iteration": 161, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 124.51, "avg": 62.25, "max": 1.59, "min": 122.92, "cnt": 2}, "forward-compute":{"total": 1804.78, "avg": 56.40, "max": 49.62, "min": 62.60, "cnt": 32}, "fwd-compute":{"total": 1801.38, "avg": 56.29, "max": 49.54, "min": 62.47, "cnt": 32}, "batch-generator":{"total": 49.91, "avg": 1.56, "max": 0.77, "min": 4.00, "cnt": 32}, "fwd-embedding":{"total": 0.76, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1737.26, "avg": 54.29, "max": 48.30, "min": 60.34, "cnt": 32}, "fwd-layernorm":{"total": 11.13, "avg": 0.09, "max": 0.06, "min": 0.27, "cnt": 128}, "fwd-attn":{"total": 114.99, "avg": 0.90, "max": 0.75, "min": 2.00, "cnt": 128}, "fwd-misc":{"total": 23.20, "avg": 0.18, "max": 0.12, "min": 0.46, "cnt": 128}, "fwd-MLP":{"total": 1563.42, "avg": 12.21, "max": 10.00, "min": 18.95, "cnt": 128}, "MoE_L0_fwd":{"total": 475.38, "avg": 14.86, "max": 11.27, "min": 18.86, "cnt": 32}, "MoEMLP":{"total": 1544.85, "avg": 12.07, "max": 9.88, "min": 18.82, "cnt": 128}, "MoE_L1_fwd":{"total": 359.25, "avg": 11.23, "max": 10.30, "min": 13.27, "cnt": 32}, "MoE_L2_fwd":{"total": 371.32, "avg": 11.60, "max": 11.00, "min": 15.12, "cnt": 32}, "MoE_L3_fwd":{"total": 345.62, "avg": 10.80, "max": 9.93, "min": 11.78, "cnt": 32}, "fwd-pooler":{"total": 0.37, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.61, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 0.98, "avg": 0.98, "max": 0.98, "min": 0.98, "cnt": 1}, "forward-send-backward-recv":{"total": 267.99, "avg": 8.64, "max": 1.35, "min": 61.54, "cnt": 31}, "backward-compute":{"total": 1480.62, "avg": 46.27, "max": 44.21, "min": 49.35, "cnt": 32}, "MoE_L3_bwd":{"total": 352.28, "avg": 11.01, "max": 10.24, "min": 12.12, "cnt": 32}, "MoE_L2_bwd":{"total": 339.45, "avg": 10.61, "max": 9.91, "min": 11.62, "cnt": 32}, "MoE_L1_bwd":{"total": 281.74, "avg": 8.80, "max": 8.29, "min": 9.79, "cnt": 32}, "MoE_L0_bwd":{"total": 286.24, "avg": 8.94, "max": 8.35, "min": 11.96, "cnt": 32}, "backward-send-forward-recv":{"total": 1403.92, "avg": 46.80, "max": 1.96, "min": 241.35, "cnt": 30}, "backward-send":{"total": 2.18, "avg": 1.09, "max": 1.06, "min": 1.12, "cnt": 2}, "backward-recv":{"total": 70.12, "avg": 70.12, "max": 70.12, "min": 70.12, "cnt": 1}, "backward-params-all-reduce":{"total": 488.26, "avg": 488.26, "max": 488.26, "min": 488.26, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 274.88, "avg": 274.88, "max": 274.88, "min": 274.88, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 235.04, "avg": 235.04, "max": 235.04, "min": 235.04, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.31, "avg": 3.31, "max": 3.31, "min": 3.31, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.50, "avg": 3.50, "max": 3.50, "min": 3.50, "cnt": 1}}}
{"type":"time", "iteration": 162, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.10, "avg": 0.10, "max": 0.10, "min": 0.10, "cnt": 1}, "forward-recv":{"total": 123.72, "avg": 61.86, "max": 1.08, "min": 122.64, "cnt": 2}, "forward-compute":{"total": 1873.53, "avg": 58.55, "max": 50.64, "min": 67.19, "cnt": 32}, "fwd-compute":{"total": 1869.95, "avg": 58.44, "max": 50.56, "min": 67.05, "cnt": 32}, "batch-generator":{"total": 48.54, "avg": 1.52, "max": 0.75, "min": 2.97, "cnt": 32}, "fwd-embedding":{"total": 0.73, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1806.51, "avg": 56.45, "max": 49.37, "min": 64.80, "cnt": 32}, "fwd-layernorm":{"total": 11.89, "avg": 0.09, "max": 0.06, "min": 0.25, "cnt": 128}, "fwd-attn":{"total": 120.49, "avg": 0.94, "max": 0.75, "min": 1.92, "cnt": 128}, "fwd-misc":{"total": 26.60, "avg": 0.21, "max": 0.12, "min": 1.73, "cnt": 128}, "fwd-MLP":{"total": 1621.69, "avg": 12.67, "max": 10.18, "min": 20.07, "cnt": 128}, "MoE_L0_fwd":{"total": 497.09, "avg": 15.53, "max": 11.43, "min": 19.95, "cnt": 32}, "MoEMLP":{"total": 1601.63, "avg": 12.51, "max": 10.06, "min": 19.90, "cnt": 128}, "MoE_L1_fwd":{"total": 369.30, "avg": 11.54, "max": 10.49, "min": 13.75, "cnt": 32}, "MoE_L2_fwd":{"total": 379.03, "avg": 11.84, "max": 11.24, "min": 14.39, "cnt": 32}, "MoE_L3_fwd":{"total": 363.50, "avg": 11.36, "max": 10.10, "min": 14.55, "cnt": 32}, "fwd-pooler":{"total": 0.39, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.66, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.14, "avg": 1.14, "max": 1.14, "min": 1.14, "cnt": 1}, "forward-send-backward-recv":{"total": 616.29, "avg": 19.88, "max": 1.28, "min": 127.18, "cnt": 31}, "backward-compute":{"total": 1477.15, "avg": 46.16, "max": 43.97, "min": 47.30, "cnt": 32}, "MoE_L3_bwd":{"total": 358.11, "avg": 11.19, "max": 10.46, "min": 12.33, "cnt": 32}, "MoE_L2_bwd":{"total": 338.37, "avg": 10.57, "max": 9.84, "min": 11.48, "cnt": 32}, "MoE_L1_bwd":{"total": 278.40, "avg": 8.70, "max": 8.29, "min": 9.25, "cnt": 32}, "MoE_L0_bwd":{"total": 277.69, "avg": 8.68, "max": 8.23, "min": 9.29, "cnt": 32}, "backward-send-forward-recv":{"total": 2007.99, "avg": 66.93, "max": 1.92, "min": 298.50, "cnt": 30}, "backward-send":{"total": 2.20, "avg": 1.10, "max": 1.06, "min": 1.14, "cnt": 2}, "backward-recv":{"total": 70.27, "avg": 70.27, "max": 70.27, "min": 70.27, "cnt": 1}, "backward-params-all-reduce":{"total": 487.39, "avg": 487.39, "max": 487.39, "min": 487.39, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 280.33, "avg": 280.33, "max": 280.33, "min": 280.33, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.41, "avg": 3.41, "max": 3.41, "min": 3.41, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 239.84, "avg": 239.84, "max": 239.84, "min": 239.84, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.79, "avg": 3.79, "max": 3.79, "min": 3.79, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.54, "avg": 3.54, "max": 3.54, "min": 3.54, "cnt": 1}}}
{"type":"time", "iteration": 163, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.10, "avg": 0.10, "max": 0.10, "min": 0.10, "cnt": 1}, "forward-recv":{"total": 122.61, "avg": 61.31, "max": 1.21, "min": 121.41, "cnt": 2}, "forward-compute":{"total": 1955.51, "avg": 61.11, "max": 55.69, "min": 69.99, "cnt": 32}, "fwd-compute":{"total": 1950.96, "avg": 60.97, "max": 55.57, "min": 69.84, "cnt": 32}, "batch-generator":{"total": 63.33, "avg": 1.98, "max": 1.01, "min": 3.72, "cnt": 32}, "fwd-embedding":{"total": 1.04, "avg": 0.03, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1868.95, "avg": 58.40, "max": 51.35, "min": 66.81, "cnt": 32}, "fwd-layernorm":{"total": 17.07, "avg": 0.13, "max": 0.07, "min": 2.91, "cnt": 128}, "fwd-attn":{"total": 136.73, "avg": 1.07, "max": 0.77, "min": 2.93, "cnt": 128}, "fwd-misc":{"total": 29.48, "avg": 0.23, "max": 0.14, "min": 0.48, "cnt": 128}, "fwd-MLP":{"total": 1655.65, "avg": 12.93, "max": 10.60, "min": 19.60, "cnt": 128}, "MoE_L0_fwd":{"total": 494.56, "avg": 15.46, "max": 11.35, "min": 19.50, "cnt": 32}, "MoEMLP":{"total": 1632.68, "avg": 12.76, "max": 10.46, "min": 19.45, "cnt": 128}, "MoE_L1_fwd":{"total": 374.74, "avg": 11.71, "max": 10.74, "min": 14.81, "cnt": 32}, "MoE_L2_fwd":{"total": 397.00, "avg": 12.41, "max": 11.04, "min": 17.64, "cnt": 32}, "MoE_L3_fwd":{"total": 374.92, "avg": 11.72, "max": 10.52, "min": 15.10, "cnt": 32}, "fwd-pooler":{"total": 0.44, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.73, "avg": 0.02, "max": 0.02, "min": 0.04, "cnt": 32}, "forward-send":{"total": 1.14, "avg": 1.14, "max": 1.14, "min": 1.14, "cnt": 1}, "forward-send-backward-recv":{"total": 952.37, "avg": 30.72, "max": 1.71, "min": 151.96, "cnt": 31}, "backward-compute":{"total": 1480.72, "avg": 46.27, "max": 44.23, "min": 48.86, "cnt": 32}, "MoE_L3_bwd":{"total": 360.34, "avg": 11.26, "max": 10.64, "min": 12.62, "cnt": 32}, "MoE_L2_bwd":{"total": 327.73, "avg": 10.24, "max": 9.41, "min": 11.10, "cnt": 32}, "MoE_L1_bwd":{"total": 279.80, "avg": 8.74, "max": 8.18, "min": 9.69, "cnt": 32}, "MoE_L0_bwd":{"total": 284.61, "avg": 8.89, "max": 8.34, "min": 11.71, "cnt": 32}, "backward-send-forward-recv":{"total": 229.34, "avg": 7.64, "max": 2.19, "min": 68.18, "cnt": 30}, "backward-send":{"total": 2.25, "avg": 1.12, "max": 1.09, "min": 1.16, "cnt": 2}, "backward-recv":{"total": 89.31, "avg": 89.31, "max": 89.31, "min": 89.31, "cnt": 1}, "backward-params-all-reduce":{"total": 489.08, "avg": 489.08, "max": 489.08, "min": 489.08, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 285.46, "avg": 285.46, "max": 285.46, "min": 285.46, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.40, "avg": 3.40, "max": 3.40, "min": 3.40, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 238.89, "avg": 238.89, "max": 238.89, "min": 238.89, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.56, "avg": 3.56, "max": 3.56, "min": 3.56, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.47, "avg": 3.47, "max": 3.47, "min": 3.47, "cnt": 1}}}
{"type":"time", "iteration": 164, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 119.69, "avg": 59.85, "max": 5.54, "min": 114.15, "cnt": 2}, "forward-compute":{"total": 1898.58, "avg": 59.33, "max": 52.08, "min": 65.46, "cnt": 32}, "fwd-compute":{"total": 1894.64, "avg": 59.21, "max": 51.99, "min": 65.32, "cnt": 32}, "batch-generator":{"total": 50.91, "avg": 1.59, "max": 0.90, "min": 2.12, "cnt": 32}, "fwd-embedding":{"total": 0.87, "avg": 0.03, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1828.11, "avg": 57.13, "max": 50.67, "min": 62.86, "cnt": 32}, "fwd-layernorm":{"total": 12.93, "avg": 0.10, "max": 0.06, "min": 0.22, "cnt": 128}, "fwd-attn":{"total": 125.53, "avg": 0.98, "max": 0.75, "min": 1.81, "cnt": 128}, "fwd-misc":{"total": 27.07, "avg": 0.21, "max": 0.12, "min": 0.43, "cnt": 128}, "fwd-MLP":{"total": 1635.11, "avg": 12.77, "max": 10.12, "min": 17.52, "cnt": 128}, "MoE_L0_fwd":{"total": 489.45, "avg": 15.30, "max": 11.16, "min": 17.42, "cnt": 32}, "MoEMLP":{"total": 1613.35, "avg": 12.60, "max": 10.00, "min": 17.36, "cnt": 128}, "MoE_L1_fwd":{"total": 380.00, "avg": 11.88, "max": 10.74, "min": 13.53, "cnt": 32}, "MoE_L2_fwd":{"total": 392.90, "avg": 12.28, "max": 11.37, "min": 14.67, "cnt": 32}, "MoE_L3_fwd":{"total": 358.89, "avg": 11.22, "max": 10.05, "min": 14.19, "cnt": 32}, "fwd-pooler":{"total": 0.39, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.67, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 0.68, "avg": 0.68, "max": 0.68, "min": 0.68, "cnt": 1}, "forward-send-backward-recv":{"total": 847.38, "avg": 27.33, "max": 1.82, "min": 137.16, "cnt": 31}, "backward-compute":{"total": 1480.85, "avg": 46.28, "max": 44.25, "min": 50.49, "cnt": 32}, "MoE_L3_bwd":{"total": 348.26, "avg": 10.88, "max": 9.48, "min": 12.75, "cnt": 32}, "MoE_L2_bwd":{"total": 344.11, "avg": 10.75, "max": 10.16, "min": 11.26, "cnt": 32}, "MoE_L1_bwd":{"total": 284.93, "avg": 8.90, "max": 8.45, "min": 10.46, "cnt": 32}, "MoE_L0_bwd":{"total": 279.97, "avg": 8.75, "max": 8.40, "min": 9.67, "cnt": 32}, "backward-send-forward-recv":{"total": 263.18, "avg": 8.77, "max": 1.97, "min": 124.10, "cnt": 30}, "backward-send":{"total": 2.06, "avg": 1.03, "max": 1.01, "min": 1.05, "cnt": 2}, "backward-recv":{"total": 76.17, "avg": 76.17, "max": 76.17, "min": 76.17, "cnt": 1}, "backward-params-all-reduce":{"total": 485.68, "avg": 485.68, "max": 485.68, "min": 485.68, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 285.73, "avg": 285.73, "max": 285.73, "min": 285.73, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 243.25, "avg": 243.25, "max": 243.25, "min": 243.25, "cnt": 1}, "optimizer-clip-main-grad":{"total": 5.85, "avg": 5.85, "max": 5.85, "min": 5.85, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.47, "avg": 3.47, "max": 3.47, "min": 3.47, "cnt": 1}}}
{"type":"time", "iteration": 165, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.11, "avg": 0.11, "max": 0.11, "min": 0.11, "cnt": 1}, "forward-recv":{"total": 116.46, "avg": 58.23, "max": 6.41, "min": 110.04, "cnt": 2}, "forward-compute":{"total": 1869.40, "avg": 58.42, "max": 50.20, "min": 65.26, "cnt": 32}, "fwd-compute":{"total": 1865.59, "avg": 58.30, "max": 50.11, "min": 65.17, "cnt": 32}, "batch-generator":{"total": 49.38, "avg": 1.54, "max": 0.78, "min": 2.34, "cnt": 32}, "fwd-embedding":{"total": 0.78, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1801.25, "avg": 56.29, "max": 48.87, "min": 63.91, "cnt": 32}, "fwd-layernorm":{"total": 12.14, "avg": 0.09, "max": 0.06, "min": 0.22, "cnt": 128}, "fwd-attn":{"total": 117.78, "avg": 0.92, "max": 0.75, "min": 1.55, "cnt": 128}, "fwd-misc":{"total": 25.48, "avg": 0.20, "max": 0.12, "min": 0.44, "cnt": 128}, "fwd-MLP":{"total": 1619.79, "avg": 12.65, "max": 10.16, "min": 21.61, "cnt": 128}, "MoE_L0_fwd":{"total": 508.29, "avg": 15.88, "max": 11.45, "min": 21.52, "cnt": 32}, "MoEMLP":{"total": 1599.68, "avg": 12.50, "max": 10.04, "min": 21.47, "cnt": 128}, "MoE_L1_fwd":{"total": 378.76, "avg": 11.84, "max": 10.50, "min": 15.99, "cnt": 32}, "MoE_L2_fwd":{"total": 376.39, "avg": 11.76, "max": 11.16, "min": 13.26, "cnt": 32}, "MoE_L3_fwd":{"total": 343.64, "avg": 10.74, "max": 10.08, "min": 12.62, "cnt": 32}, "fwd-pooler":{"total": 0.39, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.63, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 0.99, "avg": 0.99, "max": 0.99, "min": 0.99, "cnt": 1}, "forward-send-backward-recv":{"total": 510.43, "avg": 16.47, "max": 1.80, "min": 80.40, "cnt": 31}, "backward-compute":{"total": 1477.02, "avg": 46.16, "max": 43.82, "min": 53.34, "cnt": 32}, "MoE_L3_bwd":{"total": 347.82, "avg": 10.87, "max": 9.51, "min": 18.46, "cnt": 32}, "MoE_L2_bwd":{"total": 337.79, "avg": 10.56, "max": 9.73, "min": 11.59, "cnt": 32}, "MoE_L1_bwd":{"total": 276.56, "avg": 8.64, "max": 8.26, "min": 9.47, "cnt": 32}, "MoE_L0_bwd":{"total": 289.43, "avg": 9.04, "max": 8.25, "min": 10.65, "cnt": 32}, "backward-send-forward-recv":{"total": 1449.15, "avg": 48.31, "max": 2.00, "min": 532.98, "cnt": 30}, "backward-send":{"total": 2.05, "avg": 1.02, "max": 0.68, "min": 1.37, "cnt": 2}, "backward-recv":{"total": 70.45, "avg": 70.45, "max": 70.45, "min": 70.45, "cnt": 1}, "backward-params-all-reduce":{"total": 491.81, "avg": 491.81, "max": 491.81, "min": 491.81, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 277.10, "avg": 277.10, "max": 277.10, "min": 277.10, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 237.12, "avg": 237.12, "max": 237.12, "min": 237.12, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.40, "avg": 3.40, "max": 3.40, "min": 3.40, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.52, "avg": 3.52, "max": 3.52, "min": 3.52, "cnt": 1}}}
{"type":"time", "iteration": 166, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.10, "avg": 0.10, "max": 0.10, "min": 0.10, "cnt": 1}, "forward-recv":{"total": 122.90, "avg": 61.45, "max": 1.48, "min": 121.42, "cnt": 2}, "forward-compute":{"total": 1867.13, "avg": 58.35, "max": 49.84, "min": 66.21, "cnt": 32}, "fwd-compute":{"total": 1863.40, "avg": 58.23, "max": 49.76, "min": 66.08, "cnt": 32}, "batch-generator":{"total": 47.58, "avg": 1.49, "max": 0.78, "min": 3.04, "cnt": 32}, "fwd-embedding":{"total": 0.75, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1800.08, "avg": 56.25, "max": 48.55, "min": 64.19, "cnt": 32}, "fwd-layernorm":{"total": 11.98, "avg": 0.09, "max": 0.06, "min": 0.23, "cnt": 128}, "fwd-attn":{"total": 117.23, "avg": 0.92, "max": 0.75, "min": 2.26, "cnt": 128}, "fwd-misc":{"total": 24.95, "avg": 0.19, "max": 0.12, "min": 0.43, "cnt": 128}, "fwd-MLP":{"total": 1619.84, "avg": 12.65, "max": 10.11, "min": 19.97, "cnt": 128}, "MoE_L0_fwd":{"total": 485.45, "avg": 15.17, "max": 11.32, "min": 19.79, "cnt": 32}, "MoEMLP":{"total": 1599.90, "avg": 12.50, "max": 9.99, "min": 19.65, "cnt": 128}, "MoE_L1_fwd":{"total": 383.14, "avg": 11.97, "max": 10.58, "min": 14.80, "cnt": 32}, "MoE_L2_fwd":{"total": 385.45, "avg": 12.05, "max": 11.33, "min": 14.77, "cnt": 32}, "MoE_L3_fwd":{"total": 353.15, "avg": 11.04, "max": 10.04, "min": 14.29, "cnt": 32}, "fwd-pooler":{"total": 0.38, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.67, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 0.92, "avg": 0.92, "max": 0.92, "min": 0.92, "cnt": 1}, "forward-send-backward-recv":{"total": 383.06, "avg": 12.36, "max": 1.31, "min": 79.18, "cnt": 31}, "backward-compute":{"total": 1478.53, "avg": 46.20, "max": 43.80, "min": 49.87, "cnt": 32}, "MoE_L3_bwd":{"total": 342.21, "avg": 10.69, "max": 9.42, "min": 12.97, "cnt": 32}, "MoE_L2_bwd":{"total": 346.23, "avg": 10.82, "max": 10.20, "min": 14.30, "cnt": 32}, "MoE_L1_bwd":{"total": 280.87, "avg": 8.78, "max": 8.33, "min": 9.16, "cnt": 32}, "MoE_L0_bwd":{"total": 285.77, "avg": 8.93, "max": 8.62, "min": 9.56, "cnt": 32}, "backward-send-forward-recv":{"total": 1713.47, "avg": 57.12, "max": 1.95, "min": 548.32, "cnt": 30}, "backward-send":{"total": 1.94, "avg": 0.97, "max": 0.83, "min": 1.11, "cnt": 2}, "backward-recv":{"total": 65.29, "avg": 65.29, "max": 65.29, "min": 65.29, "cnt": 1}, "backward-params-all-reduce":{"total": 495.08, "avg": 495.08, "max": 495.08, "min": 495.08, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.04, "avg": 0.04, "max": 0.04, "min": 0.04, "cnt": 1}, "optimizer":{"total": 277.94, "avg": 277.94, "max": 277.94, "min": 277.94, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.40, "avg": 3.40, "max": 3.40, "min": 3.40, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 237.79, "avg": 237.79, "max": 237.79, "min": 237.79, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.34, "avg": 3.34, "max": 3.34, "min": 3.34, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.54, "avg": 3.54, "max": 3.54, "min": 3.54, "cnt": 1}}}
{"type":"time", "iteration": 167, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 128.70, "avg": 64.35, "max": 1.27, "min": 127.43, "cnt": 2}, "forward-compute":{"total": 1904.58, "avg": 59.52, "max": 53.05, "min": 67.77, "cnt": 32}, "fwd-compute":{"total": 1900.63, "avg": 59.39, "max": 52.94, "min": 67.58, "cnt": 32}, "batch-generator":{"total": 49.69, "avg": 1.55, "max": 0.82, "min": 2.58, "cnt": 32}, "fwd-embedding":{"total": 0.90, "avg": 0.03, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1835.32, "avg": 57.35, "max": 51.20, "min": 65.11, "cnt": 32}, "fwd-layernorm":{"total": 12.31, "avg": 0.10, "max": 0.06, "min": 0.26, "cnt": 128}, "fwd-attn":{"total": 118.92, "avg": 0.93, "max": 0.75, "min": 1.85, "cnt": 128}, "fwd-misc":{"total": 25.08, "avg": 0.20, "max": 0.12, "min": 0.41, "cnt": 128}, "fwd-MLP":{"total": 1652.66, "avg": 12.91, "max": 10.33, "min": 19.30, "cnt": 128}, "MoE_L0_fwd":{"total": 508.86, "avg": 15.90, "max": 11.41, "min": 19.17, "cnt": 32}, "MoEMLP":{"total": 1632.60, "avg": 12.75, "max": 10.19, "min": 19.12, "cnt": 128}, "MoE_L1_fwd":{"total": 385.58, "avg": 12.05, "max": 10.99, "min": 13.85, "cnt": 32}, "MoE_L2_fwd":{"total": 388.46, "avg": 12.14, "max": 11.25, "min": 16.42, "cnt": 32}, "MoE_L3_fwd":{"total": 357.07, "avg": 11.16, "max": 10.25, "min": 15.91, "cnt": 32}, "fwd-pooler":{"total": 0.38, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.66, "avg": 0.02, "max": 0.02, "min": 0.04, "cnt": 32}, "forward-send":{"total": 1.19, "avg": 1.19, "max": 1.19, "min": 1.19, "cnt": 1}, "forward-send-backward-recv":{"total": 819.29, "avg": 26.43, "max": 1.83, "min": 138.87, "cnt": 31}, "backward-compute":{"total": 1487.52, "avg": 46.49, "max": 44.57, "min": 49.66, "cnt": 32}, "MoE_L3_bwd":{"total": 348.29, "avg": 10.88, "max": 9.77, "min": 14.61, "cnt": 32}, "MoE_L2_bwd":{"total": 350.51, "avg": 10.95, "max": 9.96, "min": 11.63, "cnt": 32}, "MoE_L1_bwd":{"total": 292.12, "avg": 9.13, "max": 8.46, "min": 10.62, "cnt": 32}, "MoE_L0_bwd":{"total": 282.65, "avg": 8.83, "max": 8.39, "min": 9.68, "cnt": 32}, "backward-send-forward-recv":{"total": 370.84, "avg": 12.36, "max": 2.08, "min": 197.36, "cnt": 30}, "backward-send":{"total": 2.20, "avg": 1.10, "max": 1.02, "min": 1.19, "cnt": 2}, "backward-recv":{"total": 72.73, "avg": 72.73, "max": 72.73, "min": 72.73, "cnt": 1}, "backward-params-all-reduce":{"total": 489.99, "avg": 489.99, "max": 489.99, "min": 489.99, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 281.25, "avg": 281.25, "max": 281.25, "min": 281.25, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 241.16, "avg": 241.16, "max": 241.16, "min": 241.16, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.52, "avg": 3.52, "max": 3.52, "min": 3.52, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.48, "avg": 3.48, "max": 3.48, "min": 3.48, "cnt": 1}}}
{"type":"time", "iteration": 168, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.11, "avg": 0.11, "max": 0.11, "min": 0.11, "cnt": 1}, "forward-recv":{"total": 123.95, "avg": 61.98, "max": 0.85, "min": 123.11, "cnt": 2}, "forward-compute":{"total": 1905.09, "avg": 59.53, "max": 53.81, "min": 67.45, "cnt": 32}, "fwd-compute":{"total": 1900.61, "avg": 59.39, "max": 53.71, "min": 67.34, "cnt": 32}, "batch-generator":{"total": 46.34, "avg": 1.45, "max": 0.71, "min": 2.13, "cnt": 32}, "fwd-embedding":{"total": 0.80, "avg": 0.03, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1839.45, "avg": 57.48, "max": 52.38, "min": 65.66, "cnt": 32}, "fwd-layernorm":{"total": 12.19, "avg": 0.10, "max": 0.06, "min": 0.22, "cnt": 128}, "fwd-attn":{"total": 123.16, "avg": 0.96, "max": 0.75, "min": 2.61, "cnt": 128}, "fwd-misc":{"total": 25.44, "avg": 0.20, "max": 0.12, "min": 0.45, "cnt": 128}, "fwd-MLP":{"total": 1652.00, "avg": 12.91, "max": 10.66, "min": 20.51, "cnt": 128}, "MoE_L0_fwd":{"total": 486.03, "avg": 15.19, "max": 11.79, "min": 20.35, "cnt": 32}, "MoEMLP":{"total": 1631.01, "avg": 12.74, "max": 10.54, "min": 20.30, "cnt": 128}, "MoE_L1_fwd":{"total": 382.76, "avg": 11.96, "max": 10.58, "min": 16.19, "cnt": 32}, "MoE_L2_fwd":{"total": 397.50, "avg": 12.42, "max": 11.54, "min": 14.97, "cnt": 32}, "MoE_L3_fwd":{"total": 372.32, "avg": 11.63, "max": 10.66, "min": 13.85, "cnt": 32}, "fwd-pooler":{"total": 0.38, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.65, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 0.71, "avg": 0.71, "max": 0.71, "min": 0.71, "cnt": 1}, "forward-send-backward-recv":{"total": 432.32, "avg": 13.95, "max": 1.67, "min": 71.04, "cnt": 31}, "backward-compute":{"total": 1519.77, "avg": 47.49, "max": 43.83, "min": 49.56, "cnt": 32}, "MoE_L3_bwd":{"total": 377.15, "avg": 11.79, "max": 10.52, "min": 13.84, "cnt": 32}, "MoE_L2_bwd":{"total": 351.58, "avg": 10.99, "max": 10.02, "min": 12.22, "cnt": 32}, "MoE_L1_bwd":{"total": 283.84, "avg": 8.87, "max": 8.21, "min": 9.47, "cnt": 32}, "MoE_L0_bwd":{"total": 284.88, "avg": 8.90, "max": 8.18, "min": 9.64, "cnt": 32}, "backward-send-forward-recv":{"total": 375.91, "avg": 12.53, "max": 1.99, "min": 86.90, "cnt": 30}, "backward-send":{"total": 1.84, "avg": 0.92, "max": 0.84, "min": 1.00, "cnt": 2}, "backward-recv":{"total": 73.71, "avg": 73.71, "max": 73.71, "min": 73.71, "cnt": 1}, "backward-params-all-reduce":{"total": 488.01, "avg": 488.01, "max": 488.01, "min": 488.01, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.04, "avg": 0.04, "max": 0.04, "min": 0.04, "cnt": 1}, "optimizer":{"total": 286.09, "avg": 286.09, "max": 286.09, "min": 286.09, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.40, "avg": 3.40, "max": 3.40, "min": 3.40, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 245.32, "avg": 245.32, "max": 245.32, "min": 245.32, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.88, "avg": 3.88, "max": 3.88, "min": 3.88, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.58, "avg": 3.58, "max": 3.58, "min": 3.58, "cnt": 1}}}
{"type":"time", "iteration": 169, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 126.01, "avg": 63.01, "max": 1.32, "min": 124.70, "cnt": 2}, "forward-compute":{"total": 1866.07, "avg": 58.31, "max": 51.01, "min": 66.35, "cnt": 32}, "fwd-compute":{"total": 1862.38, "avg": 58.20, "max": 50.93, "min": 66.22, "cnt": 32}, "batch-generator":{"total": 47.45, "avg": 1.48, "max": 0.79, "min": 2.35, "cnt": 32}, "fwd-embedding":{"total": 0.82, "avg": 0.03, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1800.44, "avg": 56.26, "max": 49.76, "min": 63.96, "cnt": 32}, "fwd-layernorm":{"total": 11.98, "avg": 0.09, "max": 0.06, "min": 0.23, "cnt": 128}, "fwd-attn":{"total": 118.21, "avg": 0.92, "max": 0.75, "min": 1.70, "cnt": 128}, "fwd-misc":{"total": 24.71, "avg": 0.19, "max": 0.12, "min": 0.43, "cnt": 128}, "fwd-MLP":{"total": 1619.85, "avg": 12.66, "max": 10.08, "min": 18.50, "cnt": 128}, "MoE_L0_fwd":{"total": 480.22, "avg": 15.01, "max": 11.73, "min": 18.42, "cnt": 32}, "MoEMLP":{"total": 1600.20, "avg": 12.50, "max": 9.96, "min": 18.38, "cnt": 128}, "MoE_L1_fwd":{"total": 370.11, "avg": 11.57, "max": 10.23, "min": 14.54, "cnt": 32}, "MoE_L2_fwd":{"total": 389.96, "avg": 12.19, "max": 11.42, "min": 16.14, "cnt": 32}, "MoE_L3_fwd":{"total": 367.10, "avg": 11.47, "max": 10.00, "min": 16.29, "cnt": 32}, "fwd-pooler":{"total": 0.37, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.64, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.04, "avg": 1.04, "max": 1.04, "min": 1.04, "cnt": 1}, "forward-send-backward-recv":{"total": 563.48, "avg": 18.18, "max": 1.84, "min": 83.94, "cnt": 31}, "backward-compute":{"total": 1500.66, "avg": 46.90, "max": 45.72, "min": 50.78, "cnt": 32}, "MoE_L3_bwd":{"total": 360.20, "avg": 11.26, "max": 10.39, "min": 14.93, "cnt": 32}, "MoE_L2_bwd":{"total": 353.97, "avg": 11.06, "max": 10.44, "min": 11.86, "cnt": 32}, "MoE_L1_bwd":{"total": 284.46, "avg": 8.89, "max": 8.31, "min": 9.81, "cnt": 32}, "MoE_L0_bwd":{"total": 283.54, "avg": 8.86, "max": 8.44, "min": 9.29, "cnt": 32}, "backward-send-forward-recv":{"total": 651.97, "avg": 21.73, "max": 2.07, "min": 134.88, "cnt": 30}, "backward-send":{"total": 1.90, "avg": 0.95, "max": 0.87, "min": 1.04, "cnt": 2}, "backward-recv":{"total": 75.58, "avg": 75.58, "max": 75.58, "min": 75.58, "cnt": 1}, "backward-params-all-reduce":{"total": 489.52, "avg": 489.52, "max": 489.52, "min": 489.52, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 279.29, "avg": 279.29, "max": 279.29, "min": 279.29, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 239.43, "avg": 239.43, "max": 239.43, "min": 239.43, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.33, "avg": 3.33, "max": 3.33, "min": 3.33, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 170, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 141.30, "avg": 70.65, "max": 1.28, "min": 140.03, "cnt": 2}, "forward-compute":{"total": 1908.54, "avg": 59.64, "max": 53.52, "min": 68.94, "cnt": 32}, "fwd-compute":{"total": 1904.48, "avg": 59.51, "max": 53.41, "min": 68.79, "cnt": 32}, "batch-generator":{"total": 49.06, "avg": 1.53, "max": 0.73, "min": 2.10, "cnt": 32}, "fwd-embedding":{"total": 0.86, "avg": 0.03, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1840.20, "avg": 57.51, "max": 50.88, "min": 66.53, "cnt": 32}, "fwd-layernorm":{"total": 12.28, "avg": 0.10, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 121.40, "avg": 0.95, "max": 0.75, "min": 1.92, "cnt": 128}, "fwd-misc":{"total": 25.30, "avg": 0.20, "max": 0.12, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1654.45, "avg": 12.93, "max": 10.00, "min": 19.03, "cnt": 128}, "MoE_L0_fwd":{"total": 495.18, "avg": 15.47, "max": 11.14, "min": 18.40, "cnt": 32}, "MoEMLP":{"total": 1633.88, "avg": 12.76, "max": 9.88, "min": 18.86, "cnt": 128}, "MoE_L1_fwd":{"total": 385.38, "avg": 12.04, "max": 11.10, "min": 14.39, "cnt": 32}, "MoE_L2_fwd":{"total": 409.03, "avg": 12.78, "max": 11.63, "min": 18.93, "cnt": 32}, "MoE_L3_fwd":{"total": 351.70, "avg": 10.99, "max": 9.93, "min": 13.28, "cnt": 32}, "fwd-pooler":{"total": 0.41, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.64, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 0.95, "avg": 0.95, "max": 0.95, "min": 0.95, "cnt": 1}, "forward-send-backward-recv":{"total": 579.66, "avg": 18.70, "max": 1.85, "min": 108.94, "cnt": 31}, "backward-compute":{"total": 1511.63, "avg": 47.24, "max": 45.14, "min": 57.52, "cnt": 32}, "MoE_L3_bwd":{"total": 372.33, "avg": 11.64, "max": 10.03, "min": 22.15, "cnt": 32}, "MoE_L2_bwd":{"total": 354.34, "avg": 11.07, "max": 10.27, "min": 11.78, "cnt": 32}, "MoE_L1_bwd":{"total": 282.57, "avg": 8.83, "max": 8.41, "min": 10.42, "cnt": 32}, "MoE_L0_bwd":{"total": 282.53, "avg": 8.83, "max": 8.15, "min": 10.04, "cnt": 32}, "backward-send-forward-recv":{"total": 175.75, "avg": 5.86, "max": 1.87, "min": 65.53, "cnt": 30}, "backward-send":{"total": 1.86, "avg": 0.93, "max": 0.90, "min": 0.96, "cnt": 2}, "backward-recv":{"total": 143.23, "avg": 143.23, "max": 143.23, "min": 143.23, "cnt": 1}, "backward-params-all-reduce":{"total": 489.47, "avg": 489.47, "max": 489.47, "min": 489.47, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 272.00, "avg": 272.00, "max": 272.00, "min": 272.00, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 232.23, "avg": 232.23, "max": 232.23, "min": 232.23, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.32, "avg": 3.32, "max": 3.32, "min": 3.32, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.48, "avg": 3.48, "max": 3.48, "min": 3.48, "cnt": 1}}}
{"type":"time", "iteration": 171, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.11, "avg": 0.11, "max": 0.11, "min": 0.11, "cnt": 1}, "forward-recv":{"total": 124.22, "avg": 62.11, "max": 1.26, "min": 122.96, "cnt": 2}, "forward-compute":{"total": 1943.01, "avg": 60.72, "max": 54.73, "min": 69.70, "cnt": 32}, "fwd-compute":{"total": 1938.76, "avg": 60.59, "max": 54.63, "min": 69.57, "cnt": 32}, "batch-generator":{"total": 50.96, "avg": 1.59, "max": 0.77, "min": 2.87, "cnt": 32}, "fwd-embedding":{"total": 0.92, "avg": 0.03, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1871.86, "avg": 58.50, "max": 53.33, "min": 67.28, "cnt": 32}, "fwd-layernorm":{"total": 12.65, "avg": 0.10, "max": 0.06, "min": 0.26, "cnt": 128}, "fwd-attn":{"total": 124.14, "avg": 0.97, "max": 0.75, "min": 2.04, "cnt": 128}, "fwd-misc":{"total": 25.72, "avg": 0.20, "max": 0.12, "min": 0.48, "cnt": 128}, "fwd-MLP":{"total": 1682.39, "avg": 13.14, "max": 10.66, "min": 20.43, "cnt": 128}, "MoE_L0_fwd":{"total": 507.66, "avg": 15.86, "max": 12.36, "min": 20.35, "cnt": 32}, "MoEMLP":{"total": 1661.47, "avg": 12.98, "max": 10.54, "min": 20.30, "cnt": 128}, "MoE_L1_fwd":{"total": 390.72, "avg": 12.21, "max": 10.59, "min": 17.83, "cnt": 32}, "MoE_L2_fwd":{"total": 397.82, "avg": 12.43, "max": 11.37, "min": 15.55, "cnt": 32}, "MoE_L3_fwd":{"total": 372.72, "avg": 11.65, "max": 10.58, "min": 15.29, "cnt": 32}, "fwd-pooler":{"total": 0.38, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.65, "avg": 0.02, "max": 0.02, "min": 0.04, "cnt": 32}, "forward-send":{"total": 1.04, "avg": 1.04, "max": 1.04, "min": 1.04, "cnt": 1}, "forward-send-backward-recv":{"total": 561.17, "avg": 18.10, "max": 1.38, "min": 75.31, "cnt": 31}, "backward-compute":{"total": 1521.15, "avg": 47.54, "max": 44.93, "min": 50.04, "cnt": 32}, "MoE_L3_bwd":{"total": 378.51, "avg": 11.83, "max": 9.29, "min": 13.85, "cnt": 32}, "MoE_L2_bwd":{"total": 345.39, "avg": 10.79, "max": 9.98, "min": 11.23, "cnt": 32}, "MoE_L1_bwd":{"total": 279.41, "avg": 8.73, "max": 8.19, "min": 9.45, "cnt": 32}, "MoE_L0_bwd":{"total": 283.67, "avg": 8.86, "max": 8.41, "min": 10.48, "cnt": 32}, "backward-send-forward-recv":{"total": 162.74, "avg": 5.42, "max": 1.72, "min": 60.69, "cnt": 30}, "backward-send":{"total": 2.27, "avg": 1.13, "max": 1.05, "min": 1.21, "cnt": 2}, "backward-recv":{"total": 99.53, "avg": 99.53, "max": 99.53, "min": 99.53, "cnt": 1}, "backward-params-all-reduce":{"total": 490.08, "avg": 490.08, "max": 490.08, "min": 490.08, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 292.11, "avg": 292.11, "max": 292.11, "min": 292.11, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.40, "avg": 3.40, "max": 3.40, "min": 3.40, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 246.91, "avg": 246.91, "max": 246.91, "min": 246.91, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.77, "avg": 3.77, "max": 3.77, "min": 3.77, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.52, "avg": 3.52, "max": 3.52, "min": 3.52, "cnt": 1}}}
{"type":"time", "iteration": 172, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.12, "avg": 0.12, "max": 0.12, "min": 0.12, "cnt": 1}, "forward-recv":{"total": 128.33, "avg": 64.17, "max": 6.43, "min": 121.90, "cnt": 2}, "forward-compute":{"total": 1942.16, "avg": 60.69, "max": 52.53, "min": 66.75, "cnt": 32}, "fwd-compute":{"total": 1938.22, "avg": 60.57, "max": 52.45, "min": 66.66, "cnt": 32}, "batch-generator":{"total": 46.86, "avg": 1.46, "max": 0.78, "min": 1.96, "cnt": 32}, "fwd-embedding":{"total": 0.81, "avg": 0.03, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1875.35, "avg": 58.60, "max": 51.28, "min": 65.28, "cnt": 32}, "fwd-layernorm":{"total": 11.97, "avg": 0.09, "max": 0.06, "min": 0.23, "cnt": 128}, "fwd-attn":{"total": 117.24, "avg": 0.92, "max": 0.75, "min": 1.92, "cnt": 128}, "fwd-misc":{"total": 24.32, "avg": 0.19, "max": 0.11, "min": 0.43, "cnt": 128}, "fwd-MLP":{"total": 1696.31, "avg": 13.25, "max": 10.37, "min": 20.17, "cnt": 128}, "MoE_L0_fwd":{"total": 520.38, "avg": 16.26, "max": 11.28, "min": 20.09, "cnt": 32}, "MoEMLP":{"total": 1676.82, "avg": 13.10, "max": 10.26, "min": 20.05, "cnt": 128}, "MoE_L1_fwd":{"total": 382.09, "avg": 11.94, "max": 10.49, "min": 14.34, "cnt": 32}, "MoE_L2_fwd":{"total": 406.97, "avg": 12.72, "max": 11.35, "min": 18.64, "cnt": 32}, "MoE_L3_fwd":{"total": 374.52, "avg": 11.70, "max": 10.30, "min": 18.28, "cnt": 32}, "fwd-pooler":{"total": 0.42, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.70, "avg": 0.02, "max": 0.02, "min": 0.06, "cnt": 32}, "forward-send":{"total": 1.01, "avg": 1.01, "max": 1.01, "min": 1.01, "cnt": 1}, "forward-send-backward-recv":{"total": 819.72, "avg": 26.44, "max": 1.10, "min": 144.92, "cnt": 31}, "backward-compute":{"total": 1507.69, "avg": 47.12, "max": 45.45, "min": 48.57, "cnt": 32}, "MoE_L3_bwd":{"total": 357.08, "avg": 11.16, "max": 10.07, "min": 12.66, "cnt": 32}, "MoE_L2_bwd":{"total": 353.87, "avg": 11.06, "max": 10.03, "min": 12.31, "cnt": 32}, "MoE_L1_bwd":{"total": 288.86, "avg": 9.03, "max": 8.38, "min": 9.62, "cnt": 32}, "MoE_L0_bwd":{"total": 284.21, "avg": 8.88, "max": 8.50, "min": 9.29, "cnt": 32}, "backward-send-forward-recv":{"total": 654.48, "avg": 21.82, "max": 1.92, "min": 110.36, "cnt": 30}, "backward-send":{"total": 2.00, "avg": 1.00, "max": 0.92, "min": 1.08, "cnt": 2}, "backward-recv":{"total": 75.65, "avg": 75.65, "max": 75.65, "min": 75.65, "cnt": 1}, "backward-params-all-reduce":{"total": 486.05, "avg": 486.05, "max": 486.05, "min": 486.05, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 284.24, "avg": 284.24, "max": 284.24, "min": 284.24, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 244.13, "avg": 244.13, "max": 244.13, "min": 244.13, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.48, "avg": 3.48, "max": 3.48, "min": 3.48, "cnt": 1}}}
{"type":"time", "iteration": 173, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 120.98, "avg": 60.49, "max": 1.73, "min": 119.25, "cnt": 2}, "forward-compute":{"total": 1940.31, "avg": 60.63, "max": 50.99, "min": 135.25, "cnt": 32}, "fwd-compute":{"total": 1936.70, "avg": 60.52, "max": 50.91, "min": 135.13, "cnt": 32}, "batch-generator":{"total": 45.81, "avg": 1.43, "max": 0.74, "min": 2.42, "cnt": 32}, "fwd-embedding":{"total": 0.78, "avg": 0.02, "max": 0.01, "min": 0.06, "cnt": 32}, "fwd-encoder":{"total": 1876.67, "avg": 58.65, "max": 49.58, "min": 133.16, "cnt": 32}, "fwd-layernorm":{"total": 11.40, "avg": 0.09, "max": 0.06, "min": 0.26, "cnt": 128}, "fwd-attn":{"total": 116.06, "avg": 0.91, "max": 0.75, "min": 1.72, "cnt": 128}, "fwd-misc":{"total": 23.76, "avg": 0.19, "max": 0.12, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1700.48, "avg": 13.28, "max": 10.45, "min": 93.55, "cnt": 128}, "MoE_L0_fwd":{"total": 559.70, "avg": 17.49, "max": 11.29, "min": 93.40, "cnt": 32}, "MoEMLP":{"total": 1681.34, "avg": 13.14, "max": 10.33, "min": 93.32, "cnt": 128}, "MoE_L1_fwd":{"total": 388.96, "avg": 12.16, "max": 10.60, "min": 15.86, "cnt": 32}, "MoE_L2_fwd":{"total": 384.23, "avg": 12.01, "max": 11.15, "min": 13.60, "cnt": 32}, "MoE_L3_fwd":{"total": 355.51, "avg": 11.11, "max": 10.38, "min": 13.06, "cnt": 32}, "fwd-pooler":{"total": 0.37, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.63, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 0.91, "avg": 0.91, "max": 0.91, "min": 0.91, "cnt": 1}, "forward-send-backward-recv":{"total": 560.34, "avg": 18.08, "max": 1.02, "min": 102.12, "cnt": 31}, "backward-compute":{"total": 1504.69, "avg": 47.02, "max": 45.16, "min": 48.99, "cnt": 32}, "MoE_L3_bwd":{"total": 364.70, "avg": 11.40, "max": 10.49, "min": 13.36, "cnt": 32}, "MoE_L2_bwd":{"total": 348.06, "avg": 10.88, "max": 9.99, "min": 13.42, "cnt": 32}, "MoE_L1_bwd":{"total": 290.84, "avg": 9.09, "max": 8.43, "min": 10.28, "cnt": 32}, "MoE_L0_bwd":{"total": 280.08, "avg": 8.75, "max": 8.24, "min": 9.99, "cnt": 32}, "backward-send-forward-recv":{"total": 544.81, "avg": 18.16, "max": 1.36, "min": 85.22, "cnt": 30}, "backward-send":{"total": 2.11, "avg": 1.05, "max": 1.04, "min": 1.07, "cnt": 2}, "backward-recv":{"total": 65.90, "avg": 65.90, "max": 65.90, "min": 65.90, "cnt": 1}, "backward-params-all-reduce":{"total": 489.55, "avg": 489.55, "max": 489.55, "min": 489.55, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 275.21, "avg": 275.21, "max": 275.21, "min": 275.21, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 235.45, "avg": 235.45, "max": 235.45, "min": 235.45, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.25, "avg": 3.25, "max": 3.25, "min": 3.25, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 174, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.10, "avg": 0.10, "max": 0.10, "min": 0.10, "cnt": 1}, "forward-recv":{"total": 116.88, "avg": 58.44, "max": 0.93, "min": 115.95, "cnt": 2}, "forward-compute":{"total": 1919.29, "avg": 59.98, "max": 50.68, "min": 66.96, "cnt": 32}, "fwd-compute":{"total": 1915.24, "avg": 59.85, "max": 50.59, "min": 66.81, "cnt": 32}, "batch-generator":{"total": 53.29, "avg": 1.67, "max": 0.74, "min": 2.24, "cnt": 32}, "fwd-embedding":{"total": 0.92, "avg": 0.03, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1845.91, "avg": 57.68, "max": 49.26, "min": 64.37, "cnt": 32}, "fwd-layernorm":{"total": 12.80, "avg": 0.10, "max": 0.06, "min": 0.22, "cnt": 128}, "fwd-attn":{"total": 130.77, "avg": 1.02, "max": 0.75, "min": 5.83, "cnt": 128}, "fwd-misc":{"total": 26.65, "avg": 0.21, "max": 0.12, "min": 0.55, "cnt": 128}, "fwd-MLP":{"total": 1646.79, "avg": 12.87, "max": 10.24, "min": 20.52, "cnt": 128}, "MoE_L0_fwd":{"total": 494.96, "avg": 15.47, "max": 11.89, "min": 20.36, "cnt": 32}, "MoEMLP":{"total": 1625.57, "avg": 12.70, "max": 10.11, "min": 20.26, "cnt": 128}, "MoE_L1_fwd":{"total": 381.84, "avg": 11.93, "max": 10.26, "min": 16.68, "cnt": 32}, "MoE_L2_fwd":{"total": 391.98, "avg": 12.25, "max": 10.95, "min": 15.54, "cnt": 32}, "MoE_L3_fwd":{"total": 364.59, "avg": 11.39, "max": 10.15, "min": 13.97, "cnt": 32}, "fwd-pooler":{"total": 0.41, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.66, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 0.82, "avg": 0.82, "max": 0.82, "min": 0.82, "cnt": 1}, "forward-send-backward-recv":{"total": 878.03, "avg": 28.32, "max": 1.90, "min": 143.82, "cnt": 31}, "backward-compute":{"total": 1497.03, "avg": 46.78, "max": 44.57, "min": 49.63, "cnt": 32}, "MoE_L3_bwd":{"total": 360.94, "avg": 11.28, "max": 9.80, "min": 12.94, "cnt": 32}, "MoE_L2_bwd":{"total": 347.62, "avg": 10.86, "max": 9.89, "min": 12.29, "cnt": 32}, "MoE_L1_bwd":{"total": 291.35, "avg": 9.10, "max": 8.40, "min": 10.61, "cnt": 32}, "MoE_L0_bwd":{"total": 283.59, "avg": 8.86, "max": 8.39, "min": 10.74, "cnt": 32}, "backward-send-forward-recv":{"total": 351.52, "avg": 11.72, "max": 1.83, "min": 84.86, "cnt": 30}, "backward-send":{"total": 1.98, "avg": 0.99, "max": 0.84, "min": 1.14, "cnt": 2}, "backward-recv":{"total": 72.47, "avg": 72.47, "max": 72.47, "min": 72.47, "cnt": 1}, "backward-params-all-reduce":{"total": 492.04, "avg": 492.04, "max": 492.04, "min": 492.04, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 272.16, "avg": 272.16, "max": 272.16, "min": 272.16, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.40, "avg": 3.40, "max": 3.40, "min": 3.40, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 231.78, "avg": 231.78, "max": 231.78, "min": 231.78, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.70, "avg": 3.70, "max": 3.70, "min": 3.70, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.49, "avg": 3.49, "max": 3.49, "min": 3.49, "cnt": 1}}}
{"type":"time", "iteration": 175, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.10, "avg": 0.10, "max": 0.10, "min": 0.10, "cnt": 1}, "forward-recv":{"total": 115.86, "avg": 57.93, "max": 0.80, "min": 115.05, "cnt": 2}, "forward-compute":{"total": 1903.30, "avg": 59.48, "max": 50.88, "min": 71.06, "cnt": 32}, "fwd-compute":{"total": 1899.27, "avg": 59.35, "max": 50.78, "min": 70.93, "cnt": 32}, "batch-generator":{"total": 49.22, "avg": 1.54, "max": 0.83, "min": 2.19, "cnt": 32}, "fwd-embedding":{"total": 0.87, "avg": 0.03, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1834.13, "avg": 57.32, "max": 49.15, "min": 69.02, "cnt": 32}, "fwd-layernorm":{"total": 12.53, "avg": 0.10, "max": 0.06, "min": 0.22, "cnt": 128}, "fwd-attn":{"total": 122.97, "avg": 0.96, "max": 0.75, "min": 2.10, "cnt": 128}, "fwd-misc":{"total": 25.64, "avg": 0.20, "max": 0.12, "min": 0.43, "cnt": 128}, "fwd-MLP":{"total": 1646.32, "avg": 12.86, "max": 10.49, "min": 19.22, "cnt": 128}, "MoE_L0_fwd":{"total": 495.88, "avg": 15.50, "max": 11.12, "min": 19.12, "cnt": 32}, "MoEMLP":{"total": 1625.75, "avg": 12.70, "max": 10.36, "min": 19.07, "cnt": 128}, "MoE_L1_fwd":{"total": 378.69, "avg": 11.83, "max": 10.69, "min": 15.23, "cnt": 32}, "MoE_L2_fwd":{"total": 378.38, "avg": 11.82, "max": 11.25, "min": 13.60, "cnt": 32}, "MoE_L3_fwd":{"total": 380.32, "avg": 11.88, "max": 10.41, "min": 18.98, "cnt": 32}, "fwd-pooler":{"total": 0.41, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.71, "avg": 0.02, "max": 0.02, "min": 0.04, "cnt": 32}, "forward-send":{"total": 0.61, "avg": 0.61, "max": 0.61, "min": 0.61, "cnt": 1}, "forward-send-backward-recv":{"total": 980.99, "avg": 31.64, "max": 1.74, "min": 173.67, "cnt": 31}, "backward-compute":{"total": 1494.32, "avg": 46.70, "max": 44.63, "min": 52.18, "cnt": 32}, "MoE_L3_bwd":{"total": 352.49, "avg": 11.02, "max": 9.39, "min": 11.69, "cnt": 32}, "MoE_L2_bwd":{"total": 351.12, "avg": 10.97, "max": 10.36, "min": 11.46, "cnt": 32}, "MoE_L1_bwd":{"total": 291.53, "avg": 9.11, "max": 8.76, "min": 9.45, "cnt": 32}, "MoE_L0_bwd":{"total": 288.17, "avg": 9.01, "max": 8.42, "min": 13.53, "cnt": 32}, "backward-send-forward-recv":{"total": 335.19, "avg": 11.17, "max": 1.72, "min": 79.87, "cnt": 30}, "backward-send":{"total": 1.89, "avg": 0.95, "max": 0.78, "min": 1.11, "cnt": 2}, "backward-recv":{"total": 78.78, "avg": 78.78, "max": 78.78, "min": 78.78, "cnt": 1}, "backward-params-all-reduce":{"total": 491.83, "avg": 491.83, "max": 491.83, "min": 491.83, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 268.73, "avg": 268.73, "max": 268.73, "min": 268.73, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 228.71, "avg": 228.71, "max": 228.71, "min": 228.71, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.51, "avg": 3.51, "max": 3.51, "min": 3.51, "cnt": 1}}}
{"type":"time", "iteration": 176, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.11, "avg": 0.11, "max": 0.11, "min": 0.11, "cnt": 1}, "forward-recv":{"total": 123.42, "avg": 61.71, "max": 1.20, "min": 122.22, "cnt": 2}, "forward-compute":{"total": 1888.44, "avg": 59.01, "max": 52.49, "min": 65.77, "cnt": 32}, "fwd-compute":{"total": 1884.84, "avg": 58.90, "max": 52.41, "min": 65.60, "cnt": 32}, "batch-generator":{"total": 53.53, "avg": 1.67, "max": 0.80, "min": 3.74, "cnt": 32}, "fwd-embedding":{"total": 0.72, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1816.80, "avg": 56.77, "max": 50.21, "min": 63.10, "cnt": 32}, "fwd-layernorm":{"total": 11.97, "avg": 0.09, "max": 0.06, "min": 0.22, "cnt": 128}, "fwd-attn":{"total": 119.67, "avg": 0.93, "max": 0.75, "min": 1.95, "cnt": 128}, "fwd-misc":{"total": 24.96, "avg": 0.20, "max": 0.12, "min": 0.42, "cnt": 128}, "fwd-MLP":{"total": 1634.02, "avg": 12.77, "max": 10.57, "min": 19.06, "cnt": 128}, "MoE_L0_fwd":{"total": 482.66, "avg": 15.08, "max": 11.19, "min": 18.98, "cnt": 32}, "MoEMLP":{"total": 1613.33, "avg": 12.60, "max": 10.42, "min": 18.93, "cnt": 128}, "MoE_L1_fwd":{"total": 377.43, "avg": 11.79, "max": 10.47, "min": 13.27, "cnt": 32}, "MoE_L2_fwd":{"total": 394.96, "avg": 12.34, "max": 11.37, "min": 15.98, "cnt": 32}, "MoE_L3_fwd":{"total": 365.65, "avg": 11.43, "max": 10.69, "min": 15.04, "cnt": 32}, "fwd-pooler":{"total": 0.37, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.66, "avg": 0.02, "max": 0.02, "min": 0.04, "cnt": 32}, "forward-send":{"total": 0.89, "avg": 0.89, "max": 0.89, "min": 0.89, "cnt": 1}, "forward-send-backward-recv":{"total": 340.13, "avg": 10.97, "max": 1.69, "min": 69.47, "cnt": 31}, "backward-compute":{"total": 1509.94, "avg": 47.19, "max": 45.35, "min": 49.51, "cnt": 32}, "MoE_L3_bwd":{"total": 363.68, "avg": 11.37, "max": 10.74, "min": 12.07, "cnt": 32}, "MoE_L2_bwd":{"total": 349.46, "avg": 10.92, "max": 9.92, "min": 12.20, "cnt": 32}, "MoE_L1_bwd":{"total": 288.61, "avg": 9.02, "max": 8.55, "min": 9.57, "cnt": 32}, "MoE_L0_bwd":{"total": 286.63, "avg": 8.96, "max": 8.50, "min": 9.37, "cnt": 32}, "backward-send-forward-recv":{"total": 1866.41, "avg": 62.21, "max": 1.61, "min": 593.35, "cnt": 30}, "backward-send":{"total": 1.53, "avg": 0.77, "max": 0.64, "min": 0.90, "cnt": 2}, "backward-recv":{"total": 76.73, "avg": 76.73, "max": 76.73, "min": 76.73, "cnt": 1}, "backward-params-all-reduce":{"total": 485.67, "avg": 485.67, "max": 485.67, "min": 485.67, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "optimizer":{"total": 280.29, "avg": 280.29, "max": 280.29, "min": 280.29, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.41, "avg": 3.41, "max": 3.41, "min": 3.41, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 240.07, "avg": 240.07, "max": 240.07, "min": 240.07, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.50, "avg": 3.50, "max": 3.50, "min": 3.50, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.49, "avg": 3.49, "max": 3.49, "min": 3.49, "cnt": 1}}}
{"type":"time", "iteration": 177, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 143.86, "avg": 71.93, "max": 1.22, "min": 142.64, "cnt": 2}, "forward-compute":{"total": 1905.67, "avg": 59.55, "max": 51.77, "min": 68.23, "cnt": 32}, "fwd-compute":{"total": 1901.88, "avg": 59.43, "max": 51.64, "min": 68.08, "cnt": 32}, "batch-generator":{"total": 45.62, "avg": 1.43, "max": 0.74, "min": 2.51, "cnt": 32}, "fwd-embedding":{"total": 0.75, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1840.96, "avg": 57.53, "max": 50.22, "min": 66.64, "cnt": 32}, "fwd-layernorm":{"total": 11.70, "avg": 0.09, "max": 0.06, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 116.68, "avg": 0.91, "max": 0.75, "min": 1.80, "cnt": 128}, "fwd-misc":{"total": 24.57, "avg": 0.19, "max": 0.12, "min": 0.48, "cnt": 128}, "fwd-MLP":{"total": 1662.10, "avg": 12.99, "max": 10.61, "min": 19.74, "cnt": 128}, "MoE_L0_fwd":{"total": 490.34, "avg": 15.32, "max": 11.19, "min": 19.56, "cnt": 32}, "MoEMLP":{"total": 1642.37, "avg": 12.83, "max": 10.49, "min": 19.46, "cnt": 128}, "MoE_L1_fwd":{"total": 381.82, "avg": 11.93, "max": 10.60, "min": 17.48, "cnt": 32}, "MoE_L2_fwd":{"total": 393.00, "avg": 12.28, "max": 11.26, "min": 15.18, "cnt": 32}, "MoE_L3_fwd":{"total": 384.30, "avg": 12.01, "max": 10.53, "min": 17.11, "cnt": 32}, "fwd-pooler":{"total": 0.39, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.68, "avg": 0.02, "max": 0.02, "min": 0.05, "cnt": 32}, "forward-send":{"total": 0.94, "avg": 0.94, "max": 0.94, "min": 0.94, "cnt": 1}, "forward-send-backward-recv":{"total": 363.35, "avg": 11.72, "max": 1.07, "min": 60.04, "cnt": 31}, "backward-compute":{"total": 1507.13, "avg": 47.10, "max": 44.81, "min": 48.60, "cnt": 32}, "MoE_L3_bwd":{"total": 370.04, "avg": 11.56, "max": 10.22, "min": 13.84, "cnt": 32}, "MoE_L2_bwd":{"total": 347.29, "avg": 10.85, "max": 9.92, "min": 11.67, "cnt": 32}, "MoE_L1_bwd":{"total": 285.81, "avg": 8.93, "max": 8.44, "min": 9.65, "cnt": 32}, "MoE_L0_bwd":{"total": 279.67, "avg": 8.74, "max": 8.22, "min": 10.26, "cnt": 32}, "backward-send-forward-recv":{"total": 437.11, "avg": 14.57, "max": 1.94, "min": 89.82, "cnt": 30}, "backward-send":{"total": 2.22, "avg": 1.11, "max": 0.99, "min": 1.23, "cnt": 2}, "backward-recv":{"total": 71.24, "avg": 71.24, "max": 71.24, "min": 71.24, "cnt": 1}, "backward-params-all-reduce":{"total": 489.35, "avg": 489.35, "max": 489.35, "min": 489.35, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 276.60, "avg": 276.60, "max": 276.60, "min": 276.60, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 231.35, "avg": 231.35, "max": 231.35, "min": 231.35, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.03, "avg": 6.03, "max": 6.03, "min": 6.03, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 178, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.10, "avg": 0.10, "max": 0.10, "min": 0.10, "cnt": 1}, "forward-recv":{"total": 118.52, "avg": 59.26, "max": 1.01, "min": 117.51, "cnt": 2}, "forward-compute":{"total": 1889.75, "avg": 59.05, "max": 54.36, "min": 65.27, "cnt": 32}, "fwd-compute":{"total": 1885.75, "avg": 58.93, "max": 54.27, "min": 65.13, "cnt": 32}, "batch-generator":{"total": 50.76, "avg": 1.59, "max": 0.76, "min": 3.09, "cnt": 32}, "fwd-embedding":{"total": 0.83, "avg": 0.03, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1820.37, "avg": 56.89, "max": 52.55, "min": 62.86, "cnt": 32}, "fwd-layernorm":{"total": 11.81, "avg": 0.09, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 117.75, "avg": 0.92, "max": 0.75, "min": 1.63, "cnt": 128}, "fwd-misc":{"total": 24.20, "avg": 0.19, "max": 0.12, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1641.35, "avg": 12.82, "max": 10.15, "min": 18.17, "cnt": 128}, "MoE_L0_fwd":{"total": 502.10, "avg": 15.69, "max": 13.67, "min": 18.01, "cnt": 32}, "MoEMLP":{"total": 1622.00, "avg": 12.67, "max": 10.03, "min": 17.93, "cnt": 128}, "MoE_L1_fwd":{"total": 380.58, "avg": 11.89, "max": 10.77, "min": 14.37, "cnt": 32}, "MoE_L2_fwd":{"total": 390.21, "avg": 12.19, "max": 11.17, "min": 16.63, "cnt": 32}, "MoE_L3_fwd":{"total": 356.15, "avg": 11.13, "max": 10.07, "min": 15.86, "cnt": 32}, "fwd-pooler":{"total": 0.40, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.65, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 0.68, "avg": 0.68, "max": 0.68, "min": 0.68, "cnt": 1}, "forward-send-backward-recv":{"total": 1518.14, "avg": 48.97, "max": 1.75, "min": 391.19, "cnt": 31}, "backward-compute":{"total": 1497.58, "avg": 46.80, "max": 45.04, "min": 49.47, "cnt": 32}, "MoE_L3_bwd":{"total": 364.75, "avg": 11.40, "max": 10.43, "min": 12.54, "cnt": 32}, "MoE_L2_bwd":{"total": 344.31, "avg": 10.76, "max": 10.17, "min": 12.17, "cnt": 32}, "MoE_L1_bwd":{"total": 290.74, "avg": 9.09, "max": 8.55, "min": 11.18, "cnt": 32}, "MoE_L0_bwd":{"total": 278.91, "avg": 8.72, "max": 8.21, "min": 9.90, "cnt": 32}, "backward-send-forward-recv":{"total": 1491.64, "avg": 49.72, "max": 1.80, "min": 619.78, "cnt": 30}, "backward-send":{"total": 2.07, "avg": 1.04, "max": 0.89, "min": 1.19, "cnt": 2}, "backward-recv":{"total": 483.66, "avg": 483.66, "max": 483.66, "min": 483.66, "cnt": 1}, "backward-params-all-reduce":{"total": 488.71, "avg": 488.71, "max": 488.71, "min": 488.71, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 284.62, "avg": 284.62, "max": 284.62, "min": 284.62, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 241.98, "avg": 241.98, "max": 241.98, "min": 241.98, "cnt": 1}, "optimizer-clip-main-grad":{"total": 5.66, "avg": 5.66, "max": 5.66, "min": 5.66, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.52, "avg": 3.52, "max": 3.52, "min": 3.52, "cnt": 1}}}
{"type":"time", "iteration": 179, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 118.07, "avg": 59.04, "max": 0.80, "min": 117.27, "cnt": 2}, "forward-compute":{"total": 1856.89, "avg": 58.03, "max": 50.91, "min": 69.79, "cnt": 32}, "fwd-compute":{"total": 1853.03, "avg": 57.91, "max": 50.83, "min": 69.71, "cnt": 32}, "batch-generator":{"total": 46.18, "avg": 1.44, "max": 0.79, "min": 1.97, "cnt": 32}, "fwd-embedding":{"total": 0.71, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1792.00, "avg": 56.00, "max": 49.15, "min": 67.82, "cnt": 32}, "fwd-layernorm":{"total": 11.11, "avg": 0.09, "max": 0.06, "min": 0.26, "cnt": 128}, "fwd-attn":{"total": 113.19, "avg": 0.88, "max": 0.75, "min": 2.00, "cnt": 128}, "fwd-misc":{"total": 23.19, "avg": 0.18, "max": 0.12, "min": 0.44, "cnt": 128}, "fwd-MLP":{"total": 1619.97, "avg": 12.66, "max": 10.57, "min": 24.80, "cnt": 128}, "MoE_L0_fwd":{"total": 476.15, "avg": 14.88, "max": 10.98, "min": 24.65, "cnt": 32}, "MoEMLP":{"total": 1600.80, "avg": 12.51, "max": 10.45, "min": 24.55, "cnt": 128}, "MoE_L1_fwd":{"total": 384.05, "avg": 12.00, "max": 10.68, "min": 17.67, "cnt": 32}, "MoE_L2_fwd":{"total": 386.71, "avg": 12.08, "max": 11.28, "min": 17.51, "cnt": 32}, "MoE_L3_fwd":{"total": 360.91, "avg": 11.28, "max": 10.49, "min": 15.26, "cnt": 32}, "fwd-pooler":{"total": 0.38, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.72, "avg": 0.02, "max": 0.02, "min": 0.07, "cnt": 32}, "forward-send":{"total": 0.85, "avg": 0.85, "max": 0.85, "min": 0.85, "cnt": 1}, "forward-send-backward-recv":{"total": 476.40, "avg": 15.37, "max": 1.28, "min": 77.27, "cnt": 31}, "backward-compute":{"total": 1479.25, "avg": 46.23, "max": 45.19, "min": 47.84, "cnt": 32}, "MoE_L3_bwd":{"total": 350.17, "avg": 10.94, "max": 9.71, "min": 12.21, "cnt": 32}, "MoE_L2_bwd":{"total": 337.00, "avg": 10.53, "max": 10.00, "min": 11.27, "cnt": 32}, "MoE_L1_bwd":{"total": 284.21, "avg": 8.88, "max": 8.22, "min": 9.30, "cnt": 32}, "MoE_L0_bwd":{"total": 280.33, "avg": 8.76, "max": 8.27, "min": 9.17, "cnt": 32}, "backward-send-forward-recv":{"total": 976.43, "avg": 32.55, "max": 1.96, "min": 270.04, "cnt": 30}, "backward-send":{"total": 2.06, "avg": 1.03, "max": 1.02, "min": 1.04, "cnt": 2}, "backward-recv":{"total": 72.55, "avg": 72.55, "max": 72.55, "min": 72.55, "cnt": 1}, "backward-params-all-reduce":{"total": 493.57, "avg": 493.57, "max": 493.57, "min": 493.57, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 275.56, "avg": 275.56, "max": 275.56, "min": 275.56, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 235.71, "avg": 235.71, "max": 235.71, "min": 235.71, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.33, "avg": 3.33, "max": 3.33, "min": 3.33, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.49, "avg": 3.49, "max": 3.49, "min": 3.49, "cnt": 1}}}
{"type":"time", "iteration": 180, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.10, "avg": 0.10, "max": 0.10, "min": 0.10, "cnt": 1}, "forward-recv":{"total": 295.04, "avg": 147.52, "max": 1.32, "min": 293.72, "cnt": 2}, "forward-compute":{"total": 1899.09, "avg": 59.35, "max": 52.06, "min": 69.20, "cnt": 32}, "fwd-compute":{"total": 1895.39, "avg": 59.23, "max": 51.98, "min": 69.08, "cnt": 32}, "batch-generator":{"total": 45.18, "avg": 1.41, "max": 0.76, "min": 2.09, "cnt": 32}, "fwd-embedding":{"total": 0.78, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1835.22, "avg": 57.35, "max": 50.43, "min": 67.19, "cnt": 32}, "fwd-layernorm":{"total": 11.57, "avg": 0.09, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 115.25, "avg": 0.90, "max": 0.75, "min": 1.73, "cnt": 128}, "fwd-misc":{"total": 24.13, "avg": 0.19, "max": 0.12, "min": 0.41, "cnt": 128}, "fwd-MLP":{"total": 1659.05, "avg": 12.96, "max": 10.21, "min": 19.90, "cnt": 128}, "MoE_L0_fwd":{"total": 489.16, "avg": 15.29, "max": 11.56, "min": 19.81, "cnt": 32}, "MoEMLP":{"total": 1637.73, "avg": 12.79, "max": 10.09, "min": 19.76, "cnt": 128}, "MoE_L1_fwd":{"total": 390.63, "avg": 12.21, "max": 10.53, "min": 17.48, "cnt": 32}, "MoE_L2_fwd":{"total": 401.81, "avg": 12.56, "max": 10.95, "min": 16.36, "cnt": 32}, "MoE_L3_fwd":{"total": 365.08, "avg": 11.41, "max": 10.13, "min": 14.99, "cnt": 32}, "fwd-pooler":{"total": 0.38, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.65, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 0.87, "avg": 0.87, "max": 0.87, "min": 0.87, "cnt": 1}, "forward-send-backward-recv":{"total": 724.13, "avg": 23.36, "max": 1.66, "min": 105.42, "cnt": 31}, "backward-compute":{"total": 1498.73, "avg": 46.84, "max": 43.71, "min": 49.02, "cnt": 32}, "MoE_L3_bwd":{"total": 357.05, "avg": 11.16, "max": 10.15, "min": 12.67, "cnt": 32}, "MoE_L2_bwd":{"total": 341.57, "avg": 10.67, "max": 9.88, "min": 12.16, "cnt": 32}, "MoE_L1_bwd":{"total": 287.90, "avg": 9.00, "max": 8.49, "min": 9.71, "cnt": 32}, "MoE_L0_bwd":{"total": 286.63, "avg": 8.96, "max": 8.28, "min": 9.94, "cnt": 32}, "backward-send-forward-recv":{"total": 413.65, "avg": 13.79, "max": 1.44, "min": 121.71, "cnt": 30}, "backward-send":{"total": 1.93, "avg": 0.96, "max": 0.93, "min": 1.00, "cnt": 2}, "backward-recv":{"total": 70.62, "avg": 70.62, "max": 70.62, "min": 70.62, "cnt": 1}, "backward-params-all-reduce":{"total": 488.74, "avg": 488.74, "max": 488.74, "min": 488.74, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 281.37, "avg": 281.37, "max": 281.37, "min": 281.37, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 241.55, "avg": 241.55, "max": 241.55, "min": 241.55, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.23, "avg": 3.23, "max": 3.23, "min": 3.23, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.49, "avg": 3.49, "max": 3.49, "min": 3.49, "cnt": 1}}}
{"type":"time", "iteration": 181, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 124.47, "avg": 62.24, "max": 0.82, "min": 123.65, "cnt": 2}, "forward-compute":{"total": 1841.45, "avg": 57.55, "max": 50.69, "min": 65.90, "cnt": 32}, "fwd-compute":{"total": 1837.88, "avg": 57.43, "max": 50.60, "min": 65.77, "cnt": 32}, "batch-generator":{"total": 44.07, "avg": 1.38, "max": 0.84, "min": 2.00, "cnt": 32}, "fwd-embedding":{"total": 0.74, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1779.73, "avg": 55.62, "max": 49.34, "min": 63.86, "cnt": 32}, "fwd-layernorm":{"total": 11.09, "avg": 0.09, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 112.95, "avg": 0.88, "max": 0.75, "min": 1.59, "cnt": 128}, "fwd-misc":{"total": 22.96, "avg": 0.18, "max": 0.12, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1608.24, "avg": 12.56, "max": 10.26, "min": 22.45, "cnt": 128}, "MoE_L0_fwd":{"total": 480.29, "avg": 15.01, "max": 11.33, "min": 22.33, "cnt": 32}, "MoEMLP":{"total": 1589.64, "avg": 12.42, "max": 10.13, "min": 22.28, "cnt": 128}, "MoE_L1_fwd":{"total": 374.68, "avg": 11.71, "max": 10.56, "min": 15.07, "cnt": 32}, "MoE_L2_fwd":{"total": 384.55, "avg": 12.02, "max": 11.18, "min": 16.67, "cnt": 32}, "MoE_L3_fwd":{"total": 356.82, "avg": 11.15, "max": 10.18, "min": 13.00, "cnt": 32}, "fwd-pooler":{"total": 0.37, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.64, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.17, "avg": 1.17, "max": 1.17, "min": 1.17, "cnt": 1}, "forward-send-backward-recv":{"total": 807.24, "avg": 26.04, "max": 1.30, "min": 196.81, "cnt": 31}, "backward-compute":{"total": 1492.82, "avg": 46.65, "max": 44.15, "min": 48.61, "cnt": 32}, "MoE_L3_bwd":{"total": 354.51, "avg": 11.08, "max": 9.44, "min": 12.87, "cnt": 32}, "MoE_L2_bwd":{"total": 338.84, "avg": 10.59, "max": 9.89, "min": 11.92, "cnt": 32}, "MoE_L1_bwd":{"total": 290.73, "avg": 9.09, "max": 8.78, "min": 9.42, "cnt": 32}, "MoE_L0_bwd":{"total": 283.53, "avg": 8.86, "max": 8.38, "min": 9.21, "cnt": 32}, "backward-send-forward-recv":{"total": 1215.88, "avg": 40.53, "max": 2.15, "min": 247.39, "cnt": 30}, "backward-send":{"total": 2.08, "avg": 1.04, "max": 1.01, "min": 1.07, "cnt": 2}, "backward-recv":{"total": 64.88, "avg": 64.88, "max": 64.88, "min": 64.88, "cnt": 1}, "backward-params-all-reduce":{"total": 495.17, "avg": 495.17, "max": 495.17, "min": 495.17, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 272.58, "avg": 272.58, "max": 272.58, "min": 272.58, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.41, "avg": 3.41, "max": 3.41, "min": 3.41, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 232.91, "avg": 232.91, "max": 232.91, "min": 232.91, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.25, "avg": 3.25, "max": 3.25, "min": 3.25, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 182, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.11, "avg": 0.11, "max": 0.11, "min": 0.11, "cnt": 1}, "forward-recv":{"total": 128.86, "avg": 64.43, "max": 3.00, "min": 125.86, "cnt": 2}, "forward-compute":{"total": 1869.00, "avg": 58.41, "max": 52.23, "min": 65.68, "cnt": 32}, "fwd-compute":{"total": 1865.09, "avg": 58.28, "max": 52.15, "min": 65.54, "cnt": 32}, "batch-generator":{"total": 47.23, "avg": 1.48, "max": 0.72, "min": 1.92, "cnt": 32}, "fwd-embedding":{"total": 0.82, "avg": 0.03, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1802.20, "avg": 56.32, "max": 50.74, "min": 63.25, "cnt": 32}, "fwd-layernorm":{"total": 11.96, "avg": 0.09, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 118.56, "avg": 0.93, "max": 0.75, "min": 1.55, "cnt": 128}, "fwd-misc":{"total": 24.86, "avg": 0.19, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1620.65, "avg": 12.66, "max": 10.19, "min": 18.97, "cnt": 128}, "MoE_L0_fwd":{"total": 495.82, "avg": 15.49, "max": 12.08, "min": 18.89, "cnt": 32}, "MoEMLP":{"total": 1600.53, "avg": 12.50, "max": 10.07, "min": 18.84, "cnt": 128}, "MoE_L1_fwd":{"total": 389.69, "avg": 12.18, "max": 10.75, "min": 16.58, "cnt": 32}, "MoE_L2_fwd":{"total": 370.44, "avg": 11.58, "max": 10.90, "min": 12.80, "cnt": 32}, "MoE_L3_fwd":{"total": 351.76, "avg": 10.99, "max": 10.11, "min": 17.38, "cnt": 32}, "fwd-pooler":{"total": 0.37, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.65, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 0.78, "avg": 0.78, "max": 0.78, "min": 0.78, "cnt": 1}, "forward-send-backward-recv":{"total": 1217.32, "avg": 39.27, "max": 1.82, "min": 173.77, "cnt": 31}, "backward-compute":{"total": 1478.53, "avg": 46.20, "max": 43.74, "min": 48.93, "cnt": 32}, "MoE_L3_bwd":{"total": 335.51, "avg": 10.48, "max": 9.35, "min": 12.16, "cnt": 32}, "MoE_L2_bwd":{"total": 347.39, "avg": 10.86, "max": 9.99, "min": 12.40, "cnt": 32}, "MoE_L1_bwd":{"total": 294.81, "avg": 9.21, "max": 8.77, "min": 10.46, "cnt": 32}, "MoE_L0_bwd":{"total": 290.62, "avg": 9.08, "max": 8.57, "min": 10.51, "cnt": 32}, "backward-send-forward-recv":{"total": 423.95, "avg": 14.13, "max": 1.28, "min": 98.63, "cnt": 30}, "backward-send":{"total": 2.16, "avg": 1.08, "max": 1.04, "min": 1.12, "cnt": 2}, "backward-recv":{"total": 79.28, "avg": 79.28, "max": 79.28, "min": 79.28, "cnt": 1}, "backward-params-all-reduce":{"total": 491.44, "avg": 491.44, "max": 491.44, "min": 491.44, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 273.61, "avg": 273.61, "max": 273.61, "min": 273.61, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 233.56, "avg": 233.56, "max": 233.56, "min": 233.56, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.36, "avg": 3.36, "max": 3.36, "min": 3.36, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 183, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 116.48, "avg": 58.24, "max": 1.30, "min": 115.18, "cnt": 2}, "forward-compute":{"total": 1866.87, "avg": 58.34, "max": 51.55, "min": 69.34, "cnt": 32}, "fwd-compute":{"total": 1863.15, "avg": 58.22, "max": 51.47, "min": 69.26, "cnt": 32}, "batch-generator":{"total": 48.74, "avg": 1.52, "max": 0.82, "min": 2.39, "cnt": 32}, "fwd-embedding":{"total": 0.81, "avg": 0.03, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1799.98, "avg": 56.25, "max": 48.88, "min": 68.05, "cnt": 32}, "fwd-layernorm":{"total": 11.54, "avg": 0.09, "max": 0.06, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 117.02, "avg": 0.91, "max": 0.75, "min": 1.68, "cnt": 128}, "fwd-misc":{"total": 24.06, "avg": 0.19, "max": 0.12, "min": 0.38, "cnt": 128}, "fwd-MLP":{"total": 1622.06, "avg": 12.67, "max": 10.14, "min": 18.32, "cnt": 128}, "MoE_L0_fwd":{"total": 495.26, "avg": 15.48, "max": 11.55, "min": 18.24, "cnt": 32}, "MoEMLP":{"total": 1602.68, "avg": 12.52, "max": 10.02, "min": 18.19, "cnt": 128}, "MoE_L1_fwd":{"total": 382.69, "avg": 11.96, "max": 10.69, "min": 14.17, "cnt": 32}, "MoE_L2_fwd":{"total": 381.98, "avg": 11.94, "max": 11.02, "min": 18.17, "cnt": 32}, "MoE_L3_fwd":{"total": 349.62, "avg": 10.93, "max": 10.06, "min": 15.19, "cnt": 32}, "fwd-pooler":{"total": 0.37, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.63, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 0.99, "avg": 0.99, "max": 0.99, "min": 0.99, "cnt": 1}, "forward-send-backward-recv":{"total": 1681.82, "avg": 54.25, "max": 1.96, "min": 336.91, "cnt": 31}, "backward-compute":{"total": 1501.44, "avg": 46.92, "max": 45.50, "min": 51.83, "cnt": 32}, "MoE_L3_bwd":{"total": 349.13, "avg": 10.91, "max": 10.09, "min": 16.20, "cnt": 32}, "MoE_L2_bwd":{"total": 352.76, "avg": 11.02, "max": 10.24, "min": 12.63, "cnt": 32}, "MoE_L1_bwd":{"total": 292.68, "avg": 9.15, "max": 8.65, "min": 10.29, "cnt": 32}, "MoE_L0_bwd":{"total": 292.09, "avg": 9.13, "max": 8.59, "min": 10.58, "cnt": 32}, "backward-send-forward-recv":{"total": 960.43, "avg": 32.01, "max": 1.81, "min": 328.32, "cnt": 30}, "backward-send":{"total": 1.83, "avg": 0.92, "max": 0.79, "min": 1.04, "cnt": 2}, "backward-recv":{"total": 81.65, "avg": 81.65, "max": 81.65, "min": 81.65, "cnt": 1}, "backward-params-all-reduce":{"total": 489.24, "avg": 489.24, "max": 489.24, "min": 489.24, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 282.39, "avg": 282.39, "max": 282.39, "min": 282.39, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.40, "avg": 3.40, "max": 3.40, "min": 3.40, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 242.54, "avg": 242.54, "max": 242.54, "min": 242.54, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.31, "avg": 3.31, "max": 3.31, "min": 3.31, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 184, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 137.09, "avg": 68.55, "max": 1.18, "min": 135.91, "cnt": 2}, "forward-compute":{"total": 1881.31, "avg": 58.79, "max": 50.82, "min": 70.09, "cnt": 32}, "fwd-compute":{"total": 1877.75, "avg": 58.68, "max": 50.74, "min": 70.01, "cnt": 32}, "batch-generator":{"total": 45.35, "avg": 1.42, "max": 0.75, "min": 2.42, "cnt": 32}, "fwd-embedding":{"total": 0.79, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1818.07, "avg": 56.81, "max": 49.58, "min": 68.74, "cnt": 32}, "fwd-layernorm":{"total": 11.88, "avg": 0.09, "max": 0.06, "min": 0.22, "cnt": 128}, "fwd-attn":{"total": 121.42, "avg": 0.95, "max": 0.75, "min": 1.87, "cnt": 128}, "fwd-misc":{"total": 24.64, "avg": 0.19, "max": 0.12, "min": 0.44, "cnt": 128}, "fwd-MLP":{"total": 1633.99, "avg": 12.77, "max": 10.19, "min": 19.22, "cnt": 128}, "MoE_L0_fwd":{"total": 495.47, "avg": 15.48, "max": 12.01, "min": 19.14, "cnt": 32}, "MoEMLP":{"total": 1613.70, "avg": 12.61, "max": 10.07, "min": 19.10, "cnt": 128}, "MoE_L1_fwd":{"total": 385.82, "avg": 12.06, "max": 10.57, "min": 15.81, "cnt": 32}, "MoE_L2_fwd":{"total": 386.30, "avg": 12.07, "max": 11.15, "min": 17.04, "cnt": 32}, "MoE_L3_fwd":{"total": 353.40, "avg": 11.04, "max": 10.11, "min": 13.29, "cnt": 32}, "fwd-pooler":{"total": 0.37, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.63, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 0.88, "avg": 0.88, "max": 0.88, "min": 0.88, "cnt": 1}, "forward-send-backward-recv":{"total": 571.50, "avg": 18.44, "max": 0.95, "min": 106.51, "cnt": 31}, "backward-compute":{"total": 1480.38, "avg": 46.26, "max": 43.56, "min": 47.79, "cnt": 32}, "MoE_L3_bwd":{"total": 344.31, "avg": 10.76, "max": 9.42, "min": 12.54, "cnt": 32}, "MoE_L2_bwd":{"total": 340.69, "avg": 10.65, "max": 9.88, "min": 11.89, "cnt": 32}, "MoE_L1_bwd":{"total": 287.66, "avg": 8.99, "max": 8.51, "min": 9.39, "cnt": 32}, "MoE_L0_bwd":{"total": 288.84, "avg": 9.03, "max": 8.12, "min": 10.30, "cnt": 32}, "backward-send-forward-recv":{"total": 514.68, "avg": 17.16, "max": 2.02, "min": 111.96, "cnt": 30}, "backward-send":{"total": 1.78, "avg": 0.89, "max": 0.80, "min": 0.98, "cnt": 2}, "backward-recv":{"total": 74.56, "avg": 74.56, "max": 74.56, "min": 74.56, "cnt": 1}, "backward-params-all-reduce":{"total": 488.20, "avg": 488.20, "max": 488.20, "min": 488.20, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 281.44, "avg": 281.44, "max": 281.44, "min": 281.44, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 241.46, "avg": 241.46, "max": 241.46, "min": 241.46, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.58, "avg": 3.58, "max": 3.58, "min": 3.58, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 185, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 142.38, "avg": 71.19, "max": 0.97, "min": 141.41, "cnt": 2}, "forward-compute":{"total": 1872.59, "avg": 58.52, "max": 51.30, "min": 70.91, "cnt": 32}, "fwd-compute":{"total": 1869.02, "avg": 58.41, "max": 51.22, "min": 70.77, "cnt": 32}, "batch-generator":{"total": 45.01, "avg": 1.41, "max": 0.85, "min": 2.54, "cnt": 32}, "fwd-embedding":{"total": 0.70, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1808.15, "avg": 56.50, "max": 49.58, "min": 68.95, "cnt": 32}, "fwd-layernorm":{"total": 11.41, "avg": 0.09, "max": 0.06, "min": 0.26, "cnt": 128}, "fwd-attn":{"total": 117.07, "avg": 0.91, "max": 0.75, "min": 1.85, "cnt": 128}, "fwd-misc":{"total": 23.99, "avg": 0.19, "max": 0.12, "min": 0.42, "cnt": 128}, "fwd-MLP":{"total": 1629.61, "avg": 12.73, "max": 10.23, "min": 20.51, "cnt": 128}, "MoE_L0_fwd":{"total": 490.14, "avg": 15.32, "max": 10.69, "min": 20.42, "cnt": 32}, "MoEMLP":{"total": 1609.74, "avg": 12.58, "max": 10.11, "min": 20.37, "cnt": 128}, "MoE_L1_fwd":{"total": 381.51, "avg": 11.92, "max": 10.56, "min": 16.11, "cnt": 32}, "MoE_L2_fwd":{"total": 378.13, "avg": 11.82, "max": 10.98, "min": 17.00, "cnt": 32}, "MoE_L3_fwd":{"total": 367.09, "avg": 11.47, "max": 10.15, "min": 16.99, "cnt": 32}, "fwd-pooler":{"total": 0.40, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.68, "avg": 0.02, "max": 0.02, "min": 0.05, "cnt": 32}, "forward-send":{"total": 1.23, "avg": 1.23, "max": 1.23, "min": 1.23, "cnt": 1}, "forward-send-backward-recv":{"total": 290.06, "avg": 9.36, "max": 1.25, "min": 59.84, "cnt": 31}, "backward-compute":{"total": 1493.53, "avg": 46.67, "max": 44.89, "min": 47.61, "cnt": 32}, "MoE_L3_bwd":{"total": 356.19, "avg": 11.13, "max": 10.25, "min": 12.87, "cnt": 32}, "MoE_L2_bwd":{"total": 343.05, "avg": 10.72, "max": 9.72, "min": 11.33, "cnt": 32}, "MoE_L1_bwd":{"total": 290.21, "avg": 9.07, "max": 8.49, "min": 9.86, "cnt": 32}, "MoE_L0_bwd":{"total": 285.70, "avg": 8.93, "max": 8.52, "min": 9.85, "cnt": 32}, "backward-send-forward-recv":{"total": 1597.13, "avg": 53.24, "max": 1.96, "min": 389.16, "cnt": 30}, "backward-send":{"total": 2.12, "avg": 1.06, "max": 1.05, "min": 1.07, "cnt": 2}, "backward-recv":{"total": 75.01, "avg": 75.01, "max": 75.01, "min": 75.01, "cnt": 1}, "backward-params-all-reduce":{"total": 488.16, "avg": 488.16, "max": 488.16, "min": 488.16, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 271.56, "avg": 271.56, "max": 271.56, "min": 271.56, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 231.70, "avg": 231.70, "max": 231.70, "min": 231.70, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.48, "avg": 3.48, "max": 3.48, "min": 3.48, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 186, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 127.94, "avg": 63.97, "max": 1.01, "min": 126.92, "cnt": 2}, "forward-compute":{"total": 1923.91, "avg": 60.12, "max": 52.32, "min": 72.35, "cnt": 32}, "fwd-compute":{"total": 1920.07, "avg": 60.00, "max": 52.23, "min": 72.20, "cnt": 32}, "batch-generator":{"total": 51.38, "avg": 1.61, "max": 0.71, "min": 3.70, "cnt": 32}, "fwd-embedding":{"total": 0.79, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1852.53, "avg": 57.89, "max": 49.40, "min": 68.94, "cnt": 32}, "fwd-layernorm":{"total": 12.19, "avg": 0.10, "max": 0.06, "min": 0.25, "cnt": 128}, "fwd-attn":{"total": 120.25, "avg": 0.94, "max": 0.75, "min": 2.31, "cnt": 128}, "fwd-misc":{"total": 24.67, "avg": 0.19, "max": 0.12, "min": 0.43, "cnt": 128}, "fwd-MLP":{"total": 1669.21, "avg": 13.04, "max": 10.37, "min": 19.70, "cnt": 128}, "MoE_L0_fwd":{"total": 496.73, "avg": 15.52, "max": 11.22, "min": 19.58, "cnt": 32}, "MoEMLP":{"total": 1648.89, "avg": 12.88, "max": 10.24, "min": 19.52, "cnt": 128}, "MoE_L1_fwd":{"total": 390.52, "avg": 12.20, "max": 10.96, "min": 15.25, "cnt": 32}, "MoE_L2_fwd":{"total": 396.75, "avg": 12.40, "max": 11.17, "min": 18.61, "cnt": 32}, "MoE_L3_fwd":{"total": 372.28, "avg": 11.63, "max": 10.29, "min": 16.33, "cnt": 32}, "fwd-pooler":{"total": 0.40, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.67, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 0.76, "avg": 0.76, "max": 0.76, "min": 0.76, "cnt": 1}, "forward-send-backward-recv":{"total": 417.33, "avg": 13.46, "max": 1.58, "min": 76.52, "cnt": 31}, "backward-compute":{"total": 1525.75, "avg": 47.68, "max": 44.90, "min": 52.27, "cnt": 32}, "MoE_L3_bwd":{"total": 358.83, "avg": 11.21, "max": 9.93, "min": 15.38, "cnt": 32}, "MoE_L2_bwd":{"total": 361.73, "avg": 11.30, "max": 9.78, "min": 12.58, "cnt": 32}, "MoE_L1_bwd":{"total": 298.88, "avg": 9.34, "max": 8.79, "min": 10.70, "cnt": 32}, "MoE_L0_bwd":{"total": 291.24, "avg": 9.10, "max": 8.23, "min": 10.59, "cnt": 32}, "backward-send-forward-recv":{"total": 683.08, "avg": 22.77, "max": 1.29, "min": 231.91, "cnt": 30}, "backward-send":{"total": 2.26, "avg": 1.13, "max": 1.13, "min": 1.13, "cnt": 2}, "backward-recv":{"total": 73.15, "avg": 73.15, "max": 73.15, "min": 73.15, "cnt": 1}, "backward-params-all-reduce":{"total": 487.92, "avg": 487.92, "max": 487.92, "min": 487.92, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 272.84, "avg": 272.84, "max": 272.84, "min": 272.84, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 232.77, "avg": 232.77, "max": 232.77, "min": 232.77, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.53, "avg": 3.53, "max": 3.53, "min": 3.53, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.52, "avg": 3.52, "max": 3.52, "min": 3.52, "cnt": 1}}}
{"type":"time", "iteration": 187, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 124.44, "avg": 62.22, "max": 4.86, "min": 119.58, "cnt": 2}, "forward-compute":{"total": 1924.76, "avg": 60.15, "max": 56.90, "min": 65.04, "cnt": 32}, "fwd-compute":{"total": 1920.68, "avg": 60.02, "max": 56.76, "min": 64.91, "cnt": 32}, "batch-generator":{"total": 50.94, "avg": 1.59, "max": 0.80, "min": 1.91, "cnt": 32}, "fwd-embedding":{"total": 0.94, "avg": 0.03, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1854.06, "avg": 57.94, "max": 54.60, "min": 62.74, "cnt": 32}, "fwd-layernorm":{"total": 12.82, "avg": 0.10, "max": 0.06, "min": 0.25, "cnt": 128}, "fwd-attn":{"total": 125.49, "avg": 0.98, "max": 0.75, "min": 2.38, "cnt": 128}, "fwd-misc":{"total": 26.65, "avg": 0.21, "max": 0.12, "min": 0.43, "cnt": 128}, "fwd-MLP":{"total": 1662.06, "avg": 12.98, "max": 10.26, "min": 20.10, "cnt": 128}, "MoE_L0_fwd":{"total": 502.02, "avg": 15.69, "max": 13.38, "min": 19.99, "cnt": 32}, "MoEMLP":{"total": 1641.32, "avg": 12.82, "max": 10.15, "min": 19.92, "cnt": 128}, "MoE_L1_fwd":{"total": 395.19, "avg": 12.35, "max": 10.90, "min": 16.33, "cnt": 32}, "MoE_L2_fwd":{"total": 390.24, "avg": 12.20, "max": 11.19, "min": 16.98, "cnt": 32}, "MoE_L3_fwd":{"total": 361.39, "avg": 11.29, "max": 10.20, "min": 15.16, "cnt": 32}, "fwd-pooler":{"total": 0.38, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.63, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 0.98, "avg": 0.98, "max": 0.98, "min": 0.98, "cnt": 1}, "forward-send-backward-recv":{"total": 577.73, "avg": 18.64, "max": 1.94, "min": 102.75, "cnt": 31}, "backward-compute":{"total": 1493.62, "avg": 46.68, "max": 44.82, "min": 50.21, "cnt": 32}, "MoE_L3_bwd":{"total": 350.20, "avg": 10.94, "max": 10.22, "min": 13.65, "cnt": 32}, "MoE_L2_bwd":{"total": 352.11, "avg": 11.00, "max": 10.28, "min": 13.36, "cnt": 32}, "MoE_L1_bwd":{"total": 303.72, "avg": 9.49, "max": 8.94, "min": 13.17, "cnt": 32}, "MoE_L0_bwd":{"total": 276.87, "avg": 8.65, "max": 8.11, "min": 9.02, "cnt": 32}, "backward-send-forward-recv":{"total": 314.65, "avg": 10.49, "max": 1.83, "min": 246.79, "cnt": 30}, "backward-send":{"total": 2.12, "avg": 1.06, "max": 0.98, "min": 1.14, "cnt": 2}, "backward-recv":{"total": 73.51, "avg": 73.51, "max": 73.51, "min": 73.51, "cnt": 1}, "backward-params-all-reduce":{"total": 484.80, "avg": 484.80, "max": 484.80, "min": 484.80, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 280.58, "avg": 280.58, "max": 280.58, "min": 280.58, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 240.72, "avg": 240.72, "max": 240.72, "min": 240.72, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.47, "avg": 3.47, "max": 3.47, "min": 3.47, "cnt": 1}}}
{"type":"time", "iteration": 188, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 125.65, "avg": 62.82, "max": 1.36, "min": 124.29, "cnt": 2}, "forward-compute":{"total": 1852.99, "avg": 57.91, "max": 50.51, "min": 61.44, "cnt": 32}, "fwd-compute":{"total": 1849.17, "avg": 57.79, "max": 50.43, "min": 61.33, "cnt": 32}, "batch-generator":{"total": 49.07, "avg": 1.53, "max": 0.75, "min": 2.36, "cnt": 32}, "fwd-embedding":{"total": 0.83, "avg": 0.03, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1785.26, "avg": 55.79, "max": 49.33, "min": 60.10, "cnt": 32}, "fwd-layernorm":{"total": 11.82, "avg": 0.09, "max": 0.06, "min": 0.24, "cnt": 128}, "fwd-attn":{"total": 119.24, "avg": 0.93, "max": 0.75, "min": 1.82, "cnt": 128}, "fwd-misc":{"total": 25.11, "avg": 0.20, "max": 0.12, "min": 0.45, "cnt": 128}, "fwd-MLP":{"total": 1602.90, "avg": 12.52, "max": 10.37, "min": 18.95, "cnt": 128}, "MoE_L0_fwd":{"total": 473.02, "avg": 14.78, "max": 11.13, "min": 18.87, "cnt": 32}, "MoEMLP":{"total": 1583.24, "avg": 12.37, "max": 10.25, "min": 18.82, "cnt": 128}, "MoE_L1_fwd":{"total": 383.83, "avg": 11.99, "max": 11.02, "min": 14.37, "cnt": 32}, "MoE_L2_fwd":{"total": 378.14, "avg": 11.82, "max": 11.13, "min": 14.81, "cnt": 32}, "MoE_L3_fwd":{"total": 355.39, "avg": 11.11, "max": 10.29, "min": 12.25, "cnt": 32}, "fwd-pooler":{"total": 0.38, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.64, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 0.97, "avg": 0.97, "max": 0.97, "min": 0.97, "cnt": 1}, "forward-send-backward-recv":{"total": 480.33, "avg": 15.49, "max": 1.61, "min": 130.95, "cnt": 31}, "backward-compute":{"total": 1517.08, "avg": 47.41, "max": 45.33, "min": 50.35, "cnt": 32}, "MoE_L3_bwd":{"total": 371.76, "avg": 11.62, "max": 10.56, "min": 12.98, "cnt": 32}, "MoE_L2_bwd":{"total": 341.17, "avg": 10.66, "max": 9.83, "min": 12.47, "cnt": 32}, "MoE_L1_bwd":{"total": 295.73, "avg": 9.24, "max": 8.79, "min": 10.83, "cnt": 32}, "MoE_L0_bwd":{"total": 281.70, "avg": 8.80, "max": 8.26, "min": 10.36, "cnt": 32}, "backward-send-forward-recv":{"total": 580.64, "avg": 19.35, "max": 2.05, "min": 101.09, "cnt": 30}, "backward-send":{"total": 2.13, "avg": 1.06, "max": 0.99, "min": 1.13, "cnt": 2}, "backward-recv":{"total": 68.39, "avg": 68.39, "max": 68.39, "min": 68.39, "cnt": 1}, "backward-params-all-reduce":{"total": 489.17, "avg": 489.17, "max": 489.17, "min": 489.17, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 274.91, "avg": 274.91, "max": 274.91, "min": 274.91, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 234.90, "avg": 234.90, "max": 234.90, "min": 234.90, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 189, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 118.58, "avg": 59.29, "max": 0.71, "min": 117.86, "cnt": 2}, "forward-compute":{"total": 1892.81, "avg": 59.15, "max": 52.27, "min": 67.50, "cnt": 32}, "fwd-compute":{"total": 1888.42, "avg": 59.01, "max": 52.17, "min": 67.42, "cnt": 32}, "batch-generator":{"total": 47.83, "avg": 1.49, "max": 0.75, "min": 2.26, "cnt": 32}, "fwd-embedding":{"total": 0.80, "avg": 0.03, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1826.13, "avg": 57.07, "max": 50.74, "min": 65.80, "cnt": 32}, "fwd-layernorm":{"total": 12.04, "avg": 0.09, "max": 0.06, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 120.08, "avg": 0.94, "max": 0.75, "min": 2.07, "cnt": 128}, "fwd-misc":{"total": 24.51, "avg": 0.19, "max": 0.12, "min": 0.41, "cnt": 128}, "fwd-MLP":{"total": 1642.16, "avg": 12.83, "max": 10.14, "min": 23.15, "cnt": 128}, "MoE_L0_fwd":{"total": 506.93, "avg": 15.84, "max": 11.45, "min": 23.07, "cnt": 32}, "MoEMLP":{"total": 1622.24, "avg": 12.67, "max": 10.03, "min": 23.02, "cnt": 128}, "MoE_L1_fwd":{"total": 387.20, "avg": 12.10, "max": 10.83, "min": 14.91, "cnt": 32}, "MoE_L2_fwd":{"total": 374.72, "avg": 11.71, "max": 11.03, "min": 12.65, "cnt": 32}, "MoE_L3_fwd":{"total": 360.72, "avg": 11.27, "max": 10.07, "min": 16.98, "cnt": 32}, "fwd-pooler":{"total": 0.38, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 1.25, "avg": 0.04, "max": 0.02, "min": 0.61, "cnt": 32}, "forward-send":{"total": 0.81, "avg": 0.81, "max": 0.81, "min": 0.81, "cnt": 1}, "forward-send-backward-recv":{"total": 567.66, "avg": 18.31, "max": 1.35, "min": 114.20, "cnt": 31}, "backward-compute":{"total": 1485.50, "avg": 46.42, "max": 44.40, "min": 49.53, "cnt": 32}, "MoE_L3_bwd":{"total": 350.92, "avg": 10.97, "max": 9.40, "min": 12.93, "cnt": 32}, "MoE_L2_bwd":{"total": 340.46, "avg": 10.64, "max": 9.95, "min": 11.18, "cnt": 32}, "MoE_L1_bwd":{"total": 295.82, "avg": 9.24, "max": 8.61, "min": 12.37, "cnt": 32}, "MoE_L0_bwd":{"total": 281.08, "avg": 8.78, "max": 8.27, "min": 9.97, "cnt": 32}, "backward-send-forward-recv":{"total": 792.06, "avg": 26.40, "max": 1.44, "min": 552.96, "cnt": 30}, "backward-send":{"total": 2.11, "avg": 1.05, "max": 0.99, "min": 1.11, "cnt": 2}, "backward-recv":{"total": 73.50, "avg": 73.50, "max": 73.50, "min": 73.50, "cnt": 1}, "backward-params-all-reduce":{"total": 492.02, "avg": 492.02, "max": 492.02, "min": 492.02, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 275.06, "avg": 275.06, "max": 275.06, "min": 275.06, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 235.28, "avg": 235.28, "max": 235.28, "min": 235.28, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.40, "avg": 3.40, "max": 3.40, "min": 3.40, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.50, "avg": 3.50, "max": 3.50, "min": 3.50, "cnt": 1}}}
{"type":"time", "iteration": 190, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 292.61, "avg": 146.30, "max": 1.26, "min": 291.35, "cnt": 2}, "forward-compute":{"total": 1915.32, "avg": 59.85, "max": 49.96, "min": 68.81, "cnt": 32}, "fwd-compute":{"total": 1911.80, "avg": 59.74, "max": 49.88, "min": 68.71, "cnt": 32}, "batch-generator":{"total": 41.46, "avg": 1.30, "max": 0.73, "min": 1.94, "cnt": 32}, "fwd-embedding":{"total": 0.67, "avg": 0.02, "max": 0.01, "min": 0.06, "cnt": 32}, "fwd-encoder":{"total": 1855.90, "avg": 58.00, "max": 48.70, "min": 67.38, "cnt": 32}, "fwd-layernorm":{"total": 11.06, "avg": 0.09, "max": 0.06, "min": 0.26, "cnt": 128}, "fwd-attn":{"total": 115.94, "avg": 0.91, "max": 0.75, "min": 1.96, "cnt": 128}, "fwd-misc":{"total": 23.14, "avg": 0.18, "max": 0.11, "min": 0.46, "cnt": 128}, "fwd-MLP":{"total": 1680.52, "avg": 13.13, "max": 9.84, "min": 25.29, "cnt": 128}, "MoE_L0_fwd":{"total": 530.61, "avg": 16.58, "max": 11.11, "min": 25.17, "cnt": 32}, "MoEMLP":{"total": 1661.67, "avg": 12.98, "max": 9.73, "min": 25.11, "cnt": 128}, "MoE_L1_fwd":{"total": 392.18, "avg": 12.26, "max": 10.92, "min": 18.76, "cnt": 32}, "MoE_L2_fwd":{"total": 384.89, "avg": 12.03, "max": 11.19, "min": 14.34, "cnt": 32}, "MoE_L3_fwd":{"total": 360.84, "avg": 11.28, "max": 9.77, "min": 17.00, "cnt": 32}, "fwd-pooler":{"total": 0.39, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.67, "avg": 0.02, "max": 0.02, "min": 0.06, "cnt": 32}, "forward-send":{"total": 0.87, "avg": 0.87, "max": 0.87, "min": 0.87, "cnt": 1}, "forward-send-backward-recv":{"total": 383.29, "avg": 12.36, "max": 1.11, "min": 68.27, "cnt": 31}, "backward-compute":{"total": 1497.12, "avg": 46.78, "max": 43.94, "min": 48.92, "cnt": 32}, "MoE_L3_bwd":{"total": 353.19, "avg": 11.04, "max": 9.88, "min": 13.14, "cnt": 32}, "MoE_L2_bwd":{"total": 347.55, "avg": 10.86, "max": 9.95, "min": 11.97, "cnt": 32}, "MoE_L1_bwd":{"total": 295.98, "avg": 9.25, "max": 8.56, "min": 11.46, "cnt": 32}, "MoE_L0_bwd":{"total": 284.01, "avg": 8.88, "max": 8.13, "min": 10.18, "cnt": 32}, "backward-send-forward-recv":{"total": 2580.41, "avg": 86.01, "max": 1.37, "min": 408.30, "cnt": 30}, "backward-send":{"total": 1.86, "avg": 0.93, "max": 0.85, "min": 1.01, "cnt": 2}, "backward-recv":{"total": 72.99, "avg": 72.99, "max": 72.99, "min": 72.99, "cnt": 1}, "backward-params-all-reduce":{"total": 488.04, "avg": 488.04, "max": 488.04, "min": 488.04, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 275.34, "avg": 275.34, "max": 275.34, "min": 275.34, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 235.37, "avg": 235.37, "max": 235.37, "min": 235.37, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.57, "avg": 3.57, "max": 3.57, "min": 3.57, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.49, "avg": 3.49, "max": 3.49, "min": 3.49, "cnt": 1}}}
{"type":"time", "iteration": 191, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 129.52, "avg": 64.76, "max": 4.01, "min": 125.50, "cnt": 2}, "forward-compute":{"total": 1836.49, "avg": 57.39, "max": 51.40, "min": 66.46, "cnt": 32}, "fwd-compute":{"total": 1832.92, "avg": 57.28, "max": 51.31, "min": 66.35, "cnt": 32}, "batch-generator":{"total": 45.46, "avg": 1.42, "max": 0.77, "min": 2.59, "cnt": 32}, "fwd-embedding":{"total": 0.76, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1773.27, "avg": 55.41, "max": 50.15, "min": 64.53, "cnt": 32}, "fwd-layernorm":{"total": 11.39, "avg": 0.09, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 114.82, "avg": 0.90, "max": 0.75, "min": 1.51, "cnt": 128}, "fwd-misc":{"total": 23.75, "avg": 0.19, "max": 0.12, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1598.21, "avg": 12.49, "max": 10.15, "min": 18.45, "cnt": 128}, "MoE_L0_fwd":{"total": 472.81, "avg": 14.78, "max": 11.45, "min": 18.31, "cnt": 32}, "MoEMLP":{"total": 1578.98, "avg": 12.34, "max": 10.04, "min": 18.24, "cnt": 128}, "MoE_L1_fwd":{"total": 380.73, "avg": 11.90, "max": 10.88, "min": 15.91, "cnt": 32}, "MoE_L2_fwd":{"total": 374.00, "avg": 11.69, "max": 11.09, "min": 14.38, "cnt": 32}, "MoE_L3_fwd":{"total": 358.35, "avg": 11.20, "max": 10.08, "min": 14.52, "cnt": 32}, "fwd-pooler":{"total": 0.37, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.62, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 0.91, "avg": 0.91, "max": 0.91, "min": 0.91, "cnt": 1}, "forward-send-backward-recv":{"total": 379.41, "avg": 12.24, "max": 1.09, "min": 59.44, "cnt": 31}, "backward-compute":{"total": 1547.34, "avg": 48.35, "max": 45.24, "min": 50.65, "cnt": 32}, "MoE_L3_bwd":{"total": 378.37, "avg": 11.82, "max": 9.84, "min": 13.82, "cnt": 32}, "MoE_L2_bwd":{"total": 360.28, "avg": 11.26, "max": 10.30, "min": 14.31, "cnt": 32}, "MoE_L1_bwd":{"total": 304.89, "avg": 9.53, "max": 8.93, "min": 11.54, "cnt": 32}, "MoE_L0_bwd":{"total": 284.10, "avg": 8.88, "max": 8.52, "min": 10.85, "cnt": 32}, "backward-send-forward-recv":{"total": 554.17, "avg": 18.47, "max": 2.01, "min": 97.70, "cnt": 30}, "backward-send":{"total": 2.00, "avg": 1.00, "max": 0.99, "min": 1.01, "cnt": 2}, "backward-recv":{"total": 75.02, "avg": 75.02, "max": 75.02, "min": 75.02, "cnt": 1}, "backward-params-all-reduce":{"total": 484.93, "avg": 484.93, "max": 484.93, "min": 484.93, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 285.73, "avg": 285.73, "max": 285.73, "min": 285.73, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 237.51, "avg": 237.51, "max": 237.51, "min": 237.51, "cnt": 1}, "optimizer-clip-main-grad":{"total": 9.22, "avg": 9.22, "max": 9.22, "min": 9.22, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.51, "avg": 3.51, "max": 3.51, "min": 3.51, "cnt": 1}}}
{"type":"time", "iteration": 192, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 115.97, "avg": 57.98, "max": 4.37, "min": 111.60, "cnt": 2}, "forward-compute":{"total": 1941.84, "avg": 60.68, "max": 50.47, "min": 127.64, "cnt": 32}, "fwd-compute":{"total": 1937.88, "avg": 60.56, "max": 50.39, "min": 127.55, "cnt": 32}, "batch-generator":{"total": 47.95, "avg": 1.50, "max": 0.77, "min": 3.01, "cnt": 32}, "fwd-embedding":{"total": 0.78, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1875.10, "avg": 58.60, "max": 49.18, "min": 126.20, "cnt": 32}, "fwd-layernorm":{"total": 11.79, "avg": 0.09, "max": 0.06, "min": 0.23, "cnt": 128}, "fwd-attn":{"total": 118.84, "avg": 0.93, "max": 0.75, "min": 1.95, "cnt": 128}, "fwd-misc":{"total": 25.24, "avg": 0.20, "max": 0.12, "min": 0.61, "cnt": 128}, "fwd-MLP":{"total": 1693.49, "avg": 13.23, "max": 10.05, "min": 80.25, "cnt": 128}, "MoE_L0_fwd":{"total": 492.18, "avg": 15.38, "max": 11.00, "min": 20.21, "cnt": 32}, "MoEMLP":{"total": 1673.53, "avg": 13.07, "max": 9.93, "min": 80.03, "cnt": 128}, "MoE_L1_fwd":{"total": 392.50, "avg": 12.27, "max": 11.04, "min": 15.41, "cnt": 32}, "MoE_L2_fwd":{"total": 380.67, "avg": 11.90, "max": 11.15, "min": 16.18, "cnt": 32}, "MoE_L3_fwd":{"total": 415.32, "avg": 12.98, "max": 9.98, "min": 80.11, "cnt": 32}, "fwd-pooler":{"total": 0.37, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.63, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 0.87, "avg": 0.87, "max": 0.87, "min": 0.87, "cnt": 1}, "forward-send-backward-recv":{"total": 656.28, "avg": 21.17, "max": 1.86, "min": 141.15, "cnt": 31}, "backward-compute":{"total": 1523.24, "avg": 47.60, "max": 45.68, "min": 51.39, "cnt": 32}, "MoE_L3_bwd":{"total": 376.56, "avg": 11.77, "max": 10.43, "min": 14.44, "cnt": 32}, "MoE_L2_bwd":{"total": 340.32, "avg": 10.64, "max": 9.70, "min": 12.52, "cnt": 32}, "MoE_L1_bwd":{"total": 302.45, "avg": 9.45, "max": 8.88, "min": 10.20, "cnt": 32}, "MoE_L0_bwd":{"total": 279.05, "avg": 8.72, "max": 8.40, "min": 9.02, "cnt": 32}, "backward-send-forward-recv":{"total": 762.80, "avg": 25.43, "max": 1.14, "min": 342.53, "cnt": 30}, "backward-send":{"total": 1.63, "avg": 0.82, "max": 0.55, "min": 1.08, "cnt": 2}, "backward-recv":{"total": 76.96, "avg": 76.96, "max": 76.96, "min": 76.96, "cnt": 1}, "backward-params-all-reduce":{"total": 498.58, "avg": 498.58, "max": 498.58, "min": 498.58, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 264.89, "avg": 264.89, "max": 264.89, "min": 264.89, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 225.03, "avg": 225.03, "max": 225.03, "min": 225.03, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.32, "avg": 3.32, "max": 3.32, "min": 3.32, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.48, "avg": 3.48, "max": 3.48, "min": 3.48, "cnt": 1}}}
{"type":"time", "iteration": 193, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 119.84, "avg": 59.92, "max": 7.91, "min": 111.93, "cnt": 2}, "forward-compute":{"total": 1881.47, "avg": 58.80, "max": 51.15, "min": 62.07, "cnt": 32}, "fwd-compute":{"total": 1877.59, "avg": 58.67, "max": 51.06, "min": 61.97, "cnt": 32}, "batch-generator":{"total": 49.30, "avg": 1.54, "max": 0.87, "min": 2.16, "cnt": 32}, "fwd-embedding":{"total": 0.90, "avg": 0.03, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1813.25, "avg": 56.66, "max": 49.81, "min": 60.58, "cnt": 32}, "fwd-layernorm":{"total": 12.51, "avg": 0.10, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 123.13, "avg": 0.96, "max": 0.75, "min": 2.62, "cnt": 128}, "fwd-misc":{"total": 25.40, "avg": 0.20, "max": 0.12, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1625.37, "avg": 12.70, "max": 9.99, "min": 19.28, "cnt": 128}, "MoE_L0_fwd":{"total": 486.95, "avg": 15.22, "max": 11.58, "min": 19.18, "cnt": 32}, "MoEMLP":{"total": 1604.81, "avg": 12.54, "max": 9.87, "min": 19.11, "cnt": 128}, "MoE_L1_fwd":{"total": 391.52, "avg": 12.23, "max": 10.91, "min": 14.34, "cnt": 32}, "MoE_L2_fwd":{"total": 379.34, "avg": 11.85, "max": 10.95, "min": 14.02, "cnt": 32}, "MoE_L3_fwd":{"total": 354.51, "avg": 11.08, "max": 9.91, "min": 15.33, "cnt": 32}, "fwd-pooler":{"total": 0.38, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.62, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 0.74, "avg": 0.74, "max": 0.74, "min": 0.74, "cnt": 1}, "forward-send-backward-recv":{"total": 682.24, "avg": 22.01, "max": 9.76, "min": 112.30, "cnt": 31}, "backward-compute":{"total": 1487.19, "avg": 46.47, "max": 45.15, "min": 51.29, "cnt": 32}, "MoE_L3_bwd":{"total": 348.41, "avg": 10.89, "max": 10.21, "min": 13.79, "cnt": 32}, "MoE_L2_bwd":{"total": 343.87, "avg": 10.75, "max": 9.60, "min": 12.78, "cnt": 32}, "MoE_L1_bwd":{"total": 303.74, "avg": 9.49, "max": 8.86, "min": 11.82, "cnt": 32}, "MoE_L0_bwd":{"total": 275.02, "avg": 8.59, "max": 8.00, "min": 9.47, "cnt": 32}, "backward-send-forward-recv":{"total": 70.03, "avg": 2.33, "max": 1.42, "min": 2.73, "cnt": 30}, "backward-send":{"total": 2.32, "avg": 1.16, "max": 1.15, "min": 1.17, "cnt": 2}, "backward-recv":{"total": 69.01, "avg": 69.01, "max": 69.01, "min": 69.01, "cnt": 1}, "backward-params-all-reduce":{"total": 495.60, "avg": 495.60, "max": 495.60, "min": 495.60, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 270.42, "avg": 270.42, "max": 270.42, "min": 270.42, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 230.63, "avg": 230.63, "max": 230.63, "min": 230.63, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.25, "avg": 3.25, "max": 3.25, "min": 3.25, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 194, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 112.98, "avg": 56.49, "max": 1.03, "min": 111.95, "cnt": 2}, "forward-compute":{"total": 1791.95, "avg": 56.00, "max": 49.73, "min": 62.77, "cnt": 32}, "fwd-compute":{"total": 1788.43, "avg": 55.89, "max": 49.64, "min": 62.68, "cnt": 32}, "batch-generator":{"total": 45.70, "avg": 1.43, "max": 0.83, "min": 2.96, "cnt": 32}, "fwd-embedding":{"total": 0.69, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1728.65, "avg": 54.02, "max": 48.36, "min": 60.51, "cnt": 32}, "fwd-layernorm":{"total": 10.75, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 111.23, "avg": 0.87, "max": 0.75, "min": 1.47, "cnt": 128}, "fwd-misc":{"total": 22.65, "avg": 0.18, "max": 0.12, "min": 0.38, "cnt": 128}, "fwd-MLP":{"total": 1560.02, "avg": 12.19, "max": 10.14, "min": 18.00, "cnt": 128}, "MoE_L0_fwd":{"total": 454.67, "avg": 14.21, "max": 10.48, "min": 17.92, "cnt": 32}, "MoEMLP":{"total": 1541.81, "avg": 12.05, "max": 10.02, "min": 17.87, "cnt": 128}, "MoE_L1_fwd":{"total": 373.06, "avg": 11.66, "max": 10.58, "min": 14.64, "cnt": 32}, "MoE_L2_fwd":{"total": 366.13, "avg": 11.44, "max": 10.89, "min": 12.38, "cnt": 32}, "MoE_L3_fwd":{"total": 354.59, "avg": 11.08, "max": 10.06, "min": 16.40, "cnt": 32}, "fwd-pooler":{"total": 0.38, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.65, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 0.93, "avg": 0.93, "max": 0.93, "min": 0.93, "cnt": 1}, "forward-send-backward-recv":{"total": 360.31, "avg": 11.62, "max": 1.16, "min": 79.00, "cnt": 31}, "backward-compute":{"total": 1462.12, "avg": 45.69, "max": 43.09, "min": 50.17, "cnt": 32}, "MoE_L3_bwd":{"total": 346.24, "avg": 10.82, "max": 9.52, "min": 15.29, "cnt": 32}, "MoE_L2_bwd":{"total": 335.93, "avg": 10.50, "max": 9.94, "min": 11.07, "cnt": 32}, "MoE_L1_bwd":{"total": 295.11, "avg": 9.22, "max": 8.48, "min": 10.05, "cnt": 32}, "MoE_L0_bwd":{"total": 270.60, "avg": 8.46, "max": 7.58, "min": 9.94, "cnt": 32}, "backward-send-forward-recv":{"total": 1963.16, "avg": 65.44, "max": 2.23, "min": 757.35, "cnt": 30}, "backward-send":{"total": 2.11, "avg": 1.05, "max": 1.03, "min": 1.08, "cnt": 2}, "backward-recv":{"total": 80.25, "avg": 80.25, "max": 80.25, "min": 80.25, "cnt": 1}, "backward-params-all-reduce":{"total": 487.14, "avg": 487.14, "max": 487.14, "min": 487.14, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 279.21, "avg": 279.21, "max": 279.21, "min": 279.21, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 239.47, "avg": 239.47, "max": 239.47, "min": 239.47, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 195, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 129.28, "avg": 64.64, "max": 2.91, "min": 126.38, "cnt": 2}, "forward-compute":{"total": 1865.61, "avg": 58.30, "max": 50.00, "min": 67.72, "cnt": 32}, "fwd-compute":{"total": 1861.56, "avg": 58.17, "max": 49.92, "min": 67.52, "cnt": 32}, "batch-generator":{"total": 48.09, "avg": 1.50, "max": 0.75, "min": 2.08, "cnt": 32}, "fwd-embedding":{"total": 0.83, "avg": 0.03, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1797.20, "avg": 56.16, "max": 48.82, "min": 64.94, "cnt": 32}, "fwd-layernorm":{"total": 11.72, "avg": 0.09, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 118.31, "avg": 0.92, "max": 0.75, "min": 1.51, "cnt": 128}, "fwd-misc":{"total": 24.57, "avg": 0.19, "max": 0.12, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1616.59, "avg": 12.63, "max": 10.15, "min": 18.03, "cnt": 128}, "MoE_L0_fwd":{"total": 480.52, "avg": 15.02, "max": 10.39, "min": 17.92, "cnt": 32}, "MoEMLP":{"total": 1597.06, "avg": 12.48, "max": 10.03, "min": 17.87, "cnt": 128}, "MoE_L1_fwd":{"total": 389.60, "avg": 12.18, "max": 10.69, "min": 16.46, "cnt": 32}, "MoE_L2_fwd":{"total": 380.49, "avg": 11.89, "max": 10.81, "min": 16.08, "cnt": 32}, "MoE_L3_fwd":{"total": 353.57, "avg": 11.05, "max": 10.07, "min": 14.07, "cnt": 32}, "fwd-pooler":{"total": 0.39, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.70, "avg": 0.02, "max": 0.02, "min": 0.06, "cnt": 32}, "forward-send":{"total": 0.99, "avg": 0.99, "max": 0.99, "min": 0.99, "cnt": 1}, "forward-send-backward-recv":{"total": 496.06, "avg": 16.00, "max": 1.94, "min": 66.25, "cnt": 31}, "backward-compute":{"total": 1486.15, "avg": 46.44, "max": 43.88, "min": 48.37, "cnt": 32}, "MoE_L3_bwd":{"total": 350.21, "avg": 10.94, "max": 9.83, "min": 13.02, "cnt": 32}, "MoE_L2_bwd":{"total": 347.34, "avg": 10.85, "max": 9.91, "min": 11.84, "cnt": 32}, "MoE_L1_bwd":{"total": 297.61, "avg": 9.30, "max": 8.92, "min": 9.61, "cnt": 32}, "MoE_L0_bwd":{"total": 275.31, "avg": 8.60, "max": 7.93, "min": 9.93, "cnt": 32}, "backward-send-forward-recv":{"total": 411.04, "avg": 13.70, "max": 2.02, "min": 143.31, "cnt": 30}, "backward-send":{"total": 1.99, "avg": 0.99, "max": 0.96, "min": 1.03, "cnt": 2}, "backward-recv":{"total": 75.17, "avg": 75.17, "max": 75.17, "min": 75.17, "cnt": 1}, "backward-params-all-reduce":{"total": 488.05, "avg": 488.05, "max": 488.05, "min": 488.05, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 279.89, "avg": 279.89, "max": 279.89, "min": 279.89, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 234.74, "avg": 234.74, "max": 234.74, "min": 234.74, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.30, "avg": 3.30, "max": 3.30, "min": 3.30, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.47, "avg": 3.47, "max": 3.47, "min": 3.47, "cnt": 1}}}
{"type":"time", "iteration": 196, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 122.85, "avg": 61.43, "max": 2.31, "min": 120.54, "cnt": 2}, "forward-compute":{"total": 1844.32, "avg": 57.64, "max": 52.56, "min": 60.28, "cnt": 32}, "fwd-compute":{"total": 1840.61, "avg": 57.52, "max": 52.47, "min": 60.17, "cnt": 32}, "batch-generator":{"total": 48.26, "avg": 1.51, "max": 0.75, "min": 2.49, "cnt": 32}, "fwd-embedding":{"total": 0.80, "avg": 0.03, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1777.56, "avg": 55.55, "max": 50.53, "min": 58.65, "cnt": 32}, "fwd-layernorm":{"total": 11.65, "avg": 0.09, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 115.26, "avg": 0.90, "max": 0.75, "min": 2.14, "cnt": 128}, "fwd-misc":{"total": 23.83, "avg": 0.19, "max": 0.12, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1600.92, "avg": 12.51, "max": 10.06, "min": 18.42, "cnt": 128}, "MoE_L0_fwd":{"total": 479.02, "avg": 14.97, "max": 11.60, "min": 18.33, "cnt": 32}, "MoEMLP":{"total": 1581.63, "avg": 12.36, "max": 9.94, "min": 18.29, "cnt": 128}, "MoE_L1_fwd":{"total": 389.26, "avg": 12.16, "max": 11.21, "min": 14.20, "cnt": 32}, "MoE_L2_fwd":{"total": 370.42, "avg": 11.58, "max": 10.93, "min": 12.99, "cnt": 32}, "MoE_L3_fwd":{"total": 349.88, "avg": 10.93, "max": 9.99, "min": 12.15, "cnt": 32}, "fwd-pooler":{"total": 0.36, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.64, "avg": 0.02, "max": 0.02, "min": 0.04, "cnt": 32}, "forward-send":{"total": 0.89, "avg": 0.89, "max": 0.89, "min": 0.89, "cnt": 1}, "forward-send-backward-recv":{"total": 672.64, "avg": 21.70, "max": 1.37, "min": 126.76, "cnt": 31}, "backward-compute":{"total": 1473.58, "avg": 46.05, "max": 43.03, "min": 48.06, "cnt": 32}, "MoE_L3_bwd":{"total": 343.97, "avg": 10.75, "max": 9.55, "min": 11.98, "cnt": 32}, "MoE_L2_bwd":{"total": 335.94, "avg": 10.50, "max": 9.51, "min": 11.66, "cnt": 32}, "MoE_L1_bwd":{"total": 300.93, "avg": 9.40, "max": 8.95, "min": 10.19, "cnt": 32}, "MoE_L0_bwd":{"total": 277.42, "avg": 8.67, "max": 8.18, "min": 9.58, "cnt": 32}, "backward-send-forward-recv":{"total": 1629.96, "avg": 54.33, "max": 2.00, "min": 621.40, "cnt": 30}, "backward-send":{"total": 2.26, "avg": 1.13, "max": 1.11, "min": 1.15, "cnt": 2}, "backward-recv":{"total": 76.04, "avg": 76.04, "max": 76.04, "min": 76.04, "cnt": 1}, "backward-params-all-reduce":{"total": 487.57, "avg": 487.57, "max": 487.57, "min": 487.57, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 277.90, "avg": 277.90, "max": 277.90, "min": 277.90, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 238.06, "avg": 238.06, "max": 238.06, "min": 238.06, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 197, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 124.89, "avg": 62.45, "max": 3.48, "min": 121.41, "cnt": 2}, "forward-compute":{"total": 1833.99, "avg": 57.31, "max": 51.15, "min": 62.09, "cnt": 32}, "fwd-compute":{"total": 1830.18, "avg": 57.19, "max": 51.05, "min": 61.96, "cnt": 32}, "batch-generator":{"total": 49.63, "avg": 1.55, "max": 0.81, "min": 2.74, "cnt": 32}, "fwd-embedding":{"total": 0.79, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1766.01, "avg": 55.19, "max": 49.78, "min": 59.72, "cnt": 32}, "fwd-layernorm":{"total": 11.49, "avg": 0.09, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 116.44, "avg": 0.91, "max": 0.75, "min": 1.61, "cnt": 128}, "fwd-misc":{"total": 23.94, "avg": 0.19, "max": 0.12, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1588.80, "avg": 12.41, "max": 10.34, "min": 18.59, "cnt": 128}, "MoE_L0_fwd":{"total": 472.12, "avg": 14.75, "max": 11.27, "min": 18.49, "cnt": 32}, "MoEMLP":{"total": 1569.54, "avg": 12.26, "max": 10.22, "min": 18.44, "cnt": 128}, "MoE_L1_fwd":{"total": 378.49, "avg": 11.83, "max": 10.91, "min": 12.92, "cnt": 32}, "MoE_L2_fwd":{"total": 370.47, "avg": 11.58, "max": 11.01, "min": 12.47, "cnt": 32}, "MoE_L3_fwd":{"total": 355.40, "avg": 11.11, "max": 10.26, "min": 12.95, "cnt": 32}, "fwd-pooler":{"total": 0.37, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.64, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 0.98, "avg": 0.98, "max": 0.98, "min": 0.98, "cnt": 1}, "forward-send-backward-recv":{"total": 565.62, "avg": 18.25, "max": 1.07, "min": 137.03, "cnt": 31}, "backward-compute":{"total": 1491.22, "avg": 46.60, "max": 44.59, "min": 49.35, "cnt": 32}, "MoE_L3_bwd":{"total": 358.51, "avg": 11.20, "max": 10.09, "min": 13.07, "cnt": 32}, "MoE_L2_bwd":{"total": 338.32, "avg": 10.57, "max": 9.80, "min": 11.92, "cnt": 32}, "MoE_L1_bwd":{"total": 303.19, "avg": 9.47, "max": 8.78, "min": 11.19, "cnt": 32}, "MoE_L0_bwd":{"total": 276.82, "avg": 8.65, "max": 8.32, "min": 9.14, "cnt": 32}, "backward-send-forward-recv":{"total": 456.88, "avg": 15.23, "max": 1.84, "min": 82.60, "cnt": 30}, "backward-send":{"total": 2.19, "avg": 1.09, "max": 1.09, "min": 1.10, "cnt": 2}, "backward-recv":{"total": 76.47, "avg": 76.47, "max": 76.47, "min": 76.47, "cnt": 1}, "backward-params-all-reduce":{"total": 488.14, "avg": 488.14, "max": 488.14, "min": 488.14, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 273.64, "avg": 273.64, "max": 273.64, "min": 273.64, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 234.07, "avg": 234.07, "max": 234.07, "min": 234.07, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.23, "avg": 3.23, "max": 3.23, "min": 3.23, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 198, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 123.25, "avg": 61.63, "max": 0.87, "min": 122.38, "cnt": 2}, "forward-compute":{"total": 1886.18, "avg": 58.94, "max": 50.14, "min": 66.23, "cnt": 32}, "fwd-compute":{"total": 1882.29, "avg": 58.82, "max": 50.04, "min": 66.09, "cnt": 32}, "batch-generator":{"total": 48.03, "avg": 1.50, "max": 0.68, "min": 2.09, "cnt": 32}, "fwd-embedding":{"total": 0.88, "avg": 0.03, "max": 0.01, "min": 0.06, "cnt": 32}, "fwd-encoder":{"total": 1818.85, "avg": 56.84, "max": 48.59, "min": 63.78, "cnt": 32}, "fwd-layernorm":{"total": 12.16, "avg": 0.10, "max": 0.06, "min": 0.24, "cnt": 128}, "fwd-attn":{"total": 117.91, "avg": 0.92, "max": 0.75, "min": 1.97, "cnt": 128}, "fwd-misc":{"total": 25.32, "avg": 0.20, "max": 0.12, "min": 0.54, "cnt": 128}, "fwd-MLP":{"total": 1637.38, "avg": 12.79, "max": 10.45, "min": 20.76, "cnt": 128}, "MoE_L0_fwd":{"total": 497.60, "avg": 15.55, "max": 10.78, "min": 20.68, "cnt": 32}, "MoEMLP":{"total": 1617.19, "avg": 12.63, "max": 10.33, "min": 20.64, "cnt": 128}, "MoE_L1_fwd":{"total": 394.60, "avg": 12.33, "max": 10.78, "min": 16.66, "cnt": 32}, "MoE_L2_fwd":{"total": 370.32, "avg": 11.57, "max": 10.78, "min": 13.74, "cnt": 32}, "MoE_L3_fwd":{"total": 362.03, "avg": 11.31, "max": 10.37, "min": 16.19, "cnt": 32}, "fwd-pooler":{"total": 0.41, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.68, "avg": 0.02, "max": 0.02, "min": 0.04, "cnt": 32}, "forward-send":{"total": 0.83, "avg": 0.83, "max": 0.83, "min": 0.83, "cnt": 1}, "forward-send-backward-recv":{"total": 1177.18, "avg": 37.97, "max": 1.88, "min": 388.84, "cnt": 31}, "backward-compute":{"total": 1488.68, "avg": 46.52, "max": 45.13, "min": 50.55, "cnt": 32}, "MoE_L3_bwd":{"total": 356.19, "avg": 11.13, "max": 9.83, "min": 13.98, "cnt": 32}, "MoE_L2_bwd":{"total": 338.51, "avg": 10.58, "max": 9.89, "min": 12.31, "cnt": 32}, "MoE_L1_bwd":{"total": 290.63, "avg": 9.08, "max": 8.61, "min": 10.10, "cnt": 32}, "MoE_L0_bwd":{"total": 287.50, "avg": 8.98, "max": 8.50, "min": 12.63, "cnt": 32}, "backward-send-forward-recv":{"total": 723.43, "avg": 24.11, "max": 1.93, "min": 298.96, "cnt": 30}, "backward-send":{"total": 2.22, "avg": 1.11, "max": 1.11, "min": 1.11, "cnt": 2}, "backward-recv":{"total": 73.70, "avg": 73.70, "max": 73.70, "min": 73.70, "cnt": 1}, "backward-params-all-reduce":{"total": 486.66, "avg": 486.66, "max": 486.66, "min": 486.66, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 278.68, "avg": 278.68, "max": 278.68, "min": 278.68, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 235.15, "avg": 235.15, "max": 235.15, "min": 235.15, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.28, "avg": 3.28, "max": 3.28, "min": 3.28, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 199, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 121.18, "avg": 60.59, "max": 2.78, "min": 118.39, "cnt": 2}, "forward-compute":{"total": 1847.21, "avg": 57.73, "max": 50.02, "min": 68.62, "cnt": 32}, "fwd-compute":{"total": 1843.43, "avg": 57.61, "max": 49.94, "min": 68.53, "cnt": 32}, "batch-generator":{"total": 46.99, "avg": 1.47, "max": 0.76, "min": 2.17, "cnt": 32}, "fwd-embedding":{"total": 0.79, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1781.41, "avg": 55.67, "max": 48.31, "min": 67.14, "cnt": 32}, "fwd-layernorm":{"total": 11.48, "avg": 0.09, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 115.38, "avg": 0.90, "max": 0.75, "min": 1.48, "cnt": 128}, "fwd-misc":{"total": 23.65, "avg": 0.18, "max": 0.12, "min": 0.39, "cnt": 128}, "fwd-MLP":{"total": 1605.64, "avg": 12.54, "max": 10.56, "min": 22.63, "cnt": 128}, "MoE_L0_fwd":{"total": 480.94, "avg": 15.03, "max": 10.64, "min": 22.55, "cnt": 32}, "MoEMLP":{"total": 1586.65, "avg": 12.40, "max": 10.43, "min": 22.51, "cnt": 128}, "MoE_L1_fwd":{"total": 386.70, "avg": 12.08, "max": 10.52, "min": 15.60, "cnt": 32}, "MoE_L2_fwd":{"total": 367.00, "avg": 11.47, "max": 10.81, "min": 13.64, "cnt": 32}, "MoE_L3_fwd":{"total": 358.85, "avg": 11.21, "max": 10.48, "min": 12.69, "cnt": 32}, "fwd-pooler":{"total": 0.39, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.65, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 0.97, "avg": 0.97, "max": 0.97, "min": 0.97, "cnt": 1}, "forward-send-backward-recv":{"total": 362.81, "avg": 11.70, "max": 1.80, "min": 71.97, "cnt": 31}, "backward-compute":{"total": 1496.50, "avg": 46.77, "max": 42.55, "min": 48.80, "cnt": 32}, "MoE_L3_bwd":{"total": 366.15, "avg": 11.44, "max": 9.46, "min": 12.44, "cnt": 32}, "MoE_L2_bwd":{"total": 333.28, "avg": 10.41, "max": 9.83, "min": 12.46, "cnt": 32}, "MoE_L1_bwd":{"total": 297.07, "avg": 9.28, "max": 8.45, "min": 9.97, "cnt": 32}, "MoE_L0_bwd":{"total": 280.17, "avg": 8.76, "max": 8.33, "min": 9.21, "cnt": 32}, "backward-send-forward-recv":{"total": 950.02, "avg": 31.67, "max": 2.17, "min": 241.37, "cnt": 30}, "backward-send":{"total": 1.94, "avg": 0.97, "max": 0.93, "min": 1.01, "cnt": 2}, "backward-recv":{"total": 76.82, "avg": 76.82, "max": 76.82, "min": 76.82, "cnt": 1}, "backward-params-all-reduce":{"total": 486.54, "avg": 486.54, "max": 486.54, "min": 486.54, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.04, "avg": 0.04, "max": 0.04, "min": 0.04, "cnt": 1}, "optimizer":{"total": 277.93, "avg": 277.93, "max": 277.93, "min": 277.93, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 237.58, "avg": 237.58, "max": 237.58, "min": 237.58, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.70, "avg": 3.70, "max": 3.70, "min": 3.70, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.51, "avg": 3.51, "max": 3.51, "min": 3.51, "cnt": 1}}}
{"type":"time", "iteration": 200, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 143.62, "avg": 71.81, "max": 0.85, "min": 142.77, "cnt": 2}, "forward-compute":{"total": 1988.98, "avg": 62.16, "max": 57.47, "min": 69.18, "cnt": 32}, "fwd-compute":{"total": 1984.72, "avg": 62.02, "max": 57.34, "min": 69.04, "cnt": 32}, "batch-generator":{"total": 53.51, "avg": 1.67, "max": 0.82, "min": 2.12, "cnt": 32}, "fwd-embedding":{"total": 0.97, "avg": 0.03, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1914.10, "avg": 59.82, "max": 55.00, "min": 66.60, "cnt": 32}, "fwd-layernorm":{"total": 13.45, "avg": 0.11, "max": 0.06, "min": 0.24, "cnt": 128}, "fwd-attn":{"total": 132.32, "avg": 1.03, "max": 0.75, "min": 3.28, "cnt": 128}, "fwd-misc":{"total": 28.27, "avg": 0.22, "max": 0.12, "min": 0.46, "cnt": 128}, "fwd-MLP":{"total": 1711.81, "avg": 13.37, "max": 10.42, "min": 21.56, "cnt": 128}, "MoE_L0_fwd":{"total": 504.14, "avg": 15.75, "max": 12.89, "min": 21.47, "cnt": 32}, "MoEMLP":{"total": 1690.01, "avg": 13.20, "max": 10.31, "min": 21.42, "cnt": 128}, "MoE_L1_fwd":{"total": 412.77, "avg": 12.90, "max": 11.09, "min": 18.96, "cnt": 32}, "MoE_L2_fwd":{"total": 403.99, "avg": 12.62, "max": 10.86, "min": 18.36, "cnt": 32}, "MoE_L3_fwd":{"total": 377.12, "avg": 11.79, "max": 10.35, "min": 14.65, "cnt": 32}, "fwd-pooler":{"total": 0.41, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.71, "avg": 0.02, "max": 0.02, "min": 0.04, "cnt": 32}, "forward-send":{"total": 0.59, "avg": 0.59, "max": 0.59, "min": 0.59, "cnt": 1}, "forward-send-backward-recv":{"total": 558.05, "avg": 18.00, "max": 1.30, "min": 110.17, "cnt": 31}, "backward-compute":{"total": 1495.04, "avg": 46.72, "max": 45.47, "min": 49.11, "cnt": 32}, "MoE_L3_bwd":{"total": 361.14, "avg": 11.29, "max": 10.43, "min": 14.12, "cnt": 32}, "MoE_L2_bwd":{"total": 334.00, "avg": 10.44, "max": 9.71, "min": 11.15, "cnt": 32}, "MoE_L1_bwd":{"total": 304.56, "avg": 9.52, "max": 9.03, "min": 10.33, "cnt": 32}, "MoE_L0_bwd":{"total": 278.54, "avg": 8.70, "max": 8.34, "min": 9.65, "cnt": 32}, "backward-send-forward-recv":{"total": 81.57, "avg": 2.72, "max": 1.72, "min": 8.44, "cnt": 30}, "backward-send":{"total": 1.94, "avg": 0.97, "max": 0.93, "min": 1.01, "cnt": 2}, "backward-recv":{"total": 74.79, "avg": 74.79, "max": 74.79, "min": 74.79, "cnt": 1}, "backward-params-all-reduce":{"total": 491.90, "avg": 491.90, "max": 491.90, "min": 491.90, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 270.06, "avg": 270.06, "max": 270.06, "min": 270.06, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 228.20, "avg": 228.20, "max": 228.20, "min": 228.20, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.48, "avg": 3.48, "max": 3.48, "min": 3.48, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
