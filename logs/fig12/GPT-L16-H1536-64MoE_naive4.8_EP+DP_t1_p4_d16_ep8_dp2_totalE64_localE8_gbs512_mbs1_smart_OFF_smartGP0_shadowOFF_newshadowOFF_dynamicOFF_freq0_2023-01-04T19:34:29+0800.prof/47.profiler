{"type":"time", "iteration": -1, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 7554.78, "avg": 7554.78, "max": 7554.78, "min": 7554.78, "cnt": 1}, "train/valid/test-data-iterators-setup":{"total": 14767.76, "avg": 14767.76, "max": 14767.76, "min": 14767.76, "cnt": 1}}}
{"type":"time", "iteration": 1, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.84, "avg": 0.84, "max": 0.84, "min": 0.84, "cnt": 1}, "forward-recv":{"total": 6102.86, "avg": 3051.43, "max": 0.88, "min": 6101.98, "cnt": 2}, "forward-compute":{"total": 3805.12, "avg": 118.91, "max": 56.86, "min": 1790.66, "cnt": 32}, "fwd-compute":{"total": 3800.30, "avg": 118.76, "max": 56.75, "min": 1790.49, "cnt": 32}, "batch-generator":{"total": 171.67, "avg": 5.36, "max": 1.02, "min": 97.41, "cnt": 32}, "fwd-embedding":{"total": 0.74, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 3611.04, "avg": 112.84, "max": 55.05, "min": 1690.30, "cnt": 32}, "fwd-layernorm":{"total": 13.67, "avg": 0.11, "max": 0.05, "min": 1.86, "cnt": 128}, "fwd-attn":{"total": 766.31, "avg": 5.99, "max": 0.74, "min": 616.48, "cnt": 128}, "fwd-misc":{"total": 343.38, "avg": 2.68, "max": 0.12, "min": 319.18, "cnt": 128}, "fwd-MLP":{"total": 2458.16, "avg": 19.20, "max": 10.80, "min": 688.64, "cnt": 128}, "MoE_L0_fwd":{"total": 1244.36, "avg": 38.89, "max": 11.32, "min": 688.41, "cnt": 32}, "MoEMLP":{"total": 2439.04, "avg": 19.05, "max": 10.68, "min": 688.33, "cnt": 128}, "MoE_L1_fwd":{"total": 428.71, "avg": 13.40, "max": 11.44, "min": 17.75, "cnt": 32}, "MoE_L2_fwd":{"total": 384.96, "avg": 12.03, "max": 10.85, "min": 15.53, "cnt": 32}, "MoE_L3_fwd":{"total": 387.99, "avg": 12.12, "max": 10.73, "min": 18.09, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.62, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 98.34, "avg": 98.34, "max": 98.34, "min": 98.34, "cnt": 1}, "forward-send-backward-recv":{"total": 2243.40, "avg": 72.37, "max": 1.11, "min": 1697.16, "cnt": 31}, "backward-compute":{"total": 1899.28, "avg": 59.35, "max": 45.83, "min": 416.82, "cnt": 32}, "MoE_L3_bwd":{"total": 418.67, "avg": 13.08, "max": 11.07, "min": 43.41, "cnt": 32}, "MoE_L2_bwd":{"total": 330.74, "avg": 10.34, "max": 9.47, "min": 12.26, "cnt": 32}, "MoE_L1_bwd":{"total": 302.66, "avg": 9.46, "max": 8.63, "min": 12.00, "cnt": 32}, "MoE_L0_bwd":{"total": 285.44, "avg": 8.92, "max": 8.62, "min": 9.67, "cnt": 32}, "backward-send-forward-recv":{"total": 10437.91, "avg": 347.93, "max": 2.05, "min": 1243.43, "cnt": 30}, "backward-send":{"total": 2.39, "avg": 1.19, "max": 1.16, "min": 1.23, "cnt": 2}, "backward-recv":{"total": 83.75, "avg": 83.75, "max": 83.75, "min": 83.75, "cnt": 1}, "backward-params-all-reduce":{"total": 790.22, "avg": 790.22, "max": 790.22, "min": 790.22, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.05, "avg": 0.05, "max": 0.05, "min": 0.05, "cnt": 1}, "optimizer":{"total": 729.99, "avg": 729.99, "max": 729.99, "min": 729.99, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 383.49, "avg": 383.49, "max": 383.49, "min": 383.49, "cnt": 1}, "optimizer-clip-main-grad":{"total": 78.33, "avg": 78.33, "max": 78.33, "min": 78.33, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.81, "avg": 3.81, "max": 3.81, "min": 3.81, "cnt": 1}}}
{"type":"time", "iteration": 2, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 121.24, "avg": 60.62, "max": 1.43, "min": 119.81, "cnt": 2}, "forward-compute":{"total": 2031.78, "avg": 63.49, "max": 54.60, "min": 72.90, "cnt": 32}, "fwd-compute":{"total": 2027.41, "avg": 63.36, "max": 54.47, "min": 72.81, "cnt": 32}, "batch-generator":{"total": 63.67, "avg": 1.99, "max": 0.94, "min": 4.90, "cnt": 32}, "fwd-embedding":{"total": 0.74, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1948.68, "avg": 60.90, "max": 53.06, "min": 71.22, "cnt": 32}, "fwd-layernorm":{"total": 12.06, "avg": 0.09, "max": 0.06, "min": 0.45, "cnt": 128}, "fwd-attn":{"total": 119.91, "avg": 0.94, "max": 0.74, "min": 2.80, "cnt": 128}, "fwd-misc":{"total": 24.71, "avg": 0.19, "max": 0.12, "min": 0.58, "cnt": 128}, "fwd-MLP":{"total": 1766.03, "avg": 13.80, "max": 10.50, "min": 29.42, "cnt": 128}, "MoE_L0_fwd":{"total": 565.44, "avg": 17.67, "max": 11.97, "min": 29.33, "cnt": 32}, "MoEMLP":{"total": 1746.14, "avg": 13.64, "max": 10.38, "min": 29.28, "cnt": 128}, "MoE_L1_fwd":{"total": 366.28, "avg": 11.45, "max": 10.43, "min": 14.24, "cnt": 32}, "MoE_L2_fwd":{"total": 411.25, "avg": 12.85, "max": 11.49, "min": 18.73, "cnt": 32}, "MoE_L3_fwd":{"total": 410.12, "avg": 12.82, "max": 11.58, "min": 17.94, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.03, "avg": 1.03, "max": 1.03, "min": 1.03, "cnt": 1}, "forward-send-backward-recv":{"total": 356.35, "avg": 11.50, "max": 1.17, "min": 79.93, "cnt": 31}, "backward-compute":{"total": 1798.93, "avg": 56.22, "max": 52.02, "min": 60.27, "cnt": 32}, "MoE_L3_bwd":{"total": 446.59, "avg": 13.96, "max": 12.84, "min": 16.88, "cnt": 32}, "MoE_L2_bwd":{"total": 397.29, "avg": 12.42, "max": 11.52, "min": 13.52, "cnt": 32}, "MoE_L1_bwd":{"total": 332.72, "avg": 10.40, "max": 9.50, "min": 11.24, "cnt": 32}, "MoE_L0_bwd":{"total": 399.06, "avg": 12.47, "max": 11.54, "min": 13.17, "cnt": 32}, "backward-send-forward-recv":{"total": 11651.59, "avg": 388.39, "max": 1.11, "min": 1208.97, "cnt": 30}, "backward-send":{"total": 1.58, "avg": 0.79, "max": 0.52, "min": 1.07, "cnt": 2}, "backward-recv":{"total": 70.60, "avg": 70.60, "max": 70.60, "min": 70.60, "cnt": 1}, "backward-params-all-reduce":{"total": 496.23, "avg": 496.23, "max": 496.23, "min": 496.23, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 300.00, "avg": 300.00, "max": 300.00, "min": 300.00, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 254.60, "avg": 254.60, "max": 254.60, "min": 254.60, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.95, "avg": 6.95, "max": 6.95, "min": 6.95, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 3, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.14, "avg": 0.14, "max": 0.14, "min": 0.14, "cnt": 1}, "forward-recv":{"total": 147.63, "avg": 73.81, "max": 7.59, "min": 140.04, "cnt": 2}, "forward-compute":{"total": 1968.12, "avg": 61.50, "max": 52.15, "min": 75.62, "cnt": 32}, "fwd-compute":{"total": 1964.65, "avg": 61.40, "max": 52.08, "min": 75.44, "cnt": 32}, "batch-generator":{"total": 67.13, "avg": 2.10, "max": 0.67, "min": 5.63, "cnt": 32}, "fwd-embedding":{"total": 0.63, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1884.25, "avg": 58.88, "max": 51.10, "min": 70.01, "cnt": 32}, "fwd-layernorm":{"total": 10.07, "avg": 0.08, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 111.29, "avg": 0.87, "max": 0.74, "min": 2.08, "cnt": 128}, "fwd-misc":{"total": 23.01, "avg": 0.18, "max": 0.11, "min": 0.53, "cnt": 128}, "fwd-MLP":{"total": 1718.04, "avg": 13.42, "max": 10.83, "min": 26.04, "cnt": 128}, "MoE_L0_fwd":{"total": 506.44, "avg": 15.83, "max": 11.13, "min": 25.95, "cnt": 32}, "MoEMLP":{"total": 1700.23, "avg": 13.28, "max": 10.71, "min": 25.89, "cnt": 128}, "MoE_L1_fwd":{"total": 394.75, "avg": 12.34, "max": 10.76, "min": 18.37, "cnt": 32}, "MoE_L2_fwd":{"total": 400.18, "avg": 12.51, "max": 11.23, "min": 16.85, "cnt": 32}, "MoE_L3_fwd":{"total": 405.57, "avg": 12.67, "max": 11.90, "min": 16.68, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.61, "avg": 0.02, "max": 0.02, "min": 0.04, "cnt": 32}, "forward-send":{"total": 0.84, "avg": 0.84, "max": 0.84, "min": 0.84, "cnt": 1}, "forward-send-backward-recv":{"total": 621.75, "avg": 20.06, "max": 0.93, "min": 247.94, "cnt": 31}, "backward-compute":{"total": 1780.65, "avg": 55.65, "max": 50.87, "min": 59.70, "cnt": 32}, "MoE_L3_bwd":{"total": 460.70, "avg": 14.40, "max": 13.17, "min": 16.72, "cnt": 32}, "MoE_L2_bwd":{"total": 413.03, "avg": 12.91, "max": 11.25, "min": 16.82, "cnt": 32}, "MoE_L1_bwd":{"total": 361.14, "avg": 11.29, "max": 10.42, "min": 13.87, "cnt": 32}, "MoE_L0_bwd":{"total": 331.81, "avg": 10.37, "max": 9.73, "min": 11.15, "cnt": 32}, "backward-send-forward-recv":{"total": 9483.89, "avg": 316.13, "max": 1.26, "min": 2336.30, "cnt": 30}, "backward-send":{"total": 1.18, "avg": 0.59, "max": 0.45, "min": 0.73, "cnt": 2}, "backward-recv":{"total": 74.97, "avg": 74.97, "max": 74.97, "min": 74.97, "cnt": 1}, "backward-params-all-reduce":{"total": 500.20, "avg": 500.20, "max": 500.20, "min": 500.20, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.04, "avg": 0.04, "max": 0.04, "min": 0.04, "cnt": 1}, "optimizer":{"total": 303.50, "avg": 303.50, "max": 303.50, "min": 303.50, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.41, "avg": 3.41, "max": 3.41, "min": 3.41, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 257.16, "avg": 257.16, "max": 257.16, "min": 257.16, "cnt": 1}, "optimizer-clip-main-grad":{"total": 8.60, "avg": 8.60, "max": 8.60, "min": 8.60, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.48, "avg": 3.48, "max": 3.48, "min": 3.48, "cnt": 1}}}
{"type":"time", "iteration": 4, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.11, "avg": 0.11, "max": 0.11, "min": 0.11, "cnt": 1}, "forward-recv":{"total": 134.59, "avg": 67.30, "max": 3.47, "min": 131.13, "cnt": 2}, "forward-compute":{"total": 2026.45, "avg": 63.33, "max": 55.43, "min": 107.25, "cnt": 32}, "fwd-compute":{"total": 2023.24, "avg": 63.23, "max": 55.34, "min": 107.16, "cnt": 32}, "batch-generator":{"total": 44.71, "avg": 1.40, "max": 0.70, "min": 3.54, "cnt": 32}, "fwd-embedding":{"total": 0.55, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1965.72, "avg": 61.43, "max": 54.11, "min": 105.05, "cnt": 32}, "fwd-layernorm":{"total": 9.55, "avg": 0.07, "max": 0.05, "min": 0.17, "cnt": 128}, "fwd-attn":{"total": 106.36, "avg": 0.83, "max": 0.74, "min": 2.06, "cnt": 128}, "fwd-misc":{"total": 20.83, "avg": 0.16, "max": 0.12, "min": 0.38, "cnt": 128}, "fwd-MLP":{"total": 1807.75, "avg": 14.12, "max": 11.47, "min": 61.29, "cnt": 128}, "MoE_L0_fwd":{"total": 553.75, "avg": 17.30, "max": 11.74, "min": 61.20, "cnt": 32}, "MoEMLP":{"total": 1790.57, "avg": 13.99, "max": 11.36, "min": 61.15, "cnt": 128}, "MoE_L1_fwd":{"total": 415.57, "avg": 12.99, "max": 11.62, "min": 14.81, "cnt": 32}, "MoE_L2_fwd":{"total": 379.78, "avg": 11.87, "max": 11.40, "min": 13.27, "cnt": 32}, "MoE_L3_fwd":{"total": 447.76, "avg": 13.99, "max": 13.36, "min": 16.44, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 0.82, "avg": 0.82, "max": 0.82, "min": 0.82, "cnt": 1}, "forward-send-backward-recv":{"total": 4861.13, "avg": 156.81, "max": 1.01, "min": 929.94, "cnt": 31}, "backward-compute":{"total": 1926.82, "avg": 60.21, "max": 57.11, "min": 64.04, "cnt": 32}, "MoE_L3_bwd":{"total": 547.84, "avg": 17.12, "max": 15.01, "min": 21.35, "cnt": 32}, "MoE_L2_bwd":{"total": 399.87, "avg": 12.50, "max": 11.46, "min": 15.34, "cnt": 32}, "MoE_L1_bwd":{"total": 395.81, "avg": 12.37, "max": 11.60, "min": 12.75, "cnt": 32}, "MoE_L0_bwd":{"total": 371.57, "avg": 11.61, "max": 10.98, "min": 13.23, "cnt": 32}, "backward-send-forward-recv":{"total": 7136.03, "avg": 237.87, "max": 1.10, "min": 1312.65, "cnt": 30}, "backward-send":{"total": 1.84, "avg": 0.92, "max": 0.81, "min": 1.03, "cnt": 2}, "backward-recv":{"total": 720.13, "avg": 720.13, "max": 720.13, "min": 720.13, "cnt": 1}, "backward-params-all-reduce":{"total": 492.43, "avg": 492.43, "max": 492.43, "min": 492.43, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.04, "avg": 0.04, "max": 0.04, "min": 0.04, "cnt": 1}, "optimizer":{"total": 307.99, "avg": 307.99, "max": 307.99, "min": 307.99, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 263.23, "avg": 263.23, "max": 263.23, "min": 263.23, "cnt": 1}, "optimizer-clip-main-grad":{"total": 7.21, "avg": 7.21, "max": 7.21, "min": 7.21, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.51, "avg": 3.51, "max": 3.51, "min": 3.51, "cnt": 1}}}
{"type":"time", "iteration": 5, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.10, "avg": 0.10, "max": 0.10, "min": 0.10, "cnt": 1}, "forward-recv":{"total": 138.20, "avg": 69.10, "max": 7.80, "min": 130.39, "cnt": 2}, "forward-compute":{"total": 2037.59, "avg": 63.67, "max": 56.45, "min": 70.69, "cnt": 32}, "fwd-compute":{"total": 2033.66, "avg": 63.55, "max": 56.35, "min": 70.49, "cnt": 32}, "batch-generator":{"total": 56.27, "avg": 1.76, "max": 0.82, "min": 5.01, "cnt": 32}, "fwd-embedding":{"total": 0.75, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1963.27, "avg": 61.35, "max": 54.98, "min": 66.71, "cnt": 32}, "fwd-layernorm":{"total": 11.02, "avg": 0.09, "max": 0.05, "min": 0.26, "cnt": 128}, "fwd-attn":{"total": 116.63, "avg": 0.91, "max": 0.74, "min": 4.42, "cnt": 128}, "fwd-misc":{"total": 23.38, "avg": 0.18, "max": 0.11, "min": 0.44, "cnt": 128}, "fwd-MLP":{"total": 1789.15, "avg": 13.98, "max": 10.78, "min": 21.89, "cnt": 128}, "MoE_L0_fwd":{"total": 529.92, "avg": 16.56, "max": 11.95, "min": 21.76, "cnt": 32}, "MoEMLP":{"total": 1770.27, "avg": 13.83, "max": 10.66, "min": 21.71, "cnt": 128}, "MoE_L1_fwd":{"total": 388.90, "avg": 12.15, "max": 10.70, "min": 13.54, "cnt": 32}, "MoE_L2_fwd":{"total": 409.86, "avg": 12.81, "max": 11.81, "min": 17.41, "cnt": 32}, "MoE_L3_fwd":{"total": 448.56, "avg": 14.02, "max": 13.20, "min": 16.68, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.61, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 0.94, "avg": 0.94, "max": 0.94, "min": 0.94, "cnt": 1}, "forward-send-backward-recv":{"total": 1972.11, "avg": 63.62, "max": 1.07, "min": 444.06, "cnt": 31}, "backward-compute":{"total": 1924.80, "avg": 60.15, "max": 57.41, "min": 66.72, "cnt": 32}, "MoE_L3_bwd":{"total": 543.49, "avg": 16.98, "max": 15.44, "min": 23.27, "cnt": 32}, "MoE_L2_bwd":{"total": 396.64, "avg": 12.39, "max": 11.44, "min": 12.88, "cnt": 32}, "MoE_L1_bwd":{"total": 368.75, "avg": 11.52, "max": 10.68, "min": 13.34, "cnt": 32}, "MoE_L0_bwd":{"total": 403.79, "avg": 12.62, "max": 11.76, "min": 14.07, "cnt": 32}, "backward-send-forward-recv":{"total": 5813.21, "avg": 193.77, "max": 1.68, "min": 785.32, "cnt": 30}, "backward-send":{"total": 1.95, "avg": 0.98, "max": 0.96, "min": 0.99, "cnt": 2}, "backward-recv":{"total": 65.63, "avg": 65.63, "max": 65.63, "min": 65.63, "cnt": 1}, "backward-params-all-reduce":{"total": 501.32, "avg": 501.32, "max": 501.32, "min": 501.32, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "optimizer":{"total": 296.50, "avg": 296.50, "max": 296.50, "min": 296.50, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 252.12, "avg": 252.12, "max": 252.12, "min": 252.12, "cnt": 1}, "optimizer-clip-main-grad":{"total": 7.02, "avg": 7.02, "max": 7.02, "min": 7.02, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 6, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.22, "avg": 0.22, "max": 0.22, "min": 0.22, "cnt": 1}, "forward-recv":{"total": 140.48, "avg": 70.24, "max": 5.94, "min": 134.54, "cnt": 2}, "forward-compute":{"total": 1963.40, "avg": 61.36, "max": 55.09, "min": 65.40, "cnt": 32}, "fwd-compute":{"total": 1959.88, "avg": 61.25, "max": 54.97, "min": 65.31, "cnt": 32}, "batch-generator":{"total": 47.83, "avg": 1.49, "max": 0.78, "min": 3.53, "cnt": 32}, "fwd-embedding":{"total": 0.79, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1898.59, "avg": 59.33, "max": 53.56, "min": 62.42, "cnt": 32}, "fwd-layernorm":{"total": 10.87, "avg": 0.08, "max": 0.05, "min": 0.24, "cnt": 128}, "fwd-attn":{"total": 116.72, "avg": 0.91, "max": 0.74, "min": 1.98, "cnt": 128}, "fwd-misc":{"total": 23.28, "avg": 0.18, "max": 0.11, "min": 0.43, "cnt": 128}, "fwd-MLP":{"total": 1724.96, "avg": 13.48, "max": 11.08, "min": 21.31, "cnt": 128}, "MoE_L0_fwd":{"total": 535.41, "avg": 16.73, "max": 12.83, "min": 21.20, "cnt": 32}, "MoEMLP":{"total": 1706.32, "avg": 13.33, "max": 10.96, "min": 21.16, "cnt": 128}, "MoE_L1_fwd":{"total": 386.32, "avg": 12.07, "max": 11.01, "min": 14.07, "cnt": 32}, "MoE_L2_fwd":{"total": 417.35, "avg": 13.04, "max": 12.43, "min": 14.25, "cnt": 32}, "MoE_L3_fwd":{"total": 374.00, "avg": 11.69, "max": 11.23, "min": 13.50, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.61, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 0.98, "avg": 0.98, "max": 0.98, "min": 0.98, "cnt": 1}, "forward-send-backward-recv":{"total": 3106.42, "avg": 100.21, "max": 1.32, "min": 576.87, "cnt": 31}, "backward-compute":{"total": 1896.01, "avg": 59.25, "max": 55.56, "min": 63.42, "cnt": 32}, "MoE_L3_bwd":{"total": 433.34, "avg": 13.54, "max": 12.57, "min": 17.76, "cnt": 32}, "MoE_L2_bwd":{"total": 458.60, "avg": 14.33, "max": 13.38, "min": 14.97, "cnt": 32}, "MoE_L1_bwd":{"total": 367.38, "avg": 11.48, "max": 10.90, "min": 12.18, "cnt": 32}, "MoE_L0_bwd":{"total": 422.14, "avg": 13.19, "max": 12.42, "min": 14.29, "cnt": 32}, "backward-send-forward-recv":{"total": 5174.20, "avg": 172.47, "max": 1.05, "min": 732.48, "cnt": 30}, "backward-send":{"total": 1.54, "avg": 0.77, "max": 0.48, "min": 1.06, "cnt": 2}, "backward-recv":{"total": 151.90, "avg": 151.90, "max": 151.90, "min": 151.90, "cnt": 1}, "backward-params-all-reduce":{"total": 487.16, "avg": 487.16, "max": 487.16, "min": 487.16, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.04, "avg": 0.04, "max": 0.04, "min": 0.04, "cnt": 1}, "optimizer":{"total": 305.65, "avg": 305.65, "max": 305.65, "min": 305.65, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 260.16, "avg": 260.16, "max": 260.16, "min": 260.16, "cnt": 1}, "optimizer-clip-main-grad":{"total": 7.47, "avg": 7.47, "max": 7.47, "min": 7.47, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.81, "avg": 3.81, "max": 3.81, "min": 3.81, "cnt": 1}}}
{"type":"time", "iteration": 7, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.11, "avg": 0.11, "max": 0.11, "min": 0.11, "cnt": 1}, "forward-recv":{"total": 145.81, "avg": 72.91, "max": 1.13, "min": 144.68, "cnt": 2}, "forward-compute":{"total": 1980.25, "avg": 61.88, "max": 54.58, "min": 72.40, "cnt": 32}, "fwd-compute":{"total": 1976.87, "avg": 61.78, "max": 54.50, "min": 72.32, "cnt": 32}, "batch-generator":{"total": 52.39, "avg": 1.64, "max": 0.71, "min": 4.90, "cnt": 32}, "fwd-embedding":{"total": 0.65, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1911.88, "avg": 59.75, "max": 53.34, "min": 69.56, "cnt": 32}, "fwd-layernorm":{"total": 10.12, "avg": 0.08, "max": 0.05, "min": 0.22, "cnt": 128}, "fwd-attn":{"total": 111.55, "avg": 0.87, "max": 0.74, "min": 1.55, "cnt": 128}, "fwd-misc":{"total": 21.82, "avg": 0.17, "max": 0.11, "min": 0.39, "cnt": 128}, "fwd-MLP":{"total": 1746.94, "avg": 13.65, "max": 10.95, "min": 20.80, "cnt": 128}, "MoE_L0_fwd":{"total": 466.82, "avg": 14.59, "max": 10.85, "min": 20.61, "cnt": 32}, "MoEMLP":{"total": 1729.44, "avg": 13.51, "max": 10.81, "min": 20.55, "cnt": 128}, "MoE_L1_fwd":{"total": 443.60, "avg": 13.86, "max": 12.36, "min": 17.57, "cnt": 32}, "MoE_L2_fwd":{"total": 452.57, "avg": 14.14, "max": 13.22, "min": 16.21, "cnt": 32}, "MoE_L3_fwd":{"total": 372.82, "avg": 11.65, "max": 11.07, "min": 13.13, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 0.85, "avg": 0.85, "max": 0.85, "min": 0.85, "cnt": 1}, "forward-send-backward-recv":{"total": 411.00, "avg": 13.26, "max": 0.86, "min": 179.52, "cnt": 31}, "backward-compute":{"total": 1887.90, "avg": 59.00, "max": 54.33, "min": 60.57, "cnt": 32}, "MoE_L3_bwd":{"total": 428.60, "avg": 13.39, "max": 11.77, "min": 14.48, "cnt": 32}, "MoE_L2_bwd":{"total": 519.91, "avg": 16.25, "max": 14.52, "min": 17.24, "cnt": 32}, "MoE_L1_bwd":{"total": 385.56, "avg": 12.05, "max": 11.41, "min": 12.82, "cnt": 32}, "MoE_L0_bwd":{"total": 340.39, "avg": 10.64, "max": 9.96, "min": 11.33, "cnt": 32}, "backward-send-forward-recv":{"total": 9869.73, "avg": 328.99, "max": 2.44, "min": 1368.79, "cnt": 30}, "backward-send":{"total": 2.03, "avg": 1.02, "max": 0.98, "min": 1.05, "cnt": 2}, "backward-recv":{"total": 57.68, "avg": 57.68, "max": 57.68, "min": 57.68, "cnt": 1}, "backward-params-all-reduce":{"total": 493.66, "avg": 493.66, "max": 493.66, "min": 493.66, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 313.66, "avg": 313.66, "max": 313.66, "min": 313.66, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 268.14, "avg": 268.14, "max": 268.14, "min": 268.14, "cnt": 1}, "optimizer-clip-main-grad":{"total": 7.73, "avg": 7.73, "max": 7.73, "min": 7.73, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.59, "avg": 3.59, "max": 3.59, "min": 3.59, "cnt": 1}}}
{"type":"time", "iteration": 8, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 142.33, "avg": 71.16, "max": 1.13, "min": 141.20, "cnt": 2}, "forward-compute":{"total": 2024.52, "avg": 63.27, "max": 55.42, "min": 69.47, "cnt": 32}, "fwd-compute":{"total": 2021.20, "avg": 63.16, "max": 55.35, "min": 69.30, "cnt": 32}, "batch-generator":{"total": 46.24, "avg": 1.44, "max": 0.71, "min": 2.76, "cnt": 32}, "fwd-embedding":{"total": 0.68, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1961.54, "avg": 61.30, "max": 54.29, "min": 67.16, "cnt": 32}, "fwd-layernorm":{"total": 12.52, "avg": 0.10, "max": 0.05, "min": 2.20, "cnt": 128}, "fwd-attn":{"total": 114.09, "avg": 0.89, "max": 0.74, "min": 1.69, "cnt": 128}, "fwd-misc":{"total": 22.90, "avg": 0.18, "max": 0.12, "min": 0.39, "cnt": 128}, "fwd-MLP":{"total": 1789.62, "avg": 13.98, "max": 10.75, "min": 21.43, "cnt": 128}, "MoE_L0_fwd":{"total": 520.03, "avg": 16.25, "max": 12.23, "min": 21.32, "cnt": 32}, "MoEMLP":{"total": 1771.48, "avg": 13.84, "max": 10.64, "min": 21.26, "cnt": 128}, "MoE_L1_fwd":{"total": 407.83, "avg": 12.74, "max": 11.28, "min": 16.72, "cnt": 32}, "MoE_L2_fwd":{"total": 482.84, "avg": 15.09, "max": 14.46, "min": 18.28, "cnt": 32}, "MoE_L3_fwd":{"total": 367.53, "avg": 11.49, "max": 10.68, "min": 17.37, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.28, "avg": 1.28, "max": 1.28, "min": 1.28, "cnt": 1}, "forward-send-backward-recv":{"total": 1462.59, "avg": 47.18, "max": 0.98, "min": 504.03, "cnt": 31}, "backward-compute":{"total": 1961.09, "avg": 61.28, "max": 57.22, "min": 64.47, "cnt": 32}, "MoE_L3_bwd":{"total": 421.17, "avg": 13.16, "max": 11.91, "min": 14.67, "cnt": 32}, "MoE_L2_bwd":{"total": 575.44, "avg": 17.98, "max": 17.05, "min": 20.64, "cnt": 32}, "MoE_L1_bwd":{"total": 374.92, "avg": 11.72, "max": 10.99, "min": 12.67, "cnt": 32}, "MoE_L0_bwd":{"total": 375.74, "avg": 11.74, "max": 11.03, "min": 12.04, "cnt": 32}, "backward-send-forward-recv":{"total": 7357.59, "avg": 245.25, "max": 1.11, "min": 1145.02, "cnt": 30}, "backward-send":{"total": 1.53, "avg": 0.76, "max": 0.65, "min": 0.88, "cnt": 2}, "backward-recv":{"total": 78.64, "avg": 78.64, "max": 78.64, "min": 78.64, "cnt": 1}, "backward-params-all-reduce":{"total": 491.28, "avg": 491.28, "max": 491.28, "min": 491.28, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 307.87, "avg": 307.87, "max": 307.87, "min": 307.87, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 263.60, "avg": 263.60, "max": 263.60, "min": 263.60, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.87, "avg": 6.87, "max": 6.87, "min": 6.87, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.48, "avg": 3.48, "max": 3.48, "min": 3.48, "cnt": 1}}}
{"type":"time", "iteration": 9, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 138.10, "avg": 69.05, "max": 0.86, "min": 137.24, "cnt": 2}, "forward-compute":{"total": 1971.42, "avg": 61.61, "max": 54.06, "min": 68.87, "cnt": 32}, "fwd-compute":{"total": 1968.19, "avg": 61.51, "max": 53.99, "min": 68.79, "cnt": 32}, "batch-generator":{"total": 51.89, "avg": 1.62, "max": 0.64, "min": 12.01, "cnt": 32}, "fwd-embedding":{"total": 0.61, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1904.09, "avg": 59.50, "max": 53.05, "min": 65.63, "cnt": 32}, "fwd-layernorm":{"total": 9.54, "avg": 0.07, "max": 0.06, "min": 0.18, "cnt": 128}, "fwd-attn":{"total": 109.02, "avg": 0.85, "max": 0.75, "min": 1.44, "cnt": 128}, "fwd-misc":{"total": 21.34, "avg": 0.17, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1742.86, "avg": 13.62, "max": 10.86, "min": 22.46, "cnt": 128}, "MoE_L0_fwd":{"total": 521.51, "avg": 16.30, "max": 12.39, "min": 22.37, "cnt": 32}, "MoEMLP":{"total": 1725.70, "avg": 13.48, "max": 10.74, "min": 22.32, "cnt": 128}, "MoE_L1_fwd":{"total": 428.05, "avg": 13.38, "max": 11.81, "min": 17.65, "cnt": 32}, "MoE_L2_fwd":{"total": 396.60, "avg": 12.39, "max": 11.50, "min": 13.91, "cnt": 32}, "MoE_L3_fwd":{"total": 385.88, "avg": 12.06, "max": 10.78, "min": 13.39, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.61, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 0.94, "avg": 0.94, "max": 0.94, "min": 0.94, "cnt": 1}, "forward-send-backward-recv":{"total": 3570.92, "avg": 115.19, "max": 0.98, "min": 888.08, "cnt": 31}, "backward-compute":{"total": 1751.74, "avg": 54.74, "max": 50.73, "min": 59.99, "cnt": 32}, "MoE_L3_bwd":{"total": 414.24, "avg": 12.95, "max": 11.76, "min": 15.42, "cnt": 32}, "MoE_L2_bwd":{"total": 379.12, "avg": 11.85, "max": 10.49, "min": 13.83, "cnt": 32}, "MoE_L1_bwd":{"total": 361.16, "avg": 11.29, "max": 10.55, "min": 12.85, "cnt": 32}, "MoE_L0_bwd":{"total": 380.69, "avg": 11.90, "max": 11.16, "min": 14.31, "cnt": 32}, "backward-send-forward-recv":{"total": 5931.34, "avg": 197.71, "max": 1.29, "min": 1156.65, "cnt": 30}, "backward-send":{"total": 1.49, "avg": 0.74, "max": 0.48, "min": 1.01, "cnt": 2}, "backward-recv":{"total": 344.77, "avg": 344.77, "max": 344.77, "min": 344.77, "cnt": 1}, "backward-params-all-reduce":{"total": 495.99, "avg": 495.99, "max": 495.99, "min": 495.99, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.04, "avg": 0.04, "max": 0.04, "min": 0.04, "cnt": 1}, "optimizer":{"total": 268.92, "avg": 268.92, "max": 268.92, "min": 268.92, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 261.91, "avg": 261.91, "max": 261.91, "min": 261.91, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.51, "avg": 3.51, "max": 3.51, "min": 3.51, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}}}
{"type":"time", "iteration": 10, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.10, "avg": 0.10, "max": 0.10, "min": 0.10, "cnt": 1}, "forward-recv":{"total": 140.14, "avg": 70.07, "max": 10.76, "min": 129.39, "cnt": 2}, "forward-compute":{"total": 1979.21, "avg": 61.85, "max": 53.82, "min": 71.65, "cnt": 32}, "fwd-compute":{"total": 1975.99, "avg": 61.75, "max": 53.73, "min": 71.57, "cnt": 32}, "batch-generator":{"total": 43.66, "avg": 1.36, "max": 0.69, "min": 2.77, "cnt": 32}, "fwd-embedding":{"total": 0.60, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1919.91, "avg": 60.00, "max": 52.52, "min": 69.93, "cnt": 32}, "fwd-layernorm":{"total": 9.56, "avg": 0.07, "max": 0.05, "min": 0.23, "cnt": 128}, "fwd-attn":{"total": 111.65, "avg": 0.87, "max": 0.75, "min": 3.21, "cnt": 128}, "fwd-misc":{"total": 21.41, "avg": 0.17, "max": 0.11, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1756.47, "avg": 13.72, "max": 11.22, "min": 27.98, "cnt": 128}, "MoE_L0_fwd":{"total": 546.45, "avg": 17.08, "max": 12.36, "min": 27.89, "cnt": 32}, "MoEMLP":{"total": 1739.12, "avg": 13.59, "max": 11.11, "min": 27.84, "cnt": 128}, "MoE_L1_fwd":{"total": 411.97, "avg": 12.87, "max": 11.65, "min": 15.78, "cnt": 32}, "MoE_L2_fwd":{"total": 406.01, "avg": 12.69, "max": 11.43, "min": 13.90, "cnt": 32}, "MoE_L3_fwd":{"total": 381.09, "avg": 11.91, "max": 11.15, "min": 15.48, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 0.88, "avg": 0.88, "max": 0.88, "min": 0.88, "cnt": 1}, "forward-send-backward-recv":{"total": 1780.71, "avg": 57.44, "max": 1.14, "min": 425.80, "cnt": 31}, "backward-compute":{"total": 1744.15, "avg": 54.50, "max": 50.58, "min": 57.92, "cnt": 32}, "MoE_L3_bwd":{"total": 413.85, "avg": 12.93, "max": 11.35, "min": 15.23, "cnt": 32}, "MoE_L2_bwd":{"total": 376.44, "avg": 11.76, "max": 10.59, "min": 13.07, "cnt": 32}, "MoE_L1_bwd":{"total": 359.35, "avg": 11.23, "max": 10.38, "min": 12.49, "cnt": 32}, "MoE_L0_bwd":{"total": 379.84, "avg": 11.87, "max": 10.88, "min": 14.01, "cnt": 32}, "backward-send-forward-recv":{"total": 5295.71, "avg": 176.52, "max": 1.05, "min": 894.80, "cnt": 30}, "backward-send":{"total": 1.87, "avg": 0.93, "max": 0.87, "min": 0.99, "cnt": 2}, "backward-recv":{"total": 77.26, "avg": 77.26, "max": 77.26, "min": 77.26, "cnt": 1}, "backward-params-all-reduce":{"total": 498.33, "avg": 498.33, "max": 498.33, "min": 498.33, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 276.62, "avg": 276.62, "max": 276.62, "min": 276.62, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 253.49, "avg": 253.49, "max": 253.49, "min": 253.49, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.65, "avg": 3.65, "max": 3.65, "min": 3.65, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}}}
{"type":"time", "iteration": 11, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 135.92, "avg": 67.96, "max": 0.76, "min": 135.16, "cnt": 2}, "forward-compute":{"total": 1933.44, "avg": 60.42, "max": 54.74, "min": 67.43, "cnt": 32}, "fwd-compute":{"total": 1930.55, "avg": 60.33, "max": 54.66, "min": 67.34, "cnt": 32}, "batch-generator":{"total": 45.40, "avg": 1.42, "max": 0.72, "min": 2.89, "cnt": 32}, "fwd-embedding":{"total": 0.56, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1873.53, "avg": 58.55, "max": 52.85, "min": 64.51, "cnt": 32}, "fwd-layernorm":{"total": 9.07, "avg": 0.07, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 107.87, "avg": 0.84, "max": 0.75, "min": 1.67, "cnt": 128}, "fwd-misc":{"total": 20.56, "avg": 0.16, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1716.12, "avg": 13.41, "max": 10.79, "min": 20.42, "cnt": 128}, "MoE_L0_fwd":{"total": 514.67, "avg": 16.08, "max": 12.01, "min": 20.34, "cnt": 32}, "MoEMLP":{"total": 1699.48, "avg": 13.28, "max": 10.66, "min": 20.30, "cnt": 128}, "MoE_L1_fwd":{"total": 407.68, "avg": 12.74, "max": 11.72, "min": 13.85, "cnt": 32}, "MoE_L2_fwd":{"total": 401.96, "avg": 12.56, "max": 10.72, "min": 15.32, "cnt": 32}, "MoE_L3_fwd":{"total": 381.30, "avg": 11.92, "max": 10.91, "min": 15.98, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 0.44, "avg": 0.44, "max": 0.44, "min": 0.44, "cnt": 1}, "forward-send-backward-recv":{"total": 924.75, "avg": 29.83, "max": 1.09, "min": 243.85, "cnt": 31}, "backward-compute":{"total": 1749.74, "avg": 54.68, "max": 52.81, "min": 58.49, "cnt": 32}, "MoE_L3_bwd":{"total": 419.13, "avg": 13.10, "max": 11.85, "min": 18.78, "cnt": 32}, "MoE_L2_bwd":{"total": 384.55, "avg": 12.02, "max": 10.24, "min": 13.58, "cnt": 32}, "MoE_L1_bwd":{"total": 359.03, "avg": 11.22, "max": 10.38, "min": 12.41, "cnt": 32}, "MoE_L0_bwd":{"total": 373.16, "avg": 11.66, "max": 10.98, "min": 13.03, "cnt": 32}, "backward-send-forward-recv":{"total": 6551.35, "avg": 218.38, "max": 2.01, "min": 856.24, "cnt": 30}, "backward-send":{"total": 1.54, "avg": 0.77, "max": 0.44, "min": 1.10, "cnt": 2}, "backward-recv":{"total": 176.50, "avg": 176.50, "max": 176.50, "min": 176.50, "cnt": 1}, "backward-params-all-reduce":{"total": 489.02, "avg": 489.02, "max": 489.02, "min": 489.02, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 272.92, "avg": 272.92, "max": 272.92, "min": 272.92, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 262.48, "avg": 262.48, "max": 262.48, "min": 262.48, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.95, "avg": 6.95, "max": 6.95, "min": 6.95, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}}}
{"type":"time", "iteration": 12, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.11, "avg": 0.11, "max": 0.11, "min": 0.11, "cnt": 1}, "forward-recv":{"total": 127.78, "avg": 63.89, "max": 1.93, "min": 125.84, "cnt": 2}, "forward-compute":{"total": 1923.48, "avg": 60.11, "max": 53.70, "min": 67.67, "cnt": 32}, "fwd-compute":{"total": 1920.36, "avg": 60.01, "max": 53.63, "min": 67.59, "cnt": 32}, "batch-generator":{"total": 59.49, "avg": 1.86, "max": 0.72, "min": 3.75, "cnt": 32}, "fwd-embedding":{"total": 0.60, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1848.67, "avg": 57.77, "max": 52.23, "min": 65.59, "cnt": 32}, "fwd-layernorm":{"total": 9.93, "avg": 0.08, "max": 0.05, "min": 0.24, "cnt": 128}, "fwd-attn":{"total": 109.09, "avg": 0.85, "max": 0.75, "min": 1.92, "cnt": 128}, "fwd-misc":{"total": 21.50, "avg": 0.17, "max": 0.11, "min": 0.40, "cnt": 128}, "fwd-MLP":{"total": 1687.08, "avg": 13.18, "max": 10.86, "min": 22.17, "cnt": 128}, "MoE_L0_fwd":{"total": 508.70, "avg": 15.90, "max": 12.11, "min": 22.09, "cnt": 32}, "MoEMLP":{"total": 1669.67, "avg": 13.04, "max": 10.75, "min": 22.04, "cnt": 128}, "MoE_L1_fwd":{"total": 404.50, "avg": 12.64, "max": 11.70, "min": 15.08, "cnt": 32}, "MoE_L2_fwd":{"total": 391.69, "avg": 12.24, "max": 11.02, "min": 16.31, "cnt": 32}, "MoE_L3_fwd":{"total": 371.29, "avg": 11.60, "max": 10.79, "min": 15.12, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 0.85, "avg": 0.85, "max": 0.85, "min": 0.85, "cnt": 1}, "forward-send-backward-recv":{"total": 711.87, "avg": 22.96, "max": 1.38, "min": 179.52, "cnt": 31}, "backward-compute":{"total": 1728.87, "avg": 54.03, "max": 52.40, "min": 56.86, "cnt": 32}, "MoE_L3_bwd":{"total": 406.25, "avg": 12.70, "max": 11.88, "min": 14.29, "cnt": 32}, "MoE_L2_bwd":{"total": 370.09, "avg": 11.57, "max": 10.65, "min": 13.23, "cnt": 32}, "MoE_L1_bwd":{"total": 357.53, "avg": 11.17, "max": 10.16, "min": 14.42, "cnt": 32}, "MoE_L0_bwd":{"total": 377.16, "avg": 11.79, "max": 11.17, "min": 13.75, "cnt": 32}, "backward-send-forward-recv":{"total": 7614.45, "avg": 253.81, "max": 1.42, "min": 987.50, "cnt": 30}, "backward-send":{"total": 1.82, "avg": 0.91, "max": 0.78, "min": 1.04, "cnt": 2}, "backward-recv":{"total": 70.95, "avg": 70.95, "max": 70.95, "min": 70.95, "cnt": 1}, "backward-params-all-reduce":{"total": 490.93, "avg": 490.93, "max": 490.93, "min": 490.93, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 273.77, "avg": 273.77, "max": 273.77, "min": 273.77, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.48, "avg": 3.48, "max": 3.48, "min": 3.48, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 263.21, "avg": 263.21, "max": 263.21, "min": 263.21, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.79, "avg": 6.79, "max": 6.79, "min": 6.79, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}}}
{"type":"time", "iteration": 13, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.12, "avg": 0.12, "max": 0.12, "min": 0.12, "cnt": 1}, "forward-recv":{"total": 132.59, "avg": 66.29, "max": 0.96, "min": 131.63, "cnt": 2}, "forward-compute":{"total": 2024.76, "avg": 63.27, "max": 55.99, "min": 130.08, "cnt": 32}, "fwd-compute":{"total": 2021.25, "avg": 63.16, "max": 55.89, "min": 129.95, "cnt": 32}, "batch-generator":{"total": 59.33, "avg": 1.85, "max": 0.71, "min": 4.74, "cnt": 32}, "fwd-embedding":{"total": 0.71, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1948.69, "avg": 60.90, "max": 52.53, "min": 127.90, "cnt": 32}, "fwd-layernorm":{"total": 10.45, "avg": 0.08, "max": 0.05, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 113.57, "avg": 0.89, "max": 0.75, "min": 1.62, "cnt": 128}, "fwd-misc":{"total": 21.87, "avg": 0.17, "max": 0.11, "min": 0.38, "cnt": 128}, "fwd-MLP":{"total": 1781.05, "avg": 13.91, "max": 10.85, "min": 86.50, "cnt": 128}, "MoE_L0_fwd":{"total": 592.68, "avg": 18.52, "max": 12.50, "min": 86.34, "cnt": 32}, "MoEMLP":{"total": 1763.43, "avg": 13.78, "max": 10.74, "min": 86.26, "cnt": 128}, "MoE_L1_fwd":{"total": 416.44, "avg": 13.01, "max": 11.89, "min": 18.65, "cnt": 32}, "MoE_L2_fwd":{"total": 394.51, "avg": 12.33, "max": 11.21, "min": 15.12, "cnt": 32}, "MoE_L3_fwd":{"total": 366.27, "avg": 11.45, "max": 10.78, "min": 15.83, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 0.73, "avg": 0.73, "max": 0.73, "min": 0.73, "cnt": 1}, "forward-send-backward-recv":{"total": 506.75, "avg": 16.35, "max": 1.31, "min": 186.55, "cnt": 31}, "backward-compute":{"total": 1716.30, "avg": 53.63, "max": 51.08, "min": 56.43, "cnt": 32}, "MoE_L3_bwd":{"total": 407.40, "avg": 12.73, "max": 11.55, "min": 16.12, "cnt": 32}, "MoE_L2_bwd":{"total": 368.69, "avg": 11.52, "max": 10.47, "min": 13.90, "cnt": 32}, "MoE_L1_bwd":{"total": 354.43, "avg": 11.08, "max": 10.34, "min": 11.71, "cnt": 32}, "MoE_L0_bwd":{"total": 369.76, "avg": 11.56, "max": 11.11, "min": 12.62, "cnt": 32}, "backward-send-forward-recv":{"total": 7220.66, "avg": 240.69, "max": 1.14, "min": 1039.95, "cnt": 30}, "backward-send":{"total": 1.82, "avg": 0.91, "max": 0.84, "min": 0.97, "cnt": 2}, "backward-recv":{"total": 68.13, "avg": 68.13, "max": 68.13, "min": 68.13, "cnt": 1}, "backward-params-all-reduce":{"total": 491.56, "avg": 491.56, "max": 491.56, "min": 491.56, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 298.71, "avg": 298.71, "max": 298.71, "min": 298.71, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 254.33, "avg": 254.33, "max": 254.33, "min": 254.33, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.77, "avg": 6.77, "max": 6.77, "min": 6.77, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.48, "avg": 3.48, "max": 3.48, "min": 3.48, "cnt": 1}}}
{"type":"time", "iteration": 14, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 127.13, "avg": 63.56, "max": 0.96, "min": 126.16, "cnt": 2}, "forward-compute":{"total": 1978.81, "avg": 61.84, "max": 54.58, "min": 68.89, "cnt": 32}, "fwd-compute":{"total": 1975.49, "avg": 61.73, "max": 54.52, "min": 68.70, "cnt": 32}, "batch-generator":{"total": 46.53, "avg": 1.45, "max": 0.74, "min": 4.58, "cnt": 32}, "fwd-embedding":{"total": 0.69, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1915.82, "avg": 59.87, "max": 53.48, "min": 64.96, "cnt": 32}, "fwd-layernorm":{"total": 10.56, "avg": 0.08, "max": 0.05, "min": 0.32, "cnt": 128}, "fwd-attn":{"total": 113.33, "avg": 0.89, "max": 0.74, "min": 2.67, "cnt": 128}, "fwd-misc":{"total": 22.51, "avg": 0.18, "max": 0.12, "min": 0.51, "cnt": 128}, "fwd-MLP":{"total": 1747.03, "avg": 13.65, "max": 10.80, "min": 20.15, "cnt": 128}, "MoE_L0_fwd":{"total": 508.40, "avg": 15.89, "max": 12.52, "min": 20.07, "cnt": 32}, "MoEMLP":{"total": 1728.97, "avg": 13.51, "max": 10.68, "min": 20.02, "cnt": 128}, "MoE_L1_fwd":{"total": 416.19, "avg": 13.01, "max": 12.13, "min": 13.70, "cnt": 32}, "MoE_L2_fwd":{"total": 432.05, "avg": 13.50, "max": 12.97, "min": 17.16, "cnt": 32}, "MoE_L3_fwd":{"total": 378.97, "avg": 11.84, "max": 10.73, "min": 13.80, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 0.86, "avg": 0.86, "max": 0.86, "min": 0.86, "cnt": 1}, "forward-send-backward-recv":{"total": 613.78, "avg": 19.80, "max": 0.86, "min": 170.21, "cnt": 31}, "backward-compute":{"total": 1914.03, "avg": 59.81, "max": 57.29, "min": 63.53, "cnt": 32}, "MoE_L3_bwd":{"total": 441.36, "avg": 13.79, "max": 12.32, "min": 15.86, "cnt": 32}, "MoE_L2_bwd":{"total": 467.08, "avg": 14.60, "max": 13.70, "min": 15.80, "cnt": 32}, "MoE_L1_bwd":{"total": 423.80, "avg": 13.24, "max": 12.51, "min": 13.93, "cnt": 32}, "MoE_L0_bwd":{"total": 369.95, "avg": 11.56, "max": 10.86, "min": 12.95, "cnt": 32}, "backward-send-forward-recv":{"total": 7739.51, "avg": 257.98, "max": 0.99, "min": 1531.77, "cnt": 30}, "backward-send":{"total": 1.73, "avg": 0.87, "max": 0.85, "min": 0.89, "cnt": 2}, "backward-recv":{"total": 64.59, "avg": 64.59, "max": 64.59, "min": 64.59, "cnt": 1}, "backward-params-all-reduce":{"total": 495.40, "avg": 495.40, "max": 495.40, "min": 495.40, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 300.38, "avg": 300.38, "max": 300.38, "min": 300.38, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.50, "avg": 3.50, "max": 3.50, "min": 3.50, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 255.73, "avg": 255.73, "max": 255.73, "min": 255.73, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.94, "avg": 6.94, "max": 6.94, "min": 6.94, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.49, "avg": 3.49, "max": 3.49, "min": 3.49, "cnt": 1}}}
{"type":"time", "iteration": 15, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.12, "avg": 0.12, "max": 0.12, "min": 0.12, "cnt": 1}, "forward-recv":{"total": 131.83, "avg": 65.91, "max": 0.82, "min": 131.01, "cnt": 2}, "forward-compute":{"total": 1938.66, "avg": 60.58, "max": 54.00, "min": 67.80, "cnt": 32}, "fwd-compute":{"total": 1935.37, "avg": 60.48, "max": 53.93, "min": 67.61, "cnt": 32}, "batch-generator":{"total": 58.14, "avg": 1.82, "max": 0.66, "min": 7.30, "cnt": 32}, "fwd-embedding":{"total": 0.68, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1864.59, "avg": 58.27, "max": 52.80, "min": 64.85, "cnt": 32}, "fwd-layernorm":{"total": 10.22, "avg": 0.08, "max": 0.05, "min": 0.33, "cnt": 128}, "fwd-attn":{"total": 110.23, "avg": 0.86, "max": 0.74, "min": 2.55, "cnt": 128}, "fwd-misc":{"total": 21.71, "avg": 0.17, "max": 0.11, "min": 0.51, "cnt": 128}, "fwd-MLP":{"total": 1697.50, "avg": 13.26, "max": 10.94, "min": 18.23, "cnt": 128}, "MoE_L0_fwd":{"total": 457.85, "avg": 14.31, "max": 10.85, "min": 18.15, "cnt": 32}, "MoEMLP":{"total": 1680.03, "avg": 13.13, "max": 10.80, "min": 18.11, "cnt": 128}, "MoE_L1_fwd":{"total": 409.01, "avg": 12.78, "max": 11.76, "min": 14.50, "cnt": 32}, "MoE_L2_fwd":{"total": 435.32, "avg": 13.60, "max": 12.90, "min": 14.82, "cnt": 32}, "MoE_L3_fwd":{"total": 384.42, "avg": 12.01, "max": 11.54, "min": 12.93, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 0.50, "avg": 0.50, "max": 0.50, "min": 0.50, "cnt": 1}, "forward-send-backward-recv":{"total": 1427.67, "avg": 46.05, "max": 0.85, "min": 275.99, "cnt": 31}, "backward-compute":{"total": 1899.79, "avg": 59.37, "max": 56.13, "min": 62.63, "cnt": 32}, "MoE_L3_bwd":{"total": 443.78, "avg": 13.87, "max": 12.48, "min": 15.59, "cnt": 32}, "MoE_L2_bwd":{"total": 476.92, "avg": 14.90, "max": 13.93, "min": 15.73, "cnt": 32}, "MoE_L1_bwd":{"total": 406.25, "avg": 12.70, "max": 12.02, "min": 13.93, "cnt": 32}, "MoE_L0_bwd":{"total": 360.00, "avg": 11.25, "max": 10.42, "min": 12.06, "cnt": 32}, "backward-send-forward-recv":{"total": 4643.34, "avg": 154.78, "max": 0.98, "min": 721.94, "cnt": 30}, "backward-send":{"total": 1.39, "avg": 0.70, "max": 0.58, "min": 0.81, "cnt": 2}, "backward-recv":{"total": 67.59, "avg": 67.59, "max": 67.59, "min": 67.59, "cnt": 1}, "backward-params-all-reduce":{"total": 493.85, "avg": 493.85, "max": 493.85, "min": 493.85, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 298.08, "avg": 298.08, "max": 298.08, "min": 298.08, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.49, "avg": 3.49, "max": 3.49, "min": 3.49, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 253.49, "avg": 253.49, "max": 253.49, "min": 253.49, "cnt": 1}, "optimizer-clip-main-grad":{"total": 7.04, "avg": 7.04, "max": 7.04, "min": 7.04, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.48, "avg": 3.48, "max": 3.48, "min": 3.48, "cnt": 1}}}
{"type":"time", "iteration": 16, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 124.59, "avg": 62.30, "max": 0.75, "min": 123.85, "cnt": 2}, "forward-compute":{"total": 1896.64, "avg": 59.27, "max": 54.31, "min": 71.43, "cnt": 32}, "fwd-compute":{"total": 1893.61, "avg": 59.18, "max": 54.24, "min": 71.35, "cnt": 32}, "batch-generator":{"total": 43.26, "avg": 1.35, "max": 0.65, "min": 2.79, "cnt": 32}, "fwd-embedding":{"total": 0.61, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1837.89, "avg": 57.43, "max": 53.08, "min": 68.10, "cnt": 32}, "fwd-layernorm":{"total": 9.98, "avg": 0.08, "max": 0.05, "min": 0.22, "cnt": 128}, "fwd-attn":{"total": 108.49, "avg": 0.85, "max": 0.74, "min": 1.86, "cnt": 128}, "fwd-misc":{"total": 21.86, "avg": 0.17, "max": 0.11, "min": 0.40, "cnt": 128}, "fwd-MLP":{"total": 1675.62, "avg": 13.09, "max": 10.77, "min": 20.67, "cnt": 128}, "MoE_L0_fwd":{"total": 459.24, "avg": 14.35, "max": 11.74, "min": 20.59, "cnt": 32}, "MoEMLP":{"total": 1657.65, "avg": 12.95, "max": 10.65, "min": 20.55, "cnt": 128}, "MoE_L1_fwd":{"total": 396.69, "avg": 12.40, "max": 11.59, "min": 14.45, "cnt": 32}, "MoE_L2_fwd":{"total": 419.01, "avg": 13.09, "max": 12.29, "min": 14.24, "cnt": 32}, "MoE_L3_fwd":{"total": 389.27, "avg": 12.16, "max": 10.70, "min": 17.89, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 0.51, "avg": 0.51, "max": 0.51, "min": 0.51, "cnt": 1}, "forward-send-backward-recv":{"total": 1585.79, "avg": 51.15, "max": 0.87, "min": 297.14, "cnt": 31}, "backward-compute":{"total": 1845.72, "avg": 57.68, "max": 54.30, "min": 59.58, "cnt": 32}, "MoE_L3_bwd":{"total": 435.21, "avg": 13.60, "max": 11.95, "min": 15.59, "cnt": 32}, "MoE_L2_bwd":{"total": 440.38, "avg": 13.76, "max": 12.74, "min": 14.69, "cnt": 32}, "MoE_L1_bwd":{"total": 390.10, "avg": 12.19, "max": 11.55, "min": 12.65, "cnt": 32}, "MoE_L0_bwd":{"total": 367.74, "avg": 11.49, "max": 11.02, "min": 12.50, "cnt": 32}, "backward-send-forward-recv":{"total": 3853.39, "avg": 128.45, "max": 1.00, "min": 386.90, "cnt": 30}, "backward-send":{"total": 1.80, "avg": 0.90, "max": 0.73, "min": 1.07, "cnt": 2}, "backward-recv":{"total": 64.62, "avg": 64.62, "max": 64.62, "min": 64.62, "cnt": 1}, "backward-params-all-reduce":{"total": 489.09, "avg": 489.09, "max": 489.09, "min": 489.09, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 300.24, "avg": 300.24, "max": 300.24, "min": 300.24, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.40, "avg": 3.40, "max": 3.40, "min": 3.40, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 256.09, "avg": 256.09, "max": 256.09, "min": 256.09, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.85, "avg": 6.85, "max": 6.85, "min": 6.85, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 17, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.12, "avg": 0.12, "max": 0.12, "min": 0.12, "cnt": 1}, "forward-recv":{"total": 124.19, "avg": 62.10, "max": 1.16, "min": 123.03, "cnt": 2}, "forward-compute":{"total": 1891.64, "avg": 59.11, "max": 52.56, "min": 64.53, "cnt": 32}, "fwd-compute":{"total": 1888.48, "avg": 59.01, "max": 52.48, "min": 64.40, "cnt": 32}, "batch-generator":{"total": 58.51, "avg": 1.83, "max": 0.74, "min": 4.14, "cnt": 32}, "fwd-embedding":{"total": 0.64, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1817.20, "avg": 56.79, "max": 51.33, "min": 62.39, "cnt": 32}, "fwd-layernorm":{"total": 10.23, "avg": 0.08, "max": 0.06, "min": 0.23, "cnt": 128}, "fwd-attn":{"total": 110.10, "avg": 0.86, "max": 0.74, "min": 1.60, "cnt": 128}, "fwd-misc":{"total": 22.19, "avg": 0.17, "max": 0.11, "min": 0.39, "cnt": 128}, "fwd-MLP":{"total": 1652.40, "avg": 12.91, "max": 10.60, "min": 18.60, "cnt": 128}, "MoE_L0_fwd":{"total": 472.32, "avg": 14.76, "max": 11.25, "min": 18.51, "cnt": 32}, "MoEMLP":{"total": 1634.32, "avg": 12.77, "max": 10.49, "min": 18.47, "cnt": 128}, "MoE_L1_fwd":{"total": 399.65, "avg": 12.49, "max": 11.18, "min": 15.01, "cnt": 32}, "MoE_L2_fwd":{"total": 414.31, "avg": 12.95, "max": 12.07, "min": 14.77, "cnt": 32}, "MoE_L3_fwd":{"total": 354.71, "avg": 11.08, "max": 10.53, "min": 12.50, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 0.88, "avg": 0.88, "max": 0.88, "min": 0.88, "cnt": 1}, "forward-send-backward-recv":{"total": 657.22, "avg": 21.20, "max": 1.30, "min": 166.93, "cnt": 31}, "backward-compute":{"total": 1807.79, "avg": 56.49, "max": 53.23, "min": 58.79, "cnt": 32}, "MoE_L3_bwd":{"total": 401.58, "avg": 12.55, "max": 11.62, "min": 15.26, "cnt": 32}, "MoE_L2_bwd":{"total": 433.92, "avg": 13.56, "max": 12.21, "min": 15.87, "cnt": 32}, "MoE_L1_bwd":{"total": 383.67, "avg": 11.99, "max": 11.58, "min": 13.54, "cnt": 32}, "MoE_L0_bwd":{"total": 372.95, "avg": 11.65, "max": 10.63, "min": 12.54, "cnt": 32}, "backward-send-forward-recv":{"total": 6650.63, "avg": 221.69, "max": 2.39, "min": 995.02, "cnt": 30}, "backward-send":{"total": 1.81, "avg": 0.91, "max": 0.61, "min": 1.20, "cnt": 2}, "backward-recv":{"total": 72.98, "avg": 72.98, "max": 72.98, "min": 72.98, "cnt": 1}, "backward-params-all-reduce":{"total": 490.80, "avg": 490.80, "max": 490.80, "min": 490.80, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.04, "avg": 0.04, "max": 0.04, "min": 0.04, "cnt": 1}, "optimizer":{"total": 302.19, "avg": 302.19, "max": 302.19, "min": 302.19, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.40, "avg": 3.40, "max": 3.40, "min": 3.40, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 256.37, "avg": 256.37, "max": 256.37, "min": 256.37, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.96, "avg": 6.96, "max": 6.96, "min": 6.96, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.82, "avg": 3.82, "max": 3.82, "min": 3.82, "cnt": 1}}}
{"type":"time", "iteration": 18, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 134.06, "avg": 67.03, "max": 0.72, "min": 133.35, "cnt": 2}, "forward-compute":{"total": 1886.47, "avg": 58.95, "max": 52.60, "min": 63.22, "cnt": 32}, "fwd-compute":{"total": 1883.05, "avg": 58.85, "max": 52.52, "min": 63.14, "cnt": 32}, "batch-generator":{"total": 51.12, "avg": 1.60, "max": 0.70, "min": 3.39, "cnt": 32}, "fwd-embedding":{"total": 0.74, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1818.44, "avg": 56.83, "max": 51.36, "min": 61.99, "cnt": 32}, "fwd-layernorm":{"total": 10.80, "avg": 0.08, "max": 0.05, "min": 0.24, "cnt": 128}, "fwd-attn":{"total": 114.37, "avg": 0.89, "max": 0.74, "min": 1.59, "cnt": 128}, "fwd-misc":{"total": 26.64, "avg": 0.21, "max": 0.11, "min": 4.20, "cnt": 128}, "fwd-MLP":{"total": 1643.85, "avg": 12.84, "max": 10.59, "min": 23.39, "cnt": 128}, "MoE_L0_fwd":{"total": 506.22, "avg": 15.82, "max": 12.44, "min": 23.31, "cnt": 32}, "MoEMLP":{"total": 1624.80, "avg": 12.69, "max": 10.48, "min": 23.27, "cnt": 128}, "MoE_L1_fwd":{"total": 398.72, "avg": 12.46, "max": 11.22, "min": 13.91, "cnt": 32}, "MoE_L2_fwd":{"total": 378.97, "avg": 11.84, "max": 10.96, "min": 12.55, "cnt": 32}, "MoE_L3_fwd":{"total": 347.79, "avg": 10.87, "max": 10.52, "min": 11.74, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 0.82, "avg": 0.82, "max": 0.82, "min": 0.82, "cnt": 1}, "forward-send-backward-recv":{"total": 255.48, "avg": 8.24, "max": 0.95, "min": 60.36, "cnt": 31}, "backward-compute":{"total": 1770.29, "avg": 55.32, "max": 52.23, "min": 57.29, "cnt": 32}, "MoE_L3_bwd":{"total": 402.37, "avg": 12.57, "max": 11.37, "min": 14.23, "cnt": 32}, "MoE_L2_bwd":{"total": 404.32, "avg": 12.64, "max": 11.63, "min": 13.61, "cnt": 32}, "MoE_L1_bwd":{"total": 375.80, "avg": 11.74, "max": 10.88, "min": 12.59, "cnt": 32}, "MoE_L0_bwd":{"total": 373.87, "avg": 11.68, "max": 11.04, "min": 13.03, "cnt": 32}, "backward-send-forward-recv":{"total": 7050.44, "avg": 235.01, "max": 1.43, "min": 1137.42, "cnt": 30}, "backward-send":{"total": 1.17, "avg": 0.58, "max": 0.48, "min": 0.69, "cnt": 2}, "backward-recv":{"total": 63.99, "avg": 63.99, "max": 63.99, "min": 63.99, "cnt": 1}, "backward-params-all-reduce":{"total": 487.58, "avg": 487.58, "max": 487.58, "min": 487.58, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 303.43, "avg": 303.43, "max": 303.43, "min": 303.43, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 259.04, "avg": 259.04, "max": 259.04, "min": 259.04, "cnt": 1}, "optimizer-clip-main-grad":{"total": 7.03, "avg": 7.03, "max": 7.03, "min": 7.03, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 19, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 117.51, "avg": 58.76, "max": 0.70, "min": 116.81, "cnt": 2}, "forward-compute":{"total": 1834.88, "avg": 57.34, "max": 50.45, "min": 63.47, "cnt": 32}, "fwd-compute":{"total": 1831.50, "avg": 57.23, "max": 50.38, "min": 63.40, "cnt": 32}, "batch-generator":{"total": 49.55, "avg": 1.55, "max": 0.63, "min": 4.95, "cnt": 32}, "fwd-embedding":{"total": 0.66, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1769.14, "avg": 55.29, "max": 49.38, "min": 61.39, "cnt": 32}, "fwd-layernorm":{"total": 9.94, "avg": 0.08, "max": 0.05, "min": 0.25, "cnt": 128}, "fwd-attn":{"total": 109.58, "avg": 0.86, "max": 0.74, "min": 1.64, "cnt": 128}, "fwd-misc":{"total": 21.71, "avg": 0.17, "max": 0.11, "min": 0.38, "cnt": 128}, "fwd-MLP":{"total": 1606.69, "avg": 12.55, "max": 10.58, "min": 19.43, "cnt": 128}, "MoE_L0_fwd":{"total": 475.35, "avg": 14.85, "max": 11.63, "min": 19.33, "cnt": 32}, "MoEMLP":{"total": 1589.13, "avg": 12.42, "max": 10.48, "min": 19.27, "cnt": 128}, "MoE_L1_fwd":{"total": 397.37, "avg": 12.42, "max": 11.26, "min": 13.81, "cnt": 32}, "MoE_L2_fwd":{"total": 358.04, "avg": 11.19, "max": 10.52, "min": 13.71, "cnt": 32}, "MoE_L3_fwd":{"total": 364.88, "avg": 11.40, "max": 10.95, "min": 13.59, "cnt": 32}, "fwd-pooler":{"total": 0.36, "avg": 0.01, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-loss-func":{"total": 0.63, "avg": 0.02, "max": 0.02, "min": 0.06, "cnt": 32}, "forward-send":{"total": 0.83, "avg": 0.83, "max": 0.83, "min": 0.83, "cnt": 1}, "forward-send-backward-recv":{"total": 1629.77, "avg": 52.57, "max": 1.01, "min": 413.05, "cnt": 31}, "backward-compute":{"total": 1762.74, "avg": 55.09, "max": 51.71, "min": 61.38, "cnt": 32}, "MoE_L3_bwd":{"total": 420.09, "avg": 13.13, "max": 12.05, "min": 15.08, "cnt": 32}, "MoE_L2_bwd":{"total": 376.68, "avg": 11.77, "max": 11.21, "min": 12.97, "cnt": 32}, "MoE_L1_bwd":{"total": 387.77, "avg": 12.12, "max": 11.24, "min": 16.03, "cnt": 32}, "MoE_L0_bwd":{"total": 365.00, "avg": 11.41, "max": 10.70, "min": 12.85, "cnt": 32}, "backward-send-forward-recv":{"total": 6015.22, "avg": 200.51, "max": 1.12, "min": 898.53, "cnt": 30}, "backward-send":{"total": 2.32, "avg": 1.16, "max": 1.09, "min": 1.24, "cnt": 2}, "backward-recv":{"total": 70.54, "avg": 70.54, "max": 70.54, "min": 70.54, "cnt": 1}, "backward-params-all-reduce":{"total": 487.93, "avg": 487.93, "max": 487.93, "min": 487.93, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 306.78, "avg": 306.78, "max": 306.78, "min": 306.78, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 262.32, "avg": 262.32, "max": 262.32, "min": 262.32, "cnt": 1}, "optimizer-clip-main-grad":{"total": 7.04, "avg": 7.04, "max": 7.04, "min": 7.04, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 20, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 121.97, "avg": 60.99, "max": 0.72, "min": 121.26, "cnt": 2}, "forward-compute":{"total": 1894.59, "avg": 59.21, "max": 52.93, "min": 72.48, "cnt": 32}, "fwd-compute":{"total": 1891.33, "avg": 59.10, "max": 52.86, "min": 72.41, "cnt": 32}, "batch-generator":{"total": 48.82, "avg": 1.53, "max": 0.60, "min": 4.06, "cnt": 32}, "fwd-embedding":{"total": 0.70, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1830.13, "avg": 57.19, "max": 51.82, "min": 71.35, "cnt": 32}, "fwd-layernorm":{"total": 10.31, "avg": 0.08, "max": 0.05, "min": 0.25, "cnt": 128}, "fwd-attn":{"total": 113.17, "avg": 0.88, "max": 0.74, "min": 1.67, "cnt": 128}, "fwd-misc":{"total": 22.38, "avg": 0.17, "max": 0.11, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1662.15, "avg": 12.99, "max": 10.63, "min": 24.99, "cnt": 128}, "MoE_L0_fwd":{"total": 518.21, "avg": 16.19, "max": 12.16, "min": 24.91, "cnt": 32}, "MoEMLP":{"total": 1643.99, "avg": 12.84, "max": 10.52, "min": 24.86, "cnt": 128}, "MoE_L1_fwd":{"total": 397.88, "avg": 12.43, "max": 11.12, "min": 16.08, "cnt": 32}, "MoE_L2_fwd":{"total": 354.15, "avg": 11.07, "max": 10.56, "min": 12.35, "cnt": 32}, "MoE_L3_fwd":{"total": 380.45, "avg": 11.89, "max": 11.01, "min": 18.14, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 0.74, "avg": 0.74, "max": 0.74, "min": 0.74, "cnt": 1}, "forward-send-backward-recv":{"total": 248.95, "avg": 8.03, "max": 0.95, "min": 68.48, "cnt": 31}, "backward-compute":{"total": 1754.67, "avg": 54.83, "max": 51.19, "min": 60.01, "cnt": 32}, "MoE_L3_bwd":{"total": 420.74, "avg": 13.15, "max": 12.32, "min": 16.96, "cnt": 32}, "MoE_L2_bwd":{"total": 375.53, "avg": 11.74, "max": 10.68, "min": 13.29, "cnt": 32}, "MoE_L1_bwd":{"total": 385.52, "avg": 12.05, "max": 11.06, "min": 14.11, "cnt": 32}, "MoE_L0_bwd":{"total": 360.57, "avg": 11.27, "max": 10.43, "min": 12.32, "cnt": 32}, "backward-send-forward-recv":{"total": 5708.28, "avg": 190.28, "max": 0.92, "min": 577.65, "cnt": 30}, "backward-send":{"total": 1.56, "avg": 0.78, "max": 0.74, "min": 0.83, "cnt": 2}, "backward-recv":{"total": 72.32, "avg": 72.32, "max": 72.32, "min": 72.32, "cnt": 1}, "backward-params-all-reduce":{"total": 490.02, "avg": 490.02, "max": 490.02, "min": 490.02, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 300.37, "avg": 300.37, "max": 300.37, "min": 300.37, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 256.00, "avg": 256.00, "max": 256.00, "min": 256.00, "cnt": 1}, "optimizer-clip-main-grad":{"total": 7.07, "avg": 7.07, "max": 7.07, "min": 7.07, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.48, "avg": 3.48, "max": 3.48, "min": 3.48, "cnt": 1}}}
{"type":"time", "iteration": 21, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 126.65, "avg": 63.33, "max": 1.07, "min": 125.59, "cnt": 2}, "forward-compute":{"total": 1912.07, "avg": 59.75, "max": 54.18, "min": 67.84, "cnt": 32}, "fwd-compute":{"total": 1908.91, "avg": 59.65, "max": 54.11, "min": 67.76, "cnt": 32}, "batch-generator":{"total": 49.52, "avg": 1.55, "max": 0.70, "min": 3.19, "cnt": 32}, "fwd-embedding":{"total": 0.72, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1846.46, "avg": 57.70, "max": 53.10, "min": 66.42, "cnt": 32}, "fwd-layernorm":{"total": 10.64, "avg": 0.08, "max": 0.05, "min": 0.22, "cnt": 128}, "fwd-attn":{"total": 114.67, "avg": 0.90, "max": 0.74, "min": 2.25, "cnt": 128}, "fwd-misc":{"total": 22.94, "avg": 0.18, "max": 0.11, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1675.54, "avg": 13.09, "max": 10.79, "min": 25.75, "cnt": 128}, "MoE_L0_fwd":{"total": 522.16, "avg": 16.32, "max": 12.90, "min": 25.43, "cnt": 32}, "MoEMLP":{"total": 1656.84, "avg": 12.94, "max": 10.68, "min": 25.33, "cnt": 128}, "MoE_L1_fwd":{"total": 394.19, "avg": 12.32, "max": 11.20, "min": 15.27, "cnt": 32}, "MoE_L2_fwd":{"total": 381.61, "avg": 11.93, "max": 10.79, "min": 13.01, "cnt": 32}, "MoE_L3_fwd":{"total": 365.63, "avg": 11.43, "max": 10.72, "min": 13.23, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 0.79, "avg": 0.79, "max": 0.79, "min": 0.79, "cnt": 1}, "forward-send-backward-recv":{"total": 853.59, "avg": 27.54, "max": 1.20, "min": 239.23, "cnt": 31}, "backward-compute":{"total": 1772.49, "avg": 55.39, "max": 53.12, "min": 57.31, "cnt": 32}, "MoE_L3_bwd":{"total": 412.26, "avg": 12.88, "max": 11.66, "min": 13.91, "cnt": 32}, "MoE_L2_bwd":{"total": 403.87, "avg": 12.62, "max": 11.42, "min": 13.59, "cnt": 32}, "MoE_L1_bwd":{"total": 378.28, "avg": 11.82, "max": 11.17, "min": 12.74, "cnt": 32}, "MoE_L0_bwd":{"total": 366.94, "avg": 11.47, "max": 10.78, "min": 12.61, "cnt": 32}, "backward-send-forward-recv":{"total": 6915.78, "avg": 230.53, "max": 0.89, "min": 1001.20, "cnt": 30}, "backward-send":{"total": 1.31, "avg": 0.66, "max": 0.60, "min": 0.71, "cnt": 2}, "backward-recv":{"total": 74.05, "avg": 74.05, "max": 74.05, "min": 74.05, "cnt": 1}, "backward-params-all-reduce":{"total": 487.72, "avg": 487.72, "max": 487.72, "min": 487.72, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 309.07, "avg": 309.07, "max": 309.07, "min": 309.07, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 264.72, "avg": 264.72, "max": 264.72, "min": 264.72, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.95, "avg": 6.95, "max": 6.95, "min": 6.95, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 22, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 137.06, "avg": 68.53, "max": 0.67, "min": 136.39, "cnt": 2}, "forward-compute":{"total": 1827.80, "avg": 57.12, "max": 51.24, "min": 61.90, "cnt": 32}, "fwd-compute":{"total": 1824.77, "avg": 57.02, "max": 51.18, "min": 61.82, "cnt": 32}, "batch-generator":{"total": 39.45, "avg": 1.23, "max": 0.66, "min": 2.71, "cnt": 32}, "fwd-embedding":{"total": 0.54, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1773.45, "avg": 55.42, "max": 50.06, "min": 59.14, "cnt": 32}, "fwd-layernorm":{"total": 9.06, "avg": 0.07, "max": 0.05, "min": 0.18, "cnt": 128}, "fwd-attn":{"total": 104.11, "avg": 0.81, "max": 0.74, "min": 1.45, "cnt": 128}, "fwd-misc":{"total": 19.99, "avg": 0.16, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1620.23, "avg": 12.66, "max": 10.79, "min": 19.03, "cnt": 128}, "MoE_L0_fwd":{"total": 474.39, "avg": 14.82, "max": 11.47, "min": 18.94, "cnt": 32}, "MoEMLP":{"total": 1603.84, "avg": 12.53, "max": 10.68, "min": 18.90, "cnt": 128}, "MoE_L1_fwd":{"total": 391.68, "avg": 12.24, "max": 11.04, "min": 13.91, "cnt": 32}, "MoE_L2_fwd":{"total": 386.37, "avg": 12.07, "max": 11.43, "min": 15.15, "cnt": 32}, "MoE_L3_fwd":{"total": 357.48, "avg": 11.17, "max": 10.72, "min": 14.05, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.05, "cnt": 32}, "forward-send":{"total": 0.80, "avg": 0.80, "max": 0.80, "min": 0.80, "cnt": 1}, "forward-send-backward-recv":{"total": 1267.25, "avg": 40.88, "max": 1.12, "min": 217.42, "cnt": 31}, "backward-compute":{"total": 1785.53, "avg": 55.80, "max": 53.00, "min": 57.36, "cnt": 32}, "MoE_L3_bwd":{"total": 416.09, "avg": 13.00, "max": 11.89, "min": 14.40, "cnt": 32}, "MoE_L2_bwd":{"total": 413.44, "avg": 12.92, "max": 11.89, "min": 14.32, "cnt": 32}, "MoE_L1_bwd":{"total": 374.52, "avg": 11.70, "max": 11.19, "min": 12.63, "cnt": 32}, "MoE_L0_bwd":{"total": 368.81, "avg": 11.53, "max": 10.89, "min": 12.60, "cnt": 32}, "backward-send-forward-recv":{"total": 5493.76, "avg": 183.13, "max": 1.54, "min": 1350.16, "cnt": 30}, "backward-send":{"total": 1.65, "avg": 0.83, "max": 0.77, "min": 0.88, "cnt": 2}, "backward-recv":{"total": 66.93, "avg": 66.93, "max": 66.93, "min": 66.93, "cnt": 1}, "backward-params-all-reduce":{"total": 493.17, "avg": 493.17, "max": 493.17, "min": 493.17, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 302.64, "avg": 302.64, "max": 302.64, "min": 302.64, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 258.10, "avg": 258.10, "max": 258.10, "min": 258.10, "cnt": 1}, "optimizer-clip-main-grad":{"total": 7.09, "avg": 7.09, "max": 7.09, "min": 7.09, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.58, "avg": 3.58, "max": 3.58, "min": 3.58, "cnt": 1}}}
{"type":"time", "iteration": 23, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 130.87, "avg": 65.44, "max": 1.54, "min": 129.33, "cnt": 2}, "forward-compute":{"total": 1879.64, "avg": 58.74, "max": 51.54, "min": 65.71, "cnt": 32}, "fwd-compute":{"total": 1876.41, "avg": 58.64, "max": 51.46, "min": 65.52, "cnt": 32}, "batch-generator":{"total": 49.17, "avg": 1.54, "max": 0.75, "min": 3.99, "cnt": 32}, "fwd-embedding":{"total": 0.64, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1814.84, "avg": 56.71, "max": 50.38, "min": 63.63, "cnt": 32}, "fwd-layernorm":{"total": 9.83, "avg": 0.08, "max": 0.05, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 108.95, "avg": 0.85, "max": 0.74, "min": 1.58, "cnt": 128}, "fwd-misc":{"total": 21.35, "avg": 0.17, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1653.58, "avg": 12.92, "max": 10.56, "min": 19.23, "cnt": 128}, "MoE_L0_fwd":{"total": 489.11, "avg": 15.28, "max": 11.82, "min": 19.15, "cnt": 32}, "MoEMLP":{"total": 1636.27, "avg": 12.78, "max": 10.44, "min": 19.10, "cnt": 128}, "MoE_L1_fwd":{"total": 397.16, "avg": 12.41, "max": 11.14, "min": 15.24, "cnt": 32}, "MoE_L2_fwd":{"total": 398.69, "avg": 12.46, "max": 11.67, "min": 16.00, "cnt": 32}, "MoE_L3_fwd":{"total": 357.69, "avg": 11.18, "max": 10.48, "min": 14.28, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 0.93, "avg": 0.93, "max": 0.93, "min": 0.93, "cnt": 1}, "forward-send-backward-recv":{"total": 371.50, "avg": 11.98, "max": 1.07, "min": 125.67, "cnt": 31}, "backward-compute":{"total": 1758.73, "avg": 54.96, "max": 52.62, "min": 56.50, "cnt": 32}, "MoE_L3_bwd":{"total": 401.53, "avg": 12.55, "max": 11.68, "min": 13.48, "cnt": 32}, "MoE_L2_bwd":{"total": 404.60, "avg": 12.64, "max": 12.07, "min": 13.50, "cnt": 32}, "MoE_L1_bwd":{"total": 377.90, "avg": 11.81, "max": 11.27, "min": 14.15, "cnt": 32}, "MoE_L0_bwd":{"total": 362.89, "avg": 11.34, "max": 10.77, "min": 12.17, "cnt": 32}, "backward-send-forward-recv":{"total": 4964.38, "avg": 165.48, "max": 1.01, "min": 614.66, "cnt": 30}, "backward-send":{"total": 1.85, "avg": 0.92, "max": 0.87, "min": 0.98, "cnt": 2}, "backward-recv":{"total": 73.02, "avg": 73.02, "max": 73.02, "min": 73.02, "cnt": 1}, "backward-params-all-reduce":{"total": 491.74, "avg": 491.74, "max": 491.74, "min": 491.74, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 319.38, "avg": 319.38, "max": 319.38, "min": 319.38, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 261.42, "avg": 261.42, "max": 261.42, "min": 261.42, "cnt": 1}, "optimizer-clip-main-grad":{"total": 10.76, "avg": 10.76, "max": 10.76, "min": 10.76, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.47, "avg": 3.47, "max": 3.47, "min": 3.47, "cnt": 1}}}
{"type":"time", "iteration": 24, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 1099.46, "avg": 549.73, "max": 1.10, "min": 1098.36, "cnt": 2}, "forward-compute":{"total": 1909.19, "avg": 59.66, "max": 52.93, "min": 66.64, "cnt": 32}, "fwd-compute":{"total": 1906.15, "avg": 59.57, "max": 52.85, "min": 66.57, "cnt": 32}, "batch-generator":{"total": 42.56, "avg": 1.33, "max": 0.72, "min": 2.75, "cnt": 32}, "fwd-embedding":{"total": 0.63, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1851.53, "avg": 57.86, "max": 51.81, "min": 65.36, "cnt": 32}, "fwd-layernorm":{"total": 9.87, "avg": 0.08, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 110.59, "avg": 0.86, "max": 0.74, "min": 1.86, "cnt": 128}, "fwd-misc":{"total": 21.54, "avg": 0.17, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1687.96, "avg": 13.19, "max": 10.68, "min": 19.81, "cnt": 128}, "MoE_L0_fwd":{"total": 500.95, "avg": 15.65, "max": 12.30, "min": 19.63, "cnt": 32}, "MoEMLP":{"total": 1670.21, "avg": 13.05, "max": 10.57, "min": 19.53, "cnt": 128}, "MoE_L1_fwd":{"total": 407.94, "avg": 12.75, "max": 11.38, "min": 15.70, "cnt": 32}, "MoE_L2_fwd":{"total": 409.67, "avg": 12.80, "max": 11.90, "min": 15.97, "cnt": 32}, "MoE_L3_fwd":{"total": 358.16, "avg": 11.19, "max": 10.62, "min": 13.85, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 0.68, "avg": 0.68, "max": 0.68, "min": 0.68, "cnt": 1}, "forward-send-backward-recv":{"total": 230.79, "avg": 7.44, "max": 0.95, "min": 69.59, "cnt": 31}, "backward-compute":{"total": 1782.53, "avg": 55.70, "max": 52.55, "min": 58.23, "cnt": 32}, "MoE_L3_bwd":{"total": 414.96, "avg": 12.97, "max": 11.68, "min": 14.15, "cnt": 32}, "MoE_L2_bwd":{"total": 412.09, "avg": 12.88, "max": 12.33, "min": 13.80, "cnt": 32}, "MoE_L1_bwd":{"total": 382.49, "avg": 11.95, "max": 11.24, "min": 12.58, "cnt": 32}, "MoE_L0_bwd":{"total": 360.69, "avg": 11.27, "max": 10.68, "min": 11.78, "cnt": 32}, "backward-send-forward-recv":{"total": 4729.06, "avg": 157.64, "max": 1.15, "min": 407.70, "cnt": 30}, "backward-send":{"total": 1.36, "avg": 0.68, "max": 0.65, "min": 0.71, "cnt": 2}, "backward-recv":{"total": 98.52, "avg": 98.52, "max": 98.52, "min": 98.52, "cnt": 1}, "backward-params-all-reduce":{"total": 489.95, "avg": 489.95, "max": 489.95, "min": 489.95, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 304.48, "avg": 304.48, "max": 304.48, "min": 304.48, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 260.04, "avg": 260.04, "max": 260.04, "min": 260.04, "cnt": 1}, "optimizer-clip-main-grad":{"total": 7.00, "avg": 7.00, "max": 7.00, "min": 7.00, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.48, "avg": 3.48, "max": 3.48, "min": 3.48, "cnt": 1}}}
{"type":"time", "iteration": 25, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 139.77, "avg": 69.88, "max": 1.37, "min": 138.40, "cnt": 2}, "forward-compute":{"total": 1863.11, "avg": 58.22, "max": 52.37, "min": 65.22, "cnt": 32}, "fwd-compute":{"total": 1859.99, "avg": 58.12, "max": 52.30, "min": 65.14, "cnt": 32}, "batch-generator":{"total": 39.44, "avg": 1.23, "max": 0.73, "min": 2.46, "cnt": 32}, "fwd-embedding":{"total": 0.66, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1807.89, "avg": 56.50, "max": 50.36, "min": 63.96, "cnt": 32}, "fwd-layernorm":{"total": 9.67, "avg": 0.08, "max": 0.05, "min": 0.18, "cnt": 128}, "fwd-attn":{"total": 109.06, "avg": 0.85, "max": 0.74, "min": 1.94, "cnt": 128}, "fwd-misc":{"total": 21.37, "avg": 0.17, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1646.33, "avg": 12.86, "max": 10.40, "min": 22.33, "cnt": 128}, "MoE_L0_fwd":{"total": 479.50, "avg": 14.98, "max": 11.05, "min": 22.24, "cnt": 32}, "MoEMLP":{"total": 1629.05, "avg": 12.73, "max": 10.29, "min": 22.19, "cnt": 128}, "MoE_L1_fwd":{"total": 401.64, "avg": 12.55, "max": 11.26, "min": 14.66, "cnt": 32}, "MoE_L2_fwd":{"total": 401.65, "avg": 12.55, "max": 11.16, "min": 14.24, "cnt": 32}, "MoE_L3_fwd":{"total": 352.63, "avg": 11.02, "max": 10.34, "min": 12.73, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.05, "cnt": 32}, "forward-send":{"total": 0.97, "avg": 0.97, "max": 0.97, "min": 0.97, "cnt": 1}, "forward-send-backward-recv":{"total": 1950.79, "avg": 62.93, "max": 0.87, "min": 346.63, "cnt": 31}, "backward-compute":{"total": 1763.15, "avg": 55.10, "max": 53.77, "min": 58.49, "cnt": 32}, "MoE_L3_bwd":{"total": 404.30, "avg": 12.63, "max": 11.77, "min": 15.73, "cnt": 32}, "MoE_L2_bwd":{"total": 407.41, "avg": 12.73, "max": 11.99, "min": 13.90, "cnt": 32}, "MoE_L1_bwd":{"total": 383.39, "avg": 11.98, "max": 11.38, "min": 12.67, "cnt": 32}, "MoE_L0_bwd":{"total": 353.79, "avg": 11.06, "max": 10.86, "min": 11.34, "cnt": 32}, "backward-send-forward-recv":{"total": 4316.48, "avg": 143.88, "max": 1.66, "min": 860.06, "cnt": 30}, "backward-send":{"total": 1.76, "avg": 0.88, "max": 0.76, "min": 1.00, "cnt": 2}, "backward-recv":{"total": 727.40, "avg": 727.40, "max": 727.40, "min": 727.40, "cnt": 1}, "backward-params-all-reduce":{"total": 488.02, "avg": 488.02, "max": 488.02, "min": 488.02, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 315.72, "avg": 315.72, "max": 315.72, "min": 315.72, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 271.48, "avg": 271.48, "max": 271.48, "min": 271.48, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.90, "avg": 6.90, "max": 6.90, "min": 6.90, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.52, "avg": 3.52, "max": 3.52, "min": 3.52, "cnt": 1}}}
{"type":"time", "iteration": 26, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 135.31, "avg": 67.66, "max": 4.04, "min": 131.27, "cnt": 2}, "forward-compute":{"total": 1882.77, "avg": 58.84, "max": 53.03, "min": 66.91, "cnt": 32}, "fwd-compute":{"total": 1879.15, "avg": 58.72, "max": 52.95, "min": 66.82, "cnt": 32}, "batch-generator":{"total": 50.38, "avg": 1.57, "max": 0.77, "min": 2.59, "cnt": 32}, "fwd-embedding":{"total": 0.66, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1815.64, "avg": 56.74, "max": 51.43, "min": 64.16, "cnt": 32}, "fwd-layernorm":{"total": 10.40, "avg": 0.08, "max": 0.05, "min": 0.22, "cnt": 128}, "fwd-attn":{"total": 111.98, "avg": 0.87, "max": 0.74, "min": 1.95, "cnt": 128}, "fwd-misc":{"total": 22.40, "avg": 0.17, "max": 0.11, "min": 0.42, "cnt": 128}, "fwd-MLP":{"total": 1648.90, "avg": 12.88, "max": 10.38, "min": 22.48, "cnt": 128}, "MoE_L0_fwd":{"total": 486.29, "avg": 15.20, "max": 10.92, "min": 22.40, "cnt": 32}, "MoEMLP":{"total": 1631.03, "avg": 12.74, "max": 10.24, "min": 22.36, "cnt": 128}, "MoE_L1_fwd":{"total": 410.77, "avg": 12.84, "max": 11.58, "min": 15.75, "cnt": 32}, "MoE_L2_fwd":{"total": 390.97, "avg": 12.22, "max": 11.33, "min": 14.63, "cnt": 32}, "MoE_L3_fwd":{"total": 349.50, "avg": 10.92, "max": 10.29, "min": 15.73, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 0.91, "avg": 0.91, "max": 0.91, "min": 0.91, "cnt": 1}, "forward-send-backward-recv":{"total": 551.26, "avg": 17.78, "max": 1.29, "min": 119.00, "cnt": 31}, "backward-compute":{"total": 1761.32, "avg": 55.04, "max": 52.08, "min": 59.20, "cnt": 32}, "MoE_L3_bwd":{"total": 396.07, "avg": 12.38, "max": 11.47, "min": 14.20, "cnt": 32}, "MoE_L2_bwd":{"total": 400.86, "avg": 12.53, "max": 11.64, "min": 14.14, "cnt": 32}, "MoE_L1_bwd":{"total": 387.12, "avg": 12.10, "max": 11.24, "min": 13.57, "cnt": 32}, "MoE_L0_bwd":{"total": 357.91, "avg": 11.18, "max": 10.44, "min": 13.70, "cnt": 32}, "backward-send-forward-recv":{"total": 7649.01, "avg": 254.97, "max": 2.27, "min": 1136.45, "cnt": 30}, "backward-send":{"total": 1.30, "avg": 0.65, "max": 0.57, "min": 0.73, "cnt": 2}, "backward-recv":{"total": 328.85, "avg": 328.85, "max": 328.85, "min": 328.85, "cnt": 1}, "backward-params-all-reduce":{"total": 487.48, "avg": 487.48, "max": 487.48, "min": 487.48, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 351.14, "avg": 351.14, "max": 351.14, "min": 351.14, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 306.76, "avg": 306.76, "max": 306.76, "min": 306.76, "cnt": 1}, "optimizer-clip-main-grad":{"total": 7.04, "avg": 7.04, "max": 7.04, "min": 7.04, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 27, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 125.09, "avg": 62.54, "max": 0.78, "min": 124.31, "cnt": 2}, "forward-compute":{"total": 1857.15, "avg": 58.04, "max": 52.00, "min": 68.99, "cnt": 32}, "fwd-compute":{"total": 1854.31, "avg": 57.95, "max": 51.93, "min": 68.92, "cnt": 32}, "batch-generator":{"total": 41.74, "avg": 1.30, "max": 0.64, "min": 4.58, "cnt": 32}, "fwd-embedding":{"total": 0.51, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1801.29, "avg": 56.29, "max": 50.85, "min": 66.42, "cnt": 32}, "fwd-layernorm":{"total": 8.88, "avg": 0.07, "max": 0.05, "min": 0.17, "cnt": 128}, "fwd-attn":{"total": 104.10, "avg": 0.81, "max": 0.74, "min": 1.86, "cnt": 128}, "fwd-misc":{"total": 19.88, "avg": 0.16, "max": 0.11, "min": 0.33, "cnt": 128}, "fwd-MLP":{"total": 1648.58, "avg": 12.88, "max": 10.73, "min": 22.73, "cnt": 128}, "MoE_L0_fwd":{"total": 472.95, "avg": 14.78, "max": 11.41, "min": 22.49, "cnt": 32}, "MoEMLP":{"total": 1632.14, "avg": 12.75, "max": 10.63, "min": 22.40, "cnt": 128}, "MoE_L1_fwd":{"total": 403.93, "avg": 12.62, "max": 11.50, "min": 16.24, "cnt": 32}, "MoE_L2_fwd":{"total": 398.97, "avg": 12.47, "max": 11.53, "min": 17.77, "cnt": 32}, "MoE_L3_fwd":{"total": 362.33, "avg": 11.32, "max": 10.67, "min": 13.30, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 0.60, "avg": 0.60, "max": 0.60, "min": 0.60, "cnt": 1}, "forward-send-backward-recv":{"total": 615.62, "avg": 19.86, "max": 0.91, "min": 289.96, "cnt": 31}, "backward-compute":{"total": 1763.59, "avg": 55.11, "max": 52.83, "min": 58.29, "cnt": 32}, "MoE_L3_bwd":{"total": 418.37, "avg": 13.07, "max": 11.75, "min": 15.26, "cnt": 32}, "MoE_L2_bwd":{"total": 395.61, "avg": 12.36, "max": 11.67, "min": 13.24, "cnt": 32}, "MoE_L1_bwd":{"total": 384.60, "avg": 12.02, "max": 11.73, "min": 12.70, "cnt": 32}, "MoE_L0_bwd":{"total": 351.63, "avg": 10.99, "max": 10.37, "min": 12.06, "cnt": 32}, "backward-send-forward-recv":{"total": 6332.98, "avg": 211.10, "max": 2.00, "min": 932.61, "cnt": 30}, "backward-send":{"total": 1.56, "avg": 0.78, "max": 0.42, "min": 1.14, "cnt": 2}, "backward-recv":{"total": 76.36, "avg": 76.36, "max": 76.36, "min": 76.36, "cnt": 1}, "backward-params-all-reduce":{"total": 483.84, "avg": 483.84, "max": 483.84, "min": 483.84, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 309.72, "avg": 309.72, "max": 309.72, "min": 309.72, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.40, "avg": 3.40, "max": 3.40, "min": 3.40, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 265.43, "avg": 265.43, "max": 265.43, "min": 265.43, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.87, "avg": 6.87, "max": 6.87, "min": 6.87, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 28, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 137.01, "avg": 68.51, "max": 0.97, "min": 136.04, "cnt": 2}, "forward-compute":{"total": 1897.05, "avg": 59.28, "max": 52.99, "min": 67.73, "cnt": 32}, "fwd-compute":{"total": 1893.74, "avg": 59.18, "max": 52.92, "min": 67.64, "cnt": 32}, "batch-generator":{"total": 44.86, "avg": 1.40, "max": 0.68, "min": 2.77, "cnt": 32}, "fwd-embedding":{"total": 0.61, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1835.24, "avg": 57.35, "max": 51.90, "min": 66.54, "cnt": 32}, "fwd-layernorm":{"total": 10.19, "avg": 0.08, "max": 0.05, "min": 0.25, "cnt": 128}, "fwd-attn":{"total": 115.25, "avg": 0.90, "max": 0.74, "min": 3.77, "cnt": 128}, "fwd-misc":{"total": 22.29, "avg": 0.17, "max": 0.11, "min": 0.43, "cnt": 128}, "fwd-MLP":{"total": 1664.67, "avg": 13.01, "max": 10.85, "min": 24.07, "cnt": 128}, "MoE_L0_fwd":{"total": 491.33, "avg": 15.35, "max": 11.42, "min": 23.99, "cnt": 32}, "MoEMLP":{"total": 1646.35, "avg": 12.86, "max": 10.74, "min": 23.94, "cnt": 128}, "MoE_L1_fwd":{"total": 408.01, "avg": 12.75, "max": 11.43, "min": 14.74, "cnt": 32}, "MoE_L2_fwd":{"total": 385.44, "avg": 12.05, "max": 11.20, "min": 13.03, "cnt": 32}, "MoE_L3_fwd":{"total": 368.22, "avg": 11.51, "max": 10.78, "min": 15.30, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 0.89, "avg": 0.89, "max": 0.89, "min": 0.89, "cnt": 1}, "forward-send-backward-recv":{"total": 465.02, "avg": 15.00, "max": 1.20, "min": 94.14, "cnt": 31}, "backward-compute":{"total": 1772.43, "avg": 55.39, "max": 53.13, "min": 64.00, "cnt": 32}, "MoE_L3_bwd":{"total": 426.66, "avg": 13.33, "max": 11.73, "min": 20.61, "cnt": 32}, "MoE_L2_bwd":{"total": 392.49, "avg": 12.27, "max": 11.69, "min": 13.52, "cnt": 32}, "MoE_L1_bwd":{"total": 381.76, "avg": 11.93, "max": 11.32, "min": 13.83, "cnt": 32}, "MoE_L0_bwd":{"total": 356.57, "avg": 11.14, "max": 10.59, "min": 12.41, "cnt": 32}, "backward-send-forward-recv":{"total": 5706.18, "avg": 190.21, "max": 2.23, "min": 744.19, "cnt": 30}, "backward-send":{"total": 1.20, "avg": 0.60, "max": 0.46, "min": 0.73, "cnt": 2}, "backward-recv":{"total": 177.65, "avg": 177.65, "max": 177.65, "min": 177.65, "cnt": 1}, "backward-params-all-reduce":{"total": 490.16, "avg": 490.16, "max": 490.16, "min": 490.16, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 306.10, "avg": 306.10, "max": 306.10, "min": 306.10, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 261.78, "avg": 261.78, "max": 261.78, "min": 261.78, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.93, "avg": 6.93, "max": 6.93, "min": 6.93, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 29, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.11, "avg": 0.11, "max": 0.11, "min": 0.11, "cnt": 1}, "forward-recv":{"total": 137.86, "avg": 68.93, "max": 2.50, "min": 135.36, "cnt": 2}, "forward-compute":{"total": 1907.21, "avg": 59.60, "max": 51.45, "min": 67.14, "cnt": 32}, "fwd-compute":{"total": 1903.74, "avg": 59.49, "max": 51.38, "min": 67.05, "cnt": 32}, "batch-generator":{"total": 37.86, "avg": 1.18, "max": 0.67, "min": 1.75, "cnt": 32}, "fwd-embedding":{"total": 0.66, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1852.62, "avg": 57.89, "max": 50.39, "min": 65.93, "cnt": 32}, "fwd-layernorm":{"total": 9.93, "avg": 0.08, "max": 0.05, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 109.80, "avg": 0.86, "max": 0.74, "min": 2.11, "cnt": 128}, "fwd-misc":{"total": 21.85, "avg": 0.17, "max": 0.11, "min": 0.38, "cnt": 128}, "fwd-MLP":{"total": 1688.85, "avg": 13.19, "max": 10.73, "min": 18.73, "cnt": 128}, "MoE_L0_fwd":{"total": 499.57, "avg": 15.61, "max": 10.70, "min": 18.65, "cnt": 32}, "MoEMLP":{"total": 1671.20, "avg": 13.06, "max": 10.63, "min": 18.60, "cnt": 128}, "MoE_L1_fwd":{"total": 415.78, "avg": 12.99, "max": 11.22, "min": 15.46, "cnt": 32}, "MoE_L2_fwd":{"total": 400.27, "avg": 12.51, "max": 11.56, "min": 15.78, "cnt": 32}, "MoE_L3_fwd":{"total": 362.07, "avg": 11.31, "max": 10.67, "min": 14.32, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.61, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 0.82, "avg": 0.82, "max": 0.82, "min": 0.82, "cnt": 1}, "forward-send-backward-recv":{"total": 5100.30, "avg": 164.53, "max": 1.51, "min": 727.79, "cnt": 31}, "backward-compute":{"total": 1768.34, "avg": 55.26, "max": 52.35, "min": 59.07, "cnt": 32}, "MoE_L3_bwd":{"total": 416.45, "avg": 13.01, "max": 11.53, "min": 15.76, "cnt": 32}, "MoE_L2_bwd":{"total": 395.81, "avg": 12.37, "max": 11.70, "min": 13.62, "cnt": 32}, "MoE_L1_bwd":{"total": 380.79, "avg": 11.90, "max": 11.02, "min": 12.79, "cnt": 32}, "MoE_L0_bwd":{"total": 358.94, "avg": 11.22, "max": 10.68, "min": 11.88, "cnt": 32}, "backward-send-forward-recv":{"total": 1440.01, "avg": 48.00, "max": 1.04, "min": 595.92, "cnt": 30}, "backward-send":{"total": 2.10, "avg": 1.05, "max": 0.68, "min": 1.42, "cnt": 2}, "backward-recv":{"total": 74.27, "avg": 74.27, "max": 74.27, "min": 74.27, "cnt": 1}, "backward-params-all-reduce":{"total": 487.62, "avg": 487.62, "max": 487.62, "min": 487.62, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.04, "avg": 0.04, "max": 0.04, "min": 0.04, "cnt": 1}, "optimizer":{"total": 303.83, "avg": 303.83, "max": 303.83, "min": 303.83, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.40, "avg": 3.40, "max": 3.40, "min": 3.40, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 259.39, "avg": 259.39, "max": 259.39, "min": 259.39, "cnt": 1}, "optimizer-clip-main-grad":{"total": 7.00, "avg": 7.00, "max": 7.00, "min": 7.00, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.52, "avg": 3.52, "max": 3.52, "min": 3.52, "cnt": 1}}}
{"type":"time", "iteration": 30, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.11, "avg": 0.11, "max": 0.11, "min": 0.11, "cnt": 1}, "forward-recv":{"total": 132.47, "avg": 66.23, "max": 1.11, "min": 131.35, "cnt": 2}, "forward-compute":{"total": 1925.32, "avg": 60.17, "max": 51.66, "min": 67.63, "cnt": 32}, "fwd-compute":{"total": 1921.61, "avg": 60.05, "max": 51.57, "min": 67.55, "cnt": 32}, "batch-generator":{"total": 45.13, "avg": 1.41, "max": 0.64, "min": 2.71, "cnt": 32}, "fwd-embedding":{"total": 0.74, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1862.51, "avg": 58.20, "max": 50.35, "min": 65.92, "cnt": 32}, "fwd-layernorm":{"total": 10.73, "avg": 0.08, "max": 0.05, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 115.79, "avg": 0.90, "max": 0.74, "min": 2.37, "cnt": 128}, "fwd-misc":{"total": 23.04, "avg": 0.18, "max": 0.12, "min": 0.42, "cnt": 128}, "fwd-MLP":{"total": 1689.89, "avg": 13.20, "max": 10.77, "min": 19.99, "cnt": 128}, "MoE_L0_fwd":{"total": 502.16, "avg": 15.69, "max": 11.22, "min": 19.85, "cnt": 32}, "MoEMLP":{"total": 1670.72, "avg": 13.05, "max": 10.65, "min": 19.76, "cnt": 128}, "MoE_L1_fwd":{"total": 421.21, "avg": 13.16, "max": 11.58, "min": 15.84, "cnt": 32}, "MoE_L2_fwd":{"total": 397.25, "avg": 12.41, "max": 11.38, "min": 18.29, "cnt": 32}, "MoE_L3_fwd":{"total": 357.04, "avg": 11.16, "max": 10.69, "min": 13.02, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.65, "avg": 0.02, "max": 0.02, "min": 0.08, "cnt": 32}, "forward-send":{"total": 0.65, "avg": 0.65, "max": 0.65, "min": 0.65, "cnt": 1}, "forward-send-backward-recv":{"total": 2903.90, "avg": 93.67, "max": 0.97, "min": 556.14, "cnt": 31}, "backward-compute":{"total": 1768.22, "avg": 55.26, "max": 53.18, "min": 57.98, "cnt": 32}, "MoE_L3_bwd":{"total": 407.59, "avg": 12.74, "max": 11.35, "min": 14.67, "cnt": 32}, "MoE_L2_bwd":{"total": 400.87, "avg": 12.53, "max": 11.76, "min": 13.56, "cnt": 32}, "MoE_L1_bwd":{"total": 383.18, "avg": 11.97, "max": 11.40, "min": 13.08, "cnt": 32}, "MoE_L0_bwd":{"total": 359.45, "avg": 11.23, "max": 10.49, "min": 12.08, "cnt": 32}, "backward-send-forward-recv":{"total": 2615.79, "avg": 87.19, "max": 0.98, "min": 615.04, "cnt": 30}, "backward-send":{"total": 1.42, "avg": 0.71, "max": 0.46, "min": 0.96, "cnt": 2}, "backward-recv":{"total": 75.18, "avg": 75.18, "max": 75.18, "min": 75.18, "cnt": 1}, "backward-params-all-reduce":{"total": 488.73, "avg": 488.73, "max": 488.73, "min": 488.73, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "optimizer":{"total": 312.61, "avg": 312.61, "max": 312.61, "min": 312.61, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.47, "avg": 3.47, "max": 3.47, "min": 3.47, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 268.02, "avg": 268.02, "max": 268.02, "min": 268.02, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.84, "avg": 6.84, "max": 6.84, "min": 6.84, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.53, "avg": 3.53, "max": 3.53, "min": 3.53, "cnt": 1}}}
{"type":"time", "iteration": 31, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 135.38, "avg": 67.69, "max": 7.92, "min": 127.47, "cnt": 2}, "forward-compute":{"total": 1903.71, "avg": 59.49, "max": 53.15, "min": 74.69, "cnt": 32}, "fwd-compute":{"total": 1899.72, "avg": 59.37, "max": 53.04, "min": 74.60, "cnt": 32}, "batch-generator":{"total": 59.05, "avg": 1.85, "max": 0.71, "min": 6.28, "cnt": 32}, "fwd-embedding":{"total": 0.68, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1826.60, "avg": 57.08, "max": 51.55, "min": 72.03, "cnt": 32}, "fwd-layernorm":{"total": 11.11, "avg": 0.09, "max": 0.05, "min": 0.55, "cnt": 128}, "fwd-attn":{"total": 118.14, "avg": 0.92, "max": 0.74, "min": 4.62, "cnt": 128}, "fwd-misc":{"total": 23.81, "avg": 0.19, "max": 0.11, "min": 0.78, "cnt": 128}, "fwd-MLP":{"total": 1650.54, "avg": 12.89, "max": 10.39, "min": 23.84, "cnt": 128}, "MoE_L0_fwd":{"total": 477.58, "avg": 14.92, "max": 11.30, "min": 23.75, "cnt": 32}, "MoEMLP":{"total": 1631.75, "avg": 12.75, "max": 10.27, "min": 23.71, "cnt": 128}, "MoE_L1_fwd":{"total": 407.38, "avg": 12.73, "max": 11.36, "min": 16.14, "cnt": 32}, "MoE_L2_fwd":{"total": 409.87, "avg": 12.81, "max": 12.08, "min": 16.68, "cnt": 32}, "MoE_L3_fwd":{"total": 343.83, "avg": 10.74, "max": 10.32, "min": 11.40, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.61, "avg": 0.02, "max": 0.02, "min": 0.04, "cnt": 32}, "forward-send":{"total": 0.99, "avg": 0.99, "max": 0.99, "min": 0.99, "cnt": 1}, "forward-send-backward-recv":{"total": 500.61, "avg": 16.15, "max": 1.27, "min": 107.21, "cnt": 31}, "backward-compute":{"total": 1813.39, "avg": 56.67, "max": 52.73, "min": 60.83, "cnt": 32}, "MoE_L3_bwd":{"total": 421.12, "avg": 13.16, "max": 11.77, "min": 16.42, "cnt": 32}, "MoE_L2_bwd":{"total": 434.07, "avg": 13.56, "max": 12.36, "min": 17.57, "cnt": 32}, "MoE_L1_bwd":{"total": 385.48, "avg": 12.05, "max": 11.40, "min": 12.57, "cnt": 32}, "MoE_L0_bwd":{"total": 358.98, "avg": 11.22, "max": 10.63, "min": 12.02, "cnt": 32}, "backward-send-forward-recv":{"total": 6976.35, "avg": 232.54, "max": 1.79, "min": 1242.20, "cnt": 30}, "backward-send":{"total": 0.96, "avg": 0.48, "max": 0.44, "min": 0.52, "cnt": 2}, "backward-recv":{"total": 87.89, "avg": 87.89, "max": 87.89, "min": 87.89, "cnt": 1}, "backward-params-all-reduce":{"total": 489.96, "avg": 489.96, "max": 489.96, "min": 489.96, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.04, "avg": 0.04, "max": 0.04, "min": 0.04, "cnt": 1}, "optimizer":{"total": 309.13, "avg": 309.13, "max": 309.13, "min": 309.13, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 264.71, "avg": 264.71, "max": 264.71, "min": 264.71, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.96, "avg": 6.96, "max": 6.96, "min": 6.96, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.49, "avg": 3.49, "max": 3.49, "min": 3.49, "cnt": 1}}}
{"type":"time", "iteration": 32, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 131.59, "avg": 65.80, "max": 0.76, "min": 130.83, "cnt": 2}, "forward-compute":{"total": 1862.64, "avg": 58.21, "max": 52.57, "min": 67.31, "cnt": 32}, "fwd-compute":{"total": 1859.03, "avg": 58.09, "max": 52.50, "min": 67.16, "cnt": 32}, "batch-generator":{"total": 55.35, "avg": 1.73, "max": 0.73, "min": 4.99, "cnt": 32}, "fwd-embedding":{"total": 0.67, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1790.63, "avg": 55.96, "max": 51.14, "min": 64.00, "cnt": 32}, "fwd-layernorm":{"total": 10.27, "avg": 0.08, "max": 0.05, "min": 0.35, "cnt": 128}, "fwd-attn":{"total": 112.09, "avg": 0.88, "max": 0.74, "min": 2.60, "cnt": 128}, "fwd-misc":{"total": 21.87, "avg": 0.17, "max": 0.11, "min": 0.48, "cnt": 128}, "fwd-MLP":{"total": 1624.94, "avg": 12.69, "max": 10.47, "min": 21.29, "cnt": 128}, "MoE_L0_fwd":{"total": 455.03, "avg": 14.22, "max": 12.08, "min": 21.19, "cnt": 32}, "MoEMLP":{"total": 1607.50, "avg": 12.56, "max": 10.36, "min": 21.15, "cnt": 128}, "MoE_L1_fwd":{"total": 400.96, "avg": 12.53, "max": 11.48, "min": 16.10, "cnt": 32}, "MoE_L2_fwd":{"total": 406.77, "avg": 12.71, "max": 11.84, "min": 14.92, "cnt": 32}, "MoE_L3_fwd":{"total": 351.09, "avg": 10.97, "max": 10.40, "min": 13.63, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 0.77, "avg": 0.77, "max": 0.77, "min": 0.77, "cnt": 1}, "forward-send-backward-recv":{"total": 520.17, "avg": 16.78, "max": 0.95, "min": 182.80, "cnt": 31}, "backward-compute":{"total": 1780.16, "avg": 55.63, "max": 54.30, "min": 58.62, "cnt": 32}, "MoE_L3_bwd":{"total": 401.59, "avg": 12.55, "max": 11.84, "min": 14.49, "cnt": 32}, "MoE_L2_bwd":{"total": 425.05, "avg": 13.28, "max": 12.35, "min": 15.19, "cnt": 32}, "MoE_L1_bwd":{"total": 383.37, "avg": 11.98, "max": 11.67, "min": 12.72, "cnt": 32}, "MoE_L0_bwd":{"total": 358.69, "avg": 11.21, "max": 10.54, "min": 12.30, "cnt": 32}, "backward-send-forward-recv":{"total": 7508.58, "avg": 250.29, "max": 2.18, "min": 1060.55, "cnt": 30}, "backward-send":{"total": 1.80, "avg": 0.90, "max": 0.84, "min": 0.96, "cnt": 2}, "backward-recv":{"total": 90.52, "avg": 90.52, "max": 90.52, "min": 90.52, "cnt": 1}, "backward-params-all-reduce":{"total": 489.27, "avg": 489.27, "max": 489.27, "min": 489.27, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.04, "avg": 0.04, "max": 0.04, "min": 0.04, "cnt": 1}, "optimizer":{"total": 317.99, "avg": 317.99, "max": 317.99, "min": 317.99, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.41, "avg": 3.41, "max": 3.41, "min": 3.41, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 273.58, "avg": 273.58, "max": 273.58, "min": 273.58, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.98, "avg": 6.98, "max": 6.98, "min": 6.98, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 33, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.11, "avg": 0.11, "max": 0.11, "min": 0.11, "cnt": 1}, "forward-recv":{"total": 126.50, "avg": 63.25, "max": 4.50, "min": 122.00, "cnt": 2}, "forward-compute":{"total": 1891.80, "avg": 59.12, "max": 53.07, "min": 74.60, "cnt": 32}, "fwd-compute":{"total": 1888.38, "avg": 59.01, "max": 52.99, "min": 74.51, "cnt": 32}, "batch-generator":{"total": 51.69, "avg": 1.62, "max": 0.63, "min": 4.73, "cnt": 32}, "fwd-embedding":{"total": 0.62, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1824.18, "avg": 57.01, "max": 51.78, "min": 70.63, "cnt": 32}, "fwd-layernorm":{"total": 9.96, "avg": 0.08, "max": 0.05, "min": 0.26, "cnt": 128}, "fwd-attn":{"total": 110.58, "avg": 0.86, "max": 0.74, "min": 1.80, "cnt": 128}, "fwd-misc":{"total": 21.24, "avg": 0.17, "max": 0.11, "min": 0.41, "cnt": 128}, "fwd-MLP":{"total": 1661.12, "avg": 12.98, "max": 10.67, "min": 25.24, "cnt": 128}, "MoE_L0_fwd":{"total": 480.35, "avg": 15.01, "max": 11.26, "min": 25.08, "cnt": 32}, "MoEMLP":{"total": 1643.95, "avg": 12.84, "max": 10.55, "min": 25.00, "cnt": 128}, "MoE_L1_fwd":{"total": 405.15, "avg": 12.66, "max": 11.65, "min": 14.47, "cnt": 32}, "MoE_L2_fwd":{"total": 406.11, "avg": 12.69, "max": 12.08, "min": 14.20, "cnt": 32}, "MoE_L3_fwd":{"total": 358.63, "avg": 11.21, "max": 10.59, "min": 12.17, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.65, "avg": 1.65, "max": 1.65, "min": 1.65, "cnt": 1}, "forward-send-backward-recv":{"total": 579.21, "avg": 18.68, "max": 1.13, "min": 130.44, "cnt": 31}, "backward-compute":{"total": 1786.31, "avg": 55.82, "max": 54.02, "min": 62.43, "cnt": 32}, "MoE_L3_bwd":{"total": 409.05, "avg": 12.78, "max": 12.02, "min": 14.67, "cnt": 32}, "MoE_L2_bwd":{"total": 424.54, "avg": 13.27, "max": 12.56, "min": 19.32, "cnt": 32}, "MoE_L1_bwd":{"total": 383.37, "avg": 11.98, "max": 11.28, "min": 13.16, "cnt": 32}, "MoE_L0_bwd":{"total": 356.61, "avg": 11.14, "max": 10.47, "min": 11.78, "cnt": 32}, "backward-send-forward-recv":{"total": 9295.64, "avg": 309.85, "max": 2.06, "min": 1120.05, "cnt": 30}, "backward-send":{"total": 1.55, "avg": 0.78, "max": 0.63, "min": 0.92, "cnt": 2}, "backward-recv":{"total": 69.57, "avg": 69.57, "max": 69.57, "min": 69.57, "cnt": 1}, "backward-params-all-reduce":{"total": 488.60, "avg": 488.60, "max": 488.60, "min": 488.60, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 312.30, "avg": 312.30, "max": 312.30, "min": 312.30, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 267.26, "avg": 267.26, "max": 267.26, "min": 267.26, "cnt": 1}, "optimizer-clip-main-grad":{"total": 7.56, "avg": 7.56, "max": 7.56, "min": 7.56, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.58, "avg": 3.58, "max": 3.58, "min": 3.58, "cnt": 1}}}
{"type":"time", "iteration": 34, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 131.98, "avg": 65.99, "max": 1.98, "min": 130.00, "cnt": 2}, "forward-compute":{"total": 1896.30, "avg": 59.26, "max": 52.69, "min": 67.46, "cnt": 32}, "fwd-compute":{"total": 1892.80, "avg": 59.15, "max": 52.61, "min": 67.27, "cnt": 32}, "batch-generator":{"total": 66.28, "avg": 2.07, "max": 0.78, "min": 5.47, "cnt": 32}, "fwd-embedding":{"total": 0.68, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1813.36, "avg": 56.67, "max": 51.35, "min": 62.13, "cnt": 32}, "fwd-layernorm":{"total": 10.64, "avg": 0.08, "max": 0.05, "min": 0.32, "cnt": 128}, "fwd-attn":{"total": 112.26, "avg": 0.88, "max": 0.74, "min": 2.95, "cnt": 128}, "fwd-misc":{"total": 22.52, "avg": 0.18, "max": 0.11, "min": 0.73, "cnt": 128}, "fwd-MLP":{"total": 1645.88, "avg": 12.86, "max": 10.79, "min": 18.60, "cnt": 128}, "MoE_L0_fwd":{"total": 461.39, "avg": 14.42, "max": 11.18, "min": 18.52, "cnt": 32}, "MoEMLP":{"total": 1628.16, "avg": 12.72, "max": 10.68, "min": 18.47, "cnt": 128}, "MoE_L1_fwd":{"total": 410.76, "avg": 12.84, "max": 11.56, "min": 16.01, "cnt": 32}, "MoE_L2_fwd":{"total": 399.60, "avg": 12.49, "max": 11.90, "min": 15.34, "cnt": 32}, "MoE_L3_fwd":{"total": 362.99, "avg": 11.34, "max": 10.72, "min": 13.68, "cnt": 32}, "fwd-pooler":{"total": 0.36, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 0.91, "avg": 0.91, "max": 0.91, "min": 0.91, "cnt": 1}, "forward-send-backward-recv":{"total": 714.17, "avg": 23.04, "max": 1.05, "min": 184.97, "cnt": 31}, "backward-compute":{"total": 1812.10, "avg": 56.63, "max": 53.58, "min": 59.39, "cnt": 32}, "MoE_L3_bwd":{"total": 420.46, "avg": 13.14, "max": 11.57, "min": 14.65, "cnt": 32}, "MoE_L2_bwd":{"total": 432.20, "avg": 13.51, "max": 12.90, "min": 14.83, "cnt": 32}, "MoE_L1_bwd":{"total": 390.20, "avg": 12.19, "max": 11.60, "min": 14.80, "cnt": 32}, "MoE_L0_bwd":{"total": 356.57, "avg": 11.14, "max": 10.35, "min": 12.01, "cnt": 32}, "backward-send-forward-recv":{"total": 10567.81, "avg": 352.26, "max": 1.59, "min": 2276.57, "cnt": 30}, "backward-send":{"total": 2.17, "avg": 1.09, "max": 1.08, "min": 1.09, "cnt": 2}, "backward-recv":{"total": 73.25, "avg": 73.25, "max": 73.25, "min": 73.25, "cnt": 1}, "backward-params-all-reduce":{"total": 491.11, "avg": 491.11, "max": 491.11, "min": 491.11, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 303.03, "avg": 303.03, "max": 303.03, "min": 303.03, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 258.84, "avg": 258.84, "max": 258.84, "min": 258.84, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.65, "avg": 6.65, "max": 6.65, "min": 6.65, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.48, "avg": 3.48, "max": 3.48, "min": 3.48, "cnt": 1}}}
{"type":"time", "iteration": 35, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 135.34, "avg": 67.67, "max": 0.69, "min": 134.65, "cnt": 2}, "forward-compute":{"total": 1846.83, "avg": 57.71, "max": 53.21, "min": 64.24, "cnt": 32}, "fwd-compute":{"total": 1843.85, "avg": 57.62, "max": 53.11, "min": 64.10, "cnt": 32}, "batch-generator":{"total": 39.02, "avg": 1.22, "max": 0.72, "min": 2.63, "cnt": 32}, "fwd-embedding":{"total": 0.51, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1792.89, "avg": 56.03, "max": 51.69, "min": 62.20, "cnt": 32}, "fwd-layernorm":{"total": 9.18, "avg": 0.07, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 107.37, "avg": 0.84, "max": 0.74, "min": 1.98, "cnt": 128}, "fwd-misc":{"total": 20.66, "avg": 0.16, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1635.04, "avg": 12.77, "max": 10.83, "min": 19.92, "cnt": 128}, "MoE_L0_fwd":{"total": 445.61, "avg": 13.93, "max": 10.97, "min": 19.74, "cnt": 32}, "MoEMLP":{"total": 1618.12, "avg": 12.64, "max": 10.72, "min": 19.65, "cnt": 128}, "MoE_L1_fwd":{"total": 398.20, "avg": 12.44, "max": 11.49, "min": 14.13, "cnt": 32}, "MoE_L2_fwd":{"total": 405.82, "avg": 12.68, "max": 12.17, "min": 13.39, "cnt": 32}, "MoE_L3_fwd":{"total": 374.78, "avg": 11.71, "max": 10.76, "min": 14.23, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 0.57, "avg": 0.57, "max": 0.57, "min": 0.57, "cnt": 1}, "forward-send-backward-recv":{"total": 189.88, "avg": 6.13, "max": 1.01, "min": 69.11, "cnt": 31}, "backward-compute":{"total": 1813.70, "avg": 56.68, "max": 53.83, "min": 58.59, "cnt": 32}, "MoE_L3_bwd":{"total": 422.62, "avg": 13.21, "max": 12.08, "min": 15.80, "cnt": 32}, "MoE_L2_bwd":{"total": 439.07, "avg": 13.72, "max": 13.20, "min": 14.92, "cnt": 32}, "MoE_L1_bwd":{"total": 381.71, "avg": 11.93, "max": 11.27, "min": 12.50, "cnt": 32}, "MoE_L0_bwd":{"total": 356.30, "avg": 11.13, "max": 10.45, "min": 11.55, "cnt": 32}, "backward-send-forward-recv":{"total": 4450.27, "avg": 148.34, "max": 2.13, "min": 508.65, "cnt": 30}, "backward-send":{"total": 1.87, "avg": 0.93, "max": 0.87, "min": 1.00, "cnt": 2}, "backward-recv":{"total": 69.45, "avg": 69.45, "max": 69.45, "min": 69.45, "cnt": 1}, "backward-params-all-reduce":{"total": 486.47, "avg": 486.47, "max": 486.47, "min": 486.47, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 310.96, "avg": 310.96, "max": 310.96, "min": 310.96, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 266.54, "avg": 266.54, "max": 266.54, "min": 266.54, "cnt": 1}, "optimizer-clip-main-grad":{"total": 7.09, "avg": 7.09, "max": 7.09, "min": 7.09, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 36, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 138.29, "avg": 69.14, "max": 5.31, "min": 132.98, "cnt": 2}, "forward-compute":{"total": 1906.01, "avg": 59.56, "max": 55.10, "min": 65.41, "cnt": 32}, "fwd-compute":{"total": 1902.47, "avg": 59.45, "max": 55.02, "min": 65.29, "cnt": 32}, "batch-generator":{"total": 45.19, "avg": 1.41, "max": 0.72, "min": 2.33, "cnt": 32}, "fwd-embedding":{"total": 0.78, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1843.82, "avg": 57.62, "max": 53.71, "min": 63.23, "cnt": 32}, "fwd-layernorm":{"total": 10.91, "avg": 0.09, "max": 0.05, "min": 0.23, "cnt": 128}, "fwd-attn":{"total": 114.58, "avg": 0.90, "max": 0.74, "min": 1.63, "cnt": 128}, "fwd-misc":{"total": 26.26, "avg": 0.21, "max": 0.12, "min": 3.21, "cnt": 128}, "fwd-MLP":{"total": 1669.25, "avg": 13.04, "max": 10.93, "min": 17.52, "cnt": 128}, "MoE_L0_fwd":{"total": 473.67, "avg": 14.80, "max": 12.53, "min": 17.34, "cnt": 32}, "MoEMLP":{"total": 1650.81, "avg": 12.90, "max": 10.81, "min": 17.25, "cnt": 128}, "MoE_L1_fwd":{"total": 404.51, "avg": 12.64, "max": 11.61, "min": 14.43, "cnt": 32}, "MoE_L2_fwd":{"total": 408.40, "avg": 12.76, "max": 12.21, "min": 13.43, "cnt": 32}, "MoE_L3_fwd":{"total": 371.11, "avg": 11.60, "max": 10.85, "min": 15.74, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 0.93, "avg": 0.93, "max": 0.93, "min": 0.93, "cnt": 1}, "forward-send-backward-recv":{"total": 3100.86, "avg": 100.03, "max": 1.42, "min": 378.80, "cnt": 31}, "backward-compute":{"total": 1809.34, "avg": 56.54, "max": 53.31, "min": 58.35, "cnt": 32}, "MoE_L3_bwd":{"total": 414.28, "avg": 12.95, "max": 11.95, "min": 14.92, "cnt": 32}, "MoE_L2_bwd":{"total": 446.27, "avg": 13.95, "max": 13.36, "min": 14.65, "cnt": 32}, "MoE_L1_bwd":{"total": 380.20, "avg": 11.88, "max": 10.85, "min": 12.72, "cnt": 32}, "MoE_L0_bwd":{"total": 356.12, "avg": 11.13, "max": 10.53, "min": 11.50, "cnt": 32}, "backward-send-forward-recv":{"total": 4305.32, "avg": 143.51, "max": 1.84, "min": 805.51, "cnt": 30}, "backward-send":{"total": 1.90, "avg": 0.95, "max": 0.95, "min": 0.95, "cnt": 2}, "backward-recv":{"total": 77.95, "avg": 77.95, "max": 77.95, "min": 77.95, "cnt": 1}, "backward-params-all-reduce":{"total": 494.50, "avg": 494.50, "max": 494.50, "min": 494.50, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 303.12, "avg": 303.12, "max": 303.12, "min": 303.12, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 258.74, "avg": 258.74, "max": 258.74, "min": 258.74, "cnt": 1}, "optimizer-clip-main-grad":{"total": 7.00, "avg": 7.00, "max": 7.00, "min": 7.00, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 37, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 135.68, "avg": 67.84, "max": 0.85, "min": 134.83, "cnt": 2}, "forward-compute":{"total": 1886.51, "avg": 58.95, "max": 52.97, "min": 67.16, "cnt": 32}, "fwd-compute":{"total": 1883.36, "avg": 58.86, "max": 52.90, "min": 67.00, "cnt": 32}, "batch-generator":{"total": 51.91, "avg": 1.62, "max": 0.65, "min": 5.01, "cnt": 32}, "fwd-embedding":{"total": 0.61, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1819.30, "avg": 56.85, "max": 50.20, "min": 61.48, "cnt": 32}, "fwd-layernorm":{"total": 9.69, "avg": 0.08, "max": 0.05, "min": 0.28, "cnt": 128}, "fwd-attn":{"total": 106.07, "avg": 0.83, "max": 0.74, "min": 2.40, "cnt": 128}, "fwd-misc":{"total": 20.80, "avg": 0.16, "max": 0.11, "min": 0.47, "cnt": 128}, "fwd-MLP":{"total": 1662.09, "avg": 12.99, "max": 10.71, "min": 18.39, "cnt": 128}, "MoE_L0_fwd":{"total": 458.08, "avg": 14.31, "max": 10.63, "min": 18.31, "cnt": 32}, "MoEMLP":{"total": 1645.31, "avg": 12.85, "max": 10.58, "min": 18.26, "cnt": 128}, "MoE_L1_fwd":{"total": 410.83, "avg": 12.84, "max": 11.49, "min": 16.14, "cnt": 32}, "MoE_L2_fwd":{"total": 409.11, "avg": 12.78, "max": 12.37, "min": 15.86, "cnt": 32}, "MoE_L3_fwd":{"total": 373.56, "avg": 11.67, "max": 10.82, "min": 12.83, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 0.78, "avg": 0.78, "max": 0.78, "min": 0.78, "cnt": 1}, "forward-send-backward-recv":{"total": 1014.73, "avg": 32.73, "max": 1.03, "min": 548.35, "cnt": 31}, "backward-compute":{"total": 1829.90, "avg": 57.18, "max": 53.50, "min": 60.72, "cnt": 32}, "MoE_L3_bwd":{"total": 421.44, "avg": 13.17, "max": 12.11, "min": 16.78, "cnt": 32}, "MoE_L2_bwd":{"total": 446.77, "avg": 13.96, "max": 13.02, "min": 14.44, "cnt": 32}, "MoE_L1_bwd":{"total": 382.88, "avg": 11.96, "max": 11.23, "min": 13.18, "cnt": 32}, "MoE_L0_bwd":{"total": 364.22, "avg": 11.38, "max": 10.68, "min": 12.96, "cnt": 32}, "backward-send-forward-recv":{"total": 6171.78, "avg": 205.73, "max": 1.79, "min": 741.12, "cnt": 30}, "backward-send":{"total": 1.28, "avg": 0.64, "max": 0.52, "min": 0.76, "cnt": 2}, "backward-recv":{"total": 72.71, "avg": 72.71, "max": 72.71, "min": 72.71, "cnt": 1}, "backward-params-all-reduce":{"total": 484.33, "avg": 484.33, "max": 484.33, "min": 484.33, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 314.16, "avg": 314.16, "max": 314.16, "min": 314.16, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 269.69, "avg": 269.69, "max": 269.69, "min": 269.69, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.90, "avg": 6.90, "max": 6.90, "min": 6.90, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.47, "avg": 3.47, "max": 3.47, "min": 3.47, "cnt": 1}}}
{"type":"time", "iteration": 38, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 133.16, "avg": 66.58, "max": 2.70, "min": 130.46, "cnt": 2}, "forward-compute":{"total": 1890.95, "avg": 59.09, "max": 54.71, "min": 69.23, "cnt": 32}, "fwd-compute":{"total": 1887.66, "avg": 58.99, "max": 54.62, "min": 69.15, "cnt": 32}, "batch-generator":{"total": 52.26, "avg": 1.63, "max": 0.66, "min": 3.45, "cnt": 32}, "fwd-embedding":{"total": 0.66, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1822.71, "avg": 56.96, "max": 53.02, "min": 66.07, "cnt": 32}, "fwd-layernorm":{"total": 9.89, "avg": 0.08, "max": 0.05, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 108.12, "avg": 0.84, "max": 0.74, "min": 1.48, "cnt": 128}, "fwd-misc":{"total": 21.03, "avg": 0.16, "max": 0.11, "min": 0.38, "cnt": 128}, "fwd-MLP":{"total": 1662.68, "avg": 12.99, "max": 11.01, "min": 21.51, "cnt": 128}, "MoE_L0_fwd":{"total": 466.87, "avg": 14.59, "max": 11.61, "min": 21.44, "cnt": 32}, "MoEMLP":{"total": 1645.36, "avg": 12.85, "max": 10.91, "min": 21.40, "cnt": 128}, "MoE_L1_fwd":{"total": 402.76, "avg": 12.59, "max": 11.56, "min": 15.50, "cnt": 32}, "MoE_L2_fwd":{"total": 409.49, "avg": 12.80, "max": 12.42, "min": 14.54, "cnt": 32}, "MoE_L3_fwd":{"total": 372.58, "avg": 11.64, "max": 10.95, "min": 13.35, "cnt": 32}, "fwd-pooler":{"total": 0.36, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 0.96, "avg": 0.96, "max": 0.96, "min": 0.96, "cnt": 1}, "forward-send-backward-recv":{"total": 1194.50, "avg": 38.53, "max": 1.03, "min": 255.20, "cnt": 31}, "backward-compute":{"total": 1816.21, "avg": 56.76, "max": 53.46, "min": 60.34, "cnt": 32}, "MoE_L3_bwd":{"total": 414.68, "avg": 12.96, "max": 12.04, "min": 14.42, "cnt": 32}, "MoE_L2_bwd":{"total": 448.70, "avg": 14.02, "max": 13.23, "min": 16.73, "cnt": 32}, "MoE_L1_bwd":{"total": 379.11, "avg": 11.85, "max": 11.22, "min": 13.45, "cnt": 32}, "MoE_L0_bwd":{"total": 360.75, "avg": 11.27, "max": 10.75, "min": 12.04, "cnt": 32}, "backward-send-forward-recv":{"total": 5502.17, "avg": 183.41, "max": 1.05, "min": 591.64, "cnt": 30}, "backward-send":{"total": 1.16, "avg": 0.58, "max": 0.57, "min": 0.59, "cnt": 2}, "backward-recv":{"total": 70.15, "avg": 70.15, "max": 70.15, "min": 70.15, "cnt": 1}, "backward-params-all-reduce":{"total": 490.40, "avg": 490.40, "max": 490.40, "min": 490.40, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 314.06, "avg": 314.06, "max": 314.06, "min": 314.06, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 268.63, "avg": 268.63, "max": 268.63, "min": 268.63, "cnt": 1}, "optimizer-clip-main-grad":{"total": 7.95, "avg": 7.95, "max": 7.95, "min": 7.95, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.47, "avg": 3.47, "max": 3.47, "min": 3.47, "cnt": 1}}}
{"type":"time", "iteration": 39, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 138.36, "avg": 69.18, "max": 5.67, "min": 132.69, "cnt": 2}, "forward-compute":{"total": 1852.65, "avg": 57.90, "max": 52.54, "min": 66.67, "cnt": 32}, "fwd-compute":{"total": 1849.73, "avg": 57.80, "max": 52.45, "min": 66.58, "cnt": 32}, "batch-generator":{"total": 35.96, "avg": 1.12, "max": 0.65, "min": 2.21, "cnt": 32}, "fwd-embedding":{"total": 0.53, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1801.92, "avg": 56.31, "max": 51.18, "min": 64.69, "cnt": 32}, "fwd-layernorm":{"total": 9.04, "avg": 0.07, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 104.45, "avg": 0.82, "max": 0.74, "min": 1.64, "cnt": 128}, "fwd-misc":{"total": 20.33, "avg": 0.16, "max": 0.11, "min": 0.34, "cnt": 128}, "fwd-MLP":{"total": 1648.04, "avg": 12.88, "max": 11.07, "min": 18.45, "cnt": 128}, "MoE_L0_fwd":{"total": 448.07, "avg": 14.00, "max": 11.04, "min": 18.38, "cnt": 32}, "MoEMLP":{"total": 1631.44, "avg": 12.75, "max": 10.95, "min": 18.33, "cnt": 128}, "MoE_L1_fwd":{"total": 403.69, "avg": 12.62, "max": 11.51, "min": 15.49, "cnt": 32}, "MoE_L2_fwd":{"total": 413.39, "avg": 12.92, "max": 12.39, "min": 14.22, "cnt": 32}, "MoE_L3_fwd":{"total": 372.45, "avg": 11.64, "max": 11.00, "min": 16.15, "cnt": 32}, "fwd-pooler":{"total": 0.36, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.61, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 0.81, "avg": 0.81, "max": 0.81, "min": 0.81, "cnt": 1}, "forward-send-backward-recv":{"total": 886.13, "avg": 28.58, "max": 1.31, "min": 255.90, "cnt": 31}, "backward-compute":{"total": 1846.21, "avg": 57.69, "max": 54.22, "min": 60.25, "cnt": 32}, "MoE_L3_bwd":{"total": 433.37, "avg": 13.54, "max": 12.04, "min": 15.03, "cnt": 32}, "MoE_L2_bwd":{"total": 451.86, "avg": 14.12, "max": 13.40, "min": 15.01, "cnt": 32}, "MoE_L1_bwd":{"total": 387.97, "avg": 12.12, "max": 11.37, "min": 15.18, "cnt": 32}, "MoE_L0_bwd":{"total": 361.92, "avg": 11.31, "max": 10.74, "min": 12.04, "cnt": 32}, "backward-send-forward-recv":{"total": 5250.31, "avg": 175.01, "max": 2.10, "min": 1070.68, "cnt": 30}, "backward-send":{"total": 1.70, "avg": 0.85, "max": 0.65, "min": 1.05, "cnt": 2}, "backward-recv":{"total": 228.44, "avg": 228.44, "max": 228.44, "min": 228.44, "cnt": 1}, "backward-params-all-reduce":{"total": 485.10, "avg": 485.10, "max": 485.10, "min": 485.10, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 311.44, "avg": 311.44, "max": 311.44, "min": 311.44, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 267.23, "avg": 267.23, "max": 267.23, "min": 267.23, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.92, "avg": 6.92, "max": 6.92, "min": 6.92, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 40, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 280.85, "avg": 140.42, "max": 0.79, "min": 280.06, "cnt": 2}, "forward-compute":{"total": 1831.15, "avg": 57.22, "max": 51.69, "min": 64.90, "cnt": 32}, "fwd-compute":{"total": 1828.23, "avg": 57.13, "max": 51.61, "min": 64.82, "cnt": 32}, "batch-generator":{"total": 40.96, "avg": 1.28, "max": 0.71, "min": 4.51, "cnt": 32}, "fwd-embedding":{"total": 0.49, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1775.85, "avg": 55.50, "max": 49.77, "min": 62.40, "cnt": 32}, "fwd-layernorm":{"total": 8.91, "avg": 0.07, "max": 0.05, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 103.41, "avg": 0.81, "max": 0.74, "min": 1.54, "cnt": 128}, "fwd-misc":{"total": 20.11, "avg": 0.16, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1623.54, "avg": 12.68, "max": 10.47, "min": 19.88, "cnt": 128}, "MoE_L0_fwd":{"total": 432.87, "avg": 13.53, "max": 10.40, "min": 19.80, "cnt": 32}, "MoEMLP":{"total": 1606.97, "avg": 12.55, "max": 10.34, "min": 19.76, "cnt": 128}, "MoE_L1_fwd":{"total": 401.35, "avg": 12.54, "max": 11.39, "min": 14.84, "cnt": 32}, "MoE_L2_fwd":{"total": 407.15, "avg": 12.72, "max": 12.09, "min": 14.26, "cnt": 32}, "MoE_L3_fwd":{"total": 371.69, "avg": 11.62, "max": 10.91, "min": 13.11, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 0.67, "avg": 0.67, "max": 0.67, "min": 0.67, "cnt": 1}, "forward-send-backward-recv":{"total": 993.39, "avg": 32.04, "max": 1.41, "min": 184.21, "cnt": 31}, "backward-compute":{"total": 1847.25, "avg": 57.73, "max": 54.35, "min": 60.99, "cnt": 32}, "MoE_L3_bwd":{"total": 441.62, "avg": 13.80, "max": 12.11, "min": 16.33, "cnt": 32}, "MoE_L2_bwd":{"total": 448.02, "avg": 14.00, "max": 13.18, "min": 16.32, "cnt": 32}, "MoE_L1_bwd":{"total": 381.27, "avg": 11.91, "max": 11.10, "min": 13.34, "cnt": 32}, "MoE_L0_bwd":{"total": 363.51, "avg": 11.36, "max": 10.48, "min": 14.21, "cnt": 32}, "backward-send-forward-recv":{"total": 4292.47, "avg": 143.08, "max": 1.17, "min": 851.14, "cnt": 30}, "backward-send":{"total": 1.14, "avg": 0.57, "max": 0.51, "min": 0.63, "cnt": 2}, "backward-recv":{"total": 71.68, "avg": 71.68, "max": 71.68, "min": 71.68, "cnt": 1}, "backward-params-all-reduce":{"total": 505.69, "avg": 505.69, "max": 505.69, "min": 505.69, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 297.13, "avg": 297.13, "max": 297.13, "min": 297.13, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 251.07, "avg": 251.07, "max": 251.07, "min": 251.07, "cnt": 1}, "optimizer-clip-main-grad":{"total": 8.69, "avg": 8.69, "max": 8.69, "min": 8.69, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.50, "avg": 3.50, "max": 3.50, "min": 3.50, "cnt": 1}}}
{"type":"time", "iteration": 41, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 139.83, "avg": 69.91, "max": 1.15, "min": 138.68, "cnt": 2}, "forward-compute":{"total": 1884.20, "avg": 58.88, "max": 53.81, "min": 68.79, "cnt": 32}, "fwd-compute":{"total": 1881.09, "avg": 58.78, "max": 53.74, "min": 68.68, "cnt": 32}, "batch-generator":{"total": 51.45, "avg": 1.61, "max": 0.75, "min": 3.85, "cnt": 32}, "fwd-embedding":{"total": 0.63, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1817.17, "avg": 56.79, "max": 52.45, "min": 65.55, "cnt": 32}, "fwd-layernorm":{"total": 9.52, "avg": 0.07, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 108.75, "avg": 0.85, "max": 0.74, "min": 2.17, "cnt": 128}, "fwd-misc":{"total": 21.13, "avg": 0.17, "max": 0.11, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1656.96, "avg": 12.95, "max": 11.00, "min": 18.39, "cnt": 128}, "MoE_L0_fwd":{"total": 461.14, "avg": 14.41, "max": 11.76, "min": 18.32, "cnt": 32}, "MoEMLP":{"total": 1640.02, "avg": 12.81, "max": 10.88, "min": 18.27, "cnt": 128}, "MoE_L1_fwd":{"total": 408.06, "avg": 12.75, "max": 11.61, "min": 15.87, "cnt": 32}, "MoE_L2_fwd":{"total": 399.20, "avg": 12.48, "max": 11.91, "min": 14.19, "cnt": 32}, "MoE_L3_fwd":{"total": 377.95, "avg": 11.81, "max": 10.93, "min": 14.63, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 0.79, "avg": 0.79, "max": 0.79, "min": 0.79, "cnt": 1}, "forward-send-backward-recv":{"total": 751.85, "avg": 24.25, "max": 0.95, "min": 201.50, "cnt": 31}, "backward-compute":{"total": 1796.51, "avg": 56.14, "max": 54.30, "min": 58.18, "cnt": 32}, "MoE_L3_bwd":{"total": 414.72, "avg": 12.96, "max": 11.97, "min": 14.74, "cnt": 32}, "MoE_L2_bwd":{"total": 440.29, "avg": 13.76, "max": 12.88, "min": 14.48, "cnt": 32}, "MoE_L1_bwd":{"total": 371.41, "avg": 11.61, "max": 11.06, "min": 12.31, "cnt": 32}, "MoE_L0_bwd":{"total": 356.25, "avg": 11.13, "max": 10.67, "min": 12.02, "cnt": 32}, "backward-send-forward-recv":{"total": 6092.19, "avg": 203.07, "max": 2.09, "min": 816.22, "cnt": 30}, "backward-send":{"total": 1.99, "avg": 1.00, "max": 0.76, "min": 1.23, "cnt": 2}, "backward-recv":{"total": 74.07, "avg": 74.07, "max": 74.07, "min": 74.07, "cnt": 1}, "backward-params-all-reduce":{"total": 490.82, "avg": 490.82, "max": 490.82, "min": 490.82, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 307.30, "avg": 307.30, "max": 307.30, "min": 307.30, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.40, "avg": 3.40, "max": 3.40, "min": 3.40, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 262.88, "avg": 262.88, "max": 262.88, "min": 262.88, "cnt": 1}, "optimizer-clip-main-grad":{"total": 7.02, "avg": 7.02, "max": 7.02, "min": 7.02, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 42, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 132.52, "avg": 66.26, "max": 1.01, "min": 131.51, "cnt": 2}, "forward-compute":{"total": 1927.73, "avg": 60.24, "max": 53.01, "min": 68.90, "cnt": 32}, "fwd-compute":{"total": 1924.55, "avg": 60.14, "max": 52.95, "min": 68.82, "cnt": 32}, "batch-generator":{"total": 47.40, "avg": 1.48, "max": 0.69, "min": 3.39, "cnt": 32}, "fwd-embedding":{"total": 0.66, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1864.60, "avg": 58.27, "max": 51.94, "min": 66.17, "cnt": 32}, "fwd-layernorm":{"total": 9.70, "avg": 0.08, "max": 0.05, "min": 0.25, "cnt": 128}, "fwd-attn":{"total": 109.49, "avg": 0.86, "max": 0.74, "min": 1.74, "cnt": 128}, "fwd-misc":{"total": 21.73, "avg": 0.17, "max": 0.11, "min": 0.43, "cnt": 128}, "fwd-MLP":{"total": 1702.97, "avg": 13.30, "max": 10.90, "min": 22.52, "cnt": 128}, "MoE_L0_fwd":{"total": 497.88, "avg": 15.56, "max": 11.56, "min": 22.45, "cnt": 32}, "MoEMLP":{"total": 1685.74, "avg": 13.17, "max": 10.80, "min": 22.40, "cnt": 128}, "MoE_L1_fwd":{"total": 419.91, "avg": 13.12, "max": 11.14, "min": 17.04, "cnt": 32}, "MoE_L2_fwd":{"total": 398.78, "avg": 12.46, "max": 11.90, "min": 13.14, "cnt": 32}, "MoE_L3_fwd":{"total": 375.44, "avg": 11.73, "max": 10.84, "min": 16.57, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 0.88, "avg": 0.88, "max": 0.88, "min": 0.88, "cnt": 1}, "forward-send-backward-recv":{"total": 274.06, "avg": 8.84, "max": 0.85, "min": 65.99, "cnt": 31}, "backward-compute":{"total": 1789.52, "avg": 55.92, "max": 50.94, "min": 59.59, "cnt": 32}, "MoE_L3_bwd":{"total": 424.25, "avg": 13.26, "max": 11.74, "min": 16.65, "cnt": 32}, "MoE_L2_bwd":{"total": 414.08, "avg": 12.94, "max": 12.27, "min": 13.85, "cnt": 32}, "MoE_L1_bwd":{"total": 373.86, "avg": 11.68, "max": 10.61, "min": 13.27, "cnt": 32}, "MoE_L0_bwd":{"total": 362.71, "avg": 11.33, "max": 10.21, "min": 12.45, "cnt": 32}, "backward-send-forward-recv":{"total": 6635.05, "avg": 221.17, "max": 0.96, "min": 1138.71, "cnt": 30}, "backward-send":{"total": 2.28, "avg": 1.14, "max": 0.86, "min": 1.42, "cnt": 2}, "backward-recv":{"total": 75.84, "avg": 75.84, "max": 75.84, "min": 75.84, "cnt": 1}, "backward-params-all-reduce":{"total": 490.79, "avg": 490.79, "max": 490.79, "min": 490.79, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 308.90, "avg": 308.90, "max": 308.90, "min": 308.90, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 264.64, "avg": 264.64, "max": 264.64, "min": 264.64, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.96, "avg": 6.96, "max": 6.96, "min": 6.96, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 43, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 137.96, "avg": 68.98, "max": 10.86, "min": 127.09, "cnt": 2}, "forward-compute":{"total": 1805.60, "avg": 56.43, "max": 51.23, "min": 68.28, "cnt": 32}, "fwd-compute":{"total": 1802.63, "avg": 56.33, "max": 51.15, "min": 68.15, "cnt": 32}, "batch-generator":{"total": 36.91, "avg": 1.15, "max": 0.64, "min": 2.62, "cnt": 32}, "fwd-embedding":{"total": 0.54, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1754.07, "avg": 54.81, "max": 49.66, "min": 65.97, "cnt": 32}, "fwd-layernorm":{"total": 9.16, "avg": 0.07, "max": 0.05, "min": 0.17, "cnt": 128}, "fwd-attn":{"total": 106.39, "avg": 0.83, "max": 0.74, "min": 1.44, "cnt": 128}, "fwd-misc":{"total": 20.85, "avg": 0.16, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1596.92, "avg": 12.48, "max": 10.70, "min": 23.56, "cnt": 128}, "MoE_L0_fwd":{"total": 461.52, "avg": 14.42, "max": 11.01, "min": 23.42, "cnt": 32}, "MoEMLP":{"total": 1579.85, "avg": 12.34, "max": 10.59, "min": 23.34, "cnt": 128}, "MoE_L1_fwd":{"total": 383.06, "avg": 11.97, "max": 10.71, "min": 14.56, "cnt": 32}, "MoE_L2_fwd":{"total": 386.95, "avg": 12.09, "max": 11.37, "min": 13.19, "cnt": 32}, "MoE_L3_fwd":{"total": 354.54, "avg": 11.08, "max": 10.63, "min": 14.69, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.61, "avg": 0.02, "max": 0.02, "min": 0.04, "cnt": 32}, "forward-send":{"total": 0.92, "avg": 0.92, "max": 0.92, "min": 0.92, "cnt": 1}, "forward-send-backward-recv":{"total": 734.12, "avg": 23.68, "max": 0.93, "min": 175.12, "cnt": 31}, "backward-compute":{"total": 1737.29, "avg": 54.29, "max": 49.76, "min": 57.99, "cnt": 32}, "MoE_L3_bwd":{"total": 401.84, "avg": 12.56, "max": 11.02, "min": 14.52, "cnt": 32}, "MoE_L2_bwd":{"total": 421.49, "avg": 13.17, "max": 12.27, "min": 15.14, "cnt": 32}, "MoE_L1_bwd":{"total": 360.22, "avg": 11.26, "max": 10.30, "min": 15.56, "cnt": 32}, "MoE_L0_bwd":{"total": 339.32, "avg": 10.60, "max": 9.78, "min": 11.63, "cnt": 32}, "backward-send-forward-recv":{"total": 4184.26, "avg": 139.48, "max": 2.26, "min": 332.02, "cnt": 30}, "backward-send":{"total": 1.86, "avg": 0.93, "max": 0.82, "min": 1.04, "cnt": 2}, "backward-recv":{"total": 219.09, "avg": 219.09, "max": 219.09, "min": 219.09, "cnt": 1}, "backward-params-all-reduce":{"total": 492.21, "avg": 492.21, "max": 492.21, "min": 492.21, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.04, "avg": 0.04, "max": 0.04, "min": 0.04, "cnt": 1}, "optimizer":{"total": 385.09, "avg": 385.09, "max": 385.09, "min": 385.09, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.40, "avg": 3.40, "max": 3.40, "min": 3.40, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 340.84, "avg": 340.84, "max": 340.84, "min": 340.84, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.79, "avg": 6.79, "max": 6.79, "min": 6.79, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.54, "avg": 3.54, "max": 3.54, "min": 3.54, "cnt": 1}}}
{"type":"time", "iteration": 44, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 136.89, "avg": 68.44, "max": 7.67, "min": 129.22, "cnt": 2}, "forward-compute":{"total": 1873.76, "avg": 58.55, "max": 50.15, "min": 133.37, "cnt": 32}, "fwd-compute":{"total": 1870.31, "avg": 58.45, "max": 50.08, "min": 133.22, "cnt": 32}, "batch-generator":{"total": 44.34, "avg": 1.39, "max": 0.68, "min": 3.76, "cnt": 32}, "fwd-embedding":{"total": 0.60, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1813.53, "avg": 56.67, "max": 48.99, "min": 131.08, "cnt": 32}, "fwd-layernorm":{"total": 9.75, "avg": 0.08, "max": 0.05, "min": 0.32, "cnt": 128}, "fwd-attn":{"total": 110.71, "avg": 0.86, "max": 0.74, "min": 2.58, "cnt": 128}, "fwd-misc":{"total": 21.28, "avg": 0.17, "max": 0.11, "min": 0.41, "cnt": 128}, "fwd-MLP":{"total": 1650.56, "avg": 12.90, "max": 10.52, "min": 84.80, "cnt": 128}, "MoE_L0_fwd":{"total": 435.22, "avg": 13.60, "max": 10.41, "min": 17.56, "cnt": 32}, "MoEMLP":{"total": 1633.36, "avg": 12.76, "max": 10.36, "min": 84.65, "cnt": 128}, "MoE_L1_fwd":{"total": 455.52, "avg": 14.23, "max": 10.94, "min": 84.71, "cnt": 32}, "MoE_L2_fwd":{"total": 388.45, "avg": 12.14, "max": 11.31, "min": 14.71, "cnt": 32}, "MoE_L3_fwd":{"total": 360.46, "avg": 11.26, "max": 10.45, "min": 16.11, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 0.66, "avg": 0.66, "max": 0.66, "min": 0.66, "cnt": 1}, "forward-send-backward-recv":{"total": 2643.28, "avg": 85.27, "max": 1.54, "min": 310.28, "cnt": 31}, "backward-compute":{"total": 1710.64, "avg": 53.46, "max": 49.07, "min": 55.92, "cnt": 32}, "MoE_L3_bwd":{"total": 400.20, "avg": 12.51, "max": 11.18, "min": 14.13, "cnt": 32}, "MoE_L2_bwd":{"total": 401.90, "avg": 12.56, "max": 11.88, "min": 14.27, "cnt": 32}, "MoE_L1_bwd":{"total": 361.77, "avg": 11.31, "max": 10.02, "min": 13.27, "cnt": 32}, "MoE_L0_bwd":{"total": 332.73, "avg": 10.40, "max": 9.41, "min": 11.05, "cnt": 32}, "backward-send-forward-recv":{"total": 4523.53, "avg": 150.78, "max": 1.00, "min": 1316.18, "cnt": 30}, "backward-send":{"total": 1.97, "avg": 0.98, "max": 0.80, "min": 1.17, "cnt": 2}, "backward-recv":{"total": 77.27, "avg": 77.27, "max": 77.27, "min": 77.27, "cnt": 1}, "backward-params-all-reduce":{"total": 489.77, "avg": 489.77, "max": 489.77, "min": 489.77, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 307.32, "avg": 307.32, "max": 307.32, "min": 307.32, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.40, "avg": 3.40, "max": 3.40, "min": 3.40, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 263.11, "avg": 263.11, "max": 263.11, "min": 263.11, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.88, "avg": 6.88, "max": 6.88, "min": 6.88, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 45, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.11, "avg": 0.11, "max": 0.11, "min": 0.11, "cnt": 1}, "forward-recv":{"total": 137.76, "avg": 68.88, "max": 10.49, "min": 127.27, "cnt": 2}, "forward-compute":{"total": 1759.06, "avg": 54.97, "max": 50.05, "min": 63.06, "cnt": 32}, "fwd-compute":{"total": 1756.08, "avg": 54.88, "max": 49.98, "min": 62.97, "cnt": 32}, "batch-generator":{"total": 55.26, "avg": 1.73, "max": 0.65, "min": 5.72, "cnt": 32}, "fwd-embedding":{"total": 0.61, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1688.98, "avg": 52.78, "max": 48.73, "min": 58.69, "cnt": 32}, "fwd-layernorm":{"total": 9.37, "avg": 0.07, "max": 0.05, "min": 0.18, "cnt": 128}, "fwd-attn":{"total": 107.01, "avg": 0.84, "max": 0.74, "min": 1.52, "cnt": 128}, "fwd-misc":{"total": 21.15, "avg": 0.17, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1530.77, "avg": 11.96, "max": 10.36, "min": 16.34, "cnt": 128}, "MoE_L0_fwd":{"total": 399.13, "avg": 12.47, "max": 10.28, "min": 16.19, "cnt": 32}, "MoEMLP":{"total": 1513.85, "avg": 11.83, "max": 10.24, "min": 16.10, "cnt": 128}, "MoE_L1_fwd":{"total": 379.99, "avg": 11.87, "max": 10.72, "min": 14.75, "cnt": 32}, "MoE_L2_fwd":{"total": 385.77, "avg": 12.06, "max": 11.55, "min": 13.01, "cnt": 32}, "MoE_L3_fwd":{"total": 355.24, "avg": 11.10, "max": 10.59, "min": 12.00, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 0.73, "avg": 0.73, "max": 0.73, "min": 0.73, "cnt": 1}, "forward-send-backward-recv":{"total": 357.66, "avg": 11.54, "max": 1.05, "min": 82.02, "cnt": 31}, "backward-compute":{"total": 1701.93, "avg": 53.19, "max": 50.19, "min": 56.31, "cnt": 32}, "MoE_L3_bwd":{"total": 398.87, "avg": 12.46, "max": 11.45, "min": 14.18, "cnt": 32}, "MoE_L2_bwd":{"total": 395.78, "avg": 12.37, "max": 11.67, "min": 13.60, "cnt": 32}, "MoE_L1_bwd":{"total": 358.94, "avg": 11.22, "max": 10.31, "min": 12.49, "cnt": 32}, "MoE_L0_bwd":{"total": 335.71, "avg": 10.49, "max": 9.79, "min": 12.47, "cnt": 32}, "backward-send-forward-recv":{"total": 4081.43, "avg": 136.05, "max": 2.29, "min": 351.98, "cnt": 30}, "backward-send":{"total": 1.89, "avg": 0.94, "max": 0.91, "min": 0.98, "cnt": 2}, "backward-recv":{"total": 265.82, "avg": 265.82, "max": 265.82, "min": 265.82, "cnt": 1}, "backward-params-all-reduce":{"total": 489.84, "avg": 489.84, "max": 489.84, "min": 489.84, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 311.36, "avg": 311.36, "max": 311.36, "min": 311.36, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 266.80, "avg": 266.80, "max": 266.80, "min": 266.80, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.99, "avg": 6.99, "max": 6.99, "min": 6.99, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.56, "avg": 3.56, "max": 3.56, "min": 3.56, "cnt": 1}}}
{"type":"time", "iteration": 46, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 128.76, "avg": 64.38, "max": 0.99, "min": 127.76, "cnt": 2}, "forward-compute":{"total": 1801.22, "avg": 56.29, "max": 51.23, "min": 67.71, "cnt": 32}, "fwd-compute":{"total": 1797.88, "avg": 56.18, "max": 51.12, "min": 67.39, "cnt": 32}, "batch-generator":{"total": 43.32, "avg": 1.35, "max": 0.73, "min": 3.28, "cnt": 32}, "fwd-embedding":{"total": 0.58, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1742.29, "avg": 54.45, "max": 49.40, "min": 63.49, "cnt": 32}, "fwd-layernorm":{"total": 9.71, "avg": 0.08, "max": 0.05, "min": 0.23, "cnt": 128}, "fwd-attn":{"total": 107.67, "avg": 0.84, "max": 0.74, "min": 1.92, "cnt": 128}, "fwd-misc":{"total": 21.18, "avg": 0.17, "max": 0.11, "min": 0.42, "cnt": 128}, "fwd-MLP":{"total": 1582.52, "avg": 12.36, "max": 10.17, "min": 18.72, "cnt": 128}, "MoE_L0_fwd":{"total": 429.12, "avg": 13.41, "max": 10.10, "min": 18.55, "cnt": 32}, "MoEMLP":{"total": 1564.94, "avg": 12.23, "max": 10.06, "min": 18.45, "cnt": 128}, "MoE_L1_fwd":{"total": 394.21, "avg": 12.32, "max": 11.07, "min": 15.58, "cnt": 32}, "MoE_L2_fwd":{"total": 402.41, "avg": 12.58, "max": 11.56, "min": 14.80, "cnt": 32}, "MoE_L3_fwd":{"total": 345.65, "avg": 10.80, "max": 10.47, "min": 11.48, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.14, "avg": 1.14, "max": 1.14, "min": 1.14, "cnt": 1}, "forward-send-backward-recv":{"total": 2180.10, "avg": 70.33, "max": 1.06, "min": 329.24, "cnt": 31}, "backward-compute":{"total": 1719.11, "avg": 53.72, "max": 49.94, "min": 55.25, "cnt": 32}, "MoE_L3_bwd":{"total": 394.66, "avg": 12.33, "max": 10.84, "min": 13.64, "cnt": 32}, "MoE_L2_bwd":{"total": 405.57, "avg": 12.67, "max": 12.04, "min": 14.03, "cnt": 32}, "MoE_L1_bwd":{"total": 360.46, "avg": 11.26, "max": 10.49, "min": 12.67, "cnt": 32}, "MoE_L0_bwd":{"total": 341.95, "avg": 10.69, "max": 9.95, "min": 11.05, "cnt": 32}, "backward-send-forward-recv":{"total": 4708.08, "avg": 156.94, "max": 1.24, "min": 1924.61, "cnt": 30}, "backward-send":{"total": 2.32, "avg": 1.16, "max": 1.11, "min": 1.20, "cnt": 2}, "backward-recv":{"total": 551.40, "avg": 551.40, "max": 551.40, "min": 551.40, "cnt": 1}, "backward-params-all-reduce":{"total": 488.92, "avg": 488.92, "max": 488.92, "min": 488.92, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 310.75, "avg": 310.75, "max": 310.75, "min": 310.75, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 266.44, "avg": 266.44, "max": 266.44, "min": 266.44, "cnt": 1}, "optimizer-clip-main-grad":{"total": 7.05, "avg": 7.05, "max": 7.05, "min": 7.05, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 47, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.10, "avg": 0.10, "max": 0.10, "min": 0.10, "cnt": 1}, "forward-recv":{"total": 139.09, "avg": 69.55, "max": 9.00, "min": 130.09, "cnt": 2}, "forward-compute":{"total": 1818.27, "avg": 56.82, "max": 50.80, "min": 65.11, "cnt": 32}, "fwd-compute":{"total": 1815.13, "avg": 56.72, "max": 50.73, "min": 65.04, "cnt": 32}, "batch-generator":{"total": 51.44, "avg": 1.61, "max": 0.67, "min": 4.39, "cnt": 32}, "fwd-embedding":{"total": 0.54, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1751.43, "avg": 54.73, "max": 49.13, "min": 63.97, "cnt": 32}, "fwd-layernorm":{"total": 9.52, "avg": 0.07, "max": 0.05, "min": 0.23, "cnt": 128}, "fwd-attn":{"total": 106.94, "avg": 0.84, "max": 0.74, "min": 1.73, "cnt": 128}, "fwd-misc":{"total": 20.61, "avg": 0.16, "max": 0.11, "min": 0.39, "cnt": 128}, "fwd-MLP":{"total": 1593.43, "avg": 12.45, "max": 10.23, "min": 23.68, "cnt": 128}, "MoE_L0_fwd":{"total": 434.38, "avg": 13.57, "max": 10.15, "min": 23.60, "cnt": 32}, "MoEMLP":{"total": 1576.28, "avg": 12.31, "max": 10.10, "min": 23.56, "cnt": 128}, "MoE_L1_fwd":{"total": 400.73, "avg": 12.52, "max": 11.26, "min": 16.09, "cnt": 32}, "MoE_L2_fwd":{"total": 385.96, "avg": 12.06, "max": 11.41, "min": 12.91, "cnt": 32}, "MoE_L3_fwd":{"total": 361.45, "avg": 11.30, "max": 10.74, "min": 13.79, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 0.74, "avg": 0.74, "max": 0.74, "min": 0.74, "cnt": 1}, "forward-send-backward-recv":{"total": 909.79, "avg": 29.35, "max": 0.94, "min": 264.76, "cnt": 31}, "backward-compute":{"total": 1729.81, "avg": 54.06, "max": 49.76, "min": 56.82, "cnt": 32}, "MoE_L3_bwd":{"total": 414.84, "avg": 12.96, "max": 11.10, "min": 14.67, "cnt": 32}, "MoE_L2_bwd":{"total": 407.88, "avg": 12.75, "max": 11.67, "min": 13.79, "cnt": 32}, "MoE_L1_bwd":{"total": 371.58, "avg": 11.61, "max": 10.95, "min": 12.84, "cnt": 32}, "MoE_L0_bwd":{"total": 322.25, "avg": 10.07, "max": 9.17, "min": 11.98, "cnt": 32}, "backward-send-forward-recv":{"total": 5045.83, "avg": 168.19, "max": 1.93, "min": 523.88, "cnt": 30}, "backward-send":{"total": 2.18, "avg": 1.09, "max": 1.03, "min": 1.14, "cnt": 2}, "backward-recv":{"total": 136.35, "avg": 136.35, "max": 136.35, "min": 136.35, "cnt": 1}, "backward-params-all-reduce":{"total": 486.60, "avg": 486.60, "max": 486.60, "min": 486.60, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "optimizer":{"total": 302.77, "avg": 302.77, "max": 302.77, "min": 302.77, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 258.21, "avg": 258.21, "max": 258.21, "min": 258.21, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.94, "avg": 6.94, "max": 6.94, "min": 6.94, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.51, "avg": 3.51, "max": 3.51, "min": 3.51, "cnt": 1}}}
{"type":"time", "iteration": 48, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 142.02, "avg": 71.01, "max": 1.22, "min": 140.80, "cnt": 2}, "forward-compute":{"total": 1853.84, "avg": 57.93, "max": 52.03, "min": 64.99, "cnt": 32}, "fwd-compute":{"total": 1850.60, "avg": 57.83, "max": 51.96, "min": 64.90, "cnt": 32}, "batch-generator":{"total": 44.88, "avg": 1.40, "max": 0.64, "min": 4.17, "cnt": 32}, "fwd-embedding":{"total": 0.63, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1792.73, "avg": 56.02, "max": 51.02, "min": 63.76, "cnt": 32}, "fwd-layernorm":{"total": 9.96, "avg": 0.08, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 110.39, "avg": 0.86, "max": 0.74, "min": 1.55, "cnt": 128}, "fwd-misc":{"total": 24.48, "avg": 0.19, "max": 0.12, "min": 2.48, "cnt": 128}, "fwd-MLP":{"total": 1625.51, "avg": 12.70, "max": 10.66, "min": 22.34, "cnt": 128}, "MoE_L0_fwd":{"total": 461.47, "avg": 14.42, "max": 10.82, "min": 22.27, "cnt": 32}, "MoEMLP":{"total": 1607.48, "avg": 12.56, "max": 10.53, "min": 22.22, "cnt": 128}, "MoE_L1_fwd":{"total": 393.95, "avg": 12.31, "max": 11.27, "min": 14.21, "cnt": 32}, "MoE_L2_fwd":{"total": 406.15, "avg": 12.69, "max": 12.13, "min": 14.72, "cnt": 32}, "MoE_L3_fwd":{"total": 352.60, "avg": 11.02, "max": 10.57, "min": 12.30, "cnt": 32}, "fwd-pooler":{"total": 0.38, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.63, "avg": 0.02, "max": 0.02, "min": 0.05, "cnt": 32}, "forward-send":{"total": 0.92, "avg": 0.92, "max": 0.92, "min": 0.92, "cnt": 1}, "forward-send-backward-recv":{"total": 498.79, "avg": 16.09, "max": 1.17, "min": 131.20, "cnt": 31}, "backward-compute":{"total": 1808.60, "avg": 56.52, "max": 53.03, "min": 57.83, "cnt": 32}, "MoE_L3_bwd":{"total": 403.50, "avg": 12.61, "max": 11.52, "min": 13.81, "cnt": 32}, "MoE_L2_bwd":{"total": 450.10, "avg": 14.07, "max": 12.70, "min": 14.91, "cnt": 32}, "MoE_L1_bwd":{"total": 370.97, "avg": 11.59, "max": 10.98, "min": 12.10, "cnt": 32}, "MoE_L0_bwd":{"total": 367.91, "avg": 11.50, "max": 11.10, "min": 12.55, "cnt": 32}, "backward-send-forward-recv":{"total": 3637.05, "avg": 121.23, "max": 1.98, "min": 566.00, "cnt": 30}, "backward-send":{"total": 1.66, "avg": 0.83, "max": 0.81, "min": 0.85, "cnt": 2}, "backward-recv":{"total": 73.20, "avg": 73.20, "max": 73.20, "min": 73.20, "cnt": 1}, "backward-params-all-reduce":{"total": 488.47, "avg": 488.47, "max": 488.47, "min": 488.47, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 311.46, "avg": 311.46, "max": 311.46, "min": 311.46, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 267.24, "avg": 267.24, "max": 267.24, "min": 267.24, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.92, "avg": 6.92, "max": 6.92, "min": 6.92, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 49, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 127.41, "avg": 63.70, "max": 3.15, "min": 124.26, "cnt": 2}, "forward-compute":{"total": 1926.83, "avg": 60.21, "max": 50.83, "min": 69.86, "cnt": 32}, "fwd-compute":{"total": 1923.30, "avg": 60.10, "max": 50.76, "min": 69.78, "cnt": 32}, "batch-generator":{"total": 50.07, "avg": 1.56, "max": 0.68, "min": 4.10, "cnt": 32}, "fwd-embedding":{"total": 0.64, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1859.73, "avg": 58.12, "max": 49.76, "min": 67.40, "cnt": 32}, "fwd-layernorm":{"total": 10.01, "avg": 0.08, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 109.96, "avg": 0.86, "max": 0.74, "min": 1.49, "cnt": 128}, "fwd-misc":{"total": 22.16, "avg": 0.17, "max": 0.11, "min": 0.41, "cnt": 128}, "fwd-MLP":{"total": 1695.06, "avg": 13.24, "max": 10.54, "min": 24.45, "cnt": 128}, "MoE_L0_fwd":{"total": 515.16, "avg": 16.10, "max": 10.51, "min": 24.37, "cnt": 32}, "MoEMLP":{"total": 1677.20, "avg": 13.10, "max": 10.44, "min": 24.32, "cnt": 128}, "MoE_L1_fwd":{"total": 392.69, "avg": 12.27, "max": 10.95, "min": 14.30, "cnt": 32}, "MoE_L2_fwd":{"total": 426.12, "avg": 13.32, "max": 12.35, "min": 15.91, "cnt": 32}, "MoE_L3_fwd":{"total": 349.82, "avg": 10.93, "max": 10.48, "min": 12.06, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.63, "avg": 0.02, "max": 0.02, "min": 0.05, "cnt": 32}, "forward-send":{"total": 0.84, "avg": 0.84, "max": 0.84, "min": 0.84, "cnt": 1}, "forward-send-backward-recv":{"total": 260.40, "avg": 8.40, "max": 1.03, "min": 74.37, "cnt": 31}, "backward-compute":{"total": 1792.22, "avg": 56.01, "max": 54.36, "min": 58.01, "cnt": 32}, "MoE_L3_bwd":{"total": 395.73, "avg": 12.37, "max": 11.45, "min": 14.65, "cnt": 32}, "MoE_L2_bwd":{"total": 470.35, "avg": 14.70, "max": 13.94, "min": 15.90, "cnt": 32}, "MoE_L1_bwd":{"total": 364.31, "avg": 11.38, "max": 10.94, "min": 11.77, "cnt": 32}, "MoE_L0_bwd":{"total": 346.47, "avg": 10.83, "max": 10.15, "min": 11.44, "cnt": 32}, "backward-send-forward-recv":{"total": 5788.10, "avg": 192.94, "max": 1.01, "min": 1000.24, "cnt": 30}, "backward-send":{"total": 1.31, "avg": 0.65, "max": 0.61, "min": 0.70, "cnt": 2}, "backward-recv":{"total": 76.36, "avg": 76.36, "max": 76.36, "min": 76.36, "cnt": 1}, "backward-params-all-reduce":{"total": 489.35, "avg": 489.35, "max": 489.35, "min": 489.35, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 298.84, "avg": 298.84, "max": 298.84, "min": 298.84, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 259.01, "avg": 259.01, "max": 259.01, "min": 259.01, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.30, "avg": 3.30, "max": 3.30, "min": 3.30, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.52, "avg": 3.52, "max": 3.52, "min": 3.52, "cnt": 1}}}
{"type":"time", "iteration": 50, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 131.57, "avg": 65.78, "max": 6.56, "min": 125.01, "cnt": 2}, "forward-compute":{"total": 1864.74, "avg": 58.27, "max": 50.02, "min": 67.27, "cnt": 32}, "fwd-compute":{"total": 1861.56, "avg": 58.17, "max": 49.95, "min": 67.10, "cnt": 32}, "batch-generator":{"total": 42.36, "avg": 1.32, "max": 0.70, "min": 4.58, "cnt": 32}, "fwd-embedding":{"total": 0.63, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1806.68, "avg": 56.46, "max": 48.96, "min": 65.28, "cnt": 32}, "fwd-layernorm":{"total": 9.76, "avg": 0.08, "max": 0.05, "min": 0.30, "cnt": 128}, "fwd-attn":{"total": 111.28, "avg": 0.87, "max": 0.74, "min": 2.56, "cnt": 128}, "fwd-misc":{"total": 21.04, "avg": 0.16, "max": 0.11, "min": 0.51, "cnt": 128}, "fwd-MLP":{"total": 1643.09, "avg": 12.84, "max": 10.46, "min": 23.53, "cnt": 128}, "MoE_L0_fwd":{"total": 482.83, "avg": 15.09, "max": 10.49, "min": 23.42, "cnt": 32}, "MoEMLP":{"total": 1625.99, "avg": 12.70, "max": 10.35, "min": 23.37, "cnt": 128}, "MoE_L1_fwd":{"total": 391.27, "avg": 12.23, "max": 11.16, "min": 16.06, "cnt": 32}, "MoE_L2_fwd":{"total": 403.24, "avg": 12.60, "max": 11.53, "min": 13.94, "cnt": 32}, "MoE_L3_fwd":{"total": 354.88, "avg": 11.09, "max": 10.39, "min": 14.40, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 0.98, "avg": 0.98, "max": 0.98, "min": 0.98, "cnt": 1}, "forward-send-backward-recv":{"total": 299.84, "avg": 9.67, "max": 1.00, "min": 85.28, "cnt": 31}, "backward-compute":{"total": 1730.40, "avg": 54.07, "max": 50.71, "min": 57.06, "cnt": 32}, "MoE_L3_bwd":{"total": 380.88, "avg": 11.90, "max": 10.41, "min": 13.14, "cnt": 32}, "MoE_L2_bwd":{"total": 437.76, "avg": 13.68, "max": 12.89, "min": 14.76, "cnt": 32}, "MoE_L1_bwd":{"total": 379.60, "avg": 11.86, "max": 11.11, "min": 14.54, "cnt": 32}, "MoE_L0_bwd":{"total": 318.33, "avg": 9.95, "max": 9.36, "min": 10.50, "cnt": 32}, "backward-send-forward-recv":{"total": 5402.45, "avg": 180.08, "max": 0.97, "min": 1157.49, "cnt": 30}, "backward-send":{"total": 1.06, "avg": 0.53, "max": 0.51, "min": 0.55, "cnt": 2}, "backward-recv":{"total": 609.00, "avg": 609.00, "max": 609.00, "min": 609.00, "cnt": 1}, "backward-params-all-reduce":{"total": 498.41, "avg": 498.41, "max": 498.41, "min": 498.41, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 292.44, "avg": 292.44, "max": 292.44, "min": 292.44, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 252.74, "avg": 252.74, "max": 252.74, "min": 252.74, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.32, "avg": 3.32, "max": 3.32, "min": 3.32, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 51, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.14, "avg": 0.14, "max": 0.14, "min": 0.14, "cnt": 1}, "forward-recv":{"total": 128.14, "avg": 64.07, "max": 2.15, "min": 125.99, "cnt": 2}, "forward-compute":{"total": 1907.29, "avg": 59.60, "max": 52.54, "min": 65.09, "cnt": 32}, "fwd-compute":{"total": 1904.27, "avg": 59.51, "max": 52.46, "min": 64.99, "cnt": 32}, "batch-generator":{"total": 44.55, "avg": 1.39, "max": 0.71, "min": 3.39, "cnt": 32}, "fwd-embedding":{"total": 0.66, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1845.61, "avg": 57.68, "max": 51.08, "min": 63.03, "cnt": 32}, "fwd-layernorm":{"total": 9.92, "avg": 0.08, "max": 0.05, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 111.44, "avg": 0.87, "max": 0.74, "min": 1.67, "cnt": 128}, "fwd-misc":{"total": 21.30, "avg": 0.17, "max": 0.11, "min": 0.38, "cnt": 128}, "fwd-MLP":{"total": 1681.58, "avg": 13.14, "max": 9.73, "min": 20.17, "cnt": 128}, "MoE_L0_fwd":{"total": 491.55, "avg": 15.36, "max": 11.02, "min": 20.06, "cnt": 32}, "MoEMLP":{"total": 1664.25, "avg": 13.00, "max": 9.63, "min": 20.00, "cnt": 128}, "MoE_L1_fwd":{"total": 398.31, "avg": 12.45, "max": 11.08, "min": 15.60, "cnt": 32}, "MoE_L2_fwd":{"total": 446.35, "avg": 13.95, "max": 13.21, "min": 16.60, "cnt": 32}, "MoE_L3_fwd":{"total": 334.50, "avg": 10.45, "max": 9.67, "min": 11.80, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 0.78, "avg": 0.78, "max": 0.78, "min": 0.78, "cnt": 1}, "forward-send-backward-recv":{"total": 1763.61, "avg": 56.89, "max": 0.86, "min": 371.23, "cnt": 31}, "backward-compute":{"total": 1776.13, "avg": 55.50, "max": 51.21, "min": 57.61, "cnt": 32}, "MoE_L3_bwd":{"total": 360.39, "avg": 11.26, "max": 9.67, "min": 13.94, "cnt": 32}, "MoE_L2_bwd":{"total": 504.34, "avg": 15.76, "max": 14.53, "min": 16.54, "cnt": 32}, "MoE_L1_bwd":{"total": 362.21, "avg": 11.32, "max": 10.66, "min": 12.42, "cnt": 32}, "MoE_L0_bwd":{"total": 335.75, "avg": 10.49, "max": 10.02, "min": 11.86, "cnt": 32}, "backward-send-forward-recv":{"total": 3274.41, "avg": 109.15, "max": 0.93, "min": 510.85, "cnt": 30}, "backward-send":{"total": 1.45, "avg": 0.72, "max": 0.71, "min": 0.74, "cnt": 2}, "backward-recv":{"total": 73.22, "avg": 73.22, "max": 73.22, "min": 73.22, "cnt": 1}, "backward-params-all-reduce":{"total": 489.70, "avg": 489.70, "max": 489.70, "min": 489.70, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.06, "avg": 0.06, "max": 0.06, "min": 0.06, "cnt": 1}, "optimizer":{"total": 300.83, "avg": 300.83, "max": 300.83, "min": 300.83, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 260.58, "avg": 260.58, "max": 260.58, "min": 260.58, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.47, "avg": 3.47, "max": 3.47, "min": 3.47, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.53, "avg": 3.53, "max": 3.53, "min": 3.53, "cnt": 1}}}
{"type":"time", "iteration": 52, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.12, "avg": 0.12, "max": 0.12, "min": 0.12, "cnt": 1}, "forward-recv":{"total": 134.45, "avg": 67.23, "max": 1.11, "min": 133.34, "cnt": 2}, "forward-compute":{"total": 1948.43, "avg": 60.89, "max": 53.60, "min": 70.19, "cnt": 32}, "fwd-compute":{"total": 1942.53, "avg": 60.70, "max": 53.51, "min": 70.11, "cnt": 32}, "batch-generator":{"total": 51.96, "avg": 1.62, "max": 0.69, "min": 4.91, "cnt": 32}, "fwd-embedding":{"total": 0.71, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1876.72, "avg": 58.65, "max": 52.15, "min": 67.58, "cnt": 32}, "fwd-layernorm":{"total": 10.80, "avg": 0.08, "max": 0.05, "min": 0.24, "cnt": 128}, "fwd-attn":{"total": 112.85, "avg": 0.88, "max": 0.74, "min": 2.04, "cnt": 128}, "fwd-misc":{"total": 24.04, "avg": 0.19, "max": 0.11, "min": 1.32, "cnt": 128}, "fwd-MLP":{"total": 1705.98, "avg": 13.33, "max": 9.75, "min": 19.47, "cnt": 128}, "MoE_L0_fwd":{"total": 494.71, "avg": 15.46, "max": 11.14, "min": 19.37, "cnt": 32}, "MoEMLP":{"total": 1687.59, "avg": 13.18, "max": 9.64, "min": 19.32, "cnt": 128}, "MoE_L1_fwd":{"total": 413.27, "avg": 12.91, "max": 11.77, "min": 16.27, "cnt": 32}, "MoE_L2_fwd":{"total": 449.87, "avg": 14.06, "max": 13.26, "min": 16.84, "cnt": 32}, "MoE_L3_fwd":{"total": 336.57, "avg": 10.52, "max": 9.68, "min": 15.76, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.19, "avg": 1.19, "max": 1.19, "min": 1.19, "cnt": 1}, "forward-send-backward-recv":{"total": 2153.04, "avg": 69.45, "max": 0.91, "min": 460.25, "cnt": 31}, "backward-compute":{"total": 1831.06, "avg": 57.22, "max": 53.70, "min": 59.71, "cnt": 32}, "MoE_L3_bwd":{"total": 369.77, "avg": 11.56, "max": 10.43, "min": 13.45, "cnt": 32}, "MoE_L2_bwd":{"total": 514.75, "avg": 16.09, "max": 15.16, "min": 17.54, "cnt": 32}, "MoE_L1_bwd":{"total": 402.39, "avg": 12.57, "max": 12.00, "min": 13.94, "cnt": 32}, "MoE_L0_bwd":{"total": 324.09, "avg": 10.13, "max": 9.44, "min": 12.74, "cnt": 32}, "backward-send-forward-recv":{"total": 3045.45, "avg": 101.51, "max": 0.94, "min": 787.06, "cnt": 30}, "backward-send":{"total": 1.91, "avg": 0.96, "max": 0.88, "min": 1.03, "cnt": 2}, "backward-recv":{"total": 68.69, "avg": 68.69, "max": 68.69, "min": 68.69, "cnt": 1}, "backward-params-all-reduce":{"total": 495.66, "avg": 495.66, "max": 495.66, "min": 495.66, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 292.33, "avg": 292.33, "max": 292.33, "min": 292.33, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 252.38, "avg": 252.38, "max": 252.38, "min": 252.38, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.30, "avg": 3.30, "max": 3.30, "min": 3.30, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.50, "avg": 3.50, "max": 3.50, "min": 3.50, "cnt": 1}}}
{"type":"time", "iteration": 53, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 132.94, "avg": 66.47, "max": 1.50, "min": 131.45, "cnt": 2}, "forward-compute":{"total": 1993.22, "avg": 62.29, "max": 54.78, "min": 70.46, "cnt": 32}, "fwd-compute":{"total": 1989.86, "avg": 62.18, "max": 54.68, "min": 70.33, "cnt": 32}, "batch-generator":{"total": 50.87, "avg": 1.59, "max": 0.82, "min": 6.62, "cnt": 32}, "fwd-embedding":{"total": 0.70, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1925.29, "avg": 60.17, "max": 53.37, "min": 68.59, "cnt": 32}, "fwd-layernorm":{"total": 10.93, "avg": 0.09, "max": 0.05, "min": 0.32, "cnt": 128}, "fwd-attn":{"total": 116.40, "avg": 0.91, "max": 0.74, "min": 2.60, "cnt": 128}, "fwd-misc":{"total": 23.09, "avg": 0.18, "max": 0.11, "min": 0.42, "cnt": 128}, "fwd-MLP":{"total": 1751.24, "avg": 13.68, "max": 10.97, "min": 22.47, "cnt": 128}, "MoE_L0_fwd":{"total": 505.60, "avg": 15.80, "max": 10.93, "min": 22.39, "cnt": 32}, "MoEMLP":{"total": 1732.09, "avg": 13.53, "max": 10.87, "min": 22.34, "cnt": 128}, "MoE_L1_fwd":{"total": 424.96, "avg": 13.28, "max": 12.17, "min": 15.68, "cnt": 32}, "MoE_L2_fwd":{"total": 438.34, "avg": 13.70, "max": 12.72, "min": 16.51, "cnt": 32}, "MoE_L3_fwd":{"total": 370.25, "avg": 11.57, "max": 10.91, "min": 12.69, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.62, "avg": 0.02, "max": 0.02, "min": 0.04, "cnt": 32}, "forward-send":{"total": 1.00, "avg": 1.00, "max": 1.00, "min": 1.00, "cnt": 1}, "forward-send-backward-recv":{"total": 926.15, "avg": 29.88, "max": 1.13, "min": 208.66, "cnt": 31}, "backward-compute":{"total": 1885.67, "avg": 58.93, "max": 55.71, "min": 61.20, "cnt": 32}, "MoE_L3_bwd":{"total": 421.17, "avg": 13.16, "max": 11.43, "min": 14.81, "cnt": 32}, "MoE_L2_bwd":{"total": 498.42, "avg": 15.58, "max": 14.64, "min": 16.32, "cnt": 32}, "MoE_L1_bwd":{"total": 438.47, "avg": 13.70, "max": 12.73, "min": 14.58, "cnt": 32}, "MoE_L0_bwd":{"total": 314.66, "avg": 9.83, "max": 9.13, "min": 10.51, "cnt": 32}, "backward-send-forward-recv":{"total": 4280.47, "avg": 142.68, "max": 1.02, "min": 1049.71, "cnt": 30}, "backward-send":{"total": 1.52, "avg": 0.76, "max": 0.49, "min": 1.03, "cnt": 2}, "backward-recv":{"total": 70.73, "avg": 70.73, "max": 70.73, "min": 70.73, "cnt": 1}, "backward-params-all-reduce":{"total": 490.29, "avg": 490.29, "max": 490.29, "min": 490.29, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 293.22, "avg": 293.22, "max": 293.22, "min": 293.22, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 253.13, "avg": 253.13, "max": 253.13, "min": 253.13, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.61, "avg": 3.61, "max": 3.61, "min": 3.61, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 54, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 139.34, "avg": 69.67, "max": 5.92, "min": 133.42, "cnt": 2}, "forward-compute":{"total": 1960.88, "avg": 61.28, "max": 54.89, "min": 70.07, "cnt": 32}, "fwd-compute":{"total": 1957.56, "avg": 61.17, "max": 54.81, "min": 69.99, "cnt": 32}, "batch-generator":{"total": 46.09, "avg": 1.44, "max": 0.66, "min": 3.23, "cnt": 32}, "fwd-embedding":{"total": 0.66, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1898.68, "avg": 59.33, "max": 53.25, "min": 68.44, "cnt": 32}, "fwd-layernorm":{"total": 10.13, "avg": 0.08, "max": 0.05, "min": 0.18, "cnt": 128}, "fwd-attn":{"total": 112.55, "avg": 0.88, "max": 0.74, "min": 1.45, "cnt": 128}, "fwd-misc":{"total": 22.25, "avg": 0.17, "max": 0.11, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1731.79, "avg": 13.53, "max": 10.96, "min": 24.56, "cnt": 128}, "MoE_L0_fwd":{"total": 482.31, "avg": 15.07, "max": 11.41, "min": 24.46, "cnt": 32}, "MoEMLP":{"total": 1713.95, "avg": 13.39, "max": 10.83, "min": 24.39, "cnt": 128}, "MoE_L1_fwd":{"total": 437.23, "avg": 13.66, "max": 12.36, "min": 18.19, "cnt": 32}, "MoE_L2_fwd":{"total": 421.86, "avg": 13.18, "max": 12.37, "min": 17.18, "cnt": 32}, "MoE_L3_fwd":{"total": 379.13, "avg": 11.85, "max": 10.88, "min": 13.26, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.04, "cnt": 32}, "forward-send":{"total": 0.94, "avg": 0.94, "max": 0.94, "min": 0.94, "cnt": 1}, "forward-send-backward-recv":{"total": 176.87, "avg": 5.71, "max": 1.01, "min": 61.62, "cnt": 31}, "backward-compute":{"total": 1853.57, "avg": 57.92, "max": 55.30, "min": 61.83, "cnt": 32}, "MoE_L3_bwd":{"total": 397.94, "avg": 12.44, "max": 10.81, "min": 13.55, "cnt": 32}, "MoE_L2_bwd":{"total": 485.92, "avg": 15.19, "max": 14.28, "min": 18.74, "cnt": 32}, "MoE_L1_bwd":{"total": 459.13, "avg": 14.35, "max": 13.43, "min": 16.13, "cnt": 32}, "MoE_L0_bwd":{"total": 298.86, "avg": 9.34, "max": 8.50, "min": 11.32, "cnt": 32}, "backward-send-forward-recv":{"total": 4685.54, "avg": 156.18, "max": 0.91, "min": 818.23, "cnt": 30}, "backward-send":{"total": 1.66, "avg": 0.83, "max": 0.83, "min": 0.84, "cnt": 2}, "backward-recv":{"total": 71.02, "avg": 71.02, "max": 71.02, "min": 71.02, "cnt": 1}, "backward-params-all-reduce":{"total": 493.90, "avg": 493.90, "max": 493.90, "min": 493.90, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 295.45, "avg": 295.45, "max": 295.45, "min": 295.45, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 255.44, "avg": 255.44, "max": 255.44, "min": 255.44, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 55, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 139.44, "avg": 69.72, "max": 3.71, "min": 135.72, "cnt": 2}, "forward-compute":{"total": 1949.64, "avg": 60.93, "max": 54.22, "min": 71.73, "cnt": 32}, "fwd-compute":{"total": 1946.54, "avg": 60.83, "max": 54.15, "min": 71.66, "cnt": 32}, "batch-generator":{"total": 45.63, "avg": 1.43, "max": 0.70, "min": 2.71, "cnt": 32}, "fwd-embedding":{"total": 0.66, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1888.15, "avg": 59.00, "max": 52.54, "min": 70.33, "cnt": 32}, "fwd-layernorm":{"total": 9.95, "avg": 0.08, "max": 0.05, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 110.96, "avg": 0.87, "max": 0.74, "min": 1.56, "cnt": 128}, "fwd-misc":{"total": 21.55, "avg": 0.17, "max": 0.11, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1724.37, "avg": 13.47, "max": 9.97, "min": 24.54, "cnt": 128}, "MoE_L0_fwd":{"total": 474.26, "avg": 14.82, "max": 10.47, "min": 24.46, "cnt": 32}, "MoEMLP":{"total": 1706.79, "avg": 13.33, "max": 9.86, "min": 24.41, "cnt": 128}, "MoE_L1_fwd":{"total": 451.26, "avg": 14.10, "max": 12.78, "min": 15.79, "cnt": 32}, "MoE_L2_fwd":{"total": 429.40, "avg": 13.42, "max": 12.39, "min": 17.56, "cnt": 32}, "MoE_L3_fwd":{"total": 358.36, "avg": 11.20, "max": 9.90, "min": 13.76, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 0.85, "avg": 0.85, "max": 0.85, "min": 0.85, "cnt": 1}, "forward-send-backward-recv":{"total": 591.64, "avg": 19.09, "max": 1.02, "min": 235.81, "cnt": 31}, "backward-compute":{"total": 1843.40, "avg": 57.61, "max": 54.88, "min": 59.38, "cnt": 32}, "MoE_L3_bwd":{"total": 376.28, "avg": 11.76, "max": 10.74, "min": 14.25, "cnt": 32}, "MoE_L2_bwd":{"total": 479.01, "avg": 14.97, "max": 14.05, "min": 16.15, "cnt": 32}, "MoE_L1_bwd":{"total": 477.44, "avg": 14.92, "max": 14.00, "min": 15.55, "cnt": 32}, "MoE_L0_bwd":{"total": 295.13, "avg": 9.22, "max": 8.56, "min": 11.07, "cnt": 32}, "backward-send-forward-recv":{"total": 3498.78, "avg": 116.63, "max": 0.97, "min": 450.76, "cnt": 30}, "backward-send":{"total": 1.42, "avg": 0.71, "max": 0.47, "min": 0.95, "cnt": 2}, "backward-recv":{"total": 318.07, "avg": 318.07, "max": 318.07, "min": 318.07, "cnt": 1}, "backward-params-all-reduce":{"total": 488.12, "avg": 488.12, "max": 488.12, "min": 488.12, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.04, "avg": 0.04, "max": 0.04, "min": 0.04, "cnt": 1}, "optimizer":{"total": 304.11, "avg": 304.11, "max": 304.11, "min": 304.11, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 264.14, "avg": 264.14, "max": 264.14, "min": 264.14, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.36, "avg": 3.36, "max": 3.36, "min": 3.36, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.48, "avg": 3.48, "max": 3.48, "min": 3.48, "cnt": 1}}}
{"type":"time", "iteration": 56, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 136.39, "avg": 68.20, "max": 0.86, "min": 135.53, "cnt": 2}, "forward-compute":{"total": 1920.82, "avg": 60.03, "max": 54.53, "min": 65.42, "cnt": 32}, "fwd-compute":{"total": 1917.63, "avg": 59.93, "max": 54.45, "min": 65.33, "cnt": 32}, "batch-generator":{"total": 44.01, "avg": 1.38, "max": 0.68, "min": 4.32, "cnt": 32}, "fwd-embedding":{"total": 0.62, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1861.38, "avg": 58.17, "max": 53.19, "min": 64.26, "cnt": 32}, "fwd-layernorm":{"total": 9.79, "avg": 0.08, "max": 0.05, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 107.02, "avg": 0.84, "max": 0.74, "min": 1.54, "cnt": 128}, "fwd-misc":{"total": 20.85, "avg": 0.16, "max": 0.11, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1702.92, "avg": 13.30, "max": 10.04, "min": 20.51, "cnt": 128}, "MoE_L0_fwd":{"total": 480.88, "avg": 15.03, "max": 10.91, "min": 20.42, "cnt": 32}, "MoEMLP":{"total": 1685.97, "avg": 13.17, "max": 9.93, "min": 20.37, "cnt": 128}, "MoE_L1_fwd":{"total": 454.92, "avg": 14.22, "max": 13.00, "min": 15.64, "cnt": 32}, "MoE_L2_fwd":{"total": 413.95, "avg": 12.94, "max": 11.92, "min": 17.81, "cnt": 32}, "MoE_L3_fwd":{"total": 342.52, "avg": 10.70, "max": 9.97, "min": 12.49, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 0.99, "avg": 0.99, "max": 0.99, "min": 0.99, "cnt": 1}, "forward-send-backward-recv":{"total": 2709.38, "avg": 87.40, "max": 0.98, "min": 561.40, "cnt": 31}, "backward-compute":{"total": 1899.33, "avg": 59.35, "max": 53.84, "min": 136.03, "cnt": 32}, "MoE_L3_bwd":{"total": 375.83, "avg": 11.74, "max": 10.64, "min": 14.09, "cnt": 32}, "MoE_L2_bwd":{"total": 447.42, "avg": 13.98, "max": 12.80, "min": 15.42, "cnt": 32}, "MoE_L1_bwd":{"total": 470.45, "avg": 14.70, "max": 13.86, "min": 16.52, "cnt": 32}, "MoE_L0_bwd":{"total": 386.32, "avg": 12.07, "max": 8.95, "min": 88.53, "cnt": 32}, "backward-send-forward-recv":{"total": 1732.65, "avg": 57.75, "max": 0.91, "min": 340.23, "cnt": 30}, "backward-send":{"total": 1.95, "avg": 0.97, "max": 0.85, "min": 1.09, "cnt": 2}, "backward-recv":{"total": 306.60, "avg": 306.60, "max": 306.60, "min": 306.60, "cnt": 1}, "backward-params-all-reduce":{"total": 490.37, "avg": 490.37, "max": 490.37, "min": 490.37, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 299.13, "avg": 299.13, "max": 299.13, "min": 299.13, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 259.30, "avg": 259.30, "max": 259.30, "min": 259.30, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.35, "avg": 3.35, "max": 3.35, "min": 3.35, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.47, "avg": 3.47, "max": 3.47, "min": 3.47, "cnt": 1}}}
{"type":"time", "iteration": 57, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 140.73, "avg": 70.36, "max": 0.82, "min": 139.91, "cnt": 2}, "forward-compute":{"total": 1888.58, "avg": 59.02, "max": 51.59, "min": 64.18, "cnt": 32}, "fwd-compute":{"total": 1885.54, "avg": 58.92, "max": 51.52, "min": 64.11, "cnt": 32}, "batch-generator":{"total": 44.05, "avg": 1.38, "max": 0.71, "min": 2.81, "cnt": 32}, "fwd-embedding":{"total": 0.62, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1828.83, "avg": 57.15, "max": 50.47, "min": 62.03, "cnt": 32}, "fwd-layernorm":{"total": 9.56, "avg": 0.07, "max": 0.05, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 107.69, "avg": 0.84, "max": 0.74, "min": 1.65, "cnt": 128}, "fwd-misc":{"total": 20.83, "avg": 0.16, "max": 0.11, "min": 0.34, "cnt": 128}, "fwd-MLP":{"total": 1670.27, "avg": 13.05, "max": 10.06, "min": 20.71, "cnt": 128}, "MoE_L0_fwd":{"total": 480.20, "avg": 15.01, "max": 10.37, "min": 20.63, "cnt": 32}, "MoEMLP":{"total": 1653.47, "avg": 12.92, "max": 9.95, "min": 20.59, "cnt": 128}, "MoE_L1_fwd":{"total": 440.11, "avg": 13.75, "max": 12.16, "min": 15.08, "cnt": 32}, "MoE_L2_fwd":{"total": 394.80, "avg": 12.34, "max": 11.85, "min": 13.08, "cnt": 32}, "MoE_L3_fwd":{"total": 344.64, "avg": 10.77, "max": 9.99, "min": 11.90, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.56, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 0.83, "avg": 0.83, "max": 0.83, "min": 0.83, "cnt": 1}, "forward-send-backward-recv":{"total": 1068.53, "avg": 34.47, "max": 1.10, "min": 378.31, "cnt": 31}, "backward-compute":{"total": 1762.42, "avg": 55.08, "max": 53.25, "min": 57.97, "cnt": 32}, "MoE_L3_bwd":{"total": 368.55, "avg": 11.52, "max": 10.20, "min": 13.03, "cnt": 32}, "MoE_L2_bwd":{"total": 421.22, "avg": 13.16, "max": 12.48, "min": 14.00, "cnt": 32}, "MoE_L1_bwd":{"total": 443.61, "avg": 13.86, "max": 13.32, "min": 14.31, "cnt": 32}, "MoE_L0_bwd":{"total": 311.76, "avg": 9.74, "max": 9.21, "min": 10.99, "cnt": 32}, "backward-send-forward-recv":{"total": 4637.88, "avg": 154.60, "max": 1.42, "min": 562.79, "cnt": 30}, "backward-send":{"total": 1.78, "avg": 0.89, "max": 0.69, "min": 1.09, "cnt": 2}, "backward-recv":{"total": 83.01, "avg": 83.01, "max": 83.01, "min": 83.01, "cnt": 1}, "backward-params-all-reduce":{"total": 492.62, "avg": 492.62, "max": 492.62, "min": 492.62, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 293.91, "avg": 293.91, "max": 293.91, "min": 293.91, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 253.92, "avg": 253.92, "max": 253.92, "min": 253.92, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.51, "avg": 3.51, "max": 3.51, "min": 3.51, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 58, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.12, "avg": 0.12, "max": 0.12, "min": 0.12, "cnt": 1}, "forward-recv":{"total": 138.34, "avg": 69.17, "max": 6.47, "min": 131.87, "cnt": 2}, "forward-compute":{"total": 1942.75, "avg": 60.71, "max": 53.02, "min": 69.06, "cnt": 32}, "fwd-compute":{"total": 1939.52, "avg": 60.61, "max": 52.94, "min": 68.99, "cnt": 32}, "batch-generator":{"total": 60.36, "avg": 1.89, "max": 0.71, "min": 3.47, "cnt": 32}, "fwd-embedding":{"total": 0.72, "avg": 0.02, "max": 0.01, "min": 0.06, "cnt": 32}, "fwd-encoder":{"total": 1866.71, "avg": 58.33, "max": 51.87, "min": 65.98, "cnt": 32}, "fwd-layernorm":{"total": 10.02, "avg": 0.08, "max": 0.05, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 110.95, "avg": 0.87, "max": 0.74, "min": 1.73, "cnt": 128}, "fwd-misc":{"total": 21.53, "avg": 0.17, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1702.98, "avg": 13.30, "max": 9.95, "min": 20.18, "cnt": 128}, "MoE_L0_fwd":{"total": 486.14, "avg": 15.19, "max": 12.11, "min": 20.03, "cnt": 32}, "MoEMLP":{"total": 1685.68, "avg": 13.17, "max": 9.84, "min": 19.95, "cnt": 128}, "MoE_L1_fwd":{"total": 458.98, "avg": 14.34, "max": 13.00, "min": 17.29, "cnt": 32}, "MoE_L2_fwd":{"total": 383.65, "avg": 11.99, "max": 11.29, "min": 14.65, "cnt": 32}, "MoE_L3_fwd":{"total": 363.48, "avg": 11.36, "max": 9.88, "min": 16.27, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 0.83, "avg": 0.83, "max": 0.83, "min": 0.83, "cnt": 1}, "forward-send-backward-recv":{"total": 319.82, "avg": 10.32, "max": 0.97, "min": 87.05, "cnt": 31}, "backward-compute":{"total": 1776.29, "avg": 55.51, "max": 52.28, "min": 57.90, "cnt": 32}, "MoE_L3_bwd":{"total": 382.66, "avg": 11.96, "max": 10.30, "min": 14.34, "cnt": 32}, "MoE_L2_bwd":{"total": 394.62, "avg": 12.33, "max": 11.52, "min": 13.29, "cnt": 32}, "MoE_L1_bwd":{"total": 473.93, "avg": 14.81, "max": 14.23, "min": 15.52, "cnt": 32}, "MoE_L0_bwd":{"total": 310.27, "avg": 9.70, "max": 9.23, "min": 10.24, "cnt": 32}, "backward-send-forward-recv":{"total": 3911.90, "avg": 130.40, "max": 1.06, "min": 589.01, "cnt": 30}, "backward-send":{"total": 1.28, "avg": 0.64, "max": 0.58, "min": 0.71, "cnt": 2}, "backward-recv":{"total": 78.38, "avg": 78.38, "max": 78.38, "min": 78.38, "cnt": 1}, "backward-params-all-reduce":{"total": 494.43, "avg": 494.43, "max": 494.43, "min": 494.43, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.06, "avg": 0.06, "max": 0.06, "min": 0.06, "cnt": 1}, "optimizer":{"total": 296.82, "avg": 296.82, "max": 296.82, "min": 296.82, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.40, "avg": 3.40, "max": 3.40, "min": 3.40, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 256.87, "avg": 256.87, "max": 256.87, "min": 256.87, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.34, "avg": 3.34, "max": 3.34, "min": 3.34, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 59, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 131.51, "avg": 65.76, "max": 0.77, "min": 130.74, "cnt": 2}, "forward-compute":{"total": 1912.84, "avg": 59.78, "max": 53.35, "min": 65.02, "cnt": 32}, "fwd-compute":{"total": 1909.61, "avg": 59.68, "max": 53.25, "min": 64.84, "cnt": 32}, "batch-generator":{"total": 40.16, "avg": 1.25, "max": 0.75, "min": 2.30, "cnt": 32}, "fwd-embedding":{"total": 0.63, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1856.40, "avg": 58.01, "max": 51.98, "min": 62.43, "cnt": 32}, "fwd-layernorm":{"total": 9.73, "avg": 0.08, "max": 0.05, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 109.48, "avg": 0.86, "max": 0.75, "min": 1.89, "cnt": 128}, "fwd-misc":{"total": 21.59, "avg": 0.17, "max": 0.11, "min": 0.45, "cnt": 128}, "fwd-MLP":{"total": 1694.40, "avg": 13.24, "max": 10.43, "min": 18.60, "cnt": 128}, "MoE_L0_fwd":{"total": 488.27, "avg": 15.26, "max": 11.82, "min": 18.52, "cnt": 32}, "MoEMLP":{"total": 1677.12, "avg": 13.10, "max": 10.32, "min": 18.46, "cnt": 128}, "MoE_L1_fwd":{"total": 451.16, "avg": 14.10, "max": 12.93, "min": 17.52, "cnt": 32}, "MoE_L2_fwd":{"total": 356.14, "avg": 11.13, "max": 10.36, "min": 14.33, "cnt": 32}, "MoE_L3_fwd":{"total": 388.00, "avg": 12.13, "max": 11.55, "min": 14.97, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.61, "avg": 0.02, "max": 0.02, "min": 0.04, "cnt": 32}, "forward-send":{"total": 0.83, "avg": 0.83, "max": 0.83, "min": 0.83, "cnt": 1}, "forward-send-backward-recv":{"total": 2497.24, "avg": 80.56, "max": 0.93, "min": 418.83, "cnt": 31}, "backward-compute":{"total": 1758.02, "avg": 54.94, "max": 52.75, "min": 58.01, "cnt": 32}, "MoE_L3_bwd":{"total": 419.47, "avg": 13.11, "max": 11.99, "min": 14.97, "cnt": 32}, "MoE_L2_bwd":{"total": 334.38, "avg": 10.45, "max": 9.78, "min": 11.70, "cnt": 32}, "MoE_L1_bwd":{"total": 467.28, "avg": 14.60, "max": 14.01, "min": 15.40, "cnt": 32}, "MoE_L0_bwd":{"total": 319.11, "avg": 9.97, "max": 9.26, "min": 10.53, "cnt": 32}, "backward-send-forward-recv":{"total": 2715.73, "avg": 90.52, "max": 0.95, "min": 426.25, "cnt": 30}, "backward-send":{"total": 1.40, "avg": 0.70, "max": 0.68, "min": 0.71, "cnt": 2}, "backward-recv":{"total": 78.46, "avg": 78.46, "max": 78.46, "min": 78.46, "cnt": 1}, "backward-params-all-reduce":{"total": 490.90, "avg": 490.90, "max": 490.90, "min": 490.90, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 295.73, "avg": 295.73, "max": 295.73, "min": 295.73, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.40, "avg": 3.40, "max": 3.40, "min": 3.40, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 255.79, "avg": 255.79, "max": 255.79, "min": 255.79, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.41, "avg": 3.41, "max": 3.41, "min": 3.41, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.51, "avg": 3.51, "max": 3.51, "min": 3.51, "cnt": 1}}}
{"type":"time", "iteration": 60, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 130.51, "avg": 65.25, "max": 1.11, "min": 129.39, "cnt": 2}, "forward-compute":{"total": 1895.17, "avg": 59.22, "max": 53.57, "min": 64.67, "cnt": 32}, "fwd-compute":{"total": 1891.57, "avg": 59.11, "max": 53.50, "min": 64.29, "cnt": 32}, "batch-generator":{"total": 50.11, "avg": 1.57, "max": 0.72, "min": 4.48, "cnt": 32}, "fwd-embedding":{"total": 0.72, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1827.58, "avg": 57.11, "max": 52.39, "min": 62.16, "cnt": 32}, "fwd-layernorm":{"total": 10.35, "avg": 0.08, "max": 0.05, "min": 0.27, "cnt": 128}, "fwd-attn":{"total": 113.08, "avg": 0.88, "max": 0.74, "min": 2.96, "cnt": 128}, "fwd-misc":{"total": 21.96, "avg": 0.17, "max": 0.11, "min": 0.51, "cnt": 128}, "fwd-MLP":{"total": 1659.99, "avg": 12.97, "max": 10.76, "min": 20.31, "cnt": 128}, "MoE_L0_fwd":{"total": 463.70, "avg": 14.49, "max": 10.96, "min": 20.14, "cnt": 32}, "MoEMLP":{"total": 1642.33, "avg": 12.83, "max": 10.64, "min": 20.04, "cnt": 128}, "MoE_L1_fwd":{"total": 421.39, "avg": 13.17, "max": 12.37, "min": 15.35, "cnt": 32}, "MoE_L2_fwd":{"total": 358.07, "avg": 11.19, "max": 10.68, "min": 14.63, "cnt": 32}, "MoE_L3_fwd":{"total": 405.83, "avg": 12.68, "max": 11.92, "min": 15.13, "cnt": 32}, "fwd-pooler":{"total": 0.38, "avg": 0.01, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-loss-func":{"total": 0.63, "avg": 0.02, "max": 0.02, "min": 0.06, "cnt": 32}, "forward-send":{"total": 0.85, "avg": 0.85, "max": 0.85, "min": 0.85, "cnt": 1}, "forward-send-backward-recv":{"total": 584.51, "avg": 18.86, "max": 0.91, "min": 193.30, "cnt": 31}, "backward-compute":{"total": 1761.84, "avg": 55.06, "max": 51.32, "min": 60.52, "cnt": 32}, "MoE_L3_bwd":{"total": 435.56, "avg": 13.61, "max": 12.33, "min": 14.72, "cnt": 32}, "MoE_L2_bwd":{"total": 349.78, "avg": 10.93, "max": 10.32, "min": 11.72, "cnt": 32}, "MoE_L1_bwd":{"total": 439.72, "avg": 13.74, "max": 12.67, "min": 16.77, "cnt": 32}, "MoE_L0_bwd":{"total": 323.47, "avg": 10.11, "max": 9.49, "min": 11.35, "cnt": 32}, "backward-send-forward-recv":{"total": 4453.44, "avg": 148.45, "max": 2.13, "min": 876.03, "cnt": 30}, "backward-send":{"total": 1.51, "avg": 0.75, "max": 0.53, "min": 0.98, "cnt": 2}, "backward-recv":{"total": 71.99, "avg": 71.99, "max": 71.99, "min": 71.99, "cnt": 1}, "backward-params-all-reduce":{"total": 489.64, "avg": 489.64, "max": 489.64, "min": 489.64, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 299.13, "avg": 299.13, "max": 299.13, "min": 299.13, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 259.26, "avg": 259.26, "max": 259.26, "min": 259.26, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.36, "avg": 3.36, "max": 3.36, "min": 3.36, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.47, "avg": 3.47, "max": 3.47, "min": 3.47, "cnt": 1}}}
{"type":"time", "iteration": 61, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 130.28, "avg": 65.14, "max": 0.77, "min": 129.51, "cnt": 2}, "forward-compute":{"total": 1898.52, "avg": 59.33, "max": 53.67, "min": 67.28, "cnt": 32}, "fwd-compute":{"total": 1895.30, "avg": 59.23, "max": 53.60, "min": 67.20, "cnt": 32}, "batch-generator":{"total": 41.61, "avg": 1.30, "max": 0.75, "min": 2.55, "cnt": 32}, "fwd-embedding":{"total": 0.60, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1840.90, "avg": 57.53, "max": 52.47, "min": 66.01, "cnt": 32}, "fwd-layernorm":{"total": 9.85, "avg": 0.08, "max": 0.05, "min": 0.23, "cnt": 128}, "fwd-attn":{"total": 110.02, "avg": 0.86, "max": 0.74, "min": 1.98, "cnt": 128}, "fwd-misc":{"total": 21.65, "avg": 0.17, "max": 0.11, "min": 0.49, "cnt": 128}, "fwd-MLP":{"total": 1677.96, "avg": 13.11, "max": 11.08, "min": 18.95, "cnt": 128}, "MoE_L0_fwd":{"total": 473.22, "avg": 14.79, "max": 11.38, "min": 18.87, "cnt": 32}, "MoEMLP":{"total": 1660.38, "avg": 12.97, "max": 10.93, "min": 18.82, "cnt": 128}, "MoE_L1_fwd":{"total": 409.23, "avg": 12.79, "max": 11.98, "min": 15.18, "cnt": 32}, "MoE_L2_fwd":{"total": 391.00, "avg": 12.22, "max": 11.50, "min": 16.22, "cnt": 32}, "MoE_L3_fwd":{"total": 393.38, "avg": 12.29, "max": 10.99, "min": 17.50, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.29, "avg": 1.29, "max": 1.29, "min": 1.29, "cnt": 1}, "forward-send-backward-recv":{"total": 2089.97, "avg": 67.42, "max": 0.96, "min": 323.55, "cnt": 31}, "backward-compute":{"total": 1774.68, "avg": 55.46, "max": 51.56, "min": 58.22, "cnt": 32}, "MoE_L3_bwd":{"total": 429.79, "avg": 13.43, "max": 11.74, "min": 16.38, "cnt": 32}, "MoE_L2_bwd":{"total": 393.71, "avg": 12.30, "max": 11.18, "min": 14.10, "cnt": 32}, "MoE_L1_bwd":{"total": 409.86, "avg": 12.81, "max": 12.39, "min": 13.58, "cnt": 32}, "MoE_L0_bwd":{"total": 327.75, "avg": 10.24, "max": 9.57, "min": 11.09, "cnt": 32}, "backward-send-forward-recv":{"total": 3080.18, "avg": 102.67, "max": 1.63, "min": 979.52, "cnt": 30}, "backward-send":{"total": 1.64, "avg": 0.82, "max": 0.77, "min": 0.87, "cnt": 2}, "backward-recv":{"total": 592.63, "avg": 592.63, "max": 592.63, "min": 592.63, "cnt": 1}, "backward-params-all-reduce":{"total": 485.90, "avg": 485.90, "max": 485.90, "min": 485.90, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 304.78, "avg": 304.78, "max": 304.78, "min": 304.78, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 264.68, "avg": 264.68, "max": 264.68, "min": 264.68, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.52, "avg": 3.52, "max": 3.52, "min": 3.52, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 62, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.10, "avg": 0.10, "max": 0.10, "min": 0.10, "cnt": 1}, "forward-recv":{"total": 121.72, "avg": 60.86, "max": 1.14, "min": 120.58, "cnt": 2}, "forward-compute":{"total": 1919.38, "avg": 59.98, "max": 53.73, "min": 64.65, "cnt": 32}, "fwd-compute":{"total": 1916.05, "avg": 59.88, "max": 53.66, "min": 64.51, "cnt": 32}, "batch-generator":{"total": 50.53, "avg": 1.58, "max": 0.73, "min": 3.31, "cnt": 32}, "fwd-embedding":{"total": 0.70, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1852.68, "avg": 57.90, "max": 52.62, "min": 63.19, "cnt": 32}, "fwd-layernorm":{"total": 10.37, "avg": 0.08, "max": 0.05, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 112.32, "avg": 0.88, "max": 0.74, "min": 1.89, "cnt": 128}, "fwd-misc":{"total": 22.21, "avg": 0.17, "max": 0.11, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1685.96, "avg": 13.17, "max": 11.20, "min": 21.50, "cnt": 128}, "MoE_L0_fwd":{"total": 498.50, "avg": 15.58, "max": 11.85, "min": 21.36, "cnt": 32}, "MoEMLP":{"total": 1668.37, "avg": 13.03, "max": 11.07, "min": 21.28, "cnt": 128}, "MoE_L1_fwd":{"total": 403.53, "avg": 12.61, "max": 11.64, "min": 14.12, "cnt": 32}, "MoE_L2_fwd":{"total": 393.96, "avg": 12.31, "max": 11.87, "min": 13.96, "cnt": 32}, "MoE_L3_fwd":{"total": 378.95, "avg": 11.84, "max": 11.12, "min": 14.82, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 0.88, "avg": 0.88, "max": 0.88, "min": 0.88, "cnt": 1}, "forward-send-backward-recv":{"total": 1580.62, "avg": 50.99, "max": 1.59, "min": 295.49, "cnt": 31}, "backward-compute":{"total": 1780.57, "avg": 55.64, "max": 52.91, "min": 59.25, "cnt": 32}, "MoE_L3_bwd":{"total": 412.24, "avg": 12.88, "max": 11.49, "min": 16.57, "cnt": 32}, "MoE_L2_bwd":{"total": 414.87, "avg": 12.96, "max": 12.08, "min": 15.01, "cnt": 32}, "MoE_L1_bwd":{"total": 398.38, "avg": 12.45, "max": 12.03, "min": 12.97, "cnt": 32}, "MoE_L0_bwd":{"total": 329.71, "avg": 10.30, "max": 9.94, "min": 13.04, "cnt": 32}, "backward-send-forward-recv":{"total": 5358.18, "avg": 178.61, "max": 1.55, "min": 1125.18, "cnt": 30}, "backward-send":{"total": 1.74, "avg": 0.87, "max": 0.87, "min": 0.88, "cnt": 2}, "backward-recv":{"total": 75.34, "avg": 75.34, "max": 75.34, "min": 75.34, "cnt": 1}, "backward-params-all-reduce":{"total": 490.28, "avg": 490.28, "max": 490.28, "min": 490.28, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 295.84, "avg": 295.84, "max": 295.84, "min": 295.84, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 255.71, "avg": 255.71, "max": 255.71, "min": 255.71, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.50, "avg": 3.50, "max": 3.50, "min": 3.50, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.54, "avg": 3.54, "max": 3.54, "min": 3.54, "cnt": 1}}}
{"type":"time", "iteration": 63, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.22, "avg": 0.22, "max": 0.22, "min": 0.22, "cnt": 1}, "forward-recv":{"total": 127.16, "avg": 63.58, "max": 6.41, "min": 120.75, "cnt": 2}, "forward-compute":{"total": 1948.43, "avg": 60.89, "max": 54.21, "min": 68.10, "cnt": 32}, "fwd-compute":{"total": 1945.11, "avg": 60.78, "max": 54.14, "min": 68.03, "cnt": 32}, "batch-generator":{"total": 44.33, "avg": 1.39, "max": 0.65, "min": 2.45, "cnt": 32}, "fwd-embedding":{"total": 0.66, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1886.58, "avg": 58.96, "max": 53.18, "min": 65.12, "cnt": 32}, "fwd-layernorm":{"total": 10.58, "avg": 0.08, "max": 0.05, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 116.12, "avg": 0.91, "max": 0.74, "min": 3.82, "cnt": 128}, "fwd-misc":{"total": 22.40, "avg": 0.17, "max": 0.11, "min": 0.42, "cnt": 128}, "fwd-MLP":{"total": 1714.47, "avg": 13.39, "max": 10.98, "min": 18.55, "cnt": 128}, "MoE_L0_fwd":{"total": 489.80, "avg": 15.31, "max": 11.52, "min": 18.43, "cnt": 32}, "MoEMLP":{"total": 1695.85, "avg": 13.25, "max": 10.77, "min": 18.39, "cnt": 128}, "MoE_L1_fwd":{"total": 410.15, "avg": 12.82, "max": 11.69, "min": 14.89, "cnt": 32}, "MoE_L2_fwd":{"total": 403.46, "avg": 12.61, "max": 12.01, "min": 14.88, "cnt": 32}, "MoE_L3_fwd":{"total": 399.19, "avg": 12.47, "max": 10.82, "min": 17.46, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 0.89, "avg": 0.89, "max": 0.89, "min": 0.89, "cnt": 1}, "forward-send-backward-recv":{"total": 217.79, "avg": 7.03, "max": 0.86, "min": 74.01, "cnt": 31}, "backward-compute":{"total": 1802.05, "avg": 56.31, "max": 53.46, "min": 59.62, "cnt": 32}, "MoE_L3_bwd":{"total": 432.72, "avg": 13.52, "max": 11.73, "min": 15.40, "cnt": 32}, "MoE_L2_bwd":{"total": 415.42, "avg": 12.98, "max": 11.98, "min": 14.57, "cnt": 32}, "MoE_L1_bwd":{"total": 403.54, "avg": 12.61, "max": 12.04, "min": 13.28, "cnt": 32}, "MoE_L0_bwd":{"total": 332.98, "avg": 10.41, "max": 9.91, "min": 13.55, "cnt": 32}, "backward-send-forward-recv":{"total": 3254.31, "avg": 108.48, "max": 1.75, "min": 398.59, "cnt": 30}, "backward-send":{"total": 1.20, "avg": 0.60, "max": 0.47, "min": 0.73, "cnt": 2}, "backward-recv":{"total": 71.26, "avg": 71.26, "max": 71.26, "min": 71.26, "cnt": 1}, "backward-params-all-reduce":{"total": 491.22, "avg": 491.22, "max": 491.22, "min": 491.22, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 295.97, "avg": 295.97, "max": 295.97, "min": 295.97, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 255.37, "avg": 255.37, "max": 255.37, "min": 255.37, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 4.43, "avg": 4.43, "max": 4.43, "min": 4.43, "cnt": 1}}}
{"type":"time", "iteration": 64, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 127.57, "avg": 63.78, "max": 1.16, "min": 126.41, "cnt": 2}, "forward-compute":{"total": 1921.65, "avg": 60.05, "max": 54.40, "min": 69.27, "cnt": 32}, "fwd-compute":{"total": 1918.46, "avg": 59.95, "max": 54.32, "min": 69.20, "cnt": 32}, "batch-generator":{"total": 44.93, "avg": 1.40, "max": 0.71, "min": 2.23, "cnt": 32}, "fwd-embedding":{"total": 0.59, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1860.54, "avg": 58.14, "max": 51.99, "min": 68.17, "cnt": 32}, "fwd-layernorm":{"total": 9.87, "avg": 0.08, "max": 0.05, "min": 0.22, "cnt": 128}, "fwd-attn":{"total": 111.09, "avg": 0.87, "max": 0.75, "min": 1.84, "cnt": 128}, "fwd-misc":{"total": 21.26, "avg": 0.17, "max": 0.11, "min": 0.44, "cnt": 128}, "fwd-MLP":{"total": 1696.73, "avg": 13.26, "max": 11.12, "min": 20.98, "cnt": 128}, "MoE_L0_fwd":{"total": 480.66, "avg": 15.02, "max": 11.25, "min": 20.90, "cnt": 32}, "MoEMLP":{"total": 1679.33, "avg": 13.12, "max": 11.02, "min": 20.85, "cnt": 128}, "MoE_L1_fwd":{"total": 400.88, "avg": 12.53, "max": 11.48, "min": 15.47, "cnt": 32}, "MoE_L2_fwd":{"total": 412.19, "avg": 12.88, "max": 11.85, "min": 15.96, "cnt": 32}, "MoE_L3_fwd":{"total": 392.09, "avg": 12.25, "max": 11.06, "min": 14.17, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.06, "avg": 1.06, "max": 1.06, "min": 1.06, "cnt": 1}, "forward-send-backward-recv":{"total": 131.01, "avg": 4.23, "max": 0.88, "min": 56.56, "cnt": 31}, "backward-compute":{"total": 1822.31, "avg": 56.95, "max": 54.34, "min": 60.37, "cnt": 32}, "MoE_L3_bwd":{"total": 441.49, "avg": 13.80, "max": 11.57, "min": 15.78, "cnt": 32}, "MoE_L2_bwd":{"total": 434.71, "avg": 13.58, "max": 12.43, "min": 15.04, "cnt": 32}, "MoE_L1_bwd":{"total": 397.47, "avg": 12.42, "max": 11.56, "min": 14.28, "cnt": 32}, "MoE_L0_bwd":{"total": 335.79, "avg": 10.49, "max": 9.88, "min": 14.79, "cnt": 32}, "backward-send-forward-recv":{"total": 4067.85, "avg": 135.59, "max": 1.42, "min": 475.94, "cnt": 30}, "backward-send":{"total": 1.64, "avg": 0.82, "max": 0.77, "min": 0.88, "cnt": 2}, "backward-recv":{"total": 68.97, "avg": 68.97, "max": 68.97, "min": 68.97, "cnt": 1}, "backward-params-all-reduce":{"total": 485.21, "avg": 485.21, "max": 485.21, "min": 485.21, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 300.81, "avg": 300.81, "max": 300.81, "min": 300.81, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 259.78, "avg": 259.78, "max": 259.78, "min": 259.78, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.52, "avg": 3.52, "max": 3.52, "min": 3.52, "cnt": 1}}}
{"type":"time", "iteration": 65, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.14, "avg": 0.14, "max": 0.14, "min": 0.14, "cnt": 1}, "forward-recv":{"total": 142.12, "avg": 71.06, "max": 0.66, "min": 141.46, "cnt": 2}, "forward-compute":{"total": 1872.85, "avg": 58.53, "max": 54.65, "min": 66.72, "cnt": 32}, "fwd-compute":{"total": 1869.63, "avg": 58.43, "max": 54.57, "min": 66.54, "cnt": 32}, "batch-generator":{"total": 41.91, "avg": 1.31, "max": 0.65, "min": 4.09, "cnt": 32}, "fwd-embedding":{"total": 0.61, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1815.06, "avg": 56.72, "max": 52.92, "min": 61.82, "cnt": 32}, "fwd-layernorm":{"total": 9.75, "avg": 0.08, "max": 0.05, "min": 0.31, "cnt": 128}, "fwd-attn":{"total": 112.36, "avg": 0.88, "max": 0.74, "min": 3.88, "cnt": 128}, "fwd-misc":{"total": 21.05, "avg": 0.16, "max": 0.11, "min": 0.48, "cnt": 128}, "fwd-MLP":{"total": 1651.21, "avg": 12.90, "max": 11.21, "min": 17.87, "cnt": 128}, "MoE_L0_fwd":{"total": 478.68, "avg": 14.96, "max": 11.94, "min": 17.79, "cnt": 32}, "MoEMLP":{"total": 1634.27, "avg": 12.77, "max": 11.10, "min": 17.74, "cnt": 128}, "MoE_L1_fwd":{"total": 397.82, "avg": 12.43, "max": 11.28, "min": 13.82, "cnt": 32}, "MoE_L2_fwd":{"total": 388.65, "avg": 12.15, "max": 11.83, "min": 12.73, "cnt": 32}, "MoE_L3_fwd":{"total": 375.34, "avg": 11.73, "max": 11.15, "min": 12.85, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.61, "avg": 0.02, "max": 0.02, "min": 0.04, "cnt": 32}, "forward-send":{"total": 0.64, "avg": 0.64, "max": 0.64, "min": 0.64, "cnt": 1}, "forward-send-backward-recv":{"total": 917.01, "avg": 29.58, "max": 0.97, "min": 293.66, "cnt": 31}, "backward-compute":{"total": 1774.07, "avg": 55.44, "max": 50.62, "min": 58.40, "cnt": 32}, "MoE_L3_bwd":{"total": 427.65, "avg": 13.36, "max": 11.41, "min": 16.12, "cnt": 32}, "MoE_L2_bwd":{"total": 411.38, "avg": 12.86, "max": 11.66, "min": 13.62, "cnt": 32}, "MoE_L1_bwd":{"total": 390.95, "avg": 12.22, "max": 11.57, "min": 13.23, "cnt": 32}, "MoE_L0_bwd":{"total": 325.85, "avg": 10.18, "max": 9.75, "min": 11.12, "cnt": 32}, "backward-send-forward-recv":{"total": 3620.71, "avg": 120.69, "max": 2.19, "min": 583.31, "cnt": 30}, "backward-send":{"total": 2.13, "avg": 1.07, "max": 0.99, "min": 1.14, "cnt": 2}, "backward-recv":{"total": 103.11, "avg": 103.11, "max": 103.11, "min": 103.11, "cnt": 1}, "backward-params-all-reduce":{"total": 495.25, "avg": 495.25, "max": 495.25, "min": 495.25, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 288.42, "avg": 288.42, "max": 288.42, "min": 288.42, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 248.37, "avg": 248.37, "max": 248.37, "min": 248.37, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.52, "avg": 3.52, "max": 3.52, "min": 3.52, "cnt": 1}}}
{"type":"time", "iteration": 66, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 138.02, "avg": 69.01, "max": 7.78, "min": 130.24, "cnt": 2}, "forward-compute":{"total": 1920.46, "avg": 60.01, "max": 52.82, "min": 67.28, "cnt": 32}, "fwd-compute":{"total": 1917.37, "avg": 59.92, "max": 52.74, "min": 67.20, "cnt": 32}, "batch-generator":{"total": 46.12, "avg": 1.44, "max": 0.69, "min": 3.40, "cnt": 32}, "fwd-embedding":{"total": 0.60, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1858.68, "avg": 58.08, "max": 51.74, "min": 65.85, "cnt": 32}, "fwd-layernorm":{"total": 9.63, "avg": 0.08, "max": 0.05, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 109.30, "avg": 0.85, "max": 0.75, "min": 2.33, "cnt": 128}, "fwd-misc":{"total": 21.14, "avg": 0.17, "max": 0.11, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1697.79, "avg": 13.26, "max": 10.80, "min": 22.83, "cnt": 128}, "MoE_L0_fwd":{"total": 504.61, "avg": 15.77, "max": 11.69, "min": 22.75, "cnt": 32}, "MoEMLP":{"total": 1680.62, "avg": 13.13, "max": 10.69, "min": 22.70, "cnt": 128}, "MoE_L1_fwd":{"total": 404.23, "avg": 12.63, "max": 11.59, "min": 14.93, "cnt": 32}, "MoE_L2_fwd":{"total": 400.45, "avg": 12.51, "max": 11.71, "min": 17.75, "cnt": 32}, "MoE_L3_fwd":{"total": 377.73, "avg": 11.80, "max": 10.73, "min": 13.62, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.01, "avg": 1.01, "max": 1.01, "min": 1.01, "cnt": 1}, "forward-send-backward-recv":{"total": 188.15, "avg": 6.07, "max": 0.90, "min": 57.09, "cnt": 31}, "backward-compute":{"total": 1777.28, "avg": 55.54, "max": 52.46, "min": 57.63, "cnt": 32}, "MoE_L3_bwd":{"total": 406.73, "avg": 12.71, "max": 11.60, "min": 14.22, "cnt": 32}, "MoE_L2_bwd":{"total": 417.42, "avg": 13.04, "max": 11.75, "min": 14.66, "cnt": 32}, "MoE_L1_bwd":{"total": 400.64, "avg": 12.52, "max": 11.90, "min": 12.85, "cnt": 32}, "MoE_L0_bwd":{"total": 336.28, "avg": 10.51, "max": 9.83, "min": 11.70, "cnt": 32}, "backward-send-forward-recv":{"total": 5586.88, "avg": 186.23, "max": 1.62, "min": 819.93, "cnt": 30}, "backward-send":{"total": 2.03, "avg": 1.01, "max": 0.85, "min": 1.18, "cnt": 2}, "backward-recv":{"total": 71.42, "avg": 71.42, "max": 71.42, "min": 71.42, "cnt": 1}, "backward-params-all-reduce":{"total": 486.62, "avg": 486.62, "max": 486.62, "min": 486.62, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 299.02, "avg": 299.02, "max": 299.02, "min": 299.02, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 259.04, "avg": 259.04, "max": 259.04, "min": 259.04, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.52, "avg": 3.52, "max": 3.52, "min": 3.52, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 67, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 124.61, "avg": 62.31, "max": 1.17, "min": 123.45, "cnt": 2}, "forward-compute":{"total": 1892.09, "avg": 59.13, "max": 52.84, "min": 64.04, "cnt": 32}, "fwd-compute":{"total": 1889.05, "avg": 59.03, "max": 52.77, "min": 63.96, "cnt": 32}, "batch-generator":{"total": 40.58, "avg": 1.27, "max": 0.69, "min": 2.64, "cnt": 32}, "fwd-embedding":{"total": 0.66, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1836.15, "avg": 57.38, "max": 51.57, "min": 62.58, "cnt": 32}, "fwd-layernorm":{"total": 10.29, "avg": 0.08, "max": 0.05, "min": 0.26, "cnt": 128}, "fwd-attn":{"total": 112.75, "avg": 0.88, "max": 0.75, "min": 2.11, "cnt": 128}, "fwd-misc":{"total": 22.40, "avg": 0.17, "max": 0.11, "min": 0.48, "cnt": 128}, "fwd-MLP":{"total": 1668.78, "avg": 13.04, "max": 10.10, "min": 19.85, "cnt": 128}, "MoE_L0_fwd":{"total": 512.94, "avg": 16.03, "max": 12.21, "min": 19.77, "cnt": 32}, "MoEMLP":{"total": 1650.74, "avg": 12.90, "max": 9.98, "min": 19.72, "cnt": 128}, "MoE_L1_fwd":{"total": 413.28, "avg": 12.92, "max": 11.82, "min": 14.47, "cnt": 32}, "MoE_L2_fwd":{"total": 389.33, "avg": 12.17, "max": 11.50, "min": 12.77, "cnt": 32}, "MoE_L3_fwd":{"total": 341.95, "avg": 10.69, "max": 10.03, "min": 11.96, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 0.89, "avg": 0.89, "max": 0.89, "min": 0.89, "cnt": 1}, "forward-send-backward-recv":{"total": 503.00, "avg": 16.23, "max": 1.14, "min": 174.27, "cnt": 31}, "backward-compute":{"total": 1769.76, "avg": 55.30, "max": 52.43, "min": 57.46, "cnt": 32}, "MoE_L3_bwd":{"total": 367.45, "avg": 11.48, "max": 10.08, "min": 14.28, "cnt": 32}, "MoE_L2_bwd":{"total": 410.81, "avg": 12.84, "max": 12.33, "min": 13.72, "cnt": 32}, "MoE_L1_bwd":{"total": 416.45, "avg": 13.01, "max": 12.45, "min": 13.52, "cnt": 32}, "MoE_L0_bwd":{"total": 358.16, "avg": 11.19, "max": 10.59, "min": 12.12, "cnt": 32}, "backward-send-forward-recv":{"total": 5706.99, "avg": 190.23, "max": 1.09, "min": 775.83, "cnt": 30}, "backward-send":{"total": 1.52, "avg": 0.76, "max": 0.69, "min": 0.83, "cnt": 2}, "backward-recv":{"total": 71.27, "avg": 71.27, "max": 71.27, "min": 71.27, "cnt": 1}, "backward-params-all-reduce":{"total": 487.88, "avg": 487.88, "max": 487.88, "min": 487.88, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 294.40, "avg": 294.40, "max": 294.40, "min": 294.40, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 254.39, "avg": 254.39, "max": 254.39, "min": 254.39, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.36, "avg": 3.36, "max": 3.36, "min": 3.36, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.47, "avg": 3.47, "max": 3.47, "min": 3.47, "cnt": 1}}}
{"type":"time", "iteration": 68, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 130.43, "avg": 65.21, "max": 1.18, "min": 129.24, "cnt": 2}, "forward-compute":{"total": 2016.05, "avg": 63.00, "max": 55.01, "min": 116.23, "cnt": 32}, "fwd-compute":{"total": 2013.08, "avg": 62.91, "max": 54.94, "min": 116.13, "cnt": 32}, "batch-generator":{"total": 40.11, "avg": 1.25, "max": 0.67, "min": 2.49, "cnt": 32}, "fwd-embedding":{"total": 0.67, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1960.66, "avg": 61.27, "max": 53.95, "min": 114.51, "cnt": 32}, "fwd-layernorm":{"total": 9.85, "avg": 0.08, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 110.81, "avg": 0.87, "max": 0.74, "min": 1.56, "cnt": 128}, "fwd-misc":{"total": 21.78, "avg": 0.17, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1796.84, "avg": 14.04, "max": 12.01, "min": 69.89, "cnt": 128}, "MoE_L0_fwd":{"total": 537.61, "avg": 16.80, "max": 11.97, "min": 69.45, "cnt": 32}, "MoEMLP":{"total": 1778.89, "avg": 13.90, "max": 11.89, "min": 69.39, "cnt": 128}, "MoE_L1_fwd":{"total": 415.21, "avg": 12.98, "max": 11.93, "min": 18.13, "cnt": 32}, "MoE_L2_fwd":{"total": 412.88, "avg": 12.90, "max": 12.07, "min": 16.62, "cnt": 32}, "MoE_L3_fwd":{"total": 419.66, "avg": 13.11, "max": 12.10, "min": 16.21, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 0.65, "avg": 0.65, "max": 0.65, "min": 0.65, "cnt": 1}, "forward-send-backward-recv":{"total": 143.54, "avg": 4.63, "max": 0.83, "min": 68.22, "cnt": 31}, "backward-compute":{"total": 1856.26, "avg": 58.01, "max": 54.59, "min": 60.73, "cnt": 32}, "MoE_L3_bwd":{"total": 455.80, "avg": 14.24, "max": 13.09, "min": 15.60, "cnt": 32}, "MoE_L2_bwd":{"total": 413.03, "avg": 12.91, "max": 11.90, "min": 16.17, "cnt": 32}, "MoE_L1_bwd":{"total": 413.45, "avg": 12.92, "max": 12.23, "min": 13.91, "cnt": 32}, "MoE_L0_bwd":{"total": 362.84, "avg": 11.34, "max": 10.68, "min": 11.83, "cnt": 32}, "backward-send-forward-recv":{"total": 3147.28, "avg": 104.91, "max": 1.75, "min": 306.78, "cnt": 30}, "backward-send":{"total": 1.56, "avg": 0.78, "max": 0.51, "min": 1.06, "cnt": 2}, "backward-recv":{"total": 63.71, "avg": 63.71, "max": 63.71, "min": 63.71, "cnt": 1}, "backward-params-all-reduce":{"total": 487.69, "avg": 487.69, "max": 487.69, "min": 487.69, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 298.35, "avg": 298.35, "max": 298.35, "min": 298.35, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 257.97, "avg": 257.97, "max": 257.97, "min": 257.97, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.76, "avg": 3.76, "max": 3.76, "min": 3.76, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.47, "avg": 3.47, "max": 3.47, "min": 3.47, "cnt": 1}}}
{"type":"time", "iteration": 69, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 138.45, "avg": 69.22, "max": 5.76, "min": 132.68, "cnt": 2}, "forward-compute":{"total": 1908.14, "avg": 59.63, "max": 53.41, "min": 68.49, "cnt": 32}, "fwd-compute":{"total": 1904.81, "avg": 59.53, "max": 53.35, "min": 68.36, "cnt": 32}, "batch-generator":{"total": 47.52, "avg": 1.48, "max": 0.69, "min": 4.73, "cnt": 32}, "fwd-embedding":{"total": 0.58, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1844.15, "avg": 57.63, "max": 52.32, "min": 63.14, "cnt": 32}, "fwd-layernorm":{"total": 10.27, "avg": 0.08, "max": 0.05, "min": 0.39, "cnt": 128}, "fwd-attn":{"total": 110.30, "avg": 0.86, "max": 0.74, "min": 2.54, "cnt": 128}, "fwd-misc":{"total": 24.38, "avg": 0.19, "max": 0.11, "min": 3.69, "cnt": 128}, "fwd-MLP":{"total": 1677.63, "avg": 13.11, "max": 10.91, "min": 21.16, "cnt": 128}, "MoE_L0_fwd":{"total": 492.74, "avg": 15.40, "max": 12.10, "min": 21.06, "cnt": 32}, "MoEMLP":{"total": 1660.47, "avg": 12.97, "max": 10.79, "min": 21.00, "cnt": 128}, "MoE_L1_fwd":{"total": 407.69, "avg": 12.74, "max": 11.68, "min": 16.41, "cnt": 32}, "MoE_L2_fwd":{"total": 394.97, "avg": 12.34, "max": 11.60, "min": 13.45, "cnt": 32}, "MoE_L3_fwd":{"total": 371.29, "avg": 11.60, "max": 10.84, "min": 12.97, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 0.66, "avg": 0.66, "max": 0.66, "min": 0.66, "cnt": 1}, "forward-send-backward-recv":{"total": 162.22, "avg": 5.23, "max": 0.92, "min": 58.03, "cnt": 31}, "backward-compute":{"total": 1832.73, "avg": 57.27, "max": 53.46, "min": 61.59, "cnt": 32}, "MoE_L3_bwd":{"total": 408.25, "avg": 12.76, "max": 11.50, "min": 14.08, "cnt": 32}, "MoE_L2_bwd":{"total": 412.89, "avg": 12.90, "max": 11.63, "min": 14.56, "cnt": 32}, "MoE_L1_bwd":{"total": 410.56, "avg": 12.83, "max": 12.35, "min": 14.97, "cnt": 32}, "MoE_L0_bwd":{"total": 385.55, "avg": 12.05, "max": 11.19, "min": 14.95, "cnt": 32}, "backward-send-forward-recv":{"total": 7423.17, "avg": 247.44, "max": 1.60, "min": 1493.67, "cnt": 30}, "backward-send":{"total": 2.34, "avg": 1.17, "max": 1.11, "min": 1.23, "cnt": 2}, "backward-recv":{"total": 69.27, "avg": 69.27, "max": 69.27, "min": 69.27, "cnt": 1}, "backward-params-all-reduce":{"total": 484.23, "avg": 484.23, "max": 484.23, "min": 484.23, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 299.33, "avg": 299.33, "max": 299.33, "min": 299.33, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.40, "avg": 3.40, "max": 3.40, "min": 3.40, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 259.29, "avg": 259.29, "max": 259.29, "min": 259.29, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.41, "avg": 3.41, "max": 3.41, "min": 3.41, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.47, "avg": 3.47, "max": 3.47, "min": 3.47, "cnt": 1}}}
{"type":"time", "iteration": 70, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 138.67, "avg": 69.33, "max": 2.03, "min": 136.64, "cnt": 2}, "forward-compute":{"total": 1860.65, "avg": 58.15, "max": 52.81, "min": 63.09, "cnt": 32}, "fwd-compute":{"total": 1855.03, "avg": 57.97, "max": 52.73, "min": 62.78, "cnt": 32}, "batch-generator":{"total": 47.22, "avg": 1.48, "max": 0.66, "min": 2.96, "cnt": 32}, "fwd-embedding":{"total": 0.71, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1795.01, "avg": 56.09, "max": 51.36, "min": 60.65, "cnt": 32}, "fwd-layernorm":{"total": 10.09, "avg": 0.08, "max": 0.05, "min": 0.22, "cnt": 128}, "fwd-attn":{"total": 112.21, "avg": 0.88, "max": 0.74, "min": 2.26, "cnt": 128}, "fwd-misc":{"total": 21.57, "avg": 0.17, "max": 0.11, "min": 0.43, "cnt": 128}, "fwd-MLP":{"total": 1629.68, "avg": 12.73, "max": 10.11, "min": 19.13, "cnt": 128}, "MoE_L0_fwd":{"total": 472.45, "avg": 14.76, "max": 11.95, "min": 19.00, "cnt": 32}, "MoEMLP":{"total": 1612.16, "avg": 12.60, "max": 9.99, "min": 18.93, "cnt": 128}, "MoE_L1_fwd":{"total": 409.76, "avg": 12.81, "max": 11.96, "min": 14.51, "cnt": 32}, "MoE_L2_fwd":{"total": 399.39, "avg": 12.48, "max": 11.77, "min": 14.54, "cnt": 32}, "MoE_L3_fwd":{"total": 337.01, "avg": 10.53, "max": 10.04, "min": 13.10, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.61, "avg": 0.02, "max": 0.02, "min": 0.05, "cnt": 32}, "forward-send":{"total": 0.91, "avg": 0.91, "max": 0.91, "min": 0.91, "cnt": 1}, "forward-send-backward-recv":{"total": 936.23, "avg": 30.20, "max": 0.91, "min": 239.07, "cnt": 31}, "backward-compute":{"total": 1791.95, "avg": 56.00, "max": 53.04, "min": 58.03, "cnt": 32}, "MoE_L3_bwd":{"total": 369.26, "avg": 11.54, "max": 10.33, "min": 12.70, "cnt": 32}, "MoE_L2_bwd":{"total": 412.89, "avg": 12.90, "max": 12.13, "min": 14.13, "cnt": 32}, "MoE_L1_bwd":{"total": 408.27, "avg": 12.76, "max": 11.95, "min": 14.46, "cnt": 32}, "MoE_L0_bwd":{"total": 386.79, "avg": 12.09, "max": 11.57, "min": 13.04, "cnt": 32}, "backward-send-forward-recv":{"total": 3206.85, "avg": 106.90, "max": 1.67, "min": 324.73, "cnt": 30}, "backward-send":{"total": 1.57, "avg": 0.79, "max": 0.70, "min": 0.87, "cnt": 2}, "backward-recv":{"total": 67.49, "avg": 67.49, "max": 67.49, "min": 67.49, "cnt": 1}, "backward-params-all-reduce":{"total": 490.03, "avg": 490.03, "max": 490.03, "min": 490.03, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 294.39, "avg": 294.39, "max": 294.39, "min": 294.39, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 254.67, "avg": 254.67, "max": 254.67, "min": 254.67, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.22, "avg": 3.22, "max": 3.22, "min": 3.22, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.51, "avg": 3.51, "max": 3.51, "min": 3.51, "cnt": 1}}}
{"type":"time", "iteration": 71, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 136.09, "avg": 68.04, "max": 1.36, "min": 134.73, "cnt": 2}, "forward-compute":{"total": 1835.91, "avg": 57.37, "max": 51.14, "min": 66.64, "cnt": 32}, "fwd-compute":{"total": 1832.88, "avg": 57.28, "max": 51.06, "min": 66.56, "cnt": 32}, "batch-generator":{"total": 40.61, "avg": 1.27, "max": 0.70, "min": 2.39, "cnt": 32}, "fwd-embedding":{"total": 0.61, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1780.32, "avg": 55.64, "max": 49.88, "min": 64.74, "cnt": 32}, "fwd-layernorm":{"total": 9.82, "avg": 0.08, "max": 0.05, "min": 0.17, "cnt": 128}, "fwd-attn":{"total": 112.39, "avg": 0.88, "max": 0.74, "min": 2.31, "cnt": 128}, "fwd-misc":{"total": 20.93, "avg": 0.16, "max": 0.11, "min": 0.40, "cnt": 128}, "fwd-MLP":{"total": 1615.71, "avg": 12.62, "max": 9.52, "min": 24.67, "cnt": 128}, "MoE_L0_fwd":{"total": 523.78, "avg": 16.37, "max": 12.83, "min": 24.60, "cnt": 32}, "MoEMLP":{"total": 1598.32, "avg": 12.49, "max": 9.41, "min": 24.56, "cnt": 128}, "MoE_L1_fwd":{"total": 417.44, "avg": 13.04, "max": 11.94, "min": 14.83, "cnt": 32}, "MoE_L2_fwd":{"total": 345.18, "avg": 10.79, "max": 10.23, "min": 12.15, "cnt": 32}, "MoE_L3_fwd":{"total": 318.39, "avg": 9.95, "max": 9.45, "min": 10.79, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.56, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 0.89, "avg": 0.89, "max": 0.89, "min": 0.89, "cnt": 1}, "forward-send-backward-recv":{"total": 993.11, "avg": 32.04, "max": 0.92, "min": 488.40, "cnt": 31}, "backward-compute":{"total": 1699.04, "avg": 53.10, "max": 49.98, "min": 57.20, "cnt": 32}, "MoE_L3_bwd":{"total": 346.56, "avg": 10.83, "max": 9.02, "min": 12.77, "cnt": 32}, "MoE_L2_bwd":{"total": 350.06, "avg": 10.94, "max": 9.92, "min": 14.94, "cnt": 32}, "MoE_L1_bwd":{"total": 414.93, "avg": 12.97, "max": 12.61, "min": 13.41, "cnt": 32}, "MoE_L0_bwd":{"total": 371.01, "avg": 11.59, "max": 11.33, "min": 12.10, "cnt": 32}, "backward-send-forward-recv":{"total": 4772.69, "avg": 159.09, "max": 1.88, "min": 845.51, "cnt": 30}, "backward-send":{"total": 1.08, "avg": 0.54, "max": 0.48, "min": 0.60, "cnt": 2}, "backward-recv":{"total": 77.03, "avg": 77.03, "max": 77.03, "min": 77.03, "cnt": 1}, "backward-params-all-reduce":{"total": 491.97, "avg": 491.97, "max": 491.97, "min": 491.97, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 293.74, "avg": 293.74, "max": 293.74, "min": 293.74, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 253.64, "avg": 253.64, "max": 253.64, "min": 253.64, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.72, "avg": 3.72, "max": 3.72, "min": 3.72, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.47, "avg": 3.47, "max": 3.47, "min": 3.47, "cnt": 1}}}
{"type":"time", "iteration": 72, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 125.65, "avg": 62.83, "max": 0.81, "min": 124.84, "cnt": 2}, "forward-compute":{"total": 1796.62, "avg": 56.14, "max": 50.28, "min": 65.69, "cnt": 32}, "fwd-compute":{"total": 1793.40, "avg": 56.04, "max": 50.21, "min": 65.55, "cnt": 32}, "batch-generator":{"total": 45.94, "avg": 1.44, "max": 0.67, "min": 3.75, "cnt": 32}, "fwd-embedding":{"total": 0.63, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1735.00, "avg": 54.22, "max": 49.15, "min": 62.76, "cnt": 32}, "fwd-layernorm":{"total": 9.65, "avg": 0.08, "max": 0.05, "min": 0.18, "cnt": 128}, "fwd-attn":{"total": 106.67, "avg": 0.83, "max": 0.74, "min": 1.50, "cnt": 128}, "fwd-misc":{"total": 20.59, "avg": 0.16, "max": 0.11, "min": 0.34, "cnt": 128}, "fwd-MLP":{"total": 1577.57, "avg": 12.32, "max": 9.46, "min": 19.27, "cnt": 128}, "MoE_L0_fwd":{"total": 472.39, "avg": 14.76, "max": 11.59, "min": 19.18, "cnt": 32}, "MoEMLP":{"total": 1560.37, "avg": 12.19, "max": 9.35, "min": 19.13, "cnt": 128}, "MoE_L1_fwd":{"total": 414.58, "avg": 12.96, "max": 11.89, "min": 15.66, "cnt": 32}, "MoE_L2_fwd":{"total": 353.99, "avg": 11.06, "max": 10.24, "min": 13.74, "cnt": 32}, "MoE_L3_fwd":{"total": 325.69, "avg": 10.18, "max": 9.39, "min": 15.59, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 0.82, "avg": 0.82, "max": 0.82, "min": 0.82, "cnt": 1}, "forward-send-backward-recv":{"total": 2168.67, "avg": 69.96, "max": 0.92, "min": 390.36, "cnt": 31}, "backward-compute":{"total": 1717.24, "avg": 53.66, "max": 51.38, "min": 58.29, "cnt": 32}, "MoE_L3_bwd":{"total": 349.74, "avg": 10.93, "max": 9.54, "min": 12.25, "cnt": 32}, "MoE_L2_bwd":{"total": 357.69, "avg": 11.18, "max": 9.91, "min": 13.22, "cnt": 32}, "MoE_L1_bwd":{"total": 434.40, "avg": 13.58, "max": 12.60, "min": 18.33, "cnt": 32}, "MoE_L0_bwd":{"total": 357.80, "avg": 11.18, "max": 10.37, "min": 12.76, "cnt": 32}, "backward-send-forward-recv":{"total": 3576.07, "avg": 119.20, "max": 1.34, "min": 693.16, "cnt": 30}, "backward-send":{"total": 1.14, "avg": 0.57, "max": 0.43, "min": 0.71, "cnt": 2}, "backward-recv":{"total": 69.51, "avg": 69.51, "max": 69.51, "min": 69.51, "cnt": 1}, "backward-params-all-reduce":{"total": 492.29, "avg": 492.29, "max": 492.29, "min": 492.29, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 291.25, "avg": 291.25, "max": 291.25, "min": 291.25, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 251.08, "avg": 251.08, "max": 251.08, "min": 251.08, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.49, "avg": 3.49, "max": 3.49, "min": 3.49, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.48, "avg": 3.48, "max": 3.48, "min": 3.48, "cnt": 1}}}
{"type":"time", "iteration": 73, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 133.85, "avg": 66.93, "max": 3.46, "min": 130.39, "cnt": 2}, "forward-compute":{"total": 1867.04, "avg": 58.35, "max": 54.72, "min": 61.37, "cnt": 32}, "fwd-compute":{"total": 1863.42, "avg": 58.23, "max": 54.63, "min": 61.24, "cnt": 32}, "batch-generator":{"total": 41.87, "avg": 1.31, "max": 0.74, "min": 2.14, "cnt": 32}, "fwd-embedding":{"total": 0.78, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1808.22, "avg": 56.51, "max": 53.51, "min": 59.31, "cnt": 32}, "fwd-layernorm":{"total": 10.81, "avg": 0.08, "max": 0.05, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 114.37, "avg": 0.89, "max": 0.74, "min": 1.89, "cnt": 128}, "fwd-misc":{"total": 23.25, "avg": 0.18, "max": 0.12, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1637.10, "avg": 12.79, "max": 9.56, "min": 20.59, "cnt": 128}, "MoE_L0_fwd":{"total": 555.04, "avg": 17.34, "max": 14.49, "min": 20.50, "cnt": 32}, "MoEMLP":{"total": 1618.61, "avg": 12.65, "max": 9.45, "min": 20.45, "cnt": 128}, "MoE_L1_fwd":{"total": 418.91, "avg": 13.09, "max": 12.40, "min": 14.98, "cnt": 32}, "MoE_L2_fwd":{"total": 333.46, "avg": 10.42, "max": 9.81, "min": 11.23, "cnt": 32}, "MoE_L3_fwd":{"total": 318.04, "avg": 9.94, "max": 9.49, "min": 11.72, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 0.89, "avg": 0.89, "max": 0.89, "min": 0.89, "cnt": 1}, "forward-send-backward-recv":{"total": 5500.88, "avg": 177.45, "max": 8.12, "min": 898.87, "cnt": 31}, "backward-compute":{"total": 1705.31, "avg": 53.29, "max": 50.85, "min": 56.41, "cnt": 32}, "MoE_L3_bwd":{"total": 350.25, "avg": 10.95, "max": 9.34, "min": 13.84, "cnt": 32}, "MoE_L2_bwd":{"total": 323.37, "avg": 10.11, "max": 9.31, "min": 11.03, "cnt": 32}, "MoE_L1_bwd":{"total": 432.54, "avg": 13.52, "max": 13.25, "min": 13.92, "cnt": 32}, "MoE_L0_bwd":{"total": 379.49, "avg": 11.86, "max": 11.30, "min": 12.80, "cnt": 32}, "backward-send-forward-recv":{"total": 51.99, "avg": 1.73, "max": 0.95, "min": 2.89, "cnt": 30}, "backward-send":{"total": 1.62, "avg": 0.81, "max": 0.67, "min": 0.95, "cnt": 2}, "backward-recv":{"total": 222.59, "avg": 222.59, "max": 222.59, "min": 222.59, "cnt": 1}, "backward-params-all-reduce":{"total": 486.96, "avg": 486.96, "max": 486.96, "min": 486.96, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 295.20, "avg": 295.20, "max": 295.20, "min": 295.20, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 255.28, "avg": 255.28, "max": 255.28, "min": 255.28, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.33, "avg": 3.33, "max": 3.33, "min": 3.33, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 74, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 125.87, "avg": 62.94, "max": 1.61, "min": 124.27, "cnt": 2}, "forward-compute":{"total": 1832.81, "avg": 57.28, "max": 51.54, "min": 60.99, "cnt": 32}, "fwd-compute":{"total": 1829.64, "avg": 57.18, "max": 51.47, "min": 60.90, "cnt": 32}, "batch-generator":{"total": 45.20, "avg": 1.41, "max": 0.71, "min": 3.56, "cnt": 32}, "fwd-embedding":{"total": 0.67, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1771.75, "avg": 55.37, "max": 50.44, "min": 59.38, "cnt": 32}, "fwd-layernorm":{"total": 9.85, "avg": 0.08, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 110.05, "avg": 0.86, "max": 0.74, "min": 1.82, "cnt": 128}, "fwd-misc":{"total": 21.55, "avg": 0.17, "max": 0.11, "min": 0.44, "cnt": 128}, "fwd-MLP":{"total": 1609.19, "avg": 12.57, "max": 9.38, "min": 18.60, "cnt": 128}, "MoE_L0_fwd":{"total": 501.78, "avg": 15.68, "max": 12.56, "min": 18.43, "cnt": 32}, "MoEMLP":{"total": 1591.92, "avg": 12.44, "max": 9.27, "min": 18.33, "cnt": 128}, "MoE_L1_fwd":{"total": 431.99, "avg": 13.50, "max": 12.42, "min": 15.62, "cnt": 32}, "MoE_L2_fwd":{"total": 346.26, "avg": 10.82, "max": 10.22, "min": 12.09, "cnt": 32}, "MoE_L3_fwd":{"total": 318.27, "avg": 9.95, "max": 9.31, "min": 10.70, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 0.77, "avg": 0.77, "max": 0.77, "min": 0.77, "cnt": 1}, "forward-send-backward-recv":{"total": 879.05, "avg": 28.36, "max": 0.96, "min": 448.91, "cnt": 31}, "backward-compute":{"total": 1736.33, "avg": 54.26, "max": 51.57, "min": 57.08, "cnt": 32}, "MoE_L3_bwd":{"total": 341.43, "avg": 10.67, "max": 9.79, "min": 11.91, "cnt": 32}, "MoE_L2_bwd":{"total": 337.96, "avg": 10.56, "max": 9.81, "min": 13.12, "cnt": 32}, "MoE_L1_bwd":{"total": 453.28, "avg": 14.17, "max": 13.66, "min": 14.55, "cnt": 32}, "MoE_L0_bwd":{"total": 387.05, "avg": 12.10, "max": 11.25, "min": 13.37, "cnt": 32}, "backward-send-forward-recv":{"total": 4210.36, "avg": 140.35, "max": 1.66, "min": 481.10, "cnt": 30}, "backward-send":{"total": 1.96, "avg": 0.98, "max": 0.94, "min": 1.02, "cnt": 2}, "backward-recv":{"total": 75.32, "avg": 75.32, "max": 75.32, "min": 75.32, "cnt": 1}, "backward-params-all-reduce":{"total": 491.79, "avg": 491.79, "max": 491.79, "min": 491.79, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 286.44, "avg": 286.44, "max": 286.44, "min": 286.44, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 246.69, "avg": 246.69, "max": 246.69, "min": 246.69, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 75, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 136.14, "avg": 68.07, "max": 0.92, "min": 135.22, "cnt": 2}, "forward-compute":{"total": 1864.40, "avg": 58.26, "max": 52.06, "min": 65.52, "cnt": 32}, "fwd-compute":{"total": 1861.22, "avg": 58.16, "max": 51.98, "min": 65.42, "cnt": 32}, "batch-generator":{"total": 55.55, "avg": 1.74, "max": 0.67, "min": 4.00, "cnt": 32}, "fwd-embedding":{"total": 0.72, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1792.71, "avg": 56.02, "max": 50.64, "min": 61.06, "cnt": 32}, "fwd-layernorm":{"total": 10.30, "avg": 0.08, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 111.36, "avg": 0.87, "max": 0.74, "min": 1.71, "cnt": 128}, "fwd-misc":{"total": 22.19, "avg": 0.17, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1627.12, "avg": 12.71, "max": 9.67, "min": 19.86, "cnt": 128}, "MoE_L0_fwd":{"total": 478.76, "avg": 14.96, "max": 11.39, "min": 19.78, "cnt": 32}, "MoEMLP":{"total": 1609.37, "avg": 12.57, "max": 9.55, "min": 19.71, "cnt": 128}, "MoE_L1_fwd":{"total": 462.76, "avg": 14.46, "max": 13.36, "min": 17.88, "cnt": 32}, "MoE_L2_fwd":{"total": 344.22, "avg": 10.76, "max": 9.88, "min": 12.60, "cnt": 32}, "MoE_L3_fwd":{"total": 330.19, "avg": 10.32, "max": 9.60, "min": 14.46, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 0.72, "avg": 0.72, "max": 0.72, "min": 0.72, "cnt": 1}, "forward-send-backward-recv":{"total": 1180.68, "avg": 38.09, "max": 0.93, "min": 284.35, "cnt": 31}, "backward-compute":{"total": 1773.78, "avg": 55.43, "max": 51.71, "min": 59.96, "cnt": 32}, "MoE_L3_bwd":{"total": 362.76, "avg": 11.34, "max": 10.07, "min": 16.51, "cnt": 32}, "MoE_L2_bwd":{"total": 332.82, "avg": 10.40, "max": 9.56, "min": 11.63, "cnt": 32}, "MoE_L1_bwd":{"total": 506.95, "avg": 15.84, "max": 15.01, "min": 17.89, "cnt": 32}, "MoE_L0_bwd":{"total": 353.64, "avg": 11.05, "max": 10.47, "min": 11.57, "cnt": 32}, "backward-send-forward-recv":{"total": 4135.63, "avg": 137.85, "max": 1.20, "min": 790.60, "cnt": 30}, "backward-send":{"total": 1.68, "avg": 0.84, "max": 0.52, "min": 1.16, "cnt": 2}, "backward-recv":{"total": 71.32, "avg": 71.32, "max": 71.32, "min": 71.32, "cnt": 1}, "backward-params-all-reduce":{"total": 491.50, "avg": 491.50, "max": 491.50, "min": 491.50, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 288.44, "avg": 288.44, "max": 288.44, "min": 288.44, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.47, "avg": 3.47, "max": 3.47, "min": 3.47, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 248.42, "avg": 248.42, "max": 248.42, "min": 248.42, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.54, "avg": 3.54, "max": 3.54, "min": 3.54, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.48, "avg": 3.48, "max": 3.48, "min": 3.48, "cnt": 1}}}
{"type":"time", "iteration": 76, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 144.14, "avg": 72.07, "max": 13.04, "min": 131.10, "cnt": 2}, "forward-compute":{"total": 1850.04, "avg": 57.81, "max": 53.13, "min": 65.77, "cnt": 32}, "fwd-compute":{"total": 1847.06, "avg": 57.72, "max": 53.05, "min": 65.67, "cnt": 32}, "batch-generator":{"total": 38.18, "avg": 1.19, "max": 0.66, "min": 2.82, "cnt": 32}, "fwd-embedding":{"total": 0.51, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1796.74, "avg": 56.15, "max": 51.34, "min": 64.35, "cnt": 32}, "fwd-layernorm":{"total": 9.14, "avg": 0.07, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 105.35, "avg": 0.82, "max": 0.75, "min": 1.47, "cnt": 128}, "fwd-misc":{"total": 20.39, "avg": 0.16, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1641.29, "avg": 12.82, "max": 10.32, "min": 22.67, "cnt": 128}, "MoE_L0_fwd":{"total": 479.34, "avg": 14.98, "max": 11.46, "min": 22.59, "cnt": 32}, "MoEMLP":{"total": 1624.58, "avg": 12.69, "max": 10.21, "min": 22.54, "cnt": 128}, "MoE_L1_fwd":{"total": 463.02, "avg": 14.47, "max": 13.40, "min": 16.42, "cnt": 32}, "MoE_L2_fwd":{"total": 345.00, "avg": 10.78, "max": 10.25, "min": 11.85, "cnt": 32}, "MoE_L3_fwd":{"total": 343.43, "avg": 10.73, "max": 10.27, "min": 12.17, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 0.84, "avg": 0.84, "max": 0.84, "min": 0.84, "cnt": 1}, "forward-send-backward-recv":{"total": 266.40, "avg": 8.59, "max": 0.99, "min": 90.57, "cnt": 31}, "backward-compute":{"total": 1762.37, "avg": 55.07, "max": 52.24, "min": 57.58, "cnt": 32}, "MoE_L3_bwd":{"total": 373.59, "avg": 11.67, "max": 10.98, "min": 12.82, "cnt": 32}, "MoE_L2_bwd":{"total": 339.12, "avg": 10.60, "max": 9.12, "min": 13.97, "cnt": 32}, "MoE_L1_bwd":{"total": 507.39, "avg": 15.86, "max": 15.53, "min": 16.38, "cnt": 32}, "MoE_L0_bwd":{"total": 321.33, "avg": 10.04, "max": 9.36, "min": 11.72, "cnt": 32}, "backward-send-forward-recv":{"total": 4492.35, "avg": 149.74, "max": 0.95, "min": 1273.02, "cnt": 30}, "backward-send":{"total": 0.94, "avg": 0.47, "max": 0.45, "min": 0.49, "cnt": 2}, "backward-recv":{"total": 321.92, "avg": 321.92, "max": 321.92, "min": 321.92, "cnt": 1}, "backward-params-all-reduce":{"total": 491.95, "avg": 491.95, "max": 491.95, "min": 491.95, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 293.82, "avg": 293.82, "max": 293.82, "min": 293.82, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 253.99, "avg": 253.99, "max": 253.99, "min": 253.99, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.33, "avg": 3.33, "max": 3.33, "min": 3.33, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 77, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 127.99, "avg": 64.00, "max": 0.90, "min": 127.09, "cnt": 2}, "forward-compute":{"total": 1847.91, "avg": 57.75, "max": 51.56, "min": 62.61, "cnt": 32}, "fwd-compute":{"total": 1844.93, "avg": 57.65, "max": 51.49, "min": 62.47, "cnt": 32}, "batch-generator":{"total": 41.44, "avg": 1.29, "max": 0.64, "min": 2.97, "cnt": 32}, "fwd-embedding":{"total": 0.60, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1790.96, "avg": 55.97, "max": 49.90, "min": 60.24, "cnt": 32}, "fwd-layernorm":{"total": 9.67, "avg": 0.08, "max": 0.05, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 109.25, "avg": 0.85, "max": 0.74, "min": 1.52, "cnt": 128}, "fwd-misc":{"total": 21.13, "avg": 0.17, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1629.83, "avg": 12.73, "max": 9.57, "min": 19.00, "cnt": 128}, "MoE_L0_fwd":{"total": 483.90, "avg": 15.12, "max": 11.56, "min": 18.92, "cnt": 32}, "MoEMLP":{"total": 1612.43, "avg": 12.60, "max": 9.46, "min": 18.88, "cnt": 128}, "MoE_L1_fwd":{"total": 450.36, "avg": 14.07, "max": 13.04, "min": 15.23, "cnt": 32}, "MoE_L2_fwd":{"total": 346.33, "avg": 10.82, "max": 9.99, "min": 14.24, "cnt": 32}, "MoE_L3_fwd":{"total": 338.17, "avg": 10.57, "max": 9.50, "min": 12.66, "cnt": 32}, "fwd-pooler":{"total": 0.36, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 0.69, "avg": 0.69, "max": 0.69, "min": 0.69, "cnt": 1}, "forward-send-backward-recv":{"total": 1347.80, "avg": 43.48, "max": 1.00, "min": 287.42, "cnt": 31}, "backward-compute":{"total": 1743.24, "avg": 54.48, "max": 51.65, "min": 57.06, "cnt": 32}, "MoE_L3_bwd":{"total": 373.26, "avg": 11.66, "max": 10.60, "min": 12.71, "cnt": 32}, "MoE_L2_bwd":{"total": 336.48, "avg": 10.51, "max": 9.78, "min": 11.81, "cnt": 32}, "MoE_L1_bwd":{"total": 492.22, "avg": 15.38, "max": 14.75, "min": 16.71, "cnt": 32}, "MoE_L0_bwd":{"total": 320.85, "avg": 10.03, "max": 9.55, "min": 10.51, "cnt": 32}, "backward-send-forward-recv":{"total": 4931.01, "avg": 164.37, "max": 1.71, "min": 1615.13, "cnt": 30}, "backward-send":{"total": 2.08, "avg": 1.04, "max": 0.93, "min": 1.16, "cnt": 2}, "backward-recv":{"total": 76.67, "avg": 76.67, "max": 76.67, "min": 76.67, "cnt": 1}, "backward-params-all-reduce":{"total": 488.53, "avg": 488.53, "max": 488.53, "min": 488.53, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 295.54, "avg": 295.54, "max": 295.54, "min": 295.54, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 255.36, "avg": 255.36, "max": 255.36, "min": 255.36, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.68, "avg": 3.68, "max": 3.68, "min": 3.68, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 78, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 133.62, "avg": 66.81, "max": 1.48, "min": 132.14, "cnt": 2}, "forward-compute":{"total": 1809.61, "avg": 56.55, "max": 50.58, "min": 61.36, "cnt": 32}, "fwd-compute":{"total": 1806.51, "avg": 56.45, "max": 50.50, "min": 61.27, "cnt": 32}, "batch-generator":{"total": 38.08, "avg": 1.19, "max": 0.68, "min": 2.02, "cnt": 32}, "fwd-embedding":{"total": 0.64, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1756.31, "avg": 54.88, "max": 49.36, "min": 59.98, "cnt": 32}, "fwd-layernorm":{"total": 9.72, "avg": 0.08, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 113.06, "avg": 0.88, "max": 0.75, "min": 1.74, "cnt": 128}, "fwd-misc":{"total": 21.53, "avg": 0.17, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1590.59, "avg": 12.43, "max": 9.70, "min": 19.00, "cnt": 128}, "MoE_L0_fwd":{"total": 479.76, "avg": 14.99, "max": 11.44, "min": 18.91, "cnt": 32}, "MoEMLP":{"total": 1573.41, "avg": 12.29, "max": 9.60, "min": 18.86, "cnt": 128}, "MoE_L1_fwd":{"total": 436.47, "avg": 13.64, "max": 12.50, "min": 15.61, "cnt": 32}, "MoE_L2_fwd":{"total": 340.30, "avg": 10.63, "max": 9.99, "min": 11.75, "cnt": 32}, "MoE_L3_fwd":{"total": 323.22, "avg": 10.10, "max": 9.64, "min": 11.27, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.56, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 0.94, "avg": 0.94, "max": 0.94, "min": 0.94, "cnt": 1}, "forward-send-backward-recv":{"total": 320.36, "avg": 10.33, "max": 1.23, "min": 82.02, "cnt": 31}, "backward-compute":{"total": 1708.38, "avg": 53.39, "max": 50.30, "min": 56.52, "cnt": 32}, "MoE_L3_bwd":{"total": 358.10, "avg": 11.19, "max": 10.23, "min": 12.33, "cnt": 32}, "MoE_L2_bwd":{"total": 338.37, "avg": 10.57, "max": 9.93, "min": 12.87, "cnt": 32}, "MoE_L1_bwd":{"total": 467.26, "avg": 14.60, "max": 14.19, "min": 14.99, "cnt": 32}, "MoE_L0_bwd":{"total": 329.41, "avg": 10.29, "max": 8.93, "min": 13.14, "cnt": 32}, "backward-send-forward-recv":{"total": 3954.73, "avg": 131.82, "max": 1.37, "min": 786.05, "cnt": 30}, "backward-send":{"total": 1.79, "avg": 0.89, "max": 0.84, "min": 0.95, "cnt": 2}, "backward-recv":{"total": 76.29, "avg": 76.29, "max": 76.29, "min": 76.29, "cnt": 1}, "backward-params-all-reduce":{"total": 486.15, "avg": 486.15, "max": 486.15, "min": 486.15, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 297.15, "avg": 297.15, "max": 297.15, "min": 297.15, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 257.22, "avg": 257.22, "max": 257.22, "min": 257.22, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.47, "avg": 3.47, "max": 3.47, "min": 3.47, "cnt": 1}}}
{"type":"time", "iteration": 79, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 134.17, "avg": 67.09, "max": 1.00, "min": 133.17, "cnt": 2}, "forward-compute":{"total": 1865.45, "avg": 58.30, "max": 51.57, "min": 68.63, "cnt": 32}, "fwd-compute":{"total": 1862.41, "avg": 58.20, "max": 51.49, "min": 68.47, "cnt": 32}, "batch-generator":{"total": 43.46, "avg": 1.36, "max": 0.70, "min": 5.95, "cnt": 32}, "fwd-embedding":{"total": 0.59, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1806.36, "avg": 56.45, "max": 50.36, "min": 63.17, "cnt": 32}, "fwd-layernorm":{"total": 9.47, "avg": 0.07, "max": 0.05, "min": 0.27, "cnt": 128}, "fwd-attn":{"total": 107.69, "avg": 0.84, "max": 0.74, "min": 2.31, "cnt": 128}, "fwd-misc":{"total": 20.65, "avg": 0.16, "max": 0.11, "min": 0.47, "cnt": 128}, "fwd-MLP":{"total": 1647.95, "avg": 12.87, "max": 9.63, "min": 21.76, "cnt": 128}, "MoE_L0_fwd":{"total": 517.97, "avg": 16.19, "max": 11.58, "min": 21.66, "cnt": 32}, "MoEMLP":{"total": 1631.48, "avg": 12.75, "max": 9.52, "min": 21.61, "cnt": 128}, "MoE_L1_fwd":{"total": 453.10, "avg": 14.16, "max": 12.86, "min": 17.16, "cnt": 32}, "MoE_L2_fwd":{"total": 342.18, "avg": 10.69, "max": 10.02, "min": 12.07, "cnt": 32}, "MoE_L3_fwd":{"total": 324.36, "avg": 10.14, "max": 9.56, "min": 11.09, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 0.90, "avg": 0.90, "max": 0.90, "min": 0.90, "cnt": 1}, "forward-send-backward-recv":{"total": 266.21, "avg": 8.59, "max": 1.00, "min": 83.05, "cnt": 31}, "backward-compute":{"total": 1793.20, "avg": 56.04, "max": 51.00, "min": 128.95, "cnt": 32}, "MoE_L3_bwd":{"total": 364.24, "avg": 11.38, "max": 10.36, "min": 13.93, "cnt": 32}, "MoE_L2_bwd":{"total": 340.00, "avg": 10.63, "max": 10.05, "min": 11.91, "cnt": 32}, "MoE_L1_bwd":{"total": 485.56, "avg": 15.17, "max": 13.81, "min": 33.69, "cnt": 32}, "MoE_L0_bwd":{"total": 386.42, "avg": 12.08, "max": 9.90, "min": 66.31, "cnt": 32}, "backward-send-forward-recv":{"total": 4646.59, "avg": 154.89, "max": 0.91, "min": 749.63, "cnt": 30}, "backward-send":{"total": 2.03, "avg": 1.02, "max": 0.89, "min": 1.14, "cnt": 2}, "backward-recv":{"total": 73.78, "avg": 73.78, "max": 73.78, "min": 73.78, "cnt": 1}, "backward-params-all-reduce":{"total": 490.20, "avg": 490.20, "max": 490.20, "min": 490.20, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 297.94, "avg": 297.94, "max": 297.94, "min": 297.94, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 258.01, "avg": 258.01, "max": 258.01, "min": 258.01, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.47, "avg": 3.47, "max": 3.47, "min": 3.47, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 80, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 135.73, "avg": 67.87, "max": 0.65, "min": 135.08, "cnt": 2}, "forward-compute":{"total": 1836.80, "avg": 57.40, "max": 51.99, "min": 65.13, "cnt": 32}, "fwd-compute":{"total": 1833.59, "avg": 57.30, "max": 51.91, "min": 64.99, "cnt": 32}, "batch-generator":{"total": 42.65, "avg": 1.33, "max": 0.71, "min": 2.58, "cnt": 32}, "fwd-embedding":{"total": 0.72, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1778.33, "avg": 55.57, "max": 50.72, "min": 62.81, "cnt": 32}, "fwd-layernorm":{"total": 10.16, "avg": 0.08, "max": 0.05, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 111.01, "avg": 0.87, "max": 0.74, "min": 2.13, "cnt": 128}, "fwd-misc":{"total": 21.34, "avg": 0.17, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1614.52, "avg": 12.61, "max": 9.65, "min": 18.82, "cnt": 128}, "MoE_L0_fwd":{"total": 471.09, "avg": 14.72, "max": 11.42, "min": 18.72, "cnt": 32}, "MoEMLP":{"total": 1597.04, "avg": 12.48, "max": 9.54, "min": 18.67, "cnt": 128}, "MoE_L1_fwd":{"total": 450.40, "avg": 14.08, "max": 13.02, "min": 16.74, "cnt": 32}, "MoE_L2_fwd":{"total": 351.62, "avg": 10.99, "max": 10.17, "min": 13.89, "cnt": 32}, "MoE_L3_fwd":{"total": 330.41, "avg": 10.33, "max": 9.58, "min": 11.96, "cnt": 32}, "fwd-pooler":{"total": 0.36, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 0.52, "avg": 0.52, "max": 0.52, "min": 0.52, "cnt": 1}, "forward-send-backward-recv":{"total": 2502.80, "avg": 80.74, "max": 1.00, "min": 420.45, "cnt": 31}, "backward-compute":{"total": 1765.35, "avg": 55.17, "max": 53.15, "min": 58.61, "cnt": 32}, "MoE_L3_bwd":{"total": 380.10, "avg": 11.88, "max": 10.31, "min": 14.90, "cnt": 32}, "MoE_L2_bwd":{"total": 347.22, "avg": 10.85, "max": 9.93, "min": 12.44, "cnt": 32}, "MoE_L1_bwd":{"total": 471.60, "avg": 14.74, "max": 13.97, "min": 16.29, "cnt": 32}, "MoE_L0_bwd":{"total": 345.27, "avg": 10.79, "max": 10.28, "min": 12.80, "cnt": 32}, "backward-send-forward-recv":{"total": 1201.71, "avg": 40.06, "max": 1.10, "min": 239.30, "cnt": 30}, "backward-send":{"total": 1.31, "avg": 0.65, "max": 0.52, "min": 0.79, "cnt": 2}, "backward-recv":{"total": 68.88, "avg": 68.88, "max": 68.88, "min": 68.88, "cnt": 1}, "backward-params-all-reduce":{"total": 487.70, "avg": 487.70, "max": 487.70, "min": 487.70, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 289.41, "avg": 289.41, "max": 289.41, "min": 289.41, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 249.57, "avg": 249.57, "max": 249.57, "min": 249.57, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.33, "avg": 3.33, "max": 3.33, "min": 3.33, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.47, "avg": 3.47, "max": 3.47, "min": 3.47, "cnt": 1}}}
{"type":"time", "iteration": 81, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 136.38, "avg": 68.19, "max": 1.11, "min": 135.27, "cnt": 2}, "forward-compute":{"total": 1945.85, "avg": 60.81, "max": 52.95, "min": 69.69, "cnt": 32}, "fwd-compute":{"total": 1942.64, "avg": 60.71, "max": 52.87, "min": 69.61, "cnt": 32}, "batch-generator":{"total": 39.95, "avg": 1.25, "max": 0.71, "min": 2.21, "cnt": 32}, "fwd-embedding":{"total": 0.60, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1889.31, "avg": 59.04, "max": 51.83, "min": 68.38, "cnt": 32}, "fwd-layernorm":{"total": 10.07, "avg": 0.08, "max": 0.05, "min": 0.22, "cnt": 128}, "fwd-attn":{"total": 113.64, "avg": 0.89, "max": 0.74, "min": 2.58, "cnt": 128}, "fwd-misc":{"total": 22.00, "avg": 0.17, "max": 0.11, "min": 0.61, "cnt": 128}, "fwd-MLP":{"total": 1721.21, "avg": 13.45, "max": 10.02, "min": 21.83, "cnt": 128}, "MoE_L0_fwd":{"total": 519.04, "avg": 16.22, "max": 12.02, "min": 21.73, "cnt": 32}, "MoEMLP":{"total": 1703.17, "avg": 13.31, "max": 9.92, "min": 21.68, "cnt": 128}, "MoE_L1_fwd":{"total": 463.65, "avg": 14.49, "max": 13.14, "min": 17.39, "cnt": 32}, "MoE_L2_fwd":{"total": 377.13, "avg": 11.79, "max": 10.69, "min": 16.11, "cnt": 32}, "MoE_L3_fwd":{"total": 350.04, "avg": 10.94, "max": 9.96, "min": 12.61, "cnt": 32}, "fwd-pooler":{"total": 0.37, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.62, "avg": 0.02, "max": 0.02, "min": 0.04, "cnt": 32}, "forward-send":{"total": 0.83, "avg": 0.83, "max": 0.83, "min": 0.83, "cnt": 1}, "forward-send-backward-recv":{"total": 934.83, "avg": 30.16, "max": 0.91, "min": 245.27, "cnt": 31}, "backward-compute":{"total": 1816.33, "avg": 56.76, "max": 54.73, "min": 58.89, "cnt": 32}, "MoE_L3_bwd":{"total": 382.89, "avg": 11.97, "max": 10.55, "min": 13.77, "cnt": 32}, "MoE_L2_bwd":{"total": 374.19, "avg": 11.69, "max": 10.83, "min": 13.19, "cnt": 32}, "MoE_L1_bwd":{"total": 490.73, "avg": 15.34, "max": 14.62, "min": 16.39, "cnt": 32}, "MoE_L0_bwd":{"total": 354.04, "avg": 11.06, "max": 10.30, "min": 11.72, "cnt": 32}, "backward-send-forward-recv":{"total": 3911.85, "avg": 130.39, "max": 0.97, "min": 857.11, "cnt": 30}, "backward-send":{"total": 0.94, "avg": 0.47, "max": 0.46, "min": 0.48, "cnt": 2}, "backward-recv":{"total": 66.80, "avg": 66.80, "max": 66.80, "min": 66.80, "cnt": 1}, "backward-params-all-reduce":{"total": 491.70, "avg": 491.70, "max": 491.70, "min": 491.70, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 292.04, "avg": 292.04, "max": 292.04, "min": 292.04, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.36, "avg": 3.36, "max": 3.36, "min": 3.36, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 252.12, "avg": 252.12, "max": 252.12, "min": 252.12, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 82, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 135.87, "avg": 67.93, "max": 1.00, "min": 134.87, "cnt": 2}, "forward-compute":{"total": 1925.62, "avg": 60.18, "max": 52.35, "min": 73.62, "cnt": 32}, "fwd-compute":{"total": 1922.38, "avg": 60.07, "max": 52.29, "min": 73.54, "cnt": 32}, "batch-generator":{"total": 41.51, "avg": 1.30, "max": 0.65, "min": 2.29, "cnt": 32}, "fwd-embedding":{"total": 0.69, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1868.26, "avg": 58.38, "max": 51.28, "min": 71.84, "cnt": 32}, "fwd-layernorm":{"total": 10.08, "avg": 0.08, "max": 0.05, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 110.74, "avg": 0.87, "max": 0.75, "min": 1.47, "cnt": 128}, "fwd-misc":{"total": 21.17, "avg": 0.17, "max": 0.11, "min": 0.34, "cnt": 128}, "fwd-MLP":{"total": 1704.96, "avg": 13.32, "max": 9.92, "min": 30.25, "cnt": 128}, "MoE_L0_fwd":{"total": 510.66, "avg": 15.96, "max": 12.22, "min": 30.14, "cnt": 32}, "MoEMLP":{"total": 1687.48, "avg": 13.18, "max": 9.80, "min": 30.09, "cnt": 128}, "MoE_L1_fwd":{"total": 461.92, "avg": 14.43, "max": 12.81, "min": 20.95, "cnt": 32}, "MoE_L2_fwd":{"total": 367.21, "avg": 11.48, "max": 10.75, "min": 15.21, "cnt": 32}, "MoE_L3_fwd":{"total": 354.16, "avg": 11.07, "max": 9.85, "min": 16.40, "cnt": 32}, "fwd-pooler":{"total": 0.37, "avg": 0.01, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 0.72, "avg": 0.72, "max": 0.72, "min": 0.72, "cnt": 1}, "forward-send-backward-recv":{"total": 1135.21, "avg": 36.62, "max": 0.89, "min": 231.46, "cnt": 31}, "backward-compute":{"total": 1795.84, "avg": 56.12, "max": 52.16, "min": 61.10, "cnt": 32}, "MoE_L3_bwd":{"total": 392.52, "avg": 12.27, "max": 10.93, "min": 18.66, "cnt": 32}, "MoE_L2_bwd":{"total": 378.25, "avg": 11.82, "max": 10.54, "min": 13.10, "cnt": 32}, "MoE_L1_bwd":{"total": 473.08, "avg": 14.78, "max": 14.18, "min": 15.23, "cnt": 32}, "MoE_L0_bwd":{"total": 336.05, "avg": 10.50, "max": 9.81, "min": 11.31, "cnt": 32}, "backward-send-forward-recv":{"total": 1741.06, "avg": 58.04, "max": 1.00, "min": 443.87, "cnt": 30}, "backward-send":{"total": 0.97, "avg": 0.48, "max": 0.44, "min": 0.53, "cnt": 2}, "backward-recv":{"total": 68.74, "avg": 68.74, "max": 68.74, "min": 68.74, "cnt": 1}, "backward-params-all-reduce":{"total": 488.66, "avg": 488.66, "max": 488.66, "min": 488.66, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.04, "avg": 0.04, "max": 0.04, "min": 0.04, "cnt": 1}, "optimizer":{"total": 299.96, "avg": 299.96, "max": 299.96, "min": 299.96, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.40, "avg": 3.40, "max": 3.40, "min": 3.40, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 259.86, "avg": 259.86, "max": 259.86, "min": 259.86, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.50, "avg": 3.50, "max": 3.50, "min": 3.50, "cnt": 1}}}
{"type":"time", "iteration": 83, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 133.30, "avg": 66.65, "max": 3.88, "min": 129.42, "cnt": 2}, "forward-compute":{"total": 1880.79, "avg": 58.77, "max": 54.12, "min": 66.61, "cnt": 32}, "fwd-compute":{"total": 1877.64, "avg": 58.68, "max": 54.05, "min": 66.51, "cnt": 32}, "batch-generator":{"total": 38.96, "avg": 1.22, "max": 0.72, "min": 2.07, "cnt": 32}, "fwd-embedding":{"total": 0.66, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1826.27, "avg": 57.07, "max": 52.31, "min": 65.09, "cnt": 32}, "fwd-layernorm":{"total": 9.62, "avg": 0.08, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 108.74, "avg": 0.85, "max": 0.74, "min": 1.78, "cnt": 128}, "fwd-misc":{"total": 20.65, "avg": 0.16, "max": 0.11, "min": 0.33, "cnt": 128}, "fwd-MLP":{"total": 1666.57, "avg": 13.02, "max": 10.15, "min": 19.41, "cnt": 128}, "MoE_L0_fwd":{"total": 479.00, "avg": 14.97, "max": 12.00, "min": 19.32, "cnt": 32}, "MoEMLP":{"total": 1649.51, "avg": 12.89, "max": 10.04, "min": 19.26, "cnt": 128}, "MoE_L1_fwd":{"total": 452.07, "avg": 14.13, "max": 13.09, "min": 17.30, "cnt": 32}, "MoE_L2_fwd":{"total": 376.81, "avg": 11.78, "max": 10.90, "min": 16.24, "cnt": 32}, "MoE_L3_fwd":{"total": 347.94, "avg": 10.87, "max": 10.09, "min": 15.44, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 0.86, "avg": 0.86, "max": 0.86, "min": 0.86, "cnt": 1}, "forward-send-backward-recv":{"total": 944.66, "avg": 30.47, "max": 1.18, "min": 172.98, "cnt": 31}, "backward-compute":{"total": 1794.07, "avg": 56.06, "max": 53.15, "min": 60.81, "cnt": 32}, "MoE_L3_bwd":{"total": 384.35, "avg": 12.01, "max": 10.72, "min": 14.10, "cnt": 32}, "MoE_L2_bwd":{"total": 394.90, "avg": 12.34, "max": 11.52, "min": 16.13, "cnt": 32}, "MoE_L1_bwd":{"total": 474.86, "avg": 14.84, "max": 14.20, "min": 15.77, "cnt": 32}, "MoE_L0_bwd":{"total": 323.95, "avg": 10.12, "max": 9.54, "min": 11.61, "cnt": 32}, "backward-send-forward-recv":{"total": 2062.81, "avg": 68.76, "max": 1.10, "min": 329.71, "cnt": 30}, "backward-send":{"total": 1.38, "avg": 0.69, "max": 0.58, "min": 0.80, "cnt": 2}, "backward-recv":{"total": 72.98, "avg": 72.98, "max": 72.98, "min": 72.98, "cnt": 1}, "backward-params-all-reduce":{"total": 491.97, "avg": 491.97, "max": 491.97, "min": 491.97, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 291.78, "avg": 291.78, "max": 291.78, "min": 291.78, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 251.94, "avg": 251.94, "max": 251.94, "min": 251.94, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.29, "avg": 3.29, "max": 3.29, "min": 3.29, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 84, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 137.66, "avg": 68.83, "max": 0.70, "min": 136.96, "cnt": 2}, "forward-compute":{"total": 1891.60, "avg": 59.11, "max": 53.28, "min": 64.95, "cnt": 32}, "fwd-compute":{"total": 1888.51, "avg": 59.02, "max": 53.20, "min": 64.83, "cnt": 32}, "batch-generator":{"total": 40.70, "avg": 1.27, "max": 0.61, "min": 2.19, "cnt": 32}, "fwd-embedding":{"total": 0.68, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1835.66, "avg": 57.36, "max": 51.94, "min": 63.02, "cnt": 32}, "fwd-layernorm":{"total": 10.05, "avg": 0.08, "max": 0.05, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 110.64, "avg": 0.86, "max": 0.75, "min": 1.55, "cnt": 128}, "fwd-misc":{"total": 21.47, "avg": 0.17, "max": 0.11, "min": 0.38, "cnt": 128}, "fwd-MLP":{"total": 1672.08, "avg": 13.06, "max": 9.94, "min": 20.57, "cnt": 128}, "MoE_L0_fwd":{"total": 474.91, "avg": 14.84, "max": 11.45, "min": 20.48, "cnt": 32}, "MoEMLP":{"total": 1654.93, "avg": 12.93, "max": 9.84, "min": 20.44, "cnt": 128}, "MoE_L1_fwd":{"total": 461.17, "avg": 14.41, "max": 13.40, "min": 16.77, "cnt": 32}, "MoE_L2_fwd":{"total": 383.89, "avg": 12.00, "max": 11.44, "min": 14.36, "cnt": 32}, "MoE_L3_fwd":{"total": 341.31, "avg": 10.67, "max": 9.88, "min": 12.88, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.56, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 0.71, "avg": 0.71, "max": 0.71, "min": 0.71, "cnt": 1}, "forward-send-backward-recv":{"total": 553.94, "avg": 17.87, "max": 0.95, "min": 195.00, "cnt": 31}, "backward-compute":{"total": 1814.77, "avg": 56.71, "max": 54.69, "min": 62.68, "cnt": 32}, "MoE_L3_bwd":{"total": 398.13, "avg": 12.44, "max": 10.90, "min": 17.11, "cnt": 32}, "MoE_L2_bwd":{"total": 398.73, "avg": 12.46, "max": 11.81, "min": 14.17, "cnt": 32}, "MoE_L1_bwd":{"total": 482.26, "avg": 15.07, "max": 14.81, "min": 15.37, "cnt": 32}, "MoE_L0_bwd":{"total": 320.09, "avg": 10.00, "max": 9.60, "min": 10.66, "cnt": 32}, "backward-send-forward-recv":{"total": 3288.40, "avg": 109.61, "max": 1.49, "min": 385.28, "cnt": 30}, "backward-send":{"total": 1.81, "avg": 0.91, "max": 0.74, "min": 1.07, "cnt": 2}, "backward-recv":{"total": 310.47, "avg": 310.47, "max": 310.47, "min": 310.47, "cnt": 1}, "backward-params-all-reduce":{"total": 492.90, "avg": 492.90, "max": 492.90, "min": 492.90, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 296.21, "avg": 296.21, "max": 296.21, "min": 296.21, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 255.98, "avg": 255.98, "max": 255.98, "min": 255.98, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.58, "avg": 3.58, "max": 3.58, "min": 3.58, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.50, "avg": 3.50, "max": 3.50, "min": 3.50, "cnt": 1}}}
{"type":"time", "iteration": 85, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 137.80, "avg": 68.90, "max": 3.70, "min": 134.10, "cnt": 2}, "forward-compute":{"total": 1915.08, "avg": 59.85, "max": 52.98, "min": 73.86, "cnt": 32}, "fwd-compute":{"total": 1912.04, "avg": 59.75, "max": 52.90, "min": 73.78, "cnt": 32}, "batch-generator":{"total": 43.49, "avg": 1.36, "max": 0.78, "min": 4.18, "cnt": 32}, "fwd-embedding":{"total": 0.61, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1854.87, "avg": 57.96, "max": 51.55, "min": 72.57, "cnt": 32}, "fwd-layernorm":{"total": 9.90, "avg": 0.08, "max": 0.05, "min": 0.29, "cnt": 128}, "fwd-attn":{"total": 109.62, "avg": 0.86, "max": 0.74, "min": 2.36, "cnt": 128}, "fwd-misc":{"total": 23.11, "avg": 0.18, "max": 0.11, "min": 2.61, "cnt": 128}, "fwd-MLP":{"total": 1691.01, "avg": 13.21, "max": 9.82, "min": 24.19, "cnt": 128}, "MoE_L0_fwd":{"total": 483.54, "avg": 15.11, "max": 11.12, "min": 24.10, "cnt": 32}, "MoEMLP":{"total": 1674.14, "avg": 13.08, "max": 9.72, "min": 24.05, "cnt": 128}, "MoE_L1_fwd":{"total": 459.09, "avg": 14.35, "max": 13.42, "min": 16.43, "cnt": 32}, "MoE_L2_fwd":{"total": 394.59, "avg": 12.33, "max": 11.16, "min": 17.46, "cnt": 32}, "MoE_L3_fwd":{"total": 343.15, "avg": 10.72, "max": 9.76, "min": 14.52, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.08, "avg": 1.08, "max": 1.08, "min": 1.08, "cnt": 1}, "forward-send-backward-recv":{"total": 314.61, "avg": 10.15, "max": 0.95, "min": 90.49, "cnt": 31}, "backward-compute":{"total": 1804.21, "avg": 56.38, "max": 54.28, "min": 59.89, "cnt": 32}, "MoE_L3_bwd":{"total": 373.63, "avg": 11.68, "max": 10.48, "min": 13.46, "cnt": 32}, "MoE_L2_bwd":{"total": 394.83, "avg": 12.34, "max": 11.55, "min": 13.72, "cnt": 32}, "MoE_L1_bwd":{"total": 492.58, "avg": 15.39, "max": 14.89, "min": 16.08, "cnt": 32}, "MoE_L0_bwd":{"total": 325.57, "avg": 10.17, "max": 9.72, "min": 11.54, "cnt": 32}, "backward-send-forward-recv":{"total": 3345.33, "avg": 111.51, "max": 1.18, "min": 383.75, "cnt": 30}, "backward-send":{"total": 1.98, "avg": 0.99, "max": 0.90, "min": 1.07, "cnt": 2}, "backward-recv":{"total": 144.12, "avg": 144.12, "max": 144.12, "min": 144.12, "cnt": 1}, "backward-params-all-reduce":{"total": 488.20, "avg": 488.20, "max": 488.20, "min": 488.20, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 296.13, "avg": 296.13, "max": 296.13, "min": 296.13, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 256.34, "avg": 256.34, "max": 256.34, "min": 256.34, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.36, "avg": 3.36, "max": 3.36, "min": 3.36, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 86, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 137.14, "avg": 68.57, "max": 1.20, "min": 135.94, "cnt": 2}, "forward-compute":{"total": 1883.56, "avg": 58.86, "max": 51.50, "min": 63.13, "cnt": 32}, "fwd-compute":{"total": 1880.20, "avg": 58.76, "max": 51.42, "min": 63.00, "cnt": 32}, "batch-generator":{"total": 41.07, "avg": 1.28, "max": 0.76, "min": 1.76, "cnt": 32}, "fwd-embedding":{"total": 0.63, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1826.83, "avg": 57.09, "max": 50.25, "min": 61.19, "cnt": 32}, "fwd-layernorm":{"total": 9.80, "avg": 0.08, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 108.42, "avg": 0.85, "max": 0.75, "min": 1.43, "cnt": 128}, "fwd-misc":{"total": 20.91, "avg": 0.16, "max": 0.11, "min": 0.34, "cnt": 128}, "fwd-MLP":{"total": 1666.71, "avg": 13.02, "max": 10.05, "min": 19.15, "cnt": 128}, "MoE_L0_fwd":{"total": 481.12, "avg": 15.03, "max": 10.79, "min": 19.05, "cnt": 32}, "MoEMLP":{"total": 1649.73, "avg": 12.89, "max": 9.92, "min": 18.99, "cnt": 128}, "MoE_L1_fwd":{"total": 461.21, "avg": 14.41, "max": 13.13, "min": 16.14, "cnt": 32}, "MoE_L2_fwd":{"total": 373.33, "avg": 11.67, "max": 11.09, "min": 12.78, "cnt": 32}, "MoE_L3_fwd":{"total": 340.42, "avg": 10.64, "max": 9.98, "min": 13.29, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.61, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.04, "avg": 1.04, "max": 1.04, "min": 1.04, "cnt": 1}, "forward-send-backward-recv":{"total": 2178.43, "avg": 70.27, "max": 1.00, "min": 312.85, "cnt": 31}, "backward-compute":{"total": 1808.78, "avg": 56.52, "max": 53.34, "min": 60.43, "cnt": 32}, "MoE_L3_bwd":{"total": 385.81, "avg": 12.06, "max": 10.55, "min": 15.60, "cnt": 32}, "MoE_L2_bwd":{"total": 388.23, "avg": 12.13, "max": 10.87, "min": 14.02, "cnt": 32}, "MoE_L1_bwd":{"total": 493.88, "avg": 15.43, "max": 14.80, "min": 17.67, "cnt": 32}, "MoE_L0_bwd":{"total": 320.71, "avg": 10.02, "max": 9.68, "min": 11.08, "cnt": 32}, "backward-send-forward-recv":{"total": 3214.78, "avg": 107.16, "max": 0.98, "min": 556.40, "cnt": 30}, "backward-send":{"total": 0.99, "avg": 0.49, "max": 0.44, "min": 0.54, "cnt": 2}, "backward-recv":{"total": 224.27, "avg": 224.27, "max": 224.27, "min": 224.27, "cnt": 1}, "backward-params-all-reduce":{"total": 488.60, "avg": 488.60, "max": 488.60, "min": 488.60, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 301.42, "avg": 301.42, "max": 301.42, "min": 301.42, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 261.25, "avg": 261.25, "max": 261.25, "min": 261.25, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.61, "avg": 3.61, "max": 3.61, "min": 3.61, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 87, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.10, "avg": 0.10, "max": 0.10, "min": 0.10, "cnt": 1}, "forward-recv":{"total": 136.26, "avg": 68.13, "max": 9.56, "min": 126.70, "cnt": 2}, "forward-compute":{"total": 1954.46, "avg": 61.08, "max": 52.81, "min": 74.48, "cnt": 32}, "fwd-compute":{"total": 1951.27, "avg": 60.98, "max": 52.74, "min": 74.40, "cnt": 32}, "batch-generator":{"total": 39.93, "avg": 1.25, "max": 0.62, "min": 3.20, "cnt": 32}, "fwd-embedding":{"total": 0.61, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1898.71, "avg": 59.33, "max": 51.61, "min": 73.17, "cnt": 32}, "fwd-layernorm":{"total": 9.93, "avg": 0.08, "max": 0.05, "min": 0.27, "cnt": 128}, "fwd-attn":{"total": 110.72, "avg": 0.87, "max": 0.75, "min": 2.35, "cnt": 128}, "fwd-misc":{"total": 21.65, "avg": 0.17, "max": 0.11, "min": 0.44, "cnt": 128}, "fwd-MLP":{"total": 1734.62, "avg": 13.55, "max": 10.92, "min": 24.91, "cnt": 128}, "MoE_L0_fwd":{"total": 501.69, "avg": 15.68, "max": 11.21, "min": 24.84, "cnt": 32}, "MoEMLP":{"total": 1717.08, "avg": 13.41, "max": 10.80, "min": 24.79, "cnt": 128}, "MoE_L1_fwd":{"total": 476.61, "avg": 14.89, "max": 13.48, "min": 17.75, "cnt": 32}, "MoE_L2_fwd":{"total": 374.03, "avg": 11.69, "max": 10.91, "min": 14.39, "cnt": 32}, "MoE_L3_fwd":{"total": 371.29, "avg": 11.60, "max": 10.85, "min": 16.45, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 0.57, "avg": 0.57, "max": 0.57, "min": 0.57, "cnt": 1}, "forward-send-backward-recv":{"total": 1238.89, "avg": 39.96, "max": 1.05, "min": 261.00, "cnt": 31}, "backward-compute":{"total": 1892.03, "avg": 59.13, "max": 55.37, "min": 77.28, "cnt": 32}, "MoE_L3_bwd":{"total": 436.18, "avg": 13.63, "max": 11.27, "min": 32.66, "cnt": 32}, "MoE_L2_bwd":{"total": 384.94, "avg": 12.03, "max": 11.37, "min": 13.16, "cnt": 32}, "MoE_L1_bwd":{"total": 507.46, "avg": 15.86, "max": 15.36, "min": 16.98, "cnt": 32}, "MoE_L0_bwd":{"total": 348.65, "avg": 10.90, "max": 10.14, "min": 11.70, "cnt": 32}, "backward-send-forward-recv":{"total": 3328.63, "avg": 110.95, "max": 1.32, "min": 553.46, "cnt": 30}, "backward-send":{"total": 1.53, "avg": 0.76, "max": 0.49, "min": 1.04, "cnt": 2}, "backward-recv":{"total": 669.76, "avg": 669.76, "max": 669.76, "min": 669.76, "cnt": 1}, "backward-params-all-reduce":{"total": 498.87, "avg": 498.87, "max": 498.87, "min": 498.87, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.04, "avg": 0.04, "max": 0.04, "min": 0.04, "cnt": 1}, "optimizer":{"total": 292.37, "avg": 292.37, "max": 292.37, "min": 292.37, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.40, "avg": 3.40, "max": 3.40, "min": 3.40, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 247.72, "avg": 247.72, "max": 247.72, "min": 247.72, "cnt": 1}, "optimizer-clip-main-grad":{"total": 7.02, "avg": 7.02, "max": 7.02, "min": 7.02, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.53, "avg": 3.53, "max": 3.53, "min": 3.53, "cnt": 1}}}
{"type":"time", "iteration": 88, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 127.17, "avg": 63.58, "max": 1.20, "min": 125.97, "cnt": 2}, "forward-compute":{"total": 1962.91, "avg": 61.34, "max": 54.64, "min": 71.04, "cnt": 32}, "fwd-compute":{"total": 1959.18, "avg": 61.22, "max": 54.57, "min": 70.90, "cnt": 32}, "batch-generator":{"total": 47.77, "avg": 1.49, "max": 0.75, "min": 3.06, "cnt": 32}, "fwd-embedding":{"total": 0.72, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1896.99, "avg": 59.28, "max": 53.49, "min": 68.69, "cnt": 32}, "fwd-layernorm":{"total": 11.33, "avg": 0.09, "max": 0.05, "min": 0.22, "cnt": 128}, "fwd-attn":{"total": 117.01, "avg": 0.91, "max": 0.74, "min": 1.79, "cnt": 128}, "fwd-misc":{"total": 23.47, "avg": 0.18, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1721.52, "avg": 13.45, "max": 10.29, "min": 22.55, "cnt": 128}, "MoE_L0_fwd":{"total": 488.80, "avg": 15.27, "max": 11.78, "min": 18.13, "cnt": 32}, "MoEMLP":{"total": 1702.28, "avg": 13.30, "max": 10.18, "min": 22.37, "cnt": 128}, "MoE_L1_fwd":{"total": 481.85, "avg": 15.06, "max": 13.50, "min": 22.44, "cnt": 32}, "MoE_L2_fwd":{"total": 389.99, "avg": 12.19, "max": 11.30, "min": 16.47, "cnt": 32}, "MoE_L3_fwd":{"total": 348.76, "avg": 10.90, "max": 10.22, "min": 13.47, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.65, "avg": 0.02, "max": 0.02, "min": 0.04, "cnt": 32}, "forward-send":{"total": 1.09, "avg": 1.09, "max": 1.09, "min": 1.09, "cnt": 1}, "forward-send-backward-recv":{"total": 1515.70, "avg": 48.89, "max": 0.88, "min": 183.10, "cnt": 31}, "backward-compute":{"total": 1801.16, "avg": 56.29, "max": 53.45, "min": 58.99, "cnt": 32}, "MoE_L3_bwd":{"total": 373.66, "avg": 11.68, "max": 10.25, "min": 13.44, "cnt": 32}, "MoE_L2_bwd":{"total": 382.20, "avg": 11.94, "max": 10.78, "min": 13.04, "cnt": 32}, "MoE_L1_bwd":{"total": 495.23, "avg": 15.48, "max": 14.60, "min": 16.66, "cnt": 32}, "MoE_L0_bwd":{"total": 330.93, "avg": 10.34, "max": 9.85, "min": 11.85, "cnt": 32}, "backward-send-forward-recv":{"total": 1961.54, "avg": 65.38, "max": 1.36, "min": 580.79, "cnt": 30}, "backward-send":{"total": 1.35, "avg": 0.67, "max": 0.67, "min": 0.68, "cnt": 2}, "backward-recv":{"total": 67.51, "avg": 67.51, "max": 67.51, "min": 67.51, "cnt": 1}, "backward-params-all-reduce":{"total": 493.71, "avg": 493.71, "max": 493.71, "min": 493.71, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.04, "avg": 0.04, "max": 0.04, "min": 0.04, "cnt": 1}, "optimizer":{"total": 310.05, "avg": 310.05, "max": 310.05, "min": 310.05, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.40, "avg": 3.40, "max": 3.40, "min": 3.40, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 270.05, "avg": 270.05, "max": 270.05, "min": 270.05, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.29, "avg": 3.29, "max": 3.29, "min": 3.29, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.51, "avg": 3.51, "max": 3.51, "min": 3.51, "cnt": 1}}}
{"type":"time", "iteration": 89, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.10, "avg": 0.10, "max": 0.10, "min": 0.10, "cnt": 1}, "forward-recv":{"total": 132.20, "avg": 66.10, "max": 1.37, "min": 130.83, "cnt": 2}, "forward-compute":{"total": 1873.22, "avg": 58.54, "max": 51.47, "min": 69.31, "cnt": 32}, "fwd-compute":{"total": 1869.69, "avg": 58.43, "max": 51.39, "min": 69.17, "cnt": 32}, "batch-generator":{"total": 57.15, "avg": 1.79, "max": 0.67, "min": 6.13, "cnt": 32}, "fwd-embedding":{"total": 0.76, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1799.51, "avg": 56.23, "max": 50.33, "min": 66.82, "cnt": 32}, "fwd-layernorm":{"total": 10.63, "avg": 0.08, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 119.36, "avg": 0.93, "max": 0.74, "min": 4.46, "cnt": 128}, "fwd-misc":{"total": 22.23, "avg": 0.17, "max": 0.11, "min": 0.50, "cnt": 128}, "fwd-MLP":{"total": 1625.38, "avg": 12.70, "max": 9.47, "min": 21.24, "cnt": 128}, "MoE_L0_fwd":{"total": 457.88, "avg": 14.31, "max": 10.78, "min": 21.14, "cnt": 32}, "MoEMLP":{"total": 1607.58, "avg": 12.56, "max": 9.36, "min": 21.09, "cnt": 128}, "MoE_L1_fwd":{"total": 450.03, "avg": 14.06, "max": 12.90, "min": 15.60, "cnt": 32}, "MoE_L2_fwd":{"total": 376.34, "avg": 11.76, "max": 11.02, "min": 14.99, "cnt": 32}, "MoE_L3_fwd":{"total": 329.98, "avg": 10.31, "max": 9.40, "min": 14.80, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.62, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 0.87, "avg": 0.87, "max": 0.87, "min": 0.87, "cnt": 1}, "forward-send-backward-recv":{"total": 1458.34, "avg": 47.04, "max": 1.31, "min": 251.33, "cnt": 31}, "backward-compute":{"total": 1728.02, "avg": 54.00, "max": 50.91, "min": 56.13, "cnt": 32}, "MoE_L3_bwd":{"total": 351.98, "avg": 11.00, "max": 10.40, "min": 12.14, "cnt": 32}, "MoE_L2_bwd":{"total": 385.93, "avg": 12.06, "max": 11.20, "min": 13.19, "cnt": 32}, "MoE_L1_bwd":{"total": 458.51, "avg": 14.33, "max": 13.60, "min": 16.05, "cnt": 32}, "MoE_L0_bwd":{"total": 316.61, "avg": 9.89, "max": 9.13, "min": 10.66, "cnt": 32}, "backward-send-forward-recv":{"total": 3376.91, "avg": 112.56, "max": 1.47, "min": 501.03, "cnt": 30}, "backward-send":{"total": 1.57, "avg": 0.78, "max": 0.55, "min": 1.02, "cnt": 2}, "backward-recv":{"total": 72.05, "avg": 72.05, "max": 72.05, "min": 72.05, "cnt": 1}, "backward-params-all-reduce":{"total": 495.21, "avg": 495.21, "max": 495.21, "min": 495.21, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.05, "avg": 0.05, "max": 0.05, "min": 0.05, "cnt": 1}, "optimizer":{"total": 297.25, "avg": 297.25, "max": 297.25, "min": 297.25, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 257.19, "avg": 257.19, "max": 257.19, "min": 257.19, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.48, "avg": 3.48, "max": 3.48, "min": 3.48, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.47, "avg": 3.47, "max": 3.47, "min": 3.47, "cnt": 1}}}
{"type":"time", "iteration": 90, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.11, "avg": 0.11, "max": 0.11, "min": 0.11, "cnt": 1}, "forward-recv":{"total": 126.26, "avg": 63.13, "max": 5.50, "min": 120.76, "cnt": 2}, "forward-compute":{"total": 1839.58, "avg": 57.49, "max": 50.79, "min": 64.93, "cnt": 32}, "fwd-compute":{"total": 1836.74, "avg": 57.40, "max": 50.72, "min": 64.76, "cnt": 32}, "batch-generator":{"total": 44.44, "avg": 1.39, "max": 0.67, "min": 4.20, "cnt": 32}, "fwd-embedding":{"total": 0.53, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1780.49, "avg": 55.64, "max": 49.06, "min": 60.86, "cnt": 32}, "fwd-layernorm":{"total": 9.20, "avg": 0.07, "max": 0.05, "min": 0.26, "cnt": 128}, "fwd-attn":{"total": 108.78, "avg": 0.85, "max": 0.74, "min": 2.85, "cnt": 128}, "fwd-misc":{"total": 20.40, "avg": 0.16, "max": 0.11, "min": 0.46, "cnt": 128}, "fwd-MLP":{"total": 1621.51, "avg": 12.67, "max": 9.54, "min": 20.69, "cnt": 128}, "MoE_L0_fwd":{"total": 476.49, "avg": 14.89, "max": 10.61, "min": 20.54, "cnt": 32}, "MoEMLP":{"total": 1604.96, "avg": 12.54, "max": 9.43, "min": 20.45, "cnt": 128}, "MoE_L1_fwd":{"total": 442.85, "avg": 13.84, "max": 12.67, "min": 15.59, "cnt": 32}, "MoE_L2_fwd":{"total": 373.80, "avg": 11.68, "max": 10.87, "min": 13.06, "cnt": 32}, "MoE_L3_fwd":{"total": 317.97, "avg": 9.94, "max": 9.47, "min": 10.47, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.01, "avg": 1.01, "max": 1.01, "min": 1.01, "cnt": 1}, "forward-send-backward-recv":{"total": 363.10, "avg": 11.71, "max": 0.93, "min": 142.58, "cnt": 31}, "backward-compute":{"total": 1739.86, "avg": 54.37, "max": 52.45, "min": 56.25, "cnt": 32}, "MoE_L3_bwd":{"total": 372.29, "avg": 11.63, "max": 10.55, "min": 13.16, "cnt": 32}, "MoE_L2_bwd":{"total": 390.04, "avg": 12.19, "max": 11.59, "min": 13.46, "cnt": 32}, "MoE_L1_bwd":{"total": 435.47, "avg": 13.61, "max": 13.31, "min": 14.50, "cnt": 32}, "MoE_L0_bwd":{"total": 325.53, "avg": 10.17, "max": 9.53, "min": 11.08, "cnt": 32}, "backward-send-forward-recv":{"total": 4389.59, "avg": 146.32, "max": 0.98, "min": 587.53, "cnt": 30}, "backward-send":{"total": 1.15, "avg": 0.58, "max": 0.57, "min": 0.58, "cnt": 2}, "backward-recv":{"total": 257.55, "avg": 257.55, "max": 257.55, "min": 257.55, "cnt": 1}, "backward-params-all-reduce":{"total": 488.78, "avg": 488.78, "max": 488.78, "min": 488.78, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 306.37, "avg": 306.37, "max": 306.37, "min": 306.37, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 265.57, "avg": 265.57, "max": 265.57, "min": 265.57, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.98, "avg": 3.98, "max": 3.98, "min": 3.98, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.54, "avg": 3.54, "max": 3.54, "min": 3.54, "cnt": 1}}}
{"type":"time", "iteration": 91, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 136.39, "avg": 68.20, "max": 3.37, "min": 133.03, "cnt": 2}, "forward-compute":{"total": 1895.21, "avg": 59.23, "max": 52.40, "min": 64.45, "cnt": 32}, "fwd-compute":{"total": 1891.63, "avg": 59.11, "max": 52.33, "min": 64.37, "cnt": 32}, "batch-generator":{"total": 45.63, "avg": 1.43, "max": 0.72, "min": 2.22, "cnt": 32}, "fwd-embedding":{"total": 0.88, "avg": 0.03, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1832.09, "avg": 57.25, "max": 51.31, "min": 63.04, "cnt": 32}, "fwd-layernorm":{"total": 11.24, "avg": 0.09, "max": 0.05, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 117.99, "avg": 0.92, "max": 0.74, "min": 1.57, "cnt": 128}, "fwd-misc":{"total": 23.39, "avg": 0.18, "max": 0.11, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1656.04, "avg": 12.94, "max": 9.45, "min": 19.56, "cnt": 128}, "MoE_L0_fwd":{"total": 505.52, "avg": 15.80, "max": 11.97, "min": 19.48, "cnt": 32}, "MoEMLP":{"total": 1636.79, "avg": 12.79, "max": 9.34, "min": 19.43, "cnt": 128}, "MoE_L1_fwd":{"total": 443.86, "avg": 13.87, "max": 12.93, "min": 15.42, "cnt": 32}, "MoE_L2_fwd":{"total": 372.19, "avg": 11.63, "max": 11.20, "min": 13.85, "cnt": 32}, "MoE_L3_fwd":{"total": 322.26, "avg": 10.07, "max": 9.38, "min": 14.03, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 0.67, "avg": 0.67, "max": 0.67, "min": 0.67, "cnt": 1}, "forward-send-backward-recv":{"total": 3383.46, "avg": 109.14, "max": 1.13, "min": 928.27, "cnt": 31}, "backward-compute":{"total": 1768.19, "avg": 55.26, "max": 51.76, "min": 57.17, "cnt": 32}, "MoE_L3_bwd":{"total": 370.80, "avg": 11.59, "max": 10.32, "min": 13.36, "cnt": 32}, "MoE_L2_bwd":{"total": 408.81, "avg": 12.78, "max": 11.68, "min": 13.74, "cnt": 32}, "MoE_L1_bwd":{"total": 443.69, "avg": 13.87, "max": 13.36, "min": 14.50, "cnt": 32}, "MoE_L0_bwd":{"total": 327.92, "avg": 10.25, "max": 9.51, "min": 11.09, "cnt": 32}, "backward-send-forward-recv":{"total": 434.44, "avg": 14.48, "max": 0.90, "min": 251.40, "cnt": 30}, "backward-send":{"total": 1.77, "avg": 0.89, "max": 0.69, "min": 1.09, "cnt": 2}, "backward-recv":{"total": 69.19, "avg": 69.19, "max": 69.19, "min": 69.19, "cnt": 1}, "backward-params-all-reduce":{"total": 487.98, "avg": 487.98, "max": 487.98, "min": 487.98, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 304.71, "avg": 304.71, "max": 304.71, "min": 304.71, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 258.52, "avg": 258.52, "max": 258.52, "min": 258.52, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.96, "avg": 3.96, "max": 3.96, "min": 3.96, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.54, "avg": 3.54, "max": 3.54, "min": 3.54, "cnt": 1}}}
{"type":"time", "iteration": 92, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 138.24, "avg": 69.12, "max": 7.48, "min": 130.75, "cnt": 2}, "forward-compute":{"total": 1805.33, "avg": 56.42, "max": 51.45, "min": 61.41, "cnt": 32}, "fwd-compute":{"total": 1802.36, "avg": 56.32, "max": 51.37, "min": 61.33, "cnt": 32}, "batch-generator":{"total": 47.90, "avg": 1.50, "max": 0.67, "min": 3.92, "cnt": 32}, "fwd-embedding":{"total": 0.59, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1742.41, "avg": 54.45, "max": 50.29, "min": 58.65, "cnt": 32}, "fwd-layernorm":{"total": 9.38, "avg": 0.07, "max": 0.05, "min": 0.18, "cnt": 128}, "fwd-attn":{"total": 109.37, "avg": 0.85, "max": 0.75, "min": 2.88, "cnt": 128}, "fwd-misc":{"total": 20.73, "avg": 0.16, "max": 0.11, "min": 0.43, "cnt": 128}, "fwd-MLP":{"total": 1582.37, "avg": 12.36, "max": 9.33, "min": 18.23, "cnt": 128}, "MoE_L0_fwd":{"total": 456.36, "avg": 14.26, "max": 11.71, "min": 18.15, "cnt": 32}, "MoEMLP":{"total": 1565.44, "avg": 12.23, "max": 9.22, "min": 18.11, "cnt": 128}, "MoE_L1_fwd":{"total": 439.14, "avg": 13.72, "max": 12.37, "min": 15.60, "cnt": 32}, "MoE_L2_fwd":{"total": 359.36, "avg": 11.23, "max": 10.70, "min": 13.42, "cnt": 32}, "MoE_L3_fwd":{"total": 316.88, "avg": 9.90, "max": 9.26, "min": 12.04, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 0.70, "avg": 0.70, "max": 0.70, "min": 0.70, "cnt": 1}, "forward-send-backward-recv":{"total": 192.77, "avg": 6.22, "max": 0.94, "min": 52.25, "cnt": 31}, "backward-compute":{"total": 1728.62, "avg": 54.02, "max": 50.61, "min": 56.90, "cnt": 32}, "MoE_L3_bwd":{"total": 363.30, "avg": 11.35, "max": 10.21, "min": 14.49, "cnt": 32}, "MoE_L2_bwd":{"total": 375.50, "avg": 11.73, "max": 10.98, "min": 13.23, "cnt": 32}, "MoE_L1_bwd":{"total": 437.96, "avg": 13.69, "max": 12.93, "min": 14.22, "cnt": 32}, "MoE_L0_bwd":{"total": 332.91, "avg": 10.40, "max": 9.80, "min": 11.02, "cnt": 32}, "backward-send-forward-recv":{"total": 3414.22, "avg": 113.81, "max": 2.11, "min": 503.57, "cnt": 30}, "backward-send":{"total": 1.19, "avg": 0.60, "max": 0.48, "min": 0.72, "cnt": 2}, "backward-recv":{"total": 71.46, "avg": 71.46, "max": 71.46, "min": 71.46, "cnt": 1}, "backward-params-all-reduce":{"total": 491.71, "avg": 491.71, "max": 491.71, "min": 491.71, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.04, "avg": 0.04, "max": 0.04, "min": 0.04, "cnt": 1}, "optimizer":{"total": 294.66, "avg": 294.66, "max": 294.66, "min": 294.66, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 253.91, "avg": 253.91, "max": 253.91, "min": 253.91, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.89, "avg": 3.89, "max": 3.89, "min": 3.89, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.54, "avg": 3.54, "max": 3.54, "min": 3.54, "cnt": 1}}}
{"type":"time", "iteration": 93, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 130.92, "avg": 65.46, "max": 0.69, "min": 130.23, "cnt": 2}, "forward-compute":{"total": 1817.75, "avg": 56.80, "max": 50.22, "min": 63.83, "cnt": 32}, "fwd-compute":{"total": 1814.60, "avg": 56.71, "max": 50.15, "min": 63.75, "cnt": 32}, "batch-generator":{"total": 45.96, "avg": 1.44, "max": 0.67, "min": 5.40, "cnt": 32}, "fwd-embedding":{"total": 0.56, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1756.63, "avg": 54.89, "max": 48.04, "min": 62.07, "cnt": 32}, "fwd-layernorm":{"total": 9.27, "avg": 0.07, "max": 0.05, "min": 0.28, "cnt": 128}, "fwd-attn":{"total": 108.15, "avg": 0.84, "max": 0.74, "min": 2.37, "cnt": 128}, "fwd-misc":{"total": 20.24, "avg": 0.16, "max": 0.11, "min": 0.47, "cnt": 128}, "fwd-MLP":{"total": 1598.55, "avg": 12.49, "max": 9.13, "min": 22.37, "cnt": 128}, "MoE_L0_fwd":{"total": 479.43, "avg": 14.98, "max": 10.65, "min": 22.29, "cnt": 32}, "MoEMLP":{"total": 1581.92, "avg": 12.36, "max": 9.02, "min": 22.25, "cnt": 128}, "MoE_L1_fwd":{"total": 450.74, "avg": 14.09, "max": 12.66, "min": 15.88, "cnt": 32}, "MoE_L2_fwd":{"total": 348.30, "avg": 10.88, "max": 10.16, "min": 12.39, "cnt": 32}, "MoE_L3_fwd":{"total": 309.50, "avg": 9.67, "max": 9.06, "min": 10.82, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 0.60, "avg": 0.60, "max": 0.60, "min": 0.60, "cnt": 1}, "forward-send-backward-recv":{"total": 248.35, "avg": 8.01, "max": 0.95, "min": 65.48, "cnt": 31}, "backward-compute":{"total": 1685.31, "avg": 52.67, "max": 50.50, "min": 55.00, "cnt": 32}, "MoE_L3_bwd":{"total": 346.93, "avg": 10.84, "max": 9.41, "min": 12.31, "cnt": 32}, "MoE_L2_bwd":{"total": 353.32, "avg": 11.04, "max": 10.44, "min": 11.61, "cnt": 32}, "MoE_L1_bwd":{"total": 439.82, "avg": 13.74, "max": 13.11, "min": 14.33, "cnt": 32}, "MoE_L0_bwd":{"total": 329.49, "avg": 10.30, "max": 9.77, "min": 11.63, "cnt": 32}, "backward-send-forward-recv":{"total": 4776.42, "avg": 159.21, "max": 1.56, "min": 660.21, "cnt": 30}, "backward-send":{"total": 1.54, "avg": 0.77, "max": 0.55, "min": 1.00, "cnt": 2}, "backward-recv":{"total": 73.36, "avg": 73.36, "max": 73.36, "min": 73.36, "cnt": 1}, "backward-params-all-reduce":{"total": 486.35, "avg": 486.35, "max": 486.35, "min": 486.35, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 291.53, "avg": 291.53, "max": 291.53, "min": 291.53, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 251.71, "avg": 251.71, "max": 251.71, "min": 251.71, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.36, "avg": 3.36, "max": 3.36, "min": 3.36, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.48, "avg": 3.48, "max": 3.48, "min": 3.48, "cnt": 1}}}
{"type":"time", "iteration": 94, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 143.65, "avg": 71.82, "max": 0.97, "min": 142.67, "cnt": 2}, "forward-compute":{"total": 1835.16, "avg": 57.35, "max": 51.82, "min": 63.57, "cnt": 32}, "fwd-compute":{"total": 1831.83, "avg": 57.24, "max": 51.75, "min": 63.43, "cnt": 32}, "batch-generator":{"total": 38.74, "avg": 1.21, "max": 0.69, "min": 2.34, "cnt": 32}, "fwd-embedding":{"total": 0.64, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1780.90, "avg": 55.65, "max": 50.03, "min": 61.45, "cnt": 32}, "fwd-layernorm":{"total": 9.58, "avg": 0.07, "max": 0.05, "min": 0.23, "cnt": 128}, "fwd-attn":{"total": 109.13, "avg": 0.85, "max": 0.74, "min": 2.01, "cnt": 128}, "fwd-misc":{"total": 22.89, "avg": 0.18, "max": 0.11, "min": 2.08, "cnt": 128}, "fwd-MLP":{"total": 1618.65, "avg": 12.65, "max": 9.18, "min": 20.00, "cnt": 128}, "MoE_L0_fwd":{"total": 479.16, "avg": 14.97, "max": 10.76, "min": 19.88, "cnt": 32}, "MoEMLP":{"total": 1601.49, "avg": 12.51, "max": 9.06, "min": 19.83, "cnt": 128}, "MoE_L1_fwd":{"total": 460.76, "avg": 14.40, "max": 12.50, "min": 17.68, "cnt": 32}, "MoE_L2_fwd":{"total": 359.78, "avg": 11.24, "max": 10.43, "min": 13.20, "cnt": 32}, "MoE_L3_fwd":{"total": 308.10, "avg": 9.63, "max": 9.10, "min": 11.99, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 0.58, "avg": 0.58, "max": 0.58, "min": 0.58, "cnt": 1}, "forward-send-backward-recv":{"total": 1961.57, "avg": 63.28, "max": 1.23, "min": 449.22, "cnt": 31}, "backward-compute":{"total": 1718.75, "avg": 53.71, "max": 50.56, "min": 57.73, "cnt": 32}, "MoE_L3_bwd":{"total": 341.52, "avg": 10.67, "max": 9.87, "min": 12.73, "cnt": 32}, "MoE_L2_bwd":{"total": 364.93, "avg": 11.40, "max": 10.67, "min": 11.79, "cnt": 32}, "MoE_L1_bwd":{"total": 442.82, "avg": 13.84, "max": 13.20, "min": 14.44, "cnt": 32}, "MoE_L0_bwd":{"total": 344.79, "avg": 10.77, "max": 10.12, "min": 11.43, "cnt": 32}, "backward-send-forward-recv":{"total": 2064.79, "avg": 68.83, "max": 0.95, "min": 311.84, "cnt": 30}, "backward-send":{"total": 2.03, "avg": 1.01, "max": 1.01, "min": 1.02, "cnt": 2}, "backward-recv":{"total": 99.29, "avg": 99.29, "max": 99.29, "min": 99.29, "cnt": 1}, "backward-params-all-reduce":{"total": 491.45, "avg": 491.45, "max": 491.45, "min": 491.45, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 297.87, "avg": 297.87, "max": 297.87, "min": 297.87, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 257.97, "avg": 257.97, "max": 257.97, "min": 257.97, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 95, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.12, "avg": 0.12, "max": 0.12, "min": 0.12, "cnt": 1}, "forward-recv":{"total": 136.67, "avg": 68.34, "max": 0.80, "min": 135.87, "cnt": 2}, "forward-compute":{"total": 1788.59, "avg": 55.89, "max": 49.50, "min": 65.10, "cnt": 32}, "fwd-compute":{"total": 1785.46, "avg": 55.80, "max": 49.42, "min": 65.03, "cnt": 32}, "batch-generator":{"total": 38.21, "avg": 1.19, "max": 0.67, "min": 1.92, "cnt": 32}, "fwd-embedding":{"total": 0.60, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1735.01, "avg": 54.22, "max": 48.32, "min": 63.63, "cnt": 32}, "fwd-layernorm":{"total": 9.40, "avg": 0.07, "max": 0.05, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 107.74, "avg": 0.84, "max": 0.74, "min": 1.46, "cnt": 128}, "fwd-misc":{"total": 20.13, "avg": 0.16, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1577.60, "avg": 12.32, "max": 8.90, "min": 24.81, "cnt": 128}, "MoE_L0_fwd":{"total": 469.08, "avg": 14.66, "max": 11.28, "min": 24.71, "cnt": 32}, "MoEMLP":{"total": 1561.17, "avg": 12.20, "max": 8.79, "min": 24.67, "cnt": 128}, "MoE_L1_fwd":{"total": 448.75, "avg": 14.02, "max": 12.42, "min": 15.59, "cnt": 32}, "MoE_L2_fwd":{"total": 343.99, "avg": 10.75, "max": 9.93, "min": 12.03, "cnt": 32}, "MoE_L3_fwd":{"total": 305.46, "avg": 9.55, "max": 8.83, "min": 11.99, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 0.57, "avg": 0.57, "max": 0.57, "min": 0.57, "cnt": 1}, "forward-send-backward-recv":{"total": 835.51, "avg": 26.95, "max": 0.91, "min": 241.27, "cnt": 31}, "backward-compute":{"total": 1688.15, "avg": 52.75, "max": 49.79, "min": 55.28, "cnt": 32}, "MoE_L3_bwd":{"total": 353.43, "avg": 11.04, "max": 9.95, "min": 13.48, "cnt": 32}, "MoE_L2_bwd":{"total": 342.11, "avg": 10.69, "max": 9.80, "min": 13.24, "cnt": 32}, "MoE_L1_bwd":{"total": 439.82, "avg": 13.74, "max": 13.31, "min": 15.20, "cnt": 32}, "MoE_L0_bwd":{"total": 335.33, "avg": 10.48, "max": 9.68, "min": 12.47, "cnt": 32}, "backward-send-forward-recv":{"total": 3488.90, "avg": 116.30, "max": 1.13, "min": 1039.69, "cnt": 30}, "backward-send":{"total": 1.21, "avg": 0.60, "max": 0.43, "min": 0.78, "cnt": 2}, "backward-recv":{"total": 162.17, "avg": 162.17, "max": 162.17, "min": 162.17, "cnt": 1}, "backward-params-all-reduce":{"total": 488.60, "avg": 488.60, "max": 488.60, "min": 488.60, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.04, "avg": 0.04, "max": 0.04, "min": 0.04, "cnt": 1}, "optimizer":{"total": 304.33, "avg": 304.33, "max": 304.33, "min": 304.33, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 264.35, "avg": 264.35, "max": 264.35, "min": 264.35, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.28, "avg": 3.28, "max": 3.28, "min": 3.28, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.51, "avg": 3.51, "max": 3.51, "min": 3.51, "cnt": 1}}}
{"type":"time", "iteration": 96, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 127.84, "avg": 63.92, "max": 0.67, "min": 127.18, "cnt": 2}, "forward-compute":{"total": 1854.22, "avg": 57.94, "max": 51.42, "min": 67.38, "cnt": 32}, "fwd-compute":{"total": 1850.76, "avg": 57.84, "max": 51.35, "min": 67.30, "cnt": 32}, "batch-generator":{"total": 56.22, "avg": 1.76, "max": 0.69, "min": 3.90, "cnt": 32}, "fwd-embedding":{"total": 0.67, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1782.01, "avg": 55.69, "max": 49.25, "min": 65.11, "cnt": 32}, "fwd-layernorm":{"total": 10.17, "avg": 0.08, "max": 0.05, "min": 0.30, "cnt": 128}, "fwd-attn":{"total": 112.11, "avg": 0.88, "max": 0.74, "min": 2.45, "cnt": 128}, "fwd-misc":{"total": 21.57, "avg": 0.17, "max": 0.11, "min": 0.46, "cnt": 128}, "fwd-MLP":{"total": 1617.20, "avg": 12.63, "max": 9.14, "min": 25.99, "cnt": 128}, "MoE_L0_fwd":{"total": 499.71, "avg": 15.62, "max": 11.25, "min": 25.91, "cnt": 32}, "MoEMLP":{"total": 1600.03, "avg": 12.50, "max": 9.02, "min": 25.87, "cnt": 128}, "MoE_L1_fwd":{"total": 448.79, "avg": 14.02, "max": 12.89, "min": 16.83, "cnt": 32}, "MoE_L2_fwd":{"total": 357.39, "avg": 11.17, "max": 10.48, "min": 13.56, "cnt": 32}, "MoE_L3_fwd":{"total": 300.51, "avg": 9.39, "max": 9.07, "min": 10.56, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.56, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 0.61, "avg": 0.61, "max": 0.61, "min": 0.61, "cnt": 1}, "forward-send-backward-recv":{"total": 235.31, "avg": 7.59, "max": 0.95, "min": 71.98, "cnt": 31}, "backward-compute":{"total": 1699.03, "avg": 53.09, "max": 50.48, "min": 54.64, "cnt": 32}, "MoE_L3_bwd":{"total": 347.86, "avg": 10.87, "max": 9.78, "min": 12.20, "cnt": 32}, "MoE_L2_bwd":{"total": 358.33, "avg": 11.20, "max": 10.79, "min": 11.65, "cnt": 32}, "MoE_L1_bwd":{"total": 436.27, "avg": 13.63, "max": 13.31, "min": 14.04, "cnt": 32}, "MoE_L0_bwd":{"total": 338.32, "avg": 10.57, "max": 9.86, "min": 11.64, "cnt": 32}, "backward-send-forward-recv":{"total": 7040.60, "avg": 234.69, "max": 1.36, "min": 1105.14, "cnt": 30}, "backward-send":{"total": 1.72, "avg": 0.86, "max": 0.80, "min": 0.92, "cnt": 2}, "backward-recv":{"total": 75.26, "avg": 75.26, "max": 75.26, "min": 75.26, "cnt": 1}, "backward-params-all-reduce":{"total": 491.77, "avg": 491.77, "max": 491.77, "min": 491.77, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 292.92, "avg": 292.92, "max": 292.92, "min": 292.92, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 252.75, "avg": 252.75, "max": 252.75, "min": 252.75, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.59, "avg": 3.59, "max": 3.59, "min": 3.59, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.53, "avg": 3.53, "max": 3.53, "min": 3.53, "cnt": 1}}}
{"type":"time", "iteration": 97, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 140.23, "avg": 70.11, "max": 0.81, "min": 139.42, "cnt": 2}, "forward-compute":{"total": 1818.44, "avg": 56.83, "max": 51.13, "min": 62.76, "cnt": 32}, "fwd-compute":{"total": 1815.29, "avg": 56.73, "max": 51.06, "min": 62.67, "cnt": 32}, "batch-generator":{"total": 49.41, "avg": 1.54, "max": 0.68, "min": 4.33, "cnt": 32}, "fwd-embedding":{"total": 0.65, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1753.63, "avg": 54.80, "max": 50.01, "min": 60.37, "cnt": 32}, "fwd-layernorm":{"total": 9.75, "avg": 0.08, "max": 0.05, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 110.65, "avg": 0.86, "max": 0.74, "min": 2.82, "cnt": 128}, "fwd-misc":{"total": 20.80, "avg": 0.16, "max": 0.11, "min": 0.40, "cnt": 128}, "fwd-MLP":{"total": 1591.58, "avg": 12.43, "max": 9.36, "min": 20.24, "cnt": 128}, "MoE_L0_fwd":{"total": 463.45, "avg": 14.48, "max": 11.23, "min": 20.16, "cnt": 32}, "MoEMLP":{"total": 1574.77, "avg": 12.30, "max": 9.24, "min": 20.11, "cnt": 128}, "MoE_L1_fwd":{"total": 440.49, "avg": 13.77, "max": 12.32, "min": 18.55, "cnt": 32}, "MoE_L2_fwd":{"total": 364.44, "avg": 11.39, "max": 10.79, "min": 13.50, "cnt": 32}, "MoE_L3_fwd":{"total": 312.70, "avg": 9.77, "max": 9.29, "min": 12.81, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 0.64, "avg": 0.64, "max": 0.64, "min": 0.64, "cnt": 1}, "forward-send-backward-recv":{"total": 1083.37, "avg": 34.95, "max": 1.03, "min": 290.83, "cnt": 31}, "backward-compute":{"total": 1747.12, "avg": 54.60, "max": 51.38, "min": 58.35, "cnt": 32}, "MoE_L3_bwd":{"total": 348.23, "avg": 10.88, "max": 9.46, "min": 12.99, "cnt": 32}, "MoE_L2_bwd":{"total": 383.02, "avg": 11.97, "max": 11.02, "min": 14.83, "cnt": 32}, "MoE_L1_bwd":{"total": 444.60, "avg": 13.89, "max": 13.19, "min": 15.32, "cnt": 32}, "MoE_L0_bwd":{"total": 354.40, "avg": 11.07, "max": 10.46, "min": 13.25, "cnt": 32}, "backward-send-forward-recv":{"total": 4419.83, "avg": 147.33, "max": 2.26, "min": 829.36, "cnt": 30}, "backward-send":{"total": 1.20, "avg": 0.60, "max": 0.49, "min": 0.71, "cnt": 2}, "backward-recv":{"total": 64.03, "avg": 64.03, "max": 64.03, "min": 64.03, "cnt": 1}, "backward-params-all-reduce":{"total": 490.15, "avg": 490.15, "max": 490.15, "min": 490.15, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.05, "avg": 0.05, "max": 0.05, "min": 0.05, "cnt": 1}, "optimizer":{"total": 297.66, "avg": 297.66, "max": 297.66, "min": 297.66, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 257.44, "avg": 257.44, "max": 257.44, "min": 257.44, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.71, "avg": 3.71, "max": 3.71, "min": 3.71, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.48, "avg": 3.48, "max": 3.48, "min": 3.48, "cnt": 1}}}
{"type":"time", "iteration": 98, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.11, "avg": 0.11, "max": 0.11, "min": 0.11, "cnt": 1}, "forward-recv":{"total": 135.72, "avg": 67.86, "max": 6.77, "min": 128.96, "cnt": 2}, "forward-compute":{"total": 1802.42, "avg": 56.33, "max": 50.95, "min": 67.51, "cnt": 32}, "fwd-compute":{"total": 1799.21, "avg": 56.23, "max": 50.88, "min": 67.43, "cnt": 32}, "batch-generator":{"total": 44.97, "avg": 1.41, "max": 0.73, "min": 3.72, "cnt": 32}, "fwd-embedding":{"total": 0.59, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1742.25, "avg": 54.45, "max": 49.85, "min": 64.99, "cnt": 32}, "fwd-layernorm":{"total": 9.36, "avg": 0.07, "max": 0.05, "min": 0.18, "cnt": 128}, "fwd-attn":{"total": 106.50, "avg": 0.83, "max": 0.74, "min": 1.47, "cnt": 128}, "fwd-misc":{"total": 20.56, "avg": 0.16, "max": 0.11, "min": 0.44, "cnt": 128}, "fwd-MLP":{"total": 1585.34, "avg": 12.39, "max": 9.26, "min": 20.75, "cnt": 128}, "MoE_L0_fwd":{"total": 457.91, "avg": 14.31, "max": 11.06, "min": 20.67, "cnt": 32}, "MoEMLP":{"total": 1568.84, "avg": 12.26, "max": 9.14, "min": 20.63, "cnt": 128}, "MoE_L1_fwd":{"total": 441.47, "avg": 13.80, "max": 12.72, "min": 15.65, "cnt": 32}, "MoE_L2_fwd":{"total": 363.92, "avg": 11.37, "max": 10.67, "min": 19.47, "cnt": 32}, "MoE_L3_fwd":{"total": 311.72, "avg": 9.74, "max": 9.18, "min": 11.23, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 0.57, "avg": 0.57, "max": 0.57, "min": 0.57, "cnt": 1}, "forward-send-backward-recv":{"total": 522.75, "avg": 16.86, "max": 0.91, "min": 108.34, "cnt": 31}, "backward-compute":{"total": 1727.27, "avg": 53.98, "max": 51.37, "min": 58.17, "cnt": 32}, "MoE_L3_bwd":{"total": 355.64, "avg": 11.11, "max": 10.28, "min": 12.04, "cnt": 32}, "MoE_L2_bwd":{"total": 371.42, "avg": 11.61, "max": 10.75, "min": 15.01, "cnt": 32}, "MoE_L1_bwd":{"total": 441.04, "avg": 13.78, "max": 13.24, "min": 14.29, "cnt": 32}, "MoE_L0_bwd":{"total": 340.19, "avg": 10.63, "max": 9.86, "min": 11.69, "cnt": 32}, "backward-send-forward-recv":{"total": 2988.03, "avg": 99.60, "max": 2.01, "min": 314.45, "cnt": 30}, "backward-send":{"total": 1.68, "avg": 0.84, "max": 0.83, "min": 0.85, "cnt": 2}, "backward-recv":{"total": 71.55, "avg": 71.55, "max": 71.55, "min": 71.55, "cnt": 1}, "backward-params-all-reduce":{"total": 490.72, "avg": 490.72, "max": 490.72, "min": 490.72, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.04, "avg": 0.04, "max": 0.04, "min": 0.04, "cnt": 1}, "optimizer":{"total": 297.51, "avg": 297.51, "max": 297.51, "min": 297.51, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 256.94, "avg": 256.94, "max": 256.94, "min": 256.94, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.85, "avg": 3.85, "max": 3.85, "min": 3.85, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.54, "avg": 3.54, "max": 3.54, "min": 3.54, "cnt": 1}}}
{"type":"time", "iteration": 99, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 124.73, "avg": 62.37, "max": 5.01, "min": 119.72, "cnt": 2}, "forward-compute":{"total": 1835.98, "avg": 57.37, "max": 51.58, "min": 62.30, "cnt": 32}, "fwd-compute":{"total": 1832.53, "avg": 57.27, "max": 51.51, "min": 62.17, "cnt": 32}, "batch-generator":{"total": 44.95, "avg": 1.40, "max": 0.67, "min": 3.87, "cnt": 32}, "fwd-embedding":{"total": 0.75, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1774.41, "avg": 55.45, "max": 50.51, "min": 60.19, "cnt": 32}, "fwd-layernorm":{"total": 10.58, "avg": 0.08, "max": 0.05, "min": 0.23, "cnt": 128}, "fwd-attn":{"total": 113.27, "avg": 0.88, "max": 0.74, "min": 2.37, "cnt": 128}, "fwd-misc":{"total": 22.03, "avg": 0.17, "max": 0.11, "min": 0.40, "cnt": 128}, "fwd-MLP":{"total": 1606.63, "avg": 12.55, "max": 8.96, "min": 18.82, "cnt": 128}, "MoE_L0_fwd":{"total": 479.99, "avg": 15.00, "max": 12.06, "min": 18.68, "cnt": 32}, "MoEMLP":{"total": 1588.92, "avg": 12.41, "max": 8.85, "min": 18.57, "cnt": 128}, "MoE_L1_fwd":{"total": 444.37, "avg": 13.89, "max": 12.60, "min": 16.06, "cnt": 32}, "MoE_L2_fwd":{"total": 358.24, "avg": 11.19, "max": 10.47, "min": 13.23, "cnt": 32}, "MoE_L3_fwd":{"total": 312.92, "avg": 9.78, "max": 8.89, "min": 12.11, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 0.55, "avg": 0.55, "max": 0.55, "min": 0.55, "cnt": 1}, "forward-send-backward-recv":{"total": 2262.64, "avg": 72.99, "max": 1.00, "min": 434.51, "cnt": 31}, "backward-compute":{"total": 1695.77, "avg": 52.99, "max": 51.20, "min": 55.73, "cnt": 32}, "MoE_L3_bwd":{"total": 348.97, "avg": 10.91, "max": 9.89, "min": 12.48, "cnt": 32}, "MoE_L2_bwd":{"total": 361.49, "avg": 11.30, "max": 10.72, "min": 12.18, "cnt": 32}, "MoE_L1_bwd":{"total": 428.90, "avg": 13.40, "max": 12.83, "min": 14.27, "cnt": 32}, "MoE_L0_bwd":{"total": 338.53, "avg": 10.58, "max": 10.01, "min": 13.49, "cnt": 32}, "backward-send-forward-recv":{"total": 3154.48, "avg": 105.15, "max": 0.90, "min": 1026.42, "cnt": 30}, "backward-send":{"total": 1.92, "avg": 0.96, "max": 0.90, "min": 1.02, "cnt": 2}, "backward-recv":{"total": 139.95, "avg": 139.95, "max": 139.95, "min": 139.95, "cnt": 1}, "backward-params-all-reduce":{"total": 489.47, "avg": 489.47, "max": 489.47, "min": 489.47, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.04, "avg": 0.04, "max": 0.04, "min": 0.04, "cnt": 1}, "optimizer":{"total": 300.12, "avg": 300.12, "max": 300.12, "min": 300.12, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 260.15, "avg": 260.15, "max": 260.15, "min": 260.15, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.32, "avg": 3.32, "max": 3.32, "min": 3.32, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.48, "avg": 3.48, "max": 3.48, "min": 3.48, "cnt": 1}}}
{"type":"time", "iteration": 100, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 131.13, "avg": 65.56, "max": 1.07, "min": 130.05, "cnt": 2}, "forward-compute":{"total": 1835.98, "avg": 57.37, "max": 51.44, "min": 65.39, "cnt": 32}, "fwd-compute":{"total": 1833.08, "avg": 57.28, "max": 51.36, "min": 65.25, "cnt": 32}, "batch-generator":{"total": 39.41, "avg": 1.23, "max": 0.68, "min": 3.06, "cnt": 32}, "fwd-embedding":{"total": 0.50, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1781.94, "avg": 55.69, "max": 48.91, "min": 61.72, "cnt": 32}, "fwd-layernorm":{"total": 8.90, "avg": 0.07, "max": 0.05, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 104.41, "avg": 0.82, "max": 0.74, "min": 1.54, "cnt": 128}, "fwd-misc":{"total": 19.71, "avg": 0.15, "max": 0.11, "min": 0.42, "cnt": 128}, "fwd-MLP":{"total": 1629.36, "avg": 12.73, "max": 9.18, "min": 20.32, "cnt": 128}, "MoE_L0_fwd":{"total": 485.90, "avg": 15.18, "max": 10.98, "min": 20.21, "cnt": 32}, "MoEMLP":{"total": 1613.41, "avg": 12.60, "max": 9.06, "min": 20.16, "cnt": 128}, "MoE_L1_fwd":{"total": 447.75, "avg": 13.99, "max": 12.29, "min": 16.46, "cnt": 32}, "MoE_L2_fwd":{"total": 362.61, "avg": 11.33, "max": 10.60, "min": 16.14, "cnt": 32}, "MoE_L3_fwd":{"total": 323.05, "avg": 10.10, "max": 9.11, "min": 13.01, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.56, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 0.91, "avg": 0.91, "max": 0.91, "min": 0.91, "cnt": 1}, "forward-send-backward-recv":{"total": 1455.53, "avg": 46.95, "max": 0.85, "min": 685.61, "cnt": 31}, "backward-compute":{"total": 1711.27, "avg": 53.48, "max": 50.28, "min": 55.46, "cnt": 32}, "MoE_L3_bwd":{"total": 346.23, "avg": 10.82, "max": 9.58, "min": 12.57, "cnt": 32}, "MoE_L2_bwd":{"total": 371.58, "avg": 11.61, "max": 10.81, "min": 13.99, "cnt": 32}, "MoE_L1_bwd":{"total": 433.79, "avg": 13.56, "max": 13.14, "min": 14.07, "cnt": 32}, "MoE_L0_bwd":{"total": 340.73, "avg": 10.65, "max": 10.11, "min": 11.67, "cnt": 32}, "backward-send-forward-recv":{"total": 5167.05, "avg": 172.23, "max": 0.90, "min": 635.56, "cnt": 30}, "backward-send":{"total": 1.14, "avg": 0.57, "max": 0.43, "min": 0.72, "cnt": 2}, "backward-recv":{"total": 100.35, "avg": 100.35, "max": 100.35, "min": 100.35, "cnt": 1}, "backward-params-all-reduce":{"total": 487.36, "avg": 487.36, "max": 487.36, "min": 487.36, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 304.93, "avg": 304.93, "max": 304.93, "min": 304.93, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 264.82, "avg": 264.82, "max": 264.82, "min": 264.82, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.55, "avg": 3.55, "max": 3.55, "min": 3.55, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 101, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 133.44, "avg": 66.72, "max": 5.16, "min": 128.29, "cnt": 2}, "forward-compute":{"total": 1868.13, "avg": 58.38, "max": 53.11, "min": 68.24, "cnt": 32}, "fwd-compute":{"total": 1864.95, "avg": 58.28, "max": 53.04, "min": 68.15, "cnt": 32}, "batch-generator":{"total": 45.07, "avg": 1.41, "max": 0.69, "min": 4.65, "cnt": 32}, "fwd-embedding":{"total": 0.57, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1806.94, "avg": 56.47, "max": 51.93, "min": 66.10, "cnt": 32}, "fwd-layernorm":{"total": 9.47, "avg": 0.07, "max": 0.05, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 106.08, "avg": 0.83, "max": 0.74, "min": 1.60, "cnt": 128}, "fwd-misc":{"total": 19.90, "avg": 0.16, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1650.95, "avg": 12.90, "max": 10.17, "min": 19.69, "cnt": 128}, "MoE_L0_fwd":{"total": 461.09, "avg": 14.41, "max": 11.66, "min": 19.61, "cnt": 32}, "MoEMLP":{"total": 1634.40, "avg": 12.77, "max": 10.06, "min": 19.56, "cnt": 128}, "MoE_L1_fwd":{"total": 452.40, "avg": 14.14, "max": 12.83, "min": 18.31, "cnt": 32}, "MoE_L2_fwd":{"total": 379.13, "avg": 11.85, "max": 10.76, "min": 15.70, "cnt": 32}, "MoE_L3_fwd":{"total": 347.91, "avg": 10.87, "max": 10.10, "min": 14.66, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.04, "cnt": 32}, "forward-send":{"total": 0.73, "avg": 0.73, "max": 0.73, "min": 0.73, "cnt": 1}, "forward-send-backward-recv":{"total": 1859.70, "avg": 59.99, "max": 1.39, "min": 647.94, "cnt": 31}, "backward-compute":{"total": 1758.73, "avg": 54.96, "max": 53.60, "min": 58.82, "cnt": 32}, "MoE_L3_bwd":{"total": 376.41, "avg": 11.76, "max": 10.88, "min": 13.55, "cnt": 32}, "MoE_L2_bwd":{"total": 381.38, "avg": 11.92, "max": 11.17, "min": 13.43, "cnt": 32}, "MoE_L1_bwd":{"total": 442.34, "avg": 13.82, "max": 13.14, "min": 16.35, "cnt": 32}, "MoE_L0_bwd":{"total": 340.94, "avg": 10.65, "max": 10.16, "min": 11.52, "cnt": 32}, "backward-send-forward-recv":{"total": 2439.06, "avg": 81.30, "max": 1.12, "min": 599.91, "cnt": 30}, "backward-send":{"total": 1.84, "avg": 0.92, "max": 0.76, "min": 1.08, "cnt": 2}, "backward-recv":{"total": 73.07, "avg": 73.07, "max": 73.07, "min": 73.07, "cnt": 1}, "backward-params-all-reduce":{"total": 501.62, "avg": 501.62, "max": 501.62, "min": 501.62, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.04, "avg": 0.04, "max": 0.04, "min": 0.04, "cnt": 1}, "optimizer":{"total": 290.96, "avg": 290.96, "max": 290.96, "min": 290.96, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.40, "avg": 3.40, "max": 3.40, "min": 3.40, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 250.80, "avg": 250.80, "max": 250.80, "min": 250.80, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.57, "avg": 3.57, "max": 3.57, "min": 3.57, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.47, "avg": 3.47, "max": 3.47, "min": 3.47, "cnt": 1}}}
{"type":"time", "iteration": 102, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 126.45, "avg": 63.23, "max": 2.35, "min": 124.10, "cnt": 2}, "forward-compute":{"total": 1919.02, "avg": 59.97, "max": 55.57, "min": 65.54, "cnt": 32}, "fwd-compute":{"total": 1915.59, "avg": 59.86, "max": 55.48, "min": 65.44, "cnt": 32}, "batch-generator":{"total": 43.63, "avg": 1.36, "max": 0.75, "min": 4.42, "cnt": 32}, "fwd-embedding":{"total": 0.69, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1858.69, "avg": 58.08, "max": 52.54, "min": 63.88, "cnt": 32}, "fwd-layernorm":{"total": 10.13, "avg": 0.08, "max": 0.05, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 108.64, "avg": 0.85, "max": 0.74, "min": 1.53, "cnt": 128}, "fwd-misc":{"total": 21.26, "avg": 0.17, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1696.71, "avg": 13.26, "max": 10.38, "min": 21.55, "cnt": 128}, "MoE_L0_fwd":{"total": 508.14, "avg": 15.88, "max": 11.68, "min": 21.46, "cnt": 32}, "MoEMLP":{"total": 1679.31, "avg": 13.12, "max": 10.27, "min": 21.41, "cnt": 128}, "MoE_L1_fwd":{"total": 460.73, "avg": 14.40, "max": 12.96, "min": 16.36, "cnt": 32}, "MoE_L2_fwd":{"total": 372.10, "avg": 11.63, "max": 10.84, "min": 14.73, "cnt": 32}, "MoE_L3_fwd":{"total": 344.80, "avg": 10.78, "max": 10.31, "min": 11.50, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.61, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 0.98, "avg": 0.98, "max": 0.98, "min": 0.98, "cnt": 1}, "forward-send-backward-recv":{"total": 2550.26, "avg": 82.27, "max": 1.39, "min": 316.09, "cnt": 31}, "backward-compute":{"total": 1768.39, "avg": 55.26, "max": 53.10, "min": 58.41, "cnt": 32}, "MoE_L3_bwd":{"total": 384.17, "avg": 12.01, "max": 10.58, "min": 15.98, "cnt": 32}, "MoE_L2_bwd":{"total": 374.48, "avg": 11.70, "max": 10.99, "min": 13.77, "cnt": 32}, "MoE_L1_bwd":{"total": 437.11, "avg": 13.66, "max": 13.26, "min": 16.24, "cnt": 32}, "MoE_L0_bwd":{"total": 353.00, "avg": 11.03, "max": 10.08, "min": 12.73, "cnt": 32}, "backward-send-forward-recv":{"total": 589.41, "avg": 19.65, "max": 0.93, "min": 174.47, "cnt": 30}, "backward-send":{"total": 1.30, "avg": 0.65, "max": 0.45, "min": 0.85, "cnt": 2}, "backward-recv":{"total": 74.84, "avg": 74.84, "max": 74.84, "min": 74.84, "cnt": 1}, "backward-params-all-reduce":{"total": 486.75, "avg": 486.75, "max": 486.75, "min": 486.75, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 299.87, "avg": 299.87, "max": 299.87, "min": 299.87, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 260.15, "avg": 260.15, "max": 260.15, "min": 260.15, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.28, "avg": 3.28, "max": 3.28, "min": 3.28, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 103, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.11, "avg": 0.11, "max": 0.11, "min": 0.11, "cnt": 1}, "forward-recv":{"total": 133.58, "avg": 66.79, "max": 1.50, "min": 132.08, "cnt": 2}, "forward-compute":{"total": 1906.50, "avg": 59.58, "max": 53.97, "min": 66.49, "cnt": 32}, "fwd-compute":{"total": 1903.09, "avg": 59.47, "max": 53.90, "min": 66.36, "cnt": 32}, "batch-generator":{"total": 45.54, "avg": 1.42, "max": 0.71, "min": 3.44, "cnt": 32}, "fwd-embedding":{"total": 0.66, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1844.67, "avg": 57.65, "max": 52.25, "min": 64.26, "cnt": 32}, "fwd-layernorm":{"total": 9.83, "avg": 0.08, "max": 0.05, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 110.03, "avg": 0.86, "max": 0.74, "min": 1.95, "cnt": 128}, "fwd-misc":{"total": 21.17, "avg": 0.17, "max": 0.11, "min": 0.44, "cnt": 128}, "fwd-MLP":{"total": 1682.53, "avg": 13.14, "max": 10.26, "min": 20.18, "cnt": 128}, "MoE_L0_fwd":{"total": 508.10, "avg": 15.88, "max": 11.98, "min": 20.11, "cnt": 32}, "MoEMLP":{"total": 1665.47, "avg": 13.01, "max": 10.16, "min": 20.06, "cnt": 128}, "MoE_L1_fwd":{"total": 446.92, "avg": 13.97, "max": 12.91, "min": 15.79, "cnt": 32}, "MoE_L2_fwd":{"total": 370.87, "avg": 11.59, "max": 10.81, "min": 12.90, "cnt": 32}, "MoE_L3_fwd":{"total": 345.86, "avg": 10.81, "max": 10.19, "min": 12.99, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.02, "avg": 1.02, "max": 1.02, "min": 1.02, "cnt": 1}, "forward-send-backward-recv":{"total": 677.66, "avg": 21.86, "max": 0.93, "min": 272.92, "cnt": 31}, "backward-compute":{"total": 1795.42, "avg": 56.11, "max": 53.65, "min": 62.96, "cnt": 32}, "MoE_L3_bwd":{"total": 381.04, "avg": 11.91, "max": 11.14, "min": 15.65, "cnt": 32}, "MoE_L2_bwd":{"total": 387.81, "avg": 12.12, "max": 11.00, "min": 14.47, "cnt": 32}, "MoE_L1_bwd":{"total": 437.66, "avg": 13.68, "max": 13.19, "min": 15.66, "cnt": 32}, "MoE_L0_bwd":{"total": 370.77, "avg": 11.59, "max": 10.67, "min": 13.00, "cnt": 32}, "backward-send-forward-recv":{"total": 2572.43, "avg": 85.75, "max": 0.96, "min": 614.99, "cnt": 30}, "backward-send":{"total": 1.87, "avg": 0.93, "max": 0.88, "min": 0.99, "cnt": 2}, "backward-recv":{"total": 70.16, "avg": 70.16, "max": 70.16, "min": 70.16, "cnt": 1}, "backward-params-all-reduce":{"total": 493.72, "avg": 493.72, "max": 493.72, "min": 493.72, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 293.07, "avg": 293.07, "max": 293.07, "min": 293.07, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 253.01, "avg": 253.01, "max": 253.01, "min": 253.01, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.52, "avg": 3.52, "max": 3.52, "min": 3.52, "cnt": 1}}}
{"type":"time", "iteration": 104, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.17, "avg": 0.17, "max": 0.17, "min": 0.17, "cnt": 1}, "forward-recv":{"total": 136.19, "avg": 68.09, "max": 2.32, "min": 133.87, "cnt": 2}, "forward-compute":{"total": 1921.76, "avg": 60.06, "max": 52.95, "min": 71.46, "cnt": 32}, "fwd-compute":{"total": 1918.24, "avg": 59.94, "max": 52.89, "min": 71.37, "cnt": 32}, "batch-generator":{"total": 50.92, "avg": 1.59, "max": 0.67, "min": 3.50, "cnt": 32}, "fwd-embedding":{"total": 0.66, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1854.41, "avg": 57.95, "max": 51.95, "min": 68.89, "cnt": 32}, "fwd-layernorm":{"total": 12.04, "avg": 0.09, "max": 0.05, "min": 2.11, "cnt": 128}, "fwd-attn":{"total": 109.69, "avg": 0.86, "max": 0.74, "min": 2.31, "cnt": 128}, "fwd-misc":{"total": 21.74, "avg": 0.17, "max": 0.11, "min": 0.56, "cnt": 128}, "fwd-MLP":{"total": 1687.76, "avg": 13.19, "max": 10.97, "min": 22.29, "cnt": 128}, "MoE_L0_fwd":{"total": 469.92, "avg": 14.68, "max": 11.47, "min": 22.22, "cnt": 32}, "MoEMLP":{"total": 1670.47, "avg": 13.05, "max": 10.85, "min": 22.16, "cnt": 128}, "MoE_L1_fwd":{"total": 461.50, "avg": 14.42, "max": 13.25, "min": 18.14, "cnt": 32}, "MoE_L2_fwd":{"total": 376.32, "avg": 11.76, "max": 10.95, "min": 14.36, "cnt": 32}, "MoE_L3_fwd":{"total": 369.17, "avg": 11.54, "max": 10.89, "min": 15.41, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 0.44, "avg": 0.44, "max": 0.44, "min": 0.44, "cnt": 1}, "forward-send-backward-recv":{"total": 373.57, "avg": 12.05, "max": 1.18, "min": 83.81, "cnt": 31}, "backward-compute":{"total": 1775.52, "avg": 55.48, "max": 53.13, "min": 60.03, "cnt": 32}, "MoE_L3_bwd":{"total": 395.07, "avg": 12.35, "max": 11.16, "min": 14.32, "cnt": 32}, "MoE_L2_bwd":{"total": 385.21, "avg": 12.04, "max": 10.72, "min": 17.18, "cnt": 32}, "MoE_L1_bwd":{"total": 433.61, "avg": 13.55, "max": 12.58, "min": 15.04, "cnt": 32}, "MoE_L0_bwd":{"total": 341.28, "avg": 10.67, "max": 9.88, "min": 12.68, "cnt": 32}, "backward-send-forward-recv":{"total": 2073.78, "avg": 69.13, "max": 1.44, "min": 325.11, "cnt": 30}, "backward-send":{"total": 1.49, "avg": 0.75, "max": 0.48, "min": 1.02, "cnt": 2}, "backward-recv":{"total": 148.20, "avg": 148.20, "max": 148.20, "min": 148.20, "cnt": 1}, "backward-params-all-reduce":{"total": 503.73, "avg": 503.73, "max": 503.73, "min": 503.73, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.06, "avg": 0.06, "max": 0.06, "min": 0.06, "cnt": 1}, "optimizer":{"total": 290.85, "avg": 290.85, "max": 290.85, "min": 290.85, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.40, "avg": 3.40, "max": 3.40, "min": 3.40, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 245.96, "avg": 245.96, "max": 245.96, "min": 245.96, "cnt": 1}, "optimizer-clip-main-grad":{"total": 7.12, "avg": 7.12, "max": 7.12, "min": 7.12, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.57, "avg": 3.57, "max": 3.57, "min": 3.57, "cnt": 1}}}
{"type":"time", "iteration": 105, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.12, "avg": 0.12, "max": 0.12, "min": 0.12, "cnt": 1}, "forward-recv":{"total": 140.15, "avg": 70.07, "max": 3.78, "min": 136.37, "cnt": 2}, "forward-compute":{"total": 1919.46, "avg": 59.98, "max": 53.93, "min": 68.86, "cnt": 32}, "fwd-compute":{"total": 1916.01, "avg": 59.88, "max": 53.83, "min": 68.77, "cnt": 32}, "batch-generator":{"total": 46.91, "avg": 1.47, "max": 0.65, "min": 4.24, "cnt": 32}, "fwd-embedding":{"total": 0.58, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1855.25, "avg": 57.98, "max": 52.22, "min": 66.60, "cnt": 32}, "fwd-layernorm":{"total": 10.44, "avg": 0.08, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 110.53, "avg": 0.86, "max": 0.74, "min": 1.87, "cnt": 128}, "fwd-misc":{"total": 22.07, "avg": 0.17, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1688.77, "avg": 13.19, "max": 10.39, "min": 21.69, "cnt": 128}, "MoE_L0_fwd":{"total": 487.03, "avg": 15.22, "max": 11.29, "min": 21.55, "cnt": 32}, "MoEMLP":{"total": 1670.74, "avg": 13.05, "max": 10.27, "min": 21.47, "cnt": 128}, "MoE_L1_fwd":{"total": 461.71, "avg": 14.43, "max": 13.07, "min": 15.91, "cnt": 32}, "MoE_L2_fwd":{"total": 368.91, "avg": 11.53, "max": 10.31, "min": 15.05, "cnt": 32}, "MoE_L3_fwd":{"total": 359.69, "avg": 11.24, "max": 10.51, "min": 14.83, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.64, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 0.97, "avg": 0.97, "max": 0.97, "min": 0.97, "cnt": 1}, "forward-send-backward-recv":{"total": 311.89, "avg": 10.06, "max": 0.84, "min": 82.64, "cnt": 31}, "backward-compute":{"total": 1743.37, "avg": 54.48, "max": 51.52, "min": 62.61, "cnt": 32}, "MoE_L3_bwd":{"total": 387.22, "avg": 12.10, "max": 10.78, "min": 17.53, "cnt": 32}, "MoE_L2_bwd":{"total": 362.26, "avg": 11.32, "max": 10.11, "min": 12.51, "cnt": 32}, "MoE_L1_bwd":{"total": 436.14, "avg": 13.63, "max": 13.14, "min": 14.79, "cnt": 32}, "MoE_L0_bwd":{"total": 332.88, "avg": 10.40, "max": 9.68, "min": 11.78, "cnt": 32}, "backward-send-forward-recv":{"total": 2828.59, "avg": 94.29, "max": 1.29, "min": 385.11, "cnt": 30}, "backward-send":{"total": 1.34, "avg": 0.67, "max": 0.45, "min": 0.90, "cnt": 2}, "backward-recv":{"total": 68.85, "avg": 68.85, "max": 68.85, "min": 68.85, "cnt": 1}, "backward-params-all-reduce":{"total": 491.08, "avg": 491.08, "max": 491.08, "min": 491.08, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 299.57, "avg": 299.57, "max": 299.57, "min": 299.57, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 259.52, "avg": 259.52, "max": 259.52, "min": 259.52, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.28, "avg": 3.28, "max": 3.28, "min": 3.28, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.49, "avg": 3.49, "max": 3.49, "min": 3.49, "cnt": 1}}}
{"type":"time", "iteration": 106, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.13, "avg": 0.13, "max": 0.13, "min": 0.13, "cnt": 1}, "forward-recv":{"total": 147.99, "avg": 74.00, "max": 7.35, "min": 140.64, "cnt": 2}, "forward-compute":{"total": 1881.41, "avg": 58.79, "max": 54.35, "min": 70.39, "cnt": 32}, "fwd-compute":{"total": 1878.23, "avg": 58.69, "max": 54.28, "min": 70.25, "cnt": 32}, "batch-generator":{"total": 49.66, "avg": 1.55, "max": 0.71, "min": 3.73, "cnt": 32}, "fwd-embedding":{"total": 0.58, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1816.42, "avg": 56.76, "max": 52.06, "min": 68.15, "cnt": 32}, "fwd-layernorm":{"total": 9.68, "avg": 0.08, "max": 0.05, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 108.52, "avg": 0.85, "max": 0.75, "min": 1.88, "cnt": 128}, "fwd-misc":{"total": 20.91, "avg": 0.16, "max": 0.12, "min": 0.40, "cnt": 128}, "fwd-MLP":{"total": 1656.97, "avg": 12.95, "max": 10.04, "min": 21.76, "cnt": 128}, "MoE_L0_fwd":{"total": 472.11, "avg": 14.75, "max": 11.73, "min": 21.61, "cnt": 32}, "MoEMLP":{"total": 1640.42, "avg": 12.82, "max": 9.93, "min": 21.53, "cnt": 128}, "MoE_L1_fwd":{"total": 468.82, "avg": 14.65, "max": 13.47, "min": 18.59, "cnt": 32}, "MoE_L2_fwd":{"total": 364.78, "avg": 11.40, "max": 10.57, "min": 14.13, "cnt": 32}, "MoE_L3_fwd":{"total": 340.87, "avg": 10.65, "max": 9.97, "min": 13.10, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 0.59, "avg": 0.59, "max": 0.59, "min": 0.59, "cnt": 1}, "forward-send-backward-recv":{"total": 469.33, "avg": 15.14, "max": 1.27, "min": 115.74, "cnt": 31}, "backward-compute":{"total": 1747.34, "avg": 54.60, "max": 52.98, "min": 57.05, "cnt": 32}, "MoE_L3_bwd":{"total": 358.73, "avg": 11.21, "max": 10.17, "min": 12.72, "cnt": 32}, "MoE_L2_bwd":{"total": 376.87, "avg": 11.78, "max": 10.87, "min": 12.84, "cnt": 32}, "MoE_L1_bwd":{"total": 447.25, "avg": 13.98, "max": 13.47, "min": 15.69, "cnt": 32}, "MoE_L0_bwd":{"total": 340.14, "avg": 10.63, "max": 9.92, "min": 11.79, "cnt": 32}, "backward-send-forward-recv":{"total": 3650.85, "avg": 121.69, "max": 1.74, "min": 613.90, "cnt": 30}, "backward-send":{"total": 1.55, "avg": 0.77, "max": 0.46, "min": 1.08, "cnt": 2}, "backward-recv":{"total": 73.89, "avg": 73.89, "max": 73.89, "min": 73.89, "cnt": 1}, "backward-params-all-reduce":{"total": 489.87, "avg": 489.87, "max": 489.87, "min": 489.87, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 295.32, "avg": 295.32, "max": 295.32, "min": 295.32, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 255.08, "avg": 255.08, "max": 255.08, "min": 255.08, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.59, "avg": 3.59, "max": 3.59, "min": 3.59, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.49, "avg": 3.49, "max": 3.49, "min": 3.49, "cnt": 1}}}
{"type":"time", "iteration": 107, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 148.64, "avg": 74.32, "max": 8.74, "min": 139.90, "cnt": 2}, "forward-compute":{"total": 1852.78, "avg": 57.90, "max": 51.87, "min": 61.76, "cnt": 32}, "fwd-compute":{"total": 1849.60, "avg": 57.80, "max": 51.80, "min": 61.68, "cnt": 32}, "batch-generator":{"total": 42.77, "avg": 1.34, "max": 0.68, "min": 1.95, "cnt": 32}, "fwd-embedding":{"total": 0.67, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1794.38, "avg": 56.07, "max": 50.66, "min": 59.84, "cnt": 32}, "fwd-layernorm":{"total": 9.89, "avg": 0.08, "max": 0.05, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 112.58, "avg": 0.88, "max": 0.74, "min": 2.14, "cnt": 128}, "fwd-misc":{"total": 21.33, "avg": 0.17, "max": 0.11, "min": 0.38, "cnt": 128}, "fwd-MLP":{"total": 1629.70, "avg": 12.73, "max": 9.99, "min": 17.72, "cnt": 128}, "MoE_L0_fwd":{"total": 461.68, "avg": 14.43, "max": 11.31, "min": 17.65, "cnt": 32}, "MoEMLP":{"total": 1612.03, "avg": 12.59, "max": 9.89, "min": 17.60, "cnt": 128}, "MoE_L1_fwd":{"total": 461.05, "avg": 14.41, "max": 12.93, "min": 16.93, "cnt": 32}, "MoE_L2_fwd":{"total": 358.59, "avg": 11.21, "max": 10.50, "min": 13.72, "cnt": 32}, "MoE_L3_fwd":{"total": 337.92, "avg": 10.56, "max": 9.93, "min": 12.28, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 0.80, "avg": 0.80, "max": 0.80, "min": 0.80, "cnt": 1}, "forward-send-backward-recv":{"total": 309.44, "avg": 9.98, "max": 0.95, "min": 77.03, "cnt": 31}, "backward-compute":{"total": 1719.82, "avg": 53.74, "max": 50.84, "min": 56.36, "cnt": 32}, "MoE_L3_bwd":{"total": 359.10, "avg": 11.22, "max": 9.99, "min": 13.35, "cnt": 32}, "MoE_L2_bwd":{"total": 368.76, "avg": 11.52, "max": 10.42, "min": 14.10, "cnt": 32}, "MoE_L1_bwd":{"total": 441.73, "avg": 13.80, "max": 13.43, "min": 14.23, "cnt": 32}, "MoE_L0_bwd":{"total": 334.19, "avg": 10.44, "max": 9.89, "min": 11.15, "cnt": 32}, "backward-send-forward-recv":{"total": 3328.48, "avg": 110.95, "max": 1.28, "min": 785.09, "cnt": 30}, "backward-send":{"total": 1.68, "avg": 0.84, "max": 0.60, "min": 1.08, "cnt": 2}, "backward-recv":{"total": 75.34, "avg": 75.34, "max": 75.34, "min": 75.34, "cnt": 1}, "backward-params-all-reduce":{"total": 492.28, "avg": 492.28, "max": 492.28, "min": 492.28, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.04, "avg": 0.04, "max": 0.04, "min": 0.04, "cnt": 1}, "optimizer":{"total": 295.34, "avg": 295.34, "max": 295.34, "min": 295.34, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 255.51, "avg": 255.51, "max": 255.51, "min": 255.51, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.25, "avg": 3.25, "max": 3.25, "min": 3.25, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.51, "avg": 3.51, "max": 3.51, "min": 3.51, "cnt": 1}}}
{"type":"time", "iteration": 108, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 141.39, "avg": 70.70, "max": 6.82, "min": 134.57, "cnt": 2}, "forward-compute":{"total": 1900.65, "avg": 59.40, "max": 52.81, "min": 68.40, "cnt": 32}, "fwd-compute":{"total": 1897.38, "avg": 59.29, "max": 52.73, "min": 68.33, "cnt": 32}, "batch-generator":{"total": 42.54, "avg": 1.33, "max": 0.71, "min": 2.37, "cnt": 32}, "fwd-embedding":{"total": 0.63, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1841.93, "avg": 57.56, "max": 51.44, "min": 67.23, "cnt": 32}, "fwd-layernorm":{"total": 9.76, "avg": 0.08, "max": 0.06, "min": 0.18, "cnt": 128}, "fwd-attn":{"total": 108.92, "avg": 0.85, "max": 0.74, "min": 2.20, "cnt": 128}, "fwd-misc":{"total": 21.27, "avg": 0.17, "max": 0.11, "min": 0.34, "cnt": 128}, "fwd-MLP":{"total": 1681.04, "avg": 13.13, "max": 9.93, "min": 22.52, "cnt": 128}, "MoE_L0_fwd":{"total": 504.12, "avg": 15.75, "max": 11.86, "min": 22.44, "cnt": 32}, "MoEMLP":{"total": 1664.08, "avg": 13.00, "max": 9.82, "min": 22.39, "cnt": 128}, "MoE_L1_fwd":{"total": 466.55, "avg": 14.58, "max": 13.61, "min": 18.06, "cnt": 32}, "MoE_L2_fwd":{"total": 358.49, "avg": 11.20, "max": 10.48, "min": 13.95, "cnt": 32}, "MoE_L3_fwd":{"total": 341.24, "avg": 10.66, "max": 9.86, "min": 15.70, "cnt": 32}, "fwd-pooler":{"total": 0.36, "avg": 0.01, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-loss-func":{"total": 0.63, "avg": 0.02, "max": 0.02, "min": 0.08, "cnt": 32}, "forward-send":{"total": 0.61, "avg": 0.61, "max": 0.61, "min": 0.61, "cnt": 1}, "forward-send-backward-recv":{"total": 299.49, "avg": 9.66, "max": 0.94, "min": 65.93, "cnt": 31}, "backward-compute":{"total": 1719.26, "avg": 53.73, "max": 51.38, "min": 56.63, "cnt": 32}, "MoE_L3_bwd":{"total": 356.38, "avg": 11.14, "max": 10.04, "min": 13.91, "cnt": 32}, "MoE_L2_bwd":{"total": 369.12, "avg": 11.53, "max": 10.59, "min": 14.24, "cnt": 32}, "MoE_L1_bwd":{"total": 442.36, "avg": 13.82, "max": 13.34, "min": 15.25, "cnt": 32}, "MoE_L0_bwd":{"total": 333.66, "avg": 10.43, "max": 9.83, "min": 12.03, "cnt": 32}, "backward-send-forward-recv":{"total": 3539.72, "avg": 117.99, "max": 1.30, "min": 549.26, "cnt": 30}, "backward-send":{"total": 1.70, "avg": 0.85, "max": 0.70, "min": 1.01, "cnt": 2}, "backward-recv":{"total": 74.63, "avg": 74.63, "max": 74.63, "min": 74.63, "cnt": 1}, "backward-params-all-reduce":{"total": 489.92, "avg": 489.92, "max": 489.92, "min": 489.92, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 308.04, "avg": 308.04, "max": 308.04, "min": 308.04, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 268.03, "avg": 268.03, "max": 268.03, "min": 268.03, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.51, "avg": 3.51, "max": 3.51, "min": 3.51, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 109, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 141.72, "avg": 70.86, "max": 3.68, "min": 138.04, "cnt": 2}, "forward-compute":{"total": 1852.54, "avg": 57.89, "max": 51.48, "min": 65.84, "cnt": 32}, "fwd-compute":{"total": 1848.99, "avg": 57.78, "max": 51.41, "min": 65.77, "cnt": 32}, "batch-generator":{"total": 44.90, "avg": 1.40, "max": 0.70, "min": 4.16, "cnt": 32}, "fwd-embedding":{"total": 0.69, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1791.09, "avg": 55.97, "max": 50.41, "min": 63.99, "cnt": 32}, "fwd-layernorm":{"total": 10.45, "avg": 0.08, "max": 0.05, "min": 0.28, "cnt": 128}, "fwd-attn":{"total": 115.70, "avg": 0.90, "max": 0.74, "min": 2.88, "cnt": 128}, "fwd-misc":{"total": 22.05, "avg": 0.17, "max": 0.11, "min": 0.48, "cnt": 128}, "fwd-MLP":{"total": 1620.92, "avg": 12.66, "max": 9.61, "min": 21.83, "cnt": 128}, "MoE_L0_fwd":{"total": 467.79, "avg": 14.62, "max": 11.25, "min": 21.74, "cnt": 32}, "MoEMLP":{"total": 1603.36, "avg": 12.53, "max": 9.49, "min": 21.69, "cnt": 128}, "MoE_L1_fwd":{"total": 450.36, "avg": 14.07, "max": 12.97, "min": 16.57, "cnt": 32}, "MoE_L2_fwd":{"total": 351.38, "avg": 10.98, "max": 10.42, "min": 13.68, "cnt": 32}, "MoE_L3_fwd":{"total": 340.28, "avg": 10.63, "max": 9.54, "min": 14.59, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 0.52, "avg": 0.52, "max": 0.52, "min": 0.52, "cnt": 1}, "forward-send-backward-recv":{"total": 645.65, "avg": 20.83, "max": 0.99, "min": 177.69, "cnt": 31}, "backward-compute":{"total": 1701.90, "avg": 53.18, "max": 51.89, "min": 55.37, "cnt": 32}, "MoE_L3_bwd":{"total": 351.69, "avg": 10.99, "max": 9.54, "min": 14.17, "cnt": 32}, "MoE_L2_bwd":{"total": 359.88, "avg": 11.25, "max": 10.82, "min": 12.11, "cnt": 32}, "MoE_L1_bwd":{"total": 439.31, "avg": 13.73, "max": 12.84, "min": 14.35, "cnt": 32}, "MoE_L0_bwd":{"total": 332.67, "avg": 10.40, "max": 9.78, "min": 12.25, "cnt": 32}, "backward-send-forward-recv":{"total": 2302.60, "avg": 76.75, "max": 0.91, "min": 370.49, "cnt": 30}, "backward-send":{"total": 1.77, "avg": 0.89, "max": 0.84, "min": 0.93, "cnt": 2}, "backward-recv":{"total": 86.39, "avg": 86.39, "max": 86.39, "min": 86.39, "cnt": 1}, "backward-params-all-reduce":{"total": 487.73, "avg": 487.73, "max": 487.73, "min": 487.73, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 307.27, "avg": 307.27, "max": 307.27, "min": 307.27, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 267.34, "avg": 267.34, "max": 267.34, "min": 267.34, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 110, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.11, "avg": 0.11, "max": 0.11, "min": 0.11, "cnt": 1}, "forward-recv":{"total": 132.07, "avg": 66.04, "max": 1.32, "min": 130.76, "cnt": 2}, "forward-compute":{"total": 1839.31, "avg": 57.48, "max": 53.11, "min": 64.44, "cnt": 32}, "fwd-compute":{"total": 1836.09, "avg": 57.38, "max": 53.04, "min": 64.31, "cnt": 32}, "batch-generator":{"total": 43.18, "avg": 1.35, "max": 0.74, "min": 3.10, "cnt": 32}, "fwd-embedding":{"total": 0.64, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1779.97, "avg": 55.62, "max": 51.88, "min": 62.30, "cnt": 32}, "fwd-layernorm":{"total": 10.01, "avg": 0.08, "max": 0.05, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 111.13, "avg": 0.87, "max": 0.74, "min": 2.68, "cnt": 128}, "fwd-misc":{"total": 21.67, "avg": 0.17, "max": 0.11, "min": 0.41, "cnt": 128}, "fwd-MLP":{"total": 1615.62, "avg": 12.62, "max": 9.73, "min": 18.44, "cnt": 128}, "MoE_L0_fwd":{"total": 447.15, "avg": 13.97, "max": 11.94, "min": 18.34, "cnt": 32}, "MoEMLP":{"total": 1596.29, "avg": 12.47, "max": 9.62, "min": 18.29, "cnt": 128}, "MoE_L1_fwd":{"total": 463.04, "avg": 14.47, "max": 13.17, "min": 18.09, "cnt": 32}, "MoE_L2_fwd":{"total": 364.47, "avg": 11.39, "max": 10.70, "min": 16.72, "cnt": 32}, "MoE_L3_fwd":{"total": 330.09, "avg": 10.32, "max": 9.66, "min": 12.09, "cnt": 32}, "fwd-pooler":{"total": 0.36, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.61, "avg": 0.02, "max": 0.02, "min": 0.06, "cnt": 32}, "forward-send":{"total": 0.71, "avg": 0.71, "max": 0.71, "min": 0.71, "cnt": 1}, "forward-send-backward-recv":{"total": 310.38, "avg": 10.01, "max": 0.93, "min": 95.22, "cnt": 31}, "backward-compute":{"total": 1747.18, "avg": 54.60, "max": 50.93, "min": 57.00, "cnt": 32}, "MoE_L3_bwd":{"total": 362.37, "avg": 11.32, "max": 9.99, "min": 13.25, "cnt": 32}, "MoE_L2_bwd":{"total": 377.35, "avg": 11.79, "max": 11.00, "min": 14.21, "cnt": 32}, "MoE_L1_bwd":{"total": 443.69, "avg": 13.87, "max": 13.41, "min": 15.51, "cnt": 32}, "MoE_L0_bwd":{"total": 344.62, "avg": 10.77, "max": 10.01, "min": 13.33, "cnt": 32}, "backward-send-forward-recv":{"total": 3784.37, "avg": 126.15, "max": 1.66, "min": 809.76, "cnt": 30}, "backward-send":{"total": 1.48, "avg": 0.74, "max": 0.69, "min": 0.79, "cnt": 2}, "backward-recv":{"total": 72.84, "avg": 72.84, "max": 72.84, "min": 72.84, "cnt": 1}, "backward-params-all-reduce":{"total": 488.60, "avg": 488.60, "max": 488.60, "min": 488.60, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 300.50, "avg": 300.50, "max": 300.50, "min": 300.50, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.40, "avg": 3.40, "max": 3.40, "min": 3.40, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 260.27, "avg": 260.27, "max": 260.27, "min": 260.27, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.68, "avg": 3.68, "max": 3.68, "min": 3.68, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 111, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 146.83, "avg": 73.41, "max": 12.25, "min": 134.57, "cnt": 2}, "forward-compute":{"total": 1905.11, "avg": 59.53, "max": 52.41, "min": 66.23, "cnt": 32}, "fwd-compute":{"total": 1901.90, "avg": 59.43, "max": 52.35, "min": 66.16, "cnt": 32}, "batch-generator":{"total": 40.34, "avg": 1.26, "max": 0.66, "min": 2.28, "cnt": 32}, "fwd-embedding":{"total": 0.72, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1849.04, "avg": 57.78, "max": 51.32, "min": 64.98, "cnt": 32}, "fwd-layernorm":{"total": 10.32, "avg": 0.08, "max": 0.05, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 110.37, "avg": 0.86, "max": 0.74, "min": 1.75, "cnt": 128}, "fwd-misc":{"total": 21.87, "avg": 0.17, "max": 0.11, "min": 0.45, "cnt": 128}, "fwd-MLP":{"total": 1684.79, "avg": 13.16, "max": 10.23, "min": 20.33, "cnt": 128}, "MoE_L0_fwd":{"total": 502.53, "avg": 15.70, "max": 11.41, "min": 20.25, "cnt": 32}, "MoEMLP":{"total": 1666.86, "avg": 13.02, "max": 10.12, "min": 20.21, "cnt": 128}, "MoE_L1_fwd":{"total": 469.72, "avg": 14.68, "max": 13.55, "min": 17.52, "cnt": 32}, "MoE_L2_fwd":{"total": 357.57, "avg": 11.17, "max": 10.61, "min": 12.79, "cnt": 32}, "MoE_L3_fwd":{"total": 343.74, "avg": 10.74, "max": 10.16, "min": 13.50, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.04, "cnt": 32}, "forward-send":{"total": 0.93, "avg": 0.93, "max": 0.93, "min": 0.93, "cnt": 1}, "forward-send-backward-recv":{"total": 1819.28, "avg": 58.69, "max": 9.30, "min": 176.80, "cnt": 31}, "backward-compute":{"total": 1747.47, "avg": 54.61, "max": 52.50, "min": 57.99, "cnt": 32}, "MoE_L3_bwd":{"total": 375.73, "avg": 11.74, "max": 10.67, "min": 14.78, "cnt": 32}, "MoE_L2_bwd":{"total": 370.01, "avg": 11.56, "max": 10.87, "min": 12.69, "cnt": 32}, "MoE_L1_bwd":{"total": 439.69, "avg": 13.74, "max": 13.25, "min": 16.04, "cnt": 32}, "MoE_L0_bwd":{"total": 346.14, "avg": 10.82, "max": 10.23, "min": 11.50, "cnt": 32}, "backward-send-forward-recv":{"total": 740.13, "avg": 24.67, "max": 0.91, "min": 157.03, "cnt": 30}, "backward-send":{"total": 1.88, "avg": 0.94, "max": 0.77, "min": 1.10, "cnt": 2}, "backward-recv":{"total": 80.32, "avg": 80.32, "max": 80.32, "min": 80.32, "cnt": 1}, "backward-params-all-reduce":{"total": 488.99, "avg": 488.99, "max": 488.99, "min": 488.99, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 299.73, "avg": 299.73, "max": 299.73, "min": 299.73, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 259.82, "avg": 259.82, "max": 259.82, "min": 259.82, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 112, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 144.48, "avg": 72.24, "max": 7.86, "min": 136.62, "cnt": 2}, "forward-compute":{"total": 1881.24, "avg": 58.79, "max": 53.57, "min": 65.80, "cnt": 32}, "fwd-compute":{"total": 1878.12, "avg": 58.69, "max": 53.48, "min": 65.72, "cnt": 32}, "batch-generator":{"total": 41.71, "avg": 1.30, "max": 0.73, "min": 2.48, "cnt": 32}, "fwd-embedding":{"total": 0.69, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1823.36, "avg": 56.98, "max": 52.31, "min": 64.45, "cnt": 32}, "fwd-layernorm":{"total": 10.16, "avg": 0.08, "max": 0.05, "min": 0.24, "cnt": 128}, "fwd-attn":{"total": 113.81, "avg": 0.89, "max": 0.74, "min": 2.66, "cnt": 128}, "fwd-misc":{"total": 21.96, "avg": 0.17, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1655.75, "avg": 12.94, "max": 10.31, "min": 22.78, "cnt": 128}, "MoE_L0_fwd":{"total": 497.10, "avg": 15.53, "max": 12.38, "min": 22.66, "cnt": 32}, "MoEMLP":{"total": 1638.25, "avg": 12.80, "max": 10.20, "min": 22.58, "cnt": 128}, "MoE_L1_fwd":{"total": 450.03, "avg": 14.06, "max": 13.01, "min": 17.19, "cnt": 32}, "MoE_L2_fwd":{"total": 346.97, "avg": 10.84, "max": 10.26, "min": 11.48, "cnt": 32}, "MoE_L3_fwd":{"total": 350.72, "avg": 10.96, "max": 10.24, "min": 12.14, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 0.96, "avg": 0.96, "max": 0.96, "min": 0.96, "cnt": 1}, "forward-send-backward-recv":{"total": 269.11, "avg": 8.68, "max": 1.43, "min": 55.14, "cnt": 31}, "backward-compute":{"total": 1741.90, "avg": 54.43, "max": 52.29, "min": 56.49, "cnt": 32}, "MoE_L3_bwd":{"total": 376.75, "avg": 11.77, "max": 10.13, "min": 13.82, "cnt": 32}, "MoE_L2_bwd":{"total": 356.66, "avg": 11.15, "max": 10.48, "min": 11.98, "cnt": 32}, "MoE_L1_bwd":{"total": 439.38, "avg": 13.73, "max": 13.37, "min": 14.47, "cnt": 32}, "MoE_L0_bwd":{"total": 353.36, "avg": 11.04, "max": 10.43, "min": 12.05, "cnt": 32}, "backward-send-forward-recv":{"total": 3212.01, "avg": 107.07, "max": 1.45, "min": 863.41, "cnt": 30}, "backward-send":{"total": 1.70, "avg": 0.85, "max": 0.63, "min": 1.07, "cnt": 2}, "backward-recv":{"total": 75.47, "avg": 75.47, "max": 75.47, "min": 75.47, "cnt": 1}, "backward-params-all-reduce":{"total": 488.08, "avg": 488.08, "max": 488.08, "min": 488.08, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.04, "avg": 0.04, "max": 0.04, "min": 0.04, "cnt": 1}, "optimizer":{"total": 301.74, "avg": 301.74, "max": 301.74, "min": 301.74, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 261.94, "avg": 261.94, "max": 261.94, "min": 261.94, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.24, "avg": 3.24, "max": 3.24, "min": 3.24, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.51, "avg": 3.51, "max": 3.51, "min": 3.51, "cnt": 1}}}
{"type":"time", "iteration": 113, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.12, "avg": 0.12, "max": 0.12, "min": 0.12, "cnt": 1}, "forward-recv":{"total": 2844.46, "avg": 1422.23, "max": 0.70, "min": 2843.76, "cnt": 2}, "forward-compute":{"total": 1903.96, "avg": 59.50, "max": 53.09, "min": 68.23, "cnt": 32}, "fwd-compute":{"total": 1900.90, "avg": 59.40, "max": 53.01, "min": 68.12, "cnt": 32}, "batch-generator":{"total": 48.04, "avg": 1.50, "max": 0.73, "min": 5.23, "cnt": 32}, "fwd-embedding":{"total": 0.60, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1840.43, "avg": 57.51, "max": 51.74, "min": 66.74, "cnt": 32}, "fwd-layernorm":{"total": 9.93, "avg": 0.08, "max": 0.05, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 110.63, "avg": 0.86, "max": 0.75, "min": 1.59, "cnt": 128}, "fwd-misc":{"total": 21.05, "avg": 0.16, "max": 0.11, "min": 0.38, "cnt": 128}, "fwd-MLP":{"total": 1677.25, "avg": 13.10, "max": 9.93, "min": 23.30, "cnt": 128}, "MoE_L0_fwd":{"total": 522.91, "avg": 16.34, "max": 12.34, "min": 23.10, "cnt": 32}, "MoEMLP":{"total": 1659.82, "avg": 12.97, "max": 9.83, "min": 23.03, "cnt": 128}, "MoE_L1_fwd":{"total": 448.36, "avg": 14.01, "max": 13.15, "min": 15.96, "cnt": 32}, "MoE_L2_fwd":{"total": 355.94, "avg": 11.12, "max": 10.29, "min": 13.13, "cnt": 32}, "MoE_L3_fwd":{"total": 339.10, "avg": 10.60, "max": 9.87, "min": 11.83, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 0.80, "avg": 0.80, "max": 0.80, "min": 0.80, "cnt": 1}, "forward-send-backward-recv":{"total": 182.47, "avg": 5.89, "max": 0.93, "min": 65.74, "cnt": 31}, "backward-compute":{"total": 1768.01, "avg": 55.25, "max": 52.87, "min": 58.07, "cnt": 32}, "MoE_L3_bwd":{"total": 384.42, "avg": 12.01, "max": 10.79, "min": 14.49, "cnt": 32}, "MoE_L2_bwd":{"total": 359.81, "avg": 11.24, "max": 10.58, "min": 11.79, "cnt": 32}, "MoE_L1_bwd":{"total": 438.14, "avg": 13.69, "max": 13.08, "min": 14.63, "cnt": 32}, "MoE_L0_bwd":{"total": 371.04, "avg": 11.59, "max": 11.04, "min": 12.49, "cnt": 32}, "backward-send-forward-recv":{"total": 4892.14, "avg": 163.07, "max": 1.60, "min": 994.58, "cnt": 30}, "backward-send":{"total": 1.43, "avg": 0.72, "max": 0.58, "min": 0.85, "cnt": 2}, "backward-recv":{"total": 73.36, "avg": 73.36, "max": 73.36, "min": 73.36, "cnt": 1}, "backward-params-all-reduce":{"total": 488.50, "avg": 488.50, "max": 488.50, "min": 488.50, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 306.78, "avg": 306.78, "max": 306.78, "min": 306.78, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 266.86, "avg": 266.86, "max": 266.86, "min": 266.86, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.29, "avg": 3.29, "max": 3.29, "min": 3.29, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.48, "avg": 3.48, "max": 3.48, "min": 3.48, "cnt": 1}}}
{"type":"time", "iteration": 114, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 1018.91, "avg": 509.45, "max": 0.74, "min": 1018.17, "cnt": 2}, "forward-compute":{"total": 2001.74, "avg": 62.55, "max": 55.23, "min": 71.64, "cnt": 32}, "fwd-compute":{"total": 1998.24, "avg": 62.45, "max": 55.17, "min": 71.51, "cnt": 32}, "batch-generator":{"total": 43.02, "avg": 1.34, "max": 0.73, "min": 2.01, "cnt": 32}, "fwd-embedding":{"total": 0.72, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1941.86, "avg": 60.68, "max": 54.11, "min": 69.33, "cnt": 32}, "fwd-layernorm":{"total": 10.65, "avg": 0.08, "max": 0.05, "min": 0.47, "cnt": 128}, "fwd-attn":{"total": 112.48, "avg": 0.88, "max": 0.74, "min": 1.56, "cnt": 128}, "fwd-misc":{"total": 21.51, "avg": 0.17, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1773.35, "avg": 13.85, "max": 10.28, "min": 22.07, "cnt": 128}, "MoE_L0_fwd":{"total": 574.85, "avg": 17.96, "max": 14.31, "min": 22.00, "cnt": 32}, "MoEMLP":{"total": 1756.21, "avg": 13.72, "max": 10.17, "min": 21.95, "cnt": 128}, "MoE_L1_fwd":{"total": 452.02, "avg": 14.13, "max": 12.76, "min": 18.44, "cnt": 32}, "MoE_L2_fwd":{"total": 374.41, "avg": 11.70, "max": 10.34, "min": 14.94, "cnt": 32}, "MoE_L3_fwd":{"total": 361.29, "avg": 11.29, "max": 10.21, "min": 13.51, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.56, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 0.52, "avg": 0.52, "max": 0.52, "min": 0.52, "cnt": 1}, "forward-send-backward-recv":{"total": 1998.35, "avg": 64.46, "max": 0.86, "min": 312.28, "cnt": 31}, "backward-compute":{"total": 1770.05, "avg": 55.31, "max": 53.37, "min": 58.71, "cnt": 32}, "MoE_L3_bwd":{"total": 368.09, "avg": 11.50, "max": 9.96, "min": 13.97, "cnt": 32}, "MoE_L2_bwd":{"total": 365.16, "avg": 11.41, "max": 10.62, "min": 12.28, "cnt": 32}, "MoE_L1_bwd":{"total": 436.13, "avg": 13.63, "max": 12.91, "min": 15.64, "cnt": 32}, "MoE_L0_bwd":{"total": 383.21, "avg": 11.98, "max": 11.31, "min": 12.52, "cnt": 32}, "backward-send-forward-recv":{"total": 1422.43, "avg": 47.41, "max": 0.98, "min": 309.04, "cnt": 30}, "backward-send":{"total": 1.40, "avg": 0.70, "max": 0.44, "min": 0.96, "cnt": 2}, "backward-recv":{"total": 124.93, "avg": 124.93, "max": 124.93, "min": 124.93, "cnt": 1}, "backward-params-all-reduce":{"total": 486.50, "avg": 486.50, "max": 486.50, "min": 486.50, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 300.78, "avg": 300.78, "max": 300.78, "min": 300.78, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 261.03, "avg": 261.03, "max": 261.03, "min": 261.03, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.29, "avg": 3.29, "max": 3.29, "min": 3.29, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 115, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.11, "avg": 0.11, "max": 0.11, "min": 0.11, "cnt": 1}, "forward-recv":{"total": 132.48, "avg": 66.24, "max": 1.29, "min": 131.18, "cnt": 2}, "forward-compute":{"total": 2047.57, "avg": 63.99, "max": 53.69, "min": 144.33, "cnt": 32}, "fwd-compute":{"total": 2044.21, "avg": 63.88, "max": 53.62, "min": 144.23, "cnt": 32}, "batch-generator":{"total": 49.48, "avg": 1.55, "max": 0.68, "min": 4.08, "cnt": 32}, "fwd-embedding":{"total": 0.61, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1981.72, "avg": 61.93, "max": 52.62, "min": 142.78, "cnt": 32}, "fwd-layernorm":{"total": 9.98, "avg": 0.08, "max": 0.06, "min": 0.33, "cnt": 128}, "fwd-attn":{"total": 109.67, "avg": 0.86, "max": 0.75, "min": 3.23, "cnt": 128}, "fwd-misc":{"total": 22.11, "avg": 0.17, "max": 0.11, "min": 0.67, "cnt": 128}, "fwd-MLP":{"total": 1818.48, "avg": 14.21, "max": 10.60, "min": 91.69, "cnt": 128}, "MoE_L0_fwd":{"total": 533.81, "avg": 16.68, "max": 12.65, "min": 23.48, "cnt": 32}, "MoEMLP":{"total": 1801.21, "avg": 14.07, "max": 10.49, "min": 91.57, "cnt": 128}, "MoE_L1_fwd":{"total": 439.33, "avg": 13.73, "max": 12.40, "min": 17.70, "cnt": 32}, "MoE_L2_fwd":{"total": 472.69, "avg": 14.77, "max": 11.15, "min": 91.62, "cnt": 32}, "MoE_L3_fwd":{"total": 361.87, "avg": 11.31, "max": 10.53, "min": 13.44, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 0.94, "avg": 0.94, "max": 0.94, "min": 0.94, "cnt": 1}, "forward-send-backward-recv":{"total": 500.13, "avg": 16.13, "max": 1.02, "min": 201.29, "cnt": 31}, "backward-compute":{"total": 1812.84, "avg": 56.65, "max": 54.19, "min": 58.72, "cnt": 32}, "MoE_L3_bwd":{"total": 388.04, "avg": 12.13, "max": 10.87, "min": 14.57, "cnt": 32}, "MoE_L2_bwd":{"total": 390.55, "avg": 12.20, "max": 11.56, "min": 13.82, "cnt": 32}, "MoE_L1_bwd":{"total": 433.15, "avg": 13.54, "max": 12.84, "min": 13.92, "cnt": 32}, "MoE_L0_bwd":{"total": 386.16, "avg": 12.07, "max": 11.54, "min": 13.64, "cnt": 32}, "backward-send-forward-recv":{"total": 4263.62, "avg": 142.12, "max": 1.62, "min": 1202.16, "cnt": 30}, "backward-send":{"total": 2.41, "avg": 1.21, "max": 1.15, "min": 1.27, "cnt": 2}, "backward-recv":{"total": 173.95, "avg": 173.95, "max": 173.95, "min": 173.95, "cnt": 1}, "backward-params-all-reduce":{"total": 483.89, "avg": 483.89, "max": 483.89, "min": 483.89, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 304.73, "avg": 304.73, "max": 304.73, "min": 304.73, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.40, "avg": 3.40, "max": 3.40, "min": 3.40, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 264.87, "avg": 264.87, "max": 264.87, "min": 264.87, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.23, "avg": 3.23, "max": 3.23, "min": 3.23, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.53, "avg": 3.53, "max": 3.53, "min": 3.53, "cnt": 1}}}
{"type":"time", "iteration": 116, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 1.59, "avg": 1.59, "max": 1.59, "min": 1.59, "cnt": 1}, "forward-recv":{"total": 130.65, "avg": 65.33, "max": 1.03, "min": 129.63, "cnt": 2}, "forward-compute":{"total": 1986.34, "avg": 62.07, "max": 55.73, "min": 70.74, "cnt": 32}, "fwd-compute":{"total": 1983.07, "avg": 61.97, "max": 55.66, "min": 70.63, "cnt": 32}, "batch-generator":{"total": 48.12, "avg": 1.50, "max": 0.64, "min": 4.99, "cnt": 32}, "fwd-embedding":{"total": 0.84, "avg": 0.03, "max": 0.01, "min": 0.16, "cnt": 32}, "fwd-encoder":{"total": 1917.94, "avg": 59.94, "max": 54.03, "min": 69.00, "cnt": 32}, "fwd-layernorm":{"total": 10.54, "avg": 0.08, "max": 0.05, "min": 0.60, "cnt": 128}, "fwd-attn":{"total": 113.09, "avg": 0.88, "max": 0.74, "min": 2.80, "cnt": 128}, "fwd-misc":{"total": 21.77, "avg": 0.17, "max": 0.11, "min": 0.46, "cnt": 128}, "fwd-MLP":{"total": 1751.02, "avg": 13.68, "max": 10.54, "min": 23.23, "cnt": 128}, "MoE_L0_fwd":{"total": 531.38, "avg": 16.61, "max": 12.41, "min": 23.13, "cnt": 32}, "MoEMLP":{"total": 1733.67, "avg": 13.54, "max": 10.43, "min": 23.07, "cnt": 128}, "MoE_L1_fwd":{"total": 444.77, "avg": 13.90, "max": 12.75, "min": 17.02, "cnt": 32}, "MoE_L2_fwd":{"total": 393.81, "avg": 12.31, "max": 11.32, "min": 14.10, "cnt": 32}, "MoE_L3_fwd":{"total": 370.22, "avg": 11.57, "max": 10.47, "min": 15.15, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 0.69, "avg": 0.69, "max": 0.69, "min": 0.69, "cnt": 1}, "forward-send-backward-recv":{"total": 572.44, "avg": 18.47, "max": 0.92, "min": 116.19, "cnt": 31}, "backward-compute":{"total": 1827.22, "avg": 57.10, "max": 54.68, "min": 62.92, "cnt": 32}, "MoE_L3_bwd":{"total": 395.96, "avg": 12.37, "max": 10.92, "min": 17.26, "cnt": 32}, "MoE_L2_bwd":{"total": 396.56, "avg": 12.39, "max": 11.56, "min": 13.25, "cnt": 32}, "MoE_L1_bwd":{"total": 431.90, "avg": 13.50, "max": 13.18, "min": 14.36, "cnt": 32}, "MoE_L0_bwd":{"total": 387.31, "avg": 12.10, "max": 11.29, "min": 13.51, "cnt": 32}, "backward-send-forward-recv":{"total": 1781.08, "avg": 59.37, "max": 0.89, "min": 364.41, "cnt": 30}, "backward-send":{"total": 2.03, "avg": 1.02, "max": 1.00, "min": 1.03, "cnt": 2}, "backward-recv":{"total": 71.05, "avg": 71.05, "max": 71.05, "min": 71.05, "cnt": 1}, "backward-params-all-reduce":{"total": 487.75, "avg": 487.75, "max": 487.75, "min": 487.75, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 297.10, "avg": 297.10, "max": 297.10, "min": 297.10, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.41, "avg": 3.41, "max": 3.41, "min": 3.41, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 256.97, "avg": 256.97, "max": 256.97, "min": 256.97, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.51, "avg": 3.51, "max": 3.51, "min": 3.51, "cnt": 1}}}
{"type":"time", "iteration": 117, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.13, "avg": 0.13, "max": 0.13, "min": 0.13, "cnt": 1}, "forward-recv":{"total": 144.79, "avg": 72.40, "max": 10.34, "min": 134.45, "cnt": 2}, "forward-compute":{"total": 1911.95, "avg": 59.75, "max": 54.61, "min": 70.74, "cnt": 32}, "fwd-compute":{"total": 1908.47, "avg": 59.64, "max": 54.54, "min": 70.67, "cnt": 32}, "batch-generator":{"total": 46.90, "avg": 1.47, "max": 0.74, "min": 4.23, "cnt": 32}, "fwd-embedding":{"total": 0.70, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1847.78, "avg": 57.74, "max": 52.83, "min": 67.94, "cnt": 32}, "fwd-layernorm":{"total": 10.62, "avg": 0.08, "max": 0.06, "min": 0.29, "cnt": 128}, "fwd-attn":{"total": 113.87, "avg": 0.89, "max": 0.74, "min": 2.37, "cnt": 128}, "fwd-misc":{"total": 22.22, "avg": 0.17, "max": 0.11, "min": 0.60, "cnt": 128}, "fwd-MLP":{"total": 1678.54, "avg": 13.11, "max": 9.95, "min": 21.57, "cnt": 128}, "MoE_L0_fwd":{"total": 510.36, "avg": 15.95, "max": 12.80, "min": 21.39, "cnt": 32}, "MoEMLP":{"total": 1660.76, "avg": 12.97, "max": 9.83, "min": 21.30, "cnt": 128}, "MoE_L1_fwd":{"total": 432.84, "avg": 13.53, "max": 12.61, "min": 17.66, "cnt": 32}, "MoE_L2_fwd":{"total": 387.09, "avg": 12.10, "max": 11.01, "min": 16.85, "cnt": 32}, "MoE_L3_fwd":{"total": 337.04, "avg": 10.53, "max": 9.88, "min": 12.97, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 0.82, "avg": 0.82, "max": 0.82, "min": 0.82, "cnt": 1}, "forward-send-backward-recv":{"total": 238.05, "avg": 7.68, "max": 0.88, "min": 61.38, "cnt": 31}, "backward-compute":{"total": 1780.62, "avg": 55.64, "max": 53.09, "min": 57.85, "cnt": 32}, "MoE_L3_bwd":{"total": 366.55, "avg": 11.45, "max": 10.58, "min": 14.52, "cnt": 32}, "MoE_L2_bwd":{"total": 386.26, "avg": 12.07, "max": 11.15, "min": 15.00, "cnt": 32}, "MoE_L1_bwd":{"total": 427.91, "avg": 13.37, "max": 12.89, "min": 14.68, "cnt": 32}, "MoE_L0_bwd":{"total": 383.50, "avg": 11.98, "max": 11.18, "min": 12.70, "cnt": 32}, "backward-send-forward-recv":{"total": 2569.34, "avg": 85.64, "max": 2.43, "min": 363.75, "cnt": 30}, "backward-send":{"total": 1.82, "avg": 0.91, "max": 0.89, "min": 0.93, "cnt": 2}, "backward-recv":{"total": 67.94, "avg": 67.94, "max": 67.94, "min": 67.94, "cnt": 1}, "backward-params-all-reduce":{"total": 491.20, "avg": 491.20, "max": 491.20, "min": 491.20, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 297.60, "avg": 297.60, "max": 297.60, "min": 297.60, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 257.29, "avg": 257.29, "max": 257.29, "min": 257.29, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.33, "avg": 3.33, "max": 3.33, "min": 3.33, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.74, "avg": 3.74, "max": 3.74, "min": 3.74, "cnt": 1}}}
{"type":"time", "iteration": 118, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 134.35, "avg": 67.18, "max": 0.74, "min": 133.61, "cnt": 2}, "forward-compute":{"total": 1972.84, "avg": 61.65, "max": 53.61, "min": 68.47, "cnt": 32}, "fwd-compute":{"total": 1969.54, "avg": 61.55, "max": 53.54, "min": 68.35, "cnt": 32}, "batch-generator":{"total": 42.58, "avg": 1.33, "max": 0.70, "min": 2.67, "cnt": 32}, "fwd-embedding":{"total": 0.63, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1913.78, "avg": 59.81, "max": 52.44, "min": 66.29, "cnt": 32}, "fwd-layernorm":{"total": 10.13, "avg": 0.08, "max": 0.05, "min": 0.18, "cnt": 128}, "fwd-attn":{"total": 112.02, "avg": 0.88, "max": 0.75, "min": 2.44, "cnt": 128}, "fwd-misc":{"total": 22.00, "avg": 0.17, "max": 0.11, "min": 0.51, "cnt": 128}, "fwd-MLP":{"total": 1747.68, "avg": 13.65, "max": 9.96, "min": 22.63, "cnt": 128}, "MoE_L0_fwd":{"total": 546.09, "avg": 17.07, "max": 12.61, "min": 22.52, "cnt": 32}, "MoEMLP":{"total": 1730.12, "avg": 13.52, "max": 9.86, "min": 22.48, "cnt": 128}, "MoE_L1_fwd":{"total": 438.68, "avg": 13.71, "max": 12.46, "min": 15.41, "cnt": 32}, "MoE_L2_fwd":{"total": 405.74, "avg": 12.68, "max": 11.27, "min": 16.98, "cnt": 32}, "MoE_L3_fwd":{"total": 346.11, "avg": 10.82, "max": 9.90, "min": 15.87, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 0.71, "avg": 0.71, "max": 0.71, "min": 0.71, "cnt": 1}, "forward-send-backward-recv":{"total": 841.69, "avg": 27.15, "max": 0.95, "min": 180.95, "cnt": 31}, "backward-compute":{"total": 1807.74, "avg": 56.49, "max": 53.73, "min": 60.27, "cnt": 32}, "MoE_L3_bwd":{"total": 371.78, "avg": 11.62, "max": 10.24, "min": 13.94, "cnt": 32}, "MoE_L2_bwd":{"total": 398.70, "avg": 12.46, "max": 11.55, "min": 16.56, "cnt": 32}, "MoE_L1_bwd":{"total": 423.53, "avg": 13.24, "max": 12.65, "min": 14.62, "cnt": 32}, "MoE_L0_bwd":{"total": 394.75, "avg": 12.34, "max": 11.62, "min": 13.33, "cnt": 32}, "backward-send-forward-recv":{"total": 2138.08, "avg": 71.27, "max": 1.44, "min": 727.13, "cnt": 30}, "backward-send":{"total": 1.76, "avg": 0.88, "max": 0.57, "min": 1.19, "cnt": 2}, "backward-recv":{"total": 64.23, "avg": 64.23, "max": 64.23, "min": 64.23, "cnt": 1}, "backward-params-all-reduce":{"total": 489.68, "avg": 489.68, "max": 489.68, "min": 489.68, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 300.77, "avg": 300.77, "max": 300.77, "min": 300.77, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 260.90, "avg": 260.90, "max": 260.90, "min": 260.90, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 119, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.13, "avg": 0.13, "max": 0.13, "min": 0.13, "cnt": 1}, "forward-recv":{"total": 144.88, "avg": 72.44, "max": 5.95, "min": 138.93, "cnt": 2}, "forward-compute":{"total": 1982.11, "avg": 61.94, "max": 55.75, "min": 69.32, "cnt": 32}, "fwd-compute":{"total": 1978.52, "avg": 61.83, "max": 55.67, "min": 69.19, "cnt": 32}, "batch-generator":{"total": 46.04, "avg": 1.44, "max": 0.66, "min": 4.03, "cnt": 32}, "fwd-embedding":{"total": 0.68, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1918.95, "avg": 59.97, "max": 54.42, "min": 67.42, "cnt": 32}, "fwd-layernorm":{"total": 10.31, "avg": 0.08, "max": 0.06, "min": 0.29, "cnt": 128}, "fwd-attn":{"total": 113.80, "avg": 0.89, "max": 0.75, "min": 3.18, "cnt": 128}, "fwd-misc":{"total": 22.00, "avg": 0.17, "max": 0.11, "min": 0.49, "cnt": 128}, "fwd-MLP":{"total": 1751.06, "avg": 13.68, "max": 9.84, "min": 21.24, "cnt": 128}, "MoE_L0_fwd":{"total": 557.57, "avg": 17.42, "max": 13.94, "min": 21.15, "cnt": 32}, "MoEMLP":{"total": 1733.51, "avg": 13.54, "max": 9.73, "min": 21.10, "cnt": 128}, "MoE_L1_fwd":{"total": 429.79, "avg": 13.43, "max": 12.38, "min": 16.40, "cnt": 32}, "MoE_L2_fwd":{"total": 404.10, "avg": 12.63, "max": 11.67, "min": 15.34, "cnt": 32}, "MoE_L3_fwd":{"total": 348.60, "avg": 10.89, "max": 9.77, "min": 17.31, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.04, "cnt": 32}, "forward-send":{"total": 0.55, "avg": 0.55, "max": 0.55, "min": 0.55, "cnt": 1}, "forward-send-backward-recv":{"total": 181.09, "avg": 5.84, "max": 0.83, "min": 59.19, "cnt": 31}, "backward-compute":{"total": 1807.54, "avg": 56.49, "max": 55.02, "min": 59.81, "cnt": 32}, "MoE_L3_bwd":{"total": 373.54, "avg": 11.67, "max": 10.57, "min": 13.34, "cnt": 32}, "MoE_L2_bwd":{"total": 409.75, "avg": 12.80, "max": 11.90, "min": 15.42, "cnt": 32}, "MoE_L1_bwd":{"total": 410.98, "avg": 12.84, "max": 12.40, "min": 13.75, "cnt": 32}, "MoE_L0_bwd":{"total": 396.82, "avg": 12.40, "max": 11.91, "min": 13.75, "cnt": 32}, "backward-send-forward-recv":{"total": 3455.75, "avg": 115.19, "max": 1.07, "min": 534.31, "cnt": 30}, "backward-send":{"total": 1.19, "avg": 0.60, "max": 0.51, "min": 0.69, "cnt": 2}, "backward-recv":{"total": 81.09, "avg": 81.09, "max": 81.09, "min": 81.09, "cnt": 1}, "backward-params-all-reduce":{"total": 493.76, "avg": 493.76, "max": 493.76, "min": 493.76, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.04, "avg": 0.04, "max": 0.04, "min": 0.04, "cnt": 1}, "optimizer":{"total": 296.87, "avg": 296.87, "max": 296.87, "min": 296.87, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.40, "avg": 3.40, "max": 3.40, "min": 3.40, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 256.14, "avg": 256.14, "max": 256.14, "min": 256.14, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.82, "avg": 3.82, "max": 3.82, "min": 3.82, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.61, "avg": 3.61, "max": 3.61, "min": 3.61, "cnt": 1}}}
{"type":"time", "iteration": 120, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.15, "avg": 0.15, "max": 0.15, "min": 0.15, "cnt": 1}, "forward-recv":{"total": 138.10, "avg": 69.05, "max": 0.82, "min": 137.29, "cnt": 2}, "forward-compute":{"total": 1985.88, "avg": 62.06, "max": 56.48, "min": 72.96, "cnt": 32}, "fwd-compute":{"total": 1982.36, "avg": 61.95, "max": 56.38, "min": 72.78, "cnt": 32}, "batch-generator":{"total": 43.77, "avg": 1.37, "max": 0.74, "min": 2.48, "cnt": 32}, "fwd-embedding":{"total": 0.79, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1924.93, "avg": 60.15, "max": 54.93, "min": 69.82, "cnt": 32}, "fwd-layernorm":{"total": 11.05, "avg": 0.09, "max": 0.05, "min": 0.22, "cnt": 128}, "fwd-attn":{"total": 119.39, "avg": 0.93, "max": 0.75, "min": 2.20, "cnt": 128}, "fwd-misc":{"total": 23.53, "avg": 0.18, "max": 0.11, "min": 0.43, "cnt": 128}, "fwd-MLP":{"total": 1747.46, "avg": 13.65, "max": 10.36, "min": 21.04, "cnt": 128}, "MoE_L0_fwd":{"total": 522.06, "avg": 16.31, "max": 13.01, "min": 20.89, "cnt": 32}, "MoEMLP":{"total": 1728.60, "avg": 13.50, "max": 10.25, "min": 20.80, "cnt": 128}, "MoE_L1_fwd":{"total": 419.78, "avg": 13.12, "max": 12.26, "min": 15.79, "cnt": 32}, "MoE_L2_fwd":{"total": 425.29, "avg": 13.29, "max": 12.13, "min": 18.38, "cnt": 32}, "MoE_L3_fwd":{"total": 368.50, "avg": 11.52, "max": 10.29, "min": 14.42, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.04, "cnt": 32}, "forward-send":{"total": 1.22, "avg": 1.22, "max": 1.22, "min": 1.22, "cnt": 1}, "forward-send-backward-recv":{"total": 1351.40, "avg": 43.59, "max": 0.86, "min": 257.84, "cnt": 31}, "backward-compute":{"total": 1835.43, "avg": 57.36, "max": 54.43, "min": 71.26, "cnt": 32}, "MoE_L3_bwd":{"total": 423.63, "avg": 13.24, "max": 10.54, "min": 27.80, "cnt": 32}, "MoE_L2_bwd":{"total": 403.57, "avg": 12.61, "max": 11.72, "min": 13.43, "cnt": 32}, "MoE_L1_bwd":{"total": 404.97, "avg": 12.66, "max": 12.24, "min": 13.11, "cnt": 32}, "MoE_L0_bwd":{"total": 391.69, "avg": 12.24, "max": 11.82, "min": 12.71, "cnt": 32}, "backward-send-forward-recv":{"total": 823.72, "avg": 27.46, "max": 1.24, "min": 155.27, "cnt": 30}, "backward-send":{"total": 1.59, "avg": 0.79, "max": 0.48, "min": 1.11, "cnt": 2}, "backward-recv":{"total": 179.62, "avg": 179.62, "max": 179.62, "min": 179.62, "cnt": 1}, "backward-params-all-reduce":{"total": 487.03, "avg": 487.03, "max": 487.03, "min": 487.03, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.06, "avg": 0.06, "max": 0.06, "min": 0.06, "cnt": 1}, "optimizer":{"total": 304.42, "avg": 304.42, "max": 304.42, "min": 304.42, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 264.18, "avg": 264.18, "max": 264.18, "min": 264.18, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.35, "avg": 3.35, "max": 3.35, "min": 3.35, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.59, "avg": 3.59, "max": 3.59, "min": 3.59, "cnt": 1}}}
{"type":"time", "iteration": 121, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 145.00, "avg": 72.50, "max": 5.86, "min": 139.13, "cnt": 2}, "forward-compute":{"total": 1951.30, "avg": 60.98, "max": 53.89, "min": 72.21, "cnt": 32}, "fwd-compute":{"total": 1948.09, "avg": 60.88, "max": 53.81, "min": 72.08, "cnt": 32}, "batch-generator":{"total": 41.76, "avg": 1.31, "max": 0.76, "min": 2.49, "cnt": 32}, "fwd-embedding":{"total": 0.70, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1893.75, "avg": 59.18, "max": 52.74, "min": 69.96, "cnt": 32}, "fwd-layernorm":{"total": 10.08, "avg": 0.08, "max": 0.06, "min": 0.32, "cnt": 128}, "fwd-attn":{"total": 111.24, "avg": 0.87, "max": 0.75, "min": 2.33, "cnt": 128}, "fwd-misc":{"total": 21.84, "avg": 0.17, "max": 0.12, "min": 0.47, "cnt": 128}, "fwd-MLP":{"total": 1729.57, "avg": 13.51, "max": 10.47, "min": 26.44, "cnt": 128}, "MoE_L0_fwd":{"total": 546.56, "avg": 17.08, "max": 13.14, "min": 26.29, "cnt": 32}, "MoEMLP":{"total": 1712.49, "avg": 13.38, "max": 10.35, "min": 26.21, "cnt": 128}, "MoE_L1_fwd":{"total": 416.68, "avg": 13.02, "max": 12.05, "min": 14.47, "cnt": 32}, "MoE_L2_fwd":{"total": 391.36, "avg": 12.23, "max": 11.45, "min": 15.13, "cnt": 32}, "MoE_L3_fwd":{"total": 364.25, "avg": 11.38, "max": 10.40, "min": 16.57, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 0.60, "avg": 0.60, "max": 0.60, "min": 0.60, "cnt": 1}, "forward-send-backward-recv":{"total": 807.16, "avg": 26.04, "max": 1.17, "min": 137.44, "cnt": 31}, "backward-compute":{"total": 1800.51, "avg": 56.27, "max": 54.67, "min": 59.22, "cnt": 32}, "MoE_L3_bwd":{"total": 392.97, "avg": 12.28, "max": 11.21, "min": 14.39, "cnt": 32}, "MoE_L2_bwd":{"total": 391.61, "avg": 12.24, "max": 11.51, "min": 16.22, "cnt": 32}, "MoE_L1_bwd":{"total": 398.46, "avg": 12.45, "max": 12.10, "min": 13.78, "cnt": 32}, "MoE_L0_bwd":{"total": 396.46, "avg": 12.39, "max": 11.75, "min": 13.95, "cnt": 32}, "backward-send-forward-recv":{"total": 1560.08, "avg": 52.00, "max": 0.96, "min": 255.18, "cnt": 30}, "backward-send":{"total": 1.83, "avg": 0.92, "max": 0.86, "min": 0.98, "cnt": 2}, "backward-recv":{"total": 214.53, "avg": 214.53, "max": 214.53, "min": 214.53, "cnt": 1}, "backward-params-all-reduce":{"total": 488.02, "avg": 488.02, "max": 488.02, "min": 488.02, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 303.40, "avg": 303.40, "max": 303.40, "min": 303.40, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 263.53, "avg": 263.53, "max": 263.53, "min": 263.53, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.31, "avg": 3.31, "max": 3.31, "min": 3.31, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 122, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 140.63, "avg": 70.32, "max": 8.01, "min": 132.62, "cnt": 2}, "forward-compute":{"total": 2013.17, "avg": 62.91, "max": 56.65, "min": 68.21, "cnt": 32}, "fwd-compute":{"total": 2009.50, "avg": 62.80, "max": 56.56, "min": 67.89, "cnt": 32}, "batch-generator":{"total": 45.98, "avg": 1.44, "max": 0.69, "min": 3.19, "cnt": 32}, "fwd-embedding":{"total": 0.77, "avg": 0.02, "max": 0.01, "min": 0.06, "cnt": 32}, "fwd-encoder":{"total": 1949.69, "avg": 60.93, "max": 54.54, "min": 65.01, "cnt": 32}, "fwd-layernorm":{"total": 11.35, "avg": 0.09, "max": 0.06, "min": 0.93, "cnt": 128}, "fwd-attn":{"total": 113.14, "avg": 0.88, "max": 0.74, "min": 1.97, "cnt": 128}, "fwd-misc":{"total": 22.19, "avg": 0.17, "max": 0.11, "min": 0.44, "cnt": 128}, "fwd-MLP":{"total": 1781.50, "avg": 13.92, "max": 11.23, "min": 21.05, "cnt": 128}, "MoE_L0_fwd":{"total": 552.90, "avg": 17.28, "max": 13.79, "min": 20.96, "cnt": 32}, "MoEMLP":{"total": 1764.09, "avg": 13.78, "max": 11.11, "min": 20.91, "cnt": 128}, "MoE_L1_fwd":{"total": 423.81, "avg": 13.24, "max": 12.29, "min": 15.50, "cnt": 32}, "MoE_L2_fwd":{"total": 398.83, "avg": 12.46, "max": 11.56, "min": 15.91, "cnt": 32}, "MoE_L3_fwd":{"total": 395.08, "avg": 12.35, "max": 11.16, "min": 14.84, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 0.50, "avg": 0.50, "max": 0.50, "min": 0.50, "cnt": 1}, "forward-send-backward-recv":{"total": 1328.42, "avg": 42.85, "max": 0.89, "min": 306.59, "cnt": 31}, "backward-compute":{"total": 1800.68, "avg": 56.27, "max": 53.61, "min": 60.40, "cnt": 32}, "MoE_L3_bwd":{"total": 393.36, "avg": 12.29, "max": 10.90, "min": 14.83, "cnt": 32}, "MoE_L2_bwd":{"total": 393.05, "avg": 12.28, "max": 11.44, "min": 13.64, "cnt": 32}, "MoE_L1_bwd":{"total": 400.77, "avg": 12.52, "max": 11.90, "min": 14.10, "cnt": 32}, "MoE_L0_bwd":{"total": 398.77, "avg": 12.46, "max": 11.92, "min": 14.35, "cnt": 32}, "backward-send-forward-recv":{"total": 1338.23, "avg": 44.61, "max": 1.27, "min": 238.29, "cnt": 30}, "backward-send":{"total": 1.44, "avg": 0.72, "max": 0.54, "min": 0.90, "cnt": 2}, "backward-recv":{"total": 67.39, "avg": 67.39, "max": 67.39, "min": 67.39, "cnt": 1}, "backward-params-all-reduce":{"total": 490.32, "avg": 490.32, "max": 490.32, "min": 490.32, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 305.24, "avg": 305.24, "max": 305.24, "min": 305.24, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 265.26, "avg": 265.26, "max": 265.26, "min": 265.26, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 123, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 137.66, "avg": 68.83, "max": 0.71, "min": 136.95, "cnt": 2}, "forward-compute":{"total": 2003.90, "avg": 62.62, "max": 55.22, "min": 70.12, "cnt": 32}, "fwd-compute":{"total": 2000.66, "avg": 62.52, "max": 55.14, "min": 70.04, "cnt": 32}, "batch-generator":{"total": 42.29, "avg": 1.32, "max": 0.68, "min": 2.61, "cnt": 32}, "fwd-embedding":{"total": 0.69, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1945.00, "avg": 60.78, "max": 53.39, "min": 68.70, "cnt": 32}, "fwd-layernorm":{"total": 10.26, "avg": 0.08, "max": 0.05, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 112.80, "avg": 0.88, "max": 0.75, "min": 2.27, "cnt": 128}, "fwd-misc":{"total": 22.28, "avg": 0.17, "max": 0.11, "min": 0.59, "cnt": 128}, "fwd-MLP":{"total": 1777.59, "avg": 13.89, "max": 10.82, "min": 23.77, "cnt": 128}, "MoE_L0_fwd":{"total": 552.68, "avg": 17.27, "max": 13.25, "min": 23.69, "cnt": 32}, "MoEMLP":{"total": 1759.23, "avg": 13.74, "max": 10.71, "min": 23.64, "cnt": 128}, "MoE_L1_fwd":{"total": 427.18, "avg": 13.35, "max": 12.28, "min": 16.47, "cnt": 32}, "MoE_L2_fwd":{"total": 404.29, "avg": 12.63, "max": 11.23, "min": 17.75, "cnt": 32}, "MoE_L3_fwd":{"total": 381.90, "avg": 11.93, "max": 10.75, "min": 16.03, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.61, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 0.45, "avg": 0.45, "max": 0.45, "min": 0.45, "cnt": 1}, "forward-send-backward-recv":{"total": 482.79, "avg": 15.57, "max": 1.00, "min": 167.96, "cnt": 31}, "backward-compute":{"total": 1804.29, "avg": 56.38, "max": 55.19, "min": 58.44, "cnt": 32}, "MoE_L3_bwd":{"total": 409.03, "avg": 12.78, "max": 11.72, "min": 14.99, "cnt": 32}, "MoE_L2_bwd":{"total": 386.12, "avg": 12.07, "max": 11.25, "min": 12.83, "cnt": 32}, "MoE_L1_bwd":{"total": 404.95, "avg": 12.65, "max": 12.19, "min": 13.68, "cnt": 32}, "MoE_L0_bwd":{"total": 387.91, "avg": 12.12, "max": 11.88, "min": 12.43, "cnt": 32}, "backward-send-forward-recv":{"total": 2241.71, "avg": 74.72, "max": 0.93, "min": 544.61, "cnt": 30}, "backward-send":{"total": 2.26, "avg": 1.13, "max": 0.86, "min": 1.41, "cnt": 2}, "backward-recv":{"total": 80.61, "avg": 80.61, "max": 80.61, "min": 80.61, "cnt": 1}, "backward-params-all-reduce":{"total": 488.25, "avg": 488.25, "max": 488.25, "min": 488.25, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 307.91, "avg": 307.91, "max": 307.91, "min": 307.91, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 268.03, "avg": 268.03, "max": 268.03, "min": 268.03, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 124, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 133.29, "avg": 66.64, "max": 2.70, "min": 130.59, "cnt": 2}, "forward-compute":{"total": 1960.20, "avg": 61.26, "max": 55.01, "min": 67.93, "cnt": 32}, "fwd-compute":{"total": 1956.69, "avg": 61.15, "max": 54.94, "min": 67.77, "cnt": 32}, "batch-generator":{"total": 41.29, "avg": 1.29, "max": 0.72, "min": 2.03, "cnt": 32}, "fwd-embedding":{"total": 0.72, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1902.45, "avg": 59.45, "max": 53.47, "min": 65.43, "cnt": 32}, "fwd-layernorm":{"total": 10.23, "avg": 0.08, "max": 0.05, "min": 0.22, "cnt": 128}, "fwd-attn":{"total": 111.59, "avg": 0.87, "max": 0.75, "min": 1.51, "cnt": 128}, "fwd-misc":{"total": 21.30, "avg": 0.17, "max": 0.11, "min": 0.38, "cnt": 128}, "fwd-MLP":{"total": 1737.69, "avg": 13.58, "max": 11.18, "min": 20.42, "cnt": 128}, "MoE_L0_fwd":{"total": 532.58, "avg": 16.64, "max": 12.79, "min": 20.33, "cnt": 32}, "MoEMLP":{"total": 1720.17, "avg": 13.44, "max": 11.07, "min": 20.28, "cnt": 128}, "MoE_L1_fwd":{"total": 421.17, "avg": 13.16, "max": 11.90, "min": 15.01, "cnt": 32}, "MoE_L2_fwd":{"total": 392.54, "avg": 12.27, "max": 11.11, "min": 17.64, "cnt": 32}, "MoE_L3_fwd":{"total": 380.32, "avg": 11.88, "max": 11.22, "min": 12.92, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 0.61, "avg": 0.61, "max": 0.61, "min": 0.61, "cnt": 1}, "forward-send-backward-recv":{"total": 2256.03, "avg": 72.78, "max": 0.96, "min": 285.17, "cnt": 31}, "backward-compute":{"total": 1815.68, "avg": 56.74, "max": 55.23, "min": 58.52, "cnt": 32}, "MoE_L3_bwd":{"total": 428.92, "avg": 13.40, "max": 12.10, "min": 15.70, "cnt": 32}, "MoE_L2_bwd":{"total": 381.34, "avg": 11.92, "max": 11.13, "min": 12.88, "cnt": 32}, "MoE_L1_bwd":{"total": 405.16, "avg": 12.66, "max": 12.41, "min": 12.96, "cnt": 32}, "MoE_L0_bwd":{"total": 384.43, "avg": 12.01, "max": 11.46, "min": 13.09, "cnt": 32}, "backward-send-forward-recv":{"total": 1022.18, "avg": 34.07, "max": 1.10, "min": 389.23, "cnt": 30}, "backward-send":{"total": 1.08, "avg": 0.54, "max": 0.53, "min": 0.55, "cnt": 2}, "backward-recv":{"total": 149.94, "avg": 149.94, "max": 149.94, "min": 149.94, "cnt": 1}, "backward-params-all-reduce":{"total": 495.98, "avg": 495.98, "max": 495.98, "min": 495.98, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.04, "avg": 0.04, "max": 0.04, "min": 0.04, "cnt": 1}, "optimizer":{"total": 295.14, "avg": 295.14, "max": 295.14, "min": 295.14, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.40, "avg": 3.40, "max": 3.40, "min": 3.40, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 255.03, "avg": 255.03, "max": 255.03, "min": 255.03, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.56, "avg": 3.56, "max": 3.56, "min": 3.56, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.49, "avg": 3.49, "max": 3.49, "min": 3.49, "cnt": 1}}}
{"type":"time", "iteration": 125, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 136.90, "avg": 68.45, "max": 0.94, "min": 135.96, "cnt": 2}, "forward-compute":{"total": 1907.38, "avg": 59.61, "max": 53.12, "min": 71.00, "cnt": 32}, "fwd-compute":{"total": 1904.57, "avg": 59.52, "max": 53.05, "min": 70.86, "cnt": 32}, "batch-generator":{"total": 38.32, "avg": 1.20, "max": 0.73, "min": 1.70, "cnt": 32}, "fwd-embedding":{"total": 0.58, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1854.33, "avg": 57.95, "max": 51.95, "min": 68.81, "cnt": 32}, "fwd-layernorm":{"total": 9.03, "avg": 0.07, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 106.91, "avg": 0.84, "max": 0.74, "min": 1.44, "cnt": 128}, "fwd-misc":{"total": 19.77, "avg": 0.15, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1698.90, "avg": 13.27, "max": 10.80, "min": 24.20, "cnt": 128}, "MoE_L0_fwd":{"total": 515.00, "avg": 16.09, "max": 12.57, "min": 24.12, "cnt": 32}, "MoEMLP":{"total": 1682.75, "avg": 13.15, "max": 10.69, "min": 24.07, "cnt": 128}, "MoE_L1_fwd":{"total": 416.42, "avg": 13.01, "max": 11.94, "min": 14.49, "cnt": 32}, "MoE_L2_fwd":{"total": 385.68, "avg": 12.05, "max": 11.11, "min": 16.11, "cnt": 32}, "MoE_L3_fwd":{"total": 371.71, "avg": 11.62, "max": 10.74, "min": 15.11, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.04, "cnt": 32}, "forward-send":{"total": 1.29, "avg": 1.29, "max": 1.29, "min": 1.29, "cnt": 1}, "forward-send-backward-recv":{"total": 174.49, "avg": 5.63, "max": 0.84, "min": 70.75, "cnt": 31}, "backward-compute":{"total": 1804.75, "avg": 56.40, "max": 54.05, "min": 60.62, "cnt": 32}, "MoE_L3_bwd":{"total": 415.75, "avg": 12.99, "max": 11.70, "min": 16.26, "cnt": 32}, "MoE_L2_bwd":{"total": 383.86, "avg": 12.00, "max": 11.15, "min": 12.95, "cnt": 32}, "MoE_L1_bwd":{"total": 408.25, "avg": 12.76, "max": 11.96, "min": 13.39, "cnt": 32}, "MoE_L0_bwd":{"total": 383.84, "avg": 12.00, "max": 11.58, "min": 13.32, "cnt": 32}, "backward-send-forward-recv":{"total": 4015.66, "avg": 133.86, "max": 1.97, "min": 1032.16, "cnt": 30}, "backward-send":{"total": 1.34, "avg": 0.67, "max": 0.66, "min": 0.68, "cnt": 2}, "backward-recv":{"total": 307.86, "avg": 307.86, "max": 307.86, "min": 307.86, "cnt": 1}, "backward-params-all-reduce":{"total": 488.13, "avg": 488.13, "max": 488.13, "min": 488.13, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 303.10, "avg": 303.10, "max": 303.10, "min": 303.10, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 263.19, "avg": 263.19, "max": 263.19, "min": 263.19, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.48, "avg": 3.48, "max": 3.48, "min": 3.48, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 126, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 143.74, "avg": 71.87, "max": 6.67, "min": 137.07, "cnt": 2}, "forward-compute":{"total": 1926.28, "avg": 60.20, "max": 53.76, "min": 73.05, "cnt": 32}, "fwd-compute":{"total": 1922.98, "avg": 60.09, "max": 53.69, "min": 72.98, "cnt": 32}, "batch-generator":{"total": 42.60, "avg": 1.33, "max": 0.69, "min": 3.19, "cnt": 32}, "fwd-embedding":{"total": 0.63, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1867.81, "avg": 58.37, "max": 52.65, "min": 71.35, "cnt": 32}, "fwd-layernorm":{"total": 9.70, "avg": 0.08, "max": 0.05, "min": 0.18, "cnt": 128}, "fwd-attn":{"total": 108.32, "avg": 0.85, "max": 0.74, "min": 1.49, "cnt": 128}, "fwd-misc":{"total": 20.46, "avg": 0.16, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1708.73, "avg": 13.35, "max": 11.05, "min": 22.14, "cnt": 128}, "MoE_L0_fwd":{"total": 518.94, "avg": 16.22, "max": 12.95, "min": 22.06, "cnt": 32}, "MoEMLP":{"total": 1691.79, "avg": 13.22, "max": 10.94, "min": 22.01, "cnt": 128}, "MoE_L1_fwd":{"total": 420.13, "avg": 13.13, "max": 11.92, "min": 20.66, "cnt": 32}, "MoE_L2_fwd":{"total": 377.16, "avg": 11.79, "max": 10.98, "min": 14.12, "cnt": 32}, "MoE_L3_fwd":{"total": 381.86, "avg": 11.93, "max": 11.04, "min": 16.09, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.05, "cnt": 32}, "forward-send":{"total": 0.69, "avg": 0.69, "max": 0.69, "min": 0.69, "cnt": 1}, "forward-send-backward-recv":{"total": 270.27, "avg": 8.72, "max": 0.83, "min": 84.04, "cnt": 31}, "backward-compute":{"total": 1791.72, "avg": 55.99, "max": 52.66, "min": 59.51, "cnt": 32}, "MoE_L3_bwd":{"total": 424.96, "avg": 13.28, "max": 11.56, "min": 15.69, "cnt": 32}, "MoE_L2_bwd":{"total": 382.58, "avg": 11.96, "max": 11.24, "min": 13.30, "cnt": 32}, "MoE_L1_bwd":{"total": 389.73, "avg": 12.18, "max": 11.49, "min": 12.86, "cnt": 32}, "MoE_L0_bwd":{"total": 382.22, "avg": 11.94, "max": 11.43, "min": 13.15, "cnt": 32}, "backward-send-forward-recv":{"total": 3094.63, "avg": 103.15, "max": 1.34, "min": 821.96, "cnt": 30}, "backward-send":{"total": 1.47, "avg": 0.74, "max": 0.53, "min": 0.95, "cnt": 2}, "backward-recv":{"total": 77.45, "avg": 77.45, "max": 77.45, "min": 77.45, "cnt": 1}, "backward-params-all-reduce":{"total": 491.41, "avg": 491.41, "max": 491.41, "min": 491.41, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 307.39, "avg": 307.39, "max": 307.39, "min": 307.39, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 267.43, "avg": 267.43, "max": 267.43, "min": 267.43, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 127, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.06, "avg": 0.06, "max": 0.06, "min": 0.06, "cnt": 1}, "forward-recv":{"total": 145.43, "avg": 72.71, "max": 4.30, "min": 141.13, "cnt": 2}, "forward-compute":{"total": 1879.69, "avg": 58.74, "max": 53.00, "min": 66.80, "cnt": 32}, "fwd-compute":{"total": 1876.81, "avg": 58.65, "max": 52.93, "min": 66.73, "cnt": 32}, "batch-generator":{"total": 34.94, "avg": 1.09, "max": 0.65, "min": 1.63, "cnt": 32}, "fwd-embedding":{"total": 0.59, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1829.82, "avg": 57.18, "max": 51.87, "min": 65.37, "cnt": 32}, "fwd-layernorm":{"total": 9.20, "avg": 0.07, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 106.14, "avg": 0.83, "max": 0.74, "min": 1.42, "cnt": 128}, "fwd-misc":{"total": 19.91, "avg": 0.16, "max": 0.11, "min": 0.69, "cnt": 128}, "fwd-MLP":{"total": 1674.64, "avg": 13.08, "max": 10.80, "min": 20.99, "cnt": 128}, "MoE_L0_fwd":{"total": 497.17, "avg": 15.54, "max": 12.55, "min": 20.89, "cnt": 32}, "MoEMLP":{"total": 1658.47, "avg": 12.96, "max": 10.70, "min": 20.84, "cnt": 128}, "MoE_L1_fwd":{"total": 409.77, "avg": 12.81, "max": 12.09, "min": 14.42, "cnt": 32}, "MoE_L2_fwd":{"total": 381.37, "avg": 11.92, "max": 10.90, "min": 15.99, "cnt": 32}, "MoE_L3_fwd":{"total": 376.15, "avg": 11.75, "max": 10.74, "min": 14.89, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 0.46, "avg": 0.46, "max": 0.46, "min": 0.46, "cnt": 1}, "forward-send-backward-recv":{"total": 215.10, "avg": 6.94, "max": 0.82, "min": 67.37, "cnt": 31}, "backward-compute":{"total": 1819.90, "avg": 56.87, "max": 54.39, "min": 60.74, "cnt": 32}, "MoE_L3_bwd":{"total": 441.42, "avg": 13.79, "max": 11.44, "min": 16.17, "cnt": 32}, "MoE_L2_bwd":{"total": 378.11, "avg": 11.82, "max": 11.27, "min": 13.08, "cnt": 32}, "MoE_L1_bwd":{"total": 405.67, "avg": 12.68, "max": 11.73, "min": 14.72, "cnt": 32}, "MoE_L0_bwd":{"total": 382.60, "avg": 11.96, "max": 11.35, "min": 14.54, "cnt": 32}, "backward-send-forward-recv":{"total": 2070.16, "avg": 69.01, "max": 2.20, "min": 347.12, "cnt": 30}, "backward-send":{"total": 1.17, "avg": 0.59, "max": 0.49, "min": 0.68, "cnt": 2}, "backward-recv":{"total": 73.25, "avg": 73.25, "max": 73.25, "min": 73.25, "cnt": 1}, "backward-params-all-reduce":{"total": 487.18, "avg": 487.18, "max": 487.18, "min": 487.18, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 308.64, "avg": 308.64, "max": 308.64, "min": 308.64, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 268.87, "avg": 268.87, "max": 268.87, "min": 268.87, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 128, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 138.95, "avg": 69.47, "max": 3.56, "min": 135.39, "cnt": 2}, "forward-compute":{"total": 1876.77, "avg": 58.65, "max": 53.50, "min": 63.24, "cnt": 32}, "fwd-compute":{"total": 1873.58, "avg": 58.55, "max": 53.43, "min": 63.12, "cnt": 32}, "batch-generator":{"total": 40.71, "avg": 1.27, "max": 0.63, "min": 2.78, "cnt": 32}, "fwd-embedding":{"total": 0.65, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1820.90, "avg": 56.90, "max": 52.46, "min": 61.40, "cnt": 32}, "fwd-layernorm":{"total": 9.56, "avg": 0.07, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 108.52, "avg": 0.85, "max": 0.74, "min": 1.60, "cnt": 128}, "fwd-misc":{"total": 20.45, "avg": 0.16, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1661.99, "avg": 12.98, "max": 10.62, "min": 20.74, "cnt": 128}, "MoE_L0_fwd":{"total": 511.30, "avg": 15.98, "max": 13.03, "min": 20.66, "cnt": 32}, "MoEMLP":{"total": 1645.64, "avg": 12.86, "max": 10.50, "min": 20.62, "cnt": 128}, "MoE_L1_fwd":{"total": 413.40, "avg": 12.92, "max": 12.05, "min": 14.55, "cnt": 32}, "MoE_L2_fwd":{"total": 370.17, "avg": 11.57, "max": 11.05, "min": 12.21, "cnt": 32}, "MoE_L3_fwd":{"total": 356.90, "avg": 11.15, "max": 10.55, "min": 12.74, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.56, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 0.43, "avg": 0.43, "max": 0.43, "min": 0.43, "cnt": 1}, "forward-send-backward-recv":{"total": 1809.63, "avg": 58.38, "max": 1.41, "min": 287.67, "cnt": 31}, "backward-compute":{"total": 1757.41, "avg": 54.92, "max": 53.03, "min": 58.24, "cnt": 32}, "MoE_L3_bwd":{"total": 392.44, "avg": 12.26, "max": 11.35, "min": 13.57, "cnt": 32}, "MoE_L2_bwd":{"total": 373.73, "avg": 11.68, "max": 11.02, "min": 13.02, "cnt": 32}, "MoE_L1_bwd":{"total": 401.20, "avg": 12.54, "max": 12.08, "min": 14.43, "cnt": 32}, "MoE_L0_bwd":{"total": 370.73, "avg": 11.59, "max": 11.21, "min": 12.17, "cnt": 32}, "backward-send-forward-recv":{"total": 2244.04, "avg": 74.80, "max": 1.49, "min": 496.32, "cnt": 30}, "backward-send":{"total": 1.49, "avg": 0.75, "max": 0.73, "min": 0.76, "cnt": 2}, "backward-recv":{"total": 73.91, "avg": 73.91, "max": 73.91, "min": 73.91, "cnt": 1}, "backward-params-all-reduce":{"total": 490.04, "avg": 490.04, "max": 490.04, "min": 490.04, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 302.97, "avg": 302.97, "max": 302.97, "min": 302.97, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 263.01, "avg": 263.01, "max": 263.01, "min": 263.01, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.54, "avg": 3.54, "max": 3.54, "min": 3.54, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 129, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 136.25, "avg": 68.13, "max": 2.87, "min": 133.38, "cnt": 2}, "forward-compute":{"total": 1898.40, "avg": 59.32, "max": 52.60, "min": 64.59, "cnt": 32}, "fwd-compute":{"total": 1895.23, "avg": 59.23, "max": 52.53, "min": 64.47, "cnt": 32}, "batch-generator":{"total": 40.11, "avg": 1.25, "max": 0.68, "min": 2.86, "cnt": 32}, "fwd-embedding":{"total": 0.65, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1842.45, "avg": 57.58, "max": 51.55, "min": 63.14, "cnt": 32}, "fwd-layernorm":{"total": 9.65, "avg": 0.08, "max": 0.05, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 109.23, "avg": 0.85, "max": 0.74, "min": 2.38, "cnt": 128}, "fwd-misc":{"total": 21.22, "avg": 0.17, "max": 0.12, "min": 0.42, "cnt": 128}, "fwd-MLP":{"total": 1681.60, "avg": 13.14, "max": 10.58, "min": 22.92, "cnt": 128}, "MoE_L0_fwd":{"total": 519.69, "avg": 16.24, "max": 12.61, "min": 22.85, "cnt": 32}, "MoEMLP":{"total": 1664.74, "avg": 13.01, "max": 10.46, "min": 22.80, "cnt": 128}, "MoE_L1_fwd":{"total": 411.80, "avg": 12.87, "max": 11.86, "min": 14.09, "cnt": 32}, "MoE_L2_fwd":{"total": 367.10, "avg": 11.47, "max": 10.74, "min": 12.53, "cnt": 32}, "MoE_L3_fwd":{"total": 372.50, "avg": 11.64, "max": 10.51, "min": 14.71, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 0.87, "avg": 0.87, "max": 0.87, "min": 0.87, "cnt": 1}, "forward-send-backward-recv":{"total": 514.46, "avg": 16.60, "max": 1.05, "min": 107.94, "cnt": 31}, "backward-compute":{"total": 1737.50, "avg": 54.30, "max": 51.94, "min": 58.02, "cnt": 32}, "MoE_L3_bwd":{"total": 397.45, "avg": 12.42, "max": 11.40, "min": 15.74, "cnt": 32}, "MoE_L2_bwd":{"total": 373.65, "avg": 11.68, "max": 11.01, "min": 14.95, "cnt": 32}, "MoE_L1_bwd":{"total": 385.94, "avg": 12.06, "max": 11.66, "min": 14.46, "cnt": 32}, "MoE_L0_bwd":{"total": 365.42, "avg": 11.42, "max": 10.84, "min": 11.95, "cnt": 32}, "backward-send-forward-recv":{"total": 2670.50, "avg": 89.02, "max": 1.13, "min": 399.29, "cnt": 30}, "backward-send":{"total": 2.06, "avg": 1.03, "max": 0.88, "min": 1.18, "cnt": 2}, "backward-recv":{"total": 72.69, "avg": 72.69, "max": 72.69, "min": 72.69, "cnt": 1}, "backward-params-all-reduce":{"total": 488.78, "avg": 488.78, "max": 488.78, "min": 488.78, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 304.56, "avg": 304.56, "max": 304.56, "min": 304.56, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 264.44, "avg": 264.44, "max": 264.44, "min": 264.44, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.55, "avg": 3.55, "max": 3.55, "min": 3.55, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 130, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 133.67, "avg": 66.83, "max": 0.67, "min": 132.99, "cnt": 2}, "forward-compute":{"total": 1933.72, "avg": 60.43, "max": 52.57, "min": 69.95, "cnt": 32}, "fwd-compute":{"total": 1930.73, "avg": 60.34, "max": 52.50, "min": 69.88, "cnt": 32}, "batch-generator":{"total": 37.61, "avg": 1.18, "max": 0.67, "min": 1.83, "cnt": 32}, "fwd-embedding":{"total": 0.62, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1880.76, "avg": 58.77, "max": 51.39, "min": 68.76, "cnt": 32}, "fwd-layernorm":{"total": 9.49, "avg": 0.07, "max": 0.06, "min": 0.17, "cnt": 128}, "fwd-attn":{"total": 107.26, "avg": 0.84, "max": 0.74, "min": 1.44, "cnt": 128}, "fwd-misc":{"total": 20.60, "avg": 0.16, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1722.90, "avg": 13.46, "max": 10.75, "min": 22.99, "cnt": 128}, "MoE_L0_fwd":{"total": 520.08, "avg": 16.25, "max": 12.17, "min": 22.92, "cnt": 32}, "MoEMLP":{"total": 1706.32, "avg": 13.33, "max": 10.64, "min": 22.87, "cnt": 128}, "MoE_L1_fwd":{"total": 429.91, "avg": 13.43, "max": 12.06, "min": 17.73, "cnt": 32}, "MoE_L2_fwd":{"total": 386.30, "avg": 12.07, "max": 11.06, "min": 16.36, "cnt": 32}, "MoE_L3_fwd":{"total": 376.27, "avg": 11.76, "max": 10.69, "min": 15.47, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 0.45, "avg": 0.45, "max": 0.45, "min": 0.45, "cnt": 1}, "forward-send-backward-recv":{"total": 708.53, "avg": 22.86, "max": 0.87, "min": 199.07, "cnt": 31}, "backward-compute":{"total": 1741.34, "avg": 54.42, "max": 53.00, "min": 56.81, "cnt": 32}, "MoE_L3_bwd":{"total": 405.86, "avg": 12.68, "max": 11.68, "min": 14.97, "cnt": 32}, "MoE_L2_bwd":{"total": 373.55, "avg": 11.67, "max": 10.89, "min": 12.20, "cnt": 32}, "MoE_L1_bwd":{"total": 385.28, "avg": 12.04, "max": 11.37, "min": 13.03, "cnt": 32}, "MoE_L0_bwd":{"total": 365.25, "avg": 11.41, "max": 10.88, "min": 11.88, "cnt": 32}, "backward-send-forward-recv":{"total": 2298.78, "avg": 76.63, "max": 1.91, "min": 855.30, "cnt": 30}, "backward-send":{"total": 1.38, "avg": 0.69, "max": 0.58, "min": 0.80, "cnt": 2}, "backward-recv":{"total": 72.02, "avg": 72.02, "max": 72.02, "min": 72.02, "cnt": 1}, "backward-params-all-reduce":{"total": 496.25, "avg": 496.25, "max": 496.25, "min": 496.25, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 300.57, "avg": 300.57, "max": 300.57, "min": 300.57, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 260.58, "avg": 260.58, "max": 260.58, "min": 260.58, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.61, "avg": 3.61, "max": 3.61, "min": 3.61, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 131, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.12, "avg": 0.12, "max": 0.12, "min": 0.12, "cnt": 1}, "forward-recv":{"total": 136.28, "avg": 68.14, "max": 0.71, "min": 135.57, "cnt": 2}, "forward-compute":{"total": 1968.65, "avg": 61.52, "max": 53.39, "min": 71.53, "cnt": 32}, "fwd-compute":{"total": 1965.45, "avg": 61.42, "max": 53.32, "min": 71.44, "cnt": 32}, "batch-generator":{"total": 41.73, "avg": 1.30, "max": 0.69, "min": 3.06, "cnt": 32}, "fwd-embedding":{"total": 0.68, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1911.18, "avg": 59.72, "max": 52.19, "min": 69.98, "cnt": 32}, "fwd-layernorm":{"total": 10.04, "avg": 0.08, "max": 0.05, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 114.28, "avg": 0.89, "max": 0.74, "min": 1.78, "cnt": 128}, "fwd-misc":{"total": 21.75, "avg": 0.17, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1743.37, "avg": 13.62, "max": 10.60, "min": 26.71, "cnt": 128}, "MoE_L0_fwd":{"total": 537.87, "avg": 16.81, "max": 12.63, "min": 26.62, "cnt": 32}, "MoEMLP":{"total": 1725.68, "avg": 13.48, "max": 10.49, "min": 26.57, "cnt": 128}, "MoE_L1_fwd":{"total": 439.68, "avg": 13.74, "max": 11.89, "min": 20.01, "cnt": 32}, "MoE_L2_fwd":{"total": 389.48, "avg": 12.17, "max": 11.04, "min": 14.73, "cnt": 32}, "MoE_L3_fwd":{"total": 365.17, "avg": 11.41, "max": 10.53, "min": 14.43, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 0.57, "avg": 0.57, "max": 0.57, "min": 0.57, "cnt": 1}, "forward-send-backward-recv":{"total": 846.95, "avg": 27.32, "max": 1.31, "min": 181.20, "cnt": 31}, "backward-compute":{"total": 1833.71, "avg": 57.30, "max": 53.40, "min": 126.47, "cnt": 32}, "MoE_L3_bwd":{"total": 407.59, "avg": 12.74, "max": 11.83, "min": 15.10, "cnt": 32}, "MoE_L2_bwd":{"total": 380.86, "avg": 11.90, "max": 11.04, "min": 12.79, "cnt": 32}, "MoE_L1_bwd":{"total": 461.18, "avg": 14.41, "max": 11.44, "min": 84.49, "cnt": 32}, "MoE_L0_bwd":{"total": 371.19, "avg": 11.60, "max": 10.80, "min": 13.53, "cnt": 32}, "backward-send-forward-recv":{"total": 2172.98, "avg": 72.43, "max": 2.21, "min": 358.68, "cnt": 30}, "backward-send":{"total": 1.97, "avg": 0.99, "max": 0.91, "min": 1.06, "cnt": 2}, "backward-recv":{"total": 72.70, "avg": 72.70, "max": 72.70, "min": 72.70, "cnt": 1}, "backward-params-all-reduce":{"total": 488.93, "avg": 488.93, "max": 488.93, "min": 488.93, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.10, "avg": 0.10, "max": 0.10, "min": 0.10, "cnt": 1}, "optimizer":{"total": 300.95, "avg": 300.95, "max": 300.95, "min": 300.95, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.48, "avg": 3.48, "max": 3.48, "min": 3.48, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 260.70, "avg": 260.70, "max": 260.70, "min": 260.70, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.47, "avg": 3.47, "max": 3.47, "min": 3.47, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.50, "avg": 3.50, "max": 3.50, "min": 3.50, "cnt": 1}}}
{"type":"time", "iteration": 132, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 141.55, "avg": 70.78, "max": 1.58, "min": 139.98, "cnt": 2}, "forward-compute":{"total": 1898.28, "avg": 59.32, "max": 52.83, "min": 66.57, "cnt": 32}, "fwd-compute":{"total": 1895.07, "avg": 59.22, "max": 52.76, "min": 66.38, "cnt": 32}, "batch-generator":{"total": 42.07, "avg": 1.31, "max": 0.64, "min": 3.12, "cnt": 32}, "fwd-embedding":{"total": 0.63, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1840.37, "avg": 57.51, "max": 51.14, "min": 63.58, "cnt": 32}, "fwd-layernorm":{"total": 9.67, "avg": 0.08, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 111.16, "avg": 0.87, "max": 0.74, "min": 2.37, "cnt": 128}, "fwd-misc":{"total": 21.69, "avg": 0.17, "max": 0.11, "min": 0.80, "cnt": 128}, "fwd-MLP":{"total": 1676.90, "avg": 13.10, "max": 10.77, "min": 20.85, "cnt": 128}, "MoE_L0_fwd":{"total": 498.05, "avg": 15.56, "max": 12.10, "min": 20.78, "cnt": 32}, "MoEMLP":{"total": 1659.80, "avg": 12.97, "max": 10.66, "min": 20.72, "cnt": 128}, "MoE_L1_fwd":{"total": 413.00, "avg": 12.91, "max": 11.97, "min": 15.18, "cnt": 32}, "MoE_L2_fwd":{"total": 380.36, "avg": 11.89, "max": 11.03, "min": 14.61, "cnt": 32}, "MoE_L3_fwd":{"total": 374.81, "avg": 11.71, "max": 10.71, "min": 15.49, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 0.58, "avg": 0.58, "max": 0.58, "min": 0.58, "cnt": 1}, "forward-send-backward-recv":{"total": 633.63, "avg": 20.44, "max": 0.84, "min": 136.04, "cnt": 31}, "backward-compute":{"total": 1747.26, "avg": 54.60, "max": 52.72, "min": 58.26, "cnt": 32}, "MoE_L3_bwd":{"total": 411.93, "avg": 12.87, "max": 11.50, "min": 14.37, "cnt": 32}, "MoE_L2_bwd":{"total": 374.92, "avg": 11.72, "max": 10.92, "min": 12.42, "cnt": 32}, "MoE_L1_bwd":{"total": 383.05, "avg": 11.97, "max": 11.17, "min": 14.74, "cnt": 32}, "MoE_L0_bwd":{"total": 361.71, "avg": 11.30, "max": 10.86, "min": 12.40, "cnt": 32}, "backward-send-forward-recv":{"total": 2121.22, "avg": 70.71, "max": 2.33, "min": 759.21, "cnt": 30}, "backward-send":{"total": 1.23, "avg": 0.61, "max": 0.49, "min": 0.73, "cnt": 2}, "backward-recv":{"total": 79.64, "avg": 79.64, "max": 79.64, "min": 79.64, "cnt": 1}, "backward-params-all-reduce":{"total": 489.28, "avg": 489.28, "max": 489.28, "min": 489.28, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 302.82, "avg": 302.82, "max": 302.82, "min": 302.82, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 263.02, "avg": 263.02, "max": 263.02, "min": 263.02, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 133, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 148.01, "avg": 74.00, "max": 5.36, "min": 142.65, "cnt": 2}, "forward-compute":{"total": 1961.13, "avg": 61.29, "max": 54.59, "min": 70.46, "cnt": 32}, "fwd-compute":{"total": 1957.77, "avg": 61.18, "max": 54.52, "min": 70.38, "cnt": 32}, "batch-generator":{"total": 40.08, "avg": 1.25, "max": 0.63, "min": 1.85, "cnt": 32}, "fwd-embedding":{"total": 0.76, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1904.79, "avg": 59.52, "max": 53.02, "min": 69.25, "cnt": 32}, "fwd-layernorm":{"total": 10.15, "avg": 0.08, "max": 0.05, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 111.35, "avg": 0.87, "max": 0.74, "min": 1.47, "cnt": 128}, "fwd-misc":{"total": 21.39, "avg": 0.17, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1740.57, "avg": 13.60, "max": 10.59, "min": 22.08, "cnt": 128}, "MoE_L0_fwd":{"total": 545.78, "avg": 17.06, "max": 12.77, "min": 22.00, "cnt": 32}, "MoEMLP":{"total": 1723.28, "avg": 13.46, "max": 10.48, "min": 21.96, "cnt": 128}, "MoE_L1_fwd":{"total": 428.19, "avg": 13.38, "max": 12.12, "min": 14.96, "cnt": 32}, "MoE_L2_fwd":{"total": 384.37, "avg": 12.01, "max": 11.17, "min": 14.70, "cnt": 32}, "MoE_L3_fwd":{"total": 371.42, "avg": 11.61, "max": 10.52, "min": 18.01, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 0.43, "avg": 0.43, "max": 0.43, "min": 0.43, "cnt": 1}, "forward-send-backward-recv":{"total": 1354.68, "avg": 43.70, "max": 0.93, "min": 277.31, "cnt": 31}, "backward-compute":{"total": 1735.60, "avg": 54.24, "max": 51.24, "min": 56.77, "cnt": 32}, "MoE_L3_bwd":{"total": 401.86, "avg": 12.56, "max": 11.38, "min": 14.05, "cnt": 32}, "MoE_L2_bwd":{"total": 379.67, "avg": 11.86, "max": 10.96, "min": 12.87, "cnt": 32}, "MoE_L1_bwd":{"total": 373.71, "avg": 11.68, "max": 10.95, "min": 13.13, "cnt": 32}, "MoE_L0_bwd":{"total": 363.11, "avg": 11.35, "max": 10.81, "min": 12.42, "cnt": 32}, "backward-send-forward-recv":{"total": 889.85, "avg": 29.66, "max": 0.92, "min": 271.06, "cnt": 30}, "backward-send":{"total": 1.88, "avg": 0.94, "max": 0.83, "min": 1.05, "cnt": 2}, "backward-recv":{"total": 78.58, "avg": 78.58, "max": 78.58, "min": 78.58, "cnt": 1}, "backward-params-all-reduce":{"total": 484.46, "avg": 484.46, "max": 484.46, "min": 484.46, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "optimizer":{"total": 304.87, "avg": 304.87, "max": 304.87, "min": 304.87, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.91, "avg": 3.91, "max": 3.91, "min": 3.91, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 264.36, "avg": 264.36, "max": 264.36, "min": 264.36, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.33, "avg": 3.33, "max": 3.33, "min": 3.33, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.51, "avg": 3.51, "max": 3.51, "min": 3.51, "cnt": 1}}}
{"type":"time", "iteration": 134, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 129.40, "avg": 64.70, "max": 1.19, "min": 128.21, "cnt": 2}, "forward-compute":{"total": 1972.11, "avg": 61.63, "max": 53.63, "min": 67.95, "cnt": 32}, "fwd-compute":{"total": 1968.71, "avg": 61.52, "max": 53.56, "min": 67.86, "cnt": 32}, "batch-generator":{"total": 39.14, "avg": 1.22, "max": 0.75, "min": 1.67, "cnt": 32}, "fwd-embedding":{"total": 0.72, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1916.61, "avg": 59.89, "max": 52.50, "min": 66.45, "cnt": 32}, "fwd-layernorm":{"total": 10.40, "avg": 0.08, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 109.97, "avg": 0.86, "max": 0.74, "min": 1.49, "cnt": 128}, "fwd-misc":{"total": 21.71, "avg": 0.17, "max": 0.12, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1752.56, "avg": 13.69, "max": 10.40, "min": 24.56, "cnt": 128}, "MoE_L0_fwd":{"total": 572.09, "avg": 17.88, "max": 13.38, "min": 24.47, "cnt": 32}, "MoEMLP":{"total": 1735.14, "avg": 13.56, "max": 10.30, "min": 24.42, "cnt": 128}, "MoE_L1_fwd":{"total": 422.88, "avg": 13.21, "max": 11.91, "min": 14.79, "cnt": 32}, "MoE_L2_fwd":{"total": 389.97, "avg": 12.19, "max": 11.44, "min": 16.06, "cnt": 32}, "MoE_L3_fwd":{"total": 356.74, "avg": 11.15, "max": 10.34, "min": 12.02, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 0.95, "avg": 0.95, "max": 0.95, "min": 0.95, "cnt": 1}, "forward-send-backward-recv":{"total": 2174.33, "avg": 70.14, "max": 1.14, "min": 806.64, "cnt": 31}, "backward-compute":{"total": 1752.56, "avg": 54.77, "max": 52.29, "min": 57.49, "cnt": 32}, "MoE_L3_bwd":{"total": 402.17, "avg": 12.57, "max": 11.51, "min": 15.50, "cnt": 32}, "MoE_L2_bwd":{"total": 390.77, "avg": 12.21, "max": 11.54, "min": 14.40, "cnt": 32}, "MoE_L1_bwd":{"total": 375.31, "avg": 11.73, "max": 11.06, "min": 13.17, "cnt": 32}, "MoE_L0_bwd":{"total": 367.72, "avg": 11.49, "max": 10.99, "min": 12.06, "cnt": 32}, "backward-send-forward-recv":{"total": 278.45, "avg": 9.28, "max": 0.98, "min": 188.32, "cnt": 30}, "backward-send":{"total": 2.01, "avg": 1.00, "max": 1.00, "min": 1.01, "cnt": 2}, "backward-recv":{"total": 162.32, "avg": 162.32, "max": 162.32, "min": 162.32, "cnt": 1}, "backward-params-all-reduce":{"total": 487.62, "avg": 487.62, "max": 487.62, "min": 487.62, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 302.64, "avg": 302.64, "max": 302.64, "min": 302.64, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 262.79, "avg": 262.79, "max": 262.79, "min": 262.79, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.48, "avg": 3.48, "max": 3.48, "min": 3.48, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 135, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 152.93, "avg": 76.47, "max": 3.83, "min": 149.10, "cnt": 2}, "forward-compute":{"total": 1881.04, "avg": 58.78, "max": 53.07, "min": 68.65, "cnt": 32}, "fwd-compute":{"total": 1877.73, "avg": 58.68, "max": 52.97, "min": 68.55, "cnt": 32}, "batch-generator":{"total": 42.98, "avg": 1.34, "max": 0.73, "min": 2.51, "cnt": 32}, "fwd-embedding":{"total": 0.71, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1822.05, "avg": 56.94, "max": 51.33, "min": 67.10, "cnt": 32}, "fwd-layernorm":{"total": 9.84, "avg": 0.08, "max": 0.05, "min": 0.18, "cnt": 128}, "fwd-attn":{"total": 110.26, "avg": 0.86, "max": 0.74, "min": 1.50, "cnt": 128}, "fwd-misc":{"total": 21.13, "avg": 0.17, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1660.01, "avg": 12.97, "max": 10.47, "min": 20.88, "cnt": 128}, "MoE_L0_fwd":{"total": 488.70, "avg": 15.27, "max": 12.56, "min": 20.73, "cnt": 32}, "MoEMLP":{"total": 1643.05, "avg": 12.84, "max": 10.37, "min": 20.63, "cnt": 128}, "MoE_L1_fwd":{"total": 411.16, "avg": 12.85, "max": 11.89, "min": 17.01, "cnt": 32}, "MoE_L2_fwd":{"total": 382.59, "avg": 11.96, "max": 11.07, "min": 14.73, "cnt": 32}, "MoE_L3_fwd":{"total": 367.00, "avg": 11.47, "max": 10.41, "min": 15.84, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 0.85, "avg": 0.85, "max": 0.85, "min": 0.85, "cnt": 1}, "forward-send-backward-recv":{"total": 391.22, "avg": 12.62, "max": 0.98, "min": 92.79, "cnt": 31}, "backward-compute":{"total": 1749.33, "avg": 54.67, "max": 51.32, "min": 60.43, "cnt": 32}, "MoE_L3_bwd":{"total": 407.48, "avg": 12.73, "max": 11.31, "min": 19.01, "cnt": 32}, "MoE_L2_bwd":{"total": 381.18, "avg": 11.91, "max": 11.05, "min": 13.31, "cnt": 32}, "MoE_L1_bwd":{"total": 377.47, "avg": 11.80, "max": 11.34, "min": 13.18, "cnt": 32}, "MoE_L0_bwd":{"total": 369.11, "avg": 11.53, "max": 10.85, "min": 13.95, "cnt": 32}, "backward-send-forward-recv":{"total": 1242.51, "avg": 41.42, "max": 1.36, "min": 179.28, "cnt": 30}, "backward-send":{"total": 2.49, "avg": 1.24, "max": 1.11, "min": 1.38, "cnt": 2}, "backward-recv":{"total": 70.30, "avg": 70.30, "max": 70.30, "min": 70.30, "cnt": 1}, "backward-params-all-reduce":{"total": 490.52, "avg": 490.52, "max": 490.52, "min": 490.52, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 301.28, "avg": 301.28, "max": 301.28, "min": 301.28, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 261.11, "avg": 261.11, "max": 261.11, "min": 261.11, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.67, "avg": 3.67, "max": 3.67, "min": 3.67, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 136, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 138.52, "avg": 69.26, "max": 0.67, "min": 137.85, "cnt": 2}, "forward-compute":{"total": 1990.37, "avg": 62.20, "max": 54.50, "min": 69.92, "cnt": 32}, "fwd-compute":{"total": 1987.06, "avg": 62.10, "max": 54.39, "min": 69.79, "cnt": 32}, "batch-generator":{"total": 39.50, "avg": 1.23, "max": 0.66, "min": 2.83, "cnt": 32}, "fwd-embedding":{"total": 0.69, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1935.28, "avg": 60.48, "max": 52.71, "min": 67.78, "cnt": 32}, "fwd-layernorm":{"total": 9.85, "avg": 0.08, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 110.38, "avg": 0.86, "max": 0.74, "min": 1.49, "cnt": 128}, "fwd-misc":{"total": 20.96, "avg": 0.16, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1773.26, "avg": 13.85, "max": 10.52, "min": 22.07, "cnt": 128}, "MoE_L0_fwd":{"total": 572.56, "avg": 17.89, "max": 13.12, "min": 21.94, "cnt": 32}, "MoEMLP":{"total": 1756.43, "avg": 13.72, "max": 10.41, "min": 21.87, "cnt": 128}, "MoE_L1_fwd":{"total": 424.89, "avg": 13.28, "max": 11.50, "min": 18.18, "cnt": 32}, "MoE_L2_fwd":{"total": 395.68, "avg": 12.37, "max": 11.51, "min": 16.00, "cnt": 32}, "MoE_L3_fwd":{"total": 369.52, "avg": 11.55, "max": 10.46, "min": 13.91, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 0.46, "avg": 0.46, "max": 0.46, "min": 0.46, "cnt": 1}, "forward-send-backward-recv":{"total": 3083.87, "avg": 99.48, "max": 0.91, "min": 931.40, "cnt": 31}, "backward-compute":{"total": 1750.66, "avg": 54.71, "max": 52.00, "min": 57.25, "cnt": 32}, "MoE_L3_bwd":{"total": 403.92, "avg": 12.62, "max": 11.14, "min": 14.50, "cnt": 32}, "MoE_L2_bwd":{"total": 392.95, "avg": 12.28, "max": 11.19, "min": 13.41, "cnt": 32}, "MoE_L1_bwd":{"total": 370.01, "avg": 11.56, "max": 11.13, "min": 11.99, "cnt": 32}, "MoE_L0_bwd":{"total": 370.24, "avg": 11.57, "max": 10.81, "min": 12.32, "cnt": 32}, "backward-send-forward-recv":{"total": 642.84, "avg": 21.43, "max": 0.96, "min": 155.17, "cnt": 30}, "backward-send":{"total": 1.29, "avg": 0.64, "max": 0.44, "min": 0.85, "cnt": 2}, "backward-recv":{"total": 71.53, "avg": 71.53, "max": 71.53, "min": 71.53, "cnt": 1}, "backward-params-all-reduce":{"total": 488.14, "avg": 488.14, "max": 488.14, "min": 488.14, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 297.96, "avg": 297.96, "max": 297.96, "min": 297.96, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 258.08, "avg": 258.08, "max": 258.08, "min": 258.08, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 137, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 139.49, "avg": 69.74, "max": 5.31, "min": 134.18, "cnt": 2}, "forward-compute":{"total": 1892.06, "avg": 59.13, "max": 52.90, "min": 63.77, "cnt": 32}, "fwd-compute":{"total": 1888.92, "avg": 59.03, "max": 52.82, "min": 63.70, "cnt": 32}, "batch-generator":{"total": 40.93, "avg": 1.28, "max": 0.61, "min": 2.01, "cnt": 32}, "fwd-embedding":{"total": 0.65, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1835.70, "avg": 57.37, "max": 51.20, "min": 62.15, "cnt": 32}, "fwd-layernorm":{"total": 9.59, "avg": 0.07, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 109.79, "avg": 0.86, "max": 0.75, "min": 2.62, "cnt": 128}, "fwd-misc":{"total": 21.12, "avg": 0.17, "max": 0.11, "min": 0.39, "cnt": 128}, "fwd-MLP":{"total": 1674.60, "avg": 13.08, "max": 10.48, "min": 20.85, "cnt": 128}, "MoE_L0_fwd":{"total": 523.37, "avg": 16.36, "max": 12.33, "min": 20.78, "cnt": 32}, "MoEMLP":{"total": 1657.75, "avg": 12.95, "max": 10.35, "min": 20.72, "cnt": 128}, "MoE_L1_fwd":{"total": 411.44, "avg": 12.86, "max": 11.74, "min": 16.33, "cnt": 32}, "MoE_L2_fwd":{"total": 379.23, "avg": 11.85, "max": 11.28, "min": 13.60, "cnt": 32}, "MoE_L3_fwd":{"total": 350.01, "avg": 10.94, "max": 10.41, "min": 12.03, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 0.71, "avg": 0.71, "max": 0.71, "min": 0.71, "cnt": 1}, "forward-send-backward-recv":{"total": 1418.05, "avg": 45.74, "max": 1.02, "min": 272.72, "cnt": 31}, "backward-compute":{"total": 1738.65, "avg": 54.33, "max": 52.50, "min": 56.84, "cnt": 32}, "MoE_L3_bwd":{"total": 405.28, "avg": 12.66, "max": 11.28, "min": 16.44, "cnt": 32}, "MoE_L2_bwd":{"total": 388.54, "avg": 12.14, "max": 11.48, "min": 13.14, "cnt": 32}, "MoE_L1_bwd":{"total": 365.21, "avg": 11.41, "max": 10.74, "min": 12.16, "cnt": 32}, "MoE_L0_bwd":{"total": 363.90, "avg": 11.37, "max": 10.79, "min": 13.18, "cnt": 32}, "backward-send-forward-recv":{"total": 2154.45, "avg": 71.81, "max": 1.02, "min": 607.42, "cnt": 30}, "backward-send":{"total": 1.02, "avg": 0.51, "max": 0.45, "min": 0.57, "cnt": 2}, "backward-recv":{"total": 71.53, "avg": 71.53, "max": 71.53, "min": 71.53, "cnt": 1}, "backward-params-all-reduce":{"total": 488.86, "avg": 488.86, "max": 488.86, "min": 488.86, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 301.26, "avg": 301.26, "max": 301.26, "min": 301.26, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 261.20, "avg": 261.20, "max": 261.20, "min": 261.20, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.53, "avg": 3.53, "max": 3.53, "min": 3.53, "cnt": 1}}}
{"type":"time", "iteration": 138, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.38, "avg": 0.38, "max": 0.38, "min": 0.38, "cnt": 1}, "forward-recv":{"total": 145.16, "avg": 72.58, "max": 5.19, "min": 139.96, "cnt": 2}, "forward-compute":{"total": 1878.43, "avg": 58.70, "max": 51.69, "min": 65.08, "cnt": 32}, "fwd-compute":{"total": 1875.24, "avg": 58.60, "max": 51.61, "min": 65.00, "cnt": 32}, "batch-generator":{"total": 38.46, "avg": 1.20, "max": 0.61, "min": 1.79, "cnt": 32}, "fwd-embedding":{"total": 0.62, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1824.51, "avg": 57.02, "max": 50.71, "min": 63.20, "cnt": 32}, "fwd-layernorm":{"total": 9.65, "avg": 0.08, "max": 0.05, "min": 0.18, "cnt": 128}, "fwd-attn":{"total": 111.70, "avg": 0.87, "max": 0.74, "min": 1.91, "cnt": 128}, "fwd-misc":{"total": 21.49, "avg": 0.17, "max": 0.11, "min": 0.41, "cnt": 128}, "fwd-MLP":{"total": 1660.44, "avg": 12.97, "max": 10.38, "min": 21.03, "cnt": 128}, "MoE_L0_fwd":{"total": 515.72, "avg": 16.12, "max": 12.88, "min": 20.96, "cnt": 32}, "MoEMLP":{"total": 1643.25, "avg": 12.84, "max": 10.25, "min": 20.91, "cnt": 128}, "MoE_L1_fwd":{"total": 396.55, "avg": 12.39, "max": 11.34, "min": 14.44, "cnt": 32}, "MoE_L2_fwd":{"total": 383.49, "avg": 11.98, "max": 11.27, "min": 16.32, "cnt": 32}, "MoE_L3_fwd":{"total": 353.83, "avg": 11.06, "max": 10.29, "min": 12.55, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 0.93, "avg": 0.93, "max": 0.93, "min": 0.93, "cnt": 1}, "forward-send-backward-recv":{"total": 444.75, "avg": 14.35, "max": 0.84, "min": 147.00, "cnt": 31}, "backward-compute":{"total": 1719.08, "avg": 53.72, "max": 50.92, "min": 59.02, "cnt": 32}, "MoE_L3_bwd":{"total": 394.24, "avg": 12.32, "max": 11.42, "min": 17.51, "cnt": 32}, "MoE_L2_bwd":{"total": 382.61, "avg": 11.96, "max": 11.16, "min": 13.03, "cnt": 32}, "MoE_L1_bwd":{"total": 360.43, "avg": 11.26, "max": 10.52, "min": 11.80, "cnt": 32}, "MoE_L0_bwd":{"total": 369.46, "avg": 11.55, "max": 10.72, "min": 13.80, "cnt": 32}, "backward-send-forward-recv":{"total": 2481.33, "avg": 82.71, "max": 2.13, "min": 525.21, "cnt": 30}, "backward-send":{"total": 2.01, "avg": 1.01, "max": 1.00, "min": 1.01, "cnt": 2}, "backward-recv":{"total": 67.43, "avg": 67.43, "max": 67.43, "min": 67.43, "cnt": 1}, "backward-params-all-reduce":{"total": 492.82, "avg": 492.82, "max": 492.82, "min": 492.82, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 302.53, "avg": 302.53, "max": 302.53, "min": 302.53, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.36, "avg": 3.36, "max": 3.36, "min": 3.36, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 261.38, "avg": 261.38, "max": 261.38, "min": 261.38, "cnt": 1}, "optimizer-clip-main-grad":{"total": 4.60, "avg": 4.60, "max": 4.60, "min": 4.60, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 139, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 146.53, "avg": 73.26, "max": 7.00, "min": 139.53, "cnt": 2}, "forward-compute":{"total": 1884.66, "avg": 58.90, "max": 53.66, "min": 65.88, "cnt": 32}, "fwd-compute":{"total": 1881.74, "avg": 58.80, "max": 53.58, "min": 65.78, "cnt": 32}, "batch-generator":{"total": 38.83, "avg": 1.21, "max": 0.78, "min": 2.61, "cnt": 32}, "fwd-embedding":{"total": 0.59, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1830.68, "avg": 57.21, "max": 52.06, "min": 64.08, "cnt": 32}, "fwd-layernorm":{"total": 9.44, "avg": 0.07, "max": 0.05, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 106.64, "avg": 0.83, "max": 0.74, "min": 1.51, "cnt": 128}, "fwd-misc":{"total": 20.63, "avg": 0.16, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1673.40, "avg": 13.07, "max": 10.85, "min": 20.31, "cnt": 128}, "MoE_L0_fwd":{"total": 493.56, "avg": 15.42, "max": 12.37, "min": 20.23, "cnt": 32}, "MoEMLP":{"total": 1656.73, "avg": 12.94, "max": 10.73, "min": 20.18, "cnt": 128}, "MoE_L1_fwd":{"total": 397.94, "avg": 12.44, "max": 11.71, "min": 13.98, "cnt": 32}, "MoE_L2_fwd":{"total": 395.00, "avg": 12.34, "max": 11.41, "min": 15.07, "cnt": 32}, "MoE_L3_fwd":{"total": 376.46, "avg": 11.76, "max": 10.78, "min": 13.86, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 0.94, "avg": 0.94, "max": 0.94, "min": 0.94, "cnt": 1}, "forward-send-backward-recv":{"total": 407.68, "avg": 13.15, "max": 0.97, "min": 147.00, "cnt": 31}, "backward-compute":{"total": 1720.72, "avg": 53.77, "max": 50.45, "min": 58.88, "cnt": 32}, "MoE_L3_bwd":{"total": 388.89, "avg": 12.15, "max": 10.98, "min": 14.25, "cnt": 32}, "MoE_L2_bwd":{"total": 386.08, "avg": 12.07, "max": 11.09, "min": 16.94, "cnt": 32}, "MoE_L1_bwd":{"total": 364.62, "avg": 11.39, "max": 10.88, "min": 12.91, "cnt": 32}, "MoE_L0_bwd":{"total": 364.03, "avg": 11.38, "max": 10.65, "min": 13.18, "cnt": 32}, "backward-send-forward-recv":{"total": 1915.15, "avg": 63.84, "max": 1.70, "min": 251.41, "cnt": 30}, "backward-send":{"total": 2.09, "avg": 1.04, "max": 0.96, "min": 1.12, "cnt": 2}, "backward-recv":{"total": 72.90, "avg": 72.90, "max": 72.90, "min": 72.90, "cnt": 1}, "backward-params-all-reduce":{"total": 487.54, "avg": 487.54, "max": 487.54, "min": 487.54, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.04, "avg": 0.04, "max": 0.04, "min": 0.04, "cnt": 1}, "optimizer":{"total": 304.57, "avg": 304.57, "max": 304.57, "min": 304.57, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 263.92, "avg": 263.92, "max": 263.92, "min": 263.92, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.87, "avg": 3.87, "max": 3.87, "min": 3.87, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.56, "avg": 3.56, "max": 3.56, "min": 3.56, "cnt": 1}}}
{"type":"time", "iteration": 140, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 138.48, "avg": 69.24, "max": 5.18, "min": 133.30, "cnt": 2}, "forward-compute":{"total": 1856.86, "avg": 58.03, "max": 54.54, "min": 63.39, "cnt": 32}, "fwd-compute":{"total": 1853.72, "avg": 57.93, "max": 54.44, "min": 63.30, "cnt": 32}, "batch-generator":{"total": 39.49, "avg": 1.23, "max": 0.72, "min": 2.49, "cnt": 32}, "fwd-embedding":{"total": 0.64, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1800.82, "avg": 56.28, "max": 52.63, "min": 61.98, "cnt": 32}, "fwd-layernorm":{"total": 9.83, "avg": 0.08, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 109.11, "avg": 0.85, "max": 0.74, "min": 1.77, "cnt": 128}, "fwd-misc":{"total": 21.54, "avg": 0.17, "max": 0.11, "min": 0.48, "cnt": 128}, "fwd-MLP":{"total": 1639.09, "avg": 12.81, "max": 10.26, "min": 21.69, "cnt": 128}, "MoE_L0_fwd":{"total": 484.76, "avg": 15.15, "max": 12.77, "min": 21.61, "cnt": 32}, "MoEMLP":{"total": 1621.25, "avg": 12.67, "max": 10.15, "min": 21.57, "cnt": 128}, "MoE_L1_fwd":{"total": 397.05, "avg": 12.41, "max": 11.34, "min": 15.63, "cnt": 32}, "MoE_L2_fwd":{"total": 384.90, "avg": 12.03, "max": 11.36, "min": 14.12, "cnt": 32}, "MoE_L3_fwd":{"total": 361.00, "avg": 11.28, "max": 10.20, "min": 19.07, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.61, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.01, "avg": 1.01, "max": 1.01, "min": 1.01, "cnt": 1}, "forward-send-backward-recv":{"total": 527.32, "avg": 17.01, "max": 1.01, "min": 187.49, "cnt": 31}, "backward-compute":{"total": 1710.18, "avg": 53.44, "max": 50.88, "min": 55.72, "cnt": 32}, "MoE_L3_bwd":{"total": 386.10, "avg": 12.07, "max": 11.29, "min": 12.97, "cnt": 32}, "MoE_L2_bwd":{"total": 375.79, "avg": 11.74, "max": 10.74, "min": 13.81, "cnt": 32}, "MoE_L1_bwd":{"total": 360.41, "avg": 11.26, "max": 10.65, "min": 12.87, "cnt": 32}, "MoE_L0_bwd":{"total": 371.42, "avg": 11.61, "max": 10.89, "min": 13.49, "cnt": 32}, "backward-send-forward-recv":{"total": 1945.91, "avg": 64.86, "max": 2.29, "min": 207.26, "cnt": 30}, "backward-send":{"total": 0.99, "avg": 0.50, "max": 0.48, "min": 0.51, "cnt": 2}, "backward-recv":{"total": 75.36, "avg": 75.36, "max": 75.36, "min": 75.36, "cnt": 1}, "backward-params-all-reduce":{"total": 485.81, "avg": 485.81, "max": 485.81, "min": 485.81, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 302.88, "avg": 302.88, "max": 302.88, "min": 302.88, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 262.93, "avg": 262.93, "max": 262.93, "min": 262.93, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.51, "avg": 3.51, "max": 3.51, "min": 3.51, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.47, "avg": 3.47, "max": 3.47, "min": 3.47, "cnt": 1}}}
{"type":"time", "iteration": 141, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 147.48, "avg": 73.74, "max": 12.51, "min": 134.98, "cnt": 2}, "forward-compute":{"total": 1899.01, "avg": 59.34, "max": 53.14, "min": 67.32, "cnt": 32}, "fwd-compute":{"total": 1896.14, "avg": 59.25, "max": 53.08, "min": 67.24, "cnt": 32}, "batch-generator":{"total": 35.49, "avg": 1.11, "max": 0.66, "min": 1.86, "cnt": 32}, "fwd-embedding":{"total": 0.58, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1849.13, "avg": 57.79, "max": 52.11, "min": 65.64, "cnt": 32}, "fwd-layernorm":{"total": 8.91, "avg": 0.07, "max": 0.06, "min": 0.17, "cnt": 128}, "fwd-attn":{"total": 106.99, "avg": 0.84, "max": 0.74, "min": 1.49, "cnt": 128}, "fwd-misc":{"total": 19.91, "avg": 0.16, "max": 0.11, "min": 0.45, "cnt": 128}, "fwd-MLP":{"total": 1693.55, "avg": 13.23, "max": 10.32, "min": 25.86, "cnt": 128}, "MoE_L0_fwd":{"total": 530.64, "avg": 16.58, "max": 12.54, "min": 25.78, "cnt": 32}, "MoEMLP":{"total": 1677.31, "avg": 13.10, "max": 10.20, "min": 25.73, "cnt": 128}, "MoE_L1_fwd":{"total": 401.97, "avg": 12.56, "max": 11.62, "min": 14.59, "cnt": 32}, "MoE_L2_fwd":{"total": 392.73, "avg": 12.27, "max": 11.48, "min": 18.55, "cnt": 32}, "MoE_L3_fwd":{"total": 358.03, "avg": 11.19, "max": 10.25, "min": 12.67, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.56, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 0.74, "avg": 0.74, "max": 0.74, "min": 0.74, "cnt": 1}, "forward-send-backward-recv":{"total": 156.62, "avg": 5.05, "max": 0.89, "min": 59.76, "cnt": 31}, "backward-compute":{"total": 1715.79, "avg": 53.62, "max": 50.56, "min": 62.74, "cnt": 32}, "MoE_L3_bwd":{"total": 389.35, "avg": 12.17, "max": 11.13, "min": 16.05, "cnt": 32}, "MoE_L2_bwd":{"total": 381.51, "avg": 11.92, "max": 11.15, "min": 16.18, "cnt": 32}, "MoE_L1_bwd":{"total": 363.01, "avg": 11.34, "max": 10.86, "min": 12.76, "cnt": 32}, "MoE_L0_bwd":{"total": 368.63, "avg": 11.52, "max": 11.05, "min": 12.17, "cnt": 32}, "backward-send-forward-recv":{"total": 1749.41, "avg": 58.31, "max": 1.59, "min": 184.56, "cnt": 30}, "backward-send":{"total": 1.79, "avg": 0.90, "max": 0.80, "min": 0.99, "cnt": 2}, "backward-recv":{"total": 65.00, "avg": 65.00, "max": 65.00, "min": 65.00, "cnt": 1}, "backward-params-all-reduce":{"total": 487.03, "avg": 487.03, "max": 487.03, "min": 487.03, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 309.41, "avg": 309.41, "max": 309.41, "min": 309.41, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 269.45, "avg": 269.45, "max": 269.45, "min": 269.45, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 142, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 133.47, "avg": 66.73, "max": 1.19, "min": 132.28, "cnt": 2}, "forward-compute":{"total": 1868.02, "avg": 58.38, "max": 53.62, "min": 63.41, "cnt": 32}, "fwd-compute":{"total": 1865.10, "avg": 58.28, "max": 53.53, "min": 63.31, "cnt": 32}, "batch-generator":{"total": 37.76, "avg": 1.18, "max": 0.73, "min": 2.47, "cnt": 32}, "fwd-embedding":{"total": 0.57, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1815.47, "avg": 56.73, "max": 52.31, "min": 61.80, "cnt": 32}, "fwd-layernorm":{"total": 9.17, "avg": 0.07, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 106.55, "avg": 0.83, "max": 0.74, "min": 2.27, "cnt": 128}, "fwd-misc":{"total": 20.13, "avg": 0.16, "max": 0.11, "min": 0.48, "cnt": 128}, "fwd-MLP":{"total": 1659.57, "avg": 12.97, "max": 10.40, "min": 20.43, "cnt": 128}, "MoE_L0_fwd":{"total": 502.36, "avg": 15.70, "max": 12.73, "min": 20.35, "cnt": 32}, "MoEMLP":{"total": 1643.55, "avg": 12.84, "max": 10.29, "min": 20.30, "cnt": 128}, "MoE_L1_fwd":{"total": 402.64, "avg": 12.58, "max": 11.37, "min": 19.43, "cnt": 32}, "MoE_L2_fwd":{"total": 384.86, "avg": 12.03, "max": 11.41, "min": 13.69, "cnt": 32}, "MoE_L3_fwd":{"total": 359.67, "avg": 11.24, "max": 10.33, "min": 12.60, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.56, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 0.86, "avg": 0.86, "max": 0.86, "min": 0.86, "cnt": 1}, "forward-send-backward-recv":{"total": 164.92, "avg": 5.32, "max": 1.04, "min": 61.23, "cnt": 31}, "backward-compute":{"total": 1711.80, "avg": 53.49, "max": 52.15, "min": 55.78, "cnt": 32}, "MoE_L3_bwd":{"total": 395.82, "avg": 12.37, "max": 11.07, "min": 14.08, "cnt": 32}, "MoE_L2_bwd":{"total": 375.92, "avg": 11.75, "max": 11.15, "min": 14.28, "cnt": 32}, "MoE_L1_bwd":{"total": 354.39, "avg": 11.07, "max": 10.67, "min": 11.63, "cnt": 32}, "MoE_L0_bwd":{"total": 370.63, "avg": 11.58, "max": 11.11, "min": 12.61, "cnt": 32}, "backward-send-forward-recv":{"total": 2853.51, "avg": 95.12, "max": 1.28, "min": 515.39, "cnt": 30}, "backward-send":{"total": 1.54, "avg": 0.77, "max": 0.64, "min": 0.90, "cnt": 2}, "backward-recv":{"total": 71.80, "avg": 71.80, "max": 71.80, "min": 71.80, "cnt": 1}, "backward-params-all-reduce":{"total": 488.85, "avg": 488.85, "max": 488.85, "min": 488.85, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 306.35, "avg": 306.35, "max": 306.35, "min": 306.35, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 266.52, "avg": 266.52, "max": 266.52, "min": 266.52, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.29, "avg": 3.29, "max": 3.29, "min": 3.29, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.47, "avg": 3.47, "max": 3.47, "min": 3.47, "cnt": 1}}}
{"type":"time", "iteration": 143, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 140.81, "avg": 70.41, "max": 5.29, "min": 135.52, "cnt": 2}, "forward-compute":{"total": 1842.82, "avg": 57.59, "max": 51.99, "min": 66.52, "cnt": 32}, "fwd-compute":{"total": 1839.85, "avg": 57.50, "max": 51.91, "min": 66.38, "cnt": 32}, "batch-generator":{"total": 39.75, "avg": 1.24, "max": 0.71, "min": 2.87, "cnt": 32}, "fwd-embedding":{"total": 0.63, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1787.58, "avg": 55.86, "max": 50.79, "min": 64.21, "cnt": 32}, "fwd-layernorm":{"total": 9.31, "avg": 0.07, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 107.45, "avg": 0.84, "max": 0.74, "min": 1.85, "cnt": 128}, "fwd-misc":{"total": 20.39, "avg": 0.16, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1630.08, "avg": 12.74, "max": 10.24, "min": 19.91, "cnt": 128}, "MoE_L0_fwd":{"total": 483.76, "avg": 15.12, "max": 11.71, "min": 19.84, "cnt": 32}, "MoEMLP":{"total": 1613.59, "avg": 12.61, "max": 10.13, "min": 19.80, "cnt": 128}, "MoE_L1_fwd":{"total": 398.15, "avg": 12.44, "max": 11.36, "min": 17.73, "cnt": 32}, "MoE_L2_fwd":{"total": 385.49, "avg": 12.05, "max": 11.25, "min": 15.16, "cnt": 32}, "MoE_L3_fwd":{"total": 352.37, "avg": 11.01, "max": 10.17, "min": 12.42, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 0.73, "avg": 0.73, "max": 0.73, "min": 0.73, "cnt": 1}, "forward-send-backward-recv":{"total": 527.64, "avg": 17.02, "max": 0.92, "min": 129.93, "cnt": 31}, "backward-compute":{"total": 1700.35, "avg": 53.14, "max": 50.20, "min": 57.13, "cnt": 32}, "MoE_L3_bwd":{"total": 386.83, "avg": 12.09, "max": 10.86, "min": 14.97, "cnt": 32}, "MoE_L2_bwd":{"total": 378.27, "avg": 11.82, "max": 10.85, "min": 12.45, "cnt": 32}, "MoE_L1_bwd":{"total": 360.60, "avg": 11.27, "max": 10.41, "min": 13.53, "cnt": 32}, "MoE_L0_bwd":{"total": 360.59, "avg": 11.27, "max": 10.82, "min": 11.62, "cnt": 32}, "backward-send-forward-recv":{"total": 1517.43, "avg": 50.58, "max": 2.39, "min": 230.17, "cnt": 30}, "backward-send":{"total": 1.86, "avg": 0.93, "max": 0.90, "min": 0.96, "cnt": 2}, "backward-recv":{"total": 67.79, "avg": 67.79, "max": 67.79, "min": 67.79, "cnt": 1}, "backward-params-all-reduce":{"total": 488.22, "avg": 488.22, "max": 488.22, "min": 488.22, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 308.91, "avg": 308.91, "max": 308.91, "min": 308.91, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 269.16, "avg": 269.16, "max": 269.16, "min": 269.16, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 144, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 147.51, "avg": 73.76, "max": 5.15, "min": 142.36, "cnt": 2}, "forward-compute":{"total": 1842.02, "avg": 57.56, "max": 52.04, "min": 65.71, "cnt": 32}, "fwd-compute":{"total": 1839.19, "avg": 57.47, "max": 51.96, "min": 65.64, "cnt": 32}, "batch-generator":{"total": 35.36, "avg": 1.11, "max": 0.65, "min": 2.32, "cnt": 32}, "fwd-embedding":{"total": 0.60, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1791.90, "avg": 56.00, "max": 50.98, "min": 63.17, "cnt": 32}, "fwd-layernorm":{"total": 9.22, "avg": 0.07, "max": 0.05, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 105.62, "avg": 0.83, "max": 0.75, "min": 1.67, "cnt": 128}, "fwd-misc":{"total": 20.12, "avg": 0.16, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1636.99, "avg": 12.79, "max": 10.23, "min": 21.98, "cnt": 128}, "MoE_L0_fwd":{"total": 497.34, "avg": 15.54, "max": 12.82, "min": 21.91, "cnt": 32}, "MoEMLP":{"total": 1620.72, "avg": 12.66, "max": 10.12, "min": 21.86, "cnt": 128}, "MoE_L1_fwd":{"total": 398.62, "avg": 12.46, "max": 11.30, "min": 17.22, "cnt": 32}, "MoE_L2_fwd":{"total": 383.18, "avg": 11.97, "max": 11.17, "min": 14.34, "cnt": 32}, "MoE_L3_fwd":{"total": 347.71, "avg": 10.87, "max": 10.16, "min": 12.43, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 0.75, "avg": 0.75, "max": 0.75, "min": 0.75, "cnt": 1}, "forward-send-backward-recv":{"total": 321.74, "avg": 10.38, "max": 1.03, "min": 106.12, "cnt": 31}, "backward-compute":{"total": 1697.52, "avg": 53.05, "max": 51.25, "min": 58.10, "cnt": 32}, "MoE_L3_bwd":{"total": 384.49, "avg": 12.02, "max": 11.12, "min": 13.28, "cnt": 32}, "MoE_L2_bwd":{"total": 382.67, "avg": 11.96, "max": 11.30, "min": 14.27, "cnt": 32}, "MoE_L1_bwd":{"total": 352.25, "avg": 11.01, "max": 10.37, "min": 15.78, "cnt": 32}, "MoE_L0_bwd":{"total": 362.11, "avg": 11.32, "max": 10.99, "min": 11.68, "cnt": 32}, "backward-send-forward-recv":{"total": 2014.64, "avg": 67.15, "max": 0.95, "min": 251.74, "cnt": 30}, "backward-send":{"total": 2.11, "avg": 1.06, "max": 1.02, "min": 1.09, "cnt": 2}, "backward-recv":{"total": 68.84, "avg": 68.84, "max": 68.84, "min": 68.84, "cnt": 1}, "backward-params-all-reduce":{"total": 485.50, "avg": 485.50, "max": 485.50, "min": 485.50, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 308.20, "avg": 308.20, "max": 308.20, "min": 308.20, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 268.35, "avg": 268.35, "max": 268.35, "min": 268.35, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.30, "avg": 3.30, "max": 3.30, "min": 3.30, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.49, "avg": 3.49, "max": 3.49, "min": 3.49, "cnt": 1}}}
{"type":"time", "iteration": 145, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.11, "avg": 0.11, "max": 0.11, "min": 0.11, "cnt": 1}, "forward-recv":{"total": 144.61, "avg": 72.30, "max": 11.09, "min": 133.52, "cnt": 2}, "forward-compute":{"total": 1868.16, "avg": 58.38, "max": 50.00, "min": 67.77, "cnt": 32}, "fwd-compute":{"total": 1864.80, "avg": 58.28, "max": 49.93, "min": 67.69, "cnt": 32}, "batch-generator":{"total": 41.50, "avg": 1.30, "max": 0.72, "min": 2.66, "cnt": 32}, "fwd-embedding":{"total": 0.71, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1810.78, "avg": 56.59, "max": 48.84, "min": 66.38, "cnt": 32}, "fwd-layernorm":{"total": 10.21, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 112.20, "avg": 0.88, "max": 0.74, "min": 2.43, "cnt": 128}, "fwd-misc":{"total": 21.92, "avg": 0.17, "max": 0.11, "min": 0.34, "cnt": 128}, "fwd-MLP":{"total": 1644.85, "avg": 12.85, "max": 10.17, "min": 23.74, "cnt": 128}, "MoE_L0_fwd":{"total": 514.18, "avg": 16.07, "max": 11.79, "min": 23.65, "cnt": 32}, "MoEMLP":{"total": 1627.12, "avg": 12.71, "max": 10.06, "min": 23.60, "cnt": 128}, "MoE_L1_fwd":{"total": 400.52, "avg": 12.52, "max": 10.97, "min": 15.38, "cnt": 32}, "MoE_L2_fwd":{"total": 369.99, "avg": 11.56, "max": 10.99, "min": 12.75, "cnt": 32}, "MoE_L3_fwd":{"total": 348.89, "avg": 10.90, "max": 10.10, "min": 16.44, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 0.83, "avg": 0.83, "max": 0.83, "min": 0.83, "cnt": 1}, "forward-send-backward-recv":{"total": 1345.58, "avg": 43.41, "max": 0.95, "min": 235.23, "cnt": 31}, "backward-compute":{"total": 1655.13, "avg": 51.72, "max": 49.86, "min": 54.53, "cnt": 32}, "MoE_L3_bwd":{"total": 365.79, "avg": 11.43, "max": 10.07, "min": 13.20, "cnt": 32}, "MoE_L2_bwd":{"total": 369.73, "avg": 11.55, "max": 10.72, "min": 14.31, "cnt": 32}, "MoE_L1_bwd":{"total": 349.08, "avg": 10.91, "max": 10.44, "min": 11.99, "cnt": 32}, "MoE_L0_bwd":{"total": 355.50, "avg": 11.11, "max": 10.75, "min": 11.62, "cnt": 32}, "backward-send-forward-recv":{"total": 2570.63, "avg": 85.69, "max": 0.94, "min": 570.82, "cnt": 30}, "backward-send":{"total": 1.27, "avg": 0.64, "max": 0.43, "min": 0.84, "cnt": 2}, "backward-recv":{"total": 80.08, "avg": 80.08, "max": 80.08, "min": 80.08, "cnt": 1}, "backward-params-all-reduce":{"total": 487.46, "avg": 487.46, "max": 487.46, "min": 487.46, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 305.86, "avg": 305.86, "max": 305.86, "min": 305.86, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 265.94, "avg": 265.94, "max": 265.94, "min": 265.94, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 146, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 145.55, "avg": 72.77, "max": 4.31, "min": 141.24, "cnt": 2}, "forward-compute":{"total": 1835.77, "avg": 57.37, "max": 50.97, "min": 63.01, "cnt": 32}, "fwd-compute":{"total": 1832.75, "avg": 57.27, "max": 50.90, "min": 62.92, "cnt": 32}, "batch-generator":{"total": 34.82, "avg": 1.09, "max": 0.66, "min": 1.89, "cnt": 32}, "fwd-embedding":{"total": 0.55, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1785.49, "avg": 55.80, "max": 49.70, "min": 61.68, "cnt": 32}, "fwd-layernorm":{"total": 9.02, "avg": 0.07, "max": 0.05, "min": 0.17, "cnt": 128}, "fwd-attn":{"total": 104.62, "avg": 0.82, "max": 0.74, "min": 1.60, "cnt": 128}, "fwd-misc":{"total": 20.06, "avg": 0.16, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1631.42, "avg": 12.75, "max": 10.19, "min": 20.94, "cnt": 128}, "MoE_L0_fwd":{"total": 492.03, "avg": 15.38, "max": 12.04, "min": 20.86, "cnt": 32}, "MoEMLP":{"total": 1614.80, "avg": 12.62, "max": 10.08, "min": 20.81, "cnt": 128}, "MoE_L1_fwd":{"total": 393.28, "avg": 12.29, "max": 11.00, "min": 15.25, "cnt": 32}, "MoE_L2_fwd":{"total": 386.48, "avg": 12.08, "max": 11.18, "min": 16.86, "cnt": 32}, "MoE_L3_fwd":{"total": 349.09, "avg": 10.91, "max": 10.12, "min": 12.87, "cnt": 32}, "fwd-pooler":{"total": 0.36, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.61, "avg": 0.02, "max": 0.02, "min": 0.05, "cnt": 32}, "forward-send":{"total": 0.83, "avg": 0.83, "max": 0.83, "min": 0.83, "cnt": 1}, "forward-send-backward-recv":{"total": 223.54, "avg": 7.21, "max": 0.98, "min": 52.73, "cnt": 31}, "backward-compute":{"total": 1673.57, "avg": 52.30, "max": 49.03, "min": 56.34, "cnt": 32}, "MoE_L3_bwd":{"total": 374.07, "avg": 11.69, "max": 10.78, "min": 13.41, "cnt": 32}, "MoE_L2_bwd":{"total": 371.87, "avg": 11.62, "max": 10.78, "min": 13.21, "cnt": 32}, "MoE_L1_bwd":{"total": 351.45, "avg": 10.98, "max": 10.30, "min": 12.56, "cnt": 32}, "MoE_L0_bwd":{"total": 359.21, "avg": 11.23, "max": 10.75, "min": 12.22, "cnt": 32}, "backward-send-forward-recv":{"total": 1999.73, "avg": 66.66, "max": 1.18, "min": 411.46, "cnt": 30}, "backward-send":{"total": 1.35, "avg": 0.68, "max": 0.60, "min": 0.75, "cnt": 2}, "backward-recv":{"total": 78.17, "avg": 78.17, "max": 78.17, "min": 78.17, "cnt": 1}, "backward-params-all-reduce":{"total": 485.80, "avg": 485.80, "max": 485.80, "min": 485.80, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 303.23, "avg": 303.23, "max": 303.23, "min": 303.23, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 263.24, "avg": 263.24, "max": 263.24, "min": 263.24, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.58, "avg": 3.58, "max": 3.58, "min": 3.58, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 147, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 141.29, "avg": 70.64, "max": 10.59, "min": 130.70, "cnt": 2}, "forward-compute":{"total": 1941.44, "avg": 60.67, "max": 50.64, "min": 121.51, "cnt": 32}, "fwd-compute":{"total": 1938.29, "avg": 60.57, "max": 50.57, "min": 121.43, "cnt": 32}, "batch-generator":{"total": 43.49, "avg": 1.36, "max": 0.69, "min": 2.42, "cnt": 32}, "fwd-embedding":{"total": 0.68, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1881.99, "avg": 58.81, "max": 49.57, "min": 120.25, "cnt": 32}, "fwd-layernorm":{"total": 9.75, "avg": 0.08, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 110.04, "avg": 0.86, "max": 0.75, "min": 2.04, "cnt": 128}, "fwd-misc":{"total": 21.22, "avg": 0.17, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1719.80, "avg": 13.44, "max": 10.08, "min": 81.24, "cnt": 128}, "MoE_L0_fwd":{"total": 582.18, "avg": 18.19, "max": 11.85, "min": 81.16, "cnt": 32}, "MoEMLP":{"total": 1702.61, "avg": 13.30, "max": 9.95, "min": 81.11, "cnt": 128}, "MoE_L1_fwd":{"total": 395.73, "avg": 12.37, "max": 11.30, "min": 16.98, "cnt": 32}, "MoE_L2_fwd":{"total": 375.96, "avg": 11.75, "max": 11.11, "min": 13.68, "cnt": 32}, "MoE_L3_fwd":{"total": 355.06, "avg": 11.10, "max": 10.00, "min": 15.96, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 0.87, "avg": 0.87, "max": 0.87, "min": 0.87, "cnt": 1}, "forward-send-backward-recv":{"total": 219.26, "avg": 7.07, "max": 0.96, "min": 72.21, "cnt": 31}, "backward-compute":{"total": 1691.63, "avg": 52.86, "max": 49.68, "min": 58.73, "cnt": 32}, "MoE_L3_bwd":{"total": 387.69, "avg": 12.12, "max": 10.65, "min": 16.14, "cnt": 32}, "MoE_L2_bwd":{"total": 380.74, "avg": 11.90, "max": 11.08, "min": 14.08, "cnt": 32}, "MoE_L1_bwd":{"total": 348.91, "avg": 10.90, "max": 10.26, "min": 13.42, "cnt": 32}, "MoE_L0_bwd":{"total": 357.09, "avg": 11.16, "max": 10.46, "min": 12.47, "cnt": 32}, "backward-send-forward-recv":{"total": 2465.47, "avg": 82.18, "max": 1.93, "min": 533.93, "cnt": 30}, "backward-send":{"total": 1.15, "avg": 0.58, "max": 0.48, "min": 0.67, "cnt": 2}, "backward-recv":{"total": 131.77, "avg": 131.77, "max": 131.77, "min": 131.77, "cnt": 1}, "backward-params-all-reduce":{"total": 487.79, "avg": 487.79, "max": 487.79, "min": 487.79, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 312.98, "avg": 312.98, "max": 312.98, "min": 312.98, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 272.38, "avg": 272.38, "max": 272.38, "min": 272.38, "cnt": 1}, "optimizer-clip-main-grad":{"total": 4.01, "avg": 4.01, "max": 4.01, "min": 4.01, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.60, "avg": 3.60, "max": 3.60, "min": 3.60, "cnt": 1}}}
{"type":"time", "iteration": 148, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.13, "avg": 0.13, "max": 0.13, "min": 0.13, "cnt": 1}, "forward-recv":{"total": 154.02, "avg": 77.01, "max": 15.87, "min": 138.14, "cnt": 2}, "forward-compute":{"total": 1820.19, "avg": 56.88, "max": 51.63, "min": 65.37, "cnt": 32}, "fwd-compute":{"total": 1816.80, "avg": 56.78, "max": 51.53, "min": 65.18, "cnt": 32}, "batch-generator":{"total": 49.77, "avg": 1.56, "max": 0.77, "min": 4.97, "cnt": 32}, "fwd-embedding":{"total": 0.67, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1753.22, "avg": 54.79, "max": 50.01, "min": 61.13, "cnt": 32}, "fwd-layernorm":{"total": 10.51, "avg": 0.08, "max": 0.05, "min": 0.33, "cnt": 128}, "fwd-attn":{"total": 113.42, "avg": 0.89, "max": 0.74, "min": 2.56, "cnt": 128}, "fwd-misc":{"total": 22.23, "avg": 0.17, "max": 0.11, "min": 0.51, "cnt": 128}, "fwd-MLP":{"total": 1584.57, "avg": 12.38, "max": 10.11, "min": 22.10, "cnt": 128}, "MoE_L0_fwd":{"total": 483.94, "avg": 15.12, "max": 11.56, "min": 22.01, "cnt": 32}, "MoEMLP":{"total": 1566.65, "avg": 12.24, "max": 10.00, "min": 21.96, "cnt": 128}, "MoE_L1_fwd":{"total": 380.92, "avg": 11.90, "max": 10.81, "min": 13.60, "cnt": 32}, "MoE_L2_fwd":{"total": 370.69, "avg": 11.58, "max": 11.12, "min": 12.61, "cnt": 32}, "MoE_L3_fwd":{"total": 337.78, "avg": 10.56, "max": 10.04, "min": 11.79, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.61, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 0.89, "avg": 0.89, "max": 0.89, "min": 0.89, "cnt": 1}, "forward-send-backward-recv":{"total": 503.99, "avg": 16.26, "max": 1.11, "min": 209.99, "cnt": 31}, "backward-compute":{"total": 1665.25, "avg": 52.04, "max": 49.88, "min": 54.21, "cnt": 32}, "MoE_L3_bwd":{"total": 375.50, "avg": 11.73, "max": 10.62, "min": 13.28, "cnt": 32}, "MoE_L2_bwd":{"total": 372.36, "avg": 11.64, "max": 10.98, "min": 13.34, "cnt": 32}, "MoE_L1_bwd":{"total": 344.25, "avg": 10.76, "max": 10.44, "min": 11.21, "cnt": 32}, "MoE_L0_bwd":{"total": 354.01, "avg": 11.06, "max": 10.53, "min": 11.68, "cnt": 32}, "backward-send-forward-recv":{"total": 3517.00, "avg": 117.23, "max": 2.62, "min": 1023.09, "cnt": 30}, "backward-send":{"total": 1.65, "avg": 0.82, "max": 0.73, "min": 0.91, "cnt": 2}, "backward-recv":{"total": 87.74, "avg": 87.74, "max": 87.74, "min": 87.74, "cnt": 1}, "backward-params-all-reduce":{"total": 486.65, "avg": 486.65, "max": 486.65, "min": 486.65, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.06, "avg": 0.06, "max": 0.06, "min": 0.06, "cnt": 1}, "optimizer":{"total": 303.14, "avg": 303.14, "max": 303.14, "min": 303.14, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 263.07, "avg": 263.07, "max": 263.07, "min": 263.07, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 149, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.13, "avg": 0.13, "max": 0.13, "min": 0.13, "cnt": 1}, "forward-recv":{"total": 134.22, "avg": 67.11, "max": 3.45, "min": 130.77, "cnt": 2}, "forward-compute":{"total": 1798.34, "avg": 56.20, "max": 50.67, "min": 65.15, "cnt": 32}, "fwd-compute":{"total": 1795.06, "avg": 56.10, "max": 50.60, "min": 65.01, "cnt": 32}, "batch-generator":{"total": 40.85, "avg": 1.28, "max": 0.71, "min": 2.56, "cnt": 32}, "fwd-embedding":{"total": 0.63, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1742.04, "avg": 54.44, "max": 49.55, "min": 63.00, "cnt": 32}, "fwd-layernorm":{"total": 9.88, "avg": 0.08, "max": 0.06, "min": 0.22, "cnt": 128}, "fwd-attn":{"total": 109.70, "avg": 0.86, "max": 0.74, "min": 2.22, "cnt": 128}, "fwd-misc":{"total": 21.66, "avg": 0.17, "max": 0.11, "min": 0.53, "cnt": 128}, "fwd-MLP":{"total": 1579.67, "avg": 12.34, "max": 10.05, "min": 19.96, "cnt": 128}, "MoE_L0_fwd":{"total": 476.49, "avg": 14.89, "max": 11.69, "min": 19.89, "cnt": 32}, "MoEMLP":{"total": 1562.34, "avg": 12.21, "max": 9.94, "min": 19.85, "cnt": 128}, "MoE_L1_fwd":{"total": 379.39, "avg": 11.86, "max": 10.79, "min": 15.32, "cnt": 32}, "MoE_L2_fwd":{"total": 367.69, "avg": 11.49, "max": 10.91, "min": 13.88, "cnt": 32}, "MoE_L3_fwd":{"total": 345.09, "avg": 10.78, "max": 9.98, "min": 16.11, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 0.87, "avg": 0.87, "max": 0.87, "min": 0.87, "cnt": 1}, "forward-send-backward-recv":{"total": 967.80, "avg": 31.22, "max": 0.87, "min": 246.45, "cnt": 31}, "backward-compute":{"total": 1668.74, "avg": 52.15, "max": 49.49, "min": 56.74, "cnt": 32}, "MoE_L3_bwd":{"total": 375.64, "avg": 11.74, "max": 10.80, "min": 12.79, "cnt": 32}, "MoE_L2_bwd":{"total": 375.06, "avg": 11.72, "max": 11.07, "min": 12.99, "cnt": 32}, "MoE_L1_bwd":{"total": 351.95, "avg": 11.00, "max": 10.49, "min": 15.00, "cnt": 32}, "MoE_L0_bwd":{"total": 350.63, "avg": 10.96, "max": 10.57, "min": 11.92, "cnt": 32}, "backward-send-forward-recv":{"total": 2307.52, "avg": 76.92, "max": 1.23, "min": 408.11, "cnt": 30}, "backward-send":{"total": 0.88, "avg": 0.44, "max": 0.43, "min": 0.45, "cnt": 2}, "backward-recv":{"total": 77.49, "avg": 77.49, "max": 77.49, "min": 77.49, "cnt": 1}, "backward-params-all-reduce":{"total": 493.72, "avg": 493.72, "max": 493.72, "min": 493.72, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "optimizer":{"total": 293.71, "avg": 293.71, "max": 293.71, "min": 293.71, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 5.94, "avg": 5.94, "max": 5.94, "min": 5.94, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 250.66, "avg": 250.66, "max": 250.66, "min": 250.66, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.70, "avg": 3.70, "max": 3.70, "min": 3.70, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.59, "avg": 3.59, "max": 3.59, "min": 3.59, "cnt": 1}}}
{"type":"time", "iteration": 150, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.11, "avg": 0.11, "max": 0.11, "min": 0.11, "cnt": 1}, "forward-recv":{"total": 130.73, "avg": 65.37, "max": 2.82, "min": 127.92, "cnt": 2}, "forward-compute":{"total": 1877.33, "avg": 58.67, "max": 51.94, "min": 65.19, "cnt": 32}, "fwd-compute":{"total": 1874.19, "avg": 58.57, "max": 51.87, "min": 65.05, "cnt": 32}, "batch-generator":{"total": 41.73, "avg": 1.30, "max": 0.68, "min": 3.79, "cnt": 32}, "fwd-embedding":{"total": 0.65, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1819.72, "avg": 56.87, "max": 50.89, "min": 63.40, "cnt": 32}, "fwd-layernorm":{"total": 9.71, "avg": 0.08, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 112.33, "avg": 0.88, "max": 0.74, "min": 3.83, "cnt": 128}, "fwd-misc":{"total": 20.82, "avg": 0.16, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1656.21, "avg": 12.94, "max": 10.13, "min": 21.66, "cnt": 128}, "MoE_L0_fwd":{"total": 524.77, "avg": 16.40, "max": 12.56, "min": 21.50, "cnt": 32}, "MoEMLP":{"total": 1639.55, "avg": 12.81, "max": 10.00, "min": 21.42, "cnt": 128}, "MoE_L1_fwd":{"total": 394.44, "avg": 12.33, "max": 11.09, "min": 15.63, "cnt": 32}, "MoE_L2_fwd":{"total": 381.17, "avg": 11.91, "max": 10.85, "min": 17.24, "cnt": 32}, "MoE_L3_fwd":{"total": 345.36, "avg": 10.79, "max": 10.05, "min": 14.09, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 0.45, "avg": 0.45, "max": 0.45, "min": 0.45, "cnt": 1}, "forward-send-backward-recv":{"total": 1217.19, "avg": 39.26, "max": 0.96, "min": 189.18, "cnt": 31}, "backward-compute":{"total": 1678.55, "avg": 52.45, "max": 49.68, "min": 59.19, "cnt": 32}, "MoE_L3_bwd":{"total": 376.83, "avg": 11.78, "max": 10.74, "min": 15.31, "cnt": 32}, "MoE_L2_bwd":{"total": 379.93, "avg": 11.87, "max": 10.78, "min": 18.25, "cnt": 32}, "MoE_L1_bwd":{"total": 354.53, "avg": 11.08, "max": 10.44, "min": 14.64, "cnt": 32}, "MoE_L0_bwd":{"total": 353.18, "avg": 11.04, "max": 10.55, "min": 11.93, "cnt": 32}, "backward-send-forward-recv":{"total": 1702.29, "avg": 56.74, "max": 0.98, "min": 328.93, "cnt": 30}, "backward-send":{"total": 1.59, "avg": 0.79, "max": 0.76, "min": 0.83, "cnt": 2}, "backward-recv":{"total": 68.83, "avg": 68.83, "max": 68.83, "min": 68.83, "cnt": 1}, "backward-params-all-reduce":{"total": 487.47, "avg": 487.47, "max": 487.47, "min": 487.47, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "optimizer":{"total": 302.48, "avg": 302.48, "max": 302.48, "min": 302.48, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.41, "avg": 3.41, "max": 3.41, "min": 3.41, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 262.12, "avg": 262.12, "max": 262.12, "min": 262.12, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.58, "avg": 3.58, "max": 3.58, "min": 3.58, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.51, "avg": 3.51, "max": 3.51, "min": 3.51, "cnt": 1}}}
{"type":"time", "iteration": 151, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 144.90, "avg": 72.45, "max": 0.87, "min": 144.03, "cnt": 2}, "forward-compute":{"total": 1840.95, "avg": 57.53, "max": 51.26, "min": 70.98, "cnt": 32}, "fwd-compute":{"total": 1837.78, "avg": 57.43, "max": 51.19, "min": 70.91, "cnt": 32}, "batch-generator":{"total": 47.89, "avg": 1.50, "max": 0.72, "min": 4.35, "cnt": 32}, "fwd-embedding":{"total": 0.64, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1777.03, "avg": 55.53, "max": 50.05, "min": 68.82, "cnt": 32}, "fwd-layernorm":{"total": 9.91, "avg": 0.08, "max": 0.06, "min": 0.28, "cnt": 128}, "fwd-attn":{"total": 112.04, "avg": 0.88, "max": 0.74, "min": 2.69, "cnt": 128}, "fwd-misc":{"total": 21.57, "avg": 0.17, "max": 0.11, "min": 0.47, "cnt": 128}, "fwd-MLP":{"total": 1612.47, "avg": 12.60, "max": 10.09, "min": 18.96, "cnt": 128}, "MoE_L0_fwd":{"total": 480.42, "avg": 15.01, "max": 12.24, "min": 18.77, "cnt": 32}, "MoEMLP":{"total": 1595.34, "avg": 12.46, "max": 9.97, "min": 18.68, "cnt": 128}, "MoE_L1_fwd":{"total": 396.42, "avg": 12.39, "max": 11.25, "min": 13.47, "cnt": 32}, "MoE_L2_fwd":{"total": 374.71, "avg": 11.71, "max": 10.85, "min": 15.80, "cnt": 32}, "MoE_L3_fwd":{"total": 350.14, "avg": 10.94, "max": 10.02, "min": 16.67, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.00, "avg": 1.00, "max": 1.00, "min": 1.00, "cnt": 1}, "forward-send-backward-recv":{"total": 409.53, "avg": 13.21, "max": 0.90, "min": 107.99, "cnt": 31}, "backward-compute":{"total": 1675.75, "avg": 52.37, "max": 49.71, "min": 55.67, "cnt": 32}, "MoE_L3_bwd":{"total": 380.05, "avg": 11.88, "max": 10.86, "min": 13.99, "cnt": 32}, "MoE_L2_bwd":{"total": 369.97, "avg": 11.56, "max": 10.75, "min": 13.03, "cnt": 32}, "MoE_L1_bwd":{"total": 360.08, "avg": 11.25, "max": 10.54, "min": 15.29, "cnt": 32}, "MoE_L0_bwd":{"total": 348.97, "avg": 10.91, "max": 10.02, "min": 13.32, "cnt": 32}, "backward-send-forward-recv":{"total": 2723.04, "avg": 90.77, "max": 1.93, "min": 769.96, "cnt": 30}, "backward-send":{"total": 1.93, "avg": 0.96, "max": 0.87, "min": 1.06, "cnt": 2}, "backward-recv":{"total": 76.24, "avg": 76.24, "max": 76.24, "min": 76.24, "cnt": 1}, "backward-params-all-reduce":{"total": 487.72, "avg": 487.72, "max": 487.72, "min": 487.72, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 304.92, "avg": 304.92, "max": 304.92, "min": 304.92, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 264.88, "avg": 264.88, "max": 264.88, "min": 264.88, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.28, "avg": 3.28, "max": 3.28, "min": 3.28, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.50, "avg": 3.50, "max": 3.50, "min": 3.50, "cnt": 1}}}
{"type":"time", "iteration": 152, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 131.33, "avg": 65.67, "max": 0.73, "min": 130.60, "cnt": 2}, "forward-compute":{"total": 1890.22, "avg": 59.07, "max": 53.06, "min": 66.33, "cnt": 32}, "fwd-compute":{"total": 1886.95, "avg": 58.97, "max": 52.99, "min": 66.21, "cnt": 32}, "batch-generator":{"total": 40.31, "avg": 1.26, "max": 0.65, "min": 2.05, "cnt": 32}, "fwd-embedding":{"total": 0.68, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1834.05, "avg": 57.31, "max": 51.79, "min": 64.17, "cnt": 32}, "fwd-layernorm":{"total": 9.69, "avg": 0.08, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 109.66, "avg": 0.86, "max": 0.75, "min": 1.68, "cnt": 128}, "fwd-misc":{"total": 21.49, "avg": 0.17, "max": 0.11, "min": 0.38, "cnt": 128}, "fwd-MLP":{"total": 1672.30, "avg": 13.06, "max": 10.45, "min": 19.88, "cnt": 128}, "MoE_L0_fwd":{"total": 500.90, "avg": 15.65, "max": 12.08, "min": 19.72, "cnt": 32}, "MoEMLP":{"total": 1655.38, "avg": 12.93, "max": 10.34, "min": 19.63, "cnt": 128}, "MoE_L1_fwd":{"total": 399.23, "avg": 12.48, "max": 11.17, "min": 16.13, "cnt": 32}, "MoE_L2_fwd":{"total": 395.19, "avg": 12.35, "max": 11.25, "min": 17.23, "cnt": 32}, "MoE_L3_fwd":{"total": 366.37, "avg": 11.45, "max": 10.38, "min": 15.32, "cnt": 32}, "fwd-pooler":{"total": 0.36, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 0.91, "avg": 0.91, "max": 0.91, "min": 0.91, "cnt": 1}, "forward-send-backward-recv":{"total": 529.55, "avg": 17.08, "max": 0.98, "min": 80.29, "cnt": 31}, "backward-compute":{"total": 1674.42, "avg": 52.33, "max": 50.50, "min": 53.97, "cnt": 32}, "MoE_L3_bwd":{"total": 383.24, "avg": 11.98, "max": 10.87, "min": 13.92, "cnt": 32}, "MoE_L2_bwd":{"total": 370.04, "avg": 11.56, "max": 10.76, "min": 13.26, "cnt": 32}, "MoE_L1_bwd":{"total": 358.71, "avg": 11.21, "max": 10.63, "min": 12.20, "cnt": 32}, "MoE_L0_bwd":{"total": 349.65, "avg": 10.93, "max": 10.29, "min": 12.06, "cnt": 32}, "backward-send-forward-recv":{"total": 867.93, "avg": 28.93, "max": 1.81, "min": 157.73, "cnt": 30}, "backward-send":{"total": 1.17, "avg": 0.59, "max": 0.53, "min": 0.64, "cnt": 2}, "backward-recv":{"total": 103.65, "avg": 103.65, "max": 103.65, "min": 103.65, "cnt": 1}, "backward-params-all-reduce":{"total": 489.27, "avg": 489.27, "max": 489.27, "min": 489.27, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 305.08, "avg": 305.08, "max": 305.08, "min": 305.08, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 264.63, "avg": 264.63, "max": 264.63, "min": 264.63, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.93, "avg": 3.93, "max": 3.93, "min": 3.93, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 153, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 145.74, "avg": 72.87, "max": 6.55, "min": 139.19, "cnt": 2}, "forward-compute":{"total": 1855.15, "avg": 57.97, "max": 52.38, "min": 68.34, "cnt": 32}, "fwd-compute":{"total": 1852.03, "avg": 57.88, "max": 52.30, "min": 68.26, "cnt": 32}, "batch-generator":{"total": 47.51, "avg": 1.48, "max": 0.68, "min": 5.52, "cnt": 32}, "fwd-embedding":{"total": 0.66, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1791.59, "avg": 55.99, "max": 50.89, "min": 66.78, "cnt": 32}, "fwd-layernorm":{"total": 9.79, "avg": 0.08, "max": 0.06, "min": 0.18, "cnt": 128}, "fwd-attn":{"total": 107.18, "avg": 0.84, "max": 0.74, "min": 1.59, "cnt": 128}, "fwd-misc":{"total": 20.68, "avg": 0.16, "max": 0.11, "min": 0.34, "cnt": 128}, "fwd-MLP":{"total": 1632.94, "avg": 12.76, "max": 10.47, "min": 18.74, "cnt": 128}, "MoE_L0_fwd":{"total": 489.72, "avg": 15.30, "max": 11.85, "min": 18.65, "cnt": 32}, "MoEMLP":{"total": 1615.71, "avg": 12.62, "max": 10.36, "min": 18.59, "cnt": 128}, "MoE_L1_fwd":{"total": 388.43, "avg": 12.14, "max": 11.17, "min": 13.96, "cnt": 32}, "MoE_L2_fwd":{"total": 377.74, "avg": 11.80, "max": 10.78, "min": 14.88, "cnt": 32}, "MoE_L3_fwd":{"total": 366.31, "avg": 11.45, "max": 10.40, "min": 17.14, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.62, "avg": 0.02, "max": 0.02, "min": 0.05, "cnt": 32}, "forward-send":{"total": 0.69, "avg": 0.69, "max": 0.69, "min": 0.69, "cnt": 1}, "forward-send-backward-recv":{"total": 262.35, "avg": 8.46, "max": 0.99, "min": 64.36, "cnt": 31}, "backward-compute":{"total": 1652.81, "avg": 51.65, "max": 48.81, "min": 55.51, "cnt": 32}, "MoE_L3_bwd":{"total": 384.43, "avg": 12.01, "max": 10.40, "min": 15.36, "cnt": 32}, "MoE_L2_bwd":{"total": 348.64, "avg": 10.90, "max": 10.14, "min": 12.68, "cnt": 32}, "MoE_L1_bwd":{"total": 355.95, "avg": 11.12, "max": 10.55, "min": 12.34, "cnt": 32}, "MoE_L0_bwd":{"total": 348.02, "avg": 10.88, "max": 10.43, "min": 13.78, "cnt": 32}, "backward-send-forward-recv":{"total": 2048.55, "avg": 68.28, "max": 1.27, "min": 534.71, "cnt": 30}, "backward-send":{"total": 1.48, "avg": 0.74, "max": 0.51, "min": 0.98, "cnt": 2}, "backward-recv":{"total": 72.84, "avg": 72.84, "max": 72.84, "min": 72.84, "cnt": 1}, "backward-params-all-reduce":{"total": 488.79, "avg": 488.79, "max": 488.79, "min": 488.79, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 299.79, "avg": 299.79, "max": 299.79, "min": 299.79, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 259.76, "avg": 259.76, "max": 259.76, "min": 259.76, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.53, "avg": 3.53, "max": 3.53, "min": 3.53, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 154, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 149.01, "avg": 74.51, "max": 10.23, "min": 138.78, "cnt": 2}, "forward-compute":{"total": 1771.12, "avg": 55.35, "max": 52.01, "min": 60.86, "cnt": 32}, "fwd-compute":{"total": 1768.39, "avg": 55.26, "max": 51.93, "min": 60.78, "cnt": 32}, "batch-generator":{"total": 34.18, "avg": 1.07, "max": 0.67, "min": 1.99, "cnt": 32}, "fwd-embedding":{"total": 0.50, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1722.49, "avg": 53.83, "max": 50.69, "min": 59.59, "cnt": 32}, "fwd-layernorm":{"total": 8.70, "avg": 0.07, "max": 0.05, "min": 0.17, "cnt": 128}, "fwd-attn":{"total": 106.85, "avg": 0.83, "max": 0.74, "min": 2.25, "cnt": 128}, "fwd-misc":{"total": 19.63, "avg": 0.15, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1567.73, "avg": 12.25, "max": 9.99, "min": 19.94, "cnt": 128}, "MoE_L0_fwd":{"total": 459.78, "avg": 14.37, "max": 11.60, "min": 19.86, "cnt": 32}, "MoEMLP":{"total": 1551.70, "avg": 12.12, "max": 9.88, "min": 19.81, "cnt": 128}, "MoE_L1_fwd":{"total": 386.04, "avg": 12.06, "max": 11.22, "min": 15.57, "cnt": 32}, "MoE_L2_fwd":{"total": 365.66, "avg": 11.43, "max": 10.76, "min": 13.84, "cnt": 32}, "MoE_L3_fwd":{"total": 346.16, "avg": 10.82, "max": 9.92, "min": 11.92, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 0.69, "avg": 0.69, "max": 0.69, "min": 0.69, "cnt": 1}, "forward-send-backward-recv":{"total": 177.81, "avg": 5.74, "max": 1.22, "min": 56.80, "cnt": 31}, "backward-compute":{"total": 1657.70, "avg": 51.80, "max": 49.83, "min": 54.91, "cnt": 32}, "MoE_L3_bwd":{"total": 380.67, "avg": 11.90, "max": 10.86, "min": 15.20, "cnt": 32}, "MoE_L2_bwd":{"total": 355.81, "avg": 11.12, "max": 10.27, "min": 12.99, "cnt": 32}, "MoE_L1_bwd":{"total": 354.54, "avg": 11.08, "max": 10.42, "min": 11.55, "cnt": 32}, "MoE_L0_bwd":{"total": 350.03, "avg": 10.94, "max": 10.13, "min": 12.63, "cnt": 32}, "backward-send-forward-recv":{"total": 1658.85, "avg": 55.29, "max": 1.01, "min": 165.28, "cnt": 30}, "backward-send":{"total": 1.98, "avg": 0.99, "max": 0.93, "min": 1.05, "cnt": 2}, "backward-recv":{"total": 72.54, "avg": 72.54, "max": 72.54, "min": 72.54, "cnt": 1}, "backward-params-all-reduce":{"total": 488.75, "avg": 488.75, "max": 488.75, "min": 488.75, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 301.11, "avg": 301.11, "max": 301.11, "min": 301.11, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 260.57, "avg": 260.57, "max": 260.57, "min": 260.57, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.83, "avg": 3.83, "max": 3.83, "min": 3.83, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.55, "avg": 3.55, "max": 3.55, "min": 3.55, "cnt": 1}}}
{"type":"time", "iteration": 155, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 127.07, "avg": 63.53, "max": 0.81, "min": 126.26, "cnt": 2}, "forward-compute":{"total": 1831.72, "avg": 57.24, "max": 51.87, "min": 67.97, "cnt": 32}, "fwd-compute":{"total": 1828.76, "avg": 57.15, "max": 51.78, "min": 67.90, "cnt": 32}, "batch-generator":{"total": 40.04, "avg": 1.25, "max": 0.69, "min": 3.30, "cnt": 32}, "fwd-embedding":{"total": 0.53, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1776.97, "avg": 55.53, "max": 50.50, "min": 66.61, "cnt": 32}, "fwd-layernorm":{"total": 9.25, "avg": 0.07, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 106.15, "avg": 0.83, "max": 0.74, "min": 1.51, "cnt": 128}, "fwd-misc":{"total": 19.68, "avg": 0.15, "max": 0.11, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1621.93, "avg": 12.67, "max": 10.36, "min": 25.98, "cnt": 128}, "MoE_L0_fwd":{"total": 504.89, "avg": 15.78, "max": 12.35, "min": 25.89, "cnt": 32}, "MoEMLP":{"total": 1605.65, "avg": 12.54, "max": 10.25, "min": 25.85, "cnt": 128}, "MoE_L1_fwd":{"total": 389.88, "avg": 12.18, "max": 11.07, "min": 16.00, "cnt": 32}, "MoE_L2_fwd":{"total": 367.59, "avg": 11.49, "max": 10.88, "min": 12.37, "cnt": 32}, "MoE_L3_fwd":{"total": 349.41, "avg": 10.92, "max": 10.29, "min": 13.56, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 0.50, "avg": 0.50, "max": 0.50, "min": 0.50, "cnt": 1}, "forward-send-backward-recv":{"total": 166.39, "avg": 5.37, "max": 0.94, "min": 70.31, "cnt": 31}, "backward-compute":{"total": 1679.48, "avg": 52.48, "max": 49.55, "min": 56.90, "cnt": 32}, "MoE_L3_bwd":{"total": 389.80, "avg": 12.18, "max": 10.60, "min": 15.46, "cnt": 32}, "MoE_L2_bwd":{"total": 364.36, "avg": 11.39, "max": 10.61, "min": 13.47, "cnt": 32}, "MoE_L1_bwd":{"total": 359.28, "avg": 11.23, "max": 10.46, "min": 14.15, "cnt": 32}, "MoE_L0_bwd":{"total": 350.07, "avg": 10.94, "max": 10.49, "min": 11.60, "cnt": 32}, "backward-send-forward-recv":{"total": 4280.56, "avg": 142.69, "max": 2.31, "min": 715.80, "cnt": 30}, "backward-send":{"total": 1.91, "avg": 0.96, "max": 0.92, "min": 0.99, "cnt": 2}, "backward-recv":{"total": 72.88, "avg": 72.88, "max": 72.88, "min": 72.88, "cnt": 1}, "backward-params-all-reduce":{"total": 492.01, "avg": 492.01, "max": 492.01, "min": 492.01, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 293.31, "avg": 293.31, "max": 293.31, "min": 293.31, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.40, "avg": 3.40, "max": 3.40, "min": 3.40, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 253.39, "avg": 253.39, "max": 253.39, "min": 253.39, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.30, "avg": 3.30, "max": 3.30, "min": 3.30, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.47, "avg": 3.47, "max": 3.47, "min": 3.47, "cnt": 1}}}
{"type":"time", "iteration": 156, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 136.96, "avg": 68.48, "max": 4.45, "min": 132.51, "cnt": 2}, "forward-compute":{"total": 1877.46, "avg": 58.67, "max": 52.89, "min": 68.69, "cnt": 32}, "fwd-compute":{"total": 1874.01, "avg": 58.56, "max": 52.79, "min": 68.59, "cnt": 32}, "batch-generator":{"total": 45.60, "avg": 1.43, "max": 0.75, "min": 2.46, "cnt": 32}, "fwd-embedding":{"total": 0.74, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1814.04, "avg": 56.69, "max": 50.23, "min": 66.38, "cnt": 32}, "fwd-layernorm":{"total": 10.49, "avg": 0.08, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 113.80, "avg": 0.89, "max": 0.74, "min": 3.21, "cnt": 128}, "fwd-misc":{"total": 22.51, "avg": 0.18, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1645.23, "avg": 12.85, "max": 10.38, "min": 26.08, "cnt": 128}, "MoE_L0_fwd":{"total": 519.95, "avg": 16.25, "max": 12.21, "min": 25.94, "cnt": 32}, "MoEMLP":{"total": 1627.32, "avg": 12.71, "max": 10.26, "min": 25.85, "cnt": 128}, "MoE_L1_fwd":{"total": 394.32, "avg": 12.32, "max": 10.93, "min": 14.03, "cnt": 32}, "MoE_L2_fwd":{"total": 371.47, "avg": 11.61, "max": 10.78, "min": 16.71, "cnt": 32}, "MoE_L3_fwd":{"total": 348.23, "avg": 10.88, "max": 10.31, "min": 12.47, "cnt": 32}, "fwd-pooler":{"total": 0.36, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 0.88, "avg": 0.88, "max": 0.88, "min": 0.88, "cnt": 1}, "forward-send-backward-recv":{"total": 969.02, "avg": 31.26, "max": 0.85, "min": 187.62, "cnt": 31}, "backward-compute":{"total": 1662.99, "avg": 51.97, "max": 50.09, "min": 55.32, "cnt": 32}, "MoE_L3_bwd":{"total": 384.60, "avg": 12.02, "max": 10.77, "min": 16.73, "cnt": 32}, "MoE_L2_bwd":{"total": 355.95, "avg": 11.12, "max": 10.24, "min": 12.55, "cnt": 32}, "MoE_L1_bwd":{"total": 353.70, "avg": 11.05, "max": 10.28, "min": 11.50, "cnt": 32}, "MoE_L0_bwd":{"total": 352.37, "avg": 11.01, "max": 10.44, "min": 12.80, "cnt": 32}, "backward-send-forward-recv":{"total": 1359.87, "avg": 45.33, "max": 1.12, "min": 266.40, "cnt": 30}, "backward-send":{"total": 1.58, "avg": 0.79, "max": 0.76, "min": 0.82, "cnt": 2}, "backward-recv":{"total": 68.44, "avg": 68.44, "max": 68.44, "min": 68.44, "cnt": 1}, "backward-params-all-reduce":{"total": 488.66, "avg": 488.66, "max": 488.66, "min": 488.66, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 297.24, "avg": 297.24, "max": 297.24, "min": 297.24, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 257.31, "avg": 257.31, "max": 257.31, "min": 257.31, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 157, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 140.89, "avg": 70.44, "max": 8.35, "min": 132.54, "cnt": 2}, "forward-compute":{"total": 1873.07, "avg": 58.53, "max": 52.29, "min": 64.05, "cnt": 32}, "fwd-compute":{"total": 1869.64, "avg": 58.43, "max": 52.21, "min": 63.96, "cnt": 32}, "batch-generator":{"total": 40.44, "avg": 1.26, "max": 0.75, "min": 1.84, "cnt": 32}, "fwd-embedding":{"total": 0.69, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1816.63, "avg": 56.77, "max": 51.00, "min": 62.86, "cnt": 32}, "fwd-layernorm":{"total": 10.23, "avg": 0.08, "max": 0.05, "min": 0.17, "cnt": 128}, "fwd-attn":{"total": 112.39, "avg": 0.88, "max": 0.74, "min": 1.45, "cnt": 128}, "fwd-misc":{"total": 22.10, "avg": 0.17, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1649.85, "avg": 12.89, "max": 10.23, "min": 20.37, "cnt": 128}, "MoE_L0_fwd":{"total": 527.82, "avg": 16.49, "max": 12.34, "min": 20.30, "cnt": 32}, "MoEMLP":{"total": 1632.14, "avg": 12.75, "max": 10.12, "min": 20.25, "cnt": 128}, "MoE_L1_fwd":{"total": 395.77, "avg": 12.37, "max": 11.14, "min": 14.79, "cnt": 32}, "MoE_L2_fwd":{"total": 368.35, "avg": 11.51, "max": 10.81, "min": 14.79, "cnt": 32}, "MoE_L3_fwd":{"total": 346.71, "avg": 10.83, "max": 10.16, "min": 11.83, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.04, "cnt": 32}, "forward-send":{"total": 0.50, "avg": 0.50, "max": 0.50, "min": 0.50, "cnt": 1}, "forward-send-backward-recv":{"total": 1345.59, "avg": 43.41, "max": 1.00, "min": 297.18, "cnt": 31}, "backward-compute":{"total": 1667.94, "avg": 52.12, "max": 48.91, "min": 55.55, "cnt": 32}, "MoE_L3_bwd":{"total": 380.44, "avg": 11.89, "max": 10.78, "min": 13.77, "cnt": 32}, "MoE_L2_bwd":{"total": 360.64, "avg": 11.27, "max": 10.43, "min": 15.21, "cnt": 32}, "MoE_L1_bwd":{"total": 354.93, "avg": 11.09, "max": 10.41, "min": 12.74, "cnt": 32}, "MoE_L0_bwd":{"total": 354.57, "avg": 11.08, "max": 10.62, "min": 12.27, "cnt": 32}, "backward-send-forward-recv":{"total": 914.82, "avg": 30.49, "max": 1.05, "min": 135.67, "cnt": 30}, "backward-send":{"total": 1.83, "avg": 0.92, "max": 0.84, "min": 1.00, "cnt": 2}, "backward-recv":{"total": 78.32, "avg": 78.32, "max": 78.32, "min": 78.32, "cnt": 1}, "backward-params-all-reduce":{"total": 483.83, "avg": 483.83, "max": 483.83, "min": 483.83, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 302.05, "avg": 302.05, "max": 302.05, "min": 302.05, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 261.95, "avg": 261.95, "max": 261.95, "min": 261.95, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.97, "avg": 3.97, "max": 3.97, "min": 3.97, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.51, "avg": 3.51, "max": 3.51, "min": 3.51, "cnt": 1}}}
{"type":"time", "iteration": 158, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 141.35, "avg": 70.68, "max": 5.14, "min": 136.21, "cnt": 2}, "forward-compute":{"total": 1899.83, "avg": 59.37, "max": 52.02, "min": 68.02, "cnt": 32}, "fwd-compute":{"total": 1896.22, "avg": 59.26, "max": 51.95, "min": 67.95, "cnt": 32}, "batch-generator":{"total": 43.19, "avg": 1.35, "max": 0.67, "min": 2.46, "cnt": 32}, "fwd-embedding":{"total": 0.80, "avg": 0.03, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1839.02, "avg": 57.47, "max": 50.96, "min": 66.61, "cnt": 32}, "fwd-layernorm":{"total": 11.11, "avg": 0.09, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 116.34, "avg": 0.91, "max": 0.75, "min": 1.75, "cnt": 128}, "fwd-misc":{"total": 23.50, "avg": 0.18, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1665.04, "avg": 13.01, "max": 10.40, "min": 20.76, "cnt": 128}, "MoE_L0_fwd":{"total": 512.19, "avg": 16.01, "max": 12.67, "min": 20.63, "cnt": 32}, "MoEMLP":{"total": 1646.11, "avg": 12.86, "max": 10.29, "min": 20.56, "cnt": 128}, "MoE_L1_fwd":{"total": 398.73, "avg": 12.46, "max": 11.08, "min": 18.16, "cnt": 32}, "MoE_L2_fwd":{"total": 381.96, "avg": 11.94, "max": 10.89, "min": 16.24, "cnt": 32}, "MoE_L3_fwd":{"total": 360.12, "avg": 11.25, "max": 10.33, "min": 15.21, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 0.71, "avg": 0.71, "max": 0.71, "min": 0.71, "cnt": 1}, "forward-send-backward-recv":{"total": 1369.99, "avg": 44.19, "max": 0.85, "min": 303.00, "cnt": 31}, "backward-compute":{"total": 1670.72, "avg": 52.21, "max": 50.72, "min": 55.78, "cnt": 32}, "MoE_L3_bwd":{"total": 383.13, "avg": 11.97, "max": 10.98, "min": 15.79, "cnt": 32}, "MoE_L2_bwd":{"total": 355.81, "avg": 11.12, "max": 10.23, "min": 12.44, "cnt": 32}, "MoE_L1_bwd":{"total": 354.42, "avg": 11.08, "max": 10.38, "min": 13.32, "cnt": 32}, "MoE_L0_bwd":{"total": 360.49, "avg": 11.27, "max": 10.60, "min": 12.63, "cnt": 32}, "backward-send-forward-recv":{"total": 832.21, "avg": 27.74, "max": 1.95, "min": 270.82, "cnt": 30}, "backward-send":{"total": 2.25, "avg": 1.13, "max": 1.10, "min": 1.15, "cnt": 2}, "backward-recv":{"total": 72.00, "avg": 72.00, "max": 72.00, "min": 72.00, "cnt": 1}, "backward-params-all-reduce":{"total": 486.65, "avg": 486.65, "max": 486.65, "min": 486.65, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 299.75, "avg": 299.75, "max": 299.75, "min": 299.75, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 259.97, "avg": 259.97, "max": 259.97, "min": 259.97, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.48, "avg": 3.48, "max": 3.48, "min": 3.48, "cnt": 1}}}
{"type":"time", "iteration": 159, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.11, "avg": 0.11, "max": 0.11, "min": 0.11, "cnt": 1}, "forward-recv":{"total": 147.27, "avg": 73.64, "max": 0.74, "min": 146.53, "cnt": 2}, "forward-compute":{"total": 1860.10, "avg": 58.13, "max": 51.91, "min": 64.25, "cnt": 32}, "fwd-compute":{"total": 1856.86, "avg": 58.03, "max": 51.83, "min": 64.17, "cnt": 32}, "batch-generator":{"total": 41.97, "avg": 1.31, "max": 0.72, "min": 2.86, "cnt": 32}, "fwd-embedding":{"total": 0.70, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1801.95, "avg": 56.31, "max": 50.80, "min": 63.05, "cnt": 32}, "fwd-layernorm":{"total": 9.83, "avg": 0.08, "max": 0.05, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 110.24, "avg": 0.86, "max": 0.74, "min": 1.73, "cnt": 128}, "fwd-misc":{"total": 21.01, "avg": 0.16, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1639.86, "avg": 12.81, "max": 10.21, "min": 20.21, "cnt": 128}, "MoE_L0_fwd":{"total": 507.18, "avg": 15.85, "max": 12.58, "min": 20.13, "cnt": 32}, "MoEMLP":{"total": 1623.03, "avg": 12.68, "max": 10.10, "min": 20.09, "cnt": 128}, "MoE_L1_fwd":{"total": 394.24, "avg": 12.32, "max": 11.18, "min": 14.80, "cnt": 32}, "MoE_L2_fwd":{"total": 375.00, "avg": 11.72, "max": 10.78, "min": 14.43, "cnt": 32}, "MoE_L3_fwd":{"total": 352.97, "avg": 11.03, "max": 10.14, "min": 15.99, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 0.61, "avg": 0.61, "max": 0.61, "min": 0.61, "cnt": 1}, "forward-send-backward-recv":{"total": 235.79, "avg": 7.61, "max": 0.87, "min": 63.63, "cnt": 31}, "backward-compute":{"total": 1686.71, "avg": 52.71, "max": 50.74, "min": 56.62, "cnt": 32}, "MoE_L3_bwd":{"total": 392.81, "avg": 12.28, "max": 11.08, "min": 15.65, "cnt": 32}, "MoE_L2_bwd":{"total": 362.52, "avg": 11.33, "max": 10.42, "min": 13.23, "cnt": 32}, "MoE_L1_bwd":{"total": 359.60, "avg": 11.24, "max": 10.75, "min": 11.79, "cnt": 32}, "MoE_L0_bwd":{"total": 357.51, "avg": 11.17, "max": 10.59, "min": 12.31, "cnt": 32}, "backward-send-forward-recv":{"total": 2052.12, "avg": 68.40, "max": 2.14, "min": 316.53, "cnt": 30}, "backward-send":{"total": 2.27, "avg": 1.14, "max": 0.90, "min": 1.37, "cnt": 2}, "backward-recv":{"total": 74.19, "avg": 74.19, "max": 74.19, "min": 74.19, "cnt": 1}, "backward-params-all-reduce":{"total": 489.64, "avg": 489.64, "max": 489.64, "min": 489.64, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 297.42, "avg": 297.42, "max": 297.42, "min": 297.42, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 257.29, "avg": 257.29, "max": 257.29, "min": 257.29, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.41, "avg": 3.41, "max": 3.41, "min": 3.41, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.52, "avg": 3.52, "max": 3.52, "min": 3.52, "cnt": 1}}}
{"type":"time", "iteration": 160, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 147.52, "avg": 73.76, "max": 8.81, "min": 138.71, "cnt": 2}, "forward-compute":{"total": 1834.87, "avg": 57.34, "max": 53.47, "min": 63.70, "cnt": 32}, "fwd-compute":{"total": 1831.78, "avg": 57.24, "max": 53.40, "min": 63.55, "cnt": 32}, "batch-generator":{"total": 40.27, "avg": 1.26, "max": 0.71, "min": 2.52, "cnt": 32}, "fwd-embedding":{"total": 0.57, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1779.18, "avg": 55.60, "max": 50.94, "min": 61.16, "cnt": 32}, "fwd-layernorm":{"total": 9.36, "avg": 0.07, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 107.25, "avg": 0.84, "max": 0.74, "min": 2.21, "cnt": 128}, "fwd-misc":{"total": 20.32, "avg": 0.16, "max": 0.11, "min": 0.38, "cnt": 128}, "fwd-MLP":{"total": 1621.53, "avg": 12.67, "max": 10.22, "min": 18.38, "cnt": 128}, "MoE_L0_fwd":{"total": 483.07, "avg": 15.10, "max": 12.07, "min": 18.30, "cnt": 32}, "MoEMLP":{"total": 1605.20, "avg": 12.54, "max": 10.11, "min": 18.26, "cnt": 128}, "MoE_L1_fwd":{"total": 396.73, "avg": 12.40, "max": 11.26, "min": 14.80, "cnt": 32}, "MoE_L2_fwd":{"total": 378.30, "avg": 11.82, "max": 10.91, "min": 14.72, "cnt": 32}, "MoE_L3_fwd":{"total": 353.19, "avg": 11.04, "max": 10.15, "min": 13.07, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 0.96, "avg": 0.96, "max": 0.96, "min": 0.96, "cnt": 1}, "forward-send-backward-recv":{"total": 200.10, "avg": 6.45, "max": 0.83, "min": 57.77, "cnt": 31}, "backward-compute":{"total": 1719.15, "avg": 53.72, "max": 50.92, "min": 57.85, "cnt": 32}, "MoE_L3_bwd":{"total": 412.37, "avg": 12.89, "max": 11.10, "min": 17.37, "cnt": 32}, "MoE_L2_bwd":{"total": 368.77, "avg": 11.52, "max": 10.33, "min": 12.90, "cnt": 32}, "MoE_L1_bwd":{"total": 365.63, "avg": 11.43, "max": 10.72, "min": 13.54, "cnt": 32}, "MoE_L0_bwd":{"total": 357.65, "avg": 11.18, "max": 10.59, "min": 12.03, "cnt": 32}, "backward-send-forward-recv":{"total": 2334.79, "avg": 77.83, "max": 2.14, "min": 390.47, "cnt": 30}, "backward-send":{"total": 1.14, "avg": 0.57, "max": 0.46, "min": 0.68, "cnt": 2}, "backward-recv":{"total": 70.47, "avg": 70.47, "max": 70.47, "min": 70.47, "cnt": 1}, "backward-params-all-reduce":{"total": 489.91, "avg": 489.91, "max": 489.91, "min": 489.91, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 294.43, "avg": 294.43, "max": 294.43, "min": 294.43, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 254.41, "avg": 254.41, "max": 254.41, "min": 254.41, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.54, "avg": 3.54, "max": 3.54, "min": 3.54, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 161, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 141.10, "avg": 70.55, "max": 5.50, "min": 135.60, "cnt": 2}, "forward-compute":{"total": 1855.70, "avg": 57.99, "max": 51.40, "min": 67.97, "cnt": 32}, "fwd-compute":{"total": 1852.59, "avg": 57.89, "max": 51.33, "min": 67.85, "cnt": 32}, "batch-generator":{"total": 36.23, "avg": 1.13, "max": 0.65, "min": 1.82, "cnt": 32}, "fwd-embedding":{"total": 0.61, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1803.78, "avg": 56.37, "max": 50.38, "min": 65.84, "cnt": 32}, "fwd-layernorm":{"total": 9.26, "avg": 0.07, "max": 0.05, "min": 0.18, "cnt": 128}, "fwd-attn":{"total": 106.49, "avg": 0.83, "max": 0.74, "min": 1.42, "cnt": 128}, "fwd-misc":{"total": 19.69, "avg": 0.15, "max": 0.11, "min": 0.32, "cnt": 128}, "fwd-MLP":{"total": 1648.07, "avg": 12.88, "max": 10.41, "min": 26.35, "cnt": 128}, "MoE_L0_fwd":{"total": 505.44, "avg": 15.79, "max": 12.47, "min": 26.28, "cnt": 32}, "MoEMLP":{"total": 1631.70, "avg": 12.75, "max": 10.30, "min": 26.22, "cnt": 128}, "MoE_L1_fwd":{"total": 386.25, "avg": 12.07, "max": 11.13, "min": 16.73, "cnt": 32}, "MoE_L2_fwd":{"total": 387.61, "avg": 12.11, "max": 10.72, "min": 16.77, "cnt": 32}, "MoE_L3_fwd":{"total": 358.41, "avg": 11.20, "max": 10.34, "min": 14.04, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 0.73, "avg": 0.73, "max": 0.73, "min": 0.73, "cnt": 1}, "forward-send-backward-recv":{"total": 385.31, "avg": 12.43, "max": 0.87, "min": 116.55, "cnt": 31}, "backward-compute":{"total": 1703.19, "avg": 53.22, "max": 50.05, "min": 55.88, "cnt": 32}, "MoE_L3_bwd":{"total": 395.00, "avg": 12.34, "max": 11.20, "min": 14.88, "cnt": 32}, "MoE_L2_bwd":{"total": 377.45, "avg": 11.80, "max": 10.67, "min": 12.93, "cnt": 32}, "MoE_L1_bwd":{"total": 350.06, "avg": 10.94, "max": 10.30, "min": 13.16, "cnt": 32}, "MoE_L0_bwd":{"total": 366.38, "avg": 11.45, "max": 11.00, "min": 11.82, "cnt": 32}, "backward-send-forward-recv":{"total": 1248.77, "avg": 41.63, "max": 0.90, "min": 259.63, "cnt": 30}, "backward-send":{"total": 1.42, "avg": 0.71, "max": 0.52, "min": 0.90, "cnt": 2}, "backward-recv":{"total": 72.52, "avg": 72.52, "max": 72.52, "min": 72.52, "cnt": 1}, "backward-params-all-reduce":{"total": 486.48, "avg": 486.48, "max": 486.48, "min": 486.48, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 300.85, "avg": 300.85, "max": 300.85, "min": 300.85, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 260.87, "avg": 260.87, "max": 260.87, "min": 260.87, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.49, "avg": 3.49, "max": 3.49, "min": 3.49, "cnt": 1}}}
{"type":"time", "iteration": 162, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 130.80, "avg": 65.40, "max": 2.60, "min": 128.19, "cnt": 2}, "forward-compute":{"total": 1877.47, "avg": 58.67, "max": 53.70, "min": 67.89, "cnt": 32}, "fwd-compute":{"total": 1873.97, "avg": 58.56, "max": 53.62, "min": 67.81, "cnt": 32}, "batch-generator":{"total": 44.24, "avg": 1.38, "max": 0.73, "min": 2.85, "cnt": 32}, "fwd-embedding":{"total": 0.80, "avg": 0.03, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1815.83, "avg": 56.74, "max": 52.01, "min": 66.67, "cnt": 32}, "fwd-layernorm":{"total": 10.43, "avg": 0.08, "max": 0.06, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 113.45, "avg": 0.89, "max": 0.74, "min": 2.74, "cnt": 128}, "fwd-misc":{"total": 22.28, "avg": 0.17, "max": 0.11, "min": 0.41, "cnt": 128}, "fwd-MLP":{"total": 1647.93, "avg": 12.87, "max": 10.23, "min": 23.62, "cnt": 128}, "MoE_L0_fwd":{"total": 532.25, "avg": 16.63, "max": 13.04, "min": 23.55, "cnt": 32}, "MoEMLP":{"total": 1630.10, "avg": 12.74, "max": 10.12, "min": 23.49, "cnt": 128}, "MoE_L1_fwd":{"total": 387.98, "avg": 12.12, "max": 11.09, "min": 15.18, "cnt": 32}, "MoE_L2_fwd":{"total": 365.48, "avg": 11.42, "max": 10.86, "min": 13.12, "cnt": 32}, "MoE_L3_fwd":{"total": 350.92, "avg": 10.97, "max": 10.17, "min": 15.36, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 0.72, "avg": 0.72, "max": 0.72, "min": 0.72, "cnt": 1}, "forward-send-backward-recv":{"total": 688.88, "avg": 22.22, "max": 0.89, "min": 202.68, "cnt": 31}, "backward-compute":{"total": 1671.98, "avg": 52.25, "max": 50.18, "min": 56.70, "cnt": 32}, "MoE_L3_bwd":{"total": 379.55, "avg": 11.86, "max": 10.64, "min": 13.42, "cnt": 32}, "MoE_L2_bwd":{"total": 361.31, "avg": 11.29, "max": 10.70, "min": 13.04, "cnt": 32}, "MoE_L1_bwd":{"total": 350.40, "avg": 10.95, "max": 10.27, "min": 13.32, "cnt": 32}, "MoE_L0_bwd":{"total": 363.91, "avg": 11.37, "max": 10.97, "min": 12.08, "cnt": 32}, "backward-send-forward-recv":{"total": 2025.26, "avg": 67.51, "max": 0.96, "min": 955.61, "cnt": 30}, "backward-send":{"total": 1.92, "avg": 0.96, "max": 0.79, "min": 1.13, "cnt": 2}, "backward-recv":{"total": 77.92, "avg": 77.92, "max": 77.92, "min": 77.92, "cnt": 1}, "backward-params-all-reduce":{"total": 487.75, "avg": 487.75, "max": 487.75, "min": 487.75, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 305.49, "avg": 305.49, "max": 305.49, "min": 305.49, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 257.95, "avg": 257.95, "max": 257.95, "min": 257.95, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.84, "avg": 3.84, "max": 3.84, "min": 3.84, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.50, "avg": 3.50, "max": 3.50, "min": 3.50, "cnt": 1}}}
{"type":"time", "iteration": 163, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 143.81, "avg": 71.91, "max": 3.20, "min": 140.62, "cnt": 2}, "forward-compute":{"total": 1981.45, "avg": 61.92, "max": 54.40, "min": 127.56, "cnt": 32}, "fwd-compute":{"total": 1978.23, "avg": 61.82, "max": 54.33, "min": 127.46, "cnt": 32}, "batch-generator":{"total": 37.64, "avg": 1.18, "max": 0.68, "min": 1.63, "cnt": 32}, "fwd-embedding":{"total": 0.68, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1927.13, "avg": 60.22, "max": 52.95, "min": 125.90, "cnt": 32}, "fwd-layernorm":{"total": 10.17, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 109.16, "avg": 0.85, "max": 0.75, "min": 1.46, "cnt": 128}, "fwd-misc":{"total": 21.73, "avg": 0.17, "max": 0.11, "min": 0.34, "cnt": 128}, "fwd-MLP":{"total": 1764.63, "avg": 13.79, "max": 10.33, "min": 86.54, "cnt": 128}, "MoE_L0_fwd":{"total": 600.40, "avg": 18.76, "max": 12.48, "min": 86.43, "cnt": 32}, "MoEMLP":{"total": 1746.96, "avg": 13.65, "max": 10.22, "min": 86.37, "cnt": 128}, "MoE_L1_fwd":{"total": 412.34, "avg": 12.89, "max": 11.51, "min": 17.85, "cnt": 32}, "MoE_L2_fwd":{"total": 371.06, "avg": 11.60, "max": 10.90, "min": 13.28, "cnt": 32}, "MoE_L3_fwd":{"total": 369.66, "avg": 11.55, "max": 10.26, "min": 17.57, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 0.57, "avg": 0.57, "max": 0.57, "min": 0.57, "cnt": 1}, "forward-send-backward-recv":{"total": 607.10, "avg": 19.58, "max": 0.89, "min": 172.59, "cnt": 31}, "backward-compute":{"total": 1707.55, "avg": 53.36, "max": 51.07, "min": 59.53, "cnt": 32}, "MoE_L3_bwd":{"total": 395.55, "avg": 12.36, "max": 10.81, "min": 18.48, "cnt": 32}, "MoE_L2_bwd":{"total": 365.27, "avg": 11.41, "max": 10.60, "min": 14.62, "cnt": 32}, "MoE_L1_bwd":{"total": 358.51, "avg": 11.20, "max": 10.66, "min": 11.43, "cnt": 32}, "MoE_L0_bwd":{"total": 366.60, "avg": 11.46, "max": 10.94, "min": 13.07, "cnt": 32}, "backward-send-forward-recv":{"total": 259.82, "avg": 8.66, "max": 0.90, "min": 57.52, "cnt": 30}, "backward-send":{"total": 1.20, "avg": 0.60, "max": 0.49, "min": 0.72, "cnt": 2}, "backward-recv":{"total": 71.59, "avg": 71.59, "max": 71.59, "min": 71.59, "cnt": 1}, "backward-params-all-reduce":{"total": 485.18, "avg": 485.18, "max": 485.18, "min": 485.18, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 302.81, "avg": 302.81, "max": 302.81, "min": 302.81, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 262.90, "avg": 262.90, "max": 262.90, "min": 262.90, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 164, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.10, "avg": 0.10, "max": 0.10, "min": 0.10, "cnt": 1}, "forward-recv":{"total": 129.54, "avg": 64.77, "max": 0.73, "min": 128.80, "cnt": 2}, "forward-compute":{"total": 1860.41, "avg": 58.14, "max": 53.41, "min": 64.78, "cnt": 32}, "fwd-compute":{"total": 1857.30, "avg": 58.04, "max": 53.32, "min": 64.71, "cnt": 32}, "batch-generator":{"total": 38.24, "avg": 1.20, "max": 0.68, "min": 2.51, "cnt": 32}, "fwd-embedding":{"total": 0.62, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1806.89, "avg": 56.47, "max": 51.93, "min": 63.59, "cnt": 32}, "fwd-layernorm":{"total": 9.41, "avg": 0.07, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 105.79, "avg": 0.83, "max": 0.74, "min": 1.43, "cnt": 128}, "fwd-misc":{"total": 20.46, "avg": 0.16, "max": 0.11, "min": 0.38, "cnt": 128}, "fwd-MLP":{"total": 1650.90, "avg": 12.90, "max": 10.42, "min": 20.49, "cnt": 128}, "MoE_L0_fwd":{"total": 516.33, "avg": 16.14, "max": 13.09, "min": 20.39, "cnt": 32}, "MoEMLP":{"total": 1634.45, "avg": 12.77, "max": 10.31, "min": 20.35, "cnt": 128}, "MoE_L1_fwd":{"total": 395.89, "avg": 12.37, "max": 11.31, "min": 13.82, "cnt": 32}, "MoE_L2_fwd":{"total": 367.48, "avg": 11.48, "max": 10.86, "min": 12.98, "cnt": 32}, "MoE_L3_fwd":{"total": 360.81, "avg": 11.28, "max": 10.35, "min": 15.48, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 0.73, "avg": 0.73, "max": 0.73, "min": 0.73, "cnt": 1}, "forward-send-backward-recv":{"total": 279.51, "avg": 9.02, "max": 0.93, "min": 111.67, "cnt": 31}, "backward-compute":{"total": 1702.17, "avg": 53.19, "max": 51.08, "min": 57.30, "cnt": 32}, "MoE_L3_bwd":{"total": 394.09, "avg": 12.32, "max": 11.49, "min": 15.87, "cnt": 32}, "MoE_L2_bwd":{"total": 362.83, "avg": 11.34, "max": 10.79, "min": 12.10, "cnt": 32}, "MoE_L1_bwd":{"total": 363.13, "avg": 11.35, "max": 10.59, "min": 12.03, "cnt": 32}, "MoE_L0_bwd":{"total": 366.91, "avg": 11.47, "max": 10.90, "min": 15.02, "cnt": 32}, "backward-send-forward-recv":{"total": 1593.61, "avg": 53.12, "max": 0.94, "min": 567.08, "cnt": 30}, "backward-send":{"total": 0.92, "avg": 0.46, "max": 0.45, "min": 0.48, "cnt": 2}, "backward-recv":{"total": 69.91, "avg": 69.91, "max": 69.91, "min": 69.91, "cnt": 1}, "backward-params-all-reduce":{"total": 488.80, "avg": 488.80, "max": 488.80, "min": 488.80, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.04, "avg": 0.04, "max": 0.04, "min": 0.04, "cnt": 1}, "optimizer":{"total": 296.11, "avg": 296.11, "max": 296.11, "min": 296.11, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.40, "avg": 3.40, "max": 3.40, "min": 3.40, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 255.90, "avg": 255.90, "max": 255.90, "min": 255.90, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.54, "avg": 3.54, "max": 3.54, "min": 3.54, "cnt": 1}}}
{"type":"time", "iteration": 165, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 140.55, "avg": 70.27, "max": 5.59, "min": 134.96, "cnt": 2}, "forward-compute":{"total": 1887.28, "avg": 58.98, "max": 51.78, "min": 65.95, "cnt": 32}, "fwd-compute":{"total": 1883.79, "avg": 58.87, "max": 51.68, "min": 65.81, "cnt": 32}, "batch-generator":{"total": 44.55, "avg": 1.39, "max": 0.76, "min": 2.47, "cnt": 32}, "fwd-embedding":{"total": 0.75, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1825.50, "avg": 57.05, "max": 50.52, "min": 63.57, "cnt": 32}, "fwd-layernorm":{"total": 10.84, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 114.46, "avg": 0.89, "max": 0.74, "min": 2.10, "cnt": 128}, "fwd-misc":{"total": 22.91, "avg": 0.18, "max": 0.11, "min": 0.39, "cnt": 128}, "fwd-MLP":{"total": 1654.53, "avg": 12.93, "max": 10.56, "min": 23.17, "cnt": 128}, "MoE_L0_fwd":{"total": 518.49, "avg": 16.20, "max": 12.21, "min": 23.08, "cnt": 32}, "MoEMLP":{"total": 1635.70, "avg": 12.78, "max": 10.46, "min": 23.04, "cnt": 128}, "MoE_L1_fwd":{"total": 383.28, "avg": 11.98, "max": 11.15, "min": 14.26, "cnt": 32}, "MoE_L2_fwd":{"total": 374.88, "avg": 11.71, "max": 10.98, "min": 18.28, "cnt": 32}, "MoE_L3_fwd":{"total": 365.90, "avg": 11.43, "max": 10.50, "min": 15.89, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.05, "cnt": 32}, "forward-send":{"total": 0.97, "avg": 0.97, "max": 0.97, "min": 0.97, "cnt": 1}, "forward-send-backward-recv":{"total": 1272.62, "avg": 41.05, "max": 0.96, "min": 524.20, "cnt": 31}, "backward-compute":{"total": 1689.93, "avg": 52.81, "max": 50.16, "min": 55.92, "cnt": 32}, "MoE_L3_bwd":{"total": 387.70, "avg": 12.12, "max": 11.26, "min": 15.55, "cnt": 32}, "MoE_L2_bwd":{"total": 371.18, "avg": 11.60, "max": 10.79, "min": 12.88, "cnt": 32}, "MoE_L1_bwd":{"total": 351.04, "avg": 10.97, "max": 10.18, "min": 13.61, "cnt": 32}, "MoE_L0_bwd":{"total": 362.78, "avg": 11.34, "max": 10.93, "min": 11.67, "cnt": 32}, "backward-send-forward-recv":{"total": 1590.65, "avg": 53.02, "max": 0.97, "min": 462.92, "cnt": 30}, "backward-send":{"total": 1.72, "avg": 0.86, "max": 0.61, "min": 1.11, "cnt": 2}, "backward-recv":{"total": 746.16, "avg": 746.16, "max": 746.16, "min": 746.16, "cnt": 1}, "backward-params-all-reduce":{"total": 489.93, "avg": 489.93, "max": 489.93, "min": 489.93, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 303.30, "avg": 303.30, "max": 303.30, "min": 303.30, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 258.72, "avg": 258.72, "max": 258.72, "min": 258.72, "cnt": 1}, "optimizer-clip-main-grad":{"total": 7.14, "avg": 7.14, "max": 7.14, "min": 7.14, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.51, "avg": 3.51, "max": 3.51, "min": 3.51, "cnt": 1}}}
{"type":"time", "iteration": 166, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 144.54, "avg": 72.27, "max": 10.10, "min": 134.44, "cnt": 2}, "forward-compute":{"total": 1865.02, "avg": 58.28, "max": 51.57, "min": 70.35, "cnt": 32}, "fwd-compute":{"total": 1861.42, "avg": 58.17, "max": 51.50, "min": 70.20, "cnt": 32}, "batch-generator":{"total": 47.55, "avg": 1.49, "max": 0.77, "min": 5.23, "cnt": 32}, "fwd-embedding":{"total": 0.66, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1799.66, "avg": 56.24, "max": 50.35, "min": 67.99, "cnt": 32}, "fwd-layernorm":{"total": 10.39, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 112.75, "avg": 0.88, "max": 0.74, "min": 1.82, "cnt": 128}, "fwd-misc":{"total": 22.91, "avg": 0.18, "max": 0.12, "min": 0.40, "cnt": 128}, "fwd-MLP":{"total": 1631.01, "avg": 12.74, "max": 10.32, "min": 22.17, "cnt": 128}, "MoE_L0_fwd":{"total": 503.74, "avg": 15.74, "max": 12.65, "min": 22.05, "cnt": 32}, "MoEMLP":{"total": 1612.61, "avg": 12.60, "max": 10.20, "min": 22.01, "cnt": 128}, "MoE_L1_fwd":{"total": 390.16, "avg": 12.19, "max": 11.22, "min": 15.39, "cnt": 32}, "MoE_L2_fwd":{"total": 372.79, "avg": 11.65, "max": 11.01, "min": 14.04, "cnt": 32}, "MoE_L3_fwd":{"total": 352.50, "avg": 11.02, "max": 10.24, "min": 15.19, "cnt": 32}, "fwd-pooler":{"total": 0.36, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.61, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 0.98, "avg": 0.98, "max": 0.98, "min": 0.98, "cnt": 1}, "forward-send-backward-recv":{"total": 400.79, "avg": 12.93, "max": 0.98, "min": 89.59, "cnt": 31}, "backward-compute":{"total": 1690.58, "avg": 52.83, "max": 49.87, "min": 59.25, "cnt": 32}, "MoE_L3_bwd":{"total": 390.59, "avg": 12.21, "max": 11.05, "min": 15.71, "cnt": 32}, "MoE_L2_bwd":{"total": 359.43, "avg": 11.23, "max": 9.91, "min": 15.43, "cnt": 32}, "MoE_L1_bwd":{"total": 357.85, "avg": 11.18, "max": 10.58, "min": 12.25, "cnt": 32}, "MoE_L0_bwd":{"total": 364.02, "avg": 11.38, "max": 11.00, "min": 13.37, "cnt": 32}, "backward-send-forward-recv":{"total": 3629.92, "avg": 121.00, "max": 2.19, "min": 926.87, "cnt": 30}, "backward-send":{"total": 1.72, "avg": 0.86, "max": 0.82, "min": 0.89, "cnt": 2}, "backward-recv":{"total": 72.97, "avg": 72.97, "max": 72.97, "min": 72.97, "cnt": 1}, "backward-params-all-reduce":{"total": 488.35, "avg": 488.35, "max": 488.35, "min": 488.35, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 298.54, "avg": 298.54, "max": 298.54, "min": 298.54, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.40, "avg": 3.40, "max": 3.40, "min": 3.40, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 258.59, "avg": 258.59, "max": 258.59, "min": 258.59, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.47, "avg": 3.47, "max": 3.47, "min": 3.47, "cnt": 1}}}
{"type":"time", "iteration": 167, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.10, "avg": 0.10, "max": 0.10, "min": 0.10, "cnt": 1}, "forward-recv":{"total": 135.85, "avg": 67.93, "max": 5.00, "min": 130.86, "cnt": 2}, "forward-compute":{"total": 1907.07, "avg": 59.60, "max": 52.08, "min": 65.24, "cnt": 32}, "fwd-compute":{"total": 1901.18, "avg": 59.41, "max": 51.99, "min": 65.11, "cnt": 32}, "batch-generator":{"total": 53.40, "avg": 1.67, "max": 0.76, "min": 5.82, "cnt": 32}, "fwd-embedding":{"total": 0.88, "avg": 0.03, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1832.23, "avg": 57.26, "max": 50.85, "min": 61.17, "cnt": 32}, "fwd-layernorm":{"total": 11.38, "avg": 0.09, "max": 0.06, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 119.85, "avg": 0.94, "max": 0.75, "min": 1.90, "cnt": 128}, "fwd-misc":{"total": 23.77, "avg": 0.19, "max": 0.11, "min": 0.48, "cnt": 128}, "fwd-MLP":{"total": 1653.68, "avg": 12.92, "max": 10.00, "min": 19.88, "cnt": 128}, "MoE_L0_fwd":{"total": 518.60, "avg": 16.21, "max": 12.77, "min": 19.77, "cnt": 32}, "MoEMLP":{"total": 1634.60, "avg": 12.77, "max": 9.89, "min": 19.72, "cnt": 128}, "MoE_L1_fwd":{"total": 399.76, "avg": 12.49, "max": 11.54, "min": 16.05, "cnt": 32}, "MoE_L2_fwd":{"total": 371.52, "avg": 11.61, "max": 10.88, "min": 14.17, "cnt": 32}, "MoE_L3_fwd":{"total": 351.59, "avg": 10.99, "max": 9.93, "min": 14.50, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 0.79, "avg": 0.79, "max": 0.79, "min": 0.79, "cnt": 1}, "forward-send-backward-recv":{"total": 1629.93, "avg": 52.58, "max": 1.63, "min": 305.13, "cnt": 31}, "backward-compute":{"total": 1685.64, "avg": 52.68, "max": 51.28, "min": 55.32, "cnt": 32}, "MoE_L3_bwd":{"total": 383.04, "avg": 11.97, "max": 10.93, "min": 14.80, "cnt": 32}, "MoE_L2_bwd":{"total": 354.53, "avg": 11.08, "max": 10.30, "min": 14.90, "cnt": 32}, "MoE_L1_bwd":{"total": 368.15, "avg": 11.50, "max": 10.95, "min": 13.18, "cnt": 32}, "MoE_L0_bwd":{"total": 364.30, "avg": 11.38, "max": 10.94, "min": 12.19, "cnt": 32}, "backward-send-forward-recv":{"total": 688.25, "avg": 22.94, "max": 0.93, "min": 185.48, "cnt": 30}, "backward-send":{"total": 1.99, "avg": 0.99, "max": 0.97, "min": 1.02, "cnt": 2}, "backward-recv":{"total": 74.35, "avg": 74.35, "max": 74.35, "min": 74.35, "cnt": 1}, "backward-params-all-reduce":{"total": 485.10, "avg": 485.10, "max": 485.10, "min": 485.10, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.04, "avg": 0.04, "max": 0.04, "min": 0.04, "cnt": 1}, "optimizer":{"total": 301.38, "avg": 301.38, "max": 301.38, "min": 301.38, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 261.38, "avg": 261.38, "max": 261.38, "min": 261.38, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.26, "avg": 3.26, "max": 3.26, "min": 3.26, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.52, "avg": 3.52, "max": 3.52, "min": 3.52, "cnt": 1}}}
{"type":"time", "iteration": 168, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.29, "avg": 0.29, "max": 0.29, "min": 0.29, "cnt": 1}, "forward-recv":{"total": 132.68, "avg": 66.34, "max": 0.93, "min": 131.75, "cnt": 2}, "forward-compute":{"total": 1833.31, "avg": 57.29, "max": 53.57, "min": 63.44, "cnt": 32}, "fwd-compute":{"total": 1830.03, "avg": 57.19, "max": 53.50, "min": 63.30, "cnt": 32}, "batch-generator":{"total": 38.81, "avg": 1.21, "max": 0.74, "min": 2.23, "cnt": 32}, "fwd-embedding":{"total": 0.57, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1778.99, "avg": 55.59, "max": 52.24, "min": 60.97, "cnt": 32}, "fwd-layernorm":{"total": 9.36, "avg": 0.07, "max": 0.06, "min": 0.18, "cnt": 128}, "fwd-attn":{"total": 109.21, "avg": 0.85, "max": 0.74, "min": 1.57, "cnt": 128}, "fwd-misc":{"total": 20.72, "avg": 0.16, "max": 0.12, "min": 0.40, "cnt": 128}, "fwd-MLP":{"total": 1618.76, "avg": 12.65, "max": 10.37, "min": 18.89, "cnt": 128}, "MoE_L0_fwd":{"total": 492.32, "avg": 15.38, "max": 12.43, "min": 18.82, "cnt": 32}, "MoEMLP":{"total": 1602.04, "avg": 12.52, "max": 10.26, "min": 18.77, "cnt": 128}, "MoE_L1_fwd":{"total": 402.23, "avg": 12.57, "max": 11.24, "min": 17.03, "cnt": 32}, "MoE_L2_fwd":{"total": 365.22, "avg": 11.41, "max": 10.81, "min": 12.71, "cnt": 32}, "MoE_L3_fwd":{"total": 348.44, "avg": 10.89, "max": 10.30, "min": 12.51, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 0.92, "avg": 0.92, "max": 0.92, "min": 0.92, "cnt": 1}, "forward-send-backward-recv":{"total": 185.78, "avg": 5.99, "max": 0.96, "min": 59.64, "cnt": 31}, "backward-compute":{"total": 1674.71, "avg": 52.33, "max": 50.51, "min": 56.28, "cnt": 32}, "MoE_L3_bwd":{"total": 376.35, "avg": 11.76, "max": 11.02, "min": 12.61, "cnt": 32}, "MoE_L2_bwd":{"total": 349.56, "avg": 10.92, "max": 10.32, "min": 12.49, "cnt": 32}, "MoE_L1_bwd":{"total": 367.42, "avg": 11.48, "max": 11.02, "min": 15.45, "cnt": 32}, "MoE_L0_bwd":{"total": 366.24, "avg": 11.44, "max": 10.82, "min": 13.45, "cnt": 32}, "backward-send-forward-recv":{"total": 2162.64, "avg": 72.09, "max": 2.33, "min": 374.27, "cnt": 30}, "backward-send":{"total": 1.97, "avg": 0.98, "max": 0.94, "min": 1.03, "cnt": 2}, "backward-recv":{"total": 72.60, "avg": 72.60, "max": 72.60, "min": 72.60, "cnt": 1}, "backward-params-all-reduce":{"total": 490.32, "avg": 490.32, "max": 490.32, "min": 490.32, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 302.47, "avg": 302.47, "max": 302.47, "min": 302.47, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 260.25, "avg": 260.25, "max": 260.25, "min": 260.25, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.32, "avg": 3.32, "max": 3.32, "min": 3.32, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 4.02, "avg": 4.02, "max": 4.02, "min": 4.02, "cnt": 1}}}
{"type":"time", "iteration": 169, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 129.11, "avg": 64.55, "max": 3.70, "min": 125.41, "cnt": 2}, "forward-compute":{"total": 1828.32, "avg": 57.14, "max": 51.36, "min": 62.29, "cnt": 32}, "fwd-compute":{"total": 1825.03, "avg": 57.03, "max": 51.28, "min": 62.22, "cnt": 32}, "batch-generator":{"total": 44.04, "avg": 1.38, "max": 0.67, "min": 3.15, "cnt": 32}, "fwd-embedding":{"total": 0.66, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1766.22, "avg": 55.19, "max": 50.25, "min": 60.97, "cnt": 32}, "fwd-layernorm":{"total": 10.17, "avg": 0.08, "max": 0.06, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 111.78, "avg": 0.87, "max": 0.74, "min": 1.99, "cnt": 128}, "fwd-misc":{"total": 21.40, "avg": 0.17, "max": 0.11, "min": 0.39, "cnt": 128}, "fwd-MLP":{"total": 1601.32, "avg": 12.51, "max": 10.39, "min": 19.84, "cnt": 128}, "MoE_L0_fwd":{"total": 500.62, "avg": 15.64, "max": 12.66, "min": 19.77, "cnt": 32}, "MoEMLP":{"total": 1584.10, "avg": 12.38, "max": 10.29, "min": 19.72, "cnt": 128}, "MoE_L1_fwd":{"total": 377.80, "avg": 11.81, "max": 10.85, "min": 13.15, "cnt": 32}, "MoE_L2_fwd":{"total": 360.52, "avg": 11.27, "max": 10.60, "min": 12.37, "cnt": 32}, "MoE_L3_fwd":{"total": 351.55, "avg": 10.99, "max": 10.32, "min": 12.21, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 0.91, "avg": 0.91, "max": 0.91, "min": 0.91, "cnt": 1}, "forward-send-backward-recv":{"total": 1156.40, "avg": 37.30, "max": 0.89, "min": 279.82, "cnt": 31}, "backward-compute":{"total": 1665.96, "avg": 52.06, "max": 50.78, "min": 56.74, "cnt": 32}, "MoE_L3_bwd":{"total": 388.12, "avg": 12.13, "max": 11.42, "min": 13.26, "cnt": 32}, "MoE_L2_bwd":{"total": 351.35, "avg": 10.98, "max": 10.06, "min": 13.91, "cnt": 32}, "MoE_L1_bwd":{"total": 347.17, "avg": 10.85, "max": 10.30, "min": 11.27, "cnt": 32}, "MoE_L0_bwd":{"total": 363.48, "avg": 11.36, "max": 11.03, "min": 12.85, "cnt": 32}, "backward-send-forward-recv":{"total": 3345.29, "avg": 111.51, "max": 1.74, "min": 569.96, "cnt": 30}, "backward-send":{"total": 1.38, "avg": 0.69, "max": 0.60, "min": 0.78, "cnt": 2}, "backward-recv":{"total": 332.20, "avg": 332.20, "max": 332.20, "min": 332.20, "cnt": 1}, "backward-params-all-reduce":{"total": 487.86, "avg": 487.86, "max": 487.86, "min": 487.86, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 296.48, "avg": 296.48, "max": 296.48, "min": 296.48, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 256.60, "avg": 256.60, "max": 256.60, "min": 256.60, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.28, "avg": 3.28, "max": 3.28, "min": 3.28, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.48, "avg": 3.48, "max": 3.48, "min": 3.48, "cnt": 1}}}
{"type":"time", "iteration": 170, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.17, "avg": 0.17, "max": 0.17, "min": 0.17, "cnt": 1}, "forward-recv":{"total": 140.94, "avg": 70.47, "max": 5.42, "min": 135.52, "cnt": 2}, "forward-compute":{"total": 1817.83, "avg": 56.81, "max": 51.48, "min": 67.28, "cnt": 32}, "fwd-compute":{"total": 1814.81, "avg": 56.71, "max": 51.40, "min": 67.21, "cnt": 32}, "batch-generator":{"total": 41.54, "avg": 1.30, "max": 0.68, "min": 2.71, "cnt": 32}, "fwd-embedding":{"total": 0.56, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1760.63, "avg": 55.02, "max": 50.23, "min": 66.05, "cnt": 32}, "fwd-layernorm":{"total": 9.16, "avg": 0.07, "max": 0.06, "min": 0.24, "cnt": 128}, "fwd-attn":{"total": 104.76, "avg": 0.82, "max": 0.74, "min": 1.71, "cnt": 128}, "fwd-misc":{"total": 19.87, "avg": 0.16, "max": 0.11, "min": 0.40, "cnt": 128}, "fwd-MLP":{"total": 1606.98, "avg": 12.55, "max": 10.46, "min": 20.53, "cnt": 128}, "MoE_L0_fwd":{"total": 483.97, "avg": 15.12, "max": 12.58, "min": 20.45, "cnt": 32}, "MoEMLP":{"total": 1590.93, "avg": 12.43, "max": 10.36, "min": 20.41, "cnt": 128}, "MoE_L1_fwd":{"total": 388.22, "avg": 12.13, "max": 10.94, "min": 15.69, "cnt": 32}, "MoE_L2_fwd":{"total": 368.94, "avg": 11.53, "max": 10.70, "min": 14.50, "cnt": 32}, "MoE_L3_fwd":{"total": 355.77, "avg": 11.12, "max": 10.40, "min": 14.19, "cnt": 32}, "fwd-pooler":{"total": 0.36, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.61, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 0.54, "avg": 0.54, "max": 0.54, "min": 0.54, "cnt": 1}, "forward-send-backward-recv":{"total": 702.09, "avg": 22.65, "max": 1.09, "min": 386.57, "cnt": 31}, "backward-compute":{"total": 1690.11, "avg": 52.82, "max": 50.59, "min": 54.95, "cnt": 32}, "MoE_L3_bwd":{"total": 385.41, "avg": 12.04, "max": 11.12, "min": 14.68, "cnt": 32}, "MoE_L2_bwd":{"total": 369.58, "avg": 11.55, "max": 10.78, "min": 13.25, "cnt": 32}, "MoE_L1_bwd":{"total": 351.96, "avg": 11.00, "max": 10.51, "min": 11.89, "cnt": 32}, "MoE_L0_bwd":{"total": 368.07, "avg": 11.50, "max": 10.91, "min": 12.33, "cnt": 32}, "backward-send-forward-recv":{"total": 2097.31, "avg": 69.91, "max": 1.80, "min": 300.98, "cnt": 30}, "backward-send":{"total": 1.73, "avg": 0.87, "max": 0.74, "min": 0.99, "cnt": 2}, "backward-recv":{"total": 69.26, "avg": 69.26, "max": 69.26, "min": 69.26, "cnt": 1}, "backward-params-all-reduce":{"total": 486.32, "avg": 486.32, "max": 486.32, "min": 486.32, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 298.83, "avg": 298.83, "max": 298.83, "min": 298.83, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 257.02, "avg": 257.02, "max": 257.02, "min": 257.02, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.35, "avg": 3.35, "max": 3.35, "min": 3.35, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 5.33, "avg": 5.33, "max": 5.33, "min": 5.33, "cnt": 1}}}
{"type":"time", "iteration": 171, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.21, "avg": 0.21, "max": 0.21, "min": 0.21, "cnt": 1}, "forward-recv":{"total": 130.00, "avg": 65.00, "max": 1.16, "min": 128.84, "cnt": 2}, "forward-compute":{"total": 1858.43, "avg": 58.08, "max": 50.61, "min": 64.51, "cnt": 32}, "fwd-compute":{"total": 1855.08, "avg": 57.97, "max": 50.54, "min": 64.42, "cnt": 32}, "batch-generator":{"total": 46.29, "avg": 1.45, "max": 0.67, "min": 5.15, "cnt": 32}, "fwd-embedding":{"total": 0.73, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1795.50, "avg": 56.11, "max": 48.96, "min": 63.18, "cnt": 32}, "fwd-layernorm":{"total": 10.45, "avg": 0.08, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 111.55, "avg": 0.87, "max": 0.74, "min": 1.53, "cnt": 128}, "fwd-misc":{"total": 21.96, "avg": 0.17, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1629.94, "avg": 12.73, "max": 10.33, "min": 20.56, "cnt": 128}, "MoE_L0_fwd":{"total": 508.42, "avg": 15.89, "max": 12.10, "min": 20.47, "cnt": 32}, "MoEMLP":{"total": 1611.96, "avg": 12.59, "max": 10.23, "min": 20.42, "cnt": 128}, "MoE_L1_fwd":{"total": 389.74, "avg": 12.18, "max": 10.93, "min": 15.37, "cnt": 32}, "MoE_L2_fwd":{"total": 364.90, "avg": 11.40, "max": 10.47, "min": 14.06, "cnt": 32}, "MoE_L3_fwd":{"total": 355.43, "avg": 11.11, "max": 10.27, "min": 13.27, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.56, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 0.84, "avg": 0.84, "max": 0.84, "min": 0.84, "cnt": 1}, "forward-send-backward-recv":{"total": 1593.78, "avg": 51.41, "max": 1.32, "min": 253.60, "cnt": 31}, "backward-compute":{"total": 1669.38, "avg": 52.17, "max": 49.40, "min": 54.53, "cnt": 32}, "MoE_L3_bwd":{"total": 385.64, "avg": 12.05, "max": 10.63, "min": 14.21, "cnt": 32}, "MoE_L2_bwd":{"total": 352.14, "avg": 11.00, "max": 10.13, "min": 12.07, "cnt": 32}, "MoE_L1_bwd":{"total": 354.82, "avg": 11.09, "max": 10.14, "min": 13.64, "cnt": 32}, "MoE_L0_bwd":{"total": 363.73, "avg": 11.37, "max": 10.60, "min": 12.21, "cnt": 32}, "backward-send-forward-recv":{"total": 1836.04, "avg": 61.20, "max": 0.95, "min": 779.16, "cnt": 30}, "backward-send":{"total": 1.78, "avg": 0.89, "max": 0.67, "min": 1.10, "cnt": 2}, "backward-recv":{"total": 88.52, "avg": 88.52, "max": 88.52, "min": 88.52, "cnt": 1}, "backward-params-all-reduce":{"total": 487.05, "avg": 487.05, "max": 487.05, "min": 487.05, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "optimizer":{"total": 297.56, "avg": 297.56, "max": 297.56, "min": 297.56, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.41, "avg": 3.41, "max": 3.41, "min": 3.41, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 257.36, "avg": 257.36, "max": 257.36, "min": 257.36, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.54, "avg": 3.54, "max": 3.54, "min": 3.54, "cnt": 1}}}
{"type":"time", "iteration": 172, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 137.77, "avg": 68.88, "max": 8.11, "min": 129.65, "cnt": 2}, "forward-compute":{"total": 1851.53, "avg": 57.86, "max": 53.17, "min": 63.26, "cnt": 32}, "fwd-compute":{"total": 1848.52, "avg": 57.77, "max": 53.07, "min": 63.17, "cnt": 32}, "batch-generator":{"total": 35.61, "avg": 1.11, "max": 0.72, "min": 1.60, "cnt": 32}, "fwd-embedding":{"total": 0.60, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1799.77, "avg": 56.24, "max": 51.53, "min": 61.89, "cnt": 32}, "fwd-layernorm":{"total": 9.01, "avg": 0.07, "max": 0.05, "min": 0.18, "cnt": 128}, "fwd-attn":{"total": 104.41, "avg": 0.82, "max": 0.74, "min": 1.42, "cnt": 128}, "fwd-misc":{"total": 19.43, "avg": 0.15, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1646.99, "avg": 12.87, "max": 10.63, "min": 21.13, "cnt": 128}, "MoE_L0_fwd":{"total": 518.84, "avg": 16.21, "max": 12.27, "min": 21.05, "cnt": 32}, "MoEMLP":{"total": 1630.83, "avg": 12.74, "max": 10.52, "min": 21.00, "cnt": 128}, "MoE_L1_fwd":{"total": 383.05, "avg": 11.97, "max": 10.98, "min": 14.09, "cnt": 32}, "MoE_L2_fwd":{"total": 364.21, "avg": 11.38, "max": 10.73, "min": 12.09, "cnt": 32}, "MoE_L3_fwd":{"total": 370.74, "avg": 11.59, "max": 10.56, "min": 16.15, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 0.94, "avg": 0.94, "max": 0.94, "min": 0.94, "cnt": 1}, "forward-send-backward-recv":{"total": 213.08, "avg": 6.87, "max": 0.92, "min": 69.53, "cnt": 31}, "backward-compute":{"total": 1672.80, "avg": 52.27, "max": 50.56, "min": 55.25, "cnt": 32}, "MoE_L3_bwd":{"total": 402.44, "avg": 12.58, "max": 11.44, "min": 15.59, "cnt": 32}, "MoE_L2_bwd":{"total": 345.76, "avg": 10.80, "max": 9.94, "min": 12.76, "cnt": 32}, "MoE_L1_bwd":{"total": 350.88, "avg": 10.96, "max": 10.25, "min": 11.42, "cnt": 32}, "MoE_L0_bwd":{"total": 360.34, "avg": 11.26, "max": 10.82, "min": 12.02, "cnt": 32}, "backward-send-forward-recv":{"total": 1109.98, "avg": 37.00, "max": 1.03, "min": 163.63, "cnt": 30}, "backward-send":{"total": 1.17, "avg": 0.58, "max": 0.44, "min": 0.73, "cnt": 2}, "backward-recv":{"total": 68.85, "avg": 68.85, "max": 68.85, "min": 68.85, "cnt": 1}, "backward-params-all-reduce":{"total": 488.73, "avg": 488.73, "max": 488.73, "min": 488.73, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 299.09, "avg": 299.09, "max": 299.09, "min": 299.09, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 259.16, "avg": 259.16, "max": 259.16, "min": 259.16, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.32, "avg": 3.32, "max": 3.32, "min": 3.32, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.50, "avg": 3.50, "max": 3.50, "min": 3.50, "cnt": 1}}}
{"type":"time", "iteration": 173, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 128.14, "avg": 64.07, "max": 0.70, "min": 127.45, "cnt": 2}, "forward-compute":{"total": 1829.49, "avg": 57.17, "max": 51.03, "min": 64.11, "cnt": 32}, "fwd-compute":{"total": 1826.37, "avg": 57.07, "max": 50.96, "min": 63.98, "cnt": 32}, "batch-generator":{"total": 40.10, "avg": 1.25, "max": 0.70, "min": 3.48, "cnt": 32}, "fwd-embedding":{"total": 0.66, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1774.11, "avg": 55.44, "max": 49.95, "min": 62.25, "cnt": 32}, "fwd-layernorm":{"total": 9.81, "avg": 0.08, "max": 0.06, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 109.21, "avg": 0.85, "max": 0.74, "min": 1.58, "cnt": 128}, "fwd-misc":{"total": 20.91, "avg": 0.16, "max": 0.11, "min": 0.41, "cnt": 128}, "fwd-MLP":{"total": 1613.46, "avg": 12.61, "max": 10.59, "min": 22.95, "cnt": 128}, "MoE_L0_fwd":{"total": 493.16, "avg": 15.41, "max": 12.53, "min": 22.88, "cnt": 32}, "MoEMLP":{"total": 1596.63, "avg": 12.47, "max": 10.48, "min": 22.83, "cnt": 128}, "MoE_L1_fwd":{"total": 389.07, "avg": 12.16, "max": 11.29, "min": 12.93, "cnt": 32}, "MoE_L2_fwd":{"total": 360.06, "avg": 11.25, "max": 10.73, "min": 12.39, "cnt": 32}, "MoE_L3_fwd":{"total": 360.64, "avg": 11.27, "max": 10.52, "min": 15.56, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 0.55, "avg": 0.55, "max": 0.55, "min": 0.55, "cnt": 1}, "forward-send-backward-recv":{"total": 593.59, "avg": 19.15, "max": 1.05, "min": 130.62, "cnt": 31}, "backward-compute":{"total": 1681.20, "avg": 52.54, "max": 49.96, "min": 54.96, "cnt": 32}, "MoE_L3_bwd":{"total": 404.35, "avg": 12.64, "max": 11.53, "min": 14.96, "cnt": 32}, "MoE_L2_bwd":{"total": 345.61, "avg": 10.80, "max": 9.63, "min": 11.68, "cnt": 32}, "MoE_L1_bwd":{"total": 355.09, "avg": 11.10, "max": 10.59, "min": 11.50, "cnt": 32}, "MoE_L0_bwd":{"total": 361.88, "avg": 11.31, "max": 10.88, "min": 12.88, "cnt": 32}, "backward-send-forward-recv":{"total": 1432.55, "avg": 47.75, "max": 1.02, "min": 259.34, "cnt": 30}, "backward-send":{"total": 2.23, "avg": 1.11, "max": 1.07, "min": 1.15, "cnt": 2}, "backward-recv":{"total": 72.90, "avg": 72.90, "max": 72.90, "min": 72.90, "cnt": 1}, "backward-params-all-reduce":{"total": 484.61, "avg": 484.61, "max": 484.61, "min": 484.61, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 311.25, "avg": 311.25, "max": 311.25, "min": 311.25, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 270.72, "avg": 270.72, "max": 270.72, "min": 270.72, "cnt": 1}, "optimizer-clip-main-grad":{"total": 4.06, "avg": 4.06, "max": 4.06, "min": 4.06, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 174, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 135.34, "avg": 67.67, "max": 9.14, "min": 126.20, "cnt": 2}, "forward-compute":{"total": 1896.99, "avg": 59.28, "max": 51.48, "min": 67.98, "cnt": 32}, "fwd-compute":{"total": 1893.60, "avg": 59.18, "max": 51.42, "min": 67.85, "cnt": 32}, "batch-generator":{"total": 42.07, "avg": 1.31, "max": 0.66, "min": 2.65, "cnt": 32}, "fwd-embedding":{"total": 0.77, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1835.27, "avg": 57.35, "max": 50.41, "min": 65.90, "cnt": 32}, "fwd-layernorm":{"total": 10.73, "avg": 0.08, "max": 0.06, "min": 0.23, "cnt": 128}, "fwd-attn":{"total": 114.77, "avg": 0.90, "max": 0.75, "min": 2.42, "cnt": 128}, "fwd-misc":{"total": 22.46, "avg": 0.18, "max": 0.11, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1664.85, "avg": 13.01, "max": 10.61, "min": 20.94, "cnt": 128}, "MoE_L0_fwd":{"total": 518.07, "avg": 16.19, "max": 12.36, "min": 20.80, "cnt": 32}, "MoEMLP":{"total": 1646.79, "avg": 12.87, "max": 10.50, "min": 20.72, "cnt": 128}, "MoE_L1_fwd":{"total": 389.99, "avg": 12.19, "max": 11.09, "min": 14.05, "cnt": 32}, "MoE_L2_fwd":{"total": 380.77, "avg": 11.90, "max": 10.60, "min": 16.43, "cnt": 32}, "MoE_L3_fwd":{"total": 364.61, "avg": 11.39, "max": 10.54, "min": 14.77, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 0.86, "avg": 0.86, "max": 0.86, "min": 0.86, "cnt": 1}, "forward-send-backward-recv":{"total": 804.32, "avg": 25.95, "max": 1.68, "min": 140.89, "cnt": 31}, "backward-compute":{"total": 1655.99, "avg": 51.75, "max": 49.62, "min": 55.39, "cnt": 32}, "MoE_L3_bwd":{"total": 391.18, "avg": 12.22, "max": 11.04, "min": 13.59, "cnt": 32}, "MoE_L2_bwd":{"total": 339.89, "avg": 10.62, "max": 9.74, "min": 12.45, "cnt": 32}, "MoE_L1_bwd":{"total": 352.01, "avg": 11.00, "max": 10.70, "min": 11.95, "cnt": 32}, "MoE_L0_bwd":{"total": 357.16, "avg": 11.16, "max": 10.42, "min": 15.13, "cnt": 32}, "backward-send-forward-recv":{"total": 629.88, "avg": 21.00, "max": 1.16, "min": 194.62, "cnt": 30}, "backward-send":{"total": 1.44, "avg": 0.72, "max": 0.60, "min": 0.84, "cnt": 2}, "backward-recv":{"total": 187.74, "avg": 187.74, "max": 187.74, "min": 187.74, "cnt": 1}, "backward-params-all-reduce":{"total": 488.94, "avg": 488.94, "max": 488.94, "min": 488.94, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 300.66, "avg": 300.66, "max": 300.66, "min": 300.66, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 260.80, "avg": 260.80, "max": 260.80, "min": 260.80, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.48, "avg": 3.48, "max": 3.48, "min": 3.48, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.47, "avg": 3.47, "max": 3.47, "min": 3.47, "cnt": 1}}}
{"type":"time", "iteration": 175, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 134.22, "avg": 67.11, "max": 7.98, "min": 126.24, "cnt": 2}, "forward-compute":{"total": 1834.93, "avg": 57.34, "max": 50.37, "min": 66.30, "cnt": 32}, "fwd-compute":{"total": 1831.57, "avg": 57.24, "max": 50.30, "min": 66.17, "cnt": 32}, "batch-generator":{"total": 41.36, "avg": 1.29, "max": 0.69, "min": 2.64, "cnt": 32}, "fwd-embedding":{"total": 0.73, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1777.40, "avg": 55.54, "max": 49.32, "min": 64.26, "cnt": 32}, "fwd-layernorm":{"total": 12.51, "avg": 0.10, "max": 0.06, "min": 2.47, "cnt": 128}, "fwd-attn":{"total": 113.75, "avg": 0.89, "max": 0.74, "min": 2.70, "cnt": 128}, "fwd-misc":{"total": 21.55, "avg": 0.17, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1608.12, "avg": 12.56, "max": 10.19, "min": 19.35, "cnt": 128}, "MoE_L0_fwd":{"total": 504.18, "avg": 15.76, "max": 12.24, "min": 19.20, "cnt": 32}, "MoEMLP":{"total": 1591.01, "avg": 12.43, "max": 10.09, "min": 19.11, "cnt": 128}, "MoE_L1_fwd":{"total": 383.94, "avg": 12.00, "max": 11.06, "min": 13.43, "cnt": 32}, "MoE_L2_fwd":{"total": 353.85, "avg": 11.06, "max": 10.13, "min": 14.41, "cnt": 32}, "MoE_L3_fwd":{"total": 355.35, "avg": 11.10, "max": 10.36, "min": 13.76, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 0.89, "avg": 0.89, "max": 0.89, "min": 0.89, "cnt": 1}, "forward-send-backward-recv":{"total": 609.87, "avg": 19.67, "max": 1.46, "min": 127.36, "cnt": 31}, "backward-compute":{"total": 1650.60, "avg": 51.58, "max": 50.06, "min": 54.89, "cnt": 32}, "MoE_L3_bwd":{"total": 390.45, "avg": 12.20, "max": 11.12, "min": 14.21, "cnt": 32}, "MoE_L2_bwd":{"total": 338.55, "avg": 10.58, "max": 9.95, "min": 12.72, "cnt": 32}, "MoE_L1_bwd":{"total": 353.27, "avg": 11.04, "max": 10.30, "min": 12.18, "cnt": 32}, "MoE_L0_bwd":{"total": 354.13, "avg": 11.07, "max": 10.68, "min": 11.53, "cnt": 32}, "backward-send-forward-recv":{"total": 938.14, "avg": 31.27, "max": 1.51, "min": 347.37, "cnt": 30}, "backward-send":{"total": 1.80, "avg": 0.90, "max": 0.77, "min": 1.03, "cnt": 2}, "backward-recv":{"total": 264.97, "avg": 264.97, "max": 264.97, "min": 264.97, "cnt": 1}, "backward-params-all-reduce":{"total": 535.25, "avg": 535.25, "max": 535.25, "min": 535.25, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 299.74, "avg": 299.74, "max": 299.74, "min": 299.74, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 255.37, "avg": 255.37, "max": 255.37, "min": 255.37, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.97, "avg": 6.97, "max": 6.97, "min": 6.97, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.48, "avg": 3.48, "max": 3.48, "min": 3.48, "cnt": 1}}}
{"type":"time", "iteration": 176, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.11, "avg": 0.11, "max": 0.11, "min": 0.11, "cnt": 1}, "forward-recv":{"total": 131.98, "avg": 65.99, "max": 0.65, "min": 131.32, "cnt": 2}, "forward-compute":{"total": 1854.33, "avg": 57.95, "max": 50.27, "min": 64.39, "cnt": 32}, "fwd-compute":{"total": 1851.21, "avg": 57.85, "max": 50.19, "min": 64.30, "cnt": 32}, "batch-generator":{"total": 48.11, "avg": 1.50, "max": 0.67, "min": 4.05, "cnt": 32}, "fwd-embedding":{"total": 0.63, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1790.99, "avg": 55.97, "max": 49.03, "min": 62.77, "cnt": 32}, "fwd-layernorm":{"total": 9.49, "avg": 0.07, "max": 0.05, "min": 0.18, "cnt": 128}, "fwd-attn":{"total": 108.47, "avg": 0.85, "max": 0.74, "min": 2.17, "cnt": 128}, "fwd-misc":{"total": 19.80, "avg": 0.15, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1632.98, "avg": 12.76, "max": 10.55, "min": 21.98, "cnt": 128}, "MoE_L0_fwd":{"total": 499.94, "avg": 15.62, "max": 12.04, "min": 21.90, "cnt": 32}, "MoEMLP":{"total": 1616.75, "avg": 12.63, "max": 10.44, "min": 21.86, "cnt": 128}, "MoE_L1_fwd":{"total": 395.97, "avg": 12.37, "max": 11.10, "min": 14.88, "cnt": 32}, "MoE_L2_fwd":{"total": 366.81, "avg": 11.46, "max": 10.64, "min": 13.46, "cnt": 32}, "MoE_L3_fwd":{"total": 360.10, "avg": 11.25, "max": 10.49, "min": 15.81, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 0.53, "avg": 0.53, "max": 0.53, "min": 0.53, "cnt": 1}, "forward-send-backward-recv":{"total": 452.49, "avg": 14.60, "max": 1.14, "min": 247.64, "cnt": 31}, "backward-compute":{"total": 1662.94, "avg": 51.97, "max": 49.78, "min": 54.69, "cnt": 32}, "MoE_L3_bwd":{"total": 393.85, "avg": 12.31, "max": 11.42, "min": 13.97, "cnt": 32}, "MoE_L2_bwd":{"total": 346.86, "avg": 10.84, "max": 10.35, "min": 13.04, "cnt": 32}, "MoE_L1_bwd":{"total": 353.60, "avg": 11.05, "max": 10.39, "min": 12.07, "cnt": 32}, "MoE_L0_bwd":{"total": 354.08, "avg": 11.06, "max": 10.63, "min": 11.87, "cnt": 32}, "backward-send-forward-recv":{"total": 2824.56, "avg": 94.15, "max": 1.32, "min": 493.04, "cnt": 30}, "backward-send":{"total": 2.11, "avg": 1.06, "max": 0.97, "min": 1.15, "cnt": 2}, "backward-recv":{"total": 76.03, "avg": 76.03, "max": 76.03, "min": 76.03, "cnt": 1}, "backward-params-all-reduce":{"total": 487.01, "avg": 487.01, "max": 487.01, "min": 487.01, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 301.02, "avg": 301.02, "max": 301.02, "min": 301.02, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 260.16, "avg": 260.16, "max": 260.16, "min": 260.16, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.80, "avg": 3.80, "max": 3.80, "min": 3.80, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.57, "avg": 3.57, "max": 3.57, "min": 3.57, "cnt": 1}}}
{"type":"time", "iteration": 177, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 124.60, "avg": 62.30, "max": 5.89, "min": 118.70, "cnt": 2}, "forward-compute":{"total": 1857.44, "avg": 58.05, "max": 51.55, "min": 65.56, "cnt": 32}, "fwd-compute":{"total": 1854.02, "avg": 57.94, "max": 51.47, "min": 65.46, "cnt": 32}, "batch-generator":{"total": 38.08, "avg": 1.19, "max": 0.64, "min": 2.08, "cnt": 32}, "fwd-embedding":{"total": 0.68, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1802.41, "avg": 56.33, "max": 49.94, "min": 64.11, "cnt": 32}, "fwd-layernorm":{"total": 10.18, "avg": 0.08, "max": 0.06, "min": 0.23, "cnt": 128}, "fwd-attn":{"total": 110.02, "avg": 0.86, "max": 0.74, "min": 1.80, "cnt": 128}, "fwd-misc":{"total": 21.48, "avg": 0.17, "max": 0.11, "min": 0.42, "cnt": 128}, "fwd-MLP":{"total": 1638.57, "avg": 12.80, "max": 10.59, "min": 21.72, "cnt": 128}, "MoE_L0_fwd":{"total": 512.58, "avg": 16.02, "max": 11.75, "min": 21.63, "cnt": 32}, "MoEMLP":{"total": 1621.01, "avg": 12.66, "max": 10.48, "min": 21.59, "cnt": 128}, "MoE_L1_fwd":{"total": 390.94, "avg": 12.22, "max": 10.82, "min": 17.59, "cnt": 32}, "MoE_L2_fwd":{"total": 366.61, "avg": 11.46, "max": 10.75, "min": 12.80, "cnt": 32}, "MoE_L3_fwd":{"total": 357.41, "avg": 11.17, "max": 10.52, "min": 11.84, "cnt": 32}, "fwd-pooler":{"total": 0.36, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 0.99, "avg": 0.99, "max": 0.99, "min": 0.99, "cnt": 1}, "forward-send-backward-recv":{"total": 1002.56, "avg": 32.34, "max": 0.95, "min": 207.57, "cnt": 31}, "backward-compute":{"total": 1662.14, "avg": 51.94, "max": 48.63, "min": 54.72, "cnt": 32}, "MoE_L3_bwd":{"total": 388.58, "avg": 12.14, "max": 10.67, "min": 13.65, "cnt": 32}, "MoE_L2_bwd":{"total": 348.48, "avg": 10.89, "max": 10.03, "min": 11.68, "cnt": 32}, "MoE_L1_bwd":{"total": 353.11, "avg": 11.03, "max": 10.07, "min": 13.92, "cnt": 32}, "MoE_L0_bwd":{"total": 354.66, "avg": 11.08, "max": 10.64, "min": 11.92, "cnt": 32}, "backward-send-forward-recv":{"total": 1289.80, "avg": 42.99, "max": 0.97, "min": 251.88, "cnt": 30}, "backward-send":{"total": 1.24, "avg": 0.62, "max": 0.45, "min": 0.79, "cnt": 2}, "backward-recv":{"total": 75.62, "avg": 75.62, "max": 75.62, "min": 75.62, "cnt": 1}, "backward-params-all-reduce":{"total": 489.14, "avg": 489.14, "max": 489.14, "min": 489.14, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.05, "avg": 0.05, "max": 0.05, "min": 0.05, "cnt": 1}, "optimizer":{"total": 303.69, "avg": 303.69, "max": 303.69, "min": 303.69, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.41, "avg": 3.41, "max": 3.41, "min": 3.41, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 263.75, "avg": 263.75, "max": 263.75, "min": 263.75, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.36, "avg": 3.36, "max": 3.36, "min": 3.36, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.49, "avg": 3.49, "max": 3.49, "min": 3.49, "cnt": 1}}}
{"type":"time", "iteration": 178, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.14, "avg": 0.14, "max": 0.14, "min": 0.14, "cnt": 1}, "forward-recv":{"total": 133.71, "avg": 66.85, "max": 2.96, "min": 130.74, "cnt": 2}, "forward-compute":{"total": 1816.10, "avg": 56.75, "max": 49.64, "min": 68.42, "cnt": 32}, "fwd-compute":{"total": 1812.71, "avg": 56.65, "max": 49.56, "min": 68.28, "cnt": 32}, "batch-generator":{"total": 43.56, "avg": 1.36, "max": 0.70, "min": 2.12, "cnt": 32}, "fwd-embedding":{"total": 0.76, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1756.33, "avg": 54.89, "max": 48.44, "min": 66.14, "cnt": 32}, "fwd-layernorm":{"total": 10.42, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 112.03, "avg": 0.88, "max": 0.74, "min": 1.50, "cnt": 128}, "fwd-misc":{"total": 22.20, "avg": 0.17, "max": 0.11, "min": 0.44, "cnt": 128}, "fwd-MLP":{"total": 1590.02, "avg": 12.42, "max": 10.25, "min": 18.02, "cnt": 128}, "MoE_L0_fwd":{"total": 478.35, "avg": 14.95, "max": 11.60, "min": 17.92, "cnt": 32}, "MoEMLP":{"total": 1572.39, "avg": 12.28, "max": 10.13, "min": 17.88, "cnt": 128}, "MoE_L1_fwd":{"total": 386.36, "avg": 12.07, "max": 11.02, "min": 14.78, "cnt": 32}, "MoE_L2_fwd":{"total": 361.42, "avg": 11.29, "max": 10.40, "min": 15.65, "cnt": 32}, "MoE_L3_fwd":{"total": 352.88, "avg": 11.03, "max": 10.17, "min": 12.50, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 0.67, "avg": 0.67, "max": 0.67, "min": 0.67, "cnt": 1}, "forward-send-backward-recv":{"total": 1124.52, "avg": 36.27, "max": 1.02, "min": 131.05, "cnt": 31}, "backward-compute":{"total": 1652.79, "avg": 51.65, "max": 49.20, "min": 54.20, "cnt": 32}, "MoE_L3_bwd":{"total": 391.13, "avg": 12.22, "max": 10.57, "min": 14.99, "cnt": 32}, "MoE_L2_bwd":{"total": 344.29, "avg": 10.76, "max": 10.11, "min": 12.79, "cnt": 32}, "MoE_L1_bwd":{"total": 342.05, "avg": 10.69, "max": 10.26, "min": 10.99, "cnt": 32}, "MoE_L0_bwd":{"total": 358.29, "avg": 11.20, "max": 10.77, "min": 12.75, "cnt": 32}, "backward-send-forward-recv":{"total": 1460.91, "avg": 48.70, "max": 1.63, "min": 543.81, "cnt": 30}, "backward-send":{"total": 1.54, "avg": 0.77, "max": 0.74, "min": 0.80, "cnt": 2}, "backward-recv":{"total": 74.62, "avg": 74.62, "max": 74.62, "min": 74.62, "cnt": 1}, "backward-params-all-reduce":{"total": 499.43, "avg": 499.43, "max": 499.43, "min": 499.43, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.04, "avg": 0.04, "max": 0.04, "min": 0.04, "cnt": 1}, "optimizer":{"total": 290.44, "avg": 290.44, "max": 290.44, "min": 290.44, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.40, "avg": 3.40, "max": 3.40, "min": 3.40, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 244.88, "avg": 244.88, "max": 244.88, "min": 244.88, "cnt": 1}, "optimizer-clip-main-grad":{"total": 7.64, "avg": 7.64, "max": 7.64, "min": 7.64, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.59, "avg": 3.59, "max": 3.59, "min": 3.59, "cnt": 1}}}
{"type":"time", "iteration": 179, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.25, "avg": 0.25, "max": 0.25, "min": 0.25, "cnt": 1}, "forward-recv":{"total": 132.48, "avg": 66.24, "max": 7.00, "min": 125.48, "cnt": 2}, "forward-compute":{"total": 1892.32, "avg": 59.14, "max": 53.18, "min": 65.93, "cnt": 32}, "fwd-compute":{"total": 1889.02, "avg": 59.03, "max": 53.11, "min": 65.78, "cnt": 32}, "batch-generator":{"total": 45.78, "avg": 1.43, "max": 0.72, "min": 3.63, "cnt": 32}, "fwd-embedding":{"total": 0.65, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1830.24, "avg": 57.20, "max": 51.19, "min": 63.68, "cnt": 32}, "fwd-layernorm":{"total": 10.04, "avg": 0.08, "max": 0.06, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 111.75, "avg": 0.87, "max": 0.75, "min": 1.82, "cnt": 128}, "fwd-misc":{"total": 21.36, "avg": 0.17, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1665.30, "avg": 13.01, "max": 10.45, "min": 24.25, "cnt": 128}, "MoE_L0_fwd":{"total": 529.93, "avg": 16.56, "max": 12.21, "min": 24.14, "cnt": 32}, "MoEMLP":{"total": 1647.82, "avg": 12.87, "max": 10.32, "min": 24.10, "cnt": 128}, "MoE_L1_fwd":{"total": 392.31, "avg": 12.26, "max": 11.07, "min": 16.58, "cnt": 32}, "MoE_L2_fwd":{"total": 364.75, "avg": 11.40, "max": 10.37, "min": 15.15, "cnt": 32}, "MoE_L3_fwd":{"total": 367.23, "avg": 11.48, "max": 10.78, "min": 15.23, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.04, "cnt": 32}, "forward-send":{"total": 1.00, "avg": 1.00, "max": 1.00, "min": 1.00, "cnt": 1}, "forward-send-backward-recv":{"total": 254.14, "avg": 8.20, "max": 0.89, "min": 60.31, "cnt": 31}, "backward-compute":{"total": 1669.06, "avg": 52.16, "max": 49.91, "min": 58.41, "cnt": 32}, "MoE_L3_bwd":{"total": 399.89, "avg": 12.50, "max": 11.04, "min": 14.35, "cnt": 32}, "MoE_L2_bwd":{"total": 348.42, "avg": 10.89, "max": 10.12, "min": 12.40, "cnt": 32}, "MoE_L1_bwd":{"total": 351.49, "avg": 10.98, "max": 10.01, "min": 16.73, "cnt": 32}, "MoE_L0_bwd":{"total": 356.51, "avg": 11.14, "max": 10.83, "min": 11.80, "cnt": 32}, "backward-send-forward-recv":{"total": 3271.63, "avg": 109.05, "max": 1.17, "min": 596.83, "cnt": 30}, "backward-send":{"total": 1.54, "avg": 0.77, "max": 0.60, "min": 0.94, "cnt": 2}, "backward-recv":{"total": 77.55, "avg": 77.55, "max": 77.55, "min": 77.55, "cnt": 1}, "backward-params-all-reduce":{"total": 491.50, "avg": 491.50, "max": 491.50, "min": 491.50, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 297.60, "avg": 297.60, "max": 297.60, "min": 297.60, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.40, "avg": 3.40, "max": 3.40, "min": 3.40, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 253.30, "avg": 253.30, "max": 253.30, "min": 253.30, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.94, "avg": 6.94, "max": 6.94, "min": 6.94, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 180, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.32, "avg": 0.32, "max": 0.32, "min": 0.32, "cnt": 1}, "forward-recv":{"total": 135.72, "avg": 67.86, "max": 1.24, "min": 134.48, "cnt": 2}, "forward-compute":{"total": 1941.51, "avg": 60.67, "max": 53.18, "min": 135.73, "cnt": 32}, "fwd-compute":{"total": 1938.17, "avg": 60.57, "max": 53.12, "min": 135.65, "cnt": 32}, "batch-generator":{"total": 38.20, "avg": 1.19, "max": 0.63, "min": 2.07, "cnt": 32}, "fwd-embedding":{"total": 0.64, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1886.60, "avg": 58.96, "max": 51.70, "min": 134.30, "cnt": 32}, "fwd-layernorm":{"total": 10.03, "avg": 0.08, "max": 0.05, "min": 0.22, "cnt": 128}, "fwd-attn":{"total": 110.83, "avg": 0.87, "max": 0.74, "min": 1.85, "cnt": 128}, "fwd-misc":{"total": 21.63, "avg": 0.17, "max": 0.11, "min": 0.42, "cnt": 128}, "fwd-MLP":{"total": 1722.21, "avg": 13.45, "max": 10.70, "min": 90.40, "cnt": 128}, "MoE_L0_fwd":{"total": 507.21, "avg": 15.85, "max": 12.88, "min": 20.65, "cnt": 32}, "MoEMLP":{"total": 1704.95, "avg": 13.32, "max": 10.60, "min": 90.26, "cnt": 128}, "MoE_L1_fwd":{"total": 393.10, "avg": 12.28, "max": 11.32, "min": 14.45, "cnt": 32}, "MoE_L2_fwd":{"total": 364.30, "avg": 11.38, "max": 10.64, "min": 13.35, "cnt": 32}, "MoE_L3_fwd":{"total": 446.81, "avg": 13.96, "max": 10.74, "min": 90.31, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.10, "avg": 1.10, "max": 1.10, "min": 1.10, "cnt": 1}, "forward-send-backward-recv":{"total": 525.35, "avg": 16.95, "max": 0.95, "min": 131.48, "cnt": 31}, "backward-compute":{"total": 1677.70, "avg": 52.43, "max": 49.17, "min": 56.25, "cnt": 32}, "MoE_L3_bwd":{"total": 399.13, "avg": 12.47, "max": 11.41, "min": 14.04, "cnt": 32}, "MoE_L2_bwd":{"total": 354.11, "avg": 11.07, "max": 9.85, "min": 12.65, "cnt": 32}, "MoE_L1_bwd":{"total": 345.29, "avg": 10.79, "max": 10.21, "min": 11.37, "cnt": 32}, "MoE_L0_bwd":{"total": 360.61, "avg": 11.27, "max": 10.73, "min": 12.06, "cnt": 32}, "backward-send-forward-recv":{"total": 863.61, "avg": 28.79, "max": 1.38, "min": 115.78, "cnt": 30}, "backward-send":{"total": 1.73, "avg": 0.87, "max": 0.77, "min": 0.96, "cnt": 2}, "backward-recv":{"total": 85.27, "avg": 85.27, "max": 85.27, "min": 85.27, "cnt": 1}, "backward-params-all-reduce":{"total": 491.58, "avg": 491.58, "max": 491.58, "min": 491.58, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.25, "avg": 0.25, "max": 0.25, "min": 0.25, "cnt": 1}, "optimizer":{"total": 302.79, "avg": 302.79, "max": 302.79, "min": 302.79, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.72, "avg": 3.72, "max": 3.72, "min": 3.72, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 256.41, "avg": 256.41, "max": 256.41, "min": 256.41, "cnt": 1}, "optimizer-clip-main-grad":{"total": 7.70, "avg": 7.70, "max": 7.70, "min": 7.70, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.65, "avg": 3.65, "max": 3.65, "min": 3.65, "cnt": 1}}}
{"type":"time", "iteration": 181, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.15, "avg": 0.15, "max": 0.15, "min": 0.15, "cnt": 1}, "forward-recv":{"total": 134.61, "avg": 67.30, "max": 10.23, "min": 124.38, "cnt": 2}, "forward-compute":{"total": 1878.50, "avg": 58.70, "max": 53.99, "min": 65.00, "cnt": 32}, "fwd-compute":{"total": 1875.03, "avg": 58.59, "max": 53.92, "min": 64.87, "cnt": 32}, "batch-generator":{"total": 46.48, "avg": 1.45, "max": 0.74, "min": 2.76, "cnt": 32}, "fwd-embedding":{"total": 0.77, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1814.75, "avg": 56.71, "max": 52.55, "min": 62.65, "cnt": 32}, "fwd-layernorm":{"total": 10.88, "avg": 0.08, "max": 0.05, "min": 0.24, "cnt": 128}, "fwd-attn":{"total": 114.87, "avg": 0.90, "max": 0.75, "min": 2.09, "cnt": 128}, "fwd-misc":{"total": 22.63, "avg": 0.18, "max": 0.11, "min": 0.43, "cnt": 128}, "fwd-MLP":{"total": 1643.81, "avg": 12.84, "max": 10.56, "min": 19.69, "cnt": 128}, "MoE_L0_fwd":{"total": 513.52, "avg": 16.05, "max": 12.48, "min": 19.50, "cnt": 32}, "MoEMLP":{"total": 1625.36, "avg": 12.70, "max": 10.45, "min": 19.40, "cnt": 128}, "MoE_L1_fwd":{"total": 388.20, "avg": 12.13, "max": 11.39, "min": 15.69, "cnt": 32}, "MoE_L2_fwd":{"total": 365.75, "avg": 11.43, "max": 10.59, "min": 13.38, "cnt": 32}, "MoE_L3_fwd":{"total": 364.65, "avg": 11.40, "max": 10.49, "min": 12.95, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.64, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 0.93, "avg": 0.93, "max": 0.93, "min": 0.93, "cnt": 1}, "forward-send-backward-recv":{"total": 486.76, "avg": 15.70, "max": 0.93, "min": 131.40, "cnt": 31}, "backward-compute":{"total": 1682.44, "avg": 52.58, "max": 50.64, "min": 55.12, "cnt": 32}, "MoE_L3_bwd":{"total": 399.02, "avg": 12.47, "max": 11.63, "min": 14.26, "cnt": 32}, "MoE_L2_bwd":{"total": 356.21, "avg": 11.13, "max": 10.30, "min": 12.82, "cnt": 32}, "MoE_L1_bwd":{"total": 346.21, "avg": 10.82, "max": 10.37, "min": 12.24, "cnt": 32}, "MoE_L0_bwd":{"total": 367.23, "avg": 11.48, "max": 10.70, "min": 14.27, "cnt": 32}, "backward-send-forward-recv":{"total": 764.75, "avg": 25.49, "max": 1.64, "min": 182.49, "cnt": 30}, "backward-send":{"total": 1.75, "avg": 0.87, "max": 0.56, "min": 1.19, "cnt": 2}, "backward-recv":{"total": 74.34, "avg": 74.34, "max": 74.34, "min": 74.34, "cnt": 1}, "backward-params-all-reduce":{"total": 486.81, "avg": 486.81, "max": 486.81, "min": 486.81, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "optimizer":{"total": 300.72, "avg": 300.72, "max": 300.72, "min": 300.72, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 256.01, "avg": 256.01, "max": 256.01, "min": 256.01, "cnt": 1}, "optimizer-clip-main-grad":{"total": 7.04, "avg": 7.04, "max": 7.04, "min": 7.04, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.60, "avg": 3.60, "max": 3.60, "min": 3.60, "cnt": 1}}}
{"type":"time", "iteration": 182, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.10, "avg": 0.10, "max": 0.10, "min": 0.10, "cnt": 1}, "forward-recv":{"total": 129.17, "avg": 64.58, "max": 0.77, "min": 128.40, "cnt": 2}, "forward-compute":{"total": 1860.89, "avg": 58.15, "max": 53.26, "min": 64.38, "cnt": 32}, "fwd-compute":{"total": 1857.42, "avg": 58.04, "max": 53.18, "min": 64.25, "cnt": 32}, "batch-generator":{"total": 43.13, "avg": 1.35, "max": 0.76, "min": 2.65, "cnt": 32}, "fwd-embedding":{"total": 0.74, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1800.00, "avg": 56.25, "max": 51.43, "min": 61.52, "cnt": 32}, "fwd-layernorm":{"total": 10.64, "avg": 0.08, "max": 0.05, "min": 0.22, "cnt": 128}, "fwd-attn":{"total": 116.17, "avg": 0.91, "max": 0.74, "min": 2.35, "cnt": 128}, "fwd-misc":{"total": 22.12, "avg": 0.17, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1628.70, "avg": 12.72, "max": 10.66, "min": 20.47, "cnt": 128}, "MoE_L0_fwd":{"total": 506.68, "avg": 15.83, "max": 12.41, "min": 20.39, "cnt": 32}, "MoEMLP":{"total": 1610.49, "avg": 12.58, "max": 10.54, "min": 20.34, "cnt": 128}, "MoE_L1_fwd":{"total": 388.97, "avg": 12.16, "max": 10.89, "min": 16.20, "cnt": 32}, "MoE_L2_fwd":{"total": 361.72, "avg": 11.30, "max": 10.69, "min": 12.38, "cnt": 32}, "MoE_L3_fwd":{"total": 359.70, "avg": 11.24, "max": 10.59, "min": 15.06, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.05, "cnt": 32}, "forward-send":{"total": 0.74, "avg": 0.74, "max": 0.74, "min": 0.74, "cnt": 1}, "forward-send-backward-recv":{"total": 494.61, "avg": 15.96, "max": 1.37, "min": 71.25, "cnt": 31}, "backward-compute":{"total": 1652.61, "avg": 51.64, "max": 50.12, "min": 53.10, "cnt": 32}, "MoE_L3_bwd":{"total": 388.73, "avg": 12.15, "max": 11.06, "min": 12.84, "cnt": 32}, "MoE_L2_bwd":{"total": 346.28, "avg": 10.82, "max": 10.06, "min": 12.52, "cnt": 32}, "MoE_L1_bwd":{"total": 346.44, "avg": 10.83, "max": 10.49, "min": 11.39, "cnt": 32}, "MoE_L0_bwd":{"total": 358.09, "avg": 11.19, "max": 10.50, "min": 11.84, "cnt": 32}, "backward-send-forward-recv":{"total": 435.88, "avg": 14.53, "max": 1.10, "min": 123.85, "cnt": 30}, "backward-send":{"total": 1.89, "avg": 0.94, "max": 0.90, "min": 0.99, "cnt": 2}, "backward-recv":{"total": 73.08, "avg": 73.08, "max": 73.08, "min": 73.08, "cnt": 1}, "backward-params-all-reduce":{"total": 488.62, "avg": 488.62, "max": 488.62, "min": 488.62, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.05, "avg": 0.05, "max": 0.05, "min": 0.05, "cnt": 1}, "optimizer":{"total": 299.37, "avg": 299.37, "max": 299.37, "min": 299.37, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.41, "avg": 3.41, "max": 3.41, "min": 3.41, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 255.01, "avg": 255.01, "max": 255.01, "min": 255.01, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.80, "avg": 6.80, "max": 6.80, "min": 6.80, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.53, "avg": 3.53, "max": 3.53, "min": 3.53, "cnt": 1}}}
{"type":"time", "iteration": 183, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.15, "avg": 0.15, "max": 0.15, "min": 0.15, "cnt": 1}, "forward-recv":{"total": 129.50, "avg": 64.75, "max": 0.89, "min": 128.61, "cnt": 2}, "forward-compute":{"total": 1896.68, "avg": 59.27, "max": 52.60, "min": 66.99, "cnt": 32}, "fwd-compute":{"total": 1892.93, "avg": 59.15, "max": 52.53, "min": 66.86, "cnt": 32}, "batch-generator":{"total": 43.39, "avg": 1.36, "max": 0.76, "min": 2.84, "cnt": 32}, "fwd-embedding":{"total": 0.62, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1835.62, "avg": 57.36, "max": 51.38, "min": 64.89, "cnt": 32}, "fwd-layernorm":{"total": 10.51, "avg": 0.08, "max": 0.06, "min": 0.33, "cnt": 128}, "fwd-attn":{"total": 113.98, "avg": 0.89, "max": 0.74, "min": 2.61, "cnt": 128}, "fwd-misc":{"total": 21.79, "avg": 0.17, "max": 0.11, "min": 0.43, "cnt": 128}, "fwd-MLP":{"total": 1666.76, "avg": 13.02, "max": 10.37, "min": 23.56, "cnt": 128}, "MoE_L0_fwd":{"total": 539.50, "avg": 16.86, "max": 13.13, "min": 23.48, "cnt": 32}, "MoEMLP":{"total": 1649.04, "avg": 12.88, "max": 10.27, "min": 23.43, "cnt": 128}, "MoE_L1_fwd":{"total": 387.06, "avg": 12.10, "max": 10.90, "min": 17.49, "cnt": 32}, "MoE_L2_fwd":{"total": 371.28, "avg": 11.60, "max": 10.70, "min": 14.27, "cnt": 32}, "MoE_L3_fwd":{"total": 357.61, "avg": 11.18, "max": 10.31, "min": 13.03, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.04, "cnt": 32}, "forward-send":{"total": 1.34, "avg": 1.34, "max": 1.34, "min": 1.34, "cnt": 1}, "forward-send-backward-recv":{"total": 1100.14, "avg": 35.49, "max": 1.04, "min": 617.32, "cnt": 31}, "backward-compute":{"total": 1675.24, "avg": 52.35, "max": 50.32, "min": 54.47, "cnt": 32}, "MoE_L3_bwd":{"total": 393.44, "avg": 12.29, "max": 11.34, "min": 14.12, "cnt": 32}, "MoE_L2_bwd":{"total": 353.94, "avg": 11.06, "max": 9.94, "min": 12.63, "cnt": 32}, "MoE_L1_bwd":{"total": 342.62, "avg": 10.71, "max": 10.28, "min": 11.15, "cnt": 32}, "MoE_L0_bwd":{"total": 366.57, "avg": 11.46, "max": 11.07, "min": 13.85, "cnt": 32}, "backward-send-forward-recv":{"total": 4931.58, "avg": 164.39, "max": 0.95, "min": 1195.61, "cnt": 30}, "backward-send":{"total": 1.89, "avg": 0.94, "max": 0.90, "min": 0.99, "cnt": 2}, "backward-recv":{"total": 72.15, "avg": 72.15, "max": 72.15, "min": 72.15, "cnt": 1}, "backward-params-all-reduce":{"total": 489.05, "avg": 489.05, "max": 489.05, "min": 489.05, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 301.66, "avg": 301.66, "max": 301.66, "min": 301.66, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 257.29, "avg": 257.29, "max": 257.29, "min": 257.29, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.83, "avg": 6.83, "max": 6.83, "min": 6.83, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.52, "avg": 3.52, "max": 3.52, "min": 3.52, "cnt": 1}}}
{"type":"time", "iteration": 184, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 132.69, "avg": 66.35, "max": 4.01, "min": 128.68, "cnt": 2}, "forward-compute":{"total": 1888.07, "avg": 59.00, "max": 53.00, "min": 67.30, "cnt": 32}, "fwd-compute":{"total": 1884.48, "avg": 58.89, "max": 52.93, "min": 67.17, "cnt": 32}, "batch-generator":{"total": 44.85, "avg": 1.40, "max": 0.68, "min": 2.32, "cnt": 32}, "fwd-embedding":{"total": 0.83, "avg": 0.03, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1825.58, "avg": 57.05, "max": 51.95, "min": 65.12, "cnt": 32}, "fwd-layernorm":{"total": 10.84, "avg": 0.08, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 116.71, "avg": 0.91, "max": 0.74, "min": 1.52, "cnt": 128}, "fwd-misc":{"total": 23.04, "avg": 0.18, "max": 0.11, "min": 0.41, "cnt": 128}, "fwd-MLP":{"total": 1652.46, "avg": 12.91, "max": 10.24, "min": 19.27, "cnt": 128}, "MoE_L0_fwd":{"total": 514.87, "avg": 16.09, "max": 12.43, "min": 19.19, "cnt": 32}, "MoEMLP":{"total": 1633.89, "avg": 12.76, "max": 10.14, "min": 19.14, "cnt": 128}, "MoE_L1_fwd":{"total": 391.34, "avg": 12.23, "max": 11.02, "min": 13.33, "cnt": 32}, "MoE_L2_fwd":{"total": 371.98, "avg": 11.62, "max": 10.57, "min": 17.23, "cnt": 32}, "MoE_L3_fwd":{"total": 362.50, "avg": 11.33, "max": 10.18, "min": 17.38, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 0.66, "avg": 0.66, "max": 0.66, "min": 0.66, "cnt": 1}, "forward-send-backward-recv":{"total": 973.66, "avg": 31.41, "max": 0.98, "min": 168.91, "cnt": 31}, "backward-compute":{"total": 1665.32, "avg": 52.04, "max": 50.18, "min": 54.92, "cnt": 32}, "MoE_L3_bwd":{"total": 395.41, "avg": 12.36, "max": 11.45, "min": 16.05, "cnt": 32}, "MoE_L2_bwd":{"total": 345.68, "avg": 10.80, "max": 9.86, "min": 11.35, "cnt": 32}, "MoE_L1_bwd":{"total": 347.40, "avg": 10.86, "max": 10.33, "min": 11.29, "cnt": 32}, "MoE_L0_bwd":{"total": 362.18, "avg": 11.32, "max": 10.59, "min": 11.92, "cnt": 32}, "backward-send-forward-recv":{"total": 546.45, "avg": 18.22, "max": 1.11, "min": 230.39, "cnt": 30}, "backward-send":{"total": 0.86, "avg": 0.43, "max": 0.42, "min": 0.44, "cnt": 2}, "backward-recv":{"total": 76.35, "avg": 76.35, "max": 76.35, "min": 76.35, "cnt": 1}, "backward-params-all-reduce":{"total": 490.27, "avg": 490.27, "max": 490.27, "min": 490.27, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 293.97, "avg": 293.97, "max": 293.97, "min": 293.97, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 253.76, "avg": 253.76, "max": 253.76, "min": 253.76, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.70, "avg": 3.70, "max": 3.70, "min": 3.70, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.48, "avg": 3.48, "max": 3.48, "min": 3.48, "cnt": 1}}}
{"type":"time", "iteration": 185, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 144.17, "avg": 72.09, "max": 9.94, "min": 134.23, "cnt": 2}, "forward-compute":{"total": 1897.38, "avg": 59.29, "max": 53.06, "min": 66.18, "cnt": 32}, "fwd-compute":{"total": 1894.27, "avg": 59.20, "max": 52.99, "min": 66.03, "cnt": 32}, "batch-generator":{"total": 45.18, "avg": 1.41, "max": 0.63, "min": 2.98, "cnt": 32}, "fwd-embedding":{"total": 0.64, "avg": 0.02, "max": 0.01, "min": 0.06, "cnt": 32}, "fwd-encoder":{"total": 1836.36, "avg": 57.39, "max": 51.21, "min": 63.40, "cnt": 32}, "fwd-layernorm":{"total": 9.63, "avg": 0.08, "max": 0.05, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 112.34, "avg": 0.88, "max": 0.74, "min": 2.53, "cnt": 128}, "fwd-misc":{"total": 21.45, "avg": 0.17, "max": 0.11, "min": 0.42, "cnt": 128}, "fwd-MLP":{"total": 1671.83, "avg": 13.06, "max": 10.55, "min": 21.28, "cnt": 128}, "MoE_L0_fwd":{"total": 529.99, "avg": 16.56, "max": 12.17, "min": 21.19, "cnt": 32}, "MoEMLP":{"total": 1654.40, "avg": 12.92, "max": 10.43, "min": 21.13, "cnt": 128}, "MoE_L1_fwd":{"total": 388.91, "avg": 12.15, "max": 11.28, "min": 13.70, "cnt": 32}, "MoE_L2_fwd":{"total": 369.55, "avg": 11.55, "max": 10.58, "min": 14.54, "cnt": 32}, "MoE_L3_fwd":{"total": 372.33, "avg": 11.64, "max": 10.49, "min": 17.12, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-loss-func":{"total": 0.61, "avg": 0.02, "max": 0.02, "min": 0.06, "cnt": 32}, "forward-send":{"total": 0.66, "avg": 0.66, "max": 0.66, "min": 0.66, "cnt": 1}, "forward-send-backward-recv":{"total": 281.99, "avg": 9.10, "max": 0.88, "min": 53.45, "cnt": 31}, "backward-compute":{"total": 1673.31, "avg": 52.29, "max": 50.63, "min": 54.48, "cnt": 32}, "MoE_L3_bwd":{"total": 402.69, "avg": 12.58, "max": 11.16, "min": 15.00, "cnt": 32}, "MoE_L2_bwd":{"total": 346.74, "avg": 10.84, "max": 9.85, "min": 11.54, "cnt": 32}, "MoE_L1_bwd":{"total": 346.92, "avg": 10.84, "max": 10.57, "min": 11.41, "cnt": 32}, "MoE_L0_bwd":{"total": 360.70, "avg": 11.27, "max": 10.79, "min": 12.28, "cnt": 32}, "backward-send-forward-recv":{"total": 1825.03, "avg": 60.83, "max": 1.12, "min": 357.57, "cnt": 30}, "backward-send":{"total": 1.77, "avg": 0.88, "max": 0.72, "min": 1.05, "cnt": 2}, "backward-recv":{"total": 71.17, "avg": 71.17, "max": 71.17, "min": 71.17, "cnt": 1}, "backward-params-all-reduce":{"total": 492.83, "avg": 492.83, "max": 492.83, "min": 492.83, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.04, "avg": 0.04, "max": 0.04, "min": 0.04, "cnt": 1}, "optimizer":{"total": 301.74, "avg": 301.74, "max": 301.74, "min": 301.74, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.40, "avg": 3.40, "max": 3.40, "min": 3.40, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 261.56, "avg": 261.56, "max": 261.56, "min": 261.56, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.54, "avg": 3.54, "max": 3.54, "min": 3.54, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.50, "avg": 3.50, "max": 3.50, "min": 3.50, "cnt": 1}}}
{"type":"time", "iteration": 186, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 129.01, "avg": 64.51, "max": 0.69, "min": 128.32, "cnt": 2}, "forward-compute":{"total": 1892.23, "avg": 59.13, "max": 52.08, "min": 66.24, "cnt": 32}, "fwd-compute":{"total": 1888.78, "avg": 59.02, "max": 52.01, "min": 66.16, "cnt": 32}, "batch-generator":{"total": 39.85, "avg": 1.25, "max": 0.71, "min": 2.41, "cnt": 32}, "fwd-embedding":{"total": 0.67, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1836.10, "avg": 57.38, "max": 50.74, "min": 65.02, "cnt": 32}, "fwd-layernorm":{"total": 9.71, "avg": 0.08, "max": 0.05, "min": 0.22, "cnt": 128}, "fwd-attn":{"total": 107.90, "avg": 0.84, "max": 0.74, "min": 1.90, "cnt": 128}, "fwd-misc":{"total": 20.98, "avg": 0.16, "max": 0.11, "min": 0.43, "cnt": 128}, "fwd-MLP":{"total": 1676.94, "avg": 13.10, "max": 10.50, "min": 23.63, "cnt": 128}, "MoE_L0_fwd":{"total": 547.06, "avg": 17.10, "max": 12.12, "min": 23.51, "cnt": 32}, "MoEMLP":{"total": 1660.37, "avg": 12.97, "max": 10.40, "min": 23.46, "cnt": 128}, "MoE_L1_fwd":{"total": 403.52, "avg": 12.61, "max": 11.30, "min": 16.05, "cnt": 32}, "MoE_L2_fwd":{"total": 358.51, "avg": 11.20, "max": 10.51, "min": 14.97, "cnt": 32}, "MoE_L3_fwd":{"total": 357.46, "avg": 11.17, "max": 10.44, "min": 14.83, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 0.62, "avg": 0.62, "max": 0.62, "min": 0.62, "cnt": 1}, "forward-send-backward-recv":{"total": 992.22, "avg": 32.01, "max": 0.90, "min": 188.84, "cnt": 31}, "backward-compute":{"total": 1684.98, "avg": 52.66, "max": 50.51, "min": 55.89, "cnt": 32}, "MoE_L3_bwd":{"total": 392.66, "avg": 12.27, "max": 11.49, "min": 14.57, "cnt": 32}, "MoE_L2_bwd":{"total": 346.39, "avg": 10.82, "max": 9.53, "min": 11.91, "cnt": 32}, "MoE_L1_bwd":{"total": 352.37, "avg": 11.01, "max": 10.15, "min": 13.46, "cnt": 32}, "MoE_L0_bwd":{"total": 373.62, "avg": 11.68, "max": 10.92, "min": 14.81, "cnt": 32}, "backward-send-forward-recv":{"total": 1960.94, "avg": 65.36, "max": 0.95, "min": 1380.47, "cnt": 30}, "backward-send":{"total": 1.85, "avg": 0.92, "max": 0.79, "min": 1.06, "cnt": 2}, "backward-recv":{"total": 71.97, "avg": 71.97, "max": 71.97, "min": 71.97, "cnt": 1}, "backward-params-all-reduce":{"total": 488.66, "avg": 488.66, "max": 488.66, "min": 488.66, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 300.07, "avg": 300.07, "max": 300.07, "min": 300.07, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 259.90, "avg": 259.90, "max": 259.90, "min": 259.90, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.70, "avg": 3.70, "max": 3.70, "min": 3.70, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 187, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.13, "avg": 0.13, "max": 0.13, "min": 0.13, "cnt": 1}, "forward-recv":{"total": 144.74, "avg": 72.37, "max": 3.85, "min": 140.89, "cnt": 2}, "forward-compute":{"total": 1917.02, "avg": 59.91, "max": 52.76, "min": 64.56, "cnt": 32}, "fwd-compute":{"total": 1913.82, "avg": 59.81, "max": 52.67, "min": 64.42, "cnt": 32}, "batch-generator":{"total": 37.73, "avg": 1.18, "max": 0.72, "min": 1.69, "cnt": 32}, "fwd-embedding":{"total": 0.68, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1863.46, "avg": 58.23, "max": 51.22, "min": 63.27, "cnt": 32}, "fwd-layernorm":{"total": 9.83, "avg": 0.08, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 109.58, "avg": 0.86, "max": 0.74, "min": 1.48, "cnt": 128}, "fwd-misc":{"total": 21.13, "avg": 0.17, "max": 0.11, "min": 0.34, "cnt": 128}, "fwd-MLP":{"total": 1701.94, "avg": 13.30, "max": 10.57, "min": 21.68, "cnt": 128}, "MoE_L0_fwd":{"total": 561.81, "avg": 17.56, "max": 12.75, "min": 21.60, "cnt": 32}, "MoEMLP":{"total": 1684.93, "avg": 13.16, "max": 10.46, "min": 21.53, "cnt": 128}, "MoE_L1_fwd":{"total": 409.63, "avg": 12.80, "max": 11.18, "min": 16.12, "cnt": 32}, "MoE_L2_fwd":{"total": 363.07, "avg": 11.35, "max": 10.51, "min": 12.72, "cnt": 32}, "MoE_L3_fwd":{"total": 356.76, "avg": 11.15, "max": 10.57, "min": 14.32, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 0.75, "avg": 0.75, "max": 0.75, "min": 0.75, "cnt": 1}, "forward-send-backward-recv":{"total": 1326.86, "avg": 42.80, "max": 0.89, "min": 249.94, "cnt": 31}, "backward-compute":{"total": 1667.47, "avg": 52.11, "max": 49.15, "min": 55.05, "cnt": 32}, "MoE_L3_bwd":{"total": 391.48, "avg": 12.23, "max": 10.44, "min": 13.45, "cnt": 32}, "MoE_L2_bwd":{"total": 338.81, "avg": 10.59, "max": 9.94, "min": 12.84, "cnt": 32}, "MoE_L1_bwd":{"total": 350.23, "avg": 10.94, "max": 10.57, "min": 11.31, "cnt": 32}, "MoE_L0_bwd":{"total": 372.21, "avg": 11.63, "max": 10.87, "min": 12.96, "cnt": 32}, "backward-send-forward-recv":{"total": 600.44, "avg": 20.01, "max": 0.96, "min": 228.16, "cnt": 30}, "backward-send":{"total": 1.75, "avg": 0.88, "max": 0.65, "min": 1.10, "cnt": 2}, "backward-recv":{"total": 70.83, "avg": 70.83, "max": 70.83, "min": 70.83, "cnt": 1}, "backward-params-all-reduce":{"total": 490.63, "avg": 490.63, "max": 490.63, "min": 490.63, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 297.33, "avg": 297.33, "max": 297.33, "min": 297.33, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 257.32, "avg": 257.32, "max": 257.32, "min": 257.32, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.26, "avg": 3.26, "max": 3.26, "min": 3.26, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.52, "avg": 3.52, "max": 3.52, "min": 3.52, "cnt": 1}}}
{"type":"time", "iteration": 188, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 129.81, "avg": 64.90, "max": 5.49, "min": 124.32, "cnt": 2}, "forward-compute":{"total": 1893.15, "avg": 59.16, "max": 53.53, "min": 67.64, "cnt": 32}, "fwd-compute":{"total": 1889.85, "avg": 59.06, "max": 53.46, "min": 67.57, "cnt": 32}, "batch-generator":{"total": 40.01, "avg": 1.25, "max": 0.75, "min": 1.75, "cnt": 32}, "fwd-embedding":{"total": 0.69, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1837.27, "avg": 57.41, "max": 52.37, "min": 65.93, "cnt": 32}, "fwd-layernorm":{"total": 10.06, "avg": 0.08, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 110.64, "avg": 0.86, "max": 0.74, "min": 1.50, "cnt": 128}, "fwd-misc":{"total": 21.39, "avg": 0.17, "max": 0.11, "min": 0.34, "cnt": 128}, "fwd-MLP":{"total": 1674.05, "avg": 13.08, "max": 10.35, "min": 24.01, "cnt": 128}, "MoE_L0_fwd":{"total": 536.72, "avg": 16.77, "max": 13.32, "min": 23.91, "cnt": 32}, "MoEMLP":{"total": 1656.78, "avg": 12.94, "max": 10.22, "min": 23.86, "cnt": 128}, "MoE_L1_fwd":{"total": 398.37, "avg": 12.45, "max": 11.48, "min": 14.60, "cnt": 32}, "MoE_L2_fwd":{"total": 367.19, "avg": 11.47, "max": 10.28, "min": 16.33, "cnt": 32}, "MoE_L3_fwd":{"total": 360.88, "avg": 11.28, "max": 10.38, "min": 15.48, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 0.80, "avg": 0.80, "max": 0.80, "min": 0.80, "cnt": 1}, "forward-send-backward-recv":{"total": 1886.89, "avg": 60.87, "max": 0.95, "min": 576.18, "cnt": 31}, "backward-compute":{"total": 1700.37, "avg": 53.14, "max": 50.59, "min": 56.77, "cnt": 32}, "MoE_L3_bwd":{"total": 402.68, "avg": 12.58, "max": 11.17, "min": 15.74, "cnt": 32}, "MoE_L2_bwd":{"total": 352.60, "avg": 11.02, "max": 10.37, "min": 13.44, "cnt": 32}, "MoE_L1_bwd":{"total": 355.43, "avg": 11.11, "max": 10.49, "min": 12.12, "cnt": 32}, "MoE_L0_bwd":{"total": 374.49, "avg": 11.70, "max": 11.12, "min": 13.45, "cnt": 32}, "backward-send-forward-recv":{"total": 777.18, "avg": 25.91, "max": 0.90, "min": 222.86, "cnt": 30}, "backward-send":{"total": 1.60, "avg": 0.80, "max": 0.53, "min": 1.07, "cnt": 2}, "backward-recv":{"total": 77.04, "avg": 77.04, "max": 77.04, "min": 77.04, "cnt": 1}, "backward-params-all-reduce":{"total": 489.33, "avg": 489.33, "max": 489.33, "min": 489.33, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 297.21, "avg": 297.21, "max": 297.21, "min": 297.21, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 257.02, "avg": 257.02, "max": 257.02, "min": 257.02, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.68, "avg": 3.68, "max": 3.68, "min": 3.68, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.53, "avg": 3.53, "max": 3.53, "min": 3.53, "cnt": 1}}}
{"type":"time", "iteration": 189, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 136.62, "avg": 68.31, "max": 7.21, "min": 129.41, "cnt": 2}, "forward-compute":{"total": 1923.38, "avg": 60.11, "max": 52.27, "min": 65.31, "cnt": 32}, "fwd-compute":{"total": 1919.71, "avg": 59.99, "max": 52.19, "min": 65.17, "cnt": 32}, "batch-generator":{"total": 43.23, "avg": 1.35, "max": 0.66, "min": 2.38, "cnt": 32}, "fwd-embedding":{"total": 0.82, "avg": 0.03, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1862.76, "avg": 58.21, "max": 51.08, "min": 63.00, "cnt": 32}, "fwd-layernorm":{"total": 10.81, "avg": 0.08, "max": 0.05, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 115.13, "avg": 0.90, "max": 0.74, "min": 1.88, "cnt": 128}, "fwd-misc":{"total": 22.66, "avg": 0.18, "max": 0.11, "min": 0.40, "cnt": 128}, "fwd-MLP":{"total": 1691.49, "avg": 13.21, "max": 10.51, "min": 20.35, "cnt": 128}, "MoE_L0_fwd":{"total": 538.59, "avg": 16.83, "max": 12.79, "min": 20.27, "cnt": 32}, "MoEMLP":{"total": 1673.23, "avg": 13.07, "max": 10.39, "min": 20.22, "cnt": 128}, "MoE_L1_fwd":{"total": 411.78, "avg": 12.87, "max": 11.45, "min": 16.49, "cnt": 32}, "MoE_L2_fwd":{"total": 367.86, "avg": 11.50, "max": 10.44, "min": 13.56, "cnt": 32}, "MoE_L3_fwd":{"total": 361.76, "avg": 11.31, "max": 10.64, "min": 12.99, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.38, "avg": 1.38, "max": 1.38, "min": 1.38, "cnt": 1}, "forward-send-backward-recv":{"total": 948.74, "avg": 30.60, "max": 2.92, "min": 403.00, "cnt": 31}, "backward-compute":{"total": 1679.45, "avg": 52.48, "max": 50.25, "min": 55.78, "cnt": 32}, "MoE_L3_bwd":{"total": 391.09, "avg": 12.22, "max": 10.66, "min": 13.66, "cnt": 32}, "MoE_L2_bwd":{"total": 346.27, "avg": 10.82, "max": 9.95, "min": 12.79, "cnt": 32}, "MoE_L1_bwd":{"total": 358.56, "avg": 11.20, "max": 10.32, "min": 12.60, "cnt": 32}, "MoE_L0_bwd":{"total": 368.86, "avg": 11.53, "max": 10.85, "min": 13.37, "cnt": 32}, "backward-send-forward-recv":{"total": 192.31, "avg": 6.41, "max": 0.98, "min": 43.25, "cnt": 30}, "backward-send":{"total": 1.86, "avg": 0.93, "max": 0.81, "min": 1.04, "cnt": 2}, "backward-recv":{"total": 71.78, "avg": 71.78, "max": 71.78, "min": 71.78, "cnt": 1}, "backward-params-all-reduce":{"total": 491.78, "avg": 491.78, "max": 491.78, "min": 491.78, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 291.63, "avg": 291.63, "max": 291.63, "min": 291.63, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 251.74, "avg": 251.74, "max": 251.74, "min": 251.74, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 190, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.10, "avg": 0.10, "max": 0.10, "min": 0.10, "cnt": 1}, "forward-recv":{"total": 140.35, "avg": 70.17, "max": 0.92, "min": 139.43, "cnt": 2}, "forward-compute":{"total": 1946.19, "avg": 60.82, "max": 54.02, "min": 68.59, "cnt": 32}, "fwd-compute":{"total": 1942.61, "avg": 60.71, "max": 53.95, "min": 68.45, "cnt": 32}, "batch-generator":{"total": 44.59, "avg": 1.39, "max": 0.67, "min": 2.15, "cnt": 32}, "fwd-embedding":{"total": 0.84, "avg": 0.03, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1883.88, "avg": 58.87, "max": 52.55, "min": 66.03, "cnt": 32}, "fwd-layernorm":{"total": 11.04, "avg": 0.09, "max": 0.05, "min": 0.22, "cnt": 128}, "fwd-attn":{"total": 119.17, "avg": 0.93, "max": 0.74, "min": 1.90, "cnt": 128}, "fwd-misc":{"total": 23.13, "avg": 0.18, "max": 0.11, "min": 0.43, "cnt": 128}, "fwd-MLP":{"total": 1707.07, "avg": 13.34, "max": 10.46, "min": 20.99, "cnt": 128}, "MoE_L0_fwd":{"total": 536.22, "avg": 16.76, "max": 12.47, "min": 20.81, "cnt": 32}, "MoEMLP":{"total": 1688.39, "avg": 13.19, "max": 10.35, "min": 20.73, "cnt": 128}, "MoE_L1_fwd":{"total": 417.86, "avg": 13.06, "max": 12.06, "min": 16.07, "cnt": 32}, "MoE_L2_fwd":{"total": 368.14, "avg": 11.50, "max": 10.40, "min": 14.67, "cnt": 32}, "MoE_L3_fwd":{"total": 373.13, "avg": 11.66, "max": 10.74, "min": 15.11, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 0.84, "avg": 0.84, "max": 0.84, "min": 0.84, "cnt": 1}, "forward-send-backward-recv":{"total": 395.16, "avg": 12.75, "max": 1.00, "min": 98.13, "cnt": 31}, "backward-compute":{"total": 1699.60, "avg": 53.11, "max": 51.45, "min": 57.31, "cnt": 32}, "MoE_L3_bwd":{"total": 401.24, "avg": 12.54, "max": 11.21, "min": 14.19, "cnt": 32}, "MoE_L2_bwd":{"total": 344.07, "avg": 10.75, "max": 10.03, "min": 14.82, "cnt": 32}, "MoE_L1_bwd":{"total": 373.49, "avg": 11.67, "max": 11.09, "min": 12.11, "cnt": 32}, "MoE_L0_bwd":{"total": 364.86, "avg": 11.40, "max": 10.86, "min": 12.33, "cnt": 32}, "backward-send-forward-recv":{"total": 815.07, "avg": 27.17, "max": 1.48, "min": 273.80, "cnt": 30}, "backward-send":{"total": 1.98, "avg": 0.99, "max": 0.89, "min": 1.09, "cnt": 2}, "backward-recv":{"total": 76.38, "avg": 76.38, "max": 76.38, "min": 76.38, "cnt": 1}, "backward-params-all-reduce":{"total": 489.15, "avg": 489.15, "max": 489.15, "min": 489.15, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.04, "avg": 0.04, "max": 0.04, "min": 0.04, "cnt": 1}, "optimizer":{"total": 289.11, "avg": 289.11, "max": 289.11, "min": 289.11, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 249.23, "avg": 249.23, "max": 249.23, "min": 249.23, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.34, "avg": 3.34, "max": 3.34, "min": 3.34, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.49, "avg": 3.49, "max": 3.49, "min": 3.49, "cnt": 1}}}
{"type":"time", "iteration": 191, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.19, "avg": 0.19, "max": 0.19, "min": 0.19, "cnt": 1}, "forward-recv":{"total": 126.08, "avg": 63.04, "max": 0.92, "min": 125.17, "cnt": 2}, "forward-compute":{"total": 1953.06, "avg": 61.03, "max": 55.20, "min": 68.02, "cnt": 32}, "fwd-compute":{"total": 1949.51, "avg": 60.92, "max": 55.13, "min": 67.94, "cnt": 32}, "batch-generator":{"total": 45.02, "avg": 1.41, "max": 0.66, "min": 2.52, "cnt": 32}, "fwd-embedding":{"total": 0.80, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1888.15, "avg": 59.00, "max": 53.24, "min": 65.68, "cnt": 32}, "fwd-layernorm":{"total": 10.86, "avg": 0.08, "max": 0.05, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 117.38, "avg": 0.92, "max": 0.74, "min": 3.04, "cnt": 128}, "fwd-misc":{"total": 22.90, "avg": 0.18, "max": 0.11, "min": 0.48, "cnt": 128}, "fwd-MLP":{"total": 1713.03, "avg": 13.38, "max": 10.45, "min": 22.18, "cnt": 128}, "MoE_L0_fwd":{"total": 528.18, "avg": 16.51, "max": 11.98, "min": 22.10, "cnt": 32}, "MoEMLP":{"total": 1694.17, "avg": 13.24, "max": 10.34, "min": 22.06, "cnt": 128}, "MoE_L1_fwd":{"total": 404.96, "avg": 12.65, "max": 11.77, "min": 14.10, "cnt": 32}, "MoE_L2_fwd":{"total": 374.74, "avg": 11.71, "max": 10.38, "min": 14.61, "cnt": 32}, "MoE_L3_fwd":{"total": 393.07, "avg": 12.28, "max": 11.08, "min": 15.81, "cnt": 32}, "fwd-pooler":{"total": 0.36, "avg": 0.01, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-loss-func":{"total": 0.62, "avg": 0.02, "max": 0.02, "min": 0.06, "cnt": 32}, "forward-send":{"total": 0.90, "avg": 0.90, "max": 0.90, "min": 0.90, "cnt": 1}, "forward-send-backward-recv":{"total": 209.57, "avg": 6.76, "max": 0.93, "min": 69.60, "cnt": 31}, "backward-compute":{"total": 1713.49, "avg": 53.55, "max": 50.90, "min": 55.50, "cnt": 32}, "MoE_L3_bwd":{"total": 414.80, "avg": 12.96, "max": 11.46, "min": 15.11, "cnt": 32}, "MoE_L2_bwd":{"total": 340.94, "avg": 10.65, "max": 9.60, "min": 11.85, "cnt": 32}, "MoE_L1_bwd":{"total": 377.12, "avg": 11.78, "max": 11.00, "min": 13.00, "cnt": 32}, "MoE_L0_bwd":{"total": 365.17, "avg": 11.41, "max": 10.86, "min": 11.78, "cnt": 32}, "backward-send-forward-recv":{"total": 825.64, "avg": 27.52, "max": 1.15, "min": 149.28, "cnt": 30}, "backward-send":{"total": 2.04, "avg": 1.02, "max": 1.00, "min": 1.04, "cnt": 2}, "backward-recv":{"total": 66.32, "avg": 66.32, "max": 66.32, "min": 66.32, "cnt": 1}, "backward-params-all-reduce":{"total": 485.83, "avg": 485.83, "max": 485.83, "min": 485.83, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.05, "avg": 0.05, "max": 0.05, "min": 0.05, "cnt": 1}, "optimizer":{"total": 296.53, "avg": 296.53, "max": 296.53, "min": 296.53, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 256.11, "avg": 256.11, "max": 256.11, "min": 256.11, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.59, "avg": 3.59, "max": 3.59, "min": 3.59, "cnt": 1}}}
{"type":"time", "iteration": 192, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 134.36, "avg": 67.18, "max": 1.36, "min": 133.00, "cnt": 2}, "forward-compute":{"total": 1920.92, "avg": 60.03, "max": 55.02, "min": 64.20, "cnt": 32}, "fwd-compute":{"total": 1917.24, "avg": 59.91, "max": 54.95, "min": 64.13, "cnt": 32}, "batch-generator":{"total": 43.82, "avg": 1.37, "max": 0.73, "min": 1.76, "cnt": 32}, "fwd-embedding":{"total": 0.81, "avg": 0.03, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1859.30, "avg": 58.10, "max": 53.81, "min": 62.38, "cnt": 32}, "fwd-layernorm":{"total": 10.76, "avg": 0.08, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 115.13, "avg": 0.90, "max": 0.74, "min": 1.52, "cnt": 128}, "fwd-misc":{"total": 22.48, "avg": 0.18, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1688.39, "avg": 13.19, "max": 10.63, "min": 20.75, "cnt": 128}, "MoE_L0_fwd":{"total": 532.74, "avg": 16.65, "max": 12.77, "min": 20.65, "cnt": 32}, "MoEMLP":{"total": 1669.65, "avg": 13.04, "max": 10.52, "min": 20.60, "cnt": 128}, "MoE_L1_fwd":{"total": 406.53, "avg": 12.70, "max": 11.90, "min": 13.77, "cnt": 32}, "MoE_L2_fwd":{"total": 360.56, "avg": 11.27, "max": 10.56, "min": 13.04, "cnt": 32}, "MoE_L3_fwd":{"total": 376.56, "avg": 11.77, "max": 11.00, "min": 15.04, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.61, "avg": 0.02, "max": 0.02, "min": 0.05, "cnt": 32}, "forward-send":{"total": 1.04, "avg": 1.04, "max": 1.04, "min": 1.04, "cnt": 1}, "forward-send-backward-recv":{"total": 404.61, "avg": 13.05, "max": 0.85, "min": 111.40, "cnt": 31}, "backward-compute":{"total": 1713.52, "avg": 53.55, "max": 51.57, "min": 57.99, "cnt": 32}, "MoE_L3_bwd":{"total": 414.27, "avg": 12.95, "max": 11.73, "min": 15.87, "cnt": 32}, "MoE_L2_bwd":{"total": 340.76, "avg": 10.65, "max": 9.95, "min": 11.83, "cnt": 32}, "MoE_L1_bwd":{"total": 375.55, "avg": 11.74, "max": 11.03, "min": 13.43, "cnt": 32}, "MoE_L0_bwd":{"total": 367.32, "avg": 11.48, "max": 10.80, "min": 13.48, "cnt": 32}, "backward-send-forward-recv":{"total": 646.76, "avg": 21.56, "max": 1.04, "min": 213.18, "cnt": 30}, "backward-send":{"total": 1.20, "avg": 0.60, "max": 0.44, "min": 0.76, "cnt": 2}, "backward-recv":{"total": 67.78, "avg": 67.78, "max": 67.78, "min": 67.78, "cnt": 1}, "backward-params-all-reduce":{"total": 487.81, "avg": 487.81, "max": 487.81, "min": 487.81, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 293.61, "avg": 293.61, "max": 293.61, "min": 293.61, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 253.81, "avg": 253.81, "max": 253.81, "min": 253.81, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 193, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 136.81, "avg": 68.40, "max": 1.14, "min": 135.67, "cnt": 2}, "forward-compute":{"total": 1936.98, "avg": 60.53, "max": 53.59, "min": 65.78, "cnt": 32}, "fwd-compute":{"total": 1934.03, "avg": 60.44, "max": 53.52, "min": 65.71, "cnt": 32}, "batch-generator":{"total": 39.21, "avg": 1.23, "max": 0.67, "min": 2.27, "cnt": 32}, "fwd-embedding":{"total": 0.56, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1883.11, "avg": 58.85, "max": 52.00, "min": 64.30, "cnt": 32}, "fwd-layernorm":{"total": 9.14, "avg": 0.07, "max": 0.05, "min": 0.18, "cnt": 128}, "fwd-attn":{"total": 107.98, "avg": 0.84, "max": 0.74, "min": 2.31, "cnt": 128}, "fwd-misc":{"total": 19.49, "avg": 0.15, "max": 0.11, "min": 0.34, "cnt": 128}, "fwd-MLP":{"total": 1726.82, "avg": 13.49, "max": 10.76, "min": 23.12, "cnt": 128}, "MoE_L0_fwd":{"total": 547.96, "avg": 17.12, "max": 12.82, "min": 22.99, "cnt": 32}, "MoEMLP":{"total": 1710.77, "avg": 13.37, "max": 10.64, "min": 22.94, "cnt": 128}, "MoE_L1_fwd":{"total": 408.49, "avg": 12.77, "max": 11.87, "min": 13.87, "cnt": 32}, "MoE_L2_fwd":{"total": 377.75, "avg": 11.80, "max": 10.69, "min": 13.29, "cnt": 32}, "MoE_L3_fwd":{"total": 382.51, "avg": 11.95, "max": 11.30, "min": 12.88, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.55, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 0.83, "avg": 0.83, "max": 0.83, "min": 0.83, "cnt": 1}, "forward-send-backward-recv":{"total": 155.00, "avg": 5.00, "max": 0.84, "min": 54.24, "cnt": 31}, "backward-compute":{"total": 1737.64, "avg": 54.30, "max": 52.52, "min": 57.75, "cnt": 32}, "MoE_L3_bwd":{"total": 432.36, "avg": 13.51, "max": 12.04, "min": 14.73, "cnt": 32}, "MoE_L2_bwd":{"total": 346.09, "avg": 10.82, "max": 10.03, "min": 12.90, "cnt": 32}, "MoE_L1_bwd":{"total": 380.57, "avg": 11.89, "max": 11.48, "min": 12.86, "cnt": 32}, "MoE_L0_bwd":{"total": 364.50, "avg": 11.39, "max": 11.08, "min": 11.87, "cnt": 32}, "backward-send-forward-recv":{"total": 3215.72, "avg": 107.19, "max": 0.91, "min": 575.49, "cnt": 30}, "backward-send":{"total": 0.91, "avg": 0.45, "max": 0.45, "min": 0.46, "cnt": 2}, "backward-recv":{"total": 70.79, "avg": 70.79, "max": 70.79, "min": 70.79, "cnt": 1}, "backward-params-all-reduce":{"total": 487.81, "avg": 487.81, "max": 487.81, "min": 487.81, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 299.13, "avg": 299.13, "max": 299.13, "min": 299.13, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 259.24, "avg": 259.24, "max": 259.24, "min": 259.24, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 194, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 133.26, "avg": 66.63, "max": 1.01, "min": 132.25, "cnt": 2}, "forward-compute":{"total": 1960.48, "avg": 61.26, "max": 58.13, "min": 67.00, "cnt": 32}, "fwd-compute":{"total": 1956.85, "avg": 61.15, "max": 58.05, "min": 66.88, "cnt": 32}, "batch-generator":{"total": 44.85, "avg": 1.40, "max": 0.64, "min": 1.85, "cnt": 32}, "fwd-embedding":{"total": 0.87, "avg": 0.03, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1898.13, "avg": 59.32, "max": 55.93, "min": 65.55, "cnt": 32}, "fwd-layernorm":{"total": 10.89, "avg": 0.09, "max": 0.05, "min": 0.18, "cnt": 128}, "fwd-attn":{"total": 115.16, "avg": 0.90, "max": 0.74, "min": 1.52, "cnt": 128}, "fwd-misc":{"total": 22.92, "avg": 0.18, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1726.36, "avg": 13.49, "max": 10.76, "min": 23.08, "cnt": 128}, "MoE_L0_fwd":{"total": 550.54, "avg": 17.20, "max": 14.99, "min": 22.93, "cnt": 32}, "MoEMLP":{"total": 1707.06, "avg": 13.34, "max": 10.65, "min": 22.85, "cnt": 128}, "MoE_L1_fwd":{"total": 419.02, "avg": 13.09, "max": 11.93, "min": 15.77, "cnt": 32}, "MoE_L2_fwd":{"total": 363.82, "avg": 11.37, "max": 10.69, "min": 13.61, "cnt": 32}, "MoE_L3_fwd":{"total": 380.46, "avg": 11.89, "max": 11.04, "min": 16.02, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 0.70, "avg": 0.70, "max": 0.70, "min": 0.70, "cnt": 1}, "forward-send-backward-recv":{"total": 1228.50, "avg": 39.63, "max": 5.32, "min": 283.08, "cnt": 31}, "backward-compute":{"total": 1722.23, "avg": 53.82, "max": 51.10, "min": 57.46, "cnt": 32}, "MoE_L3_bwd":{"total": 422.58, "avg": 13.21, "max": 11.57, "min": 16.48, "cnt": 32}, "MoE_L2_bwd":{"total": 351.69, "avg": 10.99, "max": 10.31, "min": 11.81, "cnt": 32}, "MoE_L1_bwd":{"total": 370.66, "avg": 11.58, "max": 10.98, "min": 12.12, "cnt": 32}, "MoE_L0_bwd":{"total": 364.01, "avg": 11.38, "max": 10.66, "min": 12.93, "cnt": 32}, "backward-send-forward-recv":{"total": 185.17, "avg": 6.17, "max": 0.97, "min": 126.81, "cnt": 30}, "backward-send":{"total": 2.05, "avg": 1.02, "max": 0.95, "min": 1.10, "cnt": 2}, "backward-recv":{"total": 70.95, "avg": 70.95, "max": 70.95, "min": 70.95, "cnt": 1}, "backward-params-all-reduce":{"total": 493.22, "avg": 493.22, "max": 493.22, "min": 493.22, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 291.58, "avg": 291.58, "max": 291.58, "min": 291.58, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 251.76, "avg": 251.76, "max": 251.76, "min": 251.76, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.52, "avg": 3.52, "max": 3.52, "min": 3.52, "cnt": 1}}}
{"type":"time", "iteration": 195, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.15, "avg": 0.15, "max": 0.15, "min": 0.15, "cnt": 1}, "forward-recv":{"total": 130.29, "avg": 65.15, "max": 0.65, "min": 129.64, "cnt": 2}, "forward-compute":{"total": 1918.75, "avg": 59.96, "max": 54.87, "min": 64.75, "cnt": 32}, "fwd-compute":{"total": 1915.22, "avg": 59.85, "max": 54.80, "min": 64.68, "cnt": 32}, "batch-generator":{"total": 45.24, "avg": 1.41, "max": 0.63, "min": 3.68, "cnt": 32}, "fwd-embedding":{"total": 0.80, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1856.56, "avg": 58.02, "max": 53.72, "min": 63.74, "cnt": 32}, "fwd-layernorm":{"total": 11.16, "avg": 0.09, "max": 0.05, "min": 0.31, "cnt": 128}, "fwd-attn":{"total": 119.24, "avg": 0.93, "max": 0.74, "min": 2.50, "cnt": 128}, "fwd-misc":{"total": 23.71, "avg": 0.19, "max": 0.11, "min": 0.47, "cnt": 128}, "fwd-MLP":{"total": 1679.10, "avg": 13.12, "max": 10.56, "min": 19.47, "cnt": 128}, "MoE_L0_fwd":{"total": 528.96, "avg": 16.53, "max": 13.41, "min": 19.35, "cnt": 32}, "MoEMLP":{"total": 1660.30, "avg": 12.97, "max": 10.44, "min": 19.29, "cnt": 128}, "MoE_L1_fwd":{"total": 402.25, "avg": 12.57, "max": 11.59, "min": 13.89, "cnt": 32}, "MoE_L2_fwd":{"total": 368.39, "avg": 11.51, "max": 10.49, "min": 17.38, "cnt": 32}, "MoE_L3_fwd":{"total": 367.57, "avg": 11.49, "max": 11.02, "min": 14.33, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.56, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 0.72, "avg": 0.72, "max": 0.72, "min": 0.72, "cnt": 1}, "forward-send-backward-recv":{"total": 1178.03, "avg": 38.00, "max": 1.50, "min": 444.63, "cnt": 31}, "backward-compute":{"total": 1704.79, "avg": 53.27, "max": 52.14, "min": 57.55, "cnt": 32}, "MoE_L3_bwd":{"total": 407.22, "avg": 12.73, "max": 12.07, "min": 15.15, "cnt": 32}, "MoE_L2_bwd":{"total": 342.37, "avg": 10.70, "max": 10.10, "min": 12.24, "cnt": 32}, "MoE_L1_bwd":{"total": 372.47, "avg": 11.64, "max": 11.27, "min": 12.71, "cnt": 32}, "MoE_L0_bwd":{"total": 367.30, "avg": 11.48, "max": 10.85, "min": 16.09, "cnt": 32}, "backward-send-forward-recv":{"total": 697.52, "avg": 23.25, "max": 1.11, "min": 199.92, "cnt": 30}, "backward-send":{"total": 1.48, "avg": 0.74, "max": 0.56, "min": 0.92, "cnt": 2}, "backward-recv":{"total": 71.09, "avg": 71.09, "max": 71.09, "min": 71.09, "cnt": 1}, "backward-params-all-reduce":{"total": 486.49, "avg": 486.49, "max": 486.49, "min": 486.49, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.04, "avg": 0.04, "max": 0.04, "min": 0.04, "cnt": 1}, "optimizer":{"total": 297.05, "avg": 297.05, "max": 297.05, "min": 297.05, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 256.44, "avg": 256.44, "max": 256.44, "min": 256.44, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.82, "avg": 3.82, "max": 3.82, "min": 3.82, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 196, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.06, "avg": 0.06, "max": 0.06, "min": 0.06, "cnt": 1}, "forward-recv":{"total": 138.32, "avg": 69.16, "max": 0.96, "min": 137.36, "cnt": 2}, "forward-compute":{"total": 1952.44, "avg": 61.01, "max": 53.60, "min": 69.29, "cnt": 32}, "fwd-compute":{"total": 1949.11, "avg": 60.91, "max": 53.53, "min": 69.16, "cnt": 32}, "batch-generator":{"total": 40.37, "avg": 1.26, "max": 0.73, "min": 2.54, "cnt": 32}, "fwd-embedding":{"total": 0.73, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1896.02, "avg": 59.25, "max": 52.43, "min": 67.13, "cnt": 32}, "fwd-layernorm":{"total": 10.24, "avg": 0.08, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 110.50, "avg": 0.86, "max": 0.74, "min": 1.49, "cnt": 128}, "fwd-misc":{"total": 21.63, "avg": 0.17, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1732.54, "avg": 13.54, "max": 10.73, "min": 23.21, "cnt": 128}, "MoE_L0_fwd":{"total": 538.67, "avg": 16.83, "max": 12.31, "min": 23.13, "cnt": 32}, "MoEMLP":{"total": 1715.35, "avg": 13.40, "max": 10.63, "min": 23.08, "cnt": 128}, "MoE_L1_fwd":{"total": 420.93, "avg": 13.15, "max": 11.83, "min": 16.88, "cnt": 32}, "MoE_L2_fwd":{"total": 382.80, "avg": 11.96, "max": 10.66, "min": 15.52, "cnt": 32}, "MoE_L3_fwd":{"total": 379.43, "avg": 11.86, "max": 11.14, "min": 15.07, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.14, "avg": 1.14, "max": 1.14, "min": 1.14, "cnt": 1}, "forward-send-backward-recv":{"total": 366.09, "avg": 11.81, "max": 0.90, "min": 65.16, "cnt": 31}, "backward-compute":{"total": 1718.99, "avg": 53.72, "max": 52.53, "min": 57.24, "cnt": 32}, "MoE_L3_bwd":{"total": 418.29, "avg": 13.07, "max": 12.34, "min": 14.08, "cnt": 32}, "MoE_L2_bwd":{"total": 344.64, "avg": 10.77, "max": 10.07, "min": 12.01, "cnt": 32}, "MoE_L1_bwd":{"total": 373.53, "avg": 11.67, "max": 11.05, "min": 12.44, "cnt": 32}, "MoE_L0_bwd":{"total": 366.59, "avg": 11.46, "max": 10.92, "min": 13.03, "cnt": 32}, "backward-send-forward-recv":{"total": 462.39, "avg": 15.41, "max": 0.95, "min": 198.47, "cnt": 30}, "backward-send":{"total": 1.23, "avg": 0.62, "max": 0.46, "min": 0.77, "cnt": 2}, "backward-recv":{"total": 86.22, "avg": 86.22, "max": 86.22, "min": 86.22, "cnt": 1}, "backward-params-all-reduce":{"total": 487.12, "avg": 487.12, "max": 487.12, "min": 487.12, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 295.89, "avg": 295.89, "max": 295.89, "min": 295.89, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.40, "avg": 3.40, "max": 3.40, "min": 3.40, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 256.12, "avg": 256.12, "max": 256.12, "min": 256.12, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.34, "avg": 3.34, "max": 3.34, "min": 3.34, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.49, "avg": 3.49, "max": 3.49, "min": 3.49, "cnt": 1}}}
{"type":"time", "iteration": 197, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 142.77, "avg": 71.39, "max": 0.68, "min": 142.09, "cnt": 2}, "forward-compute":{"total": 1954.48, "avg": 61.08, "max": 54.93, "min": 66.01, "cnt": 32}, "fwd-compute":{"total": 1950.90, "avg": 60.97, "max": 54.87, "min": 65.88, "cnt": 32}, "batch-generator":{"total": 42.64, "avg": 1.33, "max": 0.64, "min": 2.54, "cnt": 32}, "fwd-embedding":{"total": 0.78, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1894.93, "avg": 59.22, "max": 53.38, "min": 63.85, "cnt": 32}, "fwd-layernorm":{"total": 10.72, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 115.44, "avg": 0.90, "max": 0.74, "min": 1.49, "cnt": 128}, "fwd-misc":{"total": 23.11, "avg": 0.18, "max": 0.11, "min": 0.70, "cnt": 128}, "fwd-MLP":{"total": 1723.28, "avg": 13.46, "max": 10.54, "min": 20.37, "cnt": 128}, "MoE_L0_fwd":{"total": 544.55, "avg": 17.02, "max": 12.89, "min": 20.28, "cnt": 32}, "MoEMLP":{"total": 1705.18, "avg": 13.32, "max": 10.43, "min": 20.23, "cnt": 128}, "MoE_L1_fwd":{"total": 425.07, "avg": 13.28, "max": 11.90, "min": 17.53, "cnt": 32}, "MoE_L2_fwd":{"total": 363.29, "avg": 11.35, "max": 10.47, "min": 13.28, "cnt": 32}, "MoE_L3_fwd":{"total": 379.04, "avg": 11.85, "max": 10.95, "min": 17.82, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.62, "avg": 0.02, "max": 0.02, "min": 0.04, "cnt": 32}, "forward-send":{"total": 0.64, "avg": 0.64, "max": 0.64, "min": 0.64, "cnt": 1}, "forward-send-backward-recv":{"total": 570.94, "avg": 18.42, "max": 1.34, "min": 122.73, "cnt": 31}, "backward-compute":{"total": 1696.77, "avg": 53.02, "max": 51.67, "min": 57.55, "cnt": 32}, "MoE_L3_bwd":{"total": 409.18, "avg": 12.79, "max": 12.24, "min": 13.74, "cnt": 32}, "MoE_L2_bwd":{"total": 338.67, "avg": 10.58, "max": 9.60, "min": 13.35, "cnt": 32}, "MoE_L1_bwd":{"total": 371.94, "avg": 11.62, "max": 11.23, "min": 12.29, "cnt": 32}, "MoE_L0_bwd":{"total": 361.02, "avg": 11.28, "max": 10.99, "min": 12.70, "cnt": 32}, "backward-send-forward-recv":{"total": 148.59, "avg": 4.95, "max": 1.00, "min": 52.56, "cnt": 30}, "backward-send":{"total": 1.96, "avg": 0.98, "max": 0.95, "min": 1.01, "cnt": 2}, "backward-recv":{"total": 70.73, "avg": 70.73, "max": 70.73, "min": 70.73, "cnt": 1}, "backward-params-all-reduce":{"total": 487.37, "avg": 487.37, "max": 487.37, "min": 487.37, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 322.67, "avg": 322.67, "max": 322.67, "min": 322.67, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.40, "avg": 3.40, "max": 3.40, "min": 3.40, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 278.37, "avg": 278.37, "max": 278.37, "min": 278.37, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.98, "avg": 6.98, "max": 6.98, "min": 6.98, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.48, "avg": 3.48, "max": 3.48, "min": 3.48, "cnt": 1}}}
{"type":"time", "iteration": 198, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.11, "avg": 0.11, "max": 0.11, "min": 0.11, "cnt": 1}, "forward-recv":{"total": 137.43, "avg": 68.71, "max": 0.92, "min": 136.51, "cnt": 2}, "forward-compute":{"total": 1963.21, "avg": 61.35, "max": 52.97, "min": 67.38, "cnt": 32}, "fwd-compute":{"total": 1959.54, "avg": 61.24, "max": 52.89, "min": 67.30, "cnt": 32}, "batch-generator":{"total": 45.07, "avg": 1.41, "max": 0.68, "min": 2.82, "cnt": 32}, "fwd-embedding":{"total": 0.79, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1900.95, "avg": 59.40, "max": 51.65, "min": 66.09, "cnt": 32}, "fwd-layernorm":{"total": 10.80, "avg": 0.08, "max": 0.06, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 113.50, "avg": 0.89, "max": 0.74, "min": 1.50, "cnt": 128}, "fwd-misc":{"total": 22.97, "avg": 0.18, "max": 0.11, "min": 0.38, "cnt": 128}, "fwd-MLP":{"total": 1731.61, "avg": 13.53, "max": 10.78, "min": 22.08, "cnt": 128}, "MoE_L0_fwd":{"total": 536.99, "avg": 16.78, "max": 12.31, "min": 22.00, "cnt": 32}, "MoEMLP":{"total": 1713.54, "avg": 13.39, "max": 10.66, "min": 21.95, "cnt": 128}, "MoE_L1_fwd":{"total": 417.35, "avg": 13.04, "max": 11.93, "min": 15.45, "cnt": 32}, "MoE_L2_fwd":{"total": 375.83, "avg": 11.74, "max": 10.70, "min": 14.28, "cnt": 32}, "MoE_L3_fwd":{"total": 390.04, "avg": 12.19, "max": 11.00, "min": 17.89, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 0.99, "avg": 0.99, "max": 0.99, "min": 0.99, "cnt": 1}, "forward-send-backward-recv":{"total": 1083.48, "avg": 34.95, "max": 1.17, "min": 191.96, "cnt": 31}, "backward-compute":{"total": 1747.20, "avg": 54.60, "max": 51.24, "min": 57.23, "cnt": 32}, "MoE_L3_bwd":{"total": 425.23, "avg": 13.29, "max": 11.62, "min": 16.05, "cnt": 32}, "MoE_L2_bwd":{"total": 351.39, "avg": 10.98, "max": 10.05, "min": 11.91, "cnt": 32}, "MoE_L1_bwd":{"total": 379.78, "avg": 11.87, "max": 11.20, "min": 13.22, "cnt": 32}, "MoE_L0_bwd":{"total": 372.20, "avg": 11.63, "max": 10.90, "min": 14.12, "cnt": 32}, "backward-send-forward-recv":{"total": 578.58, "avg": 19.29, "max": 1.02, "min": 148.75, "cnt": 30}, "backward-send":{"total": 1.02, "avg": 0.51, "max": 0.45, "min": 0.57, "cnt": 2}, "backward-recv":{"total": 70.28, "avg": 70.28, "max": 70.28, "min": 70.28, "cnt": 1}, "backward-params-all-reduce":{"total": 489.56, "avg": 489.56, "max": 489.56, "min": 489.56, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.06, "avg": 0.06, "max": 0.06, "min": 0.06, "cnt": 1}, "optimizer":{"total": 295.89, "avg": 295.89, "max": 295.89, "min": 295.89, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 255.78, "avg": 255.78, "max": 255.78, "min": 255.78, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.30, "avg": 3.30, "max": 3.30, "min": 3.30, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.51, "avg": 3.51, "max": 3.51, "min": 3.51, "cnt": 1}}}
{"type":"time", "iteration": 199, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.16, "avg": 0.16, "max": 0.16, "min": 0.16, "cnt": 1}, "forward-recv":{"total": 127.20, "avg": 63.60, "max": 2.08, "min": 125.12, "cnt": 2}, "forward-compute":{"total": 1922.71, "avg": 60.08, "max": 53.01, "min": 68.22, "cnt": 32}, "fwd-compute":{"total": 1919.14, "avg": 59.97, "max": 52.92, "min": 68.11, "cnt": 32}, "batch-generator":{"total": 41.80, "avg": 1.31, "max": 0.73, "min": 3.04, "cnt": 32}, "fwd-embedding":{"total": 0.70, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1864.43, "avg": 58.26, "max": 51.39, "min": 66.17, "cnt": 32}, "fwd-layernorm":{"total": 10.64, "avg": 0.08, "max": 0.05, "min": 0.27, "cnt": 128}, "fwd-attn":{"total": 113.09, "avg": 0.88, "max": 0.74, "min": 2.01, "cnt": 128}, "fwd-misc":{"total": 22.47, "avg": 0.18, "max": 0.11, "min": 0.43, "cnt": 128}, "fwd-MLP":{"total": 1695.64, "avg": 13.25, "max": 10.77, "min": 20.62, "cnt": 128}, "MoE_L0_fwd":{"total": 527.10, "avg": 16.47, "max": 12.49, "min": 20.50, "cnt": 32}, "MoEMLP":{"total": 1677.34, "avg": 13.10, "max": 10.66, "min": 20.45, "cnt": 128}, "MoE_L1_fwd":{"total": 412.45, "avg": 12.89, "max": 11.62, "min": 14.39, "cnt": 32}, "MoE_L2_fwd":{"total": 365.02, "avg": 11.41, "max": 10.70, "min": 13.01, "cnt": 32}, "MoE_L3_fwd":{"total": 379.33, "avg": 11.85, "max": 10.89, "min": 16.10, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 0.72, "avg": 0.72, "max": 0.72, "min": 0.72, "cnt": 1}, "forward-send-backward-recv":{"total": 834.08, "avg": 26.91, "max": 0.91, "min": 201.03, "cnt": 31}, "backward-compute":{"total": 1737.68, "avg": 54.30, "max": 52.74, "min": 57.95, "cnt": 32}, "MoE_L3_bwd":{"total": 427.48, "avg": 13.36, "max": 11.95, "min": 17.83, "cnt": 32}, "MoE_L2_bwd":{"total": 360.32, "avg": 11.26, "max": 9.87, "min": 13.22, "cnt": 32}, "MoE_L1_bwd":{"total": 374.41, "avg": 11.70, "max": 11.30, "min": 12.69, "cnt": 32}, "MoE_L0_bwd":{"total": 363.93, "avg": 11.37, "max": 10.82, "min": 11.68, "cnt": 32}, "backward-send-forward-recv":{"total": 1521.70, "avg": 50.72, "max": 0.95, "min": 599.84, "cnt": 30}, "backward-send":{"total": 2.17, "avg": 1.08, "max": 1.04, "min": 1.13, "cnt": 2}, "backward-recv":{"total": 73.32, "avg": 73.32, "max": 73.32, "min": 73.32, "cnt": 1}, "backward-params-all-reduce":{"total": 488.97, "avg": 488.97, "max": 488.97, "min": 488.97, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 297.05, "avg": 297.05, "max": 297.05, "min": 297.05, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 256.60, "avg": 256.60, "max": 256.60, "min": 256.60, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.64, "avg": 3.64, "max": 3.64, "min": 3.64, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.59, "avg": 3.59, "max": 3.59, "min": 3.59, "cnt": 1}}}
{"type":"time", "iteration": 200, "rank": 47, "tp_rank": 0, "pp_rank": 2, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 135.75, "avg": 67.87, "max": 8.54, "min": 127.21, "cnt": 2}, "forward-compute":{"total": 1901.31, "avg": 59.42, "max": 52.74, "min": 68.74, "cnt": 32}, "fwd-compute":{"total": 1897.80, "avg": 59.31, "max": 52.67, "min": 68.55, "cnt": 32}, "batch-generator":{"total": 45.67, "avg": 1.43, "max": 0.71, "min": 3.36, "cnt": 32}, "fwd-embedding":{"total": 0.67, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1838.57, "avg": 57.46, "max": 51.54, "min": 65.83, "cnt": 32}, "fwd-layernorm":{"total": 10.38, "avg": 0.08, "max": 0.05, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 113.77, "avg": 0.89, "max": 0.75, "min": 1.66, "cnt": 128}, "fwd-misc":{"total": 22.94, "avg": 0.18, "max": 0.11, "min": 1.38, "cnt": 128}, "fwd-MLP":{"total": 1669.21, "avg": 13.04, "max": 10.60, "min": 23.39, "cnt": 128}, "MoE_L0_fwd":{"total": 517.01, "avg": 16.16, "max": 12.44, "min": 23.26, "cnt": 32}, "MoEMLP":{"total": 1651.19, "avg": 12.90, "max": 10.48, "min": 23.18, "cnt": 128}, "MoE_L1_fwd":{"total": 394.21, "avg": 12.32, "max": 11.43, "min": 13.48, "cnt": 32}, "MoE_L2_fwd":{"total": 373.48, "avg": 11.67, "max": 10.53, "min": 14.10, "cnt": 32}, "MoE_L3_fwd":{"total": 373.03, "avg": 11.66, "max": 10.88, "min": 15.29, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 0.69, "avg": 0.69, "max": 0.69, "min": 0.69, "cnt": 1}, "forward-send-backward-recv":{"total": 408.41, "avg": 13.17, "max": 0.84, "min": 133.02, "cnt": 31}, "backward-compute":{"total": 1737.75, "avg": 54.30, "max": 52.26, "min": 59.29, "cnt": 32}, "MoE_L3_bwd":{"total": 421.19, "avg": 13.16, "max": 11.94, "min": 15.49, "cnt": 32}, "MoE_L2_bwd":{"total": 354.52, "avg": 11.08, "max": 10.03, "min": 13.67, "cnt": 32}, "MoE_L1_bwd":{"total": 371.03, "avg": 11.59, "max": 11.18, "min": 12.00, "cnt": 32}, "MoE_L0_bwd":{"total": 377.22, "avg": 11.79, "max": 11.12, "min": 16.99, "cnt": 32}, "backward-send-forward-recv":{"total": 2559.03, "avg": 85.30, "max": 1.05, "min": 517.66, "cnt": 30}, "backward-send":{"total": 1.71, "avg": 0.85, "max": 0.80, "min": 0.91, "cnt": 2}, "backward-recv":{"total": 67.98, "avg": 67.98, "max": 67.98, "min": 67.98, "cnt": 1}, "backward-params-all-reduce":{"total": 493.20, "avg": 493.20, "max": 493.20, "min": 493.20, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 300.92, "avg": 300.92, "max": 300.92, "min": 300.92, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.40, "avg": 3.40, "max": 3.40, "min": 3.40, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 261.02, "avg": 261.02, "max": 261.02, "min": 261.02, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.26, "avg": 3.26, "max": 3.26, "min": 3.26, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.51, "avg": 3.51, "max": 3.51, "min": 3.51, "cnt": 1}}}
