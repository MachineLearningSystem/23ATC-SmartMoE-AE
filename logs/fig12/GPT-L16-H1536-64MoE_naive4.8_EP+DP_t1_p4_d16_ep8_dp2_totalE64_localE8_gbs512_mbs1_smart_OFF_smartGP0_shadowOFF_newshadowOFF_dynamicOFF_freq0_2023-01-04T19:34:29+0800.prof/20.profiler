{"type":"time", "iteration": -1, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 7192.69, "avg": 7192.69, "max": 7192.69, "min": 7192.69, "cnt": 1}, "train/valid/test-data-iterators-setup":{"total": 14762.88, "avg": 14762.88, "max": 14762.88, "min": 14762.88, "cnt": 1}}}
{"type":"time", "iteration": 1, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.77, "avg": 0.77, "max": 0.77, "min": 0.77, "cnt": 1}, "forward-recv":{"total": 4613.89, "avg": 1537.96, "max": 0.89, "min": 4609.99, "cnt": 3}, "forward-compute":{"total": 3982.05, "avg": 124.44, "max": 53.67, "min": 1519.35, "cnt": 32}, "fwd-compute":{"total": 3978.20, "avg": 124.32, "max": 53.59, "min": 1519.17, "cnt": 32}, "batch-generator":{"total": 62.61, "avg": 1.96, "max": 0.84, "min": 6.37, "cnt": 32}, "fwd-embedding":{"total": 0.61, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 3900.95, "avg": 121.90, "max": 50.69, "min": 1511.44, "cnt": 32}, "fwd-layernorm":{"total": 10.51, "avg": 0.08, "max": 0.05, "min": 0.28, "cnt": 128}, "fwd-attn":{"total": 630.23, "avg": 4.92, "max": 0.74, "min": 467.10, "cnt": 128}, "fwd-misc":{"total": 533.11, "avg": 4.16, "max": 0.11, "min": 511.29, "cnt": 128}, "fwd-MLP":{"total": 2701.35, "avg": 21.10, "max": 10.80, "min": 465.15, "cnt": 128}, "MoE_L0_fwd":{"total": 1491.66, "avg": 46.61, "max": 11.26, "min": 464.98, "cnt": 32}, "MoEMLP":{"total": 2683.46, "avg": 20.96, "max": 10.70, "min": 464.89, "cnt": 128}, "MoE_L1_fwd":{"total": 419.57, "avg": 13.11, "max": 11.16, "min": 17.65, "cnt": 32}, "MoE_L2_fwd":{"total": 398.34, "avg": 12.45, "max": 10.83, "min": 17.28, "cnt": 32}, "MoE_L3_fwd":{"total": 380.32, "avg": 11.88, "max": 10.74, "min": 16.71, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.04, "cnt": 32}, "forward-send":{"total": 1792.49, "avg": 896.25, "max": 86.73, "min": 1705.76, "cnt": 2}, "forward-send-backward-recv":{"total": 3091.45, "avg": 103.05, "max": 1.44, "min": 2111.30, "cnt": 30}, "backward-compute":{"total": 1978.88, "avg": 61.84, "max": 46.71, "min": 446.64, "cnt": 32}, "MoE_L3_bwd":{"total": 455.68, "avg": 14.24, "max": 11.53, "min": 48.70, "cnt": 32}, "MoE_L2_bwd":{"total": 343.12, "avg": 10.72, "max": 9.51, "min": 14.65, "cnt": 32}, "MoE_L1_bwd":{"total": 297.43, "avg": 9.29, "max": 8.64, "min": 11.34, "cnt": 32}, "MoE_L0_bwd":{"total": 291.95, "avg": 9.12, "max": 8.68, "min": 11.57, "cnt": 32}, "backward-send-forward-recv":{"total": 8572.84, "avg": 295.62, "max": 1.83, "min": 1224.39, "cnt": 29}, "backward-send":{"total": 2.72, "avg": 0.91, "max": 0.72, "min": 1.15, "cnt": 3}, "backward-recv":{"total": 689.15, "avg": 344.58, "max": 67.36, "min": 621.79, "cnt": 2}, "backward-params-all-reduce":{"total": 833.48, "avg": 833.48, "max": 833.48, "min": 833.48, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.04, "avg": 0.04, "max": 0.04, "min": 0.04, "cnt": 1}, "optimizer":{"total": 602.56, "avg": 602.56, "max": 602.56, "min": 602.56, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.41, "avg": 3.41, "max": 3.41, "min": 3.41, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 302.06, "avg": 302.06, "max": 302.06, "min": 302.06, "cnt": 1}, "optimizer-clip-main-grad":{"total": 68.63, "avg": 68.63, "max": 68.63, "min": 68.63, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.78, "avg": 3.78, "max": 3.78, "min": 3.78, "cnt": 1}}}
{"type":"time", "iteration": 2, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.12, "avg": 0.12, "max": 0.12, "min": 0.12, "cnt": 1}, "forward-recv":{"total": 70.03, "avg": 23.34, "max": 0.89, "min": 66.64, "cnt": 3}, "forward-compute":{"total": 2454.73, "avg": 76.71, "max": 52.61, "min": 163.55, "cnt": 32}, "fwd-compute":{"total": 2451.54, "avg": 76.61, "max": 52.53, "min": 163.47, "cnt": 32}, "batch-generator":{"total": 242.07, "avg": 7.56, "max": 0.66, "min": 92.92, "cnt": 32}, "fwd-embedding":{"total": 0.64, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 2197.11, "avg": 68.66, "max": 51.25, "min": 162.03, "cnt": 32}, "fwd-layernorm":{"total": 10.21, "avg": 0.08, "max": 0.05, "min": 0.24, "cnt": 128}, "fwd-attn":{"total": 109.71, "avg": 0.86, "max": 0.74, "min": 1.99, "cnt": 128}, "fwd-misc":{"total": 21.16, "avg": 0.17, "max": 0.11, "min": 0.38, "cnt": 128}, "fwd-MLP":{"total": 2034.93, "avg": 15.90, "max": 9.98, "min": 121.86, "cnt": 128}, "MoE_L0_fwd":{"total": 905.44, "avg": 28.29, "max": 12.66, "min": 121.77, "cnt": 32}, "MoEMLP":{"total": 2017.94, "avg": 15.77, "max": 9.86, "min": 121.72, "cnt": 128}, "MoE_L1_fwd":{"total": 372.88, "avg": 11.65, "max": 10.57, "min": 13.05, "cnt": 32}, "MoE_L2_fwd":{"total": 342.25, "avg": 10.70, "max": 9.91, "min": 16.23, "cnt": 32}, "MoE_L3_fwd":{"total": 403.56, "avg": 12.61, "max": 11.27, "min": 22.41, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.50, "avg": 0.75, "max": 0.67, "min": 0.83, "cnt": 2}, "forward-send-backward-recv":{"total": 1191.38, "avg": 39.71, "max": 1.37, "min": 209.23, "cnt": 30}, "backward-compute":{"total": 1746.51, "avg": 54.58, "max": 49.31, "min": 58.92, "cnt": 32}, "MoE_L3_bwd":{"total": 445.04, "avg": 13.91, "max": 11.72, "min": 18.06, "cnt": 32}, "MoE_L2_bwd":{"total": 354.00, "avg": 11.06, "max": 10.04, "min": 14.15, "cnt": 32}, "MoE_L1_bwd":{"total": 362.01, "avg": 11.31, "max": 10.35, "min": 13.26, "cnt": 32}, "MoE_L0_bwd":{"total": 372.49, "avg": 11.64, "max": 10.80, "min": 13.29, "cnt": 32}, "backward-send-forward-recv":{"total": 9795.76, "avg": 337.78, "max": 1.40, "min": 1132.54, "cnt": 29}, "backward-send":{"total": 3.24, "avg": 1.08, "max": 0.92, "min": 1.40, "cnt": 3}, "backward-recv":{"total": 815.78, "avg": 407.89, "max": 60.62, "min": 755.17, "cnt": 2}, "backward-params-all-reduce":{"total": 499.08, "avg": 499.08, "max": 499.08, "min": 499.08, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 253.52, "avg": 253.52, "max": 253.52, "min": 253.52, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.40, "avg": 3.40, "max": 3.40, "min": 3.40, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 208.18, "avg": 208.18, "max": 208.18, "min": 208.18, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.84, "avg": 6.84, "max": 6.84, "min": 6.84, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 4.00, "avg": 4.00, "max": 4.00, "min": 4.00, "cnt": 1}}}
{"type":"time", "iteration": 3, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 78.32, "avg": 26.11, "max": 3.98, "min": 64.78, "cnt": 3}, "forward-compute":{"total": 2921.56, "avg": 91.30, "max": 52.49, "min": 460.58, "cnt": 32}, "fwd-compute":{"total": 2918.60, "avg": 91.21, "max": 52.42, "min": 460.42, "cnt": 32}, "batch-generator":{"total": 74.05, "avg": 2.31, "max": 0.64, "min": 26.77, "cnt": 32}, "fwd-embedding":{"total": 0.52, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 2832.80, "avg": 88.52, "max": 51.48, "min": 458.40, "cnt": 32}, "fwd-layernorm":{"total": 8.96, "avg": 0.07, "max": 0.05, "min": 0.17, "cnt": 128}, "fwd-attn":{"total": 103.69, "avg": 0.81, "max": 0.74, "min": 1.44, "cnt": 128}, "fwd-misc":{"total": 19.56, "avg": 0.15, "max": 0.11, "min": 0.34, "cnt": 128}, "fwd-MLP":{"total": 2680.93, "avg": 20.94, "max": 11.17, "min": 417.07, "cnt": 128}, "MoE_L0_fwd":{"total": 1482.15, "avg": 46.32, "max": 11.46, "min": 416.94, "cnt": 32}, "MoEMLP":{"total": 2664.78, "avg": 20.82, "max": 11.05, "min": 416.90, "cnt": 128}, "MoE_L1_fwd":{"total": 421.59, "avg": 13.17, "max": 12.10, "min": 16.10, "cnt": 32}, "MoE_L2_fwd":{"total": 369.90, "avg": 11.56, "max": 11.10, "min": 12.73, "cnt": 32}, "MoE_L3_fwd":{"total": 397.03, "avg": 12.41, "max": 11.57, "min": 15.65, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.85, "avg": 0.93, "max": 0.91, "min": 0.94, "cnt": 2}, "forward-send-backward-recv":{"total": 183.01, "avg": 6.10, "max": 1.72, "min": 116.90, "cnt": 30}, "backward-compute":{"total": 1907.32, "avg": 59.60, "max": 56.13, "min": 62.12, "cnt": 32}, "MoE_L3_bwd":{"total": 439.78, "avg": 13.74, "max": 12.79, "min": 15.04, "cnt": 32}, "MoE_L2_bwd":{"total": 416.46, "avg": 13.01, "max": 11.50, "min": 14.59, "cnt": 32}, "MoE_L1_bwd":{"total": 461.78, "avg": 14.43, "max": 13.80, "min": 16.23, "cnt": 32}, "MoE_L0_bwd":{"total": 375.17, "avg": 11.72, "max": 10.84, "min": 12.94, "cnt": 32}, "backward-send-forward-recv":{"total": 8843.55, "avg": 304.95, "max": 1.31, "min": 938.78, "cnt": 29}, "backward-send":{"total": 2.52, "avg": 0.84, "max": 0.70, "min": 0.96, "cnt": 3}, "backward-recv":{"total": 198.75, "avg": 99.37, "max": 74.01, "min": 124.74, "cnt": 2}, "backward-params-all-reduce":{"total": 488.03, "avg": 488.03, "max": 488.03, "min": 488.03, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 262.60, "avg": 262.60, "max": 262.60, "min": 262.60, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 218.31, "avg": 218.31, "max": 218.31, "min": 218.31, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.83, "avg": 6.83, "max": 6.83, "min": 6.83, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.48, "avg": 3.48, "max": 3.48, "min": 3.48, "cnt": 1}}}
{"type":"time", "iteration": 4, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 65.31, "avg": 21.77, "max": 1.22, "min": 61.46, "cnt": 3}, "forward-compute":{"total": 3127.12, "avg": 97.72, "max": 53.38, "min": 442.78, "cnt": 32}, "fwd-compute":{"total": 3124.20, "avg": 97.63, "max": 53.31, "min": 442.70, "cnt": 32}, "batch-generator":{"total": 226.43, "avg": 7.08, "max": 0.66, "min": 177.07, "cnt": 32}, "fwd-embedding":{"total": 0.53, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 2885.64, "avg": 90.18, "max": 52.27, "min": 440.13, "cnt": 32}, "fwd-layernorm":{"total": 9.32, "avg": 0.07, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 106.22, "avg": 0.83, "max": 0.74, "min": 1.53, "cnt": 128}, "fwd-misc":{"total": 20.37, "avg": 0.16, "max": 0.11, "min": 0.40, "cnt": 128}, "fwd-MLP":{"total": 2729.52, "avg": 21.32, "max": 11.21, "min": 399.60, "cnt": 128}, "MoE_L0_fwd":{"total": 1537.59, "avg": 48.05, "max": 11.94, "min": 399.50, "cnt": 32}, "MoEMLP":{"total": 2713.08, "avg": 21.20, "max": 11.10, "min": 399.45, "cnt": 128}, "MoE_L1_fwd":{"total": 405.66, "avg": 12.68, "max": 11.59, "min": 16.10, "cnt": 32}, "MoE_L2_fwd":{"total": 393.51, "avg": 12.30, "max": 11.60, "min": 13.49, "cnt": 32}, "MoE_L3_fwd":{"total": 382.42, "avg": 11.95, "max": 11.14, "min": 15.42, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 5.05, "avg": 2.52, "max": 0.89, "min": 4.16, "cnt": 2}, "forward-send-backward-recv":{"total": 235.82, "avg": 7.86, "max": 1.31, "min": 120.98, "cnt": 30}, "backward-compute":{"total": 1792.73, "avg": 56.02, "max": 53.76, "min": 63.81, "cnt": 32}, "MoE_L3_bwd":{"total": 444.04, "avg": 13.88, "max": 12.56, "min": 20.10, "cnt": 32}, "MoE_L2_bwd":{"total": 397.36, "avg": 12.42, "max": 11.85, "min": 13.51, "cnt": 32}, "MoE_L1_bwd":{"total": 360.36, "avg": 11.26, "max": 10.59, "min": 13.46, "cnt": 32}, "MoE_L0_bwd":{"total": 378.17, "avg": 11.82, "max": 11.20, "min": 13.24, "cnt": 32}, "backward-send-forward-recv":{"total": 11482.32, "avg": 395.94, "max": 2.11, "min": 2086.38, "cnt": 29}, "backward-send":{"total": 2.65, "avg": 0.88, "max": 0.72, "min": 1.00, "cnt": 3}, "backward-recv":{"total": 132.86, "avg": 66.43, "max": 66.11, "min": 66.75, "cnt": 2}, "backward-params-all-reduce":{"total": 502.65, "avg": 502.65, "max": 502.65, "min": 502.65, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 257.83, "avg": 257.83, "max": 257.83, "min": 257.83, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.40, "avg": 3.40, "max": 3.40, "min": 3.40, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 213.58, "avg": 213.58, "max": 213.58, "min": 213.58, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.80, "avg": 6.80, "max": 6.80, "min": 6.80, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 5, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 324.39, "avg": 108.13, "max": 1.06, "min": 263.24, "cnt": 3}, "forward-compute":{"total": 2339.44, "avg": 73.11, "max": 52.45, "min": 178.32, "cnt": 32}, "fwd-compute":{"total": 2336.45, "avg": 73.01, "max": 52.38, "min": 178.23, "cnt": 32}, "batch-generator":{"total": 45.21, "avg": 1.41, "max": 0.68, "min": 3.41, "cnt": 32}, "fwd-embedding":{"total": 0.58, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 2279.12, "avg": 71.22, "max": 51.22, "min": 176.12, "cnt": 32}, "fwd-layernorm":{"total": 9.45, "avg": 0.07, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 106.72, "avg": 0.83, "max": 0.74, "min": 1.46, "cnt": 128}, "fwd-misc":{"total": 21.07, "avg": 0.16, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 2120.89, "avg": 16.57, "max": 10.68, "min": 133.25, "cnt": 128}, "MoE_L0_fwd":{"total": 946.22, "avg": 29.57, "max": 11.44, "min": 133.17, "cnt": 32}, "MoEMLP":{"total": 2103.90, "avg": 16.44, "max": 10.55, "min": 133.12, "cnt": 128}, "MoE_L1_fwd":{"total": 415.42, "avg": 12.98, "max": 12.03, "min": 14.93, "cnt": 32}, "MoE_L2_fwd":{"total": 392.15, "avg": 12.25, "max": 11.37, "min": 13.49, "cnt": 32}, "MoE_L3_fwd":{"total": 356.27, "avg": 11.13, "max": 10.61, "min": 13.00, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 4.32, "avg": 2.16, "max": 0.78, "min": 3.54, "cnt": 2}, "forward-send-backward-recv":{"total": 80.36, "avg": 2.68, "max": 1.64, "min": 8.49, "cnt": 30}, "backward-compute":{"total": 1804.43, "avg": 56.39, "max": 54.02, "min": 59.46, "cnt": 32}, "MoE_L3_bwd":{"total": 404.31, "avg": 12.63, "max": 11.61, "min": 14.10, "cnt": 32}, "MoE_L2_bwd":{"total": 414.00, "avg": 12.94, "max": 11.91, "min": 14.82, "cnt": 32}, "MoE_L1_bwd":{"total": 410.81, "avg": 12.84, "max": 12.01, "min": 15.45, "cnt": 32}, "MoE_L0_bwd":{"total": 361.35, "avg": 11.29, "max": 10.91, "min": 12.18, "cnt": 32}, "backward-send-forward-recv":{"total": 7281.42, "avg": 251.08, "max": 2.32, "min": 743.13, "cnt": 29}, "backward-send":{"total": 3.12, "avg": 1.04, "max": 0.94, "min": 1.17, "cnt": 3}, "backward-recv":{"total": 164.11, "avg": 82.06, "max": 67.65, "min": 96.46, "cnt": 2}, "backward-params-all-reduce":{"total": 492.32, "avg": 492.32, "max": 492.32, "min": 492.32, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "optimizer":{"total": 259.98, "avg": 259.98, "max": 259.98, "min": 259.98, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 5.51, "avg": 5.51, "max": 5.51, "min": 5.51, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 213.62, "avg": 213.62, "max": 213.62, "min": 213.62, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.80, "avg": 6.80, "max": 6.80, "min": 6.80, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 6, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 76.02, "avg": 25.34, "max": 1.83, "min": 68.71, "cnt": 3}, "forward-compute":{"total": 1971.57, "avg": 61.61, "max": 54.80, "min": 75.37, "cnt": 32}, "fwd-compute":{"total": 1968.48, "avg": 61.52, "max": 54.73, "min": 75.28, "cnt": 32}, "batch-generator":{"total": 47.67, "avg": 1.49, "max": 0.68, "min": 4.65, "cnt": 32}, "fwd-embedding":{"total": 0.66, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1907.71, "avg": 59.62, "max": 53.70, "min": 73.84, "cnt": 32}, "fwd-layernorm":{"total": 9.93, "avg": 0.08, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 110.69, "avg": 0.86, "max": 0.74, "min": 1.53, "cnt": 128}, "fwd-misc":{"total": 22.04, "avg": 0.17, "max": 0.11, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1743.35, "avg": 13.62, "max": 10.73, "min": 32.35, "cnt": 128}, "MoE_L0_fwd":{"total": 560.77, "avg": 17.52, "max": 13.33, "min": 32.26, "cnt": 32}, "MoEMLP":{"total": 1725.72, "avg": 13.48, "max": 10.61, "min": 32.22, "cnt": 128}, "MoE_L1_fwd":{"total": 427.83, "avg": 13.37, "max": 12.35, "min": 16.22, "cnt": 32}, "MoE_L2_fwd":{"total": 373.72, "avg": 11.68, "max": 10.98, "min": 14.73, "cnt": 32}, "MoE_L3_fwd":{"total": 369.73, "avg": 11.55, "max": 10.66, "min": 15.75, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 2.01, "avg": 1.01, "max": 0.99, "min": 1.02, "cnt": 2}, "forward-send-backward-recv":{"total": 210.70, "avg": 7.02, "max": 1.57, "min": 128.52, "cnt": 30}, "backward-compute":{"total": 1905.06, "avg": 59.53, "max": 57.59, "min": 62.09, "cnt": 32}, "MoE_L3_bwd":{"total": 412.89, "avg": 12.90, "max": 11.54, "min": 14.69, "cnt": 32}, "MoE_L2_bwd":{"total": 364.59, "avg": 11.39, "max": 10.91, "min": 12.14, "cnt": 32}, "MoE_L1_bwd":{"total": 435.52, "avg": 13.61, "max": 12.94, "min": 14.85, "cnt": 32}, "MoE_L0_bwd":{"total": 476.71, "avg": 14.90, "max": 14.11, "min": 15.89, "cnt": 32}, "backward-send-forward-recv":{"total": 8187.99, "avg": 282.34, "max": 1.93, "min": 833.81, "cnt": 29}, "backward-send":{"total": 1.51, "avg": 0.50, "max": 0.45, "min": 0.58, "cnt": 3}, "backward-recv":{"total": 124.08, "avg": 62.04, "max": 57.05, "min": 67.03, "cnt": 2}, "backward-params-all-reduce":{"total": 488.79, "avg": 488.79, "max": 488.79, "min": 488.79, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 257.45, "avg": 257.45, "max": 257.45, "min": 257.45, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 213.30, "avg": 213.30, "max": 213.30, "min": 213.30, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.77, "avg": 6.77, "max": 6.77, "min": 6.77, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 7, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 73.52, "avg": 24.51, "max": 1.24, "min": 68.12, "cnt": 3}, "forward-compute":{"total": 2181.05, "avg": 68.16, "max": 58.94, "min": 163.87, "cnt": 32}, "fwd-compute":{"total": 2177.83, "avg": 68.06, "max": 58.85, "min": 163.78, "cnt": 32}, "batch-generator":{"total": 83.44, "avg": 2.61, "max": 0.69, "min": 33.36, "cnt": 32}, "fwd-embedding":{"total": 0.71, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 2081.66, "avg": 65.05, "max": 57.62, "min": 160.01, "cnt": 32}, "fwd-layernorm":{"total": 10.58, "avg": 0.08, "max": 0.05, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 114.15, "avg": 0.89, "max": 0.74, "min": 2.27, "cnt": 128}, "fwd-misc":{"total": 22.54, "avg": 0.18, "max": 0.11, "min": 0.39, "cnt": 128}, "fwd-MLP":{"total": 1911.78, "avg": 14.94, "max": 10.92, "min": 114.66, "cnt": 128}, "MoE_L0_fwd":{"total": 652.86, "avg": 20.40, "max": 13.95, "min": 114.57, "cnt": 32}, "MoEMLP":{"total": 1893.40, "avg": 14.79, "max": 10.81, "min": 114.52, "cnt": 128}, "MoE_L1_fwd":{"total": 383.34, "avg": 11.98, "max": 10.85, "min": 15.45, "cnt": 32}, "MoE_L2_fwd":{"total": 457.23, "avg": 14.29, "max": 13.58, "min": 17.15, "cnt": 32}, "MoE_L3_fwd":{"total": 406.65, "avg": 12.71, "max": 12.07, "min": 13.65, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.61, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.92, "avg": 0.96, "max": 0.93, "min": 0.99, "cnt": 2}, "forward-send-backward-recv":{"total": 767.86, "avg": 25.60, "max": 1.52, "min": 247.33, "cnt": 30}, "backward-compute":{"total": 2081.43, "avg": 65.04, "max": 63.68, "min": 69.59, "cnt": 32}, "MoE_L3_bwd":{"total": 480.80, "avg": 15.02, "max": 13.99, "min": 18.12, "cnt": 32}, "MoE_L2_bwd":{"total": 533.92, "avg": 16.68, "max": 15.69, "min": 18.58, "cnt": 32}, "MoE_L1_bwd":{"total": 346.06, "avg": 10.81, "max": 10.47, "min": 11.83, "cnt": 32}, "MoE_L0_bwd":{"total": 508.34, "avg": 15.89, "max": 15.30, "min": 16.41, "cnt": 32}, "backward-send-forward-recv":{"total": 9136.86, "avg": 315.06, "max": 1.80, "min": 1134.40, "cnt": 29}, "backward-send":{"total": 2.28, "avg": 0.76, "max": 0.50, "min": 0.94, "cnt": 3}, "backward-recv":{"total": 168.41, "avg": 84.21, "max": 68.66, "min": 99.75, "cnt": 2}, "backward-params-all-reduce":{"total": 489.55, "avg": 489.55, "max": 489.55, "min": 489.55, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 259.71, "avg": 259.71, "max": 259.71, "min": 259.71, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 215.54, "avg": 215.54, "max": 215.54, "min": 215.54, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.82, "avg": 6.82, "max": 6.82, "min": 6.82, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 8, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 70.88, "avg": 23.63, "max": 0.85, "min": 69.01, "cnt": 3}, "forward-compute":{"total": 1958.41, "avg": 61.20, "max": 53.28, "min": 68.13, "cnt": 32}, "fwd-compute":{"total": 1955.09, "avg": 61.10, "max": 53.20, "min": 68.04, "cnt": 32}, "batch-generator":{"total": 61.09, "avg": 1.91, "max": 0.72, "min": 3.78, "cnt": 32}, "fwd-embedding":{"total": 0.63, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1881.43, "avg": 58.79, "max": 52.12, "min": 65.42, "cnt": 32}, "fwd-layernorm":{"total": 10.00, "avg": 0.08, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 109.08, "avg": 0.85, "max": 0.74, "min": 1.52, "cnt": 128}, "fwd-misc":{"total": 21.55, "avg": 0.17, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1719.58, "avg": 13.43, "max": 10.64, "min": 21.94, "cnt": 128}, "MoE_L0_fwd":{"total": 472.99, "avg": 14.78, "max": 10.56, "min": 21.86, "cnt": 32}, "MoEMLP":{"total": 1702.18, "avg": 13.30, "max": 10.52, "min": 21.81, "cnt": 128}, "MoE_L1_fwd":{"total": 380.12, "avg": 11.88, "max": 11.02, "min": 12.63, "cnt": 32}, "MoE_L2_fwd":{"total": 442.91, "avg": 13.84, "max": 13.30, "min": 15.50, "cnt": 32}, "MoE_L3_fwd":{"total": 412.56, "avg": 12.89, "max": 11.89, "min": 16.45, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 12.28, "avg": 6.14, "max": 1.16, "min": 11.12, "cnt": 2}, "forward-send-backward-recv":{"total": 232.01, "avg": 7.73, "max": 1.49, "min": 127.56, "cnt": 30}, "backward-compute":{"total": 1877.08, "avg": 58.66, "max": 55.31, "min": 60.73, "cnt": 32}, "MoE_L3_bwd":{"total": 441.43, "avg": 13.79, "max": 12.56, "min": 15.46, "cnt": 32}, "MoE_L2_bwd":{"total": 497.29, "avg": 15.54, "max": 14.75, "min": 16.53, "cnt": 32}, "MoE_L1_bwd":{"total": 380.28, "avg": 11.88, "max": 11.31, "min": 12.38, "cnt": 32}, "MoE_L0_bwd":{"total": 345.22, "avg": 10.79, "max": 9.72, "min": 11.27, "cnt": 32}, "backward-send-forward-recv":{"total": 8786.95, "avg": 303.00, "max": 2.28, "min": 1097.77, "cnt": 29}, "backward-send":{"total": 2.90, "avg": 0.97, "max": 0.86, "min": 1.05, "cnt": 3}, "backward-recv":{"total": 138.86, "avg": 69.43, "max": 67.03, "min": 71.83, "cnt": 2}, "backward-params-all-reduce":{"total": 492.56, "avg": 492.56, "max": 492.56, "min": 492.56, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 256.86, "avg": 256.86, "max": 256.86, "min": 256.86, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 212.71, "avg": 212.71, "max": 212.71, "min": 212.71, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.81, "avg": 6.81, "max": 6.81, "min": 6.81, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 9, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.11, "avg": 0.11, "max": 0.11, "min": 0.11, "cnt": 1}, "forward-recv":{"total": 67.70, "avg": 22.57, "max": 0.87, "min": 65.64, "cnt": 3}, "forward-compute":{"total": 2019.44, "avg": 63.11, "max": 53.94, "min": 150.91, "cnt": 32}, "fwd-compute":{"total": 2016.36, "avg": 63.01, "max": 53.87, "min": 150.82, "cnt": 32}, "batch-generator":{"total": 44.67, "avg": 1.40, "max": 0.67, "min": 2.60, "cnt": 32}, "fwd-embedding":{"total": 0.63, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1958.99, "avg": 61.22, "max": 52.82, "min": 149.42, "cnt": 32}, "fwd-layernorm":{"total": 10.01, "avg": 0.08, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 111.60, "avg": 0.87, "max": 0.74, "min": 1.87, "cnt": 128}, "fwd-misc":{"total": 21.68, "avg": 0.17, "max": 0.11, "min": 0.40, "cnt": 128}, "fwd-MLP":{"total": 1794.02, "avg": 14.02, "max": 11.12, "min": 107.13, "cnt": 128}, "MoE_L0_fwd":{"total": 619.76, "avg": 19.37, "max": 12.61, "min": 107.03, "cnt": 32}, "MoEMLP":{"total": 1776.05, "avg": 13.88, "max": 10.98, "min": 106.98, "cnt": 128}, "MoE_L1_fwd":{"total": 384.40, "avg": 12.01, "max": 11.03, "min": 15.83, "cnt": 32}, "MoE_L2_fwd":{"total": 389.66, "avg": 12.18, "max": 11.32, "min": 14.09, "cnt": 32}, "MoE_L3_fwd":{"total": 388.60, "avg": 12.14, "max": 11.44, "min": 14.23, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 11.21, "avg": 5.61, "max": 0.58, "min": 10.64, "cnt": 2}, "forward-send-backward-recv":{"total": 213.20, "avg": 7.11, "max": 1.23, "min": 115.62, "cnt": 30}, "backward-compute":{"total": 1722.10, "avg": 53.82, "max": 50.77, "min": 58.42, "cnt": 32}, "MoE_L3_bwd":{"total": 444.69, "avg": 13.90, "max": 13.16, "min": 18.50, "cnt": 32}, "MoE_L2_bwd":{"total": 372.67, "avg": 11.65, "max": 10.52, "min": 12.83, "cnt": 32}, "MoE_L1_bwd":{"total": 340.69, "avg": 10.65, "max": 9.99, "min": 11.59, "cnt": 32}, "MoE_L0_bwd":{"total": 349.14, "avg": 10.91, "max": 10.06, "min": 12.81, "cnt": 32}, "backward-send-forward-recv":{"total": 9582.32, "avg": 330.42, "max": 2.07, "min": 1087.25, "cnt": 29}, "backward-send":{"total": 3.36, "avg": 1.12, "max": 1.00, "min": 1.34, "cnt": 3}, "backward-recv":{"total": 134.64, "avg": 67.32, "max": 60.39, "min": 74.25, "cnt": 2}, "backward-params-all-reduce":{"total": 493.06, "avg": 493.06, "max": 493.06, "min": 493.06, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.04, "avg": 0.04, "max": 0.04, "min": 0.04, "cnt": 1}, "optimizer":{"total": 224.16, "avg": 224.16, "max": 224.16, "min": 224.16, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 217.19, "avg": 217.19, "max": 217.19, "min": 217.19, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}}}
{"type":"time", "iteration": 10, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 67.11, "avg": 22.37, "max": 0.92, "min": 62.05, "cnt": 3}, "forward-compute":{"total": 1978.73, "avg": 61.84, "max": 54.13, "min": 81.05, "cnt": 32}, "fwd-compute":{"total": 1975.39, "avg": 61.73, "max": 54.06, "min": 80.97, "cnt": 32}, "batch-generator":{"total": 53.99, "avg": 1.69, "max": 0.68, "min": 4.22, "cnt": 32}, "fwd-embedding":{"total": 0.72, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1908.22, "avg": 59.63, "max": 53.03, "min": 79.49, "cnt": 32}, "fwd-layernorm":{"total": 10.35, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 112.74, "avg": 0.88, "max": 0.74, "min": 1.54, "cnt": 128}, "fwd-misc":{"total": 22.31, "avg": 0.17, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1740.58, "avg": 13.60, "max": 11.25, "min": 33.54, "cnt": 128}, "MoE_L0_fwd":{"total": 547.06, "avg": 17.10, "max": 13.14, "min": 33.44, "cnt": 32}, "MoEMLP":{"total": 1722.69, "avg": 13.46, "max": 11.12, "min": 33.39, "cnt": 128}, "MoE_L1_fwd":{"total": 396.73, "avg": 12.40, "max": 11.17, "min": 16.14, "cnt": 32}, "MoE_L2_fwd":{"total": 395.87, "avg": 12.37, "max": 11.46, "min": 18.48, "cnt": 32}, "MoE_L3_fwd":{"total": 389.54, "avg": 12.17, "max": 11.44, "min": 17.81, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 2.52, "avg": 1.26, "max": 0.65, "min": 1.87, "cnt": 2}, "forward-send-backward-recv":{"total": 204.63, "avg": 6.82, "max": 1.34, "min": 118.19, "cnt": 30}, "backward-compute":{"total": 1702.86, "avg": 53.21, "max": 51.36, "min": 54.79, "cnt": 32}, "MoE_L3_bwd":{"total": 438.65, "avg": 13.71, "max": 12.84, "min": 14.44, "cnt": 32}, "MoE_L2_bwd":{"total": 370.47, "avg": 11.58, "max": 10.99, "min": 12.91, "cnt": 32}, "MoE_L1_bwd":{"total": 337.89, "avg": 10.56, "max": 9.97, "min": 11.16, "cnt": 32}, "MoE_L0_bwd":{"total": 344.28, "avg": 10.76, "max": 10.16, "min": 11.28, "cnt": 32}, "backward-send-forward-recv":{"total": 6789.63, "avg": 234.13, "max": 2.21, "min": 991.92, "cnt": 29}, "backward-send":{"total": 2.20, "avg": 0.73, "max": 0.52, "min": 0.97, "cnt": 3}, "backward-recv":{"total": 322.57, "avg": 161.28, "max": 63.84, "min": 258.73, "cnt": 2}, "backward-params-all-reduce":{"total": 484.52, "avg": 484.52, "max": 484.52, "min": 484.52, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 231.25, "avg": 231.25, "max": 231.25, "min": 231.25, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 224.26, "avg": 224.26, "max": 224.26, "min": 224.26, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.34, "avg": 3.34, "max": 3.34, "min": 3.34, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}}}
{"type":"time", "iteration": 11, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 70.75, "avg": 23.58, "max": 2.60, "min": 61.89, "cnt": 3}, "forward-compute":{"total": 1962.86, "avg": 61.34, "max": 53.43, "min": 80.89, "cnt": 32}, "fwd-compute":{"total": 1959.86, "avg": 61.25, "max": 53.36, "min": 80.81, "cnt": 32}, "batch-generator":{"total": 55.77, "avg": 1.74, "max": 0.68, "min": 3.89, "cnt": 32}, "fwd-embedding":{"total": 0.67, "avg": 0.02, "max": 0.01, "min": 0.06, "cnt": 32}, "fwd-encoder":{"total": 1891.43, "avg": 59.11, "max": 51.92, "min": 76.54, "cnt": 32}, "fwd-layernorm":{"total": 9.89, "avg": 0.08, "max": 0.05, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 107.69, "avg": 0.84, "max": 0.74, "min": 1.55, "cnt": 128}, "fwd-misc":{"total": 20.94, "avg": 0.16, "max": 0.11, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1732.36, "avg": 13.53, "max": 11.02, "min": 31.31, "cnt": 128}, "MoE_L0_fwd":{"total": 534.39, "avg": 16.70, "max": 12.31, "min": 31.17, "cnt": 32}, "MoEMLP":{"total": 1715.33, "avg": 13.40, "max": 10.91, "min": 31.09, "cnt": 128}, "MoE_L1_fwd":{"total": 399.64, "avg": 12.49, "max": 10.95, "min": 16.42, "cnt": 32}, "MoE_L2_fwd":{"total": 395.38, "avg": 12.36, "max": 11.16, "min": 14.38, "cnt": 32}, "MoE_L3_fwd":{"total": 392.18, "avg": 12.26, "max": 11.32, "min": 14.74, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.27, "avg": 0.64, "max": 0.58, "min": 0.69, "cnt": 2}, "forward-send-backward-recv":{"total": 208.21, "avg": 6.94, "max": 1.27, "min": 129.62, "cnt": 30}, "backward-compute":{"total": 1727.22, "avg": 53.98, "max": 50.06, "min": 57.96, "cnt": 32}, "MoE_L3_bwd":{"total": 457.10, "avg": 14.28, "max": 12.33, "min": 18.53, "cnt": 32}, "MoE_L2_bwd":{"total": 372.62, "avg": 11.64, "max": 10.21, "min": 13.79, "cnt": 32}, "MoE_L1_bwd":{"total": 338.19, "avg": 10.57, "max": 9.78, "min": 11.29, "cnt": 32}, "MoE_L0_bwd":{"total": 346.07, "avg": 10.81, "max": 10.27, "min": 12.30, "cnt": 32}, "backward-send-forward-recv":{"total": 7421.09, "avg": 255.90, "max": 2.05, "min": 903.67, "cnt": 29}, "backward-send":{"total": 2.31, "avg": 0.77, "max": 0.45, "min": 0.99, "cnt": 3}, "backward-recv":{"total": 134.10, "avg": 67.05, "max": 60.87, "min": 73.23, "cnt": 2}, "backward-params-all-reduce":{"total": 488.67, "avg": 488.67, "max": 488.67, "min": 488.67, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 227.31, "avg": 227.31, "max": 227.31, "min": 227.31, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 216.95, "avg": 216.95, "max": 216.95, "min": 216.95, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.84, "avg": 6.84, "max": 6.84, "min": 6.84, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}}}
{"type":"time", "iteration": 12, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 71.24, "avg": 23.75, "max": 0.97, "min": 68.97, "cnt": 3}, "forward-compute":{"total": 2021.14, "avg": 63.16, "max": 52.82, "min": 98.73, "cnt": 32}, "fwd-compute":{"total": 2017.99, "avg": 63.06, "max": 52.75, "min": 98.65, "cnt": 32}, "batch-generator":{"total": 82.55, "avg": 2.58, "max": 0.66, "min": 26.77, "cnt": 32}, "fwd-embedding":{"total": 0.67, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1922.62, "avg": 60.08, "max": 51.62, "min": 94.91, "cnt": 32}, "fwd-layernorm":{"total": 10.32, "avg": 0.08, "max": 0.06, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 110.94, "avg": 0.87, "max": 0.74, "min": 1.85, "cnt": 128}, "fwd-misc":{"total": 21.63, "avg": 0.17, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1758.03, "avg": 13.73, "max": 11.24, "min": 51.64, "cnt": 128}, "MoE_L0_fwd":{"total": 549.61, "avg": 17.18, "max": 12.49, "min": 51.56, "cnt": 32}, "MoEMLP":{"total": 1740.32, "avg": 13.60, "max": 11.09, "min": 51.51, "cnt": 128}, "MoE_L1_fwd":{"total": 393.43, "avg": 12.29, "max": 11.16, "min": 15.83, "cnt": 32}, "MoE_L2_fwd":{"total": 396.49, "avg": 12.39, "max": 11.13, "min": 16.10, "cnt": 32}, "MoE_L3_fwd":{"total": 407.31, "avg": 12.73, "max": 11.41, "min": 19.48, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 4.46, "avg": 2.23, "max": 0.62, "min": 3.84, "cnt": 2}, "forward-send-backward-recv":{"total": 196.90, "avg": 6.56, "max": 1.25, "min": 120.32, "cnt": 30}, "backward-compute":{"total": 1742.76, "avg": 54.46, "max": 52.71, "min": 58.10, "cnt": 32}, "MoE_L3_bwd":{"total": 459.23, "avg": 14.35, "max": 13.07, "min": 17.08, "cnt": 32}, "MoE_L2_bwd":{"total": 384.98, "avg": 12.03, "max": 10.44, "min": 13.21, "cnt": 32}, "MoE_L1_bwd":{"total": 340.01, "avg": 10.63, "max": 10.12, "min": 11.12, "cnt": 32}, "MoE_L0_bwd":{"total": 346.50, "avg": 10.83, "max": 9.79, "min": 11.34, "cnt": 32}, "backward-send-forward-recv":{"total": 8003.20, "avg": 275.97, "max": 2.18, "min": 1405.15, "cnt": 29}, "backward-send":{"total": 1.76, "avg": 0.59, "max": 0.48, "min": 0.78, "cnt": 3}, "backward-recv":{"total": 179.16, "avg": 89.58, "max": 73.01, "min": 106.14, "cnt": 2}, "backward-params-all-reduce":{"total": 488.49, "avg": 488.49, "max": 488.49, "min": 488.49, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 232.11, "avg": 232.11, "max": 232.11, "min": 232.11, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 221.82, "avg": 221.82, "max": 221.82, "min": 221.82, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.75, "avg": 6.75, "max": 6.75, "min": 6.75, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}}}
{"type":"time", "iteration": 13, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.06, "avg": 0.06, "max": 0.06, "min": 0.06, "cnt": 1}, "forward-recv":{"total": 74.76, "avg": 24.92, "max": 1.34, "min": 66.01, "cnt": 3}, "forward-compute":{"total": 1934.12, "avg": 60.44, "max": 51.91, "min": 71.66, "cnt": 32}, "fwd-compute":{"total": 1931.43, "avg": 60.36, "max": 51.84, "min": 71.58, "cnt": 32}, "batch-generator":{"total": 44.10, "avg": 1.38, "max": 0.72, "min": 3.21, "cnt": 32}, "fwd-embedding":{"total": 0.52, "avg": 0.02, "max": 0.01, "min": 0.06, "cnt": 32}, "fwd-encoder":{"total": 1875.95, "avg": 58.62, "max": 50.82, "min": 69.58, "cnt": 32}, "fwd-layernorm":{"total": 9.03, "avg": 0.07, "max": 0.06, "min": 0.22, "cnt": 128}, "fwd-attn":{"total": 104.53, "avg": 0.82, "max": 0.74, "min": 1.66, "cnt": 128}, "fwd-misc":{"total": 19.71, "avg": 0.15, "max": 0.11, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1723.06, "avg": 13.46, "max": 11.06, "min": 23.42, "cnt": 128}, "MoE_L0_fwd":{"total": 529.96, "avg": 16.56, "max": 12.04, "min": 23.33, "cnt": 32}, "MoEMLP":{"total": 1706.88, "avg": 13.33, "max": 10.95, "min": 23.28, "cnt": 128}, "MoE_L1_fwd":{"total": 406.91, "avg": 12.72, "max": 10.99, "min": 15.52, "cnt": 32}, "MoE_L2_fwd":{"total": 391.25, "avg": 12.23, "max": 11.36, "min": 15.23, "cnt": 32}, "MoE_L3_fwd":{"total": 384.68, "avg": 12.02, "max": 11.41, "min": 13.17, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.56, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.55, "avg": 0.77, "max": 0.67, "min": 0.88, "cnt": 2}, "forward-send-backward-recv":{"total": 1607.61, "avg": 53.59, "max": 1.28, "min": 524.56, "cnt": 30}, "backward-compute":{"total": 1728.39, "avg": 54.01, "max": 51.26, "min": 58.90, "cnt": 32}, "MoE_L3_bwd":{"total": 451.81, "avg": 14.12, "max": 11.60, "min": 18.72, "cnt": 32}, "MoE_L2_bwd":{"total": 379.68, "avg": 11.86, "max": 10.66, "min": 13.39, "cnt": 32}, "MoE_L1_bwd":{"total": 340.94, "avg": 10.65, "max": 10.03, "min": 11.91, "cnt": 32}, "MoE_L0_bwd":{"total": 344.16, "avg": 10.76, "max": 10.33, "min": 11.94, "cnt": 32}, "backward-send-forward-recv":{"total": 5989.91, "avg": 206.55, "max": 1.28, "min": 968.71, "cnt": 29}, "backward-send":{"total": 2.25, "avg": 0.75, "max": 0.59, "min": 0.96, "cnt": 3}, "backward-recv":{"total": 381.47, "avg": 190.73, "max": 79.15, "min": 302.32, "cnt": 2}, "backward-params-all-reduce":{"total": 486.99, "avg": 486.99, "max": 486.99, "min": 486.99, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 258.49, "avg": 258.49, "max": 258.49, "min": 258.49, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 214.22, "avg": 214.22, "max": 214.22, "min": 214.22, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.99, "avg": 6.99, "max": 6.99, "min": 6.99, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 14, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 66.58, "avg": 22.19, "max": 0.85, "min": 61.71, "cnt": 3}, "forward-compute":{"total": 1802.57, "avg": 56.33, "max": 50.24, "min": 64.18, "cnt": 32}, "fwd-compute":{"total": 1799.28, "avg": 56.23, "max": 50.17, "min": 64.07, "cnt": 32}, "batch-generator":{"total": 52.34, "avg": 1.64, "max": 0.67, "min": 3.10, "cnt": 32}, "fwd-embedding":{"total": 0.67, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1734.37, "avg": 54.20, "max": 49.21, "min": 60.61, "cnt": 32}, "fwd-layernorm":{"total": 10.38, "avg": 0.08, "max": 0.05, "min": 0.23, "cnt": 128}, "fwd-attn":{"total": 112.19, "avg": 0.88, "max": 0.74, "min": 1.97, "cnt": 128}, "fwd-misc":{"total": 21.98, "avg": 0.17, "max": 0.11, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1568.24, "avg": 12.25, "max": 10.94, "min": 21.01, "cnt": 128}, "MoE_L0_fwd":{"total": 455.73, "avg": 14.24, "max": 11.16, "min": 20.92, "cnt": 32}, "MoEMLP":{"total": 1550.29, "avg": 12.11, "max": 10.83, "min": 20.87, "cnt": 128}, "MoE_L1_fwd":{"total": 373.30, "avg": 11.67, "max": 10.87, "min": 13.00, "cnt": 32}, "MoE_L2_fwd":{"total": 364.50, "avg": 11.39, "max": 11.09, "min": 11.79, "cnt": 32}, "MoE_L3_fwd":{"total": 363.34, "avg": 11.35, "max": 10.95, "min": 12.56, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 12.02, "avg": 6.01, "max": 0.94, "min": 11.08, "cnt": 2}, "forward-send-backward-recv":{"total": 312.83, "avg": 10.43, "max": 1.48, "min": 124.91, "cnt": 30}, "backward-compute":{"total": 1768.09, "avg": 55.25, "max": 52.24, "min": 60.25, "cnt": 32}, "MoE_L3_bwd":{"total": 425.38, "avg": 13.29, "max": 12.57, "min": 15.81, "cnt": 32}, "MoE_L2_bwd":{"total": 385.83, "avg": 12.06, "max": 11.19, "min": 14.97, "cnt": 32}, "MoE_L1_bwd":{"total": 365.77, "avg": 11.43, "max": 10.85, "min": 11.69, "cnt": 32}, "MoE_L0_bwd":{"total": 378.92, "avg": 11.84, "max": 11.03, "min": 13.40, "cnt": 32}, "backward-send-forward-recv":{"total": 8202.18, "avg": 282.83, "max": 2.15, "min": 1653.32, "cnt": 29}, "backward-send":{"total": 3.06, "avg": 1.02, "max": 0.91, "min": 1.11, "cnt": 3}, "backward-recv":{"total": 322.03, "avg": 161.02, "max": 70.04, "min": 251.99, "cnt": 2}, "backward-params-all-reduce":{"total": 488.25, "avg": 488.25, "max": 488.25, "min": 488.25, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 257.80, "avg": 257.80, "max": 257.80, "min": 257.80, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 213.58, "avg": 213.58, "max": 213.58, "min": 213.58, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.82, "avg": 6.82, "max": 6.82, "min": 6.82, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 15, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.06, "avg": 0.06, "max": 0.06, "min": 0.06, "cnt": 1}, "forward-recv":{"total": 72.92, "avg": 24.31, "max": 1.76, "min": 61.74, "cnt": 3}, "forward-compute":{"total": 1813.90, "avg": 56.68, "max": 50.33, "min": 60.78, "cnt": 32}, "fwd-compute":{"total": 1810.81, "avg": 56.59, "max": 50.26, "min": 60.70, "cnt": 32}, "batch-generator":{"total": 49.75, "avg": 1.55, "max": 0.72, "min": 3.50, "cnt": 32}, "fwd-embedding":{"total": 0.66, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1748.80, "avg": 54.65, "max": 49.17, "min": 58.47, "cnt": 32}, "fwd-layernorm":{"total": 10.00, "avg": 0.08, "max": 0.05, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 110.15, "avg": 0.86, "max": 0.74, "min": 1.50, "cnt": 128}, "fwd-misc":{"total": 21.67, "avg": 0.17, "max": 0.11, "min": 0.34, "cnt": 128}, "fwd-MLP":{"total": 1585.45, "avg": 12.39, "max": 10.35, "min": 19.43, "cnt": 128}, "MoE_L0_fwd":{"total": 460.04, "avg": 14.38, "max": 10.89, "min": 19.35, "cnt": 32}, "MoEMLP":{"total": 1567.85, "avg": 12.25, "max": 10.23, "min": 19.31, "cnt": 128}, "MoE_L1_fwd":{"total": 385.55, "avg": 12.05, "max": 11.12, "min": 14.63, "cnt": 32}, "MoE_L2_fwd":{"total": 368.66, "avg": 11.52, "max": 11.10, "min": 13.72, "cnt": 32}, "MoE_L3_fwd":{"total": 360.06, "avg": 11.25, "max": 10.28, "min": 11.68, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.86, "avg": 0.93, "max": 0.91, "min": 0.95, "cnt": 2}, "forward-send-backward-recv":{"total": 239.81, "avg": 7.99, "max": 1.24, "min": 125.69, "cnt": 30}, "backward-compute":{"total": 1759.18, "avg": 54.97, "max": 53.20, "min": 57.73, "cnt": 32}, "MoE_L3_bwd":{"total": 423.68, "avg": 13.24, "max": 12.16, "min": 15.20, "cnt": 32}, "MoE_L2_bwd":{"total": 389.34, "avg": 12.17, "max": 11.22, "min": 13.69, "cnt": 32}, "MoE_L1_bwd":{"total": 367.54, "avg": 11.49, "max": 10.77, "min": 11.71, "cnt": 32}, "MoE_L0_bwd":{"total": 366.75, "avg": 11.46, "max": 10.72, "min": 11.94, "cnt": 32}, "backward-send-forward-recv":{"total": 6058.68, "avg": 208.92, "max": 2.00, "min": 759.82, "cnt": 29}, "backward-send":{"total": 2.48, "avg": 0.83, "max": 0.69, "min": 1.08, "cnt": 3}, "backward-recv":{"total": 206.10, "avg": 103.05, "max": 70.73, "min": 135.36, "cnt": 2}, "backward-params-all-reduce":{"total": 489.20, "avg": 489.20, "max": 489.20, "min": 489.20, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 256.79, "avg": 256.79, "max": 256.79, "min": 256.79, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 212.68, "avg": 212.68, "max": 212.68, "min": 212.68, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.80, "avg": 6.80, "max": 6.80, "min": 6.80, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 16, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 69.19, "avg": 23.06, "max": 2.62, "min": 59.84, "cnt": 3}, "forward-compute":{"total": 1940.63, "avg": 60.64, "max": 50.03, "min": 112.35, "cnt": 32}, "fwd-compute":{"total": 1937.36, "avg": 60.54, "max": 49.95, "min": 112.26, "cnt": 32}, "batch-generator":{"total": 45.34, "avg": 1.42, "max": 0.73, "min": 2.64, "cnt": 32}, "fwd-embedding":{"total": 0.66, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1879.12, "avg": 58.72, "max": 48.79, "min": 110.87, "cnt": 32}, "fwd-layernorm":{"total": 10.27, "avg": 0.08, "max": 0.05, "min": 0.22, "cnt": 128}, "fwd-attn":{"total": 110.13, "avg": 0.86, "max": 0.74, "min": 1.58, "cnt": 128}, "fwd-misc":{"total": 21.40, "avg": 0.17, "max": 0.11, "min": 0.38, "cnt": 128}, "fwd-MLP":{"total": 1715.40, "avg": 13.40, "max": 10.45, "min": 70.10, "cnt": 128}, "MoE_L0_fwd":{"total": 576.27, "avg": 18.01, "max": 10.71, "min": 70.00, "cnt": 32}, "MoEMLP":{"total": 1697.79, "avg": 13.26, "max": 10.33, "min": 69.95, "cnt": 128}, "MoE_L1_fwd":{"total": 393.17, "avg": 12.29, "max": 11.06, "min": 15.52, "cnt": 32}, "MoE_L2_fwd":{"total": 379.99, "avg": 11.87, "max": 11.14, "min": 16.12, "cnt": 32}, "MoE_L3_fwd":{"total": 354.78, "avg": 11.09, "max": 10.37, "min": 14.88, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.87, "avg": 0.94, "max": 0.90, "min": 0.97, "cnt": 2}, "forward-send-backward-recv":{"total": 235.87, "avg": 7.86, "max": 1.29, "min": 120.12, "cnt": 30}, "backward-compute":{"total": 1724.99, "avg": 53.91, "max": 51.61, "min": 57.23, "cnt": 32}, "MoE_L3_bwd":{"total": 401.24, "avg": 12.54, "max": 11.40, "min": 14.91, "cnt": 32}, "MoE_L2_bwd":{"total": 376.99, "avg": 11.78, "max": 11.26, "min": 12.56, "cnt": 32}, "MoE_L1_bwd":{"total": 368.91, "avg": 11.53, "max": 11.16, "min": 11.89, "cnt": 32}, "MoE_L0_bwd":{"total": 363.21, "avg": 11.35, "max": 10.58, "min": 12.33, "cnt": 32}, "backward-send-forward-recv":{"total": 5310.39, "avg": 183.12, "max": 1.94, "min": 538.61, "cnt": 29}, "backward-send":{"total": 2.76, "avg": 0.92, "max": 0.91, "min": 0.94, "cnt": 3}, "backward-recv":{"total": 129.94, "avg": 64.97, "max": 63.93, "min": 66.01, "cnt": 2}, "backward-params-all-reduce":{"total": 490.74, "avg": 490.74, "max": 490.74, "min": 490.74, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.06, "avg": 0.06, "max": 0.06, "min": 0.06, "cnt": 1}, "optimizer":{"total": 255.64, "avg": 255.64, "max": 255.64, "min": 255.64, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 5.50, "avg": 5.50, "max": 5.50, "min": 5.50, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 209.26, "avg": 209.26, "max": 209.26, "min": 209.26, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.78, "avg": 6.78, "max": 6.78, "min": 6.78, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.53, "avg": 3.53, "max": 3.53, "min": 3.53, "cnt": 1}}}
{"type":"time", "iteration": 17, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 62.54, "avg": 20.85, "max": 1.11, "min": 60.09, "cnt": 3}, "forward-compute":{"total": 1810.98, "avg": 56.59, "max": 49.23, "min": 63.95, "cnt": 32}, "fwd-compute":{"total": 1807.73, "avg": 56.49, "max": 49.15, "min": 63.86, "cnt": 32}, "batch-generator":{"total": 43.10, "avg": 1.35, "max": 0.74, "min": 2.99, "cnt": 32}, "fwd-embedding":{"total": 0.64, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1752.20, "avg": 54.76, "max": 48.07, "min": 62.15, "cnt": 32}, "fwd-layernorm":{"total": 9.62, "avg": 0.08, "max": 0.05, "min": 0.18, "cnt": 128}, "fwd-attn":{"total": 109.69, "avg": 0.86, "max": 0.74, "min": 1.85, "cnt": 128}, "fwd-misc":{"total": 20.83, "avg": 0.16, "max": 0.11, "min": 0.38, "cnt": 128}, "fwd-MLP":{"total": 1590.92, "avg": 12.43, "max": 10.31, "min": 21.71, "cnt": 128}, "MoE_L0_fwd":{"total": 484.47, "avg": 15.14, "max": 10.54, "min": 21.63, "cnt": 32}, "MoEMLP":{"total": 1573.59, "avg": 12.29, "max": 10.19, "min": 21.59, "cnt": 128}, "MoE_L1_fwd":{"total": 380.06, "avg": 11.88, "max": 10.88, "min": 13.99, "cnt": 32}, "MoE_L2_fwd":{"total": 371.87, "avg": 11.62, "max": 11.18, "min": 13.13, "cnt": 32}, "MoE_L3_fwd":{"total": 343.38, "avg": 10.73, "max": 10.24, "min": 11.68, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 9.35, "avg": 4.67, "max": 0.96, "min": 8.39, "cnt": 2}, "forward-send-backward-recv":{"total": 237.02, "avg": 7.90, "max": 1.24, "min": 121.25, "cnt": 30}, "backward-compute":{"total": 1721.16, "avg": 53.79, "max": 50.41, "min": 57.62, "cnt": 32}, "MoE_L3_bwd":{"total": 394.99, "avg": 12.34, "max": 11.42, "min": 15.39, "cnt": 32}, "MoE_L2_bwd":{"total": 381.64, "avg": 11.93, "max": 10.86, "min": 15.18, "cnt": 32}, "MoE_L1_bwd":{"total": 368.48, "avg": 11.51, "max": 10.92, "min": 11.89, "cnt": 32}, "MoE_L0_bwd":{"total": 361.65, "avg": 11.30, "max": 10.60, "min": 12.78, "cnt": 32}, "backward-send-forward-recv":{"total": 7277.88, "avg": 250.96, "max": 2.12, "min": 1370.38, "cnt": 29}, "backward-send":{"total": 3.18, "avg": 1.06, "max": 0.97, "min": 1.19, "cnt": 3}, "backward-recv":{"total": 125.66, "avg": 62.83, "max": 60.35, "min": 65.31, "cnt": 2}, "backward-params-all-reduce":{"total": 492.86, "avg": 492.86, "max": 492.86, "min": 492.86, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 258.84, "avg": 258.84, "max": 258.84, "min": 258.84, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 214.56, "avg": 214.56, "max": 214.56, "min": 214.56, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.86, "avg": 6.86, "max": 6.86, "min": 6.86, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 18, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 64.67, "avg": 21.56, "max": 0.97, "min": 58.13, "cnt": 3}, "forward-compute":{"total": 1806.14, "avg": 56.44, "max": 49.19, "min": 66.67, "cnt": 32}, "fwd-compute":{"total": 1803.24, "avg": 56.35, "max": 49.12, "min": 66.60, "cnt": 32}, "batch-generator":{"total": 53.31, "avg": 1.67, "max": 0.61, "min": 4.29, "cnt": 32}, "fwd-embedding":{"total": 0.59, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1737.80, "avg": 54.31, "max": 48.05, "min": 63.93, "cnt": 32}, "fwd-layernorm":{"total": 9.52, "avg": 0.07, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 106.35, "avg": 0.83, "max": 0.74, "min": 1.61, "cnt": 128}, "fwd-misc":{"total": 20.84, "avg": 0.16, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1580.83, "avg": 12.35, "max": 10.47, "min": 23.36, "cnt": 128}, "MoE_L0_fwd":{"total": 461.16, "avg": 14.41, "max": 10.63, "min": 23.28, "cnt": 32}, "MoEMLP":{"total": 1564.02, "avg": 12.22, "max": 10.35, "min": 23.24, "cnt": 128}, "MoE_L1_fwd":{"total": 390.48, "avg": 12.20, "max": 10.99, "min": 15.20, "cnt": 32}, "MoE_L2_fwd":{"total": 372.61, "avg": 11.64, "max": 10.99, "min": 14.57, "cnt": 32}, "MoE_L3_fwd":{"total": 346.04, "avg": 10.81, "max": 10.39, "min": 13.06, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 2.12, "avg": 1.06, "max": 0.85, "min": 1.27, "cnt": 2}, "forward-send-backward-recv":{"total": 446.60, "avg": 14.89, "max": 1.56, "min": 132.46, "cnt": 30}, "backward-compute":{"total": 1707.89, "avg": 53.37, "max": 50.46, "min": 55.06, "cnt": 32}, "MoE_L3_bwd":{"total": 391.00, "avg": 12.22, "max": 10.99, "min": 14.08, "cnt": 32}, "MoE_L2_bwd":{"total": 378.27, "avg": 11.82, "max": 10.79, "min": 12.88, "cnt": 32}, "MoE_L1_bwd":{"total": 368.19, "avg": 11.51, "max": 10.88, "min": 11.93, "cnt": 32}, "MoE_L0_bwd":{"total": 354.81, "avg": 11.09, "max": 10.64, "min": 11.29, "cnt": 32}, "backward-send-forward-recv":{"total": 6663.50, "avg": 229.78, "max": 1.79, "min": 905.56, "cnt": 29}, "backward-send":{"total": 3.12, "avg": 1.04, "max": 0.97, "min": 1.09, "cnt": 3}, "backward-recv":{"total": 509.42, "avg": 254.71, "max": 107.09, "min": 402.32, "cnt": 2}, "backward-params-all-reduce":{"total": 487.38, "avg": 487.38, "max": 487.38, "min": 487.38, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 259.48, "avg": 259.48, "max": 259.48, "min": 259.48, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 215.40, "avg": 215.40, "max": 215.40, "min": 215.40, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.80, "avg": 6.80, "max": 6.80, "min": 6.80, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 19, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 56.50, "avg": 18.83, "max": 0.99, "min": 54.51, "cnt": 3}, "forward-compute":{"total": 1800.35, "avg": 56.26, "max": 50.07, "min": 63.06, "cnt": 32}, "fwd-compute":{"total": 1797.17, "avg": 56.16, "max": 49.99, "min": 62.90, "cnt": 32}, "batch-generator":{"total": 64.06, "avg": 2.00, "max": 0.72, "min": 5.86, "cnt": 32}, "fwd-embedding":{"total": 0.64, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1720.64, "avg": 53.77, "max": 48.90, "min": 59.77, "cnt": 32}, "fwd-layernorm":{"total": 10.30, "avg": 0.08, "max": 0.05, "min": 0.26, "cnt": 128}, "fwd-attn":{"total": 110.28, "avg": 0.86, "max": 0.74, "min": 2.27, "cnt": 128}, "fwd-misc":{"total": 22.34, "avg": 0.17, "max": 0.11, "min": 0.45, "cnt": 128}, "fwd-MLP":{"total": 1555.87, "avg": 12.16, "max": 10.47, "min": 18.51, "cnt": 128}, "MoE_L0_fwd":{"total": 432.74, "avg": 13.52, "max": 10.46, "min": 18.42, "cnt": 32}, "MoEMLP":{"total": 1538.14, "avg": 12.02, "max": 10.37, "min": 18.37, "cnt": 128}, "MoE_L1_fwd":{"total": 394.75, "avg": 12.34, "max": 11.12, "min": 16.06, "cnt": 32}, "MoE_L2_fwd":{"total": 367.59, "avg": 11.49, "max": 11.08, "min": 12.83, "cnt": 32}, "MoE_L3_fwd":{"total": 349.58, "avg": 10.92, "max": 10.41, "min": 14.66, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 2.38, "avg": 1.19, "max": 0.83, "min": 1.55, "cnt": 2}, "forward-send-backward-recv":{"total": 229.52, "avg": 7.65, "max": 1.21, "min": 121.94, "cnt": 30}, "backward-compute":{"total": 1709.75, "avg": 53.43, "max": 51.62, "min": 55.10, "cnt": 32}, "MoE_L3_bwd":{"total": 395.30, "avg": 12.35, "max": 11.31, "min": 13.31, "cnt": 32}, "MoE_L2_bwd":{"total": 380.91, "avg": 11.90, "max": 11.19, "min": 12.54, "cnt": 32}, "MoE_L1_bwd":{"total": 368.56, "avg": 11.52, "max": 11.00, "min": 11.86, "cnt": 32}, "MoE_L0_bwd":{"total": 351.92, "avg": 11.00, "max": 10.39, "min": 11.94, "cnt": 32}, "backward-send-forward-recv":{"total": 7536.17, "avg": 259.87, "max": 2.17, "min": 1004.02, "cnt": 29}, "backward-send":{"total": 2.90, "avg": 0.97, "max": 0.92, "min": 0.99, "cnt": 3}, "backward-recv":{"total": 139.12, "avg": 69.56, "max": 67.95, "min": 71.17, "cnt": 2}, "backward-params-all-reduce":{"total": 490.52, "avg": 490.52, "max": 490.52, "min": 490.52, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 257.36, "avg": 257.36, "max": 257.36, "min": 257.36, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 213.22, "avg": 213.22, "max": 213.22, "min": 213.22, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.79, "avg": 6.79, "max": 6.79, "min": 6.79, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}}}
{"type":"time", "iteration": 20, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 58.37, "avg": 19.46, "max": 0.86, "min": 56.51, "cnt": 3}, "forward-compute":{"total": 1925.79, "avg": 60.18, "max": 50.20, "min": 132.51, "cnt": 32}, "fwd-compute":{"total": 1923.05, "avg": 60.10, "max": 50.12, "min": 132.43, "cnt": 32}, "batch-generator":{"total": 51.86, "avg": 1.62, "max": 0.62, "min": 4.19, "cnt": 32}, "fwd-embedding":{"total": 0.55, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1859.26, "avg": 58.10, "max": 48.93, "min": 131.12, "cnt": 32}, "fwd-layernorm":{"total": 9.43, "avg": 0.07, "max": 0.05, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 105.45, "avg": 0.82, "max": 0.74, "min": 1.50, "cnt": 128}, "fwd-misc":{"total": 20.87, "avg": 0.16, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1702.57, "avg": 13.30, "max": 10.70, "min": 92.92, "cnt": 128}, "MoE_L0_fwd":{"total": 466.35, "avg": 14.57, "max": 10.75, "min": 21.46, "cnt": 32}, "MoEMLP":{"total": 1685.02, "avg": 13.16, "max": 10.51, "min": 92.80, "cnt": 128}, "MoE_L1_fwd":{"total": 401.90, "avg": 12.56, "max": 11.26, "min": 17.73, "cnt": 32}, "MoE_L2_fwd":{"total": 381.65, "avg": 11.93, "max": 11.22, "min": 16.94, "cnt": 32}, "MoE_L3_fwd":{"total": 441.36, "avg": 13.79, "max": 10.55, "min": 92.84, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 2.89, "avg": 1.44, "max": 0.47, "min": 2.42, "cnt": 2}, "forward-send-backward-recv":{"total": 642.32, "avg": 21.41, "max": 1.25, "min": 201.30, "cnt": 30}, "backward-compute":{"total": 1715.30, "avg": 53.60, "max": 50.77, "min": 54.84, "cnt": 32}, "MoE_L3_bwd":{"total": 400.27, "avg": 12.51, "max": 11.91, "min": 13.86, "cnt": 32}, "MoE_L2_bwd":{"total": 378.98, "avg": 11.84, "max": 10.98, "min": 12.60, "cnt": 32}, "MoE_L1_bwd":{"total": 370.05, "avg": 11.56, "max": 10.88, "min": 12.77, "cnt": 32}, "MoE_L0_bwd":{"total": 351.44, "avg": 10.98, "max": 10.58, "min": 11.67, "cnt": 32}, "backward-send-forward-recv":{"total": 5176.74, "avg": 178.51, "max": 2.10, "min": 457.83, "cnt": 29}, "backward-send":{"total": 2.85, "avg": 0.95, "max": 0.94, "min": 0.97, "cnt": 3}, "backward-recv":{"total": 319.60, "avg": 159.80, "max": 70.22, "min": 249.38, "cnt": 2}, "backward-params-all-reduce":{"total": 496.15, "avg": 496.15, "max": 496.15, "min": 496.15, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 254.43, "avg": 254.43, "max": 254.43, "min": 254.43, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 210.35, "avg": 210.35, "max": 210.35, "min": 210.35, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.82, "avg": 6.82, "max": 6.82, "min": 6.82, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 21, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.06, "avg": 0.06, "max": 0.06, "min": 0.06, "cnt": 1}, "forward-recv":{"total": 71.27, "avg": 23.76, "max": 0.99, "min": 69.26, "cnt": 3}, "forward-compute":{"total": 1796.73, "avg": 56.15, "max": 50.04, "min": 62.38, "cnt": 32}, "fwd-compute":{"total": 1794.03, "avg": 56.06, "max": 49.94, "min": 62.29, "cnt": 32}, "batch-generator":{"total": 45.21, "avg": 1.41, "max": 0.62, "min": 4.15, "cnt": 32}, "fwd-embedding":{"total": 0.55, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1737.10, "avg": 54.28, "max": 48.87, "min": 58.71, "cnt": 32}, "fwd-layernorm":{"total": 9.31, "avg": 0.07, "max": 0.05, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 106.66, "avg": 0.83, "max": 0.74, "min": 1.80, "cnt": 128}, "fwd-misc":{"total": 20.74, "avg": 0.16, "max": 0.11, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1580.05, "avg": 12.34, "max": 10.77, "min": 18.12, "cnt": 128}, "MoE_L0_fwd":{"total": 447.87, "avg": 14.00, "max": 10.70, "min": 18.05, "cnt": 32}, "MoEMLP":{"total": 1563.43, "avg": 12.21, "max": 10.66, "min": 18.00, "cnt": 128}, "MoE_L1_fwd":{"total": 388.85, "avg": 12.15, "max": 10.94, "min": 14.62, "cnt": 32}, "MoE_L2_fwd":{"total": 371.13, "avg": 11.60, "max": 10.90, "min": 13.30, "cnt": 32}, "MoE_L3_fwd":{"total": 361.68, "avg": 11.30, "max": 10.76, "min": 14.50, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.52, "avg": 0.76, "max": 0.61, "min": 0.92, "cnt": 2}, "forward-send-backward-recv":{"total": 502.27, "avg": 16.74, "max": 1.32, "min": 133.56, "cnt": 30}, "backward-compute":{"total": 1732.79, "avg": 54.15, "max": 51.29, "min": 55.65, "cnt": 32}, "MoE_L3_bwd":{"total": 413.86, "avg": 12.93, "max": 11.95, "min": 14.53, "cnt": 32}, "MoE_L2_bwd":{"total": 379.13, "avg": 11.85, "max": 10.79, "min": 13.49, "cnt": 32}, "MoE_L1_bwd":{"total": 367.89, "avg": 11.50, "max": 10.92, "min": 11.81, "cnt": 32}, "MoE_L0_bwd":{"total": 357.76, "avg": 11.18, "max": 10.51, "min": 11.83, "cnt": 32}, "backward-send-forward-recv":{"total": 6929.00, "avg": 238.93, "max": 2.26, "min": 1068.90, "cnt": 29}, "backward-send":{"total": 1.61, "avg": 0.54, "max": 0.47, "min": 0.59, "cnt": 3}, "backward-recv":{"total": 663.69, "avg": 331.84, "max": 71.71, "min": 591.98, "cnt": 2}, "backward-params-all-reduce":{"total": 484.85, "avg": 484.85, "max": 484.85, "min": 484.85, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 265.51, "avg": 265.51, "max": 265.51, "min": 265.51, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 221.43, "avg": 221.43, "max": 221.43, "min": 221.43, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.86, "avg": 6.86, "max": 6.86, "min": 6.86, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}}}
{"type":"time", "iteration": 22, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 68.24, "avg": 22.75, "max": 0.87, "min": 64.44, "cnt": 3}, "forward-compute":{"total": 1817.11, "avg": 56.78, "max": 49.64, "min": 69.26, "cnt": 32}, "fwd-compute":{"total": 1814.21, "avg": 56.69, "max": 49.57, "min": 69.18, "cnt": 32}, "batch-generator":{"total": 39.62, "avg": 1.24, "max": 0.67, "min": 2.53, "cnt": 32}, "fwd-embedding":{"total": 0.54, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1762.93, "avg": 55.09, "max": 48.53, "min": 67.92, "cnt": 32}, "fwd-layernorm":{"total": 9.21, "avg": 0.07, "max": 0.05, "min": 0.18, "cnt": 128}, "fwd-attn":{"total": 107.08, "avg": 0.84, "max": 0.74, "min": 1.49, "cnt": 128}, "fwd-misc":{"total": 19.81, "avg": 0.15, "max": 0.11, "min": 0.34, "cnt": 128}, "fwd-MLP":{"total": 1606.52, "avg": 12.55, "max": 10.62, "min": 19.85, "cnt": 128}, "MoE_L0_fwd":{"total": 457.35, "avg": 14.29, "max": 10.55, "min": 19.74, "cnt": 32}, "MoEMLP":{"total": 1589.21, "avg": 12.42, "max": 10.50, "min": 19.70, "cnt": 128}, "MoE_L1_fwd":{"total": 386.14, "avg": 12.07, "max": 10.91, "min": 16.13, "cnt": 32}, "MoE_L2_fwd":{"total": 377.20, "avg": 11.79, "max": 11.12, "min": 15.49, "cnt": 32}, "MoE_L3_fwd":{"total": 374.49, "avg": 11.70, "max": 11.15, "min": 13.67, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.56, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 9.13, "avg": 4.57, "max": 0.86, "min": 8.27, "cnt": 2}, "forward-send-backward-recv":{"total": 207.81, "avg": 6.93, "max": 1.38, "min": 130.67, "cnt": 30}, "backward-compute":{"total": 1747.34, "avg": 54.60, "max": 52.25, "min": 56.47, "cnt": 32}, "MoE_L3_bwd":{"total": 419.85, "avg": 13.12, "max": 12.25, "min": 15.02, "cnt": 32}, "MoE_L2_bwd":{"total": 381.09, "avg": 11.91, "max": 11.08, "min": 12.45, "cnt": 32}, "MoE_L1_bwd":{"total": 367.83, "avg": 11.49, "max": 10.88, "min": 12.46, "cnt": 32}, "MoE_L0_bwd":{"total": 367.87, "avg": 11.50, "max": 10.92, "min": 12.74, "cnt": 32}, "backward-send-forward-recv":{"total": 6639.73, "avg": 228.96, "max": 2.08, "min": 1228.37, "cnt": 29}, "backward-send":{"total": 2.39, "avg": 0.80, "max": 0.55, "min": 1.17, "cnt": 3}, "backward-recv":{"total": 138.44, "avg": 69.22, "max": 66.57, "min": 71.87, "cnt": 2}, "backward-params-all-reduce":{"total": 488.16, "avg": 488.16, "max": 488.16, "min": 488.16, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 258.72, "avg": 258.72, "max": 258.72, "min": 258.72, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 214.44, "avg": 214.44, "max": 214.44, "min": 214.44, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.87, "avg": 6.87, "max": 6.87, "min": 6.87, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.47, "avg": 3.47, "max": 3.47, "min": 3.47, "cnt": 1}}}
{"type":"time", "iteration": 23, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 80.86, "avg": 26.95, "max": 2.85, "min": 73.28, "cnt": 3}, "forward-compute":{"total": 1803.84, "avg": 56.37, "max": 50.86, "min": 64.34, "cnt": 32}, "fwd-compute":{"total": 1800.96, "avg": 56.28, "max": 50.78, "min": 64.27, "cnt": 32}, "batch-generator":{"total": 57.09, "avg": 1.78, "max": 0.73, "min": 10.12, "cnt": 32}, "fwd-embedding":{"total": 0.60, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1732.08, "avg": 54.13, "max": 49.72, "min": 59.40, "cnt": 32}, "fwd-layernorm":{"total": 9.35, "avg": 0.07, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 105.91, "avg": 0.83, "max": 0.74, "min": 1.61, "cnt": 128}, "fwd-misc":{"total": 20.42, "avg": 0.16, "max": 0.11, "min": 0.34, "cnt": 128}, "fwd-MLP":{"total": 1576.07, "avg": 12.31, "max": 10.91, "min": 20.18, "cnt": 128}, "MoE_L0_fwd":{"total": 460.86, "avg": 14.40, "max": 11.32, "min": 20.10, "cnt": 32}, "MoEMLP":{"total": 1559.55, "avg": 12.18, "max": 10.80, "min": 20.06, "cnt": 128}, "MoE_L1_fwd":{"total": 380.39, "avg": 11.89, "max": 11.12, "min": 14.53, "cnt": 32}, "MoE_L2_fwd":{"total": 366.06, "avg": 11.44, "max": 11.09, "min": 12.60, "cnt": 32}, "MoE_L3_fwd":{"total": 358.29, "avg": 11.20, "max": 10.84, "min": 11.98, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.85, "avg": 0.92, "max": 0.92, "min": 0.93, "cnt": 2}, "forward-send-backward-recv":{"total": 851.26, "avg": 28.38, "max": 1.33, "min": 147.68, "cnt": 30}, "backward-compute":{"total": 1753.14, "avg": 54.79, "max": 52.14, "min": 56.35, "cnt": 32}, "MoE_L3_bwd":{"total": 414.72, "avg": 12.96, "max": 11.75, "min": 14.15, "cnt": 32}, "MoE_L2_bwd":{"total": 381.44, "avg": 11.92, "max": 11.28, "min": 12.48, "cnt": 32}, "MoE_L1_bwd":{"total": 368.64, "avg": 11.52, "max": 10.73, "min": 11.87, "cnt": 32}, "MoE_L0_bwd":{"total": 372.12, "avg": 11.63, "max": 10.79, "min": 12.92, "cnt": 32}, "backward-send-forward-recv":{"total": 4406.32, "avg": 151.94, "max": 2.18, "min": 495.23, "cnt": 29}, "backward-send":{"total": 2.52, "avg": 0.84, "max": 0.70, "min": 0.98, "cnt": 3}, "backward-recv":{"total": 326.52, "avg": 163.26, "max": 62.45, "min": 264.07, "cnt": 2}, "backward-params-all-reduce":{"total": 489.28, "avg": 489.28, "max": 489.28, "min": 489.28, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 296.74, "avg": 296.74, "max": 296.74, "min": 296.74, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 252.37, "avg": 252.37, "max": 252.37, "min": 252.37, "cnt": 1}, "optimizer-clip-main-grad":{"total": 7.05, "avg": 7.05, "max": 7.05, "min": 7.05, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 24, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 1009.27, "avg": 336.42, "max": 1.01, "min": 1007.10, "cnt": 3}, "forward-compute":{"total": 1862.95, "avg": 58.22, "max": 50.01, "min": 68.02, "cnt": 32}, "fwd-compute":{"total": 1860.05, "avg": 58.13, "max": 49.94, "min": 67.95, "cnt": 32}, "batch-generator":{"total": 43.47, "avg": 1.36, "max": 0.70, "min": 3.63, "cnt": 32}, "fwd-embedding":{"total": 0.55, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1804.60, "avg": 56.39, "max": 48.89, "min": 66.69, "cnt": 32}, "fwd-layernorm":{"total": 9.62, "avg": 0.08, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 110.27, "avg": 0.86, "max": 0.74, "min": 1.92, "cnt": 128}, "fwd-misc":{"total": 21.85, "avg": 0.17, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1641.42, "avg": 12.82, "max": 10.67, "min": 23.52, "cnt": 128}, "MoE_L0_fwd":{"total": 481.51, "avg": 15.05, "max": 11.08, "min": 23.44, "cnt": 32}, "MoEMLP":{"total": 1623.75, "avg": 12.69, "max": 10.55, "min": 23.40, "cnt": 128}, "MoE_L1_fwd":{"total": 404.06, "avg": 12.63, "max": 11.13, "min": 16.84, "cnt": 32}, "MoE_L2_fwd":{"total": 382.48, "avg": 11.95, "max": 11.12, "min": 14.44, "cnt": 32}, "MoE_L3_fwd":{"total": 362.11, "avg": 11.32, "max": 10.59, "min": 14.13, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.89, "avg": 0.95, "max": 0.94, "min": 0.96, "cnt": 2}, "forward-send-backward-recv":{"total": 233.29, "avg": 7.78, "max": 1.28, "min": 132.79, "cnt": 30}, "backward-compute":{"total": 1746.15, "avg": 54.57, "max": 50.43, "min": 57.39, "cnt": 32}, "MoE_L3_bwd":{"total": 404.28, "avg": 12.63, "max": 11.32, "min": 14.02, "cnt": 32}, "MoE_L2_bwd":{"total": 385.56, "avg": 12.05, "max": 11.32, "min": 14.03, "cnt": 32}, "MoE_L1_bwd":{"total": 368.34, "avg": 11.51, "max": 10.85, "min": 12.13, "cnt": 32}, "MoE_L0_bwd":{"total": 373.97, "avg": 11.69, "max": 10.61, "min": 14.89, "cnt": 32}, "backward-send-forward-recv":{"total": 4876.61, "avg": 168.16, "max": 2.49, "min": 339.59, "cnt": 29}, "backward-send":{"total": 3.07, "avg": 1.02, "max": 0.88, "min": 1.12, "cnt": 3}, "backward-recv":{"total": 137.45, "avg": 68.73, "max": 68.60, "min": 68.86, "cnt": 2}, "backward-params-all-reduce":{"total": 490.88, "avg": 490.88, "max": 490.88, "min": 490.88, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 265.12, "avg": 265.12, "max": 265.12, "min": 265.12, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 220.64, "avg": 220.64, "max": 220.64, "min": 220.64, "cnt": 1}, "optimizer-clip-main-grad":{"total": 7.10, "avg": 7.10, "max": 7.10, "min": 7.10, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 25, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 72.85, "avg": 24.28, "max": 0.96, "min": 63.69, "cnt": 3}, "forward-compute":{"total": 1827.42, "avg": 57.11, "max": 49.71, "min": 70.94, "cnt": 32}, "fwd-compute":{"total": 1824.67, "avg": 57.02, "max": 49.64, "min": 70.87, "cnt": 32}, "batch-generator":{"total": 51.67, "avg": 1.61, "max": 0.62, "min": 3.26, "cnt": 32}, "fwd-embedding":{"total": 0.50, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1761.02, "avg": 55.03, "max": 48.73, "min": 67.47, "cnt": 32}, "fwd-layernorm":{"total": 8.90, "avg": 0.07, "max": 0.05, "min": 0.18, "cnt": 128}, "fwd-attn":{"total": 101.59, "avg": 0.79, "max": 0.74, "min": 1.46, "cnt": 128}, "fwd-misc":{"total": 19.85, "avg": 0.16, "max": 0.11, "min": 0.34, "cnt": 128}, "fwd-MLP":{"total": 1610.77, "avg": 12.58, "max": 10.43, "min": 24.69, "cnt": 128}, "MoE_L0_fwd":{"total": 480.64, "avg": 15.02, "max": 10.52, "min": 24.59, "cnt": 32}, "MoEMLP":{"total": 1594.60, "avg": 12.46, "max": 10.32, "min": 24.54, "cnt": 128}, "MoE_L1_fwd":{"total": 396.14, "avg": 12.38, "max": 11.05, "min": 20.19, "cnt": 32}, "MoE_L2_fwd":{"total": 371.25, "avg": 11.60, "max": 11.13, "min": 13.44, "cnt": 32}, "MoE_L3_fwd":{"total": 352.52, "avg": 11.02, "max": 10.36, "min": 13.46, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.77, "avg": 0.88, "max": 0.85, "min": 0.92, "cnt": 2}, "forward-send-backward-recv":{"total": 203.12, "avg": 6.77, "max": 1.36, "min": 123.47, "cnt": 30}, "backward-compute":{"total": 1721.01, "avg": 53.78, "max": 50.39, "min": 56.00, "cnt": 32}, "MoE_L3_bwd":{"total": 402.47, "avg": 12.58, "max": 11.48, "min": 14.43, "cnt": 32}, "MoE_L2_bwd":{"total": 375.79, "avg": 11.74, "max": 11.06, "min": 12.48, "cnt": 32}, "MoE_L1_bwd":{"total": 366.77, "avg": 11.46, "max": 10.78, "min": 11.88, "cnt": 32}, "MoE_L0_bwd":{"total": 360.01, "avg": 11.25, "max": 10.39, "min": 11.58, "cnt": 32}, "backward-send-forward-recv":{"total": 6824.56, "avg": 235.33, "max": 2.41, "min": 806.38, "cnt": 29}, "backward-send":{"total": 2.90, "avg": 0.97, "max": 0.69, "min": 1.18, "cnt": 3}, "backward-recv":{"total": 145.86, "avg": 72.93, "max": 69.43, "min": 76.43, "cnt": 2}, "backward-params-all-reduce":{"total": 493.04, "avg": 493.04, "max": 493.04, "min": 493.04, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 264.43, "avg": 264.43, "max": 264.43, "min": 264.43, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 220.37, "avg": 220.37, "max": 220.37, "min": 220.37, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.79, "avg": 6.79, "max": 6.79, "min": 6.79, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 26, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 76.10, "avg": 25.37, "max": 0.92, "min": 74.07, "cnt": 3}, "forward-compute":{"total": 1766.96, "avg": 55.22, "max": 49.37, "min": 68.14, "cnt": 32}, "fwd-compute":{"total": 1764.22, "avg": 55.13, "max": 49.30, "min": 68.05, "cnt": 32}, "batch-generator":{"total": 45.57, "avg": 1.42, "max": 0.70, "min": 3.29, "cnt": 32}, "fwd-embedding":{"total": 0.48, "avg": 0.01, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1707.46, "avg": 53.36, "max": 48.21, "min": 66.00, "cnt": 32}, "fwd-layernorm":{"total": 8.61, "avg": 0.07, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 103.08, "avg": 0.81, "max": 0.74, "min": 1.82, "cnt": 128}, "fwd-misc":{"total": 19.32, "avg": 0.15, "max": 0.11, "min": 0.39, "cnt": 128}, "fwd-MLP":{"total": 1557.12, "avg": 12.17, "max": 10.35, "min": 24.58, "cnt": 128}, "MoE_L0_fwd":{"total": 443.39, "avg": 13.86, "max": 10.67, "min": 24.42, "cnt": 32}, "MoEMLP":{"total": 1541.27, "avg": 12.04, "max": 10.24, "min": 24.34, "cnt": 128}, "MoE_L1_fwd":{"total": 384.18, "avg": 12.01, "max": 10.85, "min": 16.92, "cnt": 32}, "MoE_L2_fwd":{"total": 376.28, "avg": 11.76, "max": 10.80, "min": 15.56, "cnt": 32}, "MoE_L3_fwd":{"total": 343.14, "avg": 10.72, "max": 10.28, "min": 11.43, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.56, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 7.21, "avg": 3.60, "max": 0.87, "min": 6.34, "cnt": 2}, "forward-send-backward-recv":{"total": 417.14, "avg": 13.90, "max": 1.24, "min": 177.04, "cnt": 30}, "backward-compute":{"total": 1767.40, "avg": 55.23, "max": 50.96, "min": 106.19, "cnt": 32}, "MoE_L3_bwd":{"total": 453.16, "avg": 14.16, "max": 11.87, "min": 66.03, "cnt": 32}, "MoE_L2_bwd":{"total": 377.73, "avg": 11.80, "max": 11.01, "min": 12.51, "cnt": 32}, "MoE_L1_bwd":{"total": 367.89, "avg": 11.50, "max": 11.06, "min": 11.84, "cnt": 32}, "MoE_L0_bwd":{"total": 355.39, "avg": 11.11, "max": 10.34, "min": 12.20, "cnt": 32}, "backward-send-forward-recv":{"total": 8225.06, "avg": 283.62, "max": 2.20, "min": 673.93, "cnt": 29}, "backward-send":{"total": 3.03, "avg": 1.01, "max": 0.79, "min": 1.18, "cnt": 3}, "backward-recv":{"total": 145.61, "avg": 72.81, "max": 66.03, "min": 79.58, "cnt": 2}, "backward-params-all-reduce":{"total": 486.12, "avg": 486.12, "max": 486.12, "min": 486.12, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 263.55, "avg": 263.55, "max": 263.55, "min": 263.55, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 219.30, "avg": 219.30, "max": 219.30, "min": 219.30, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.82, "avg": 6.82, "max": 6.82, "min": 6.82, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.49, "avg": 3.49, "max": 3.49, "min": 3.49, "cnt": 1}}}
{"type":"time", "iteration": 27, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 830.02, "avg": 276.67, "max": 58.39, "min": 703.05, "cnt": 3}, "forward-compute":{"total": 1790.91, "avg": 55.97, "max": 49.37, "min": 61.07, "cnt": 32}, "fwd-compute":{"total": 1787.83, "avg": 55.87, "max": 49.30, "min": 60.99, "cnt": 32}, "batch-generator":{"total": 48.17, "avg": 1.51, "max": 0.69, "min": 3.90, "cnt": 32}, "fwd-embedding":{"total": 0.61, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1727.32, "avg": 53.98, "max": 48.26, "min": 59.65, "cnt": 32}, "fwd-layernorm":{"total": 9.61, "avg": 0.08, "max": 0.05, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 107.13, "avg": 0.84, "max": 0.74, "min": 1.74, "cnt": 128}, "fwd-misc":{"total": 20.92, "avg": 0.16, "max": 0.11, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1568.78, "avg": 12.26, "max": 10.51, "min": 18.98, "cnt": 128}, "MoE_L0_fwd":{"total": 435.19, "avg": 13.60, "max": 10.43, "min": 18.90, "cnt": 32}, "MoEMLP":{"total": 1551.84, "avg": 12.12, "max": 10.38, "min": 18.86, "cnt": 128}, "MoE_L1_fwd":{"total": 384.73, "avg": 12.02, "max": 11.06, "min": 14.61, "cnt": 32}, "MoE_L2_fwd":{"total": 375.10, "avg": 11.72, "max": 10.89, "min": 18.22, "cnt": 32}, "MoE_L3_fwd":{"total": 363.08, "avg": 11.35, "max": 10.48, "min": 14.82, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.55, "avg": 0.78, "max": 0.73, "min": 0.82, "cnt": 2}, "forward-send-backward-recv":{"total": 1665.57, "avg": 55.52, "max": 1.42, "min": 304.92, "cnt": 30}, "backward-compute":{"total": 1724.88, "avg": 53.90, "max": 50.96, "min": 55.36, "cnt": 32}, "MoE_L3_bwd":{"total": 402.80, "avg": 12.59, "max": 11.49, "min": 13.73, "cnt": 32}, "MoE_L2_bwd":{"total": 379.73, "avg": 11.87, "max": 10.95, "min": 13.58, "cnt": 32}, "MoE_L1_bwd":{"total": 369.89, "avg": 11.56, "max": 11.06, "min": 12.80, "cnt": 32}, "MoE_L0_bwd":{"total": 356.84, "avg": 11.15, "max": 10.37, "min": 12.98, "cnt": 32}, "backward-send-forward-recv":{"total": 4372.36, "avg": 150.77, "max": 1.97, "min": 952.57, "cnt": 29}, "backward-send":{"total": 1.37, "avg": 0.46, "max": 0.45, "min": 0.47, "cnt": 3}, "backward-recv":{"total": 425.45, "avg": 212.73, "max": 162.34, "min": 263.11, "cnt": 2}, "backward-params-all-reduce":{"total": 486.74, "avg": 486.74, "max": 486.74, "min": 486.74, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 267.47, "avg": 267.47, "max": 267.47, "min": 267.47, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 223.36, "avg": 223.36, "max": 223.36, "min": 223.36, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.75, "avg": 6.75, "max": 6.75, "min": 6.75, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 28, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 67.59, "avg": 22.53, "max": 3.09, "min": 58.41, "cnt": 3}, "forward-compute":{"total": 1782.01, "avg": 55.69, "max": 49.56, "min": 63.64, "cnt": 32}, "fwd-compute":{"total": 1778.68, "avg": 55.58, "max": 49.49, "min": 63.55, "cnt": 32}, "batch-generator":{"total": 50.89, "avg": 1.59, "max": 0.66, "min": 3.66, "cnt": 32}, "fwd-embedding":{"total": 0.74, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1714.89, "avg": 53.59, "max": 48.44, "min": 61.10, "cnt": 32}, "fwd-layernorm":{"total": 10.87, "avg": 0.08, "max": 0.05, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 113.04, "avg": 0.88, "max": 0.74, "min": 1.61, "cnt": 128}, "fwd-misc":{"total": 22.77, "avg": 0.18, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1545.08, "avg": 12.07, "max": 10.46, "min": 19.62, "cnt": 128}, "MoE_L0_fwd":{"total": 423.42, "avg": 13.23, "max": 10.37, "min": 19.53, "cnt": 32}, "MoEMLP":{"total": 1526.38, "avg": 11.92, "max": 10.32, "min": 19.48, "cnt": 128}, "MoE_L1_fwd":{"total": 390.38, "avg": 12.20, "max": 11.09, "min": 14.68, "cnt": 32}, "MoE_L2_fwd":{"total": 366.55, "avg": 11.45, "max": 10.95, "min": 12.60, "cnt": 32}, "MoE_L3_fwd":{"total": 352.79, "avg": 11.02, "max": 10.50, "min": 12.19, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 2.59, "avg": 1.29, "max": 0.91, "min": 1.68, "cnt": 2}, "forward-send-backward-recv":{"total": 495.40, "avg": 16.51, "max": 1.49, "min": 188.88, "cnt": 30}, "backward-compute":{"total": 1737.85, "avg": 54.31, "max": 49.93, "min": 56.23, "cnt": 32}, "MoE_L3_bwd":{"total": 415.80, "avg": 12.99, "max": 11.94, "min": 14.68, "cnt": 32}, "MoE_L2_bwd":{"total": 386.56, "avg": 12.08, "max": 10.53, "min": 12.88, "cnt": 32}, "MoE_L1_bwd":{"total": 370.17, "avg": 11.57, "max": 10.76, "min": 12.69, "cnt": 32}, "MoE_L0_bwd":{"total": 354.33, "avg": 11.07, "max": 10.24, "min": 12.51, "cnt": 32}, "backward-send-forward-recv":{"total": 5968.06, "avg": 205.80, "max": 1.92, "min": 758.43, "cnt": 29}, "backward-send":{"total": 2.16, "avg": 0.72, "max": 0.54, "min": 0.92, "cnt": 3}, "backward-recv":{"total": 140.70, "avg": 70.35, "max": 64.66, "min": 76.04, "cnt": 2}, "backward-params-all-reduce":{"total": 501.66, "avg": 501.66, "max": 501.66, "min": 501.66, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 253.18, "avg": 253.18, "max": 253.18, "min": 253.18, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 208.95, "avg": 208.95, "max": 208.95, "min": 208.95, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.90, "avg": 6.90, "max": 6.90, "min": 6.90, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 29, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 77.21, "avg": 25.74, "max": 1.42, "min": 64.72, "cnt": 3}, "forward-compute":{"total": 1835.36, "avg": 57.36, "max": 50.71, "min": 67.95, "cnt": 32}, "fwd-compute":{"total": 1832.50, "avg": 57.27, "max": 50.63, "min": 67.87, "cnt": 32}, "batch-generator":{"total": 40.00, "avg": 1.25, "max": 0.72, "min": 2.51, "cnt": 32}, "fwd-embedding":{"total": 0.59, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1780.56, "avg": 55.64, "max": 49.39, "min": 65.76, "cnt": 32}, "fwd-layernorm":{"total": 9.41, "avg": 0.07, "max": 0.05, "min": 0.22, "cnt": 128}, "fwd-attn":{"total": 105.01, "avg": 0.82, "max": 0.74, "min": 1.73, "cnt": 128}, "fwd-misc":{"total": 21.18, "avg": 0.17, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1623.93, "avg": 12.69, "max": 10.66, "min": 23.52, "cnt": 128}, "MoE_L0_fwd":{"total": 462.88, "avg": 14.46, "max": 10.82, "min": 23.44, "cnt": 32}, "MoEMLP":{"total": 1606.81, "avg": 12.55, "max": 10.55, "min": 23.40, "cnt": 128}, "MoE_L1_fwd":{"total": 403.88, "avg": 12.62, "max": 11.33, "min": 16.29, "cnt": 32}, "MoE_L2_fwd":{"total": 383.40, "avg": 11.98, "max": 10.87, "min": 15.08, "cnt": 32}, "MoE_L3_fwd":{"total": 362.84, "avg": 11.34, "max": 10.59, "min": 14.79, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.82, "avg": 0.91, "max": 0.91, "min": 0.91, "cnt": 2}, "forward-send-backward-recv":{"total": 199.53, "avg": 6.65, "max": 1.85, "min": 111.66, "cnt": 30}, "backward-compute":{"total": 1718.34, "avg": 53.70, "max": 51.40, "min": 55.74, "cnt": 32}, "MoE_L3_bwd":{"total": 413.04, "avg": 12.91, "max": 12.18, "min": 14.29, "cnt": 32}, "MoE_L2_bwd":{"total": 374.10, "avg": 11.69, "max": 11.05, "min": 12.69, "cnt": 32}, "MoE_L1_bwd":{"total": 370.26, "avg": 11.57, "max": 10.83, "min": 12.24, "cnt": 32}, "MoE_L0_bwd":{"total": 345.70, "avg": 10.80, "max": 10.19, "min": 11.53, "cnt": 32}, "backward-send-forward-recv":{"total": 6485.23, "avg": 223.63, "max": 2.21, "min": 1305.18, "cnt": 29}, "backward-send":{"total": 2.12, "avg": 0.71, "max": 0.48, "min": 0.93, "cnt": 3}, "backward-recv":{"total": 153.81, "avg": 76.91, "max": 76.84, "min": 76.97, "cnt": 2}, "backward-params-all-reduce":{"total": 487.17, "avg": 487.17, "max": 487.17, "min": 487.17, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 262.56, "avg": 262.56, "max": 262.56, "min": 262.56, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 218.52, "avg": 218.52, "max": 218.52, "min": 218.52, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.75, "avg": 6.75, "max": 6.75, "min": 6.75, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.52, "avg": 3.52, "max": 3.52, "min": 3.52, "cnt": 1}}}
{"type":"time", "iteration": 30, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 76.20, "avg": 25.40, "max": 5.52, "min": 63.64, "cnt": 3}, "forward-compute":{"total": 1760.99, "avg": 55.03, "max": 49.75, "min": 62.71, "cnt": 32}, "fwd-compute":{"total": 1757.65, "avg": 54.93, "max": 49.67, "min": 62.54, "cnt": 32}, "batch-generator":{"total": 43.69, "avg": 1.37, "max": 0.77, "min": 4.26, "cnt": 32}, "fwd-embedding":{"total": 0.60, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1701.01, "avg": 53.16, "max": 48.53, "min": 59.03, "cnt": 32}, "fwd-layernorm":{"total": 9.64, "avg": 0.08, "max": 0.06, "min": 0.27, "cnt": 128}, "fwd-attn":{"total": 107.22, "avg": 0.84, "max": 0.74, "min": 2.80, "cnt": 128}, "fwd-misc":{"total": 21.94, "avg": 0.17, "max": 0.12, "min": 0.64, "cnt": 128}, "fwd-MLP":{"total": 1540.95, "avg": 12.04, "max": 10.40, "min": 19.57, "cnt": 128}, "MoE_L0_fwd":{"total": 426.96, "avg": 13.34, "max": 10.32, "min": 19.47, "cnt": 32}, "MoEMLP":{"total": 1523.63, "avg": 11.90, "max": 10.27, "min": 19.42, "cnt": 128}, "MoE_L1_fwd":{"total": 383.25, "avg": 11.98, "max": 11.20, "min": 13.42, "cnt": 32}, "MoE_L2_fwd":{"total": 364.64, "avg": 11.39, "max": 10.90, "min": 12.31, "cnt": 32}, "MoE_L3_fwd":{"total": 355.06, "avg": 11.10, "max": 10.64, "min": 13.01, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 2.00, "avg": 1.00, "max": 0.99, "min": 1.01, "cnt": 2}, "forward-send-backward-recv":{"total": 225.03, "avg": 7.50, "max": 1.86, "min": 132.06, "cnt": 30}, "backward-compute":{"total": 1729.12, "avg": 54.04, "max": 52.14, "min": 56.48, "cnt": 32}, "MoE_L3_bwd":{"total": 414.31, "avg": 12.95, "max": 11.70, "min": 16.30, "cnt": 32}, "MoE_L2_bwd":{"total": 374.86, "avg": 11.71, "max": 10.05, "min": 13.79, "cnt": 32}, "MoE_L1_bwd":{"total": 367.04, "avg": 11.47, "max": 10.83, "min": 11.77, "cnt": 32}, "MoE_L0_bwd":{"total": 355.51, "avg": 11.11, "max": 10.22, "min": 13.43, "cnt": 32}, "backward-send-forward-recv":{"total": 5523.72, "avg": 190.47, "max": 2.49, "min": 749.56, "cnt": 29}, "backward-send":{"total": 3.28, "avg": 1.09, "max": 0.97, "min": 1.16, "cnt": 3}, "backward-recv":{"total": 142.64, "avg": 71.32, "max": 66.14, "min": 76.50, "cnt": 2}, "backward-params-all-reduce":{"total": 484.63, "avg": 484.63, "max": 484.63, "min": 484.63, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 273.94, "avg": 273.94, "max": 273.94, "min": 273.94, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 229.57, "avg": 229.57, "max": 229.57, "min": 229.57, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.86, "avg": 6.86, "max": 6.86, "min": 6.86, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.49, "avg": 3.49, "max": 3.49, "min": 3.49, "cnt": 1}}}
{"type":"time", "iteration": 31, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 76.09, "avg": 25.36, "max": 4.30, "min": 65.99, "cnt": 3}, "forward-compute":{"total": 1895.70, "avg": 59.24, "max": 49.60, "min": 130.79, "cnt": 32}, "fwd-compute":{"total": 1892.51, "avg": 59.14, "max": 49.53, "min": 130.62, "cnt": 32}, "batch-generator":{"total": 48.07, "avg": 1.50, "max": 0.68, "min": 2.74, "cnt": 32}, "fwd-embedding":{"total": 0.63, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1832.03, "avg": 57.25, "max": 48.44, "min": 127.49, "cnt": 32}, "fwd-layernorm":{"total": 9.82, "avg": 0.08, "max": 0.05, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 111.05, "avg": 0.87, "max": 0.74, "min": 1.59, "cnt": 128}, "fwd-misc":{"total": 20.86, "avg": 0.16, "max": 0.11, "min": 0.39, "cnt": 128}, "fwd-MLP":{"total": 1669.33, "avg": 13.04, "max": 10.37, "min": 85.42, "cnt": 128}, "MoE_L0_fwd":{"total": 451.43, "avg": 14.11, "max": 10.29, "min": 18.88, "cnt": 32}, "MoEMLP":{"total": 1652.31, "avg": 12.91, "max": 10.25, "min": 85.31, "cnt": 128}, "MoE_L1_fwd":{"total": 388.27, "avg": 12.13, "max": 10.83, "min": 15.02, "cnt": 32}, "MoE_L2_fwd":{"total": 371.28, "avg": 11.60, "max": 10.98, "min": 14.07, "cnt": 32}, "MoE_L3_fwd":{"total": 447.53, "avg": 13.99, "max": 10.63, "min": 85.35, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.74, "avg": 0.87, "max": 0.83, "min": 0.92, "cnt": 2}, "forward-send-backward-recv":{"total": 607.43, "avg": 20.25, "max": 1.25, "min": 202.88, "cnt": 30}, "backward-compute":{"total": 1738.76, "avg": 54.34, "max": 50.65, "min": 56.68, "cnt": 32}, "MoE_L3_bwd":{"total": 425.01, "avg": 13.28, "max": 11.95, "min": 14.81, "cnt": 32}, "MoE_L2_bwd":{"total": 370.67, "avg": 11.58, "max": 10.17, "min": 13.02, "cnt": 32}, "MoE_L1_bwd":{"total": 367.75, "avg": 11.49, "max": 10.77, "min": 11.88, "cnt": 32}, "MoE_L0_bwd":{"total": 362.46, "avg": 11.33, "max": 10.76, "min": 12.04, "cnt": 32}, "backward-send-forward-recv":{"total": 6978.72, "avg": 240.65, "max": 2.12, "min": 1401.14, "cnt": 29}, "backward-send":{"total": 3.26, "avg": 1.09, "max": 1.05, "min": 1.11, "cnt": 3}, "backward-recv":{"total": 151.13, "avg": 75.57, "max": 75.05, "min": 76.08, "cnt": 2}, "backward-params-all-reduce":{"total": 502.06, "avg": 502.06, "max": 502.06, "min": 502.06, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 264.29, "avg": 264.29, "max": 264.29, "min": 264.29, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 220.10, "avg": 220.10, "max": 220.10, "min": 220.10, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.76, "avg": 6.76, "max": 6.76, "min": 6.76, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.48, "avg": 3.48, "max": 3.48, "min": 3.48, "cnt": 1}}}
{"type":"time", "iteration": 32, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 67.54, "avg": 22.51, "max": 1.34, "min": 56.69, "cnt": 3}, "forward-compute":{"total": 1811.37, "avg": 56.61, "max": 51.70, "min": 62.89, "cnt": 32}, "fwd-compute":{"total": 1808.27, "avg": 56.51, "max": 51.61, "min": 62.80, "cnt": 32}, "batch-generator":{"total": 44.13, "avg": 1.38, "max": 0.64, "min": 2.86, "cnt": 32}, "fwd-embedding":{"total": 0.60, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1752.21, "avg": 54.76, "max": 50.10, "min": 60.86, "cnt": 32}, "fwd-layernorm":{"total": 9.28, "avg": 0.07, "max": 0.05, "min": 0.17, "cnt": 128}, "fwd-attn":{"total": 105.77, "avg": 0.83, "max": 0.74, "min": 1.45, "cnt": 128}, "fwd-misc":{"total": 19.99, "avg": 0.16, "max": 0.11, "min": 0.34, "cnt": 128}, "fwd-MLP":{"total": 1597.08, "avg": 12.48, "max": 10.72, "min": 19.06, "cnt": 128}, "MoE_L0_fwd":{"total": 470.69, "avg": 14.71, "max": 11.97, "min": 18.98, "cnt": 32}, "MoEMLP":{"total": 1580.58, "avg": 12.35, "max": 10.61, "min": 18.93, "cnt": 128}, "MoE_L1_fwd":{"total": 379.61, "avg": 11.86, "max": 10.85, "min": 13.86, "cnt": 32}, "MoE_L2_fwd":{"total": 368.03, "avg": 11.50, "max": 10.98, "min": 12.32, "cnt": 32}, "MoE_L3_fwd":{"total": 368.16, "avg": 11.50, "max": 10.65, "min": 13.28, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.75, "avg": 0.88, "max": 0.79, "min": 0.96, "cnt": 2}, "forward-send-backward-recv":{"total": 210.63, "avg": 7.02, "max": 1.68, "min": 120.23, "cnt": 30}, "backward-compute":{"total": 1741.35, "avg": 54.42, "max": 51.52, "min": 56.93, "cnt": 32}, "MoE_L3_bwd":{"total": 416.33, "avg": 13.01, "max": 12.33, "min": 15.22, "cnt": 32}, "MoE_L2_bwd":{"total": 372.73, "avg": 11.65, "max": 10.92, "min": 12.85, "cnt": 32}, "MoE_L1_bwd":{"total": 369.58, "avg": 11.55, "max": 10.90, "min": 12.04, "cnt": 32}, "MoE_L0_bwd":{"total": 368.38, "avg": 11.51, "max": 10.78, "min": 12.32, "cnt": 32}, "backward-send-forward-recv":{"total": 6227.79, "avg": 214.75, "max": 1.82, "min": 877.70, "cnt": 29}, "backward-send":{"total": 2.33, "avg": 0.78, "max": 0.47, "min": 1.04, "cnt": 3}, "backward-recv":{"total": 1882.99, "avg": 941.50, "max": 744.20, "min": 1138.80, "cnt": 2}, "backward-params-all-reduce":{"total": 487.88, "avg": 487.88, "max": 487.88, "min": 487.88, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 265.84, "avg": 265.84, "max": 265.84, "min": 265.84, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 221.66, "avg": 221.66, "max": 221.66, "min": 221.66, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.91, "avg": 6.91, "max": 6.91, "min": 6.91, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 33, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 74.76, "avg": 24.92, "max": 5.80, "min": 62.15, "cnt": 3}, "forward-compute":{"total": 1807.77, "avg": 56.49, "max": 51.22, "min": 62.74, "cnt": 32}, "fwd-compute":{"total": 1804.56, "avg": 56.39, "max": 51.15, "min": 62.65, "cnt": 32}, "batch-generator":{"total": 50.61, "avg": 1.58, "max": 0.67, "min": 3.26, "cnt": 32}, "fwd-embedding":{"total": 0.62, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1741.81, "avg": 54.43, "max": 50.15, "min": 59.77, "cnt": 32}, "fwd-layernorm":{"total": 9.53, "avg": 0.07, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 106.38, "avg": 0.83, "max": 0.74, "min": 1.45, "cnt": 128}, "fwd-misc":{"total": 20.32, "avg": 0.16, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1584.96, "avg": 12.38, "max": 10.69, "min": 18.66, "cnt": 128}, "MoE_L0_fwd":{"total": 459.23, "avg": 14.35, "max": 11.32, "min": 18.58, "cnt": 32}, "MoEMLP":{"total": 1568.47, "avg": 12.25, "max": 10.57, "min": 18.53, "cnt": 128}, "MoE_L1_fwd":{"total": 382.04, "avg": 11.94, "max": 10.93, "min": 15.99, "cnt": 32}, "MoE_L2_fwd":{"total": 370.97, "avg": 11.59, "max": 11.08, "min": 13.23, "cnt": 32}, "MoE_L3_fwd":{"total": 362.27, "avg": 11.32, "max": 10.62, "min": 14.08, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.56, "avg": 0.78, "max": 0.70, "min": 0.86, "cnt": 2}, "forward-send-backward-recv":{"total": 1071.97, "avg": 35.73, "max": 1.34, "min": 260.55, "cnt": 30}, "backward-compute":{"total": 1742.51, "avg": 54.45, "max": 52.42, "min": 57.15, "cnt": 32}, "MoE_L3_bwd":{"total": 411.60, "avg": 12.86, "max": 11.97, "min": 15.23, "cnt": 32}, "MoE_L2_bwd":{"total": 377.78, "avg": 11.81, "max": 11.01, "min": 12.76, "cnt": 32}, "MoE_L1_bwd":{"total": 369.91, "avg": 11.56, "max": 10.81, "min": 11.84, "cnt": 32}, "MoE_L0_bwd":{"total": 370.15, "avg": 11.57, "max": 11.06, "min": 11.90, "cnt": 32}, "backward-send-forward-recv":{"total": 8811.83, "avg": 303.86, "max": 2.12, "min": 1249.08, "cnt": 29}, "backward-send":{"total": 2.57, "avg": 0.86, "max": 0.57, "min": 1.07, "cnt": 3}, "backward-recv":{"total": 289.40, "avg": 144.70, "max": 134.17, "min": 155.23, "cnt": 2}, "backward-params-all-reduce":{"total": 488.39, "avg": 488.39, "max": 488.39, "min": 488.39, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 265.25, "avg": 265.25, "max": 265.25, "min": 265.25, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 221.14, "avg": 221.14, "max": 221.14, "min": 221.14, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.82, "avg": 6.82, "max": 6.82, "min": 6.82, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 34, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.06, "avg": 0.06, "max": 0.06, "min": 0.06, "cnt": 1}, "forward-recv":{"total": 73.71, "avg": 24.57, "max": 5.34, "min": 59.87, "cnt": 3}, "forward-compute":{"total": 1796.15, "avg": 56.13, "max": 50.55, "min": 61.85, "cnt": 32}, "fwd-compute":{"total": 1793.24, "avg": 56.04, "max": 50.48, "min": 61.78, "cnt": 32}, "batch-generator":{"total": 44.36, "avg": 1.39, "max": 0.74, "min": 3.24, "cnt": 32}, "fwd-embedding":{"total": 0.53, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1737.04, "avg": 54.28, "max": 49.43, "min": 60.66, "cnt": 32}, "fwd-layernorm":{"total": 9.30, "avg": 0.07, "max": 0.06, "min": 0.22, "cnt": 128}, "fwd-attn":{"total": 105.55, "avg": 0.82, "max": 0.74, "min": 1.50, "cnt": 128}, "fwd-misc":{"total": 20.27, "avg": 0.16, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1581.55, "avg": 12.36, "max": 10.80, "min": 21.57, "cnt": 128}, "MoE_L0_fwd":{"total": 461.42, "avg": 14.42, "max": 10.89, "min": 21.49, "cnt": 32}, "MoEMLP":{"total": 1564.97, "avg": 12.23, "max": 10.69, "min": 21.44, "cnt": 128}, "MoE_L1_fwd":{"total": 387.33, "avg": 12.10, "max": 10.85, "min": 15.62, "cnt": 32}, "MoE_L2_fwd":{"total": 370.16, "avg": 11.57, "max": 11.05, "min": 12.75, "cnt": 32}, "MoE_L3_fwd":{"total": 352.08, "avg": 11.00, "max": 10.73, "min": 11.96, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.92, "avg": 0.96, "max": 0.93, "min": 0.99, "cnt": 2}, "forward-send-backward-recv":{"total": 358.87, "avg": 11.96, "max": 1.29, "min": 155.66, "cnt": 30}, "backward-compute":{"total": 1758.40, "avg": 54.95, "max": 53.67, "min": 57.83, "cnt": 32}, "MoE_L3_bwd":{"total": 412.83, "avg": 12.90, "max": 12.10, "min": 15.57, "cnt": 32}, "MoE_L2_bwd":{"total": 379.71, "avg": 11.87, "max": 10.56, "min": 12.35, "cnt": 32}, "MoE_L1_bwd":{"total": 376.65, "avg": 11.77, "max": 11.28, "min": 13.23, "cnt": 32}, "MoE_L0_bwd":{"total": 376.84, "avg": 11.78, "max": 11.43, "min": 12.94, "cnt": 32}, "backward-send-forward-recv":{"total": 10910.81, "avg": 376.23, "max": 2.45, "min": 1918.46, "cnt": 29}, "backward-send":{"total": 2.09, "avg": 0.70, "max": 0.62, "min": 0.77, "cnt": 3}, "backward-recv":{"total": 340.76, "avg": 170.38, "max": 112.38, "min": 228.38, "cnt": 2}, "backward-params-all-reduce":{"total": 487.93, "avg": 487.93, "max": 487.93, "min": 487.93, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 266.49, "avg": 266.49, "max": 266.49, "min": 266.49, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 222.33, "avg": 222.33, "max": 222.33, "min": 222.33, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.90, "avg": 6.90, "max": 6.90, "min": 6.90, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 35, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 67.51, "avg": 22.50, "max": 1.62, "min": 59.42, "cnt": 3}, "forward-compute":{"total": 1784.94, "avg": 55.78, "max": 50.64, "min": 62.72, "cnt": 32}, "fwd-compute":{"total": 1781.99, "avg": 55.69, "max": 50.55, "min": 62.64, "cnt": 32}, "batch-generator":{"total": 36.02, "avg": 1.13, "max": 0.68, "min": 2.62, "cnt": 32}, "fwd-embedding":{"total": 0.49, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1734.23, "avg": 54.19, "max": 49.55, "min": 60.37, "cnt": 32}, "fwd-layernorm":{"total": 8.99, "avg": 0.07, "max": 0.05, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 102.97, "avg": 0.80, "max": 0.74, "min": 1.49, "cnt": 128}, "fwd-misc":{"total": 19.43, "avg": 0.15, "max": 0.11, "min": 0.33, "cnt": 128}, "fwd-MLP":{"total": 1583.02, "avg": 12.37, "max": 10.72, "min": 18.93, "cnt": 128}, "MoE_L0_fwd":{"total": 464.13, "avg": 14.50, "max": 11.32, "min": 18.85, "cnt": 32}, "MoEMLP":{"total": 1566.53, "avg": 12.24, "max": 10.61, "min": 18.80, "cnt": 128}, "MoE_L1_fwd":{"total": 373.16, "avg": 11.66, "max": 10.74, "min": 14.51, "cnt": 32}, "MoE_L2_fwd":{"total": 375.87, "avg": 11.75, "max": 10.93, "min": 13.71, "cnt": 32}, "MoE_L3_fwd":{"total": 359.28, "avg": 11.23, "max": 10.65, "min": 12.44, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.57, "avg": 0.79, "max": 0.74, "min": 0.84, "cnt": 2}, "forward-send-backward-recv":{"total": 653.87, "avg": 21.80, "max": 1.64, "min": 195.20, "cnt": 30}, "backward-compute":{"total": 1730.52, "avg": 54.08, "max": 50.74, "min": 56.88, "cnt": 32}, "MoE_L3_bwd":{"total": 408.18, "avg": 12.76, "max": 12.15, "min": 13.76, "cnt": 32}, "MoE_L2_bwd":{"total": 377.94, "avg": 11.81, "max": 11.08, "min": 13.68, "cnt": 32}, "MoE_L1_bwd":{"total": 349.53, "avg": 10.92, "max": 10.41, "min": 12.16, "cnt": 32}, "MoE_L0_bwd":{"total": 379.57, "avg": 11.86, "max": 11.06, "min": 13.21, "cnt": 32}, "backward-send-forward-recv":{"total": 3993.87, "avg": 137.72, "max": 1.93, "min": 393.14, "cnt": 29}, "backward-send":{"total": 1.94, "avg": 0.65, "max": 0.50, "min": 0.76, "cnt": 3}, "backward-recv":{"total": 311.77, "avg": 155.89, "max": 81.86, "min": 229.91, "cnt": 2}, "backward-params-all-reduce":{"total": 489.00, "avg": 489.00, "max": 489.00, "min": 489.00, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 266.64, "avg": 266.64, "max": 266.64, "min": 266.64, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 222.55, "avg": 222.55, "max": 222.55, "min": 222.55, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.82, "avg": 6.82, "max": 6.82, "min": 6.82, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 36, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.06, "avg": 0.06, "max": 0.06, "min": 0.06, "cnt": 1}, "forward-recv":{"total": 66.61, "avg": 22.20, "max": 0.91, "min": 61.17, "cnt": 3}, "forward-compute":{"total": 1821.63, "avg": 56.93, "max": 49.18, "min": 72.88, "cnt": 32}, "fwd-compute":{"total": 1818.81, "avg": 56.84, "max": 49.09, "min": 72.78, "cnt": 32}, "batch-generator":{"total": 40.10, "avg": 1.25, "max": 0.67, "min": 4.38, "cnt": 32}, "fwd-embedding":{"total": 0.49, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1767.05, "avg": 55.22, "max": 48.10, "min": 67.68, "cnt": 32}, "fwd-layernorm":{"total": 9.08, "avg": 0.07, "max": 0.05, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 106.64, "avg": 0.83, "max": 0.74, "min": 1.52, "cnt": 128}, "fwd-misc":{"total": 20.35, "avg": 0.16, "max": 0.11, "min": 0.64, "cnt": 128}, "fwd-MLP":{"total": 1610.71, "avg": 12.58, "max": 10.49, "min": 28.30, "cnt": 128}, "MoE_L0_fwd":{"total": 493.49, "avg": 15.42, "max": 11.05, "min": 28.21, "cnt": 32}, "MoEMLP":{"total": 1594.36, "avg": 12.46, "max": 10.38, "min": 28.16, "cnt": 128}, "MoE_L1_fwd":{"total": 379.91, "avg": 11.87, "max": 10.54, "min": 14.50, "cnt": 32}, "MoE_L2_fwd":{"total": 364.59, "avg": 11.39, "max": 10.42, "min": 12.72, "cnt": 32}, "MoE_L3_fwd":{"total": 362.38, "avg": 11.32, "max": 10.56, "min": 12.31, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.62, "avg": 0.02, "max": 0.02, "min": 0.04, "cnt": 32}, "forward-send":{"total": 12.15, "avg": 6.08, "max": 0.91, "min": 11.24, "cnt": 2}, "forward-send-backward-recv":{"total": 211.35, "avg": 7.04, "max": 1.74, "min": 139.18, "cnt": 30}, "backward-compute":{"total": 1714.65, "avg": 53.58, "max": 51.00, "min": 56.01, "cnt": 32}, "MoE_L3_bwd":{"total": 407.89, "avg": 12.75, "max": 11.80, "min": 13.70, "cnt": 32}, "MoE_L2_bwd":{"total": 363.99, "avg": 11.37, "max": 10.60, "min": 12.34, "cnt": 32}, "MoE_L1_bwd":{"total": 350.55, "avg": 10.95, "max": 10.27, "min": 12.29, "cnt": 32}, "MoE_L0_bwd":{"total": 379.31, "avg": 11.85, "max": 11.42, "min": 13.09, "cnt": 32}, "backward-send-forward-recv":{"total": 7392.44, "avg": 254.91, "max": 10.86, "min": 1066.22, "cnt": 29}, "backward-send":{"total": 2.33, "avg": 0.78, "max": 0.61, "min": 1.08, "cnt": 3}, "backward-recv":{"total": 164.05, "avg": 82.02, "max": 81.37, "min": 82.68, "cnt": 2}, "backward-params-all-reduce":{"total": 485.16, "avg": 485.16, "max": 485.16, "min": 485.16, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 264.79, "avg": 264.79, "max": 264.79, "min": 264.79, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 220.66, "avg": 220.66, "max": 220.66, "min": 220.66, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.85, "avg": 6.85, "max": 6.85, "min": 6.85, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 37, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.06, "avg": 0.06, "max": 0.06, "min": 0.06, "cnt": 1}, "forward-recv":{"total": 75.39, "avg": 25.13, "max": 4.87, "min": 64.31, "cnt": 3}, "forward-compute":{"total": 1798.92, "avg": 56.22, "max": 50.24, "min": 64.74, "cnt": 32}, "fwd-compute":{"total": 1795.84, "avg": 56.12, "max": 50.15, "min": 64.60, "cnt": 32}, "batch-generator":{"total": 42.93, "avg": 1.34, "max": 0.64, "min": 2.30, "cnt": 32}, "fwd-embedding":{"total": 0.61, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1740.49, "avg": 54.39, "max": 49.01, "min": 62.02, "cnt": 32}, "fwd-layernorm":{"total": 9.49, "avg": 0.07, "max": 0.05, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 107.48, "avg": 0.84, "max": 0.74, "min": 1.54, "cnt": 128}, "fwd-misc":{"total": 20.52, "avg": 0.16, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1582.46, "avg": 12.36, "max": 10.69, "min": 20.73, "cnt": 128}, "MoE_L0_fwd":{"total": 481.35, "avg": 15.04, "max": 11.41, "min": 20.57, "cnt": 32}, "MoEMLP":{"total": 1565.49, "avg": 12.23, "max": 10.58, "min": 20.49, "cnt": 128}, "MoE_L1_fwd":{"total": 376.03, "avg": 11.75, "max": 10.89, "min": 13.50, "cnt": 32}, "MoE_L2_fwd":{"total": 356.85, "avg": 11.15, "max": 10.62, "min": 12.17, "cnt": 32}, "MoE_L3_fwd":{"total": 357.32, "avg": 11.17, "max": 10.73, "min": 12.41, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.68, "avg": 0.84, "max": 0.69, "min": 0.99, "cnt": 2}, "forward-send-backward-recv":{"total": 728.15, "avg": 24.27, "max": 1.24, "min": 193.91, "cnt": 30}, "backward-compute":{"total": 1717.73, "avg": 53.68, "max": 50.06, "min": 56.01, "cnt": 32}, "MoE_L3_bwd":{"total": 416.50, "avg": 13.02, "max": 11.95, "min": 15.07, "cnt": 32}, "MoE_L2_bwd":{"total": 361.24, "avg": 11.29, "max": 10.69, "min": 12.00, "cnt": 32}, "MoE_L1_bwd":{"total": 351.42, "avg": 10.98, "max": 10.47, "min": 11.49, "cnt": 32}, "MoE_L0_bwd":{"total": 374.37, "avg": 11.70, "max": 10.82, "min": 12.46, "cnt": 32}, "backward-send-forward-recv":{"total": 6675.49, "avg": 230.19, "max": 2.24, "min": 877.05, "cnt": 29}, "backward-send":{"total": 3.22, "avg": 1.07, "max": 1.03, "min": 1.13, "cnt": 3}, "backward-recv":{"total": 156.77, "avg": 78.39, "max": 74.73, "min": 82.04, "cnt": 2}, "backward-params-all-reduce":{"total": 487.22, "avg": 487.22, "max": 487.22, "min": 487.22, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 266.36, "avg": 266.36, "max": 266.36, "min": 266.36, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 222.26, "avg": 222.26, "max": 222.26, "min": 222.26, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.81, "avg": 6.81, "max": 6.81, "min": 6.81, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 38, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.10, "avg": 0.10, "max": 0.10, "min": 0.10, "cnt": 1}, "forward-recv":{"total": 83.23, "avg": 27.74, "max": 6.55, "min": 66.27, "cnt": 3}, "forward-compute":{"total": 1779.92, "avg": 55.62, "max": 50.24, "min": 63.54, "cnt": 32}, "fwd-compute":{"total": 1776.87, "avg": 55.53, "max": 50.17, "min": 63.45, "cnt": 32}, "batch-generator":{"total": 63.43, "avg": 1.98, "max": 0.70, "min": 4.15, "cnt": 32}, "fwd-embedding":{"total": 0.59, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1701.40, "avg": 53.17, "max": 49.14, "min": 59.95, "cnt": 32}, "fwd-layernorm":{"total": 9.59, "avg": 0.07, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 104.39, "avg": 0.82, "max": 0.74, "min": 1.52, "cnt": 128}, "fwd-misc":{"total": 20.29, "avg": 0.16, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1546.73, "avg": 12.08, "max": 10.68, "min": 19.41, "cnt": 128}, "MoE_L0_fwd":{"total": 432.85, "avg": 13.53, "max": 11.23, "min": 19.33, "cnt": 32}, "MoEMLP":{"total": 1530.14, "avg": 11.95, "max": 10.56, "min": 19.28, "cnt": 128}, "MoE_L1_fwd":{"total": 378.54, "avg": 11.83, "max": 10.75, "min": 14.67, "cnt": 32}, "MoE_L2_fwd":{"total": 369.73, "avg": 11.55, "max": 11.10, "min": 12.32, "cnt": 32}, "MoE_L3_fwd":{"total": 355.16, "avg": 11.10, "max": 10.60, "min": 12.90, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.86, "avg": 0.93, "max": 0.92, "min": 0.94, "cnt": 2}, "forward-send-backward-recv":{"total": 209.18, "avg": 6.97, "max": 1.27, "min": 118.19, "cnt": 30}, "backward-compute":{"total": 1721.73, "avg": 53.80, "max": 51.06, "min": 55.21, "cnt": 32}, "MoE_L3_bwd":{"total": 399.82, "avg": 12.49, "max": 11.93, "min": 13.24, "cnt": 32}, "MoE_L2_bwd":{"total": 383.33, "avg": 11.98, "max": 11.34, "min": 13.56, "cnt": 32}, "MoE_L1_bwd":{"total": 351.03, "avg": 10.97, "max": 10.28, "min": 11.27, "cnt": 32}, "MoE_L0_bwd":{"total": 373.30, "avg": 11.67, "max": 10.73, "min": 12.87, "cnt": 32}, "backward-send-forward-recv":{"total": 6712.96, "avg": 231.48, "max": 2.39, "min": 838.13, "cnt": 29}, "backward-send":{"total": 3.15, "avg": 1.05, "max": 0.95, "min": 1.17, "cnt": 3}, "backward-recv":{"total": 145.68, "avg": 72.84, "max": 64.43, "min": 81.25, "cnt": 2}, "backward-params-all-reduce":{"total": 484.39, "avg": 484.39, "max": 484.39, "min": 484.39, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 270.60, "avg": 270.60, "max": 270.60, "min": 270.60, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 226.33, "avg": 226.33, "max": 226.33, "min": 226.33, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.78, "avg": 6.78, "max": 6.78, "min": 6.78, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 39, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 68.69, "avg": 22.90, "max": 4.56, "min": 58.84, "cnt": 3}, "forward-compute":{"total": 1840.43, "avg": 57.51, "max": 51.97, "min": 64.18, "cnt": 32}, "fwd-compute":{"total": 1837.42, "avg": 57.42, "max": 51.89, "min": 64.10, "cnt": 32}, "batch-generator":{"total": 46.61, "avg": 1.46, "max": 0.68, "min": 3.33, "cnt": 32}, "fwd-embedding":{"total": 0.71, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1778.35, "avg": 55.57, "max": 50.79, "min": 62.70, "cnt": 32}, "fwd-layernorm":{"total": 10.15, "avg": 0.08, "max": 0.05, "min": 0.22, "cnt": 128}, "fwd-attn":{"total": 109.55, "avg": 0.86, "max": 0.74, "min": 1.53, "cnt": 128}, "fwd-misc":{"total": 21.49, "avg": 0.17, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1615.45, "avg": 12.62, "max": 10.66, "min": 21.32, "cnt": 128}, "MoE_L0_fwd":{"total": 495.96, "avg": 15.50, "max": 12.60, "min": 21.17, "cnt": 32}, "MoEMLP":{"total": 1598.02, "avg": 12.48, "max": 10.55, "min": 21.09, "cnt": 128}, "MoE_L1_fwd":{"total": 380.46, "avg": 11.89, "max": 10.66, "min": 16.25, "cnt": 32}, "MoE_L2_fwd":{"total": 371.78, "avg": 11.62, "max": 10.98, "min": 12.68, "cnt": 32}, "MoE_L3_fwd":{"total": 356.17, "avg": 11.13, "max": 10.59, "min": 14.37, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.68, "avg": 0.84, "max": 0.79, "min": 0.89, "cnt": 2}, "forward-send-backward-recv":{"total": 210.78, "avg": 7.03, "max": 1.26, "min": 125.67, "cnt": 30}, "backward-compute":{"total": 1739.72, "avg": 54.37, "max": 52.06, "min": 57.13, "cnt": 32}, "MoE_L3_bwd":{"total": 409.88, "avg": 12.81, "max": 12.17, "min": 14.15, "cnt": 32}, "MoE_L2_bwd":{"total": 383.91, "avg": 12.00, "max": 11.11, "min": 13.08, "cnt": 32}, "MoE_L1_bwd":{"total": 356.10, "avg": 11.13, "max": 10.35, "min": 11.96, "cnt": 32}, "MoE_L0_bwd":{"total": 374.48, "avg": 11.70, "max": 11.23, "min": 13.48, "cnt": 32}, "backward-send-forward-recv":{"total": 6157.72, "avg": 212.34, "max": 2.38, "min": 1047.94, "cnt": 29}, "backward-send":{"total": 2.97, "avg": 0.99, "max": 0.95, "min": 1.03, "cnt": 3}, "backward-recv":{"total": 146.32, "avg": 73.16, "max": 72.34, "min": 73.98, "cnt": 2}, "backward-params-all-reduce":{"total": 565.29, "avg": 565.29, "max": 565.29, "min": 565.29, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 267.37, "avg": 267.37, "max": 267.37, "min": 267.37, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 223.31, "avg": 223.31, "max": 223.31, "min": 223.31, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.78, "avg": 6.78, "max": 6.78, "min": 6.78, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 40, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.11, "avg": 0.11, "max": 0.11, "min": 0.11, "cnt": 1}, "forward-recv":{"total": 88.06, "avg": 29.35, "max": 8.95, "min": 69.87, "cnt": 3}, "forward-compute":{"total": 1791.23, "avg": 55.98, "max": 50.12, "min": 67.12, "cnt": 32}, "fwd-compute":{"total": 1788.21, "avg": 55.88, "max": 50.02, "min": 67.04, "cnt": 32}, "batch-generator":{"total": 44.13, "avg": 1.38, "max": 0.71, "min": 2.65, "cnt": 32}, "fwd-embedding":{"total": 0.56, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1730.86, "avg": 54.09, "max": 48.91, "min": 65.68, "cnt": 32}, "fwd-layernorm":{"total": 9.65, "avg": 0.08, "max": 0.05, "min": 0.22, "cnt": 128}, "fwd-attn":{"total": 106.30, "avg": 0.83, "max": 0.74, "min": 1.65, "cnt": 128}, "fwd-misc":{"total": 20.69, "avg": 0.16, "max": 0.11, "min": 0.39, "cnt": 128}, "fwd-MLP":{"total": 1572.71, "avg": 12.29, "max": 10.66, "min": 23.48, "cnt": 128}, "MoE_L0_fwd":{"total": 459.78, "avg": 14.37, "max": 11.42, "min": 23.40, "cnt": 32}, "MoEMLP":{"total": 1555.07, "avg": 12.15, "max": 10.55, "min": 23.35, "cnt": 128}, "MoE_L1_fwd":{"total": 376.85, "avg": 11.78, "max": 10.59, "min": 13.09, "cnt": 32}, "MoE_L2_fwd":{"total": 366.70, "avg": 11.46, "max": 11.00, "min": 12.35, "cnt": 32}, "MoE_L3_fwd":{"total": 358.04, "avg": 11.19, "max": 10.67, "min": 13.66, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.60, "avg": 0.80, "max": 0.74, "min": 0.86, "cnt": 2}, "forward-send-backward-recv":{"total": 344.08, "avg": 11.47, "max": 1.30, "min": 266.38, "cnt": 30}, "backward-compute":{"total": 1751.41, "avg": 54.73, "max": 52.15, "min": 56.90, "cnt": 32}, "MoE_L3_bwd":{"total": 406.61, "avg": 12.71, "max": 11.67, "min": 14.20, "cnt": 32}, "MoE_L2_bwd":{"total": 393.66, "avg": 12.30, "max": 11.29, "min": 14.20, "cnt": 32}, "MoE_L1_bwd":{"total": 366.99, "avg": 11.47, "max": 10.38, "min": 12.25, "cnt": 32}, "MoE_L0_bwd":{"total": 368.63, "avg": 11.52, "max": 10.73, "min": 12.48, "cnt": 32}, "backward-send-forward-recv":{"total": 5219.60, "avg": 179.99, "max": 2.39, "min": 773.80, "cnt": 29}, "backward-send":{"total": 2.44, "avg": 0.81, "max": 0.50, "min": 1.00, "cnt": 3}, "backward-recv":{"total": 162.46, "avg": 81.23, "max": 80.73, "min": 81.73, "cnt": 2}, "backward-params-all-reduce":{"total": 489.92, "avg": 489.92, "max": 489.92, "min": 489.92, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "optimizer":{"total": 265.16, "avg": 265.16, "max": 265.16, "min": 265.16, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 220.99, "avg": 220.99, "max": 220.99, "min": 220.99, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.75, "avg": 6.75, "max": 6.75, "min": 6.75, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.47, "avg": 3.47, "max": 3.47, "min": 3.47, "cnt": 1}}}
{"type":"time", "iteration": 41, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 76.44, "avg": 25.48, "max": 1.74, "min": 71.10, "cnt": 3}, "forward-compute":{"total": 1888.78, "avg": 59.02, "max": 51.28, "min": 118.64, "cnt": 32}, "fwd-compute":{"total": 1885.66, "avg": 58.93, "max": 51.21, "min": 118.56, "cnt": 32}, "batch-generator":{"total": 41.54, "avg": 1.30, "max": 0.74, "min": 2.81, "cnt": 32}, "fwd-embedding":{"total": 0.58, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1831.74, "avg": 57.24, "max": 50.15, "min": 117.26, "cnt": 32}, "fwd-layernorm":{"total": 9.53, "avg": 0.07, "max": 0.06, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 109.15, "avg": 0.85, "max": 0.74, "min": 1.65, "cnt": 128}, "fwd-misc":{"total": 20.87, "avg": 0.16, "max": 0.11, "min": 0.42, "cnt": 128}, "fwd-MLP":{"total": 1671.25, "avg": 13.06, "max": 10.68, "min": 76.41, "cnt": 128}, "MoE_L0_fwd":{"total": 538.25, "avg": 16.82, "max": 11.68, "min": 76.33, "cnt": 32}, "MoEMLP":{"total": 1654.16, "avg": 12.92, "max": 10.58, "min": 76.28, "cnt": 128}, "MoE_L1_fwd":{"total": 396.39, "avg": 12.39, "max": 11.25, "min": 14.52, "cnt": 32}, "MoE_L2_fwd":{"total": 364.90, "avg": 11.40, "max": 10.93, "min": 11.92, "cnt": 32}, "MoE_L3_fwd":{"total": 360.73, "avg": 11.27, "max": 10.62, "min": 17.25, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 7.04, "avg": 3.52, "max": 0.92, "min": 6.12, "cnt": 2}, "forward-send-backward-recv":{"total": 197.96, "avg": 6.60, "max": 1.40, "min": 124.46, "cnt": 30}, "backward-compute":{"total": 1777.67, "avg": 55.55, "max": 53.81, "min": 63.06, "cnt": 32}, "MoE_L3_bwd":{"total": 408.15, "avg": 12.75, "max": 12.08, "min": 14.61, "cnt": 32}, "MoE_L2_bwd":{"total": 387.57, "avg": 12.11, "max": 11.46, "min": 17.16, "cnt": 32}, "MoE_L1_bwd":{"total": 385.41, "avg": 12.04, "max": 11.31, "min": 13.67, "cnt": 32}, "MoE_L0_bwd":{"total": 379.75, "avg": 11.87, "max": 11.44, "min": 12.74, "cnt": 32}, "backward-send-forward-recv":{"total": 6696.98, "avg": 230.93, "max": 2.51, "min": 840.71, "cnt": 29}, "backward-send":{"total": 2.43, "avg": 0.81, "max": 0.78, "min": 0.86, "cnt": 3}, "backward-recv":{"total": 139.91, "avg": 69.95, "max": 63.24, "min": 76.67, "cnt": 2}, "backward-params-all-reduce":{"total": 485.54, "avg": 485.54, "max": 485.54, "min": 485.54, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 269.67, "avg": 269.67, "max": 269.67, "min": 269.67, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 225.52, "avg": 225.52, "max": 225.52, "min": 225.52, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.83, "avg": 6.83, "max": 6.83, "min": 6.83, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 42, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 61.28, "avg": 20.43, "max": 1.08, "min": 56.63, "cnt": 3}, "forward-compute":{"total": 1913.31, "avg": 59.79, "max": 53.72, "min": 101.33, "cnt": 32}, "fwd-compute":{"total": 1909.94, "avg": 59.69, "max": 53.63, "min": 101.25, "cnt": 32}, "batch-generator":{"total": 48.50, "avg": 1.52, "max": 0.68, "min": 3.07, "cnt": 32}, "fwd-embedding":{"total": 0.62, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1848.42, "avg": 57.76, "max": 52.56, "min": 98.34, "cnt": 32}, "fwd-layernorm":{"total": 10.05, "avg": 0.08, "max": 0.05, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 111.31, "avg": 0.87, "max": 0.74, "min": 2.18, "cnt": 128}, "fwd-misc":{"total": 21.51, "avg": 0.17, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1683.90, "avg": 13.16, "max": 10.72, "min": 58.17, "cnt": 128}, "MoE_L0_fwd":{"total": 533.85, "avg": 16.68, "max": 12.56, "min": 58.09, "cnt": 32}, "MoEMLP":{"total": 1666.17, "avg": 13.02, "max": 10.61, "min": 58.05, "cnt": 128}, "MoE_L1_fwd":{"total": 403.78, "avg": 12.62, "max": 11.66, "min": 16.26, "cnt": 32}, "MoE_L2_fwd":{"total": 370.56, "avg": 11.58, "max": 11.06, "min": 14.79, "cnt": 32}, "MoE_L3_fwd":{"total": 364.42, "avg": 11.39, "max": 10.65, "min": 13.59, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.63, "avg": 0.02, "max": 0.02, "min": 0.04, "cnt": 32}, "forward-send":{"total": 1.81, "avg": 0.90, "max": 0.86, "min": 0.95, "cnt": 2}, "forward-send-backward-recv":{"total": 631.53, "avg": 21.05, "max": 1.44, "min": 208.22, "cnt": 30}, "backward-compute":{"total": 1789.98, "avg": 55.94, "max": 54.39, "min": 57.75, "cnt": 32}, "MoE_L3_bwd":{"total": 413.90, "avg": 12.93, "max": 11.99, "min": 14.59, "cnt": 32}, "MoE_L2_bwd":{"total": 383.99, "avg": 12.00, "max": 11.07, "min": 12.80, "cnt": 32}, "MoE_L1_bwd":{"total": 389.80, "avg": 12.18, "max": 11.64, "min": 12.98, "cnt": 32}, "MoE_L0_bwd":{"total": 387.61, "avg": 12.11, "max": 11.76, "min": 13.16, "cnt": 32}, "backward-send-forward-recv":{"total": 5827.16, "avg": 200.94, "max": 2.37, "min": 1185.66, "cnt": 29}, "backward-send":{"total": 3.07, "avg": 1.02, "max": 0.99, "min": 1.05, "cnt": 3}, "backward-recv":{"total": 655.26, "avg": 327.63, "max": 71.09, "min": 584.17, "cnt": 2}, "backward-params-all-reduce":{"total": 484.80, "avg": 484.80, "max": 484.80, "min": 484.80, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 266.22, "avg": 266.22, "max": 266.22, "min": 266.22, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 221.97, "avg": 221.97, "max": 221.97, "min": 221.97, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.90, "avg": 6.90, "max": 6.90, "min": 6.90, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.47, "avg": 3.47, "max": 3.47, "min": 3.47, "cnt": 1}}}
{"type":"time", "iteration": 43, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.11, "avg": 0.11, "max": 0.11, "min": 0.11, "cnt": 1}, "forward-recv":{"total": 73.95, "avg": 24.65, "max": 2.65, "min": 65.82, "cnt": 3}, "forward-compute":{"total": 1893.09, "avg": 59.16, "max": 50.04, "min": 108.00, "cnt": 32}, "fwd-compute":{"total": 1890.04, "avg": 59.06, "max": 49.98, "min": 107.90, "cnt": 32}, "batch-generator":{"total": 55.84, "avg": 1.74, "max": 0.69, "min": 4.42, "cnt": 32}, "fwd-embedding":{"total": 0.60, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1822.01, "avg": 56.94, "max": 48.99, "min": 106.63, "cnt": 32}, "fwd-layernorm":{"total": 9.62, "avg": 0.08, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 106.67, "avg": 0.83, "max": 0.74, "min": 1.53, "cnt": 128}, "fwd-misc":{"total": 20.61, "avg": 0.16, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1664.37, "avg": 13.00, "max": 10.85, "min": 66.95, "cnt": 128}, "MoE_L0_fwd":{"total": 515.31, "avg": 16.10, "max": 11.86, "min": 66.86, "cnt": 32}, "MoEMLP":{"total": 1647.65, "avg": 12.87, "max": 10.73, "min": 66.82, "cnt": 128}, "MoE_L1_fwd":{"total": 391.47, "avg": 12.23, "max": 10.81, "min": 14.10, "cnt": 32}, "MoE_L2_fwd":{"total": 367.83, "avg": 11.49, "max": 10.88, "min": 13.38, "cnt": 32}, "MoE_L3_fwd":{"total": 379.18, "avg": 11.85, "max": 10.79, "min": 13.47, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 2.10, "avg": 1.05, "max": 0.95, "min": 1.16, "cnt": 2}, "forward-send-backward-recv":{"total": 195.42, "avg": 6.51, "max": 1.40, "min": 122.91, "cnt": 30}, "backward-compute":{"total": 1788.41, "avg": 55.89, "max": 53.29, "min": 57.53, "cnt": 32}, "MoE_L3_bwd":{"total": 432.92, "avg": 13.53, "max": 12.44, "min": 15.32, "cnt": 32}, "MoE_L2_bwd":{"total": 377.97, "avg": 11.81, "max": 10.98, "min": 12.32, "cnt": 32}, "MoE_L1_bwd":{"total": 373.86, "avg": 11.68, "max": 11.12, "min": 12.26, "cnt": 32}, "MoE_L0_bwd":{"total": 392.12, "avg": 12.25, "max": 11.32, "min": 13.30, "cnt": 32}, "backward-send-forward-recv":{"total": 4775.22, "avg": 164.66, "max": 2.47, "min": 418.27, "cnt": 29}, "backward-send":{"total": 2.57, "avg": 0.86, "max": 0.66, "min": 1.16, "cnt": 3}, "backward-recv":{"total": 131.83, "avg": 65.91, "max": 60.06, "min": 71.77, "cnt": 2}, "backward-params-all-reduce":{"total": 493.39, "avg": 493.39, "max": 493.39, "min": 493.39, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 344.22, "avg": 344.22, "max": 344.22, "min": 344.22, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.40, "avg": 3.40, "max": 3.40, "min": 3.40, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 299.83, "avg": 299.83, "max": 299.83, "min": 299.83, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.92, "avg": 6.92, "max": 6.92, "min": 6.92, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 44, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.06, "avg": 0.06, "max": 0.06, "min": 0.06, "cnt": 1}, "forward-recv":{"total": 70.82, "avg": 23.61, "max": 0.95, "min": 66.87, "cnt": 3}, "forward-compute":{"total": 1841.58, "avg": 57.55, "max": 52.10, "min": 69.43, "cnt": 32}, "fwd-compute":{"total": 1838.49, "avg": 57.45, "max": 52.04, "min": 69.34, "cnt": 32}, "batch-generator":{"total": 66.16, "avg": 2.07, "max": 0.68, "min": 4.47, "cnt": 32}, "fwd-embedding":{"total": 0.66, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1759.88, "avg": 55.00, "max": 50.78, "min": 67.11, "cnt": 32}, "fwd-layernorm":{"total": 10.03, "avg": 0.08, "max": 0.05, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 107.38, "avg": 0.84, "max": 0.74, "min": 1.54, "cnt": 128}, "fwd-misc":{"total": 21.11, "avg": 0.16, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1600.69, "avg": 12.51, "max": 10.64, "min": 20.01, "cnt": 128}, "MoE_L0_fwd":{"total": 463.84, "avg": 14.50, "max": 11.82, "min": 19.93, "cnt": 32}, "MoEMLP":{"total": 1583.84, "avg": 12.37, "max": 10.52, "min": 19.89, "cnt": 128}, "MoE_L1_fwd":{"total": 374.53, "avg": 11.70, "max": 10.60, "min": 15.51, "cnt": 32}, "MoE_L2_fwd":{"total": 362.88, "avg": 11.34, "max": 10.57, "min": 12.86, "cnt": 32}, "MoE_L3_fwd":{"total": 388.85, "avg": 12.15, "max": 11.03, "min": 16.36, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 7.38, "avg": 3.69, "max": 0.91, "min": 6.48, "cnt": 2}, "forward-send-backward-recv":{"total": 210.12, "avg": 7.00, "max": 1.32, "min": 130.32, "cnt": 30}, "backward-compute":{"total": 1781.75, "avg": 55.68, "max": 53.24, "min": 59.14, "cnt": 32}, "MoE_L3_bwd":{"total": 440.05, "avg": 13.75, "max": 12.93, "min": 16.09, "cnt": 32}, "MoE_L2_bwd":{"total": 377.65, "avg": 11.80, "max": 10.87, "min": 13.16, "cnt": 32}, "MoE_L1_bwd":{"total": 366.79, "avg": 11.46, "max": 10.77, "min": 12.30, "cnt": 32}, "MoE_L0_bwd":{"total": 384.65, "avg": 12.02, "max": 11.49, "min": 13.62, "cnt": 32}, "backward-send-forward-recv":{"total": 6923.02, "avg": 238.72, "max": 2.54, "min": 1553.98, "cnt": 29}, "backward-send":{"total": 3.09, "avg": 1.03, "max": 0.96, "min": 1.07, "cnt": 3}, "backward-recv":{"total": 186.05, "avg": 93.03, "max": 66.00, "min": 120.05, "cnt": 2}, "backward-params-all-reduce":{"total": 487.58, "avg": 487.58, "max": 487.58, "min": 487.58, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 264.53, "avg": 264.53, "max": 264.53, "min": 264.53, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 220.45, "avg": 220.45, "max": 220.45, "min": 220.45, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.77, "avg": 6.77, "max": 6.77, "min": 6.77, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 45, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 72.72, "avg": 24.24, "max": 6.14, "min": 58.79, "cnt": 3}, "forward-compute":{"total": 1865.54, "avg": 58.30, "max": 51.40, "min": 64.77, "cnt": 32}, "fwd-compute":{"total": 1862.85, "avg": 58.21, "max": 51.34, "min": 64.70, "cnt": 32}, "batch-generator":{"total": 38.01, "avg": 1.19, "max": 0.67, "min": 2.71, "cnt": 32}, "fwd-embedding":{"total": 0.49, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1813.43, "avg": 56.67, "max": 50.33, "min": 62.51, "cnt": 32}, "fwd-layernorm":{"total": 9.07, "avg": 0.07, "max": 0.05, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 106.67, "avg": 0.83, "max": 0.74, "min": 2.11, "cnt": 128}, "fwd-misc":{"total": 20.79, "avg": 0.16, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1656.33, "avg": 12.94, "max": 10.38, "min": 21.16, "cnt": 128}, "MoE_L0_fwd":{"total": 481.58, "avg": 15.05, "max": 11.71, "min": 21.09, "cnt": 32}, "MoEMLP":{"total": 1639.31, "avg": 12.81, "max": 10.27, "min": 21.04, "cnt": 128}, "MoE_L1_fwd":{"total": 383.55, "avg": 11.99, "max": 10.60, "min": 13.53, "cnt": 32}, "MoE_L2_fwd":{"total": 366.76, "avg": 11.46, "max": 10.31, "min": 12.89, "cnt": 32}, "MoE_L3_fwd":{"total": 413.56, "avg": 12.92, "max": 11.95, "min": 16.36, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.70, "avg": 0.85, "max": 0.82, "min": 0.89, "cnt": 2}, "forward-send-backward-recv":{"total": 195.82, "avg": 6.53, "max": 1.48, "min": 114.97, "cnt": 30}, "backward-compute":{"total": 1802.06, "avg": 56.31, "max": 52.46, "min": 60.52, "cnt": 32}, "MoE_L3_bwd":{"total": 469.27, "avg": 14.66, "max": 13.77, "min": 18.53, "cnt": 32}, "MoE_L2_bwd":{"total": 378.83, "avg": 11.84, "max": 10.65, "min": 12.24, "cnt": 32}, "MoE_L1_bwd":{"total": 359.17, "avg": 11.22, "max": 10.31, "min": 12.10, "cnt": 32}, "MoE_L0_bwd":{"total": 382.06, "avg": 11.94, "max": 11.11, "min": 12.55, "cnt": 32}, "backward-send-forward-recv":{"total": 4285.43, "avg": 147.77, "max": 2.43, "min": 308.58, "cnt": 29}, "backward-send":{"total": 3.03, "avg": 1.01, "max": 0.97, "min": 1.05, "cnt": 3}, "backward-recv":{"total": 121.18, "avg": 60.59, "max": 49.84, "min": 71.34, "cnt": 2}, "backward-params-all-reduce":{"total": 490.87, "avg": 490.87, "max": 490.87, "min": 490.87, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 264.98, "avg": 264.98, "max": 264.98, "min": 264.98, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 220.76, "avg": 220.76, "max": 220.76, "min": 220.76, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.88, "avg": 6.88, "max": 6.88, "min": 6.88, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 46, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.10, "avg": 0.10, "max": 0.10, "min": 0.10, "cnt": 1}, "forward-recv":{"total": 74.36, "avg": 24.79, "max": 1.56, "min": 63.32, "cnt": 3}, "forward-compute":{"total": 1829.56, "avg": 57.17, "max": 50.33, "min": 66.05, "cnt": 32}, "fwd-compute":{"total": 1826.45, "avg": 57.08, "max": 50.26, "min": 65.95, "cnt": 32}, "batch-generator":{"total": 66.50, "avg": 2.08, "max": 0.67, "min": 4.86, "cnt": 32}, "fwd-embedding":{"total": 0.63, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1747.68, "avg": 54.61, "max": 49.20, "min": 62.35, "cnt": 32}, "fwd-layernorm":{"total": 9.94, "avg": 0.08, "max": 0.05, "min": 0.27, "cnt": 128}, "fwd-attn":{"total": 108.18, "avg": 0.85, "max": 0.74, "min": 2.36, "cnt": 128}, "fwd-misc":{"total": 21.01, "avg": 0.16, "max": 0.11, "min": 0.45, "cnt": 128}, "fwd-MLP":{"total": 1587.48, "avg": 12.40, "max": 10.53, "min": 20.31, "cnt": 128}, "MoE_L0_fwd":{"total": 472.28, "avg": 14.76, "max": 11.60, "min": 20.22, "cnt": 32}, "MoEMLP":{"total": 1570.41, "avg": 12.27, "max": 10.41, "min": 20.18, "cnt": 128}, "MoE_L1_fwd":{"total": 377.93, "avg": 11.81, "max": 10.54, "min": 13.80, "cnt": 32}, "MoE_L2_fwd":{"total": 353.14, "avg": 11.04, "max": 10.46, "min": 12.26, "cnt": 32}, "MoE_L3_fwd":{"total": 373.33, "avg": 11.67, "max": 11.06, "min": 13.90, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.91, "avg": 0.95, "max": 0.94, "min": 0.96, "cnt": 2}, "forward-send-backward-recv":{"total": 201.13, "avg": 6.70, "max": 1.30, "min": 120.23, "cnt": 30}, "backward-compute":{"total": 1737.75, "avg": 54.30, "max": 50.98, "min": 55.86, "cnt": 32}, "MoE_L3_bwd":{"total": 427.29, "avg": 13.35, "max": 12.37, "min": 15.15, "cnt": 32}, "MoE_L2_bwd":{"total": 362.56, "avg": 11.33, "max": 10.10, "min": 11.87, "cnt": 32}, "MoE_L1_bwd":{"total": 353.33, "avg": 11.04, "max": 10.35, "min": 11.71, "cnt": 32}, "MoE_L0_bwd":{"total": 382.77, "avg": 11.96, "max": 11.48, "min": 12.87, "cnt": 32}, "backward-send-forward-recv":{"total": 7147.41, "avg": 246.46, "max": 1.73, "min": 2257.62, "cnt": 29}, "backward-send":{"total": 3.09, "avg": 1.03, "max": 0.93, "min": 1.15, "cnt": 3}, "backward-recv":{"total": 140.29, "avg": 70.14, "max": 57.52, "min": 82.77, "cnt": 2}, "backward-params-all-reduce":{"total": 488.96, "avg": 488.96, "max": 488.96, "min": 488.96, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 270.17, "avg": 270.17, "max": 270.17, "min": 270.17, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 225.85, "avg": 225.85, "max": 225.85, "min": 225.85, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.89, "avg": 6.89, "max": 6.89, "min": 6.89, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 47, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.06, "avg": 0.06, "max": 0.06, "min": 0.06, "cnt": 1}, "forward-recv":{"total": 96.16, "avg": 32.05, "max": 3.94, "min": 84.41, "cnt": 3}, "forward-compute":{"total": 1816.78, "avg": 56.77, "max": 50.04, "min": 70.53, "cnt": 32}, "fwd-compute":{"total": 1813.84, "avg": 56.68, "max": 49.97, "min": 70.44, "cnt": 32}, "batch-generator":{"total": 58.36, "avg": 1.82, "max": 0.65, "min": 3.95, "cnt": 32}, "fwd-embedding":{"total": 0.61, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1743.66, "avg": 54.49, "max": 49.02, "min": 67.49, "cnt": 32}, "fwd-layernorm":{"total": 9.42, "avg": 0.07, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 106.98, "avg": 0.84, "max": 0.74, "min": 1.52, "cnt": 128}, "fwd-misc":{"total": 20.18, "avg": 0.16, "max": 0.11, "min": 0.34, "cnt": 128}, "fwd-MLP":{"total": 1587.04, "avg": 12.40, "max": 9.98, "min": 25.30, "cnt": 128}, "MoE_L0_fwd":{"total": 481.96, "avg": 15.06, "max": 11.35, "min": 25.22, "cnt": 32}, "MoEMLP":{"total": 1570.50, "avg": 12.27, "max": 9.86, "min": 25.17, "cnt": 128}, "MoE_L1_fwd":{"total": 389.20, "avg": 12.16, "max": 11.01, "min": 14.27, "cnt": 32}, "MoE_L2_fwd":{"total": 342.89, "avg": 10.72, "max": 9.90, "min": 11.78, "cnt": 32}, "MoE_L3_fwd":{"total": 362.50, "avg": 11.33, "max": 10.47, "min": 16.42, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.55, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.92, "avg": 0.96, "max": 0.95, "min": 0.97, "cnt": 2}, "forward-send-backward-recv":{"total": 199.59, "avg": 6.65, "max": 1.45, "min": 118.07, "cnt": 30}, "backward-compute":{"total": 1692.46, "avg": 52.89, "max": 50.40, "min": 57.17, "cnt": 32}, "MoE_L3_bwd":{"total": 392.44, "avg": 12.26, "max": 10.87, "min": 13.61, "cnt": 32}, "MoE_L2_bwd":{"total": 345.90, "avg": 10.81, "max": 9.84, "min": 14.35, "cnt": 32}, "MoE_L1_bwd":{"total": 362.66, "avg": 11.33, "max": 10.69, "min": 11.78, "cnt": 32}, "MoE_L0_bwd":{"total": 378.64, "avg": 11.83, "max": 11.33, "min": 12.12, "cnt": 32}, "backward-send-forward-recv":{"total": 5888.24, "avg": 203.04, "max": 2.40, "min": 813.20, "cnt": 29}, "backward-send":{"total": 2.64, "avg": 0.88, "max": 0.68, "min": 1.05, "cnt": 3}, "backward-recv":{"total": 121.36, "avg": 60.68, "max": 52.78, "min": 68.58, "cnt": 2}, "backward-params-all-reduce":{"total": 490.34, "avg": 490.34, "max": 490.34, "min": 490.34, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 258.80, "avg": 258.80, "max": 258.80, "min": 258.80, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 214.75, "avg": 214.75, "max": 214.75, "min": 214.75, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.82, "avg": 6.82, "max": 6.82, "min": 6.82, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}}}
{"type":"time", "iteration": 48, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 64.90, "avg": 21.63, "max": 3.32, "min": 56.63, "cnt": 3}, "forward-compute":{"total": 1846.67, "avg": 57.71, "max": 50.43, "min": 65.21, "cnt": 32}, "fwd-compute":{"total": 1843.55, "avg": 57.61, "max": 50.36, "min": 65.08, "cnt": 32}, "batch-generator":{"total": 49.23, "avg": 1.54, "max": 0.64, "min": 3.06, "cnt": 32}, "fwd-embedding":{"total": 0.68, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1781.89, "avg": 55.68, "max": 49.13, "min": 63.12, "cnt": 32}, "fwd-layernorm":{"total": 9.87, "avg": 0.08, "max": 0.05, "min": 0.18, "cnt": 128}, "fwd-attn":{"total": 107.84, "avg": 0.84, "max": 0.74, "min": 1.54, "cnt": 128}, "fwd-misc":{"total": 21.10, "avg": 0.16, "max": 0.11, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1622.43, "avg": 12.68, "max": 10.34, "min": 19.56, "cnt": 128}, "MoE_L0_fwd":{"total": 477.08, "avg": 14.91, "max": 11.17, "min": 19.43, "cnt": 32}, "MoEMLP":{"total": 1605.50, "avg": 12.54, "max": 10.24, "min": 19.36, "cnt": 128}, "MoE_L1_fwd":{"total": 382.58, "avg": 11.96, "max": 10.93, "min": 14.10, "cnt": 32}, "MoE_L2_fwd":{"total": 347.83, "avg": 10.87, "max": 10.28, "min": 12.28, "cnt": 32}, "MoE_L3_fwd":{"total": 404.24, "avg": 12.63, "max": 11.88, "min": 15.32, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.71, "avg": 0.86, "max": 0.80, "min": 0.92, "cnt": 2}, "forward-send-backward-recv":{"total": 487.50, "avg": 16.25, "max": 1.41, "min": 140.86, "cnt": 30}, "backward-compute":{"total": 1780.04, "avg": 55.63, "max": 54.12, "min": 63.52, "cnt": 32}, "MoE_L3_bwd":{"total": 471.15, "avg": 14.72, "max": 13.61, "min": 21.63, "cnt": 32}, "MoE_L2_bwd":{"total": 353.92, "avg": 11.06, "max": 10.26, "min": 12.51, "cnt": 32}, "MoE_L1_bwd":{"total": 370.43, "avg": 11.58, "max": 10.69, "min": 12.65, "cnt": 32}, "MoE_L0_bwd":{"total": 371.25, "avg": 11.60, "max": 11.11, "min": 12.24, "cnt": 32}, "backward-send-forward-recv":{"total": 3612.28, "avg": 124.56, "max": 2.39, "min": 711.77, "cnt": 29}, "backward-send":{"total": 3.03, "avg": 1.01, "max": 0.81, "min": 1.15, "cnt": 3}, "backward-recv":{"total": 265.26, "avg": 132.63, "max": 70.38, "min": 194.88, "cnt": 2}, "backward-params-all-reduce":{"total": 488.15, "avg": 488.15, "max": 488.15, "min": 488.15, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 263.95, "avg": 263.95, "max": 263.95, "min": 263.95, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 219.81, "avg": 219.81, "max": 219.81, "min": 219.81, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.81, "avg": 6.81, "max": 6.81, "min": 6.81, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 49, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 66.29, "avg": 22.10, "max": 1.76, "min": 59.63, "cnt": 3}, "forward-compute":{"total": 1881.72, "avg": 58.80, "max": 52.26, "min": 72.56, "cnt": 32}, "fwd-compute":{"total": 1878.39, "avg": 58.70, "max": 52.18, "min": 72.48, "cnt": 32}, "batch-generator":{"total": 42.81, "avg": 1.34, "max": 0.68, "min": 2.63, "cnt": 32}, "fwd-embedding":{"total": 0.73, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1822.37, "avg": 56.95, "max": 51.10, "min": 71.21, "cnt": 32}, "fwd-layernorm":{"total": 10.57, "avg": 0.08, "max": 0.05, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 112.20, "avg": 0.88, "max": 0.74, "min": 1.48, "cnt": 128}, "fwd-misc":{"total": 22.11, "avg": 0.17, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1655.59, "avg": 12.93, "max": 10.61, "min": 26.35, "cnt": 128}, "MoE_L0_fwd":{"total": 509.61, "avg": 15.93, "max": 12.19, "min": 26.25, "cnt": 32}, "MoEMLP":{"total": 1637.66, "avg": 12.79, "max": 10.49, "min": 26.20, "cnt": 128}, "MoE_L1_fwd":{"total": 375.44, "avg": 11.73, "max": 10.54, "min": 14.78, "cnt": 32}, "MoE_L2_fwd":{"total": 366.18, "avg": 11.44, "max": 10.71, "min": 13.91, "cnt": 32}, "MoE_L3_fwd":{"total": 392.96, "avg": 12.28, "max": 11.52, "min": 13.81, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 2.79, "avg": 1.39, "max": 0.86, "min": 1.93, "cnt": 2}, "forward-send-backward-recv":{"total": 670.87, "avg": 22.36, "max": 1.32, "min": 120.34, "cnt": 30}, "backward-compute":{"total": 1762.60, "avg": 55.08, "max": 54.24, "min": 55.99, "cnt": 32}, "MoE_L3_bwd":{"total": 443.41, "avg": 13.86, "max": 13.22, "min": 14.99, "cnt": 32}, "MoE_L2_bwd":{"total": 369.60, "avg": 11.55, "max": 10.84, "min": 12.22, "cnt": 32}, "MoE_L1_bwd":{"total": 355.95, "avg": 11.12, "max": 10.82, "min": 13.02, "cnt": 32}, "MoE_L0_bwd":{"total": 379.68, "avg": 11.86, "max": 11.17, "min": 12.47, "cnt": 32}, "backward-send-forward-recv":{"total": 5066.96, "avg": 174.72, "max": 2.24, "min": 722.75, "cnt": 29}, "backward-send":{"total": 2.77, "avg": 0.92, "max": 0.81, "min": 0.98, "cnt": 3}, "backward-recv":{"total": 569.93, "avg": 284.96, "max": 63.54, "min": 506.38, "cnt": 2}, "backward-params-all-reduce":{"total": 496.94, "avg": 496.94, "max": 496.94, "min": 496.94, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 245.63, "avg": 245.63, "max": 245.63, "min": 245.63, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 205.81, "avg": 205.81, "max": 205.81, "min": 205.81, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.35, "avg": 3.35, "max": 3.35, "min": 3.35, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 50, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 69.42, "avg": 23.14, "max": 1.06, "min": 67.07, "cnt": 3}, "forward-compute":{"total": 1876.76, "avg": 58.65, "max": 51.82, "min": 65.37, "cnt": 32}, "fwd-compute":{"total": 1873.88, "avg": 58.56, "max": 51.75, "min": 65.29, "cnt": 32}, "batch-generator":{"total": 41.27, "avg": 1.29, "max": 0.66, "min": 4.40, "cnt": 32}, "fwd-embedding":{"total": 0.56, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1820.63, "avg": 56.89, "max": 50.65, "min": 63.98, "cnt": 32}, "fwd-layernorm":{"total": 9.23, "avg": 0.07, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 106.58, "avg": 0.83, "max": 0.74, "min": 2.01, "cnt": 128}, "fwd-misc":{"total": 20.05, "avg": 0.16, "max": 0.11, "min": 0.34, "cnt": 128}, "fwd-MLP":{"total": 1664.38, "avg": 13.00, "max": 10.58, "min": 23.35, "cnt": 128}, "MoE_L0_fwd":{"total": 513.78, "avg": 16.06, "max": 12.16, "min": 23.26, "cnt": 32}, "MoEMLP":{"total": 1647.60, "avg": 12.87, "max": 10.47, "min": 23.22, "cnt": 128}, "MoE_L1_fwd":{"total": 385.44, "avg": 12.05, "max": 10.51, "min": 17.51, "cnt": 32}, "MoE_L2_fwd":{"total": 367.84, "avg": 11.49, "max": 10.69, "min": 13.78, "cnt": 32}, "MoE_L3_fwd":{"total": 386.57, "avg": 12.08, "max": 11.66, "min": 13.06, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.77, "avg": 0.88, "max": 0.77, "min": 1.00, "cnt": 2}, "forward-send-backward-recv":{"total": 326.75, "avg": 10.89, "max": 1.61, "min": 120.08, "cnt": 30}, "backward-compute":{"total": 1776.86, "avg": 55.53, "max": 53.70, "min": 59.53, "cnt": 32}, "MoE_L3_bwd":{"total": 436.92, "avg": 13.65, "max": 12.71, "min": 16.03, "cnt": 32}, "MoE_L2_bwd":{"total": 378.02, "avg": 11.81, "max": 10.87, "min": 14.71, "cnt": 32}, "MoE_L1_bwd":{"total": 357.12, "avg": 11.16, "max": 10.43, "min": 11.50, "cnt": 32}, "MoE_L0_bwd":{"total": 390.07, "avg": 12.19, "max": 11.41, "min": 14.42, "cnt": 32}, "backward-send-forward-recv":{"total": 5890.13, "avg": 203.11, "max": 1.65, "min": 1859.66, "cnt": 29}, "backward-send":{"total": 2.75, "avg": 0.92, "max": 0.87, "min": 0.99, "cnt": 3}, "backward-recv":{"total": 135.02, "avg": 67.51, "max": 62.14, "min": 72.88, "cnt": 2}, "backward-params-all-reduce":{"total": 489.97, "avg": 489.97, "max": 489.97, "min": 489.97, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 258.25, "avg": 258.25, "max": 258.25, "min": 258.25, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 218.42, "avg": 218.42, "max": 218.42, "min": 218.42, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.29, "avg": 3.29, "max": 3.29, "min": 3.29, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.47, "avg": 3.47, "max": 3.47, "min": 3.47, "cnt": 1}}}
{"type":"time", "iteration": 51, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 77.71, "avg": 25.90, "max": 1.10, "min": 75.34, "cnt": 3}, "forward-compute":{"total": 1918.98, "avg": 59.97, "max": 51.41, "min": 70.42, "cnt": 32}, "fwd-compute":{"total": 1915.80, "avg": 59.87, "max": 51.33, "min": 70.35, "cnt": 32}, "batch-generator":{"total": 54.61, "avg": 1.71, "max": 0.75, "min": 3.86, "cnt": 32}, "fwd-embedding":{"total": 0.75, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1847.99, "avg": 57.75, "max": 50.20, "min": 67.95, "cnt": 32}, "fwd-layernorm":{"total": 10.74, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 114.21, "avg": 0.89, "max": 0.74, "min": 1.89, "cnt": 128}, "fwd-misc":{"total": 22.59, "avg": 0.18, "max": 0.11, "min": 0.38, "cnt": 128}, "fwd-MLP":{"total": 1677.81, "avg": 13.11, "max": 10.71, "min": 26.53, "cnt": 128}, "MoE_L0_fwd":{"total": 532.60, "avg": 16.64, "max": 12.22, "min": 26.45, "cnt": 32}, "MoEMLP":{"total": 1659.43, "avg": 12.96, "max": 10.58, "min": 26.40, "cnt": 128}, "MoE_L1_fwd":{"total": 370.03, "avg": 11.56, "max": 10.66, "min": 14.01, "cnt": 32}, "MoE_L2_fwd":{"total": 368.38, "avg": 11.51, "max": 10.63, "min": 14.50, "cnt": 32}, "MoE_L3_fwd":{"total": 395.13, "avg": 12.35, "max": 11.51, "min": 14.65, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.77, "avg": 0.88, "max": 0.83, "min": 0.94, "cnt": 2}, "forward-send-backward-recv":{"total": 205.87, "avg": 6.86, "max": 1.50, "min": 122.37, "cnt": 30}, "backward-compute":{"total": 1833.54, "avg": 57.30, "max": 51.93, "min": 108.83, "cnt": 32}, "MoE_L3_bwd":{"total": 487.88, "avg": 15.25, "max": 12.46, "min": 67.85, "cnt": 32}, "MoE_L2_bwd":{"total": 378.24, "avg": 11.82, "max": 10.45, "min": 14.38, "cnt": 32}, "MoE_L1_bwd":{"total": 364.77, "avg": 11.40, "max": 10.73, "min": 12.45, "cnt": 32}, "MoE_L0_bwd":{"total": 390.90, "avg": 12.22, "max": 11.52, "min": 13.11, "cnt": 32}, "backward-send-forward-recv":{"total": 4798.98, "avg": 165.48, "max": 2.15, "min": 646.14, "cnt": 29}, "backward-send":{"total": 3.35, "avg": 1.12, "max": 1.07, "min": 1.16, "cnt": 3}, "backward-recv":{"total": 127.85, "avg": 63.93, "max": 55.67, "min": 72.18, "cnt": 2}, "backward-params-all-reduce":{"total": 486.54, "avg": 486.54, "max": 486.54, "min": 486.54, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "optimizer":{"total": 261.44, "avg": 261.44, "max": 261.44, "min": 261.44, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 5.39, "avg": 5.39, "max": 5.39, "min": 5.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 219.42, "avg": 219.42, "max": 219.42, "min": 219.42, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.34, "avg": 3.34, "max": 3.34, "min": 3.34, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 52, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.06, "avg": 0.06, "max": 0.06, "min": 0.06, "cnt": 1}, "forward-recv":{"total": 66.25, "avg": 22.08, "max": 0.93, "min": 64.10, "cnt": 3}, "forward-compute":{"total": 1931.32, "avg": 60.35, "max": 52.33, "min": 133.48, "cnt": 32}, "fwd-compute":{"total": 1928.02, "avg": 60.25, "max": 52.26, "min": 133.31, "cnt": 32}, "batch-generator":{"total": 46.16, "avg": 1.44, "max": 0.70, "min": 3.26, "cnt": 32}, "fwd-embedding":{"total": 0.70, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1868.88, "avg": 58.40, "max": 51.20, "min": 130.91, "cnt": 32}, "fwd-layernorm":{"total": 10.20, "avg": 0.08, "max": 0.06, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 110.01, "avg": 0.86, "max": 0.74, "min": 1.54, "cnt": 128}, "fwd-misc":{"total": 21.82, "avg": 0.17, "max": 0.11, "min": 0.40, "cnt": 128}, "fwd-MLP":{"total": 1705.30, "avg": 13.32, "max": 10.40, "min": 81.90, "cnt": 128}, "MoE_L0_fwd":{"total": 497.68, "avg": 15.55, "max": 11.87, "min": 19.33, "cnt": 32}, "MoEMLP":{"total": 1687.83, "avg": 13.19, "max": 10.29, "min": 81.76, "cnt": 128}, "MoE_L1_fwd":{"total": 450.20, "avg": 14.07, "max": 10.88, "min": 81.81, "cnt": 32}, "MoE_L2_fwd":{"total": 359.66, "avg": 11.24, "max": 10.33, "min": 13.74, "cnt": 32}, "MoE_L3_fwd":{"total": 386.58, "avg": 12.08, "max": 11.43, "min": 13.40, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 5.91, "avg": 2.95, "max": 0.75, "min": 5.15, "cnt": 2}, "forward-send-backward-recv":{"total": 255.90, "avg": 8.53, "max": 1.79, "min": 123.87, "cnt": 30}, "backward-compute":{"total": 1713.48, "avg": 53.55, "max": 50.89, "min": 55.89, "cnt": 32}, "MoE_L3_bwd":{"total": 433.80, "avg": 13.56, "max": 12.33, "min": 15.70, "cnt": 32}, "MoE_L2_bwd":{"total": 329.63, "avg": 10.30, "max": 9.77, "min": 10.78, "cnt": 32}, "MoE_L1_bwd":{"total": 355.31, "avg": 11.10, "max": 10.54, "min": 11.76, "cnt": 32}, "MoE_L0_bwd":{"total": 380.14, "avg": 11.88, "max": 11.27, "min": 12.74, "cnt": 32}, "backward-send-forward-recv":{"total": 4989.75, "avg": 172.06, "max": 1.71, "min": 750.82, "cnt": 29}, "backward-send":{"total": 2.71, "avg": 0.90, "max": 0.74, "min": 1.06, "cnt": 3}, "backward-recv":{"total": 261.20, "avg": 130.60, "max": 77.53, "min": 183.68, "cnt": 2}, "backward-params-all-reduce":{"total": 489.16, "avg": 489.16, "max": 489.16, "min": 489.16, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 258.83, "avg": 258.83, "max": 258.83, "min": 258.83, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 219.10, "avg": 219.10, "max": 219.10, "min": 219.10, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.31, "avg": 3.31, "max": 3.31, "min": 3.31, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}}}
{"type":"time", "iteration": 53, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 60.70, "avg": 20.23, "max": 1.26, "min": 56.91, "cnt": 3}, "forward-compute":{"total": 1870.93, "avg": 58.47, "max": 52.32, "min": 66.07, "cnt": 32}, "fwd-compute":{"total": 1867.63, "avg": 58.36, "max": 52.25, "min": 65.92, "cnt": 32}, "batch-generator":{"total": 48.08, "avg": 1.50, "max": 0.71, "min": 2.86, "cnt": 32}, "fwd-embedding":{"total": 0.72, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1806.82, "avg": 56.46, "max": 51.13, "min": 63.91, "cnt": 32}, "fwd-layernorm":{"total": 10.62, "avg": 0.08, "max": 0.06, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 112.76, "avg": 0.88, "max": 0.74, "min": 1.96, "cnt": 128}, "fwd-misc":{"total": 21.97, "avg": 0.17, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1639.44, "avg": 12.81, "max": 10.62, "min": 19.22, "cnt": 128}, "MoE_L0_fwd":{"total": 499.90, "avg": 15.62, "max": 12.34, "min": 19.15, "cnt": 32}, "MoEMLP":{"total": 1621.70, "avg": 12.67, "max": 10.50, "min": 19.08, "cnt": 128}, "MoE_L1_fwd":{"total": 380.31, "avg": 11.88, "max": 10.93, "min": 15.64, "cnt": 32}, "MoE_L2_fwd":{"total": 359.02, "avg": 11.22, "max": 10.54, "min": 13.25, "cnt": 32}, "MoE_L3_fwd":{"total": 389.00, "avg": 12.16, "max": 11.39, "min": 14.81, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.56, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 5.72, "avg": 2.86, "max": 0.95, "min": 4.78, "cnt": 2}, "forward-send-backward-recv":{"total": 291.57, "avg": 9.72, "max": 1.54, "min": 123.64, "cnt": 30}, "backward-compute":{"total": 1702.73, "avg": 53.21, "max": 49.37, "min": 57.40, "cnt": 32}, "MoE_L3_bwd":{"total": 442.47, "avg": 13.83, "max": 12.59, "min": 17.42, "cnt": 32}, "MoE_L2_bwd":{"total": 344.80, "avg": 10.78, "max": 9.94, "min": 12.08, "cnt": 32}, "MoE_L1_bwd":{"total": 322.52, "avg": 10.08, "max": 9.47, "min": 10.73, "cnt": 32}, "MoE_L0_bwd":{"total": 379.14, "avg": 11.85, "max": 10.75, "min": 12.77, "cnt": 32}, "backward-send-forward-recv":{"total": 5240.82, "avg": 180.72, "max": 2.17, "min": 1054.26, "cnt": 29}, "backward-send":{"total": 2.52, "avg": 0.84, "max": 0.76, "min": 0.98, "cnt": 3}, "backward-recv":{"total": 155.76, "avg": 77.88, "max": 77.81, "min": 77.96, "cnt": 2}, "backward-params-all-reduce":{"total": 487.52, "avg": 487.52, "max": 487.52, "min": 487.52, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 256.25, "avg": 256.25, "max": 256.25, "min": 256.25, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 216.41, "avg": 216.41, "max": 216.41, "min": 216.41, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 54, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 61.27, "avg": 20.42, "max": 1.00, "min": 59.00, "cnt": 3}, "forward-compute":{"total": 1872.62, "avg": 58.52, "max": 52.50, "min": 65.80, "cnt": 32}, "fwd-compute":{"total": 1869.45, "avg": 58.42, "max": 52.42, "min": 65.71, "cnt": 32}, "batch-generator":{"total": 47.56, "avg": 1.49, "max": 0.76, "min": 3.54, "cnt": 32}, "fwd-embedding":{"total": 0.70, "avg": 0.02, "max": 0.01, "min": 0.06, "cnt": 32}, "fwd-encoder":{"total": 1809.20, "avg": 56.54, "max": 50.98, "min": 62.50, "cnt": 32}, "fwd-layernorm":{"total": 10.22, "avg": 0.08, "max": 0.06, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 112.70, "avg": 0.88, "max": 0.74, "min": 2.37, "cnt": 128}, "fwd-misc":{"total": 21.66, "avg": 0.17, "max": 0.11, "min": 0.39, "cnt": 128}, "fwd-MLP":{"total": 1643.21, "avg": 12.84, "max": 10.42, "min": 19.38, "cnt": 128}, "MoE_L0_fwd":{"total": 513.52, "avg": 16.05, "max": 13.27, "min": 19.21, "cnt": 32}, "MoEMLP":{"total": 1625.65, "avg": 12.70, "max": 10.30, "min": 19.16, "cnt": 128}, "MoE_L1_fwd":{"total": 384.24, "avg": 12.01, "max": 10.83, "min": 15.11, "cnt": 32}, "MoE_L2_fwd":{"total": 350.79, "avg": 10.96, "max": 10.34, "min": 12.46, "cnt": 32}, "MoE_L3_fwd":{"total": 383.45, "avg": 11.98, "max": 11.33, "min": 13.09, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 2.73, "avg": 1.37, "max": 0.79, "min": 1.95, "cnt": 2}, "forward-send-backward-recv":{"total": 1211.31, "avg": 40.38, "max": 1.43, "min": 234.50, "cnt": 30}, "backward-compute":{"total": 1725.19, "avg": 53.91, "max": 51.69, "min": 60.37, "cnt": 32}, "MoE_L3_bwd":{"total": 448.20, "avg": 14.01, "max": 12.82, "min": 19.52, "cnt": 32}, "MoE_L2_bwd":{"total": 353.19, "avg": 11.04, "max": 10.07, "min": 11.92, "cnt": 32}, "MoE_L1_bwd":{"total": 318.11, "avg": 9.94, "max": 9.61, "min": 10.23, "cnt": 32}, "MoE_L0_bwd":{"total": 391.83, "avg": 12.24, "max": 11.27, "min": 14.03, "cnt": 32}, "backward-send-forward-recv":{"total": 3860.60, "avg": 133.12, "max": 2.40, "min": 818.70, "cnt": 29}, "backward-send":{"total": 2.80, "avg": 0.93, "max": 0.82, "min": 1.14, "cnt": 3}, "backward-recv":{"total": 194.27, "avg": 97.14, "max": 73.64, "min": 120.63, "cnt": 2}, "backward-params-all-reduce":{"total": 488.63, "avg": 488.63, "max": 488.63, "min": 488.63, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 256.53, "avg": 256.53, "max": 256.53, "min": 256.53, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 216.68, "avg": 216.68, "max": 216.68, "min": 216.68, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.23, "avg": 3.23, "max": 3.23, "min": 3.23, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.47, "avg": 3.47, "max": 3.47, "min": 3.47, "cnt": 1}}}
{"type":"time", "iteration": 55, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.06, "avg": 0.06, "max": 0.06, "min": 0.06, "cnt": 1}, "forward-recv":{"total": 65.94, "avg": 21.98, "max": 1.07, "min": 63.63, "cnt": 3}, "forward-compute":{"total": 1845.36, "avg": 57.67, "max": 51.57, "min": 64.89, "cnt": 32}, "fwd-compute":{"total": 1842.48, "avg": 57.58, "max": 51.50, "min": 64.81, "cnt": 32}, "batch-generator":{"total": 50.82, "avg": 1.59, "max": 0.70, "min": 3.18, "cnt": 32}, "fwd-embedding":{"total": 0.53, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1780.23, "avg": 55.63, "max": 50.47, "min": 62.22, "cnt": 32}, "fwd-layernorm":{"total": 8.93, "avg": 0.07, "max": 0.05, "min": 0.18, "cnt": 128}, "fwd-attn":{"total": 104.08, "avg": 0.81, "max": 0.74, "min": 1.49, "cnt": 128}, "fwd-misc":{"total": 19.92, "avg": 0.16, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1627.76, "avg": 12.72, "max": 10.43, "min": 21.81, "cnt": 128}, "MoE_L0_fwd":{"total": 495.41, "avg": 15.48, "max": 11.71, "min": 21.73, "cnt": 32}, "MoEMLP":{"total": 1611.51, "avg": 12.59, "max": 10.31, "min": 21.69, "cnt": 128}, "MoE_L1_fwd":{"total": 379.23, "avg": 11.85, "max": 11.03, "min": 13.60, "cnt": 32}, "MoE_L2_fwd":{"total": 354.72, "avg": 11.09, "max": 10.36, "min": 12.02, "cnt": 32}, "MoE_L3_fwd":{"total": 388.15, "avg": 12.13, "max": 11.49, "min": 13.07, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.56, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.82, "avg": 0.91, "max": 0.86, "min": 0.97, "cnt": 2}, "forward-send-backward-recv":{"total": 220.43, "avg": 7.35, "max": 1.31, "min": 129.57, "cnt": 30}, "backward-compute":{"total": 1734.17, "avg": 54.19, "max": 51.72, "min": 55.86, "cnt": 32}, "MoE_L3_bwd":{"total": 438.05, "avg": 13.69, "max": 12.92, "min": 14.72, "cnt": 32}, "MoE_L2_bwd":{"total": 350.60, "avg": 10.96, "max": 10.26, "min": 11.68, "cnt": 32}, "MoE_L1_bwd":{"total": 338.08, "avg": 10.56, "max": 9.85, "min": 11.02, "cnt": 32}, "MoE_L0_bwd":{"total": 392.49, "avg": 12.27, "max": 11.68, "min": 12.80, "cnt": 32}, "backward-send-forward-recv":{"total": 4360.64, "avg": 150.37, "max": 2.47, "min": 432.87, "cnt": 29}, "backward-send":{"total": 3.44, "avg": 1.15, "max": 1.14, "min": 1.15, "cnt": 3}, "backward-recv":{"total": 152.04, "avg": 76.02, "max": 74.06, "min": 77.98, "cnt": 2}, "backward-params-all-reduce":{"total": 488.44, "avg": 488.44, "max": 488.44, "min": 488.44, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 258.01, "avg": 258.01, "max": 258.01, "min": 258.01, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 217.64, "avg": 217.64, "max": 217.64, "min": 217.64, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.84, "avg": 3.84, "max": 3.84, "min": 3.84, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 56, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 72.73, "avg": 24.24, "max": 1.02, "min": 70.37, "cnt": 3}, "forward-compute":{"total": 1822.37, "avg": 56.95, "max": 51.27, "min": 64.59, "cnt": 32}, "fwd-compute":{"total": 1819.50, "avg": 56.86, "max": 51.20, "min": 64.50, "cnt": 32}, "batch-generator":{"total": 43.82, "avg": 1.37, "max": 0.66, "min": 2.76, "cnt": 32}, "fwd-embedding":{"total": 0.50, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1763.65, "avg": 55.11, "max": 50.16, "min": 63.02, "cnt": 32}, "fwd-layernorm":{"total": 8.97, "avg": 0.07, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 104.20, "avg": 0.81, "max": 0.74, "min": 1.50, "cnt": 128}, "fwd-misc":{"total": 19.67, "avg": 0.15, "max": 0.11, "min": 0.34, "cnt": 128}, "fwd-MLP":{"total": 1611.06, "avg": 12.59, "max": 10.70, "min": 22.27, "cnt": 128}, "MoE_L0_fwd":{"total": 470.36, "avg": 14.70, "max": 11.29, "min": 22.12, "cnt": 32}, "MoEMLP":{"total": 1594.89, "avg": 12.46, "max": 10.57, "min": 22.07, "cnt": 128}, "MoE_L1_fwd":{"total": 376.84, "avg": 11.78, "max": 10.72, "min": 13.69, "cnt": 32}, "MoE_L2_fwd":{"total": 369.71, "avg": 11.55, "max": 10.62, "min": 12.52, "cnt": 32}, "MoE_L3_fwd":{"total": 383.93, "avg": 12.00, "max": 11.46, "min": 14.96, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 5.98, "avg": 2.99, "max": 0.95, "min": 5.03, "cnt": 2}, "forward-send-backward-recv":{"total": 288.09, "avg": 9.60, "max": 1.52, "min": 125.29, "cnt": 30}, "backward-compute":{"total": 1707.99, "avg": 53.37, "max": 51.12, "min": 56.79, "cnt": 32}, "MoE_L3_bwd":{"total": 436.06, "avg": 13.63, "max": 12.69, "min": 15.21, "cnt": 32}, "MoE_L2_bwd":{"total": 370.04, "avg": 11.56, "max": 10.96, "min": 12.32, "cnt": 32}, "MoE_L1_bwd":{"total": 325.45, "avg": 10.17, "max": 9.54, "min": 10.79, "cnt": 32}, "MoE_L0_bwd":{"total": 357.35, "avg": 11.17, "max": 10.61, "min": 12.08, "cnt": 32}, "backward-send-forward-recv":{"total": 4703.59, "avg": 162.19, "max": 2.50, "min": 573.14, "cnt": 29}, "backward-send":{"total": 3.25, "avg": 1.08, "max": 0.86, "min": 1.23, "cnt": 3}, "backward-recv":{"total": 144.81, "avg": 72.40, "max": 70.91, "min": 73.90, "cnt": 2}, "backward-params-all-reduce":{"total": 497.75, "avg": 497.75, "max": 497.75, "min": 497.75, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 255.19, "avg": 255.19, "max": 255.19, "min": 255.19, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 215.30, "avg": 215.30, "max": 215.30, "min": 215.30, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 57, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.06, "avg": 0.06, "max": 0.06, "min": 0.06, "cnt": 1}, "forward-recv":{"total": 67.18, "avg": 22.39, "max": 0.91, "min": 59.38, "cnt": 3}, "forward-compute":{"total": 1816.22, "avg": 56.76, "max": 51.01, "min": 61.71, "cnt": 32}, "fwd-compute":{"total": 1813.33, "avg": 56.67, "max": 50.94, "min": 61.63, "cnt": 32}, "batch-generator":{"total": 42.06, "avg": 1.31, "max": 0.71, "min": 3.12, "cnt": 32}, "fwd-embedding":{"total": 0.52, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1759.96, "avg": 55.00, "max": 49.86, "min": 60.34, "cnt": 32}, "fwd-layernorm":{"total": 8.95, "avg": 0.07, "max": 0.06, "min": 0.18, "cnt": 128}, "fwd-attn":{"total": 103.30, "avg": 0.81, "max": 0.74, "min": 1.52, "cnt": 128}, "fwd-misc":{"total": 19.88, "avg": 0.16, "max": 0.11, "min": 0.34, "cnt": 128}, "fwd-MLP":{"total": 1608.08, "avg": 12.56, "max": 10.86, "min": 20.53, "cnt": 128}, "MoE_L0_fwd":{"total": 471.31, "avg": 14.73, "max": 11.03, "min": 20.45, "cnt": 32}, "MoEMLP":{"total": 1591.89, "avg": 12.44, "max": 10.74, "min": 20.41, "cnt": 128}, "MoE_L1_fwd":{"total": 383.87, "avg": 12.00, "max": 10.82, "min": 14.39, "cnt": 32}, "MoE_L2_fwd":{"total": 361.69, "avg": 11.30, "max": 10.78, "min": 12.29, "cnt": 32}, "MoE_L3_fwd":{"total": 380.94, "avg": 11.90, "max": 11.39, "min": 13.24, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 8.59, "avg": 4.30, "max": 0.87, "min": 7.72, "cnt": 2}, "forward-send-backward-recv":{"total": 228.47, "avg": 7.62, "max": 1.66, "min": 125.86, "cnt": 30}, "backward-compute":{"total": 1672.24, "avg": 52.26, "max": 50.27, "min": 53.57, "cnt": 32}, "MoE_L3_bwd":{"total": 432.62, "avg": 13.52, "max": 12.69, "min": 14.54, "cnt": 32}, "MoE_L2_bwd":{"total": 372.62, "avg": 11.64, "max": 10.93, "min": 13.02, "cnt": 32}, "MoE_L1_bwd":{"total": 334.86, "avg": 10.46, "max": 9.93, "min": 10.94, "cnt": 32}, "MoE_L0_bwd":{"total": 318.89, "avg": 9.97, "max": 9.40, "min": 10.73, "cnt": 32}, "backward-send-forward-recv":{"total": 5697.76, "avg": 196.47, "max": 2.37, "min": 529.76, "cnt": 29}, "backward-send":{"total": 2.73, "avg": 0.91, "max": 0.83, "min": 0.97, "cnt": 3}, "backward-recv":{"total": 131.31, "avg": 65.66, "max": 58.07, "min": 73.24, "cnt": 2}, "backward-params-all-reduce":{"total": 488.12, "avg": 488.12, "max": 488.12, "min": 488.12, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 254.57, "avg": 254.57, "max": 254.57, "min": 254.57, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 214.82, "avg": 214.82, "max": 214.82, "min": 214.82, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.30, "avg": 3.30, "max": 3.30, "min": 3.30, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 58, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.06, "avg": 0.06, "max": 0.06, "min": 0.06, "cnt": 1}, "forward-recv":{"total": 65.50, "avg": 21.83, "max": 1.00, "min": 63.29, "cnt": 3}, "forward-compute":{"total": 1877.40, "avg": 58.67, "max": 54.00, "min": 64.85, "cnt": 32}, "fwd-compute":{"total": 1874.05, "avg": 58.56, "max": 53.92, "min": 64.72, "cnt": 32}, "batch-generator":{"total": 41.96, "avg": 1.31, "max": 0.66, "min": 2.53, "cnt": 32}, "fwd-embedding":{"total": 0.71, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1818.82, "avg": 56.84, "max": 52.76, "min": 62.67, "cnt": 32}, "fwd-layernorm":{"total": 10.31, "avg": 0.08, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 112.13, "avg": 0.88, "max": 0.74, "min": 1.49, "cnt": 128}, "fwd-misc":{"total": 21.86, "avg": 0.17, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1652.69, "avg": 12.91, "max": 11.06, "min": 18.85, "cnt": 128}, "MoE_L0_fwd":{"total": 488.05, "avg": 15.25, "max": 12.06, "min": 18.75, "cnt": 32}, "MoEMLP":{"total": 1634.92, "avg": 12.77, "max": 10.95, "min": 18.70, "cnt": 128}, "MoE_L1_fwd":{"total": 401.01, "avg": 12.53, "max": 11.35, "min": 16.94, "cnt": 32}, "MoE_L2_fwd":{"total": 369.39, "avg": 11.54, "max": 10.99, "min": 12.99, "cnt": 32}, "MoE_L3_fwd":{"total": 382.82, "avg": 11.96, "max": 11.46, "min": 13.33, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.05, "cnt": 32}, "forward-send":{"total": 4.46, "avg": 2.23, "max": 1.01, "min": 3.45, "cnt": 2}, "forward-send-backward-recv":{"total": 2352.56, "avg": 78.42, "max": 1.79, "min": 346.09, "cnt": 30}, "backward-compute":{"total": 1738.72, "avg": 54.34, "max": 52.62, "min": 56.85, "cnt": 32}, "MoE_L3_bwd":{"total": 441.50, "avg": 13.80, "max": 12.45, "min": 14.71, "cnt": 32}, "MoE_L2_bwd":{"total": 379.00, "avg": 11.84, "max": 11.20, "min": 14.48, "cnt": 32}, "MoE_L1_bwd":{"total": 354.49, "avg": 11.08, "max": 10.56, "min": 11.97, "cnt": 32}, "MoE_L0_bwd":{"total": 353.04, "avg": 11.03, "max": 10.62, "min": 11.98, "cnt": 32}, "backward-send-forward-recv":{"total": 1770.20, "avg": 61.04, "max": 1.70, "min": 420.35, "cnt": 29}, "backward-send":{"total": 2.13, "avg": 0.71, "max": 0.65, "min": 0.80, "cnt": 3}, "backward-recv":{"total": 400.69, "avg": 200.35, "max": 81.96, "min": 318.73, "cnt": 2}, "backward-params-all-reduce":{"total": 489.06, "avg": 489.06, "max": 489.06, "min": 489.06, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 259.08, "avg": 259.08, "max": 259.08, "min": 259.08, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 219.28, "avg": 219.28, "max": 219.28, "min": 219.28, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.32, "avg": 3.32, "max": 3.32, "min": 3.32, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 59, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 58.44, "avg": 19.48, "max": 0.92, "min": 56.40, "cnt": 3}, "forward-compute":{"total": 1862.85, "avg": 58.21, "max": 53.22, "min": 65.23, "cnt": 32}, "fwd-compute":{"total": 1859.83, "avg": 58.12, "max": 53.14, "min": 65.15, "cnt": 32}, "batch-generator":{"total": 50.39, "avg": 1.57, "max": 0.67, "min": 3.89, "cnt": 32}, "fwd-embedding":{"total": 0.67, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1797.14, "avg": 56.16, "max": 51.12, "min": 62.04, "cnt": 32}, "fwd-layernorm":{"total": 10.30, "avg": 0.08, "max": 0.05, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 111.39, "avg": 0.87, "max": 0.74, "min": 1.74, "cnt": 128}, "fwd-misc":{"total": 21.50, "avg": 0.17, "max": 0.11, "min": 0.40, "cnt": 128}, "fwd-MLP":{"total": 1632.39, "avg": 12.75, "max": 10.98, "min": 18.83, "cnt": 128}, "MoE_L0_fwd":{"total": 473.08, "avg": 14.78, "max": 11.27, "min": 18.65, "cnt": 32}, "MoEMLP":{"total": 1614.78, "avg": 12.62, "max": 10.86, "min": 18.56, "cnt": 128}, "MoE_L1_fwd":{"total": 401.74, "avg": 12.55, "max": 11.46, "min": 17.55, "cnt": 32}, "MoE_L2_fwd":{"total": 369.63, "avg": 11.55, "max": 10.91, "min": 13.15, "cnt": 32}, "MoE_L3_fwd":{"total": 376.82, "avg": 11.78, "max": 11.33, "min": 12.92, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.56, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 3.26, "avg": 1.63, "max": 0.71, "min": 2.55, "cnt": 2}, "forward-send-backward-recv":{"total": 215.74, "avg": 7.19, "max": 1.37, "min": 127.15, "cnt": 30}, "backward-compute":{"total": 1729.87, "avg": 54.06, "max": 51.42, "min": 58.29, "cnt": 32}, "MoE_L3_bwd":{"total": 422.06, "avg": 13.19, "max": 12.26, "min": 13.79, "cnt": 32}, "MoE_L2_bwd":{"total": 375.09, "avg": 11.72, "max": 10.67, "min": 15.79, "cnt": 32}, "MoE_L1_bwd":{"total": 358.85, "avg": 11.21, "max": 10.42, "min": 12.34, "cnt": 32}, "MoE_L0_bwd":{"total": 360.48, "avg": 11.26, "max": 10.58, "min": 12.25, "cnt": 32}, "backward-send-forward-recv":{"total": 5124.77, "avg": 176.72, "max": 2.42, "min": 538.43, "cnt": 29}, "backward-send":{"total": 2.73, "avg": 0.91, "max": 0.85, "min": 0.98, "cnt": 3}, "backward-recv":{"total": 142.38, "avg": 71.19, "max": 60.97, "min": 81.41, "cnt": 2}, "backward-params-all-reduce":{"total": 485.35, "avg": 485.35, "max": 485.35, "min": 485.35, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 255.32, "avg": 255.32, "max": 255.32, "min": 255.32, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 215.43, "avg": 215.43, "max": 215.43, "min": 215.43, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 60, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 58.79, "avg": 19.60, "max": 1.37, "min": 55.80, "cnt": 3}, "forward-compute":{"total": 1848.57, "avg": 57.77, "max": 50.80, "min": 64.49, "cnt": 32}, "fwd-compute":{"total": 1845.52, "avg": 57.67, "max": 50.73, "min": 64.39, "cnt": 32}, "batch-generator":{"total": 44.75, "avg": 1.40, "max": 0.64, "min": 3.44, "cnt": 32}, "fwd-embedding":{"total": 0.58, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1788.87, "avg": 55.90, "max": 49.68, "min": 61.72, "cnt": 32}, "fwd-layernorm":{"total": 9.51, "avg": 0.07, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 106.98, "avg": 0.84, "max": 0.74, "min": 1.54, "cnt": 128}, "fwd-misc":{"total": 20.37, "avg": 0.16, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1631.47, "avg": 12.75, "max": 11.01, "min": 20.87, "cnt": 128}, "MoE_L0_fwd":{"total": 484.15, "avg": 15.13, "max": 10.93, "min": 20.80, "cnt": 32}, "MoEMLP":{"total": 1614.69, "avg": 12.61, "max": 10.89, "min": 20.76, "cnt": 128}, "MoE_L1_fwd":{"total": 386.97, "avg": 12.09, "max": 11.09, "min": 13.22, "cnt": 32}, "MoE_L2_fwd":{"total": 369.99, "avg": 11.56, "max": 10.96, "min": 13.06, "cnt": 32}, "MoE_L3_fwd":{"total": 379.61, "avg": 11.86, "max": 11.50, "min": 12.72, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 5.19, "avg": 2.59, "max": 0.89, "min": 4.30, "cnt": 2}, "forward-send-backward-recv":{"total": 449.97, "avg": 15.00, "max": 1.88, "min": 133.06, "cnt": 30}, "backward-compute":{"total": 1742.05, "avg": 54.44, "max": 51.56, "min": 57.40, "cnt": 32}, "MoE_L3_bwd":{"total": 439.08, "avg": 13.72, "max": 12.66, "min": 16.11, "cnt": 32}, "MoE_L2_bwd":{"total": 380.50, "avg": 11.89, "max": 11.26, "min": 12.83, "cnt": 32}, "MoE_L1_bwd":{"total": 349.09, "avg": 10.91, "max": 10.29, "min": 11.59, "cnt": 32}, "MoE_L0_bwd":{"total": 360.18, "avg": 11.26, "max": 10.24, "min": 11.82, "cnt": 32}, "backward-send-forward-recv":{"total": 4415.91, "avg": 152.27, "max": 2.42, "min": 647.83, "cnt": 29}, "backward-send":{"total": 3.03, "avg": 1.01, "max": 0.92, "min": 1.12, "cnt": 3}, "backward-recv":{"total": 422.93, "avg": 211.47, "max": 78.22, "min": 344.71, "cnt": 2}, "backward-params-all-reduce":{"total": 485.16, "avg": 485.16, "max": 485.16, "min": 485.16, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 259.17, "avg": 259.17, "max": 259.17, "min": 259.17, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 219.45, "avg": 219.45, "max": 219.45, "min": 219.45, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.31, "avg": 3.31, "max": 3.31, "min": 3.31, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 61, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 66.35, "avg": 22.12, "max": 1.00, "min": 64.01, "cnt": 3}, "forward-compute":{"total": 1835.49, "avg": 57.36, "max": 51.06, "min": 63.83, "cnt": 32}, "fwd-compute":{"total": 1832.39, "avg": 57.26, "max": 50.99, "min": 63.70, "cnt": 32}, "batch-generator":{"total": 43.28, "avg": 1.35, "max": 0.71, "min": 2.38, "cnt": 32}, "fwd-embedding":{"total": 0.68, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1776.51, "avg": 55.52, "max": 49.90, "min": 61.69, "cnt": 32}, "fwd-layernorm":{"total": 10.27, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 112.68, "avg": 0.88, "max": 0.74, "min": 1.49, "cnt": 128}, "fwd-misc":{"total": 21.58, "avg": 0.17, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1610.26, "avg": 12.58, "max": 10.88, "min": 21.12, "cnt": 128}, "MoE_L0_fwd":{"total": 469.10, "avg": 14.66, "max": 10.92, "min": 21.04, "cnt": 32}, "MoEMLP":{"total": 1592.62, "avg": 12.44, "max": 10.76, "min": 20.99, "cnt": 128}, "MoE_L1_fwd":{"total": 377.16, "avg": 11.79, "max": 10.95, "min": 15.16, "cnt": 32}, "MoE_L2_fwd":{"total": 371.16, "avg": 11.60, "max": 10.81, "min": 15.72, "cnt": 32}, "MoE_L3_fwd":{"total": 381.50, "avg": 11.92, "max": 11.30, "min": 13.62, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 3.36, "avg": 1.68, "max": 0.72, "min": 2.63, "cnt": 2}, "forward-send-backward-recv":{"total": 204.76, "avg": 6.83, "max": 1.32, "min": 121.43, "cnt": 30}, "backward-compute":{"total": 1704.32, "avg": 53.26, "max": 51.82, "min": 56.10, "cnt": 32}, "MoE_L3_bwd":{"total": 436.01, "avg": 13.63, "max": 13.09, "min": 16.01, "cnt": 32}, "MoE_L2_bwd":{"total": 373.12, "avg": 11.66, "max": 11.01, "min": 13.30, "cnt": 32}, "MoE_L1_bwd":{"total": 329.81, "avg": 10.31, "max": 9.52, "min": 11.42, "cnt": 32}, "MoE_L0_bwd":{"total": 349.07, "avg": 10.91, "max": 10.35, "min": 11.25, "cnt": 32}, "backward-send-forward-recv":{"total": 5637.11, "avg": 194.38, "max": 2.49, "min": 940.91, "cnt": 29}, "backward-send":{"total": 3.28, "avg": 1.09, "max": 1.06, "min": 1.12, "cnt": 3}, "backward-recv":{"total": 147.67, "avg": 73.84, "max": 70.14, "min": 77.53, "cnt": 2}, "backward-params-all-reduce":{"total": 489.49, "avg": 489.49, "max": 489.49, "min": 489.49, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 261.86, "avg": 261.86, "max": 261.86, "min": 261.86, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 222.05, "avg": 222.05, "max": 222.05, "min": 222.05, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.26, "avg": 3.26, "max": 3.26, "min": 3.26, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 62, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.06, "avg": 0.06, "max": 0.06, "min": 0.06, "cnt": 1}, "forward-recv":{"total": 61.18, "avg": 20.39, "max": 0.87, "min": 59.30, "cnt": 3}, "forward-compute":{"total": 1811.97, "avg": 56.62, "max": 50.23, "min": 68.12, "cnt": 32}, "fwd-compute":{"total": 1808.95, "avg": 56.53, "max": 50.16, "min": 68.05, "cnt": 32}, "batch-generator":{"total": 42.04, "avg": 1.31, "max": 0.70, "min": 2.76, "cnt": 32}, "fwd-embedding":{"total": 0.60, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1754.72, "avg": 54.83, "max": 49.14, "min": 66.55, "cnt": 32}, "fwd-layernorm":{"total": 9.53, "avg": 0.07, "max": 0.05, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 107.11, "avg": 0.84, "max": 0.74, "min": 1.54, "cnt": 128}, "fwd-misc":{"total": 20.26, "avg": 0.16, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1597.23, "avg": 12.48, "max": 10.49, "min": 24.64, "cnt": 128}, "MoE_L0_fwd":{"total": 473.93, "avg": 14.81, "max": 11.35, "min": 24.53, "cnt": 32}, "MoEMLP":{"total": 1580.27, "avg": 12.35, "max": 10.36, "min": 24.48, "cnt": 128}, "MoE_L1_fwd":{"total": 360.94, "avg": 11.28, "max": 10.45, "min": 12.79, "cnt": 32}, "MoE_L2_fwd":{"total": 362.58, "avg": 11.33, "max": 10.41, "min": 15.24, "cnt": 32}, "MoE_L3_fwd":{"total": 388.92, "avg": 12.15, "max": 11.48, "min": 14.44, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 5.64, "avg": 2.82, "max": 0.94, "min": 4.69, "cnt": 2}, "forward-send-backward-recv":{"total": 241.25, "avg": 8.04, "max": 1.49, "min": 124.23, "cnt": 30}, "backward-compute":{"total": 1646.32, "avg": 51.45, "max": 48.69, "min": 53.90, "cnt": 32}, "MoE_L3_bwd":{"total": 436.40, "avg": 13.64, "max": 12.55, "min": 15.12, "cnt": 32}, "MoE_L2_bwd":{"total": 357.86, "avg": 11.18, "max": 10.30, "min": 11.89, "cnt": 32}, "MoE_L1_bwd":{"total": 314.79, "avg": 9.84, "max": 9.24, "min": 10.27, "cnt": 32}, "MoE_L0_bwd":{"total": 322.61, "avg": 10.08, "max": 9.64, "min": 11.15, "cnt": 32}, "backward-send-forward-recv":{"total": 6783.87, "avg": 233.93, "max": 2.22, "min": 1050.44, "cnt": 29}, "backward-send":{"total": 2.83, "avg": 0.94, "max": 0.67, "min": 1.10, "cnt": 3}, "backward-recv":{"total": 330.95, "avg": 165.48, "max": 76.46, "min": 254.50, "cnt": 2}, "backward-params-all-reduce":{"total": 487.27, "avg": 487.27, "max": 487.27, "min": 487.27, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 255.56, "avg": 255.56, "max": 255.56, "min": 255.56, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 215.77, "avg": 215.77, "max": 215.77, "min": 215.77, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.29, "avg": 3.29, "max": 3.29, "min": 3.29, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 63, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 82.70, "avg": 27.57, "max": 7.22, "min": 63.09, "cnt": 3}, "forward-compute":{"total": 1800.22, "avg": 56.26, "max": 49.12, "min": 64.51, "cnt": 32}, "fwd-compute":{"total": 1797.37, "avg": 56.17, "max": 49.05, "min": 64.43, "cnt": 32}, "batch-generator":{"total": 39.37, "avg": 1.23, "max": 0.68, "min": 2.62, "cnt": 32}, "fwd-embedding":{"total": 0.58, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1745.08, "avg": 54.53, "max": 48.05, "min": 63.27, "cnt": 32}, "fwd-layernorm":{"total": 9.48, "avg": 0.07, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 107.07, "avg": 0.84, "max": 0.74, "min": 2.19, "cnt": 128}, "fwd-misc":{"total": 20.82, "avg": 0.16, "max": 0.11, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1586.65, "avg": 12.40, "max": 10.57, "min": 20.34, "cnt": 128}, "MoE_L0_fwd":{"total": 473.97, "avg": 14.81, "max": 10.74, "min": 20.26, "cnt": 32}, "MoEMLP":{"total": 1569.36, "avg": 12.26, "max": 10.46, "min": 20.21, "cnt": 128}, "MoE_L1_fwd":{"total": 362.45, "avg": 11.33, "max": 10.50, "min": 13.13, "cnt": 32}, "MoE_L2_fwd":{"total": 361.40, "avg": 11.29, "max": 10.53, "min": 15.46, "cnt": 32}, "MoE_L3_fwd":{"total": 377.67, "avg": 11.80, "max": 11.34, "min": 14.31, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 2.99, "avg": 1.49, "max": 0.94, "min": 2.05, "cnt": 2}, "forward-send-backward-recv":{"total": 393.05, "avg": 13.10, "max": 1.79, "min": 125.67, "cnt": 30}, "backward-compute":{"total": 1628.06, "avg": 50.88, "max": 48.62, "min": 52.31, "cnt": 32}, "MoE_L3_bwd":{"total": 426.66, "avg": 13.33, "max": 12.50, "min": 15.12, "cnt": 32}, "MoE_L2_bwd":{"total": 358.16, "avg": 11.19, "max": 10.66, "min": 12.09, "cnt": 32}, "MoE_L1_bwd":{"total": 306.59, "avg": 9.58, "max": 9.09, "min": 10.15, "cnt": 32}, "MoE_L0_bwd":{"total": 320.80, "avg": 10.03, "max": 9.66, "min": 10.74, "cnt": 32}, "backward-send-forward-recv":{"total": 3331.51, "avg": 114.88, "max": 2.18, "min": 294.67, "cnt": 29}, "backward-send":{"total": 3.22, "avg": 1.07, "max": 1.01, "min": 1.13, "cnt": 3}, "backward-recv":{"total": 228.01, "avg": 114.00, "max": 75.93, "min": 152.07, "cnt": 2}, "backward-params-all-reduce":{"total": 487.32, "avg": 487.32, "max": 487.32, "min": 487.32, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 254.25, "avg": 254.25, "max": 254.25, "min": 254.25, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 214.40, "avg": 214.40, "max": 214.40, "min": 214.40, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.28, "avg": 3.28, "max": 3.28, "min": 3.28, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 64, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.06, "avg": 0.06, "max": 0.06, "min": 0.06, "cnt": 1}, "forward-recv":{"total": 69.46, "avg": 23.15, "max": 2.27, "min": 63.70, "cnt": 3}, "forward-compute":{"total": 1797.56, "avg": 56.17, "max": 48.76, "min": 61.98, "cnt": 32}, "fwd-compute":{"total": 1794.55, "avg": 56.08, "max": 48.69, "min": 61.85, "cnt": 32}, "batch-generator":{"total": 45.01, "avg": 1.41, "max": 0.74, "min": 3.03, "cnt": 32}, "fwd-embedding":{"total": 0.60, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1737.11, "avg": 54.28, "max": 47.65, "min": 60.22, "cnt": 32}, "fwd-layernorm":{"total": 9.66, "avg": 0.08, "max": 0.05, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 107.51, "avg": 0.84, "max": 0.74, "min": 1.88, "cnt": 128}, "fwd-misc":{"total": 20.71, "avg": 0.16, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1578.45, "avg": 12.33, "max": 10.24, "min": 20.73, "cnt": 128}, "MoE_L0_fwd":{"total": 462.19, "avg": 14.44, "max": 10.33, "min": 20.64, "cnt": 32}, "MoEMLP":{"total": 1561.33, "avg": 12.20, "max": 10.12, "min": 20.59, "cnt": 128}, "MoE_L1_fwd":{"total": 370.52, "avg": 11.58, "max": 10.36, "min": 16.26, "cnt": 32}, "MoE_L2_fwd":{"total": 356.24, "avg": 11.13, "max": 10.17, "min": 13.74, "cnt": 32}, "MoE_L3_fwd":{"total": 378.60, "avg": 11.83, "max": 11.30, "min": 14.89, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 4.26, "avg": 2.13, "max": 0.91, "min": 3.36, "cnt": 2}, "forward-send-backward-recv":{"total": 462.65, "avg": 15.42, "max": 1.73, "min": 124.98, "cnt": 30}, "backward-compute":{"total": 1590.99, "avg": 49.72, "max": 46.87, "min": 51.50, "cnt": 32}, "MoE_L3_bwd":{"total": 425.45, "avg": 13.30, "max": 12.41, "min": 14.93, "cnt": 32}, "MoE_L2_bwd":{"total": 337.08, "avg": 10.53, "max": 10.07, "min": 11.95, "cnt": 32}, "MoE_L1_bwd":{"total": 308.07, "avg": 9.63, "max": 8.99, "min": 10.31, "cnt": 32}, "MoE_L0_bwd":{"total": 305.51, "avg": 9.55, "max": 8.70, "min": 9.81, "cnt": 32}, "backward-send-forward-recv":{"total": 4000.78, "avg": 137.96, "max": 2.11, "min": 575.82, "cnt": 29}, "backward-send":{"total": 2.39, "avg": 0.80, "max": 0.62, "min": 1.04, "cnt": 3}, "backward-recv":{"total": 256.24, "avg": 128.12, "max": 103.85, "min": 152.39, "cnt": 2}, "backward-params-all-reduce":{"total": 489.12, "avg": 489.12, "max": 489.12, "min": 489.12, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 254.05, "avg": 254.05, "max": 254.05, "min": 254.05, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 214.26, "avg": 214.26, "max": 214.26, "min": 214.26, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 65, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.06, "avg": 0.06, "max": 0.06, "min": 0.06, "cnt": 1}, "forward-recv":{"total": 288.45, "avg": 96.15, "max": 1.28, "min": 230.18, "cnt": 3}, "forward-compute":{"total": 1767.36, "avg": 55.23, "max": 50.14, "min": 65.79, "cnt": 32}, "fwd-compute":{"total": 1764.49, "avg": 55.14, "max": 50.05, "min": 65.70, "cnt": 32}, "batch-generator":{"total": 42.67, "avg": 1.33, "max": 0.72, "min": 2.74, "cnt": 32}, "fwd-embedding":{"total": 0.59, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1709.17, "avg": 53.41, "max": 48.91, "min": 64.01, "cnt": 32}, "fwd-layernorm":{"total": 9.67, "avg": 0.08, "max": 0.05, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 108.88, "avg": 0.85, "max": 0.74, "min": 2.11, "cnt": 128}, "fwd-misc":{"total": 20.50, "avg": 0.16, "max": 0.11, "min": 0.34, "cnt": 128}, "fwd-MLP":{"total": 1549.35, "avg": 12.10, "max": 10.34, "min": 23.42, "cnt": 128}, "MoE_L0_fwd":{"total": 461.16, "avg": 14.41, "max": 11.03, "min": 23.34, "cnt": 32}, "MoEMLP":{"total": 1532.53, "avg": 11.97, "max": 10.23, "min": 23.29, "cnt": 128}, "MoE_L1_fwd":{"total": 358.43, "avg": 11.20, "max": 10.53, "min": 13.27, "cnt": 32}, "MoE_L2_fwd":{"total": 343.50, "avg": 10.73, "max": 10.27, "min": 11.66, "cnt": 32}, "MoE_L3_fwd":{"total": 375.62, "avg": 11.74, "max": 11.31, "min": 13.14, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 5.12, "avg": 2.56, "max": 0.94, "min": 4.18, "cnt": 2}, "forward-send-backward-recv":{"total": 209.86, "avg": 7.00, "max": 1.46, "min": 127.11, "cnt": 30}, "backward-compute":{"total": 1593.98, "avg": 49.81, "max": 47.97, "min": 50.77, "cnt": 32}, "MoE_L3_bwd":{"total": 421.24, "avg": 13.16, "max": 12.32, "min": 14.43, "cnt": 32}, "MoE_L2_bwd":{"total": 340.62, "avg": 10.64, "max": 9.93, "min": 11.55, "cnt": 32}, "MoE_L1_bwd":{"total": 304.10, "avg": 9.50, "max": 9.04, "min": 9.80, "cnt": 32}, "MoE_L0_bwd":{"total": 313.34, "avg": 9.79, "max": 9.20, "min": 10.19, "cnt": 32}, "backward-send-forward-recv":{"total": 4470.98, "avg": 154.17, "max": 7.59, "min": 587.06, "cnt": 29}, "backward-send":{"total": 3.71, "avg": 1.24, "max": 1.07, "min": 1.49, "cnt": 3}, "backward-recv":{"total": 139.99, "avg": 70.00, "max": 65.89, "min": 74.10, "cnt": 2}, "backward-params-all-reduce":{"total": 487.42, "avg": 487.42, "max": 487.42, "min": 487.42, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 253.42, "avg": 253.42, "max": 253.42, "min": 253.42, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.36, "avg": 3.36, "max": 3.36, "min": 3.36, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 213.49, "avg": 213.49, "max": 213.49, "min": 213.49, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.55, "avg": 3.55, "max": 3.55, "min": 3.55, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.41, "avg": 3.41, "max": 3.41, "min": 3.41, "cnt": 1}}}
{"type":"time", "iteration": 66, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.06, "avg": 0.06, "max": 0.06, "min": 0.06, "cnt": 1}, "forward-recv":{"total": 68.52, "avg": 22.84, "max": 1.21, "min": 59.98, "cnt": 3}, "forward-compute":{"total": 1783.45, "avg": 55.73, "max": 49.19, "min": 64.29, "cnt": 32}, "fwd-compute":{"total": 1780.43, "avg": 55.64, "max": 49.13, "min": 64.21, "cnt": 32}, "batch-generator":{"total": 46.88, "avg": 1.46, "max": 0.67, "min": 4.33, "cnt": 32}, "fwd-embedding":{"total": 0.66, "avg": 0.02, "max": 0.01, "min": 0.06, "cnt": 32}, "fwd-encoder":{"total": 1721.38, "avg": 53.79, "max": 48.16, "min": 62.41, "cnt": 32}, "fwd-layernorm":{"total": 10.05, "avg": 0.08, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 109.68, "avg": 0.86, "max": 0.74, "min": 1.49, "cnt": 128}, "fwd-misc":{"total": 21.25, "avg": 0.17, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1558.71, "avg": 12.18, "max": 10.33, "min": 22.90, "cnt": 128}, "MoE_L0_fwd":{"total": 455.62, "avg": 14.24, "max": 10.58, "min": 22.81, "cnt": 32}, "MoEMLP":{"total": 1540.71, "avg": 12.04, "max": 10.22, "min": 22.76, "cnt": 128}, "MoE_L1_fwd":{"total": 359.77, "avg": 11.24, "max": 10.26, "min": 13.39, "cnt": 32}, "MoE_L2_fwd":{"total": 351.39, "avg": 10.98, "max": 10.39, "min": 12.65, "cnt": 32}, "MoE_L3_fwd":{"total": 380.32, "avg": 11.89, "max": 11.14, "min": 16.90, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.66, "avg": 0.83, "max": 0.75, "min": 0.91, "cnt": 2}, "forward-send-backward-recv":{"total": 1008.41, "avg": 33.61, "max": 1.60, "min": 220.83, "cnt": 30}, "backward-compute":{"total": 1613.42, "avg": 50.42, "max": 47.94, "min": 52.85, "cnt": 32}, "MoE_L3_bwd":{"total": 438.19, "avg": 13.69, "max": 12.75, "min": 16.50, "cnt": 32}, "MoE_L2_bwd":{"total": 350.32, "avg": 10.95, "max": 10.04, "min": 11.80, "cnt": 32}, "MoE_L1_bwd":{"total": 298.11, "avg": 9.32, "max": 9.02, "min": 9.67, "cnt": 32}, "MoE_L0_bwd":{"total": 312.28, "avg": 9.76, "max": 9.35, "min": 10.69, "cnt": 32}, "backward-send-forward-recv":{"total": 4908.85, "avg": 169.27, "max": 2.22, "min": 874.57, "cnt": 29}, "backward-send":{"total": 3.19, "avg": 1.06, "max": 1.00, "min": 1.11, "cnt": 3}, "backward-recv":{"total": 332.23, "avg": 166.11, "max": 73.17, "min": 259.06, "cnt": 2}, "backward-params-all-reduce":{"total": 491.18, "avg": 491.18, "max": 491.18, "min": 491.18, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 258.81, "avg": 258.81, "max": 258.81, "min": 258.81, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 218.96, "avg": 218.96, "max": 218.96, "min": 218.96, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.36, "avg": 3.36, "max": 3.36, "min": 3.36, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 67, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 79.16, "avg": 26.39, "max": 5.19, "min": 66.15, "cnt": 3}, "forward-compute":{"total": 1782.44, "avg": 55.70, "max": 49.90, "min": 64.12, "cnt": 32}, "fwd-compute":{"total": 1779.19, "avg": 55.60, "max": 49.83, "min": 64.03, "cnt": 32}, "batch-generator":{"total": 49.93, "avg": 1.56, "max": 0.66, "min": 3.91, "cnt": 32}, "fwd-embedding":{"total": 0.69, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1716.60, "avg": 53.64, "max": 48.88, "min": 60.06, "cnt": 32}, "fwd-layernorm":{"total": 10.12, "avg": 0.08, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 109.60, "avg": 0.86, "max": 0.74, "min": 1.53, "cnt": 128}, "fwd-misc":{"total": 21.05, "avg": 0.16, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1554.77, "avg": 12.15, "max": 10.19, "min": 19.36, "cnt": 128}, "MoE_L0_fwd":{"total": 466.32, "avg": 14.57, "max": 11.20, "min": 19.28, "cnt": 32}, "MoEMLP":{"total": 1537.58, "avg": 12.01, "max": 10.08, "min": 19.23, "cnt": 128}, "MoE_L1_fwd":{"total": 355.26, "avg": 11.10, "max": 10.12, "min": 13.49, "cnt": 32}, "MoE_L2_fwd":{"total": 347.39, "avg": 10.86, "max": 10.14, "min": 11.61, "cnt": 32}, "MoE_L3_fwd":{"total": 374.88, "avg": 11.71, "max": 11.18, "min": 12.56, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.56, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.72, "avg": 0.86, "max": 0.79, "min": 0.93, "cnt": 2}, "forward-send-backward-recv":{"total": 1156.85, "avg": 38.56, "max": 1.72, "min": 292.14, "cnt": 30}, "backward-compute":{"total": 1615.28, "avg": 50.48, "max": 47.63, "min": 53.50, "cnt": 32}, "MoE_L3_bwd":{"total": 434.26, "avg": 13.57, "max": 12.26, "min": 17.06, "cnt": 32}, "MoE_L2_bwd":{"total": 332.35, "avg": 10.39, "max": 9.64, "min": 11.87, "cnt": 32}, "MoE_L1_bwd":{"total": 306.42, "avg": 9.58, "max": 8.94, "min": 11.45, "cnt": 32}, "MoE_L0_bwd":{"total": 327.08, "avg": 10.22, "max": 9.80, "min": 10.63, "cnt": 32}, "backward-send-forward-recv":{"total": 5281.43, "avg": 182.12, "max": 1.57, "min": 984.26, "cnt": 29}, "backward-send":{"total": 3.33, "avg": 1.11, "max": 1.04, "min": 1.15, "cnt": 3}, "backward-recv":{"total": 201.40, "avg": 100.70, "max": 71.45, "min": 129.95, "cnt": 2}, "backward-params-all-reduce":{"total": 481.50, "avg": 481.50, "max": 481.50, "min": 481.50, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 260.13, "avg": 260.13, "max": 260.13, "min": 260.13, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 220.21, "avg": 220.21, "max": 220.21, "min": 220.21, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.33, "avg": 3.33, "max": 3.33, "min": 3.33, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 68, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.06, "avg": 0.06, "max": 0.06, "min": 0.06, "cnt": 1}, "forward-recv":{"total": 68.82, "avg": 22.94, "max": 3.03, "min": 57.44, "cnt": 3}, "forward-compute":{"total": 1810.53, "avg": 56.58, "max": 51.32, "min": 73.99, "cnt": 32}, "fwd-compute":{"total": 1807.47, "avg": 56.48, "max": 51.25, "min": 73.91, "cnt": 32}, "batch-generator":{"total": 46.65, "avg": 1.46, "max": 0.70, "min": 3.07, "cnt": 32}, "fwd-embedding":{"total": 0.63, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1748.77, "avg": 54.65, "max": 49.67, "min": 71.62, "cnt": 32}, "fwd-layernorm":{"total": 9.64, "avg": 0.08, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 106.69, "avg": 0.83, "max": 0.74, "min": 1.52, "cnt": 128}, "fwd-misc":{"total": 20.82, "avg": 0.16, "max": 0.11, "min": 0.55, "cnt": 128}, "fwd-MLP":{"total": 1591.21, "avg": 12.43, "max": 10.42, "min": 33.09, "cnt": 128}, "MoE_L0_fwd":{"total": 486.95, "avg": 15.22, "max": 11.69, "min": 33.01, "cnt": 32}, "MoEMLP":{"total": 1574.20, "avg": 12.30, "max": 10.30, "min": 32.97, "cnt": 128}, "MoE_L1_fwd":{"total": 353.41, "avg": 11.04, "max": 10.34, "min": 13.69, "cnt": 32}, "MoE_L2_fwd":{"total": 365.78, "avg": 11.43, "max": 10.73, "min": 15.74, "cnt": 32}, "MoE_L3_fwd":{"total": 374.23, "avg": 11.69, "max": 11.33, "min": 12.26, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.78, "avg": 0.89, "max": 0.86, "min": 0.92, "cnt": 2}, "forward-send-backward-recv":{"total": 905.07, "avg": 30.17, "max": 1.64, "min": 312.52, "cnt": 30}, "backward-compute":{"total": 1669.22, "avg": 52.16, "max": 51.33, "min": 54.14, "cnt": 32}, "MoE_L3_bwd":{"total": 428.71, "avg": 13.40, "max": 12.87, "min": 14.94, "cnt": 32}, "MoE_L2_bwd":{"total": 361.25, "avg": 11.29, "max": 10.56, "min": 12.24, "cnt": 32}, "MoE_L1_bwd":{"total": 296.99, "avg": 9.28, "max": 9.00, "min": 9.74, "cnt": 32}, "MoE_L0_bwd":{"total": 366.96, "avg": 11.47, "max": 10.90, "min": 12.75, "cnt": 32}, "backward-send-forward-recv":{"total": 2695.09, "avg": 92.93, "max": 1.53, "min": 282.00, "cnt": 29}, "backward-send":{"total": 2.85, "avg": 0.95, "max": 0.88, "min": 1.02, "cnt": 3}, "backward-recv":{"total": 248.71, "avg": 124.35, "max": 76.70, "min": 172.01, "cnt": 2}, "backward-params-all-reduce":{"total": 481.78, "avg": 481.78, "max": 481.78, "min": 481.78, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 256.95, "avg": 256.95, "max": 256.95, "min": 256.95, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 217.19, "avg": 217.19, "max": 217.19, "min": 217.19, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.30, "avg": 3.30, "max": 3.30, "min": 3.30, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}}}
{"type":"time", "iteration": 69, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.06, "avg": 0.06, "max": 0.06, "min": 0.06, "cnt": 1}, "forward-recv":{"total": 61.78, "avg": 20.59, "max": 1.11, "min": 57.42, "cnt": 3}, "forward-compute":{"total": 1844.07, "avg": 57.63, "max": 52.06, "min": 66.48, "cnt": 32}, "fwd-compute":{"total": 1841.18, "avg": 57.54, "max": 51.96, "min": 66.39, "cnt": 32}, "batch-generator":{"total": 39.23, "avg": 1.23, "max": 0.66, "min": 2.72, "cnt": 32}, "fwd-embedding":{"total": 0.56, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1789.98, "avg": 55.94, "max": 50.40, "min": 64.77, "cnt": 32}, "fwd-layernorm":{"total": 9.27, "avg": 0.07, "max": 0.05, "min": 0.22, "cnt": 128}, "fwd-attn":{"total": 107.79, "avg": 0.84, "max": 0.74, "min": 2.38, "cnt": 128}, "fwd-misc":{"total": 20.00, "avg": 0.16, "max": 0.11, "min": 0.44, "cnt": 128}, "fwd-MLP":{"total": 1632.95, "avg": 12.76, "max": 10.58, "min": 24.38, "cnt": 128}, "MoE_L0_fwd":{"total": 514.67, "avg": 16.08, "max": 12.27, "min": 24.30, "cnt": 32}, "MoEMLP":{"total": 1616.74, "avg": 12.63, "max": 10.46, "min": 24.26, "cnt": 128}, "MoE_L1_fwd":{"total": 368.99, "avg": 11.53, "max": 10.50, "min": 17.03, "cnt": 32}, "MoE_L2_fwd":{"total": 368.62, "avg": 11.52, "max": 10.99, "min": 13.86, "cnt": 32}, "MoE_L3_fwd":{"total": 370.27, "avg": 11.57, "max": 11.30, "min": 12.30, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.68, "avg": 0.84, "max": 0.80, "min": 0.88, "cnt": 2}, "forward-send-backward-recv":{"total": 203.69, "avg": 6.79, "max": 1.33, "min": 121.39, "cnt": 30}, "backward-compute":{"total": 1678.25, "avg": 52.45, "max": 50.17, "min": 54.15, "cnt": 32}, "MoE_L3_bwd":{"total": 431.92, "avg": 13.50, "max": 12.84, "min": 15.13, "cnt": 32}, "MoE_L2_bwd":{"total": 368.67, "avg": 11.52, "max": 11.03, "min": 12.11, "cnt": 32}, "MoE_L1_bwd":{"total": 293.19, "avg": 9.16, "max": 8.75, "min": 9.47, "cnt": 32}, "MoE_L0_bwd":{"total": 370.40, "avg": 11.58, "max": 11.11, "min": 12.46, "cnt": 32}, "backward-send-forward-recv":{"total": 7346.68, "avg": 253.33, "max": 2.01, "min": 1300.63, "cnt": 29}, "backward-send":{"total": 3.22, "avg": 1.07, "max": 1.02, "min": 1.13, "cnt": 3}, "backward-recv":{"total": 446.14, "avg": 223.07, "max": 63.08, "min": 383.05, "cnt": 2}, "backward-params-all-reduce":{"total": 483.90, "avg": 483.90, "max": 483.90, "min": 483.90, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 257.07, "avg": 257.07, "max": 257.07, "min": 257.07, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 217.33, "avg": 217.33, "max": 217.33, "min": 217.33, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.27, "avg": 3.27, "max": 3.27, "min": 3.27, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 70, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.06, "avg": 0.06, "max": 0.06, "min": 0.06, "cnt": 1}, "forward-recv":{"total": 64.78, "avg": 21.59, "max": 1.21, "min": 62.31, "cnt": 3}, "forward-compute":{"total": 1786.91, "avg": 55.84, "max": 49.71, "min": 63.82, "cnt": 32}, "fwd-compute":{"total": 1783.74, "avg": 55.74, "max": 49.65, "min": 63.74, "cnt": 32}, "batch-generator":{"total": 49.21, "avg": 1.54, "max": 0.69, "min": 5.12, "cnt": 32}, "fwd-embedding":{"total": 0.63, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1722.38, "avg": 53.82, "max": 48.67, "min": 62.37, "cnt": 32}, "fwd-layernorm":{"total": 9.92, "avg": 0.08, "max": 0.05, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 109.62, "avg": 0.86, "max": 0.74, "min": 1.67, "cnt": 128}, "fwd-misc":{"total": 21.36, "avg": 0.17, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1560.35, "avg": 12.19, "max": 9.61, "min": 18.56, "cnt": 128}, "MoE_L0_fwd":{"total": 455.05, "avg": 14.22, "max": 10.92, "min": 18.48, "cnt": 32}, "MoEMLP":{"total": 1543.18, "avg": 12.06, "max": 9.49, "min": 18.43, "cnt": 128}, "MoE_L1_fwd":{"total": 355.88, "avg": 11.12, "max": 9.54, "min": 14.18, "cnt": 32}, "MoE_L2_fwd":{"total": 368.96, "avg": 11.53, "max": 10.93, "min": 15.58, "cnt": 32}, "MoE_L3_fwd":{"total": 369.56, "avg": 11.55, "max": 11.15, "min": 13.17, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.56, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 4.18, "avg": 2.09, "max": 0.90, "min": 3.29, "cnt": 2}, "forward-send-backward-recv":{"total": 208.85, "avg": 6.96, "max": 1.38, "min": 124.03, "cnt": 30}, "backward-compute":{"total": 1647.47, "avg": 51.48, "max": 49.22, "min": 53.89, "cnt": 32}, "MoE_L3_bwd":{"total": 420.98, "avg": 13.16, "max": 12.05, "min": 14.70, "cnt": 32}, "MoE_L2_bwd":{"total": 368.40, "avg": 11.51, "max": 10.81, "min": 12.19, "cnt": 32}, "MoE_L1_bwd":{"total": 286.47, "avg": 8.95, "max": 8.16, "min": 9.40, "cnt": 32}, "MoE_L0_bwd":{"total": 357.75, "avg": 11.18, "max": 10.42, "min": 13.75, "cnt": 32}, "backward-send-forward-recv":{"total": 4169.64, "avg": 143.78, "max": 2.43, "min": 470.87, "cnt": 29}, "backward-send":{"total": 2.98, "avg": 0.99, "max": 0.85, "min": 1.07, "cnt": 3}, "backward-recv":{"total": 155.28, "avg": 77.64, "max": 71.61, "min": 83.67, "cnt": 2}, "backward-params-all-reduce":{"total": 491.33, "avg": 491.33, "max": 491.33, "min": 491.33, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 256.21, "avg": 256.21, "max": 256.21, "min": 256.21, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 216.48, "avg": 216.48, "max": 216.48, "min": 216.48, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.33, "avg": 3.33, "max": 3.33, "min": 3.33, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}}}
{"type":"time", "iteration": 71, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 77.20, "avg": 25.73, "max": 2.86, "min": 64.96, "cnt": 3}, "forward-compute":{"total": 1797.46, "avg": 56.17, "max": 50.67, "min": 67.92, "cnt": 32}, "fwd-compute":{"total": 1794.29, "avg": 56.07, "max": 50.59, "min": 67.84, "cnt": 32}, "batch-generator":{"total": 61.55, "avg": 1.92, "max": 0.66, "min": 4.01, "cnt": 32}, "fwd-embedding":{"total": 0.68, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1720.06, "avg": 53.75, "max": 49.56, "min": 63.45, "cnt": 32}, "fwd-layernorm":{"total": 9.97, "avg": 0.08, "max": 0.05, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 108.13, "avg": 0.84, "max": 0.74, "min": 1.53, "cnt": 128}, "fwd-misc":{"total": 21.31, "avg": 0.17, "max": 0.11, "min": 0.38, "cnt": 128}, "fwd-MLP":{"total": 1559.65, "avg": 12.18, "max": 9.72, "min": 17.53, "cnt": 128}, "MoE_L0_fwd":{"total": 447.81, "avg": 13.99, "max": 11.08, "min": 17.45, "cnt": 32}, "MoEMLP":{"total": 1542.49, "avg": 12.05, "max": 9.60, "min": 17.41, "cnt": 128}, "MoE_L1_fwd":{"total": 355.45, "avg": 11.11, "max": 9.65, "min": 14.64, "cnt": 32}, "MoE_L2_fwd":{"total": 373.17, "avg": 11.66, "max": 10.74, "min": 15.74, "cnt": 32}, "MoE_L3_fwd":{"total": 372.39, "avg": 11.64, "max": 11.26, "min": 13.62, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.56, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 2.02, "avg": 1.01, "max": 0.99, "min": 1.04, "cnt": 2}, "forward-send-backward-recv":{"total": 205.01, "avg": 6.83, "max": 1.33, "min": 111.75, "cnt": 30}, "backward-compute":{"total": 1642.17, "avg": 51.32, "max": 48.67, "min": 53.02, "cnt": 32}, "MoE_L3_bwd":{"total": 426.28, "avg": 13.32, "max": 12.03, "min": 14.51, "cnt": 32}, "MoE_L2_bwd":{"total": 367.55, "avg": 11.49, "max": 10.68, "min": 12.30, "cnt": 32}, "MoE_L1_bwd":{"total": 283.24, "avg": 8.85, "max": 7.68, "min": 9.42, "cnt": 32}, "MoE_L0_bwd":{"total": 351.62, "avg": 10.99, "max": 10.63, "min": 11.58, "cnt": 32}, "backward-send-forward-recv":{"total": 5695.60, "avg": 196.40, "max": 2.31, "min": 943.15, "cnt": 29}, "backward-send":{"total": 2.79, "avg": 0.93, "max": 0.71, "min": 1.09, "cnt": 3}, "backward-recv":{"total": 131.02, "avg": 65.51, "max": 58.99, "min": 72.04, "cnt": 2}, "backward-params-all-reduce":{"total": 488.29, "avg": 488.29, "max": 488.29, "min": 488.29, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 258.69, "avg": 258.69, "max": 258.69, "min": 258.69, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 218.78, "avg": 218.78, "max": 218.78, "min": 218.78, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.21, "avg": 3.21, "max": 3.21, "min": 3.21, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.53, "avg": 3.53, "max": 3.53, "min": 3.53, "cnt": 1}}}
{"type":"time", "iteration": 72, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 72.38, "avg": 24.13, "max": 2.03, "min": 65.05, "cnt": 3}, "forward-compute":{"total": 1821.38, "avg": 56.92, "max": 53.12, "min": 66.48, "cnt": 32}, "fwd-compute":{"total": 1818.22, "avg": 56.82, "max": 53.04, "min": 66.39, "cnt": 32}, "batch-generator":{"total": 44.75, "avg": 1.40, "max": 0.71, "min": 2.79, "cnt": 32}, "fwd-embedding":{"total": 0.62, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1761.42, "avg": 55.04, "max": 50.25, "min": 63.34, "cnt": 32}, "fwd-layernorm":{"total": 9.72, "avg": 0.08, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 108.20, "avg": 0.85, "max": 0.74, "min": 1.51, "cnt": 128}, "fwd-misc":{"total": 20.38, "avg": 0.16, "max": 0.11, "min": 0.34, "cnt": 128}, "fwd-MLP":{"total": 1602.86, "avg": 12.52, "max": 9.85, "min": 23.56, "cnt": 128}, "MoE_L0_fwd":{"total": 499.54, "avg": 15.61, "max": 12.16, "min": 23.48, "cnt": 32}, "MoEMLP":{"total": 1586.38, "avg": 12.39, "max": 9.73, "min": 23.44, "cnt": 128}, "MoE_L1_fwd":{"total": 356.82, "avg": 11.15, "max": 9.78, "min": 14.34, "cnt": 32}, "MoE_L2_fwd":{"total": 361.44, "avg": 11.29, "max": 10.77, "min": 12.26, "cnt": 32}, "MoE_L3_fwd":{"total": 374.67, "avg": 11.71, "max": 11.16, "min": 12.50, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.56, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.71, "avg": 0.85, "max": 0.75, "min": 0.95, "cnt": 2}, "forward-send-backward-recv":{"total": 194.73, "avg": 6.49, "max": 1.70, "min": 110.06, "cnt": 30}, "backward-compute":{"total": 1631.23, "avg": 50.98, "max": 47.50, "min": 55.38, "cnt": 32}, "MoE_L3_bwd":{"total": 427.29, "avg": 13.35, "max": 11.92, "min": 14.91, "cnt": 32}, "MoE_L2_bwd":{"total": 357.78, "avg": 11.18, "max": 10.56, "min": 11.77, "cnt": 32}, "MoE_L1_bwd":{"total": 281.22, "avg": 8.79, "max": 7.54, "min": 12.73, "cnt": 32}, "MoE_L0_bwd":{"total": 350.48, "avg": 10.95, "max": 10.34, "min": 11.45, "cnt": 32}, "backward-send-forward-recv":{"total": 5640.89, "avg": 194.51, "max": 2.33, "min": 808.72, "cnt": 29}, "backward-send":{"total": 2.01, "avg": 0.67, "max": 0.57, "min": 0.73, "cnt": 3}, "backward-recv":{"total": 143.89, "avg": 71.95, "max": 66.50, "min": 77.39, "cnt": 2}, "backward-params-all-reduce":{"total": 490.18, "avg": 490.18, "max": 490.18, "min": 490.18, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 253.51, "avg": 253.51, "max": 253.51, "min": 253.51, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 213.70, "avg": 213.70, "max": 213.70, "min": 213.70, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.33, "avg": 3.33, "max": 3.33, "min": 3.33, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 73, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.06, "avg": 0.06, "max": 0.06, "min": 0.06, "cnt": 1}, "forward-recv":{"total": 1249.48, "avg": 416.49, "max": 0.99, "min": 763.84, "cnt": 3}, "forward-compute":{"total": 1835.25, "avg": 57.35, "max": 51.70, "min": 63.12, "cnt": 32}, "fwd-compute":{"total": 1832.39, "avg": 57.26, "max": 51.62, "min": 63.04, "cnt": 32}, "batch-generator":{"total": 35.78, "avg": 1.12, "max": 0.67, "min": 2.38, "cnt": 32}, "fwd-embedding":{"total": 0.48, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1784.89, "avg": 55.78, "max": 50.22, "min": 61.63, "cnt": 32}, "fwd-layernorm":{"total": 9.08, "avg": 0.07, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 105.75, "avg": 0.83, "max": 0.74, "min": 1.47, "cnt": 128}, "fwd-misc":{"total": 19.49, "avg": 0.15, "max": 0.11, "min": 0.34, "cnt": 128}, "fwd-MLP":{"total": 1630.17, "avg": 12.74, "max": 10.37, "min": 22.32, "cnt": 128}, "MoE_L0_fwd":{"total": 523.99, "avg": 16.37, "max": 12.17, "min": 22.24, "cnt": 32}, "MoEMLP":{"total": 1613.91, "avg": 12.61, "max": 10.25, "min": 22.19, "cnt": 128}, "MoE_L1_fwd":{"total": 359.90, "avg": 11.25, "max": 10.42, "min": 12.42, "cnt": 32}, "MoE_L2_fwd":{"total": 349.71, "avg": 10.93, "max": 10.30, "min": 11.80, "cnt": 32}, "MoE_L3_fwd":{"total": 386.31, "avg": 12.07, "max": 11.52, "min": 14.02, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 4.79, "avg": 2.39, "max": 0.82, "min": 3.97, "cnt": 2}, "forward-send-backward-recv":{"total": 74.87, "avg": 2.50, "max": 1.46, "min": 9.93, "cnt": 30}, "backward-compute":{"total": 1649.47, "avg": 51.55, "max": 49.65, "min": 53.25, "cnt": 32}, "MoE_L3_bwd":{"total": 439.36, "avg": 13.73, "max": 13.17, "min": 14.56, "cnt": 32}, "MoE_L2_bwd":{"total": 349.39, "avg": 10.92, "max": 10.24, "min": 11.99, "cnt": 32}, "MoE_L1_bwd":{"total": 296.36, "avg": 9.26, "max": 8.01, "min": 12.43, "cnt": 32}, "MoE_L0_bwd":{"total": 349.86, "avg": 10.93, "max": 10.28, "min": 11.59, "cnt": 32}, "backward-send-forward-recv":{"total": 4574.88, "avg": 157.75, "max": 1.51, "min": 877.72, "cnt": 29}, "backward-send":{"total": 3.13, "avg": 1.04, "max": 0.97, "min": 1.14, "cnt": 3}, "backward-recv":{"total": 131.18, "avg": 65.59, "max": 59.27, "min": 71.91, "cnt": 2}, "backward-params-all-reduce":{"total": 484.46, "avg": 484.46, "max": 484.46, "min": 484.46, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 256.47, "avg": 256.47, "max": 256.47, "min": 256.47, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 216.73, "avg": 216.73, "max": 216.73, "min": 216.73, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.27, "avg": 3.27, "max": 3.27, "min": 3.27, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 74, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 58.61, "avg": 19.54, "max": 1.12, "min": 56.27, "cnt": 3}, "forward-compute":{"total": 1806.44, "avg": 56.45, "max": 50.19, "min": 62.52, "cnt": 32}, "fwd-compute":{"total": 1803.43, "avg": 56.36, "max": 50.13, "min": 62.43, "cnt": 32}, "batch-generator":{"total": 54.12, "avg": 1.69, "max": 0.71, "min": 3.87, "cnt": 32}, "fwd-embedding":{"total": 0.62, "avg": 0.02, "max": 0.01, "min": 0.06, "cnt": 32}, "fwd-encoder":{"total": 1737.36, "avg": 54.29, "max": 49.12, "min": 59.72, "cnt": 32}, "fwd-layernorm":{"total": 9.50, "avg": 0.07, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 108.96, "avg": 0.85, "max": 0.74, "min": 2.94, "cnt": 128}, "fwd-misc":{"total": 20.59, "avg": 0.16, "max": 0.11, "min": 0.46, "cnt": 128}, "fwd-MLP":{"total": 1577.88, "avg": 12.33, "max": 9.99, "min": 18.99, "cnt": 128}, "MoE_L0_fwd":{"total": 473.72, "avg": 14.80, "max": 10.57, "min": 18.90, "cnt": 32}, "MoEMLP":{"total": 1561.31, "avg": 12.20, "max": 9.86, "min": 18.86, "cnt": 128}, "MoE_L1_fwd":{"total": 367.63, "avg": 11.49, "max": 10.43, "min": 14.26, "cnt": 32}, "MoE_L2_fwd":{"total": 336.67, "avg": 10.52, "max": 9.91, "min": 15.44, "cnt": 32}, "MoE_L3_fwd":{"total": 389.32, "avg": 12.17, "max": 11.62, "min": 13.04, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.56, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.48, "avg": 0.74, "max": 0.74, "min": 0.74, "cnt": 2}, "forward-send-backward-recv":{"total": 439.18, "avg": 14.64, "max": 1.56, "min": 122.85, "cnt": 30}, "backward-compute":{"total": 1640.39, "avg": 51.26, "max": 48.89, "min": 54.85, "cnt": 32}, "MoE_L3_bwd":{"total": 447.86, "avg": 14.00, "max": 12.99, "min": 15.67, "cnt": 32}, "MoE_L2_bwd":{"total": 325.67, "avg": 10.18, "max": 9.35, "min": 11.67, "cnt": 32}, "MoE_L1_bwd":{"total": 302.51, "avg": 9.45, "max": 8.79, "min": 11.45, "cnt": 32}, "MoE_L0_bwd":{"total": 352.21, "avg": 11.01, "max": 10.29, "min": 13.15, "cnt": 32}, "backward-send-forward-recv":{"total": 4685.33, "avg": 161.56, "max": 2.48, "min": 918.62, "cnt": 29}, "backward-send":{"total": 2.22, "avg": 0.74, "max": 0.57, "min": 1.04, "cnt": 3}, "backward-recv":{"total": 269.89, "avg": 134.94, "max": 78.99, "min": 190.90, "cnt": 2}, "backward-params-all-reduce":{"total": 486.87, "avg": 486.87, "max": 486.87, "min": 486.87, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 250.79, "avg": 250.79, "max": 250.79, "min": 250.79, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 210.90, "avg": 210.90, "max": 210.90, "min": 210.90, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.32, "avg": 3.32, "max": 3.32, "min": 3.32, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 75, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 61.76, "avg": 20.59, "max": 0.91, "min": 56.95, "cnt": 3}, "forward-compute":{"total": 1841.24, "avg": 57.54, "max": 50.75, "min": 135.07, "cnt": 32}, "fwd-compute":{"total": 1838.25, "avg": 57.45, "max": 50.66, "min": 134.99, "cnt": 32}, "batch-generator":{"total": 46.84, "avg": 1.46, "max": 0.70, "min": 3.13, "cnt": 32}, "fwd-embedding":{"total": 0.63, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1778.65, "avg": 55.58, "max": 49.43, "min": 133.78, "cnt": 32}, "fwd-layernorm":{"total": 9.84, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 108.38, "avg": 0.85, "max": 0.74, "min": 1.61, "cnt": 128}, "fwd-misc":{"total": 20.92, "avg": 0.16, "max": 0.11, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1618.70, "avg": 12.65, "max": 9.31, "min": 96.44, "cnt": 128}, "MoE_L0_fwd":{"total": 526.68, "avg": 16.46, "max": 11.17, "min": 96.35, "cnt": 32}, "MoEMLP":{"total": 1601.74, "avg": 12.51, "max": 9.19, "min": 96.30, "cnt": 128}, "MoE_L1_fwd":{"total": 359.39, "avg": 11.23, "max": 9.83, "min": 12.81, "cnt": 32}, "MoE_L2_fwd":{"total": 316.92, "avg": 9.90, "max": 9.23, "min": 11.14, "cnt": 32}, "MoE_L3_fwd":{"total": 404.99, "avg": 12.66, "max": 12.21, "min": 15.26, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 7.32, "avg": 3.66, "max": 0.89, "min": 6.44, "cnt": 2}, "forward-send-backward-recv":{"total": 236.68, "avg": 7.89, "max": 1.45, "min": 134.56, "cnt": 30}, "backward-compute":{"total": 1643.69, "avg": 51.37, "max": 48.84, "min": 53.42, "cnt": 32}, "MoE_L3_bwd":{"total": 461.98, "avg": 14.44, "max": 13.57, "min": 16.09, "cnt": 32}, "MoE_L2_bwd":{"total": 299.71, "avg": 9.37, "max": 8.71, "min": 9.89, "cnt": 32}, "MoE_L1_bwd":{"total": 310.18, "avg": 9.69, "max": 8.87, "min": 11.53, "cnt": 32}, "MoE_L0_bwd":{"total": 360.67, "avg": 11.27, "max": 10.47, "min": 11.92, "cnt": 32}, "backward-send-forward-recv":{"total": 5262.18, "avg": 181.45, "max": 1.67, "min": 886.16, "cnt": 29}, "backward-send":{"total": 2.84, "avg": 0.95, "max": 0.69, "min": 1.09, "cnt": 3}, "backward-recv":{"total": 143.83, "avg": 71.91, "max": 68.25, "min": 75.58, "cnt": 2}, "backward-params-all-reduce":{"total": 488.62, "avg": 488.62, "max": 488.62, "min": 488.62, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 253.89, "avg": 253.89, "max": 253.89, "min": 253.89, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 214.10, "avg": 214.10, "max": 214.10, "min": 214.10, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.31, "avg": 3.31, "max": 3.31, "min": 3.31, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 76, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 82.33, "avg": 27.44, "max": 5.07, "min": 67.31, "cnt": 3}, "forward-compute":{"total": 1811.31, "avg": 56.60, "max": 51.23, "min": 63.50, "cnt": 32}, "fwd-compute":{"total": 1808.21, "avg": 56.51, "max": 51.16, "min": 63.42, "cnt": 32}, "batch-generator":{"total": 47.95, "avg": 1.50, "max": 0.69, "min": 4.04, "cnt": 32}, "fwd-embedding":{"total": 0.64, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1747.53, "avg": 54.61, "max": 50.08, "min": 61.33, "cnt": 32}, "fwd-layernorm":{"total": 9.96, "avg": 0.08, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 110.87, "avg": 0.87, "max": 0.74, "min": 1.62, "cnt": 128}, "fwd-misc":{"total": 21.01, "avg": 0.16, "max": 0.11, "min": 0.46, "cnt": 128}, "fwd-MLP":{"total": 1584.15, "avg": 12.38, "max": 9.35, "min": 17.72, "cnt": 128}, "MoE_L0_fwd":{"total": 466.39, "avg": 14.57, "max": 11.92, "min": 17.55, "cnt": 32}, "MoEMLP":{"total": 1566.43, "avg": 12.24, "max": 9.24, "min": 17.45, "cnt": 128}, "MoE_L1_fwd":{"total": 370.51, "avg": 11.58, "max": 10.54, "min": 14.42, "cnt": 32}, "MoE_L2_fwd":{"total": 327.33, "avg": 10.23, "max": 9.28, "min": 12.53, "cnt": 32}, "MoE_L3_fwd":{"total": 408.51, "avg": 12.77, "max": 12.29, "min": 14.08, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.56, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.69, "avg": 0.85, "max": 0.75, "min": 0.94, "cnt": 2}, "forward-send-backward-recv":{"total": 309.99, "avg": 10.33, "max": 1.53, "min": 113.94, "cnt": 30}, "backward-compute":{"total": 1659.55, "avg": 51.86, "max": 49.11, "min": 52.96, "cnt": 32}, "MoE_L3_bwd":{"total": 471.92, "avg": 14.75, "max": 14.23, "min": 15.71, "cnt": 32}, "MoE_L2_bwd":{"total": 296.65, "avg": 9.27, "max": 8.56, "min": 10.01, "cnt": 32}, "MoE_L1_bwd":{"total": 303.21, "avg": 9.48, "max": 9.03, "min": 9.90, "cnt": 32}, "MoE_L0_bwd":{"total": 372.90, "avg": 11.65, "max": 10.75, "min": 11.89, "cnt": 32}, "backward-send-forward-recv":{"total": 4865.20, "avg": 167.77, "max": 2.31, "min": 1359.47, "cnt": 29}, "backward-send":{"total": 1.81, "avg": 0.60, "max": 0.46, "min": 0.75, "cnt": 3}, "backward-recv":{"total": 143.60, "avg": 71.80, "max": 65.06, "min": 78.54, "cnt": 2}, "backward-params-all-reduce":{"total": 492.18, "avg": 492.18, "max": 492.18, "min": 492.18, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 255.08, "avg": 255.08, "max": 255.08, "min": 255.08, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 215.17, "avg": 215.17, "max": 215.17, "min": 215.17, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.32, "avg": 3.32, "max": 3.32, "min": 3.32, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 77, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.06, "avg": 0.06, "max": 0.06, "min": 0.06, "cnt": 1}, "forward-recv":{"total": 57.33, "avg": 19.11, "max": 0.91, "min": 54.58, "cnt": 3}, "forward-compute":{"total": 1796.10, "avg": 56.13, "max": 51.06, "min": 63.98, "cnt": 32}, "fwd-compute":{"total": 1793.15, "avg": 56.04, "max": 50.99, "min": 63.89, "cnt": 32}, "batch-generator":{"total": 39.37, "avg": 1.23, "max": 0.66, "min": 4.31, "cnt": 32}, "fwd-embedding":{"total": 0.59, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1741.48, "avg": 54.42, "max": 50.03, "min": 62.41, "cnt": 32}, "fwd-layernorm":{"total": 9.25, "avg": 0.07, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 104.97, "avg": 0.82, "max": 0.74, "min": 1.54, "cnt": 128}, "fwd-misc":{"total": 19.80, "avg": 0.15, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1587.22, "avg": 12.40, "max": 10.10, "min": 20.84, "cnt": 128}, "MoE_L0_fwd":{"total": 471.43, "avg": 14.73, "max": 11.78, "min": 20.74, "cnt": 32}, "MoEMLP":{"total": 1571.00, "avg": 12.27, "max": 9.98, "min": 20.69, "cnt": 128}, "MoE_L1_fwd":{"total": 370.70, "avg": 11.58, "max": 10.62, "min": 14.78, "cnt": 32}, "MoE_L2_fwd":{"total": 339.30, "avg": 10.60, "max": 10.02, "min": 11.29, "cnt": 32}, "MoE_L3_fwd":{"total": 395.52, "avg": 12.36, "max": 11.92, "min": 13.08, "cnt": 32}, "fwd-pooler":{"total": 0.31, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.29, "avg": 0.64, "max": 0.55, "min": 0.74, "cnt": 2}, "forward-send-backward-recv":{"total": 223.64, "avg": 7.45, "max": 1.86, "min": 122.29, "cnt": 30}, "backward-compute":{"total": 1655.07, "avg": 51.72, "max": 48.64, "min": 55.08, "cnt": 32}, "MoE_L3_bwd":{"total": 449.80, "avg": 14.06, "max": 13.26, "min": 15.54, "cnt": 32}, "MoE_L2_bwd":{"total": 308.35, "avg": 9.64, "max": 8.94, "min": 12.39, "cnt": 32}, "MoE_L1_bwd":{"total": 303.99, "avg": 9.50, "max": 8.92, "min": 11.14, "cnt": 32}, "MoE_L0_bwd":{"total": 377.86, "avg": 11.81, "max": 10.96, "min": 12.51, "cnt": 32}, "backward-send-forward-recv":{"total": 6208.80, "avg": 214.10, "max": 1.91, "min": 1975.46, "cnt": 29}, "backward-send":{"total": 2.82, "avg": 0.94, "max": 0.73, "min": 1.11, "cnt": 3}, "backward-recv":{"total": 168.91, "avg": 84.45, "max": 74.35, "min": 94.56, "cnt": 2}, "backward-params-all-reduce":{"total": 484.91, "avg": 484.91, "max": 484.91, "min": 484.91, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 256.63, "avg": 256.63, "max": 256.63, "min": 256.63, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 216.90, "avg": 216.90, "max": 216.90, "min": 216.90, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.27, "avg": 3.27, "max": 3.27, "min": 3.27, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}}}
{"type":"time", "iteration": 78, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 65.47, "avg": 21.82, "max": 0.82, "min": 63.12, "cnt": 3}, "forward-compute":{"total": 1806.69, "avg": 56.46, "max": 50.89, "min": 62.95, "cnt": 32}, "fwd-compute":{"total": 1803.76, "avg": 56.37, "max": 50.83, "min": 62.87, "cnt": 32}, "batch-generator":{"total": 44.22, "avg": 1.38, "max": 0.67, "min": 4.03, "cnt": 32}, "fwd-embedding":{"total": 0.62, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1747.26, "avg": 54.60, "max": 49.79, "min": 60.35, "cnt": 32}, "fwd-layernorm":{"total": 9.90, "avg": 0.08, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 109.92, "avg": 0.86, "max": 0.74, "min": 1.58, "cnt": 128}, "fwd-misc":{"total": 21.19, "avg": 0.17, "max": 0.11, "min": 0.47, "cnt": 128}, "fwd-MLP":{"total": 1585.17, "avg": 12.38, "max": 9.90, "min": 19.30, "cnt": 128}, "MoE_L0_fwd":{"total": 459.06, "avg": 14.35, "max": 11.27, "min": 19.22, "cnt": 32}, "MoEMLP":{"total": 1568.00, "avg": 12.25, "max": 9.78, "min": 19.17, "cnt": 128}, "MoE_L1_fwd":{"total": 371.25, "avg": 11.60, "max": 10.84, "min": 13.05, "cnt": 32}, "MoE_L2_fwd":{"total": 346.64, "avg": 10.83, "max": 9.83, "min": 16.39, "cnt": 32}, "MoE_L3_fwd":{"total": 397.34, "avg": 12.42, "max": 11.86, "min": 14.58, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 7.05, "avg": 3.52, "max": 0.91, "min": 6.14, "cnt": 2}, "forward-send-backward-recv":{"total": 850.35, "avg": 28.35, "max": 1.40, "min": 177.60, "cnt": 30}, "backward-compute":{"total": 1668.26, "avg": 52.13, "max": 48.63, "min": 55.23, "cnt": 32}, "MoE_L3_bwd":{"total": 447.27, "avg": 13.98, "max": 12.90, "min": 15.53, "cnt": 32}, "MoE_L2_bwd":{"total": 322.20, "avg": 10.07, "max": 9.43, "min": 10.91, "cnt": 32}, "MoE_L1_bwd":{"total": 310.80, "avg": 9.71, "max": 9.05, "min": 11.32, "cnt": 32}, "MoE_L0_bwd":{"total": 376.36, "avg": 11.76, "max": 10.74, "min": 12.39, "cnt": 32}, "backward-send-forward-recv":{"total": 3179.66, "avg": 109.64, "max": 1.56, "min": 413.60, "cnt": 29}, "backward-send":{"total": 2.10, "avg": 0.70, "max": 0.51, "min": 0.99, "cnt": 3}, "backward-recv":{"total": 470.99, "avg": 235.50, "max": 74.81, "min": 396.18, "cnt": 2}, "backward-params-all-reduce":{"total": 487.84, "avg": 487.84, "max": 487.84, "min": 487.84, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 253.11, "avg": 253.11, "max": 253.11, "min": 253.11, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 213.28, "avg": 213.28, "max": 213.28, "min": 213.28, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.35, "avg": 3.35, "max": 3.35, "min": 3.35, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 79, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.06, "avg": 0.06, "max": 0.06, "min": 0.06, "cnt": 1}, "forward-recv":{"total": 59.74, "avg": 19.91, "max": 1.00, "min": 57.65, "cnt": 3}, "forward-compute":{"total": 1856.51, "avg": 58.02, "max": 50.61, "min": 64.63, "cnt": 32}, "fwd-compute":{"total": 1853.46, "avg": 57.92, "max": 50.54, "min": 64.50, "cnt": 32}, "batch-generator":{"total": 62.97, "avg": 1.97, "max": 0.72, "min": 5.16, "cnt": 32}, "fwd-embedding":{"total": 0.64, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1777.48, "avg": 55.55, "max": 49.36, "min": 62.49, "cnt": 32}, "fwd-layernorm":{"total": 10.08, "avg": 0.08, "max": 0.06, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 107.64, "avg": 0.84, "max": 0.74, "min": 1.61, "cnt": 128}, "fwd-misc":{"total": 21.25, "avg": 0.17, "max": 0.11, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1617.14, "avg": 12.63, "max": 9.75, "min": 18.01, "cnt": 128}, "MoE_L0_fwd":{"total": 479.93, "avg": 15.00, "max": 11.47, "min": 17.93, "cnt": 32}, "MoEMLP":{"total": 1599.91, "avg": 12.50, "max": 9.64, "min": 17.88, "cnt": 128}, "MoE_L1_fwd":{"total": 376.67, "avg": 11.77, "max": 10.85, "min": 14.09, "cnt": 32}, "MoE_L2_fwd":{"total": 345.81, "avg": 10.81, "max": 9.68, "min": 14.86, "cnt": 32}, "MoE_L3_fwd":{"total": 403.84, "avg": 12.62, "max": 11.95, "min": 15.58, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 11.57, "avg": 5.79, "max": 0.87, "min": 10.71, "cnt": 2}, "forward-send-backward-recv":{"total": 507.61, "avg": 16.92, "max": 1.43, "min": 128.13, "cnt": 30}, "backward-compute":{"total": 1685.97, "avg": 52.69, "max": 51.21, "min": 56.54, "cnt": 32}, "MoE_L3_bwd":{"total": 445.95, "avg": 13.94, "max": 12.58, "min": 14.88, "cnt": 32}, "MoE_L2_bwd":{"total": 326.45, "avg": 10.20, "max": 9.42, "min": 11.36, "cnt": 32}, "MoE_L1_bwd":{"total": 318.18, "avg": 9.94, "max": 9.29, "min": 12.63, "cnt": 32}, "MoE_L0_bwd":{"total": 381.59, "avg": 11.92, "max": 11.25, "min": 13.10, "cnt": 32}, "backward-send-forward-recv":{"total": 4175.94, "avg": 144.00, "max": 1.85, "min": 673.42, "cnt": 29}, "backward-send":{"total": 2.25, "avg": 0.75, "max": 0.55, "min": 1.02, "cnt": 3}, "backward-recv":{"total": 525.73, "avg": 262.86, "max": 115.81, "min": 409.91, "cnt": 2}, "backward-params-all-reduce":{"total": 485.38, "avg": 485.38, "max": 485.38, "min": 485.38, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 254.13, "avg": 254.13, "max": 254.13, "min": 254.13, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 214.33, "avg": 214.33, "max": 214.33, "min": 214.33, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.28, "avg": 3.28, "max": 3.28, "min": 3.28, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}}}
{"type":"time", "iteration": 80, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 57.76, "avg": 19.25, "max": 0.99, "min": 55.68, "cnt": 3}, "forward-compute":{"total": 1850.50, "avg": 57.83, "max": 50.20, "min": 65.46, "cnt": 32}, "fwd-compute":{"total": 1847.37, "avg": 57.73, "max": 50.13, "min": 65.38, "cnt": 32}, "batch-generator":{"total": 42.75, "avg": 1.34, "max": 0.68, "min": 3.46, "cnt": 32}, "fwd-embedding":{"total": 0.61, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1792.03, "avg": 56.00, "max": 49.14, "min": 63.54, "cnt": 32}, "fwd-layernorm":{"total": 9.61, "avg": 0.08, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 109.16, "avg": 0.85, "max": 0.74, "min": 1.47, "cnt": 128}, "fwd-misc":{"total": 21.05, "avg": 0.16, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1630.83, "avg": 12.74, "max": 9.98, "min": 20.16, "cnt": 128}, "MoE_L0_fwd":{"total": 491.98, "avg": 15.37, "max": 11.56, "min": 20.05, "cnt": 32}, "MoEMLP":{"total": 1613.55, "avg": 12.61, "max": 9.87, "min": 20.00, "cnt": 128}, "MoE_L1_fwd":{"total": 381.30, "avg": 11.92, "max": 11.00, "min": 14.77, "cnt": 32}, "MoE_L2_fwd":{"total": 349.37, "avg": 10.92, "max": 9.92, "min": 15.01, "cnt": 32}, "MoE_L3_fwd":{"total": 397.09, "avg": 12.41, "max": 11.96, "min": 14.05, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.84, "avg": 0.92, "max": 0.90, "min": 0.94, "cnt": 2}, "forward-send-backward-recv":{"total": 230.77, "avg": 7.69, "max": 1.80, "min": 133.16, "cnt": 30}, "backward-compute":{"total": 1697.23, "avg": 53.04, "max": 50.69, "min": 54.38, "cnt": 32}, "MoE_L3_bwd":{"total": 450.65, "avg": 14.08, "max": 12.91, "min": 15.56, "cnt": 32}, "MoE_L2_bwd":{"total": 331.56, "avg": 10.36, "max": 9.53, "min": 12.02, "cnt": 32}, "MoE_L1_bwd":{"total": 322.03, "avg": 10.06, "max": 9.27, "min": 10.66, "cnt": 32}, "MoE_L0_bwd":{"total": 379.13, "avg": 11.85, "max": 11.19, "min": 12.40, "cnt": 32}, "backward-send-forward-recv":{"total": 3575.96, "avg": 123.31, "max": 2.29, "min": 408.74, "cnt": 29}, "backward-send":{"total": 2.86, "avg": 0.95, "max": 0.85, "min": 1.13, "cnt": 3}, "backward-recv":{"total": 138.74, "avg": 69.37, "max": 68.02, "min": 70.72, "cnt": 2}, "backward-params-all-reduce":{"total": 488.90, "avg": 488.90, "max": 488.90, "min": 488.90, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 248.61, "avg": 248.61, "max": 248.61, "min": 248.61, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 208.92, "avg": 208.92, "max": 208.92, "min": 208.92, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.27, "avg": 3.27, "max": 3.27, "min": 3.27, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 81, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.06, "avg": 0.06, "max": 0.06, "min": 0.06, "cnt": 1}, "forward-recv":{"total": 66.45, "avg": 22.15, "max": 1.09, "min": 62.56, "cnt": 3}, "forward-compute":{"total": 1862.42, "avg": 58.20, "max": 51.28, "min": 64.01, "cnt": 32}, "fwd-compute":{"total": 1859.20, "avg": 58.10, "max": 51.22, "min": 63.88, "cnt": 32}, "batch-generator":{"total": 40.23, "avg": 1.26, "max": 0.68, "min": 2.60, "cnt": 32}, "fwd-embedding":{"total": 0.66, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1806.70, "avg": 56.46, "max": 50.25, "min": 61.88, "cnt": 32}, "fwd-layernorm":{"total": 10.14, "avg": 0.08, "max": 0.05, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 111.84, "avg": 0.87, "max": 0.74, "min": 1.49, "cnt": 128}, "fwd-misc":{"total": 21.85, "avg": 0.17, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1641.25, "avg": 12.82, "max": 10.30, "min": 19.10, "cnt": 128}, "MoE_L0_fwd":{"total": 493.60, "avg": 15.43, "max": 11.70, "min": 19.02, "cnt": 32}, "MoEMLP":{"total": 1623.46, "avg": 12.68, "max": 10.18, "min": 18.97, "cnt": 128}, "MoE_L1_fwd":{"total": 392.27, "avg": 12.26, "max": 11.06, "min": 15.95, "cnt": 32}, "MoE_L2_fwd":{"total": 345.43, "avg": 10.79, "max": 10.22, "min": 12.84, "cnt": 32}, "MoE_L3_fwd":{"total": 398.57, "avg": 12.46, "max": 11.87, "min": 16.00, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.56, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.51, "avg": 0.75, "max": 0.75, "min": 0.75, "cnt": 2}, "forward-send-backward-recv":{"total": 746.43, "avg": 24.88, "max": 1.33, "min": 236.15, "cnt": 30}, "backward-compute":{"total": 1750.09, "avg": 54.69, "max": 51.24, "min": 57.75, "cnt": 32}, "MoE_L3_bwd":{"total": 458.80, "avg": 14.34, "max": 13.10, "min": 17.14, "cnt": 32}, "MoE_L2_bwd":{"total": 354.13, "avg": 11.07, "max": 10.25, "min": 14.01, "cnt": 32}, "MoE_L1_bwd":{"total": 344.63, "avg": 10.77, "max": 10.26, "min": 11.24, "cnt": 32}, "MoE_L0_bwd":{"total": 379.81, "avg": 11.87, "max": 11.00, "min": 12.38, "cnt": 32}, "backward-send-forward-recv":{"total": 4191.01, "avg": 144.52, "max": 2.24, "min": 938.58, "cnt": 29}, "backward-send":{"total": 2.46, "avg": 0.82, "max": 0.64, "min": 0.96, "cnt": 3}, "backward-recv":{"total": 238.95, "avg": 119.47, "max": 68.74, "min": 170.21, "cnt": 2}, "backward-params-all-reduce":{"total": 485.23, "avg": 485.23, "max": 485.23, "min": 485.23, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 250.78, "avg": 250.78, "max": 250.78, "min": 250.78, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 210.99, "avg": 210.99, "max": 210.99, "min": 210.99, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.36, "avg": 3.36, "max": 3.36, "min": 3.36, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}}}
{"type":"time", "iteration": 82, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 68.99, "avg": 23.00, "max": 1.19, "min": 57.59, "cnt": 3}, "forward-compute":{"total": 1829.18, "avg": 57.16, "max": 51.33, "min": 63.99, "cnt": 32}, "fwd-compute":{"total": 1826.19, "avg": 57.07, "max": 51.25, "min": 63.90, "cnt": 32}, "batch-generator":{"total": 38.90, "avg": 1.22, "max": 0.72, "min": 2.35, "cnt": 32}, "fwd-embedding":{"total": 0.61, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1773.66, "avg": 55.43, "max": 50.09, "min": 62.48, "cnt": 32}, "fwd-layernorm":{"total": 9.70, "avg": 0.08, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 114.75, "avg": 0.90, "max": 0.74, "min": 6.67, "cnt": 128}, "fwd-misc":{"total": 21.44, "avg": 0.17, "max": 0.11, "min": 0.55, "cnt": 128}, "fwd-MLP":{"total": 1606.20, "avg": 12.55, "max": 10.27, "min": 19.24, "cnt": 128}, "MoE_L0_fwd":{"total": 461.82, "avg": 14.43, "max": 11.69, "min": 19.15, "cnt": 32}, "MoEMLP":{"total": 1588.80, "avg": 12.41, "max": 10.16, "min": 19.11, "cnt": 128}, "MoE_L1_fwd":{"total": 373.24, "avg": 11.66, "max": 10.77, "min": 15.12, "cnt": 32}, "MoE_L2_fwd":{"total": 354.53, "avg": 11.08, "max": 10.20, "min": 14.64, "cnt": 32}, "MoE_L3_fwd":{"total": 405.47, "avg": 12.67, "max": 12.04, "min": 14.23, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.43, "avg": 0.72, "max": 0.71, "min": 0.72, "cnt": 2}, "forward-send-backward-recv":{"total": 204.10, "avg": 6.80, "max": 1.52, "min": 133.23, "cnt": 30}, "backward-compute":{"total": 1729.19, "avg": 54.04, "max": 50.86, "min": 57.99, "cnt": 32}, "MoE_L3_bwd":{"total": 448.98, "avg": 14.03, "max": 12.87, "min": 17.08, "cnt": 32}, "MoE_L2_bwd":{"total": 352.61, "avg": 11.02, "max": 10.29, "min": 11.84, "cnt": 32}, "MoE_L1_bwd":{"total": 335.80, "avg": 10.49, "max": 10.16, "min": 10.87, "cnt": 32}, "MoE_L0_bwd":{"total": 378.61, "avg": 11.83, "max": 11.24, "min": 12.11, "cnt": 32}, "backward-send-forward-recv":{"total": 2829.88, "avg": 97.58, "max": 2.36, "min": 415.92, "cnt": 29}, "backward-send":{"total": 2.47, "avg": 0.82, "max": 0.50, "min": 1.02, "cnt": 3}, "backward-recv":{"total": 186.35, "avg": 93.17, "max": 60.15, "min": 126.20, "cnt": 2}, "backward-params-all-reduce":{"total": 486.20, "avg": 486.20, "max": 486.20, "min": 486.20, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 255.01, "avg": 255.01, "max": 255.01, "min": 255.01, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 215.13, "avg": 215.13, "max": 215.13, "min": 215.13, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.27, "avg": 3.27, "max": 3.27, "min": 3.27, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.41, "avg": 3.41, "max": 3.41, "min": 3.41, "cnt": 1}}}
{"type":"time", "iteration": 83, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 78.33, "avg": 26.11, "max": 1.14, "min": 68.46, "cnt": 3}, "forward-compute":{"total": 1922.07, "avg": 60.06, "max": 51.32, "min": 118.82, "cnt": 32}, "fwd-compute":{"total": 1919.06, "avg": 59.97, "max": 51.25, "min": 118.68, "cnt": 32}, "batch-generator":{"total": 46.52, "avg": 1.45, "max": 0.69, "min": 4.25, "cnt": 32}, "fwd-embedding":{"total": 0.67, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1860.21, "avg": 58.13, "max": 50.26, "min": 116.40, "cnt": 32}, "fwd-layernorm":{"total": 10.08, "avg": 0.08, "max": 0.05, "min": 0.18, "cnt": 128}, "fwd-attn":{"total": 112.46, "avg": 0.88, "max": 0.74, "min": 1.91, "cnt": 128}, "fwd-misc":{"total": 21.93, "avg": 0.17, "max": 0.11, "min": 0.46, "cnt": 128}, "fwd-MLP":{"total": 1693.87, "avg": 13.23, "max": 10.55, "min": 76.49, "cnt": 128}, "MoE_L0_fwd":{"total": 538.96, "avg": 16.84, "max": 11.69, "min": 76.35, "cnt": 32}, "MoEMLP":{"total": 1675.88, "avg": 13.09, "max": 10.45, "min": 76.27, "cnt": 128}, "MoE_L1_fwd":{"total": 375.62, "avg": 11.74, "max": 10.67, "min": 14.63, "cnt": 32}, "MoE_L2_fwd":{"total": 359.45, "avg": 11.23, "max": 10.49, "min": 16.16, "cnt": 32}, "MoE_L3_fwd":{"total": 408.30, "avg": 12.76, "max": 12.03, "min": 18.03, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.56, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 3.78, "avg": 1.89, "max": 0.89, "min": 2.89, "cnt": 2}, "forward-send-backward-recv":{"total": 182.34, "avg": 6.08, "max": 1.79, "min": 111.27, "cnt": 30}, "backward-compute":{"total": 1753.25, "avg": 54.79, "max": 53.12, "min": 58.45, "cnt": 32}, "MoE_L3_bwd":{"total": 455.58, "avg": 14.24, "max": 12.91, "min": 15.39, "cnt": 32}, "MoE_L2_bwd":{"total": 365.76, "avg": 11.43, "max": 10.65, "min": 14.31, "cnt": 32}, "MoE_L1_bwd":{"total": 336.91, "avg": 10.53, "max": 9.95, "min": 11.25, "cnt": 32}, "MoE_L0_bwd":{"total": 382.36, "avg": 11.95, "max": 11.49, "min": 13.25, "cnt": 32}, "backward-send-forward-recv":{"total": 2875.46, "avg": 99.15, "max": 2.36, "min": 306.45, "cnt": 29}, "backward-send":{"total": 2.59, "avg": 0.86, "max": 0.67, "min": 1.01, "cnt": 3}, "backward-recv":{"total": 127.03, "avg": 63.52, "max": 63.35, "min": 63.68, "cnt": 2}, "backward-params-all-reduce":{"total": 486.56, "avg": 486.56, "max": 486.56, "min": 486.56, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 251.91, "avg": 251.91, "max": 251.91, "min": 251.91, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 212.13, "avg": 212.13, "max": 212.13, "min": 212.13, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.22, "avg": 3.22, "max": 3.22, "min": 3.22, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.47, "avg": 3.47, "max": 3.47, "min": 3.47, "cnt": 1}}}
{"type":"time", "iteration": 84, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 64.62, "avg": 21.54, "max": 0.93, "min": 62.61, "cnt": 3}, "forward-compute":{"total": 1831.12, "avg": 57.22, "max": 52.04, "min": 62.30, "cnt": 32}, "fwd-compute":{"total": 1828.17, "avg": 57.13, "max": 51.96, "min": 62.21, "cnt": 32}, "batch-generator":{"total": 35.54, "avg": 1.11, "max": 0.74, "min": 1.72, "cnt": 32}, "fwd-embedding":{"total": 0.53, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1780.97, "avg": 55.66, "max": 50.87, "min": 60.63, "cnt": 32}, "fwd-layernorm":{"total": 9.25, "avg": 0.07, "max": 0.06, "min": 0.18, "cnt": 128}, "fwd-attn":{"total": 106.94, "avg": 0.84, "max": 0.74, "min": 1.49, "cnt": 128}, "fwd-misc":{"total": 20.31, "avg": 0.16, "max": 0.11, "min": 0.33, "cnt": 128}, "fwd-MLP":{"total": 1624.14, "avg": 12.69, "max": 10.80, "min": 19.62, "cnt": 128}, "MoE_L0_fwd":{"total": 482.78, "avg": 15.09, "max": 11.52, "min": 19.53, "cnt": 32}, "MoEMLP":{"total": 1607.59, "avg": 12.56, "max": 10.68, "min": 19.49, "cnt": 128}, "MoE_L1_fwd":{"total": 375.82, "avg": 11.74, "max": 10.72, "min": 13.03, "cnt": 32}, "MoE_L2_fwd":{"total": 366.58, "avg": 11.46, "max": 10.86, "min": 12.42, "cnt": 32}, "MoE_L3_fwd":{"total": 388.39, "avg": 12.14, "max": 11.51, "min": 12.88, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.56, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.74, "avg": 0.87, "max": 0.86, "min": 0.88, "cnt": 2}, "forward-send-backward-recv":{"total": 547.04, "avg": 18.23, "max": 1.51, "min": 129.69, "cnt": 30}, "backward-compute":{"total": 1756.17, "avg": 54.88, "max": 52.57, "min": 56.32, "cnt": 32}, "MoE_L3_bwd":{"total": 443.34, "avg": 13.85, "max": 12.60, "min": 15.09, "cnt": 32}, "MoE_L2_bwd":{"total": 379.93, "avg": 11.87, "max": 11.12, "min": 12.70, "cnt": 32}, "MoE_L1_bwd":{"total": 344.53, "avg": 10.77, "max": 10.26, "min": 12.11, "cnt": 32}, "MoE_L0_bwd":{"total": 374.74, "avg": 11.71, "max": 11.11, "min": 12.00, "cnt": 32}, "backward-send-forward-recv":{"total": 3698.19, "avg": 127.52, "max": 2.28, "min": 440.13, "cnt": 29}, "backward-send":{"total": 2.80, "avg": 0.93, "max": 0.90, "min": 0.95, "cnt": 3}, "backward-recv":{"total": 137.50, "avg": 68.75, "max": 64.32, "min": 73.18, "cnt": 2}, "backward-params-all-reduce":{"total": 490.30, "avg": 490.30, "max": 490.30, "min": 490.30, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 256.32, "avg": 256.32, "max": 256.32, "min": 256.32, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 216.56, "avg": 216.56, "max": 216.56, "min": 216.56, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.32, "avg": 3.32, "max": 3.32, "min": 3.32, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.41, "avg": 3.41, "max": 3.41, "min": 3.41, "cnt": 1}}}
{"type":"time", "iteration": 85, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.06, "avg": 0.06, "max": 0.06, "min": 0.06, "cnt": 1}, "forward-recv":{"total": 59.41, "avg": 19.80, "max": 1.68, "min": 55.62, "cnt": 3}, "forward-compute":{"total": 1830.45, "avg": 57.20, "max": 50.79, "min": 67.46, "cnt": 32}, "fwd-compute":{"total": 1827.45, "avg": 57.11, "max": 50.71, "min": 67.37, "cnt": 32}, "batch-generator":{"total": 43.77, "avg": 1.37, "max": 0.66, "min": 2.92, "cnt": 32}, "fwd-embedding":{"total": 0.56, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1771.90, "avg": 55.37, "max": 49.72, "min": 66.04, "cnt": 32}, "fwd-layernorm":{"total": 9.68, "avg": 0.08, "max": 0.05, "min": 0.22, "cnt": 128}, "fwd-attn":{"total": 107.93, "avg": 0.84, "max": 0.74, "min": 2.09, "cnt": 128}, "fwd-misc":{"total": 20.95, "avg": 0.16, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1612.54, "avg": 12.60, "max": 11.01, "min": 23.48, "cnt": 128}, "MoE_L0_fwd":{"total": 467.88, "avg": 14.62, "max": 11.24, "min": 23.39, "cnt": 32}, "MoEMLP":{"total": 1595.29, "avg": 12.46, "max": 10.89, "min": 23.35, "cnt": 128}, "MoE_L1_fwd":{"total": 380.73, "avg": 11.90, "max": 10.94, "min": 14.73, "cnt": 32}, "MoE_L2_fwd":{"total": 369.32, "avg": 11.54, "max": 10.97, "min": 14.92, "cnt": 32}, "MoE_L3_fwd":{"total": 383.52, "avg": 11.99, "max": 11.41, "min": 14.37, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.72, "avg": 0.86, "max": 0.73, "min": 0.99, "cnt": 2}, "forward-send-backward-recv":{"total": 219.35, "avg": 7.31, "max": 1.57, "min": 136.50, "cnt": 30}, "backward-compute":{"total": 1752.72, "avg": 54.77, "max": 52.48, "min": 58.07, "cnt": 32}, "MoE_L3_bwd":{"total": 438.92, "avg": 13.72, "max": 12.70, "min": 15.43, "cnt": 32}, "MoE_L2_bwd":{"total": 376.92, "avg": 11.78, "max": 11.05, "min": 12.68, "cnt": 32}, "MoE_L1_bwd":{"total": 349.41, "avg": 10.92, "max": 10.38, "min": 13.27, "cnt": 32}, "MoE_L0_bwd":{"total": 373.35, "avg": 11.67, "max": 11.27, "min": 12.36, "cnt": 32}, "backward-send-forward-recv":{"total": 3712.46, "avg": 128.02, "max": 1.58, "min": 354.56, "cnt": 29}, "backward-send":{"total": 2.67, "avg": 0.89, "max": 0.81, "min": 1.00, "cnt": 3}, "backward-recv":{"total": 130.78, "avg": 65.39, "max": 64.72, "min": 66.06, "cnt": 2}, "backward-params-all-reduce":{"total": 485.62, "avg": 485.62, "max": 485.62, "min": 485.62, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 255.62, "avg": 255.62, "max": 255.62, "min": 255.62, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 215.83, "avg": 215.83, "max": 215.83, "min": 215.83, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.27, "avg": 3.27, "max": 3.27, "min": 3.27, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}}}
{"type":"time", "iteration": 86, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 484.02, "avg": 161.34, "max": 1.21, "min": 427.93, "cnt": 3}, "forward-compute":{"total": 1875.45, "avg": 58.61, "max": 51.41, "min": 65.33, "cnt": 32}, "fwd-compute":{"total": 1872.55, "avg": 58.52, "max": 51.35, "min": 65.22, "cnt": 32}, "batch-generator":{"total": 52.26, "avg": 1.63, "max": 0.72, "min": 4.35, "cnt": 32}, "fwd-embedding":{"total": 0.73, "avg": 0.02, "max": 0.01, "min": 0.09, "cnt": 32}, "fwd-encoder":{"total": 1807.52, "avg": 56.48, "max": 50.32, "min": 62.07, "cnt": 32}, "fwd-layernorm":{"total": 10.38, "avg": 0.08, "max": 0.05, "min": 0.24, "cnt": 128}, "fwd-attn":{"total": 111.41, "avg": 0.87, "max": 0.74, "min": 1.74, "cnt": 128}, "fwd-misc":{"total": 21.90, "avg": 0.17, "max": 0.11, "min": 0.47, "cnt": 128}, "fwd-MLP":{"total": 1642.17, "avg": 12.83, "max": 10.93, "min": 18.83, "cnt": 128}, "MoE_L0_fwd":{"total": 476.50, "avg": 14.89, "max": 11.28, "min": 18.75, "cnt": 32}, "MoEMLP":{"total": 1624.16, "avg": 12.69, "max": 10.83, "min": 18.70, "cnt": 128}, "MoE_L1_fwd":{"total": 382.24, "avg": 11.94, "max": 10.87, "min": 15.20, "cnt": 32}, "MoE_L2_fwd":{"total": 388.16, "avg": 12.13, "max": 11.35, "min": 13.91, "cnt": 32}, "MoE_L3_fwd":{"total": 383.69, "avg": 11.99, "max": 11.40, "min": 15.95, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 2.92, "avg": 1.46, "max": 0.88, "min": 2.05, "cnt": 2}, "forward-send-backward-recv":{"total": 72.06, "avg": 2.40, "max": 1.79, "min": 6.96, "cnt": 30}, "backward-compute":{"total": 1757.63, "avg": 54.93, "max": 52.51, "min": 58.57, "cnt": 32}, "MoE_L3_bwd":{"total": 437.23, "avg": 13.66, "max": 12.79, "min": 16.93, "cnt": 32}, "MoE_L2_bwd":{"total": 389.93, "avg": 12.19, "max": 11.70, "min": 12.90, "cnt": 32}, "MoE_L1_bwd":{"total": 333.98, "avg": 10.44, "max": 9.79, "min": 11.00, "cnt": 32}, "MoE_L0_bwd":{"total": 382.95, "avg": 11.97, "max": 11.22, "min": 12.49, "cnt": 32}, "backward-send-forward-recv":{"total": 5164.59, "avg": 178.09, "max": 2.36, "min": 863.83, "cnt": 29}, "backward-send":{"total": 3.10, "avg": 1.03, "max": 0.86, "min": 1.13, "cnt": 3}, "backward-recv":{"total": 130.07, "avg": 65.04, "max": 64.36, "min": 65.72, "cnt": 2}, "backward-params-all-reduce":{"total": 488.01, "avg": 488.01, "max": 488.01, "min": 488.01, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 256.93, "avg": 256.93, "max": 256.93, "min": 256.93, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 217.31, "avg": 217.31, "max": 217.31, "min": 217.31, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.32, "avg": 3.32, "max": 3.32, "min": 3.32, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 87, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 67.70, "avg": 22.57, "max": 0.96, "min": 63.38, "cnt": 3}, "forward-compute":{"total": 1905.92, "avg": 59.56, "max": 52.36, "min": 67.36, "cnt": 32}, "fwd-compute":{"total": 1902.94, "avg": 59.47, "max": 52.29, "min": 67.29, "cnt": 32}, "batch-generator":{"total": 39.24, "avg": 1.23, "max": 0.66, "min": 2.02, "cnt": 32}, "fwd-embedding":{"total": 0.59, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1851.60, "avg": 57.86, "max": 51.25, "min": 66.14, "cnt": 32}, "fwd-layernorm":{"total": 9.38, "avg": 0.07, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 107.71, "avg": 0.84, "max": 0.74, "min": 1.46, "cnt": 128}, "fwd-misc":{"total": 20.31, "avg": 0.16, "max": 0.11, "min": 0.39, "cnt": 128}, "fwd-MLP":{"total": 1693.88, "avg": 13.23, "max": 10.67, "min": 19.48, "cnt": 128}, "MoE_L0_fwd":{"total": 505.79, "avg": 15.81, "max": 12.03, "min": 19.40, "cnt": 32}, "MoEMLP":{"total": 1677.23, "avg": 13.10, "max": 10.56, "min": 19.35, "cnt": 128}, "MoE_L1_fwd":{"total": 387.79, "avg": 12.12, "max": 10.60, "min": 14.51, "cnt": 32}, "MoE_L2_fwd":{"total": 392.51, "avg": 12.27, "max": 11.13, "min": 16.20, "cnt": 32}, "MoE_L3_fwd":{"total": 397.22, "avg": 12.41, "max": 11.35, "min": 17.63, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.56, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 8.90, "avg": 4.45, "max": 0.71, "min": 8.19, "cnt": 2}, "forward-send-backward-recv":{"total": 386.61, "avg": 12.89, "max": 1.43, "min": 133.61, "cnt": 30}, "backward-compute":{"total": 1807.45, "avg": 56.48, "max": 53.96, "min": 58.29, "cnt": 32}, "MoE_L3_bwd":{"total": 437.30, "avg": 13.67, "max": 12.89, "min": 15.10, "cnt": 32}, "MoE_L2_bwd":{"total": 403.94, "avg": 12.62, "max": 11.83, "min": 13.52, "cnt": 32}, "MoE_L1_bwd":{"total": 344.09, "avg": 10.75, "max": 10.11, "min": 11.80, "cnt": 32}, "MoE_L0_bwd":{"total": 409.23, "avg": 12.79, "max": 12.28, "min": 13.78, "cnt": 32}, "backward-send-forward-recv":{"total": 4942.82, "avg": 170.44, "max": 1.49, "min": 692.84, "cnt": 29}, "backward-send":{"total": 3.00, "avg": 1.00, "max": 0.85, "min": 1.15, "cnt": 3}, "backward-recv":{"total": 137.76, "avg": 68.88, "max": 66.24, "min": 71.52, "cnt": 2}, "backward-params-all-reduce":{"total": 494.04, "avg": 494.04, "max": 494.04, "min": 494.04, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 261.66, "avg": 261.66, "max": 261.66, "min": 261.66, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 217.49, "avg": 217.49, "max": 217.49, "min": 217.49, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.87, "avg": 6.87, "max": 6.87, "min": 6.87, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.47, "avg": 3.47, "max": 3.47, "min": 3.47, "cnt": 1}}}
{"type":"time", "iteration": 88, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 59.45, "avg": 19.82, "max": 1.22, "min": 56.87, "cnt": 3}, "forward-compute":{"total": 1874.18, "avg": 58.57, "max": 52.98, "min": 62.84, "cnt": 32}, "fwd-compute":{"total": 1871.23, "avg": 58.48, "max": 52.91, "min": 62.77, "cnt": 32}, "batch-generator":{"total": 46.27, "avg": 1.45, "max": 0.71, "min": 3.31, "cnt": 32}, "fwd-embedding":{"total": 0.56, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1812.89, "avg": 56.65, "max": 51.57, "min": 61.72, "cnt": 32}, "fwd-layernorm":{"total": 9.55, "avg": 0.07, "max": 0.05, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 107.98, "avg": 0.84, "max": 0.74, "min": 2.27, "cnt": 128}, "fwd-misc":{"total": 19.94, "avg": 0.16, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1655.01, "avg": 12.93, "max": 10.74, "min": 21.71, "cnt": 128}, "MoE_L0_fwd":{"total": 497.19, "avg": 15.54, "max": 12.45, "min": 21.63, "cnt": 32}, "MoEMLP":{"total": 1638.21, "avg": 12.80, "max": 10.63, "min": 21.59, "cnt": 128}, "MoE_L1_fwd":{"total": 370.33, "avg": 11.57, "max": 10.67, "min": 15.31, "cnt": 32}, "MoE_L2_fwd":{"total": 391.14, "avg": 12.22, "max": 11.31, "min": 16.15, "cnt": 32}, "MoE_L3_fwd":{"total": 385.67, "avg": 12.05, "max": 11.44, "min": 14.06, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.58, "avg": 0.79, "max": 0.76, "min": 0.82, "cnt": 2}, "forward-send-backward-recv":{"total": 187.76, "avg": 6.26, "max": 1.42, "min": 115.30, "cnt": 30}, "backward-compute":{"total": 1827.68, "avg": 57.12, "max": 55.07, "min": 59.40, "cnt": 32}, "MoE_L3_bwd":{"total": 440.19, "avg": 13.76, "max": 12.78, "min": 15.33, "cnt": 32}, "MoE_L2_bwd":{"total": 402.52, "avg": 12.58, "max": 11.82, "min": 13.26, "cnt": 32}, "MoE_L1_bwd":{"total": 324.62, "avg": 10.14, "max": 9.31, "min": 10.94, "cnt": 32}, "MoE_L0_bwd":{"total": 446.58, "avg": 13.96, "max": 13.39, "min": 14.78, "cnt": 32}, "backward-send-forward-recv":{"total": 3401.95, "avg": 117.31, "max": 1.63, "min": 646.21, "cnt": 29}, "backward-send":{"total": 1.85, "avg": 0.62, "max": 0.55, "min": 0.70, "cnt": 3}, "backward-recv":{"total": 130.08, "avg": 65.04, "max": 62.74, "min": 67.34, "cnt": 2}, "backward-params-all-reduce":{"total": 490.25, "avg": 490.25, "max": 490.25, "min": 490.25, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 263.39, "avg": 263.39, "max": 263.39, "min": 263.39, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 223.30, "avg": 223.30, "max": 223.30, "min": 223.30, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.47, "avg": 3.47, "max": 3.47, "min": 3.47, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 89, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 428.13, "avg": 142.71, "max": 0.96, "min": 363.11, "cnt": 3}, "forward-compute":{"total": 1874.29, "avg": 58.57, "max": 53.45, "min": 64.27, "cnt": 32}, "fwd-compute":{"total": 1871.19, "avg": 58.47, "max": 53.38, "min": 64.19, "cnt": 32}, "batch-generator":{"total": 43.06, "avg": 1.35, "max": 0.65, "min": 2.75, "cnt": 32}, "fwd-embedding":{"total": 0.58, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1816.04, "avg": 56.75, "max": 52.32, "min": 62.26, "cnt": 32}, "fwd-layernorm":{"total": 9.47, "avg": 0.07, "max": 0.05, "min": 0.18, "cnt": 128}, "fwd-attn":{"total": 109.66, "avg": 0.86, "max": 0.74, "min": 1.91, "cnt": 128}, "fwd-misc":{"total": 21.03, "avg": 0.16, "max": 0.11, "min": 0.38, "cnt": 128}, "fwd-MLP":{"total": 1655.08, "avg": 12.93, "max": 10.35, "min": 20.68, "cnt": 128}, "MoE_L0_fwd":{"total": 519.02, "avg": 16.22, "max": 13.13, "min": 20.60, "cnt": 32}, "MoEMLP":{"total": 1638.20, "avg": 12.80, "max": 10.22, "min": 20.55, "cnt": 128}, "MoE_L1_fwd":{"total": 365.32, "avg": 11.42, "max": 10.27, "min": 13.00, "cnt": 32}, "MoE_L2_fwd":{"total": 372.19, "avg": 11.63, "max": 11.10, "min": 12.89, "cnt": 32}, "MoE_L3_fwd":{"total": 387.84, "avg": 12.12, "max": 11.52, "min": 12.99, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 11.41, "avg": 5.70, "max": 0.62, "min": 10.79, "cnt": 2}, "forward-send-backward-recv":{"total": 52.63, "avg": 1.75, "max": 1.25, "min": 4.98, "cnt": 30}, "backward-compute":{"total": 1814.95, "avg": 56.72, "max": 53.64, "min": 58.92, "cnt": 32}, "MoE_L3_bwd":{"total": 445.23, "avg": 13.91, "max": 12.14, "min": 15.73, "cnt": 32}, "MoE_L2_bwd":{"total": 396.71, "avg": 12.40, "max": 11.69, "min": 13.10, "cnt": 32}, "MoE_L1_bwd":{"total": 308.18, "avg": 9.63, "max": 9.10, "min": 10.78, "cnt": 32}, "MoE_L0_bwd":{"total": 449.88, "avg": 14.06, "max": 13.39, "min": 15.35, "cnt": 32}, "backward-send-forward-recv":{"total": 4345.62, "avg": 149.85, "max": 2.37, "min": 512.00, "cnt": 29}, "backward-send":{"total": 3.07, "avg": 1.02, "max": 0.94, "min": 1.10, "cnt": 3}, "backward-recv":{"total": 162.43, "avg": 81.22, "max": 72.48, "min": 89.95, "cnt": 2}, "backward-params-all-reduce":{"total": 487.36, "avg": 487.36, "max": 487.36, "min": 487.36, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 257.86, "avg": 257.86, "max": 257.86, "min": 257.86, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 217.81, "avg": 217.81, "max": 217.81, "min": 217.81, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.53, "avg": 3.53, "max": 3.53, "min": 3.53, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 90, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 134.99, "avg": 45.00, "max": 0.90, "min": 129.09, "cnt": 3}, "forward-compute":{"total": 1868.11, "avg": 58.38, "max": 53.75, "min": 63.95, "cnt": 32}, "fwd-compute":{"total": 1864.96, "avg": 58.28, "max": 53.67, "min": 63.81, "cnt": 32}, "batch-generator":{"total": 51.25, "avg": 1.60, "max": 0.67, "min": 4.24, "cnt": 32}, "fwd-embedding":{"total": 0.66, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1801.00, "avg": 56.28, "max": 52.11, "min": 61.72, "cnt": 32}, "fwd-layernorm":{"total": 9.71, "avg": 0.08, "max": 0.05, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 108.55, "avg": 0.85, "max": 0.74, "min": 1.52, "cnt": 128}, "fwd-misc":{"total": 20.84, "avg": 0.16, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1640.87, "avg": 12.82, "max": 10.29, "min": 18.50, "cnt": 128}, "MoE_L0_fwd":{"total": 493.46, "avg": 15.42, "max": 12.51, "min": 18.39, "cnt": 32}, "MoEMLP":{"total": 1623.80, "avg": 12.69, "max": 10.17, "min": 18.35, "cnt": 128}, "MoE_L1_fwd":{"total": 359.12, "avg": 11.22, "max": 10.21, "min": 12.23, "cnt": 32}, "MoE_L2_fwd":{"total": 385.04, "avg": 12.03, "max": 11.05, "min": 15.05, "cnt": 32}, "MoE_L3_fwd":{"total": 392.27, "avg": 12.26, "max": 11.52, "min": 13.95, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.33, "avg": 0.66, "max": 0.54, "min": 0.78, "cnt": 2}, "forward-send-backward-recv":{"total": 1206.01, "avg": 40.20, "max": 1.34, "min": 239.56, "cnt": 30}, "backward-compute":{"total": 1806.58, "avg": 56.46, "max": 53.74, "min": 59.21, "cnt": 32}, "MoE_L3_bwd":{"total": 442.43, "avg": 13.83, "max": 12.39, "min": 15.73, "cnt": 32}, "MoE_L2_bwd":{"total": 400.96, "avg": 12.53, "max": 11.91, "min": 13.41, "cnt": 32}, "MoE_L1_bwd":{"total": 305.27, "avg": 9.54, "max": 9.14, "min": 10.22, "cnt": 32}, "MoE_L0_bwd":{"total": 445.17, "avg": 13.91, "max": 13.61, "min": 14.88, "cnt": 32}, "backward-send-forward-recv":{"total": 3621.24, "avg": 124.87, "max": 1.89, "min": 521.78, "cnt": 29}, "backward-send":{"total": 3.04, "avg": 1.01, "max": 0.96, "min": 1.08, "cnt": 3}, "backward-recv":{"total": 126.26, "avg": 63.13, "max": 60.08, "min": 66.18, "cnt": 2}, "backward-params-all-reduce":{"total": 493.72, "avg": 493.72, "max": 493.72, "min": 493.72, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 260.68, "avg": 260.68, "max": 260.68, "min": 260.68, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 220.84, "avg": 220.84, "max": 220.84, "min": 220.84, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.29, "avg": 3.29, "max": 3.29, "min": 3.29, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 91, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.06, "avg": 0.06, "max": 0.06, "min": 0.06, "cnt": 1}, "forward-recv":{"total": 65.58, "avg": 21.86, "max": 0.89, "min": 56.53, "cnt": 3}, "forward-compute":{"total": 1888.30, "avg": 59.01, "max": 52.23, "min": 67.76, "cnt": 32}, "fwd-compute":{"total": 1885.07, "avg": 58.91, "max": 52.17, "min": 67.63, "cnt": 32}, "batch-generator":{"total": 47.97, "avg": 1.50, "max": 0.68, "min": 4.15, "cnt": 32}, "fwd-embedding":{"total": 0.74, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1823.72, "avg": 56.99, "max": 51.16, "min": 65.14, "cnt": 32}, "fwd-layernorm":{"total": 10.08, "avg": 0.08, "max": 0.05, "min": 0.23, "cnt": 128}, "fwd-attn":{"total": 109.86, "avg": 0.86, "max": 0.74, "min": 1.53, "cnt": 128}, "fwd-misc":{"total": 21.33, "avg": 0.17, "max": 0.11, "min": 0.39, "cnt": 128}, "fwd-MLP":{"total": 1661.22, "avg": 12.98, "max": 10.33, "min": 22.26, "cnt": 128}, "MoE_L0_fwd":{"total": 507.92, "avg": 15.87, "max": 12.72, "min": 22.17, "cnt": 32}, "MoEMLP":{"total": 1644.02, "avg": 12.84, "max": 10.20, "min": 22.12, "cnt": 128}, "MoE_L1_fwd":{"total": 369.55, "avg": 11.55, "max": 10.25, "min": 16.14, "cnt": 32}, "MoE_L2_fwd":{"total": 383.01, "avg": 11.97, "max": 11.17, "min": 15.51, "cnt": 32}, "MoE_L3_fwd":{"total": 389.75, "avg": 12.18, "max": 11.47, "min": 15.04, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.56, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.36, "avg": 0.68, "max": 0.62, "min": 0.74, "cnt": 2}, "forward-send-backward-recv":{"total": 195.79, "avg": 6.53, "max": 1.38, "min": 124.08, "cnt": 30}, "backward-compute":{"total": 1787.50, "avg": 55.86, "max": 54.52, "min": 57.27, "cnt": 32}, "MoE_L3_bwd":{"total": 441.66, "avg": 13.80, "max": 13.14, "min": 14.53, "cnt": 32}, "MoE_L2_bwd":{"total": 400.35, "avg": 12.51, "max": 11.81, "min": 13.36, "cnt": 32}, "MoE_L1_bwd":{"total": 300.56, "avg": 9.39, "max": 8.44, "min": 10.57, "cnt": 32}, "MoE_L0_bwd":{"total": 431.89, "avg": 13.50, "max": 13.14, "min": 14.09, "cnt": 32}, "backward-send-forward-recv":{"total": 3652.14, "avg": 125.94, "max": 1.75, "min": 924.17, "cnt": 29}, "backward-send":{"total": 2.21, "avg": 0.74, "max": 0.59, "min": 0.96, "cnt": 3}, "backward-recv":{"total": 139.86, "avg": 69.93, "max": 68.88, "min": 70.98, "cnt": 2}, "backward-params-all-reduce":{"total": 485.28, "avg": 485.28, "max": 485.28, "min": 485.28, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 259.73, "avg": 259.73, "max": 259.73, "min": 259.73, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 220.02, "avg": 220.02, "max": 220.02, "min": 220.02, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.25, "avg": 3.25, "max": 3.25, "min": 3.25, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 92, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.06, "avg": 0.06, "max": 0.06, "min": 0.06, "cnt": 1}, "forward-recv":{"total": 57.43, "avg": 19.14, "max": 0.94, "min": 54.49, "cnt": 3}, "forward-compute":{"total": 1887.92, "avg": 59.00, "max": 51.88, "min": 68.65, "cnt": 32}, "fwd-compute":{"total": 1884.58, "avg": 58.89, "max": 51.81, "min": 68.56, "cnt": 32}, "batch-generator":{"total": 48.54, "avg": 1.52, "max": 0.70, "min": 2.80, "cnt": 32}, "fwd-embedding":{"total": 0.69, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1822.78, "avg": 56.96, "max": 50.82, "min": 66.67, "cnt": 32}, "fwd-layernorm":{"total": 10.39, "avg": 0.08, "max": 0.05, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 111.56, "avg": 0.87, "max": 0.74, "min": 1.50, "cnt": 128}, "fwd-misc":{"total": 22.58, "avg": 0.18, "max": 0.11, "min": 0.69, "cnt": 128}, "fwd-MLP":{"total": 1656.47, "avg": 12.94, "max": 10.00, "min": 23.53, "cnt": 128}, "MoE_L0_fwd":{"total": 513.79, "avg": 16.06, "max": 12.80, "min": 23.38, "cnt": 32}, "MoEMLP":{"total": 1638.58, "avg": 12.80, "max": 9.89, "min": 23.29, "cnt": 128}, "MoE_L1_fwd":{"total": 364.05, "avg": 11.38, "max": 9.93, "min": 15.19, "cnt": 32}, "MoE_L2_fwd":{"total": 379.09, "avg": 11.85, "max": 11.19, "min": 13.56, "cnt": 32}, "MoE_L3_fwd":{"total": 388.22, "avg": 12.13, "max": 11.41, "min": 13.12, "cnt": 32}, "fwd-pooler":{"total": 0.36, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.56, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.26, "avg": 0.63, "max": 0.61, "min": 0.65, "cnt": 2}, "forward-send-backward-recv":{"total": 1483.37, "avg": 49.45, "max": 1.53, "min": 233.35, "cnt": 30}, "backward-compute":{"total": 1804.44, "avg": 56.39, "max": 52.83, "min": 65.29, "cnt": 32}, "MoE_L3_bwd":{"total": 457.50, "avg": 14.30, "max": 12.66, "min": 22.57, "cnt": 32}, "MoE_L2_bwd":{"total": 390.85, "avg": 12.21, "max": 11.60, "min": 13.15, "cnt": 32}, "MoE_L1_bwd":{"total": 302.64, "avg": 9.46, "max": 8.64, "min": 12.87, "cnt": 32}, "MoE_L0_bwd":{"total": 439.94, "avg": 13.75, "max": 13.04, "min": 16.22, "cnt": 32}, "backward-send-forward-recv":{"total": 2030.17, "avg": 70.01, "max": 1.69, "min": 337.24, "cnt": 29}, "backward-send":{"total": 2.97, "avg": 0.99, "max": 0.67, "min": 1.17, "cnt": 3}, "backward-recv":{"total": 133.51, "avg": 66.76, "max": 60.52, "min": 72.99, "cnt": 2}, "backward-params-all-reduce":{"total": 486.42, "avg": 486.42, "max": 486.42, "min": 486.42, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 254.13, "avg": 254.13, "max": 254.13, "min": 254.13, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 214.34, "avg": 214.34, "max": 214.34, "min": 214.34, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.30, "avg": 3.30, "max": 3.30, "min": 3.30, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.41, "avg": 3.41, "max": 3.41, "min": 3.41, "cnt": 1}}}
{"type":"time", "iteration": 93, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.06, "avg": 0.06, "max": 0.06, "min": 0.06, "cnt": 1}, "forward-recv":{"total": 73.56, "avg": 24.52, "max": 0.93, "min": 64.42, "cnt": 3}, "forward-compute":{"total": 3581.49, "avg": 111.92, "max": 52.11, "min": 1823.44, "cnt": 32}, "fwd-compute":{"total": 3578.27, "avg": 111.82, "max": 52.04, "min": 1823.35, "cnt": 32}, "batch-generator":{"total": 44.34, "avg": 1.39, "max": 0.66, "min": 3.18, "cnt": 32}, "fwd-embedding":{"total": 0.69, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 3521.24, "avg": 110.04, "max": 51.05, "min": 1822.07, "cnt": 32}, "fwd-layernorm":{"total": 10.01, "avg": 0.08, "max": 0.05, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 110.24, "avg": 0.86, "max": 0.74, "min": 1.54, "cnt": 128}, "fwd-misc":{"total": 21.08, "avg": 0.16, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 3358.79, "avg": 26.24, "max": 9.84, "min": 1780.59, "cnt": 128}, "MoE_L0_fwd":{"total": 2246.76, "avg": 70.21, "max": 12.69, "min": 1780.45, "cnt": 32}, "MoEMLP":{"total": 3341.59, "avg": 26.11, "max": 9.74, "min": 1780.40, "cnt": 128}, "MoE_L1_fwd":{"total": 349.43, "avg": 10.92, "max": 9.77, "min": 13.53, "cnt": 32}, "MoE_L2_fwd":{"total": 369.72, "avg": 11.55, "max": 10.84, "min": 13.78, "cnt": 32}, "MoE_L3_fwd":{"total": 381.94, "avg": 11.94, "max": 11.35, "min": 12.92, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 4.66, "avg": 2.33, "max": 0.68, "min": 3.98, "cnt": 2}, "forward-send-backward-recv":{"total": 1557.72, "avg": 51.92, "max": 1.43, "min": 344.72, "cnt": 30}, "backward-compute":{"total": 1788.94, "avg": 55.90, "max": 53.54, "min": 67.08, "cnt": 32}, "MoE_L3_bwd":{"total": 455.52, "avg": 14.23, "max": 12.49, "min": 28.13, "cnt": 32}, "MoE_L2_bwd":{"total": 391.00, "avg": 12.22, "max": 10.97, "min": 12.90, "cnt": 32}, "MoE_L1_bwd":{"total": 294.50, "avg": 9.20, "max": 8.68, "min": 10.02, "cnt": 32}, "MoE_L0_bwd":{"total": 435.48, "avg": 13.61, "max": 12.97, "min": 14.18, "cnt": 32}, "backward-send-forward-recv":{"total": 3272.20, "avg": 112.83, "max": 2.31, "min": 442.72, "cnt": 29}, "backward-send":{"total": 2.72, "avg": 0.91, "max": 0.84, "min": 0.94, "cnt": 3}, "backward-recv":{"total": 335.34, "avg": 167.67, "max": 67.23, "min": 268.11, "cnt": 2}, "backward-params-all-reduce":{"total": 487.30, "avg": 487.30, "max": 487.30, "min": 487.30, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 249.10, "avg": 249.10, "max": 249.10, "min": 249.10, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 209.31, "avg": 209.31, "max": 209.31, "min": 209.31, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.33, "avg": 3.33, "max": 3.33, "min": 3.33, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.41, "avg": 3.41, "max": 3.41, "min": 3.41, "cnt": 1}}}
{"type":"time", "iteration": 94, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 57.78, "avg": 19.26, "max": 0.88, "min": 55.99, "cnt": 3}, "forward-compute":{"total": 1823.47, "avg": 56.98, "max": 51.69, "min": 63.51, "cnt": 32}, "fwd-compute":{"total": 1820.24, "avg": 56.88, "max": 51.61, "min": 63.42, "cnt": 32}, "batch-generator":{"total": 44.29, "avg": 1.38, "max": 0.70, "min": 3.44, "cnt": 32}, "fwd-embedding":{"total": 0.67, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1762.54, "avg": 55.08, "max": 50.51, "min": 62.01, "cnt": 32}, "fwd-layernorm":{"total": 10.24, "avg": 0.08, "max": 0.05, "min": 0.22, "cnt": 128}, "fwd-attn":{"total": 112.52, "avg": 0.88, "max": 0.74, "min": 2.71, "cnt": 128}, "fwd-misc":{"total": 21.43, "avg": 0.17, "max": 0.11, "min": 0.50, "cnt": 128}, "fwd-MLP":{"total": 1596.67, "avg": 12.47, "max": 9.99, "min": 20.58, "cnt": 128}, "MoE_L0_fwd":{"total": 484.87, "avg": 15.15, "max": 12.84, "min": 20.49, "cnt": 32}, "MoEMLP":{"total": 1579.27, "avg": 12.34, "max": 9.87, "min": 20.44, "cnt": 128}, "MoE_L1_fwd":{"total": 354.66, "avg": 11.08, "max": 9.92, "min": 16.74, "cnt": 32}, "MoE_L2_fwd":{"total": 359.13, "avg": 11.22, "max": 10.30, "min": 12.75, "cnt": 32}, "MoE_L3_fwd":{"total": 386.94, "avg": 12.09, "max": 11.22, "min": 15.02, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.19, "avg": 0.60, "max": 0.48, "min": 0.71, "cnt": 2}, "forward-send-backward-recv":{"total": 191.58, "avg": 6.39, "max": 1.24, "min": 127.18, "cnt": 30}, "backward-compute":{"total": 1769.55, "avg": 55.30, "max": 53.11, "min": 61.03, "cnt": 32}, "MoE_L3_bwd":{"total": 443.17, "avg": 13.85, "max": 12.49, "min": 15.41, "cnt": 32}, "MoE_L2_bwd":{"total": 376.28, "avg": 11.76, "max": 11.10, "min": 12.40, "cnt": 32}, "MoE_L1_bwd":{"total": 298.48, "avg": 9.33, "max": 8.68, "min": 11.61, "cnt": 32}, "MoE_L0_bwd":{"total": 435.69, "avg": 13.62, "max": 12.68, "min": 19.62, "cnt": 32}, "backward-send-forward-recv":{"total": 3896.96, "avg": 134.38, "max": 2.02, "min": 485.81, "cnt": 29}, "backward-send":{"total": 3.27, "avg": 1.09, "max": 1.03, "min": 1.15, "cnt": 3}, "backward-recv":{"total": 122.77, "avg": 61.38, "max": 54.12, "min": 68.64, "cnt": 2}, "backward-params-all-reduce":{"total": 479.91, "avg": 479.91, "max": 479.91, "min": 479.91, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 263.52, "avg": 263.52, "max": 263.52, "min": 263.52, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 223.67, "avg": 223.67, "max": 223.67, "min": 223.67, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.32, "avg": 3.32, "max": 3.32, "min": 3.32, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}}}
{"type":"time", "iteration": 95, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 70.70, "avg": 23.57, "max": 3.66, "min": 55.55, "cnt": 3}, "forward-compute":{"total": 1780.86, "avg": 55.65, "max": 50.82, "min": 61.76, "cnt": 32}, "fwd-compute":{"total": 1777.92, "avg": 55.56, "max": 50.75, "min": 61.66, "cnt": 32}, "batch-generator":{"total": 43.56, "avg": 1.36, "max": 0.66, "min": 3.44, "cnt": 32}, "fwd-embedding":{"total": 0.60, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1722.32, "avg": 53.82, "max": 49.77, "min": 59.25, "cnt": 32}, "fwd-layernorm":{"total": 9.35, "avg": 0.07, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 106.54, "avg": 0.83, "max": 0.74, "min": 1.50, "cnt": 128}, "fwd-misc":{"total": 20.15, "avg": 0.16, "max": 0.11, "min": 0.40, "cnt": 128}, "fwd-MLP":{"total": 1566.01, "avg": 12.23, "max": 9.83, "min": 19.52, "cnt": 128}, "MoE_L0_fwd":{"total": 481.28, "avg": 15.04, "max": 12.51, "min": 19.44, "cnt": 32}, "MoEMLP":{"total": 1549.40, "avg": 12.10, "max": 9.72, "min": 19.40, "cnt": 128}, "MoE_L1_fwd":{"total": 342.37, "avg": 10.70, "max": 9.76, "min": 15.03, "cnt": 32}, "MoE_L2_fwd":{"total": 365.39, "avg": 11.42, "max": 10.76, "min": 12.50, "cnt": 32}, "MoE_L3_fwd":{"total": 366.36, "avg": 11.45, "max": 10.91, "min": 12.47, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.10, "avg": 0.55, "max": 0.51, "min": 0.58, "cnt": 2}, "forward-send-backward-recv":{"total": 179.67, "avg": 5.99, "max": 1.18, "min": 117.12, "cnt": 30}, "backward-compute":{"total": 1754.95, "avg": 54.84, "max": 51.74, "min": 57.84, "cnt": 32}, "MoE_L3_bwd":{"total": 424.51, "avg": 13.27, "max": 11.87, "min": 15.19, "cnt": 32}, "MoE_L2_bwd":{"total": 388.80, "avg": 12.15, "max": 11.77, "min": 12.69, "cnt": 32}, "MoE_L1_bwd":{"total": 298.95, "avg": 9.34, "max": 8.78, "min": 12.16, "cnt": 32}, "MoE_L0_bwd":{"total": 428.39, "avg": 13.39, "max": 12.79, "min": 13.94, "cnt": 32}, "backward-send-forward-recv":{"total": 4219.70, "avg": 145.51, "max": 2.64, "min": 1083.22, "cnt": 29}, "backward-send":{"total": 3.13, "avg": 1.04, "max": 1.01, "min": 1.07, "cnt": 3}, "backward-recv":{"total": 121.57, "avg": 60.78, "max": 54.47, "min": 67.10, "cnt": 2}, "backward-params-all-reduce":{"total": 499.72, "avg": 499.72, "max": 499.72, "min": 499.72, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 260.59, "avg": 260.59, "max": 260.59, "min": 260.59, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 220.66, "avg": 220.66, "max": 220.66, "min": 220.66, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.35, "avg": 3.35, "max": 3.35, "min": 3.35, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 96, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 66.26, "avg": 22.09, "max": 0.85, "min": 61.28, "cnt": 3}, "forward-compute":{"total": 1784.52, "avg": 55.77, "max": 49.58, "min": 62.66, "cnt": 32}, "fwd-compute":{"total": 1781.65, "avg": 55.68, "max": 49.51, "min": 62.57, "cnt": 32}, "batch-generator":{"total": 44.01, "avg": 1.38, "max": 0.64, "min": 3.66, "cnt": 32}, "fwd-embedding":{"total": 0.60, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1725.78, "avg": 53.93, "max": 48.59, "min": 59.63, "cnt": 32}, "fwd-layernorm":{"total": 9.50, "avg": 0.07, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 108.28, "avg": 0.85, "max": 0.74, "min": 1.57, "cnt": 128}, "fwd-misc":{"total": 20.22, "avg": 0.16, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1567.65, "avg": 12.25, "max": 9.85, "min": 18.84, "cnt": 128}, "MoE_L0_fwd":{"total": 480.21, "avg": 15.01, "max": 12.16, "min": 18.68, "cnt": 32}, "MoEMLP":{"total": 1551.27, "avg": 12.12, "max": 9.74, "min": 18.59, "cnt": 128}, "MoE_L1_fwd":{"total": 349.37, "avg": 10.92, "max": 9.78, "min": 13.11, "cnt": 32}, "MoE_L2_fwd":{"total": 361.77, "avg": 11.31, "max": 10.82, "min": 12.16, "cnt": 32}, "MoE_L3_fwd":{"total": 365.88, "avg": 11.43, "max": 10.91, "min": 12.42, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.55, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 4.58, "avg": 2.29, "max": 0.80, "min": 3.78, "cnt": 2}, "forward-send-backward-recv":{"total": 917.92, "avg": 30.60, "max": 1.51, "min": 239.74, "cnt": 30}, "backward-compute":{"total": 1746.96, "avg": 54.59, "max": 51.98, "min": 56.25, "cnt": 32}, "MoE_L3_bwd":{"total": 429.39, "avg": 13.42, "max": 12.96, "min": 15.97, "cnt": 32}, "MoE_L2_bwd":{"total": 389.39, "avg": 12.17, "max": 11.37, "min": 13.15, "cnt": 32}, "MoE_L1_bwd":{"total": 296.38, "avg": 9.26, "max": 8.62, "min": 10.08, "cnt": 32}, "MoE_L0_bwd":{"total": 420.35, "avg": 13.14, "max": 12.19, "min": 13.93, "cnt": 32}, "backward-send-forward-recv":{"total": 6255.39, "avg": 215.70, "max": 2.10, "min": 1116.91, "cnt": 29}, "backward-send":{"total": 3.22, "avg": 1.07, "max": 0.94, "min": 1.20, "cnt": 3}, "backward-recv":{"total": 299.10, "avg": 149.55, "max": 69.94, "min": 229.16, "cnt": 2}, "backward-params-all-reduce":{"total": 484.07, "avg": 484.07, "max": 484.07, "min": 484.07, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 257.94, "avg": 257.94, "max": 257.94, "min": 257.94, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 218.10, "avg": 218.10, "max": 218.10, "min": 218.10, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.35, "avg": 3.35, "max": 3.35, "min": 3.35, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 97, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.06, "avg": 0.06, "max": 0.06, "min": 0.06, "cnt": 1}, "forward-recv":{"total": 74.61, "avg": 24.87, "max": 3.20, "min": 67.75, "cnt": 3}, "forward-compute":{"total": 1803.59, "avg": 56.36, "max": 49.99, "min": 60.93, "cnt": 32}, "fwd-compute":{"total": 1800.56, "avg": 56.27, "max": 49.93, "min": 60.85, "cnt": 32}, "batch-generator":{"total": 46.37, "avg": 1.45, "max": 0.66, "min": 3.20, "cnt": 32}, "fwd-embedding":{"total": 0.58, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1742.00, "avg": 54.44, "max": 48.98, "min": 58.68, "cnt": 32}, "fwd-layernorm":{"total": 9.48, "avg": 0.07, "max": 0.05, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 108.02, "avg": 0.84, "max": 0.74, "min": 1.60, "cnt": 128}, "fwd-misc":{"total": 20.02, "avg": 0.16, "max": 0.11, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1584.20, "avg": 12.38, "max": 9.83, "min": 19.90, "cnt": 128}, "MoE_L0_fwd":{"total": 489.34, "avg": 15.29, "max": 12.04, "min": 19.79, "cnt": 32}, "MoEMLP":{"total": 1568.01, "avg": 12.25, "max": 9.72, "min": 19.75, "cnt": 128}, "MoE_L1_fwd":{"total": 342.39, "avg": 10.70, "max": 9.76, "min": 12.60, "cnt": 32}, "MoE_L2_fwd":{"total": 367.80, "avg": 11.49, "max": 10.88, "min": 12.41, "cnt": 32}, "MoE_L3_fwd":{"total": 374.39, "avg": 11.70, "max": 10.77, "min": 13.44, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.56, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.28, "avg": 0.64, "max": 0.59, "min": 0.69, "cnt": 2}, "forward-send-backward-recv":{"total": 203.86, "avg": 6.80, "max": 1.45, "min": 131.20, "cnt": 30}, "backward-compute":{"total": 1756.07, "avg": 54.88, "max": 52.76, "min": 57.27, "cnt": 32}, "MoE_L3_bwd":{"total": 433.12, "avg": 13.54, "max": 11.96, "min": 16.11, "cnt": 32}, "MoE_L2_bwd":{"total": 390.41, "avg": 12.20, "max": 11.46, "min": 12.86, "cnt": 32}, "MoE_L1_bwd":{"total": 295.24, "avg": 9.23, "max": 8.31, "min": 10.22, "cnt": 32}, "MoE_L0_bwd":{"total": 423.89, "avg": 13.25, "max": 12.81, "min": 13.81, "cnt": 32}, "backward-send-forward-recv":{"total": 5313.28, "avg": 183.22, "max": 2.39, "min": 872.06, "cnt": 29}, "backward-send":{"total": 2.65, "avg": 0.88, "max": 0.85, "min": 0.93, "cnt": 3}, "backward-recv":{"total": 158.65, "avg": 79.32, "max": 60.50, "min": 98.15, "cnt": 2}, "backward-params-all-reduce":{"total": 488.11, "avg": 488.11, "max": 488.11, "min": 488.11, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 256.96, "avg": 256.96, "max": 256.96, "min": 256.96, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 216.96, "avg": 216.96, "max": 216.96, "min": 216.96, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.56, "avg": 3.56, "max": 3.56, "min": 3.56, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 98, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 66.30, "avg": 22.10, "max": 0.90, "min": 63.21, "cnt": 3}, "forward-compute":{"total": 1914.38, "avg": 59.82, "max": 51.29, "min": 133.09, "cnt": 32}, "fwd-compute":{"total": 1911.26, "avg": 59.73, "max": 51.23, "min": 133.02, "cnt": 32}, "batch-generator":{"total": 47.37, "avg": 1.48, "max": 0.66, "min": 3.24, "cnt": 32}, "fwd-embedding":{"total": 0.60, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1851.40, "avg": 57.86, "max": 50.23, "min": 132.07, "cnt": 32}, "fwd-layernorm":{"total": 9.51, "avg": 0.07, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 107.90, "avg": 0.84, "max": 0.74, "min": 1.49, "cnt": 128}, "fwd-misc":{"total": 20.05, "avg": 0.16, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1693.59, "avg": 13.23, "max": 10.09, "min": 92.95, "cnt": 128}, "MoE_L0_fwd":{"total": 492.86, "avg": 15.40, "max": 12.86, "min": 20.59, "cnt": 32}, "MoEMLP":{"total": 1676.85, "avg": 13.10, "max": 9.98, "min": 92.85, "cnt": 128}, "MoE_L1_fwd":{"total": 347.88, "avg": 10.87, "max": 10.02, "min": 12.55, "cnt": 32}, "MoE_L2_fwd":{"total": 466.53, "avg": 14.58, "max": 11.47, "min": 92.89, "cnt": 32}, "MoE_L3_fwd":{"total": 375.64, "avg": 11.74, "max": 10.79, "min": 15.10, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 3.12, "avg": 1.56, "max": 0.52, "min": 2.61, "cnt": 2}, "forward-send-backward-recv":{"total": 133.14, "avg": 4.44, "max": 1.28, "min": 40.07, "cnt": 30}, "backward-compute":{"total": 1780.01, "avg": 55.63, "max": 53.06, "min": 57.08, "cnt": 32}, "MoE_L3_bwd":{"total": 427.80, "avg": 13.37, "max": 11.68, "min": 14.49, "cnt": 32}, "MoE_L2_bwd":{"total": 405.38, "avg": 12.67, "max": 12.18, "min": 13.28, "cnt": 32}, "MoE_L1_bwd":{"total": 297.13, "avg": 9.29, "max": 8.73, "min": 10.08, "cnt": 32}, "MoE_L0_bwd":{"total": 438.35, "avg": 13.70, "max": 13.00, "min": 14.34, "cnt": 32}, "backward-send-forward-recv":{"total": 3190.56, "avg": 110.02, "max": 2.19, "min": 335.40, "cnt": 29}, "backward-send":{"total": 2.90, "avg": 0.97, "max": 0.84, "min": 1.07, "cnt": 3}, "backward-recv":{"total": 202.18, "avg": 101.09, "max": 67.81, "min": 134.37, "cnt": 2}, "backward-params-all-reduce":{"total": 489.23, "avg": 489.23, "max": 489.23, "min": 489.23, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 253.23, "avg": 253.23, "max": 253.23, "min": 253.23, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 213.38, "avg": 213.38, "max": 213.38, "min": 213.38, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.35, "avg": 3.35, "max": 3.35, "min": 3.35, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 99, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 61.42, "avg": 20.47, "max": 0.91, "min": 59.59, "cnt": 3}, "forward-compute":{"total": 1893.92, "avg": 59.18, "max": 52.00, "min": 71.36, "cnt": 32}, "fwd-compute":{"total": 1890.66, "avg": 59.08, "max": 51.94, "min": 71.23, "cnt": 32}, "batch-generator":{"total": 47.09, "avg": 1.47, "max": 0.63, "min": 2.95, "cnt": 32}, "fwd-embedding":{"total": 0.79, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1830.58, "avg": 57.21, "max": 51.00, "min": 69.18, "cnt": 32}, "fwd-layernorm":{"total": 10.59, "avg": 0.08, "max": 0.05, "min": 0.27, "cnt": 128}, "fwd-attn":{"total": 115.00, "avg": 0.90, "max": 0.74, "min": 2.22, "cnt": 128}, "fwd-misc":{"total": 22.21, "avg": 0.17, "max": 0.11, "min": 0.49, "cnt": 128}, "fwd-MLP":{"total": 1661.14, "avg": 12.98, "max": 10.08, "min": 21.01, "cnt": 128}, "MoE_L0_fwd":{"total": 508.46, "avg": 15.89, "max": 12.84, "min": 20.93, "cnt": 32}, "MoEMLP":{"total": 1643.68, "avg": 12.84, "max": 9.97, "min": 20.88, "cnt": 128}, "MoE_L1_fwd":{"total": 376.11, "avg": 11.75, "max": 10.01, "min": 16.91, "cnt": 32}, "MoE_L2_fwd":{"total": 392.74, "avg": 12.27, "max": 11.49, "min": 16.93, "cnt": 32}, "MoE_L3_fwd":{"total": 372.79, "avg": 11.65, "max": 10.60, "min": 13.12, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.56, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 4.03, "avg": 2.01, "max": 0.58, "min": 3.44, "cnt": 2}, "forward-send-backward-recv":{"total": 169.42, "avg": 5.65, "max": 1.15, "min": 123.67, "cnt": 30}, "backward-compute":{"total": 1797.42, "avg": 56.17, "max": 53.40, "min": 59.49, "cnt": 32}, "MoE_L3_bwd":{"total": 439.40, "avg": 13.73, "max": 11.83, "min": 16.64, "cnt": 32}, "MoE_L2_bwd":{"total": 407.61, "avg": 12.74, "max": 12.02, "min": 13.45, "cnt": 32}, "MoE_L1_bwd":{"total": 301.56, "avg": 9.42, "max": 8.76, "min": 11.14, "cnt": 32}, "MoE_L0_bwd":{"total": 437.51, "avg": 13.67, "max": 13.18, "min": 14.60, "cnt": 32}, "backward-send-forward-recv":{"total": 5216.90, "avg": 179.89, "max": 2.18, "min": 1280.09, "cnt": 29}, "backward-send":{"total": 2.77, "avg": 0.92, "max": 0.76, "min": 1.08, "cnt": 3}, "backward-recv":{"total": 117.34, "avg": 58.67, "max": 53.87, "min": 63.47, "cnt": 2}, "backward-params-all-reduce":{"total": 487.80, "avg": 487.80, "max": 487.80, "min": 487.80, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 257.55, "avg": 257.55, "max": 257.55, "min": 257.55, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 217.62, "avg": 217.62, "max": 217.62, "min": 217.62, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.30, "avg": 3.30, "max": 3.30, "min": 3.30, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 100, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 64.48, "avg": 21.49, "max": 0.91, "min": 57.78, "cnt": 3}, "forward-compute":{"total": 1853.42, "avg": 57.92, "max": 52.59, "min": 65.20, "cnt": 32}, "fwd-compute":{"total": 1850.50, "avg": 57.83, "max": 52.51, "min": 65.11, "cnt": 32}, "batch-generator":{"total": 44.80, "avg": 1.40, "max": 0.69, "min": 4.56, "cnt": 32}, "fwd-embedding":{"total": 0.60, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1793.50, "avg": 56.05, "max": 51.51, "min": 63.49, "cnt": 32}, "fwd-layernorm":{"total": 9.50, "avg": 0.07, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 107.00, "avg": 0.84, "max": 0.74, "min": 1.87, "cnt": 128}, "fwd-misc":{"total": 20.31, "avg": 0.16, "max": 0.11, "min": 0.38, "cnt": 128}, "fwd-MLP":{"total": 1636.27, "avg": 12.78, "max": 10.12, "min": 24.74, "cnt": 128}, "MoE_L0_fwd":{"total": 497.27, "avg": 15.54, "max": 12.95, "min": 24.65, "cnt": 32}, "MoEMLP":{"total": 1619.54, "avg": 12.65, "max": 10.01, "min": 24.59, "cnt": 128}, "MoE_L1_fwd":{"total": 362.38, "avg": 11.32, "max": 10.05, "min": 14.73, "cnt": 32}, "MoE_L2_fwd":{"total": 395.36, "avg": 12.35, "max": 11.11, "min": 14.79, "cnt": 32}, "MoE_L3_fwd":{"total": 370.56, "avg": 11.58, "max": 10.77, "min": 13.03, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.56, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.10, "avg": 0.55, "max": 0.55, "min": 0.55, "cnt": 2}, "forward-send-backward-recv":{"total": 188.19, "avg": 6.27, "max": 1.30, "min": 119.08, "cnt": 30}, "backward-compute":{"total": 1791.91, "avg": 56.00, "max": 53.64, "min": 58.68, "cnt": 32}, "MoE_L3_bwd":{"total": 438.75, "avg": 13.71, "max": 12.66, "min": 16.56, "cnt": 32}, "MoE_L2_bwd":{"total": 402.14, "avg": 12.57, "max": 11.80, "min": 13.67, "cnt": 32}, "MoE_L1_bwd":{"total": 308.73, "avg": 9.65, "max": 8.87, "min": 11.53, "cnt": 32}, "MoE_L0_bwd":{"total": 427.61, "avg": 13.36, "max": 12.92, "min": 14.00, "cnt": 32}, "backward-send-forward-recv":{"total": 6417.52, "avg": 221.29, "max": 2.35, "min": 812.56, "cnt": 29}, "backward-send":{"total": 2.58, "avg": 0.86, "max": 0.75, "min": 0.96, "cnt": 3}, "backward-recv":{"total": 128.55, "avg": 64.27, "max": 57.68, "min": 70.87, "cnt": 2}, "backward-params-all-reduce":{"total": 481.72, "avg": 481.72, "max": 481.72, "min": 481.72, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 263.52, "avg": 263.52, "max": 263.52, "min": 263.52, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 223.71, "avg": 223.71, "max": 223.71, "min": 223.71, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.27, "avg": 3.27, "max": 3.27, "min": 3.27, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 101, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 60.24, "avg": 20.08, "max": 1.25, "min": 56.84, "cnt": 3}, "forward-compute":{"total": 1916.22, "avg": 59.88, "max": 53.41, "min": 97.08, "cnt": 32}, "fwd-compute":{"total": 1912.88, "avg": 59.78, "max": 53.34, "min": 97.00, "cnt": 32}, "batch-generator":{"total": 42.95, "avg": 1.34, "max": 0.64, "min": 2.04, "cnt": 32}, "fwd-embedding":{"total": 0.72, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1856.92, "avg": 58.03, "max": 52.20, "min": 95.76, "cnt": 32}, "fwd-layernorm":{"total": 10.19, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 110.63, "avg": 0.86, "max": 0.74, "min": 2.13, "cnt": 128}, "fwd-misc":{"total": 21.74, "avg": 0.17, "max": 0.11, "min": 0.66, "cnt": 128}, "fwd-MLP":{"total": 1693.15, "avg": 13.23, "max": 10.45, "min": 55.77, "cnt": 128}, "MoE_L0_fwd":{"total": 536.06, "avg": 16.75, "max": 12.30, "min": 55.69, "cnt": 32}, "MoEMLP":{"total": 1675.63, "avg": 13.09, "max": 10.33, "min": 55.63, "cnt": 128}, "MoE_L1_fwd":{"total": 361.77, "avg": 11.31, "max": 10.37, "min": 12.50, "cnt": 32}, "MoE_L2_fwd":{"total": 402.93, "avg": 12.59, "max": 11.67, "min": 14.38, "cnt": 32}, "MoE_L3_fwd":{"total": 381.20, "avg": 11.91, "max": 11.44, "min": 12.60, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.29, "avg": 0.65, "max": 0.63, "min": 0.66, "cnt": 2}, "forward-send-backward-recv":{"total": 407.52, "avg": 13.58, "max": 1.24, "min": 175.12, "cnt": 30}, "backward-compute":{"total": 1812.48, "avg": 56.64, "max": 54.09, "min": 60.34, "cnt": 32}, "MoE_L3_bwd":{"total": 451.71, "avg": 14.12, "max": 12.65, "min": 17.40, "cnt": 32}, "MoE_L2_bwd":{"total": 403.67, "avg": 12.61, "max": 11.63, "min": 13.05, "cnt": 32}, "MoE_L1_bwd":{"total": 304.84, "avg": 9.53, "max": 8.73, "min": 10.04, "cnt": 32}, "MoE_L0_bwd":{"total": 433.00, "avg": 13.53, "max": 12.94, "min": 14.21, "cnt": 32}, "backward-send-forward-recv":{"total": 3704.53, "avg": 127.74, "max": 2.29, "min": 1215.45, "cnt": 29}, "backward-send":{"total": 2.73, "avg": 0.91, "max": 0.68, "min": 1.09, "cnt": 3}, "backward-recv":{"total": 277.10, "avg": 138.55, "max": 73.41, "min": 203.69, "cnt": 2}, "backward-params-all-reduce":{"total": 486.90, "avg": 486.90, "max": 486.90, "min": 486.90, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 257.11, "avg": 257.11, "max": 257.11, "min": 257.11, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 217.22, "avg": 217.22, "max": 217.22, "min": 217.22, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.33, "avg": 3.33, "max": 3.33, "min": 3.33, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.48, "avg": 3.48, "max": 3.48, "min": 3.48, "cnt": 1}}}
{"type":"time", "iteration": 102, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 70.34, "avg": 23.45, "max": 0.96, "min": 62.10, "cnt": 3}, "forward-compute":{"total": 1910.49, "avg": 59.70, "max": 52.66, "min": 65.64, "cnt": 32}, "fwd-compute":{"total": 1907.27, "avg": 59.60, "max": 52.59, "min": 65.56, "cnt": 32}, "batch-generator":{"total": 44.90, "avg": 1.40, "max": 0.69, "min": 4.31, "cnt": 32}, "fwd-embedding":{"total": 0.74, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1849.37, "avg": 57.79, "max": 51.48, "min": 63.76, "cnt": 32}, "fwd-layernorm":{"total": 10.34, "avg": 0.08, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 112.69, "avg": 0.88, "max": 0.74, "min": 1.54, "cnt": 128}, "fwd-misc":{"total": 21.94, "avg": 0.17, "max": 0.11, "min": 0.42, "cnt": 128}, "fwd-MLP":{"total": 1682.42, "avg": 13.14, "max": 10.50, "min": 22.38, "cnt": 128}, "MoE_L0_fwd":{"total": 518.75, "avg": 16.21, "max": 12.46, "min": 22.30, "cnt": 32}, "MoEMLP":{"total": 1664.62, "avg": 13.00, "max": 10.38, "min": 22.26, "cnt": 128}, "MoE_L1_fwd":{"total": 364.25, "avg": 11.38, "max": 10.42, "min": 13.73, "cnt": 32}, "MoE_L2_fwd":{"total": 395.86, "avg": 12.37, "max": 11.53, "min": 17.20, "cnt": 32}, "MoE_L3_fwd":{"total": 392.19, "avg": 12.26, "max": 11.55, "min": 15.37, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.56, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.22, "avg": 0.61, "max": 0.58, "min": 0.64, "cnt": 2}, "forward-send-backward-recv":{"total": 174.52, "avg": 5.82, "max": 1.35, "min": 116.12, "cnt": 30}, "backward-compute":{"total": 1834.44, "avg": 57.33, "max": 53.87, "min": 60.15, "cnt": 32}, "MoE_L3_bwd":{"total": 467.05, "avg": 14.60, "max": 12.49, "min": 16.43, "cnt": 32}, "MoE_L2_bwd":{"total": 418.23, "avg": 13.07, "max": 12.25, "min": 15.56, "cnt": 32}, "MoE_L1_bwd":{"total": 308.85, "avg": 9.65, "max": 9.10, "min": 10.40, "cnt": 32}, "MoE_L0_bwd":{"total": 428.65, "avg": 13.40, "max": 12.93, "min": 14.05, "cnt": 32}, "backward-send-forward-recv":{"total": 2932.15, "avg": 101.11, "max": 2.33, "min": 375.05, "cnt": 29}, "backward-send":{"total": 2.46, "avg": 0.82, "max": 0.62, "min": 1.08, "cnt": 3}, "backward-recv":{"total": 146.50, "avg": 73.25, "max": 70.56, "min": 75.93, "cnt": 2}, "backward-params-all-reduce":{"total": 489.60, "avg": 489.60, "max": 489.60, "min": 489.60, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 253.41, "avg": 253.41, "max": 253.41, "min": 253.41, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 213.72, "avg": 213.72, "max": 213.72, "min": 213.72, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.26, "avg": 3.26, "max": 3.26, "min": 3.26, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 103, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.06, "avg": 0.06, "max": 0.06, "min": 0.06, "cnt": 1}, "forward-recv":{"total": 56.59, "avg": 18.86, "max": 0.96, "min": 54.68, "cnt": 3}, "forward-compute":{"total": 1889.81, "avg": 59.06, "max": 52.36, "min": 68.91, "cnt": 32}, "fwd-compute":{"total": 1886.63, "avg": 58.96, "max": 52.29, "min": 68.82, "cnt": 32}, "batch-generator":{"total": 55.09, "avg": 1.72, "max": 0.66, "min": 4.00, "cnt": 32}, "fwd-embedding":{"total": 0.67, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1819.03, "avg": 56.84, "max": 51.35, "min": 65.23, "cnt": 32}, "fwd-layernorm":{"total": 9.90, "avg": 0.08, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 108.98, "avg": 0.85, "max": 0.74, "min": 1.48, "cnt": 128}, "fwd-misc":{"total": 20.85, "avg": 0.16, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1658.72, "avg": 12.96, "max": 10.63, "min": 24.99, "cnt": 128}, "MoE_L0_fwd":{"total": 490.26, "avg": 15.32, "max": 12.33, "min": 24.90, "cnt": 32}, "MoEMLP":{"total": 1641.97, "avg": 12.83, "max": 10.53, "min": 24.85, "cnt": 128}, "MoE_L1_fwd":{"total": 376.69, "avg": 11.77, "max": 10.57, "min": 14.63, "cnt": 32}, "MoE_L2_fwd":{"total": 396.31, "avg": 12.38, "max": 11.62, "min": 15.11, "cnt": 32}, "MoE_L3_fwd":{"total": 384.81, "avg": 12.03, "max": 11.50, "min": 13.34, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 6.56, "avg": 3.28, "max": 0.71, "min": 5.85, "cnt": 2}, "forward-send-backward-recv":{"total": 243.74, "avg": 8.12, "max": 1.26, "min": 122.57, "cnt": 30}, "backward-compute":{"total": 1785.72, "avg": 55.80, "max": 52.84, "min": 58.09, "cnt": 32}, "MoE_L3_bwd":{"total": 451.12, "avg": 14.10, "max": 12.96, "min": 16.48, "cnt": 32}, "MoE_L2_bwd":{"total": 412.74, "avg": 12.90, "max": 12.21, "min": 13.78, "cnt": 32}, "MoE_L1_bwd":{"total": 306.13, "avg": 9.57, "max": 8.96, "min": 9.79, "cnt": 32}, "MoE_L0_bwd":{"total": 404.02, "avg": 12.63, "max": 12.03, "min": 13.88, "cnt": 32}, "backward-send-forward-recv":{"total": 3073.81, "avg": 105.99, "max": 1.88, "min": 676.58, "cnt": 29}, "backward-send":{"total": 2.91, "avg": 0.97, "max": 0.64, "min": 1.15, "cnt": 3}, "backward-recv":{"total": 144.35, "avg": 72.17, "max": 70.95, "min": 73.40, "cnt": 2}, "backward-params-all-reduce":{"total": 486.74, "avg": 486.74, "max": 486.74, "min": 486.74, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 260.64, "avg": 260.64, "max": 260.64, "min": 260.64, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 216.45, "avg": 216.45, "max": 216.45, "min": 216.45, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.78, "avg": 6.78, "max": 6.78, "min": 6.78, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 104, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 1653.28, "avg": 551.09, "max": 1.98, "min": 1645.22, "cnt": 3}, "forward-compute":{"total": 1943.55, "avg": 60.74, "max": 53.61, "min": 69.09, "cnt": 32}, "fwd-compute":{"total": 1940.37, "avg": 60.64, "max": 53.53, "min": 68.99, "cnt": 32}, "batch-generator":{"total": 41.91, "avg": 1.31, "max": 0.78, "min": 2.13, "cnt": 32}, "fwd-embedding":{"total": 0.67, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1885.86, "avg": 58.93, "max": 52.42, "min": 67.09, "cnt": 32}, "fwd-layernorm":{"total": 10.19, "avg": 0.08, "max": 0.06, "min": 0.18, "cnt": 128}, "fwd-attn":{"total": 113.60, "avg": 0.89, "max": 0.74, "min": 2.24, "cnt": 128}, "fwd-misc":{"total": 21.72, "avg": 0.17, "max": 0.11, "min": 0.52, "cnt": 128}, "fwd-MLP":{"total": 1718.78, "avg": 13.43, "max": 10.84, "min": 21.48, "cnt": 128}, "MoE_L0_fwd":{"total": 528.32, "avg": 16.51, "max": 12.81, "min": 21.40, "cnt": 32}, "MoEMLP":{"total": 1700.95, "avg": 13.29, "max": 10.72, "min": 21.35, "cnt": 128}, "MoE_L1_fwd":{"total": 383.99, "avg": 12.00, "max": 10.77, "min": 15.25, "cnt": 32}, "MoE_L2_fwd":{"total": 403.47, "avg": 12.61, "max": 11.95, "min": 14.83, "cnt": 32}, "MoE_L3_fwd":{"total": 391.66, "avg": 12.24, "max": 11.38, "min": 15.84, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.16, "avg": 0.58, "max": 0.53, "min": 0.62, "cnt": 2}, "forward-send-backward-recv":{"total": 198.05, "avg": 6.60, "max": 1.32, "min": 126.39, "cnt": 30}, "backward-compute":{"total": 1817.60, "avg": 56.80, "max": 53.14, "min": 61.56, "cnt": 32}, "MoE_L3_bwd":{"total": 456.58, "avg": 14.27, "max": 13.02, "min": 16.21, "cnt": 32}, "MoE_L2_bwd":{"total": 411.44, "avg": 12.86, "max": 11.89, "min": 13.96, "cnt": 32}, "MoE_L1_bwd":{"total": 315.11, "avg": 9.85, "max": 9.18, "min": 14.05, "cnt": 32}, "MoE_L0_bwd":{"total": 418.46, "avg": 13.08, "max": 12.24, "min": 14.56, "cnt": 32}, "backward-send-forward-recv":{"total": 2323.09, "avg": 80.11, "max": 2.06, "min": 386.90, "cnt": 29}, "backward-send":{"total": 2.64, "avg": 0.88, "max": 0.73, "min": 1.02, "cnt": 3}, "backward-recv":{"total": 125.04, "avg": 62.52, "max": 60.34, "min": 64.70, "cnt": 2}, "backward-params-all-reduce":{"total": 487.06, "avg": 487.06, "max": 487.06, "min": 487.06, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 259.38, "avg": 259.38, "max": 259.38, "min": 259.38, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 215.12, "avg": 215.12, "max": 215.12, "min": 215.12, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.90, "avg": 6.90, "max": 6.90, "min": 6.90, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 105, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.06, "avg": 0.06, "max": 0.06, "min": 0.06, "cnt": 1}, "forward-recv":{"total": 69.79, "avg": 23.26, "max": 1.27, "min": 64.23, "cnt": 3}, "forward-compute":{"total": 1884.04, "avg": 58.88, "max": 52.27, "min": 64.97, "cnt": 32}, "fwd-compute":{"total": 1880.82, "avg": 58.78, "max": 52.21, "min": 64.90, "cnt": 32}, "batch-generator":{"total": 43.75, "avg": 1.37, "max": 0.67, "min": 2.97, "cnt": 32}, "fwd-embedding":{"total": 0.68, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1824.35, "avg": 57.01, "max": 51.24, "min": 63.65, "cnt": 32}, "fwd-layernorm":{"total": 9.80, "avg": 0.08, "max": 0.05, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 112.07, "avg": 0.88, "max": 0.74, "min": 2.08, "cnt": 128}, "fwd-misc":{"total": 20.59, "avg": 0.16, "max": 0.11, "min": 0.34, "cnt": 128}, "fwd-MLP":{"total": 1661.29, "avg": 12.98, "max": 10.66, "min": 22.24, "cnt": 128}, "MoE_L0_fwd":{"total": 491.99, "avg": 15.37, "max": 12.57, "min": 22.17, "cnt": 32}, "MoEMLP":{"total": 1644.35, "avg": 12.85, "max": 10.53, "min": 22.12, "cnt": 128}, "MoE_L1_fwd":{"total": 372.30, "avg": 11.63, "max": 10.57, "min": 15.27, "cnt": 32}, "MoE_L2_fwd":{"total": 393.79, "avg": 12.31, "max": 11.74, "min": 13.16, "cnt": 32}, "MoE_L3_fwd":{"total": 392.45, "avg": 12.26, "max": 11.46, "min": 13.21, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 2.04, "avg": 1.02, "max": 0.72, "min": 1.32, "cnt": 2}, "forward-send-backward-recv":{"total": 1028.36, "avg": 34.28, "max": 1.23, "min": 265.15, "cnt": 30}, "backward-compute":{"total": 1826.24, "avg": 57.07, "max": 55.02, "min": 61.21, "cnt": 32}, "MoE_L3_bwd":{"total": 469.81, "avg": 14.68, "max": 13.07, "min": 18.69, "cnt": 32}, "MoE_L2_bwd":{"total": 408.06, "avg": 12.75, "max": 12.08, "min": 13.72, "cnt": 32}, "MoE_L1_bwd":{"total": 309.99, "avg": 9.69, "max": 9.32, "min": 10.40, "cnt": 32}, "MoE_L0_bwd":{"total": 426.68, "avg": 13.33, "max": 12.83, "min": 14.47, "cnt": 32}, "backward-send-forward-recv":{"total": 2076.30, "avg": 71.60, "max": 2.36, "min": 284.87, "cnt": 29}, "backward-send":{"total": 2.37, "avg": 0.79, "max": 0.69, "min": 0.84, "cnt": 3}, "backward-recv":{"total": 178.83, "avg": 89.41, "max": 70.36, "min": 108.47, "cnt": 2}, "backward-params-all-reduce":{"total": 486.78, "avg": 486.78, "max": 486.78, "min": 486.78, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 259.21, "avg": 259.21, "max": 259.21, "min": 259.21, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 219.41, "avg": 219.41, "max": 219.41, "min": 219.41, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.30, "avg": 3.30, "max": 3.30, "min": 3.30, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.41, "avg": 3.41, "max": 3.41, "min": 3.41, "cnt": 1}}}
{"type":"time", "iteration": 106, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 66.38, "avg": 22.13, "max": 2.31, "min": 61.17, "cnt": 3}, "forward-compute":{"total": 1902.94, "avg": 59.47, "max": 53.10, "min": 67.07, "cnt": 32}, "fwd-compute":{"total": 1899.85, "avg": 59.37, "max": 53.03, "min": 66.99, "cnt": 32}, "batch-generator":{"total": 40.26, "avg": 1.26, "max": 0.69, "min": 2.79, "cnt": 32}, "fwd-embedding":{"total": 0.62, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1847.38, "avg": 57.73, "max": 52.00, "min": 65.20, "cnt": 32}, "fwd-layernorm":{"total": 9.84, "avg": 0.08, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 110.97, "avg": 0.87, "max": 0.74, "min": 1.88, "cnt": 128}, "fwd-misc":{"total": 21.18, "avg": 0.17, "max": 0.11, "min": 0.40, "cnt": 128}, "fwd-MLP":{"total": 1684.53, "avg": 13.16, "max": 10.65, "min": 21.30, "cnt": 128}, "MoE_L0_fwd":{"total": 511.99, "avg": 16.00, "max": 13.00, "min": 21.19, "cnt": 32}, "MoEMLP":{"total": 1667.34, "avg": 13.03, "max": 10.53, "min": 21.15, "cnt": 128}, "MoE_L1_fwd":{"total": 376.25, "avg": 11.76, "max": 10.56, "min": 16.00, "cnt": 32}, "MoE_L2_fwd":{"total": 396.91, "avg": 12.40, "max": 11.70, "min": 15.05, "cnt": 32}, "MoE_L3_fwd":{"total": 388.48, "avg": 12.14, "max": 11.50, "min": 15.56, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.26, "avg": 0.63, "max": 0.57, "min": 0.69, "cnt": 2}, "forward-send-backward-recv":{"total": 307.06, "avg": 10.24, "max": 1.33, "min": 128.79, "cnt": 30}, "backward-compute":{"total": 1823.61, "avg": 56.99, "max": 54.38, "min": 59.04, "cnt": 32}, "MoE_L3_bwd":{"total": 450.67, "avg": 14.08, "max": 12.56, "min": 16.27, "cnt": 32}, "MoE_L2_bwd":{"total": 405.43, "avg": 12.67, "max": 11.83, "min": 13.39, "cnt": 32}, "MoE_L1_bwd":{"total": 320.94, "avg": 10.03, "max": 9.28, "min": 11.52, "cnt": 32}, "MoE_L0_bwd":{"total": 434.02, "avg": 13.56, "max": 13.00, "min": 14.37, "cnt": 32}, "backward-send-forward-recv":{"total": 3718.04, "avg": 128.21, "max": 2.21, "min": 700.55, "cnt": 29}, "backward-send":{"total": 2.19, "avg": 0.73, "max": 0.45, "min": 0.93, "cnt": 3}, "backward-recv":{"total": 199.85, "avg": 99.93, "max": 70.68, "min": 129.17, "cnt": 2}, "backward-params-all-reduce":{"total": 483.49, "avg": 483.49, "max": 483.49, "min": 483.49, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 255.78, "avg": 255.78, "max": 255.78, "min": 255.78, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 216.06, "avg": 216.06, "max": 216.06, "min": 216.06, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.27, "avg": 3.27, "max": 3.27, "min": 3.27, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 107, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 66.96, "avg": 22.32, "max": 0.95, "min": 62.87, "cnt": 3}, "forward-compute":{"total": 1927.08, "avg": 60.22, "max": 53.75, "min": 69.43, "cnt": 32}, "fwd-compute":{"total": 1924.01, "avg": 60.13, "max": 53.68, "min": 69.35, "cnt": 32}, "batch-generator":{"total": 42.94, "avg": 1.34, "max": 0.67, "min": 3.17, "cnt": 32}, "fwd-embedding":{"total": 0.63, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1868.72, "avg": 58.40, "max": 52.60, "min": 67.04, "cnt": 32}, "fwd-layernorm":{"total": 9.88, "avg": 0.08, "max": 0.06, "min": 0.17, "cnt": 128}, "fwd-attn":{"total": 110.03, "avg": 0.86, "max": 0.74, "min": 1.46, "cnt": 128}, "fwd-misc":{"total": 21.12, "avg": 0.16, "max": 0.11, "min": 0.39, "cnt": 128}, "fwd-MLP":{"total": 1706.46, "avg": 13.33, "max": 10.85, "min": 21.04, "cnt": 128}, "MoE_L0_fwd":{"total": 524.29, "avg": 16.38, "max": 12.69, "min": 20.96, "cnt": 32}, "MoEMLP":{"total": 1689.23, "avg": 13.20, "max": 10.74, "min": 20.92, "cnt": 128}, "MoE_L1_fwd":{"total": 382.61, "avg": 11.96, "max": 10.78, "min": 14.62, "cnt": 32}, "MoE_L2_fwd":{"total": 398.78, "avg": 12.46, "max": 11.75, "min": 15.48, "cnt": 32}, "MoE_L3_fwd":{"total": 389.77, "avg": 12.18, "max": 11.47, "min": 17.85, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.56, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.43, "avg": 0.71, "max": 0.67, "min": 0.75, "cnt": 2}, "forward-send-backward-recv":{"total": 1276.12, "avg": 42.54, "max": 1.35, "min": 257.84, "cnt": 30}, "backward-compute":{"total": 1831.87, "avg": 57.25, "max": 55.43, "min": 58.06, "cnt": 32}, "MoE_L3_bwd":{"total": 450.31, "avg": 14.07, "max": 13.04, "min": 15.05, "cnt": 32}, "MoE_L2_bwd":{"total": 416.87, "avg": 13.03, "max": 12.40, "min": 13.74, "cnt": 32}, "MoE_L1_bwd":{"total": 321.06, "avg": 10.03, "max": 9.48, "min": 10.85, "cnt": 32}, "MoE_L0_bwd":{"total": 432.25, "avg": 13.51, "max": 13.06, "min": 14.21, "cnt": 32}, "backward-send-forward-recv":{"total": 1940.60, "avg": 66.92, "max": 1.63, "min": 672.22, "cnt": 29}, "backward-send":{"total": 2.47, "avg": 0.82, "max": 0.73, "min": 0.93, "cnt": 3}, "backward-recv":{"total": 438.50, "avg": 219.25, "max": 69.51, "min": 369.00, "cnt": 2}, "backward-params-all-reduce":{"total": 485.25, "avg": 485.25, "max": 485.25, "min": 485.25, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 256.95, "avg": 256.95, "max": 256.95, "min": 256.95, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 217.27, "avg": 217.27, "max": 217.27, "min": 217.27, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.25, "avg": 3.25, "max": 3.25, "min": 3.25, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.47, "avg": 3.47, "max": 3.47, "min": 3.47, "cnt": 1}}}
{"type":"time", "iteration": 108, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 67.92, "avg": 22.64, "max": 0.84, "min": 64.17, "cnt": 3}, "forward-compute":{"total": 1947.61, "avg": 60.86, "max": 53.89, "min": 70.59, "cnt": 32}, "fwd-compute":{"total": 1944.34, "avg": 60.76, "max": 53.81, "min": 70.50, "cnt": 32}, "batch-generator":{"total": 39.40, "avg": 1.23, "max": 0.65, "min": 1.78, "cnt": 32}, "fwd-embedding":{"total": 0.71, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1892.32, "avg": 59.13, "max": 52.67, "min": 69.20, "cnt": 32}, "fwd-layernorm":{"total": 10.26, "avg": 0.08, "max": 0.05, "min": 0.24, "cnt": 128}, "fwd-attn":{"total": 111.44, "avg": 0.87, "max": 0.74, "min": 1.75, "cnt": 128}, "fwd-misc":{"total": 21.28, "avg": 0.17, "max": 0.11, "min": 0.39, "cnt": 128}, "fwd-MLP":{"total": 1728.27, "avg": 13.50, "max": 10.71, "min": 23.21, "cnt": 128}, "MoE_L0_fwd":{"total": 532.02, "avg": 16.63, "max": 13.22, "min": 23.12, "cnt": 32}, "MoEMLP":{"total": 1711.10, "avg": 13.37, "max": 10.58, "min": 23.07, "cnt": 128}, "MoE_L1_fwd":{"total": 377.76, "avg": 11.80, "max": 10.63, "min": 16.02, "cnt": 32}, "MoE_L2_fwd":{"total": 408.22, "avg": 12.76, "max": 12.09, "min": 15.47, "cnt": 32}, "MoE_L3_fwd":{"total": 399.41, "avg": 12.48, "max": 11.61, "min": 14.08, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.23, "avg": 0.61, "max": 0.60, "min": 0.63, "cnt": 2}, "forward-send-backward-recv":{"total": 1335.32, "avg": 44.51, "max": 1.41, "min": 369.35, "cnt": 30}, "backward-compute":{"total": 1830.24, "avg": 57.19, "max": 54.58, "min": 60.30, "cnt": 32}, "MoE_L3_bwd":{"total": 463.69, "avg": 14.49, "max": 13.44, "min": 17.93, "cnt": 32}, "MoE_L2_bwd":{"total": 418.74, "avg": 13.09, "max": 12.63, "min": 13.82, "cnt": 32}, "MoE_L1_bwd":{"total": 312.35, "avg": 9.76, "max": 9.33, "min": 10.70, "cnt": 32}, "MoE_L0_bwd":{"total": 420.63, "avg": 13.14, "max": 12.48, "min": 13.85, "cnt": 32}, "backward-send-forward-recv":{"total": 2103.11, "avg": 72.52, "max": 1.63, "min": 327.75, "cnt": 29}, "backward-send":{"total": 3.82, "avg": 1.27, "max": 1.18, "min": 1.43, "cnt": 3}, "backward-recv":{"total": 433.96, "avg": 216.98, "max": 69.36, "min": 364.60, "cnt": 2}, "backward-params-all-reduce":{"total": 484.47, "avg": 484.47, "max": 484.47, "min": 484.47, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 262.40, "avg": 262.40, "max": 262.40, "min": 262.40, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 222.65, "avg": 222.65, "max": 222.65, "min": 222.65, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.28, "avg": 3.28, "max": 3.28, "min": 3.28, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 109, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.06, "avg": 0.06, "max": 0.06, "min": 0.06, "cnt": 1}, "forward-recv":{"total": 66.66, "avg": 22.22, "max": 2.63, "min": 57.46, "cnt": 3}, "forward-compute":{"total": 1864.00, "avg": 58.25, "max": 53.27, "min": 63.66, "cnt": 32}, "fwd-compute":{"total": 1861.05, "avg": 58.16, "max": 53.20, "min": 63.53, "cnt": 32}, "batch-generator":{"total": 47.76, "avg": 1.49, "max": 0.65, "min": 3.61, "cnt": 32}, "fwd-embedding":{"total": 0.56, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1801.66, "avg": 56.30, "max": 51.80, "min": 61.43, "cnt": 32}, "fwd-layernorm":{"total": 9.21, "avg": 0.07, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 106.51, "avg": 0.83, "max": 0.75, "min": 1.46, "cnt": 128}, "fwd-misc":{"total": 19.57, "avg": 0.15, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1646.91, "avg": 12.87, "max": 10.57, "min": 17.75, "cnt": 128}, "MoE_L0_fwd":{"total": 457.75, "avg": 14.30, "max": 12.14, "min": 17.67, "cnt": 32}, "MoEMLP":{"total": 1630.99, "avg": 12.74, "max": 10.47, "min": 17.63, "cnt": 128}, "MoE_L1_fwd":{"total": 377.03, "avg": 11.78, "max": 10.51, "min": 14.01, "cnt": 32}, "MoE_L2_fwd":{"total": 405.96, "avg": 12.69, "max": 12.20, "min": 13.79, "cnt": 32}, "MoE_L3_fwd":{"total": 396.14, "avg": 12.38, "max": 11.73, "min": 13.92, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.56, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.98, "avg": 0.99, "max": 0.82, "min": 1.16, "cnt": 2}, "forward-send-backward-recv":{"total": 259.54, "avg": 8.65, "max": 1.24, "min": 127.54, "cnt": 30}, "backward-compute":{"total": 1810.33, "avg": 56.57, "max": 54.18, "min": 57.93, "cnt": 32}, "MoE_L3_bwd":{"total": 457.21, "avg": 14.29, "max": 13.38, "min": 15.42, "cnt": 32}, "MoE_L2_bwd":{"total": 430.61, "avg": 13.46, "max": 12.82, "min": 14.68, "cnt": 32}, "MoE_L1_bwd":{"total": 306.77, "avg": 9.59, "max": 8.93, "min": 10.40, "cnt": 32}, "MoE_L0_bwd":{"total": 402.83, "avg": 12.59, "max": 12.06, "min": 13.23, "cnt": 32}, "backward-send-forward-recv":{"total": 2655.72, "avg": 91.58, "max": 2.44, "min": 386.13, "cnt": 29}, "backward-send":{"total": 3.23, "avg": 1.08, "max": 1.02, "min": 1.14, "cnt": 3}, "backward-recv":{"total": 119.98, "avg": 59.99, "max": 53.01, "min": 66.97, "cnt": 2}, "backward-params-all-reduce":{"total": 484.52, "avg": 484.52, "max": 484.52, "min": 484.52, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 260.57, "avg": 260.57, "max": 260.57, "min": 260.57, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 220.81, "avg": 220.81, "max": 220.81, "min": 220.81, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.28, "avg": 3.28, "max": 3.28, "min": 3.28, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}}}
{"type":"time", "iteration": 110, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 59.10, "avg": 19.70, "max": 0.90, "min": 57.20, "cnt": 3}, "forward-compute":{"total": 1915.89, "avg": 59.87, "max": 54.21, "min": 65.23, "cnt": 32}, "fwd-compute":{"total": 1912.31, "avg": 59.76, "max": 54.14, "min": 65.16, "cnt": 32}, "batch-generator":{"total": 44.08, "avg": 1.38, "max": 0.66, "min": 1.76, "cnt": 32}, "fwd-embedding":{"total": 0.76, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1854.44, "avg": 57.95, "max": 53.18, "min": 64.14, "cnt": 32}, "fwd-layernorm":{"total": 10.75, "avg": 0.08, "max": 0.05, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 114.89, "avg": 0.90, "max": 0.75, "min": 2.00, "cnt": 128}, "fwd-misc":{"total": 22.68, "avg": 0.18, "max": 0.11, "min": 0.45, "cnt": 128}, "fwd-MLP":{"total": 1683.94, "avg": 13.16, "max": 10.38, "min": 19.15, "cnt": 128}, "MoE_L0_fwd":{"total": 496.05, "avg": 15.50, "max": 13.27, "min": 19.07, "cnt": 32}, "MoEMLP":{"total": 1666.05, "avg": 13.02, "max": 10.26, "min": 19.03, "cnt": 128}, "MoE_L1_fwd":{"total": 363.85, "avg": 11.37, "max": 10.30, "min": 13.70, "cnt": 32}, "MoE_L2_fwd":{"total": 412.96, "avg": 12.91, "max": 12.35, "min": 15.24, "cnt": 32}, "MoE_L3_fwd":{"total": 399.72, "avg": 12.49, "max": 11.12, "min": 18.43, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.58, "avg": 0.79, "max": 0.78, "min": 0.80, "cnt": 2}, "forward-send-backward-recv":{"total": 1877.36, "avg": 62.58, "max": 1.42, "min": 309.71, "cnt": 30}, "backward-compute":{"total": 1806.82, "avg": 56.46, "max": 54.99, "min": 58.38, "cnt": 32}, "MoE_L3_bwd":{"total": 451.74, "avg": 14.12, "max": 12.61, "min": 15.71, "cnt": 32}, "MoE_L2_bwd":{"total": 433.45, "avg": 13.55, "max": 13.03, "min": 14.04, "cnt": 32}, "MoE_L1_bwd":{"total": 311.47, "avg": 9.73, "max": 9.15, "min": 11.96, "cnt": 32}, "MoE_L0_bwd":{"total": 396.38, "avg": 12.39, "max": 11.87, "min": 12.94, "cnt": 32}, "backward-send-forward-recv":{"total": 2078.52, "avg": 71.67, "max": 2.05, "min": 696.99, "cnt": 29}, "backward-send":{"total": 3.31, "avg": 1.10, "max": 1.09, "min": 1.12, "cnt": 3}, "backward-recv":{"total": 191.06, "avg": 95.53, "max": 67.09, "min": 123.97, "cnt": 2}, "backward-params-all-reduce":{"total": 483.54, "avg": 483.54, "max": 483.54, "min": 483.54, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 262.69, "avg": 262.69, "max": 262.69, "min": 262.69, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 222.92, "avg": 222.92, "max": 222.92, "min": 222.92, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.31, "avg": 3.31, "max": 3.31, "min": 3.31, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}}}
{"type":"time", "iteration": 111, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 65.43, "avg": 21.81, "max": 2.33, "min": 60.13, "cnt": 3}, "forward-compute":{"total": 1869.88, "avg": 58.43, "max": 53.40, "min": 63.71, "cnt": 32}, "fwd-compute":{"total": 1866.78, "avg": 58.34, "max": 53.31, "min": 63.62, "cnt": 32}, "batch-generator":{"total": 41.11, "avg": 1.28, "max": 0.68, "min": 2.74, "cnt": 32}, "fwd-embedding":{"total": 0.67, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1813.14, "avg": 56.66, "max": 52.04, "min": 61.08, "cnt": 32}, "fwd-layernorm":{"total": 9.88, "avg": 0.08, "max": 0.06, "min": 0.23, "cnt": 128}, "fwd-attn":{"total": 111.02, "avg": 0.87, "max": 0.75, "min": 2.05, "cnt": 128}, "fwd-misc":{"total": 21.03, "avg": 0.16, "max": 0.11, "min": 0.63, "cnt": 128}, "fwd-MLP":{"total": 1650.44, "avg": 12.89, "max": 9.94, "min": 19.46, "cnt": 128}, "MoE_L0_fwd":{"total": 478.26, "avg": 14.95, "max": 11.94, "min": 19.37, "cnt": 32}, "MoEMLP":{"total": 1633.44, "avg": 12.76, "max": 9.82, "min": 19.33, "cnt": 128}, "MoE_L1_fwd":{"total": 363.17, "avg": 11.35, "max": 9.86, "min": 13.56, "cnt": 32}, "MoE_L2_fwd":{"total": 415.14, "avg": 12.97, "max": 12.37, "min": 15.67, "cnt": 32}, "MoE_L3_fwd":{"total": 383.07, "avg": 11.97, "max": 11.31, "min": 13.73, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.69, "avg": 0.84, "max": 0.80, "min": 0.89, "cnt": 2}, "forward-send-backward-recv":{"total": 191.96, "avg": 6.40, "max": 1.65, "min": 122.50, "cnt": 30}, "backward-compute":{"total": 1803.43, "avg": 56.36, "max": 55.52, "min": 58.74, "cnt": 32}, "MoE_L3_bwd":{"total": 442.32, "avg": 13.82, "max": 12.92, "min": 14.93, "cnt": 32}, "MoE_L2_bwd":{"total": 441.39, "avg": 13.79, "max": 13.00, "min": 15.21, "cnt": 32}, "MoE_L1_bwd":{"total": 314.37, "avg": 9.82, "max": 8.95, "min": 10.99, "cnt": 32}, "MoE_L0_bwd":{"total": 392.45, "avg": 12.26, "max": 11.75, "min": 12.65, "cnt": 32}, "backward-send-forward-recv":{"total": 2426.09, "avg": 83.66, "max": 2.10, "min": 290.96, "cnt": 29}, "backward-send":{"total": 3.12, "avg": 1.04, "max": 0.94, "min": 1.13, "cnt": 3}, "backward-recv":{"total": 119.67, "avg": 59.83, "max": 53.66, "min": 66.01, "cnt": 2}, "backward-params-all-reduce":{"total": 486.39, "avg": 486.39, "max": 486.39, "min": 486.39, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 259.73, "avg": 259.73, "max": 259.73, "min": 259.73, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 219.89, "avg": 219.89, "max": 219.89, "min": 219.89, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.29, "avg": 3.29, "max": 3.29, "min": 3.29, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 112, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.06, "avg": 0.06, "max": 0.06, "min": 0.06, "cnt": 1}, "forward-recv":{"total": 71.29, "avg": 23.76, "max": 3.15, "min": 57.88, "cnt": 3}, "forward-compute":{"total": 1941.43, "avg": 60.67, "max": 53.30, "min": 119.77, "cnt": 32}, "fwd-compute":{"total": 1938.48, "avg": 60.58, "max": 53.23, "min": 119.64, "cnt": 32}, "batch-generator":{"total": 40.67, "avg": 1.27, "max": 0.70, "min": 3.53, "cnt": 32}, "fwd-embedding":{"total": 0.58, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1886.19, "avg": 58.94, "max": 52.23, "min": 117.58, "cnt": 32}, "fwd-layernorm":{"total": 9.06, "avg": 0.07, "max": 0.06, "min": 0.17, "cnt": 128}, "fwd-attn":{"total": 105.87, "avg": 0.83, "max": 0.75, "min": 1.47, "cnt": 128}, "fwd-misc":{"total": 19.39, "avg": 0.15, "max": 0.11, "min": 0.33, "cnt": 128}, "fwd-MLP":{"total": 1732.06, "avg": 13.53, "max": 10.33, "min": 74.76, "cnt": 128}, "MoE_L0_fwd":{"total": 547.69, "avg": 17.12, "max": 12.11, "min": 74.62, "cnt": 32}, "MoEMLP":{"total": 1716.14, "avg": 13.41, "max": 10.22, "min": 74.54, "cnt": 128}, "MoE_L1_fwd":{"total": 369.11, "avg": 11.53, "max": 10.26, "min": 15.98, "cnt": 32}, "MoE_L2_fwd":{"total": 426.04, "avg": 13.31, "max": 12.34, "min": 15.39, "cnt": 32}, "MoE_L3_fwd":{"total": 379.12, "avg": 11.85, "max": 10.87, "min": 14.60, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.40, "avg": 0.70, "max": 0.66, "min": 0.74, "cnt": 2}, "forward-send-backward-recv":{"total": 464.14, "avg": 15.47, "max": 1.36, "min": 166.90, "cnt": 30}, "backward-compute":{"total": 1797.52, "avg": 56.17, "max": 53.25, "min": 58.37, "cnt": 32}, "MoE_L3_bwd":{"total": 425.49, "avg": 13.30, "max": 11.99, "min": 14.90, "cnt": 32}, "MoE_L2_bwd":{"total": 445.24, "avg": 13.91, "max": 13.18, "min": 15.29, "cnt": 32}, "MoE_L1_bwd":{"total": 315.26, "avg": 9.85, "max": 9.40, "min": 10.28, "cnt": 32}, "MoE_L0_bwd":{"total": 397.67, "avg": 12.43, "max": 11.72, "min": 13.78, "cnt": 32}, "backward-send-forward-recv":{"total": 2951.68, "avg": 101.78, "max": 2.33, "min": 686.41, "cnt": 29}, "backward-send":{"total": 3.11, "avg": 1.04, "max": 0.98, "min": 1.11, "cnt": 3}, "backward-recv":{"total": 140.37, "avg": 70.18, "max": 69.24, "min": 71.12, "cnt": 2}, "backward-params-all-reduce":{"total": 482.62, "avg": 482.62, "max": 482.62, "min": 482.62, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 261.32, "avg": 261.32, "max": 261.32, "min": 261.32, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.36, "avg": 3.36, "max": 3.36, "min": 3.36, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 221.67, "avg": 221.67, "max": 221.67, "min": 221.67, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.28, "avg": 3.28, "max": 3.28, "min": 3.28, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 113, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 2755.21, "avg": 918.40, "max": 0.86, "min": 2753.40, "cnt": 3}, "forward-compute":{"total": 1904.07, "avg": 59.50, "max": 53.27, "min": 64.81, "cnt": 32}, "fwd-compute":{"total": 1900.97, "avg": 59.41, "max": 53.20, "min": 64.66, "cnt": 32}, "batch-generator":{"total": 46.72, "avg": 1.46, "max": 0.68, "min": 3.50, "cnt": 32}, "fwd-embedding":{"total": 0.61, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1842.13, "avg": 57.57, "max": 51.56, "min": 63.45, "cnt": 32}, "fwd-layernorm":{"total": 9.50, "avg": 0.07, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 106.56, "avg": 0.83, "max": 0.75, "min": 1.49, "cnt": 128}, "fwd-misc":{"total": 19.98, "avg": 0.16, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1685.80, "avg": 13.17, "max": 10.68, "min": 22.18, "cnt": 128}, "MoE_L0_fwd":{"total": 500.54, "avg": 15.64, "max": 12.28, "min": 21.99, "cnt": 32}, "MoEMLP":{"total": 1669.25, "avg": 13.04, "max": 10.56, "min": 21.93, "cnt": 128}, "MoE_L1_fwd":{"total": 382.04, "avg": 11.94, "max": 10.60, "min": 15.90, "cnt": 32}, "MoE_L2_fwd":{"total": 414.54, "avg": 12.95, "max": 12.45, "min": 13.76, "cnt": 32}, "MoE_L3_fwd":{"total": 378.14, "avg": 11.82, "max": 11.06, "min": 14.65, "cnt": 32}, "fwd-pooler":{"total": 0.31, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.55, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 8.66, "avg": 4.33, "max": 0.83, "min": 7.82, "cnt": 2}, "forward-send-backward-recv":{"total": 2380.15, "avg": 79.34, "max": 1.47, "min": 765.43, "cnt": 30}, "backward-compute":{"total": 1799.45, "avg": 56.23, "max": 54.28, "min": 59.43, "cnt": 32}, "MoE_L3_bwd":{"total": 436.38, "avg": 13.64, "max": 11.97, "min": 16.64, "cnt": 32}, "MoE_L2_bwd":{"total": 445.45, "avg": 13.92, "max": 13.18, "min": 14.94, "cnt": 32}, "MoE_L1_bwd":{"total": 313.07, "avg": 9.78, "max": 9.41, "min": 10.53, "cnt": 32}, "MoE_L0_bwd":{"total": 392.74, "avg": 12.27, "max": 11.42, "min": 12.81, "cnt": 32}, "backward-send-forward-recv":{"total": 2471.77, "avg": 85.23, "max": 1.59, "min": 483.18, "cnt": 29}, "backward-send":{"total": 2.73, "avg": 0.91, "max": 0.63, "min": 1.23, "cnt": 3}, "backward-recv":{"total": 394.43, "avg": 197.22, "max": 74.34, "min": 320.09, "cnt": 2}, "backward-params-all-reduce":{"total": 485.04, "avg": 485.04, "max": 485.04, "min": 485.04, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 260.05, "avg": 260.05, "max": 260.05, "min": 260.05, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 220.27, "avg": 220.27, "max": 220.27, "min": 220.27, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.31, "avg": 3.31, "max": 3.31, "min": 3.31, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 114, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 931.53, "avg": 310.51, "max": 0.89, "min": 929.28, "cnt": 3}, "forward-compute":{"total": 1884.59, "avg": 58.89, "max": 53.20, "min": 64.32, "cnt": 32}, "fwd-compute":{"total": 1881.32, "avg": 58.79, "max": 53.13, "min": 64.22, "cnt": 32}, "batch-generator":{"total": 48.04, "avg": 1.50, "max": 0.68, "min": 4.18, "cnt": 32}, "fwd-embedding":{"total": 0.74, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1819.65, "avg": 56.86, "max": 52.13, "min": 60.94, "cnt": 32}, "fwd-layernorm":{"total": 10.62, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 115.25, "avg": 0.90, "max": 0.75, "min": 2.00, "cnt": 128}, "fwd-misc":{"total": 22.58, "avg": 0.18, "max": 0.11, "min": 0.50, "cnt": 128}, "fwd-MLP":{"total": 1649.33, "avg": 12.89, "max": 10.68, "min": 18.99, "cnt": 128}, "MoE_L0_fwd":{"total": 479.88, "avg": 15.00, "max": 13.05, "min": 18.82, "cnt": 32}, "MoEMLP":{"total": 1631.57, "avg": 12.75, "max": 10.58, "min": 18.73, "cnt": 128}, "MoE_L1_fwd":{"total": 375.43, "avg": 11.73, "max": 10.61, "min": 15.95, "cnt": 32}, "MoE_L2_fwd":{"total": 411.83, "avg": 12.87, "max": 12.36, "min": 14.71, "cnt": 32}, "MoE_L3_fwd":{"total": 370.84, "avg": 11.59, "max": 10.94, "min": 12.52, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 9.06, "avg": 4.53, "max": 0.83, "min": 8.23, "cnt": 2}, "forward-send-backward-recv":{"total": 225.18, "avg": 7.51, "max": 1.38, "min": 142.18, "cnt": 30}, "backward-compute":{"total": 1784.80, "avg": 55.77, "max": 54.01, "min": 57.83, "cnt": 32}, "MoE_L3_bwd":{"total": 414.37, "avg": 12.95, "max": 11.43, "min": 14.95, "cnt": 32}, "MoE_L2_bwd":{"total": 437.39, "avg": 13.67, "max": 13.21, "min": 14.30, "cnt": 32}, "MoE_L1_bwd":{"total": 313.62, "avg": 9.80, "max": 9.45, "min": 10.37, "cnt": 32}, "MoE_L0_bwd":{"total": 404.89, "avg": 12.65, "max": 12.08, "min": 13.04, "cnt": 32}, "backward-send-forward-recv":{"total": 3414.06, "avg": 117.73, "max": 2.47, "min": 489.78, "cnt": 29}, "backward-send":{"total": 2.66, "avg": 0.89, "max": 0.54, "min": 1.12, "cnt": 3}, "backward-recv":{"total": 129.73, "avg": 64.87, "max": 62.47, "min": 67.26, "cnt": 2}, "backward-params-all-reduce":{"total": 482.67, "avg": 482.67, "max": 482.67, "min": 482.67, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 259.68, "avg": 259.68, "max": 259.68, "min": 259.68, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 220.00, "avg": 220.00, "max": 220.00, "min": 220.00, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.25, "avg": 3.25, "max": 3.25, "min": 3.25, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}}}
{"type":"time", "iteration": 115, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 63.31, "avg": 21.10, "max": 0.90, "min": 60.05, "cnt": 3}, "forward-compute":{"total": 1856.75, "avg": 58.02, "max": 52.85, "min": 64.72, "cnt": 32}, "fwd-compute":{"total": 1853.68, "avg": 57.93, "max": 52.78, "min": 64.65, "cnt": 32}, "batch-generator":{"total": 44.62, "avg": 1.39, "max": 0.71, "min": 3.56, "cnt": 32}, "fwd-embedding":{"total": 0.63, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1797.14, "avg": 56.16, "max": 51.27, "min": 63.31, "cnt": 32}, "fwd-layernorm":{"total": 9.53, "avg": 0.07, "max": 0.06, "min": 0.18, "cnt": 128}, "fwd-attn":{"total": 108.70, "avg": 0.85, "max": 0.75, "min": 2.46, "cnt": 128}, "fwd-misc":{"total": 20.31, "avg": 0.16, "max": 0.11, "min": 0.47, "cnt": 128}, "fwd-MLP":{"total": 1638.26, "avg": 12.80, "max": 10.53, "min": 22.57, "cnt": 128}, "MoE_L0_fwd":{"total": 485.01, "avg": 15.16, "max": 12.13, "min": 22.49, "cnt": 32}, "MoEMLP":{"total": 1621.90, "avg": 12.67, "max": 10.42, "min": 22.44, "cnt": 128}, "MoE_L1_fwd":{"total": 361.33, "avg": 11.29, "max": 10.46, "min": 13.14, "cnt": 32}, "MoE_L2_fwd":{"total": 411.64, "avg": 12.86, "max": 12.16, "min": 15.58, "cnt": 32}, "MoE_L3_fwd":{"total": 369.93, "avg": 11.56, "max": 10.57, "min": 17.95, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.56, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 4.51, "avg": 2.26, "max": 0.81, "min": 3.70, "cnt": 2}, "forward-send-backward-recv":{"total": 505.83, "avg": 16.86, "max": 1.32, "min": 156.90, "cnt": 30}, "backward-compute":{"total": 1764.94, "avg": 55.15, "max": 52.76, "min": 58.98, "cnt": 32}, "MoE_L3_bwd":{"total": 409.02, "avg": 12.78, "max": 11.59, "min": 14.27, "cnt": 32}, "MoE_L2_bwd":{"total": 435.28, "avg": 13.60, "max": 12.88, "min": 14.43, "cnt": 32}, "MoE_L1_bwd":{"total": 314.16, "avg": 9.82, "max": 9.20, "min": 12.87, "cnt": 32}, "MoE_L0_bwd":{"total": 394.07, "avg": 12.31, "max": 11.86, "min": 12.78, "cnt": 32}, "backward-send-forward-recv":{"total": 4642.13, "avg": 160.07, "max": 2.28, "min": 1406.27, "cnt": 29}, "backward-send":{"total": 2.79, "avg": 0.93, "max": 0.70, "min": 1.05, "cnt": 3}, "backward-recv":{"total": 137.63, "avg": 68.81, "max": 64.43, "min": 73.19, "cnt": 2}, "backward-params-all-reduce":{"total": 490.05, "avg": 490.05, "max": 490.05, "min": 490.05, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 257.09, "avg": 257.09, "max": 257.09, "min": 257.09, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 217.33, "avg": 217.33, "max": 217.33, "min": 217.33, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.30, "avg": 3.30, "max": 3.30, "min": 3.30, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 116, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 77.23, "avg": 25.74, "max": 7.44, "min": 62.05, "cnt": 3}, "forward-compute":{"total": 1853.00, "avg": 57.91, "max": 52.92, "min": 63.49, "cnt": 32}, "fwd-compute":{"total": 1849.96, "avg": 57.81, "max": 52.86, "min": 63.40, "cnt": 32}, "batch-generator":{"total": 38.22, "avg": 1.19, "max": 0.69, "min": 1.97, "cnt": 32}, "fwd-embedding":{"total": 0.62, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1799.18, "avg": 56.22, "max": 51.84, "min": 62.16, "cnt": 32}, "fwd-layernorm":{"total": 9.48, "avg": 0.07, "max": 0.05, "min": 0.18, "cnt": 128}, "fwd-attn":{"total": 107.29, "avg": 0.84, "max": 0.74, "min": 1.97, "cnt": 128}, "fwd-misc":{"total": 20.27, "avg": 0.16, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1641.80, "avg": 12.83, "max": 10.52, "min": 18.95, "cnt": 128}, "MoE_L0_fwd":{"total": 466.12, "avg": 14.57, "max": 11.93, "min": 18.85, "cnt": 32}, "MoEMLP":{"total": 1625.22, "avg": 12.70, "max": 10.39, "min": 18.80, "cnt": 128}, "MoE_L1_fwd":{"total": 366.16, "avg": 11.44, "max": 10.44, "min": 13.30, "cnt": 32}, "MoE_L2_fwd":{"total": 421.67, "avg": 13.18, "max": 12.54, "min": 14.02, "cnt": 32}, "MoE_L3_fwd":{"total": 377.29, "avg": 11.79, "max": 10.85, "min": 14.64, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.81, "avg": 0.90, "max": 0.85, "min": 0.95, "cnt": 2}, "forward-send-backward-recv":{"total": 1031.25, "avg": 34.38, "max": 1.90, "min": 316.31, "cnt": 30}, "backward-compute":{"total": 1753.79, "avg": 54.81, "max": 53.07, "min": 55.87, "cnt": 32}, "MoE_L3_bwd":{"total": 402.34, "avg": 12.57, "max": 11.79, "min": 13.60, "cnt": 32}, "MoE_L2_bwd":{"total": 439.71, "avg": 13.74, "max": 13.16, "min": 15.11, "cnt": 32}, "MoE_L1_bwd":{"total": 308.13, "avg": 9.63, "max": 9.08, "min": 10.38, "cnt": 32}, "MoE_L0_bwd":{"total": 389.73, "avg": 12.18, "max": 11.59, "min": 13.15, "cnt": 32}, "backward-send-forward-recv":{"total": 1542.78, "avg": 53.20, "max": 2.30, "min": 173.61, "cnt": 29}, "backward-send":{"total": 2.95, "avg": 0.98, "max": 0.70, "min": 1.24, "cnt": 3}, "backward-recv":{"total": 147.95, "avg": 73.97, "max": 72.60, "min": 75.35, "cnt": 2}, "backward-params-all-reduce":{"total": 485.63, "avg": 485.63, "max": 485.63, "min": 485.63, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 256.82, "avg": 256.82, "max": 256.82, "min": 256.82, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 217.11, "avg": 217.11, "max": 217.11, "min": 217.11, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.25, "avg": 3.25, "max": 3.25, "min": 3.25, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 117, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 70.92, "avg": 23.64, "max": 1.11, "min": 68.53, "cnt": 3}, "forward-compute":{"total": 1877.08, "avg": 58.66, "max": 53.79, "min": 64.19, "cnt": 32}, "fwd-compute":{"total": 1873.83, "avg": 58.56, "max": 53.71, "min": 64.10, "cnt": 32}, "batch-generator":{"total": 45.08, "avg": 1.41, "max": 0.63, "min": 2.61, "cnt": 32}, "fwd-embedding":{"total": 0.64, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1815.80, "avg": 56.74, "max": 52.45, "min": 62.63, "cnt": 32}, "fwd-layernorm":{"total": 9.80, "avg": 0.08, "max": 0.05, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 109.02, "avg": 0.85, "max": 0.75, "min": 2.18, "cnt": 128}, "fwd-misc":{"total": 20.65, "avg": 0.16, "max": 0.11, "min": 0.39, "cnt": 128}, "fwd-MLP":{"total": 1655.66, "avg": 12.93, "max": 10.68, "min": 19.55, "cnt": 128}, "MoE_L0_fwd":{"total": 480.46, "avg": 15.01, "max": 11.81, "min": 19.47, "cnt": 32}, "MoEMLP":{"total": 1638.78, "avg": 12.80, "max": 10.56, "min": 19.42, "cnt": 128}, "MoE_L1_fwd":{"total": 365.96, "avg": 11.44, "max": 10.60, "min": 13.13, "cnt": 32}, "MoE_L2_fwd":{"total": 412.92, "avg": 12.90, "max": 12.34, "min": 14.12, "cnt": 32}, "MoE_L3_fwd":{"total": 385.57, "avg": 12.05, "max": 11.07, "min": 15.30, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.75, "avg": 0.88, "max": 0.88, "min": 0.88, "cnt": 2}, "forward-send-backward-recv":{"total": 834.46, "avg": 27.82, "max": 1.78, "min": 231.01, "cnt": 30}, "backward-compute":{"total": 1752.48, "avg": 54.77, "max": 53.23, "min": 58.10, "cnt": 32}, "MoE_L3_bwd":{"total": 406.68, "avg": 12.71, "max": 11.52, "min": 14.54, "cnt": 32}, "MoE_L2_bwd":{"total": 426.63, "avg": 13.33, "max": 12.68, "min": 16.20, "cnt": 32}, "MoE_L1_bwd":{"total": 307.54, "avg": 9.61, "max": 9.26, "min": 9.84, "cnt": 32}, "MoE_L0_bwd":{"total": 394.78, "avg": 12.34, "max": 11.82, "min": 13.19, "cnt": 32}, "backward-send-forward-recv":{"total": 1968.73, "avg": 67.89, "max": 1.62, "min": 311.26, "cnt": 29}, "backward-send":{"total": 2.37, "avg": 0.79, "max": 0.55, "min": 1.12, "cnt": 3}, "backward-recv":{"total": 256.60, "avg": 128.30, "max": 112.86, "min": 143.74, "cnt": 2}, "backward-params-all-reduce":{"total": 483.63, "avg": 483.63, "max": 483.63, "min": 483.63, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 260.12, "avg": 260.12, "max": 260.12, "min": 260.12, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 220.25, "avg": 220.25, "max": 220.25, "min": 220.25, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.30, "avg": 3.30, "max": 3.30, "min": 3.30, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.47, "avg": 3.47, "max": 3.47, "min": 3.47, "cnt": 1}}}
{"type":"time", "iteration": 118, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 60.27, "avg": 20.09, "max": 1.05, "min": 57.95, "cnt": 3}, "forward-compute":{"total": 1876.63, "avg": 58.64, "max": 52.65, "min": 63.59, "cnt": 32}, "fwd-compute":{"total": 1873.54, "avg": 58.55, "max": 52.58, "min": 63.52, "cnt": 32}, "batch-generator":{"total": 50.02, "avg": 1.56, "max": 0.68, "min": 4.42, "cnt": 32}, "fwd-embedding":{"total": 0.69, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1811.20, "avg": 56.60, "max": 51.38, "min": 62.29, "cnt": 32}, "fwd-layernorm":{"total": 10.04, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 111.23, "avg": 0.87, "max": 0.75, "min": 1.71, "cnt": 128}, "fwd-misc":{"total": 21.51, "avg": 0.17, "max": 0.11, "min": 0.39, "cnt": 128}, "fwd-MLP":{"total": 1647.09, "avg": 12.87, "max": 10.69, "min": 19.36, "cnt": 128}, "MoE_L0_fwd":{"total": 477.55, "avg": 14.92, "max": 11.69, "min": 19.28, "cnt": 32}, "MoEMLP":{"total": 1629.50, "avg": 12.73, "max": 10.58, "min": 19.24, "cnt": 128}, "MoE_L1_fwd":{"total": 376.66, "avg": 11.77, "max": 10.78, "min": 14.50, "cnt": 32}, "MoE_L2_fwd":{"total": 411.19, "avg": 12.85, "max": 12.22, "min": 13.94, "cnt": 32}, "MoE_L3_fwd":{"total": 370.45, "avg": 11.58, "max": 10.62, "min": 14.75, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.56, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.57, "avg": 0.79, "max": 0.69, "min": 0.88, "cnt": 2}, "forward-send-backward-recv":{"total": 318.63, "avg": 10.62, "max": 1.58, "min": 138.96, "cnt": 30}, "backward-compute":{"total": 1769.41, "avg": 55.29, "max": 54.00, "min": 57.99, "cnt": 32}, "MoE_L3_bwd":{"total": 403.40, "avg": 12.61, "max": 10.89, "min": 16.38, "cnt": 32}, "MoE_L2_bwd":{"total": 429.39, "avg": 13.42, "max": 12.09, "min": 15.55, "cnt": 32}, "MoE_L1_bwd":{"total": 317.99, "avg": 9.94, "max": 9.45, "min": 10.74, "cnt": 32}, "MoE_L0_bwd":{"total": 404.33, "avg": 12.64, "max": 12.17, "min": 13.28, "cnt": 32}, "backward-send-forward-recv":{"total": 2771.13, "avg": 95.56, "max": 2.21, "min": 555.06, "cnt": 29}, "backward-send":{"total": 2.44, "avg": 0.81, "max": 0.75, "min": 0.90, "cnt": 3}, "backward-recv":{"total": 203.45, "avg": 101.72, "max": 72.46, "min": 130.99, "cnt": 2}, "backward-params-all-reduce":{"total": 487.16, "avg": 487.16, "max": 487.16, "min": 487.16, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 260.50, "avg": 260.50, "max": 260.50, "min": 260.50, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.36, "avg": 3.36, "max": 3.36, "min": 3.36, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 220.66, "avg": 220.66, "max": 220.66, "min": 220.66, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.26, "avg": 3.26, "max": 3.26, "min": 3.26, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 119, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 67.03, "avg": 22.34, "max": 1.13, "min": 59.45, "cnt": 3}, "forward-compute":{"total": 1892.25, "avg": 59.13, "max": 53.19, "min": 64.14, "cnt": 32}, "fwd-compute":{"total": 1889.16, "avg": 59.04, "max": 53.12, "min": 64.05, "cnt": 32}, "batch-generator":{"total": 37.40, "avg": 1.17, "max": 0.64, "min": 2.11, "cnt": 32}, "fwd-embedding":{"total": 0.60, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1839.53, "avg": 57.49, "max": 52.05, "min": 62.93, "cnt": 32}, "fwd-layernorm":{"total": 9.85, "avg": 0.08, "max": 0.05, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 108.78, "avg": 0.85, "max": 0.74, "min": 2.41, "cnt": 128}, "fwd-misc":{"total": 20.84, "avg": 0.16, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1679.28, "avg": 13.12, "max": 10.76, "min": 20.66, "cnt": 128}, "MoE_L0_fwd":{"total": 497.43, "avg": 15.54, "max": 12.64, "min": 20.58, "cnt": 32}, "MoEMLP":{"total": 1662.25, "avg": 12.99, "max": 10.66, "min": 20.54, "cnt": 128}, "MoE_L1_fwd":{"total": 382.01, "avg": 11.94, "max": 10.87, "min": 14.63, "cnt": 32}, "MoE_L2_fwd":{"total": 422.14, "avg": 13.19, "max": 12.33, "min": 16.58, "cnt": 32}, "MoE_L3_fwd":{"total": 366.86, "avg": 11.46, "max": 10.70, "min": 13.64, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.57, "avg": 0.79, "max": 0.75, "min": 0.82, "cnt": 2}, "forward-send-backward-recv":{"total": 1013.21, "avg": 33.77, "max": 1.40, "min": 283.32, "cnt": 30}, "backward-compute":{"total": 1780.31, "avg": 55.63, "max": 52.44, "min": 57.67, "cnt": 32}, "MoE_L3_bwd":{"total": 405.17, "avg": 12.66, "max": 11.34, "min": 14.71, "cnt": 32}, "MoE_L2_bwd":{"total": 440.14, "avg": 13.75, "max": 13.07, "min": 14.83, "cnt": 32}, "MoE_L1_bwd":{"total": 319.02, "avg": 9.97, "max": 9.46, "min": 11.97, "cnt": 32}, "MoE_L0_bwd":{"total": 402.25, "avg": 12.57, "max": 11.93, "min": 12.98, "cnt": 32}, "backward-send-forward-recv":{"total": 2632.70, "avg": 90.78, "max": 1.90, "min": 505.62, "cnt": 29}, "backward-send":{"total": 3.40, "avg": 1.13, "max": 1.11, "min": 1.15, "cnt": 3}, "backward-recv":{"total": 306.52, "avg": 153.26, "max": 74.11, "min": 232.41, "cnt": 2}, "backward-params-all-reduce":{"total": 487.10, "avg": 487.10, "max": 487.10, "min": 487.10, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 259.19, "avg": 259.19, "max": 259.19, "min": 259.19, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 219.29, "avg": 219.29, "max": 219.29, "min": 219.29, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.28, "avg": 3.28, "max": 3.28, "min": 3.28, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 120, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 68.22, "avg": 22.74, "max": 1.14, "min": 64.85, "cnt": 3}, "forward-compute":{"total": 1961.03, "avg": 61.28, "max": 54.22, "min": 119.34, "cnt": 32}, "fwd-compute":{"total": 1957.73, "avg": 61.18, "max": 54.16, "min": 119.22, "cnt": 32}, "batch-generator":{"total": 40.41, "avg": 1.26, "max": 0.70, "min": 2.10, "cnt": 32}, "fwd-embedding":{"total": 0.60, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1903.53, "avg": 59.49, "max": 53.16, "min": 116.60, "cnt": 32}, "fwd-layernorm":{"total": 9.94, "avg": 0.08, "max": 0.06, "min": 0.23, "cnt": 128}, "fwd-attn":{"total": 117.80, "avg": 0.92, "max": 0.74, "min": 8.46, "cnt": 128}, "fwd-misc":{"total": 21.17, "avg": 0.17, "max": 0.11, "min": 0.42, "cnt": 128}, "fwd-MLP":{"total": 1732.90, "avg": 13.54, "max": 11.07, "min": 67.15, "cnt": 128}, "MoE_L0_fwd":{"total": 529.02, "avg": 16.53, "max": 12.34, "min": 67.00, "cnt": 32}, "MoEMLP":{"total": 1715.84, "avg": 13.41, "max": 10.96, "min": 66.92, "cnt": 128}, "MoE_L1_fwd":{"total": 381.38, "avg": 11.92, "max": 11.00, "min": 14.19, "cnt": 32}, "MoE_L2_fwd":{"total": 424.10, "avg": 13.25, "max": 12.64, "min": 14.71, "cnt": 32}, "MoE_L3_fwd":{"total": 387.56, "avg": 12.11, "max": 11.20, "min": 13.70, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.39, "avg": 0.70, "max": 0.50, "min": 0.89, "cnt": 2}, "forward-send-backward-recv":{"total": 198.17, "avg": 6.61, "max": 1.14, "min": 126.99, "cnt": 30}, "backward-compute":{"total": 1804.18, "avg": 56.38, "max": 54.63, "min": 59.99, "cnt": 32}, "MoE_L3_bwd":{"total": 411.48, "avg": 12.86, "max": 11.53, "min": 15.71, "cnt": 32}, "MoE_L2_bwd":{"total": 441.57, "avg": 13.80, "max": 13.11, "min": 14.83, "cnt": 32}, "MoE_L1_bwd":{"total": 322.67, "avg": 10.08, "max": 9.44, "min": 10.45, "cnt": 32}, "MoE_L0_bwd":{"total": 411.53, "avg": 12.86, "max": 12.19, "min": 13.34, "cnt": 32}, "backward-send-forward-recv":{"total": 2193.27, "avg": 75.63, "max": 2.52, "min": 350.90, "cnt": 29}, "backward-send":{"total": 2.98, "avg": 0.99, "max": 0.90, "min": 1.06, "cnt": 3}, "backward-recv":{"total": 129.74, "avg": 64.87, "max": 63.45, "min": 66.28, "cnt": 2}, "backward-params-all-reduce":{"total": 489.62, "avg": 489.62, "max": 489.62, "min": 489.62, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 260.87, "avg": 260.87, "max": 260.87, "min": 260.87, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 221.04, "avg": 221.04, "max": 221.04, "min": 221.04, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.27, "avg": 3.27, "max": 3.27, "min": 3.27, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 121, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 62.76, "avg": 20.92, "max": 2.02, "min": 58.04, "cnt": 3}, "forward-compute":{"total": 1891.14, "avg": 59.10, "max": 53.07, "min": 65.53, "cnt": 32}, "fwd-compute":{"total": 1888.04, "avg": 59.00, "max": 53.00, "min": 65.44, "cnt": 32}, "batch-generator":{"total": 42.64, "avg": 1.33, "max": 0.70, "min": 2.83, "cnt": 32}, "fwd-embedding":{"total": 0.61, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1832.65, "avg": 57.27, "max": 52.00, "min": 64.29, "cnt": 32}, "fwd-layernorm":{"total": 9.78, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 108.38, "avg": 0.85, "max": 0.74, "min": 1.48, "cnt": 128}, "fwd-misc":{"total": 21.13, "avg": 0.17, "max": 0.11, "min": 0.39, "cnt": 128}, "fwd-MLP":{"total": 1672.28, "avg": 13.06, "max": 11.05, "min": 19.41, "cnt": 128}, "MoE_L0_fwd":{"total": 468.62, "avg": 14.64, "max": 12.50, "min": 19.33, "cnt": 32}, "MoEMLP":{"total": 1655.47, "avg": 12.93, "max": 10.95, "min": 19.28, "cnt": 128}, "MoE_L1_fwd":{"total": 386.44, "avg": 12.08, "max": 10.99, "min": 16.23, "cnt": 32}, "MoE_L2_fwd":{"total": 418.99, "avg": 13.09, "max": 12.42, "min": 14.01, "cnt": 32}, "MoE_L3_fwd":{"total": 387.51, "avg": 12.11, "max": 11.09, "min": 17.49, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.84, "avg": 0.92, "max": 0.83, "min": 1.01, "cnt": 2}, "forward-send-backward-recv":{"total": 244.38, "avg": 8.15, "max": 1.43, "min": 139.14, "cnt": 30}, "backward-compute":{"total": 1819.95, "avg": 56.87, "max": 54.96, "min": 59.63, "cnt": 32}, "MoE_L3_bwd":{"total": 412.34, "avg": 12.89, "max": 11.88, "min": 14.24, "cnt": 32}, "MoE_L2_bwd":{"total": 437.64, "avg": 13.68, "max": 12.49, "min": 15.16, "cnt": 32}, "MoE_L1_bwd":{"total": 328.82, "avg": 10.28, "max": 9.82, "min": 10.74, "cnt": 32}, "MoE_L0_bwd":{"total": 426.37, "avg": 13.32, "max": 12.45, "min": 16.30, "cnt": 32}, "backward-send-forward-recv":{"total": 2362.28, "avg": 81.46, "max": 2.49, "min": 384.22, "cnt": 29}, "backward-send":{"total": 2.71, "avg": 0.90, "max": 0.78, "min": 1.14, "cnt": 3}, "backward-recv":{"total": 137.91, "avg": 68.96, "max": 66.99, "min": 70.93, "cnt": 2}, "backward-params-all-reduce":{"total": 485.18, "avg": 485.18, "max": 485.18, "min": 485.18, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 261.60, "avg": 261.60, "max": 261.60, "min": 261.60, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 221.71, "avg": 221.71, "max": 221.71, "min": 221.71, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.30, "avg": 3.30, "max": 3.30, "min": 3.30, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 122, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 64.31, "avg": 21.44, "max": 1.09, "min": 61.50, "cnt": 3}, "forward-compute":{"total": 1918.29, "avg": 59.95, "max": 53.65, "min": 65.04, "cnt": 32}, "fwd-compute":{"total": 1915.28, "avg": 59.85, "max": 53.57, "min": 64.95, "cnt": 32}, "batch-generator":{"total": 37.88, "avg": 1.18, "max": 0.69, "min": 2.45, "cnt": 32}, "fwd-embedding":{"total": 0.57, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1864.92, "avg": 58.28, "max": 52.55, "min": 63.58, "cnt": 32}, "fwd-layernorm":{"total": 9.32, "avg": 0.07, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 106.65, "avg": 0.83, "max": 0.74, "min": 2.30, "cnt": 128}, "fwd-misc":{"total": 20.05, "avg": 0.16, "max": 0.11, "min": 0.34, "cnt": 128}, "fwd-MLP":{"total": 1708.62, "avg": 13.35, "max": 11.22, "min": 21.41, "cnt": 128}, "MoE_L0_fwd":{"total": 495.39, "avg": 15.48, "max": 12.11, "min": 21.32, "cnt": 32}, "MoEMLP":{"total": 1692.31, "avg": 13.22, "max": 11.11, "min": 21.27, "cnt": 128}, "MoE_L1_fwd":{"total": 392.59, "avg": 12.27, "max": 11.15, "min": 14.01, "cnt": 32}, "MoE_L2_fwd":{"total": 422.76, "avg": 13.21, "max": 12.18, "min": 16.02, "cnt": 32}, "MoE_L3_fwd":{"total": 387.55, "avg": 12.11, "max": 11.36, "min": 13.22, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.75, "avg": 0.88, "max": 0.87, "min": 0.88, "cnt": 2}, "forward-send-backward-recv":{"total": 209.50, "avg": 6.98, "max": 1.81, "min": 125.60, "cnt": 30}, "backward-compute":{"total": 1817.75, "avg": 56.80, "max": 54.07, "min": 58.37, "cnt": 32}, "MoE_L3_bwd":{"total": 419.51, "avg": 13.11, "max": 11.91, "min": 14.29, "cnt": 32}, "MoE_L2_bwd":{"total": 428.46, "avg": 13.39, "max": 12.64, "min": 14.29, "cnt": 32}, "MoE_L1_bwd":{"total": 333.70, "avg": 10.43, "max": 9.97, "min": 11.06, "cnt": 32}, "MoE_L0_bwd":{"total": 420.81, "avg": 13.15, "max": 12.64, "min": 13.87, "cnt": 32}, "backward-send-forward-recv":{"total": 2587.60, "avg": 89.23, "max": 2.12, "min": 302.33, "cnt": 29}, "backward-send":{"total": 3.03, "avg": 1.01, "max": 0.89, "min": 1.11, "cnt": 3}, "backward-recv":{"total": 133.74, "avg": 66.87, "max": 65.29, "min": 68.45, "cnt": 2}, "backward-params-all-reduce":{"total": 484.68, "avg": 484.68, "max": 484.68, "min": 484.68, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 263.98, "avg": 263.98, "max": 263.98, "min": 263.98, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 224.07, "avg": 224.07, "max": 224.07, "min": 224.07, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.32, "avg": 3.32, "max": 3.32, "min": 3.32, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.47, "avg": 3.47, "max": 3.47, "min": 3.47, "cnt": 1}}}
{"type":"time", "iteration": 123, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.06, "avg": 0.06, "max": 0.06, "min": 0.06, "cnt": 1}, "forward-recv":{"total": 62.48, "avg": 20.83, "max": 1.11, "min": 58.93, "cnt": 3}, "forward-compute":{"total": 1948.79, "avg": 60.90, "max": 54.12, "min": 70.68, "cnt": 32}, "fwd-compute":{"total": 1945.46, "avg": 60.80, "max": 54.06, "min": 70.60, "cnt": 32}, "batch-generator":{"total": 42.75, "avg": 1.34, "max": 0.66, "min": 2.79, "cnt": 32}, "fwd-embedding":{"total": 0.68, "avg": 0.02, "max": 0.01, "min": 0.06, "cnt": 32}, "fwd-encoder":{"total": 1889.52, "avg": 59.05, "max": 53.06, "min": 68.56, "cnt": 32}, "fwd-layernorm":{"total": 10.11, "avg": 0.08, "max": 0.06, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 111.48, "avg": 0.87, "max": 0.74, "min": 1.89, "cnt": 128}, "fwd-misc":{"total": 20.87, "avg": 0.16, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1725.71, "avg": 13.48, "max": 11.40, "min": 25.40, "cnt": 128}, "MoE_L0_fwd":{"total": 501.60, "avg": 15.68, "max": 12.36, "min": 25.32, "cnt": 32}, "MoEMLP":{"total": 1708.54, "avg": 13.35, "max": 11.28, "min": 25.26, "cnt": 128}, "MoE_L1_fwd":{"total": 392.62, "avg": 12.27, "max": 11.33, "min": 13.84, "cnt": 32}, "MoE_L2_fwd":{"total": 423.50, "avg": 13.23, "max": 12.63, "min": 16.10, "cnt": 32}, "MoE_L3_fwd":{"total": 397.06, "avg": 12.41, "max": 11.46, "min": 16.18, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.80, "avg": 0.90, "max": 0.90, "min": 0.90, "cnt": 2}, "forward-send-backward-recv":{"total": 223.50, "avg": 7.45, "max": 1.33, "min": 139.28, "cnt": 30}, "backward-compute":{"total": 1854.19, "avg": 57.94, "max": 56.23, "min": 60.49, "cnt": 32}, "MoE_L3_bwd":{"total": 435.71, "avg": 13.62, "max": 12.62, "min": 15.85, "cnt": 32}, "MoE_L2_bwd":{"total": 439.82, "avg": 13.74, "max": 12.92, "min": 15.01, "cnt": 32}, "MoE_L1_bwd":{"total": 341.18, "avg": 10.66, "max": 10.07, "min": 11.35, "cnt": 32}, "MoE_L0_bwd":{"total": 424.08, "avg": 13.25, "max": 12.59, "min": 14.84, "cnt": 32}, "backward-send-forward-recv":{"total": 2581.44, "avg": 89.02, "max": 2.23, "min": 585.28, "cnt": 29}, "backward-send":{"total": 3.22, "avg": 1.07, "max": 1.00, "min": 1.13, "cnt": 3}, "backward-recv":{"total": 124.33, "avg": 62.17, "max": 57.07, "min": 67.27, "cnt": 2}, "backward-params-all-reduce":{"total": 487.30, "avg": 487.30, "max": 487.30, "min": 487.30, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 262.45, "avg": 262.45, "max": 262.45, "min": 262.45, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 222.68, "avg": 222.68, "max": 222.68, "min": 222.68, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.31, "avg": 3.31, "max": 3.31, "min": 3.31, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 124, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 69.01, "avg": 23.00, "max": 1.90, "min": 59.34, "cnt": 3}, "forward-compute":{"total": 1970.60, "avg": 61.58, "max": 54.83, "min": 69.81, "cnt": 32}, "fwd-compute":{"total": 1967.36, "avg": 61.48, "max": 54.76, "min": 69.68, "cnt": 32}, "batch-generator":{"total": 48.40, "avg": 1.51, "max": 0.68, "min": 4.58, "cnt": 32}, "fwd-embedding":{"total": 0.64, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1906.39, "avg": 59.57, "max": 53.74, "min": 67.59, "cnt": 32}, "fwd-layernorm":{"total": 9.78, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 109.94, "avg": 0.86, "max": 0.74, "min": 1.63, "cnt": 128}, "fwd-misc":{"total": 20.68, "avg": 0.16, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1745.10, "avg": 13.63, "max": 11.34, "min": 22.42, "cnt": 128}, "MoE_L0_fwd":{"total": 514.26, "avg": 16.07, "max": 12.35, "min": 22.32, "cnt": 32}, "MoEMLP":{"total": 1728.46, "avg": 13.50, "max": 11.22, "min": 22.27, "cnt": 128}, "MoE_L1_fwd":{"total": 409.43, "avg": 12.79, "max": 11.26, "min": 18.19, "cnt": 32}, "MoE_L2_fwd":{"total": 422.88, "avg": 13.21, "max": 12.63, "min": 14.15, "cnt": 32}, "MoE_L3_fwd":{"total": 388.01, "avg": 12.13, "max": 11.60, "min": 13.33, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.04, "cnt": 32}, "forward-send":{"total": 1.77, "avg": 0.89, "max": 0.85, "min": 0.92, "cnt": 2}, "forward-send-backward-recv":{"total": 191.88, "avg": 6.40, "max": 1.60, "min": 116.53, "cnt": 30}, "backward-compute":{"total": 1853.35, "avg": 57.92, "max": 56.67, "min": 59.90, "cnt": 32}, "MoE_L3_bwd":{"total": 431.73, "avg": 13.49, "max": 12.82, "min": 14.86, "cnt": 32}, "MoE_L2_bwd":{"total": 438.62, "avg": 13.71, "max": 12.83, "min": 15.20, "cnt": 32}, "MoE_L1_bwd":{"total": 347.22, "avg": 10.85, "max": 10.28, "min": 12.52, "cnt": 32}, "MoE_L0_bwd":{"total": 421.27, "avg": 13.16, "max": 12.78, "min": 13.50, "cnt": 32}, "backward-send-forward-recv":{"total": 3075.65, "avg": 106.06, "max": 2.32, "min": 433.35, "cnt": 29}, "backward-send":{"total": 3.16, "avg": 1.05, "max": 0.97, "min": 1.11, "cnt": 3}, "backward-recv":{"total": 142.74, "avg": 71.37, "max": 70.86, "min": 71.87, "cnt": 2}, "backward-params-all-reduce":{"total": 559.42, "avg": 559.42, "max": 559.42, "min": 559.42, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 260.00, "avg": 260.00, "max": 260.00, "min": 260.00, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 220.17, "avg": 220.17, "max": 220.17, "min": 220.17, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.31, "avg": 3.31, "max": 3.31, "min": 3.31, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 125, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.10, "avg": 0.10, "max": 0.10, "min": 0.10, "cnt": 1}, "forward-recv":{"total": 62.69, "avg": 20.90, "max": 0.95, "min": 60.69, "cnt": 3}, "forward-compute":{"total": 1985.21, "avg": 62.04, "max": 56.81, "min": 73.01, "cnt": 32}, "fwd-compute":{"total": 1982.13, "avg": 61.94, "max": 56.71, "min": 72.88, "cnt": 32}, "batch-generator":{"total": 45.29, "avg": 1.42, "max": 0.68, "min": 3.26, "cnt": 32}, "fwd-embedding":{"total": 0.64, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1924.07, "avg": 60.13, "max": 55.20, "min": 70.76, "cnt": 32}, "fwd-layernorm":{"total": 10.14, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 111.24, "avg": 0.87, "max": 0.74, "min": 2.11, "cnt": 128}, "fwd-misc":{"total": 21.40, "avg": 0.17, "max": 0.11, "min": 0.34, "cnt": 128}, "fwd-MLP":{"total": 1759.81, "avg": 13.75, "max": 11.42, "min": 19.70, "cnt": 128}, "MoE_L0_fwd":{"total": 507.31, "avg": 15.85, "max": 12.68, "min": 19.60, "cnt": 32}, "MoEMLP":{"total": 1742.37, "avg": 13.61, "max": 11.29, "min": 19.54, "cnt": 128}, "MoE_L1_fwd":{"total": 404.77, "avg": 12.65, "max": 11.34, "min": 16.98, "cnt": 32}, "MoE_L2_fwd":{"total": 435.30, "avg": 13.60, "max": 12.89, "min": 17.23, "cnt": 32}, "MoE_L3_fwd":{"total": 401.27, "avg": 12.54, "max": 11.46, "min": 18.65, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.56, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 3.86, "avg": 1.93, "max": 0.90, "min": 2.95, "cnt": 2}, "forward-send-backward-recv":{"total": 1004.83, "avg": 33.49, "max": 1.87, "min": 253.41, "cnt": 30}, "backward-compute":{"total": 1849.08, "avg": 57.78, "max": 55.83, "min": 59.86, "cnt": 32}, "MoE_L3_bwd":{"total": 429.84, "avg": 13.43, "max": 12.36, "min": 14.94, "cnt": 32}, "MoE_L2_bwd":{"total": 443.96, "avg": 13.87, "max": 13.45, "min": 16.34, "cnt": 32}, "MoE_L1_bwd":{"total": 336.46, "avg": 10.51, "max": 9.84, "min": 11.24, "cnt": 32}, "MoE_L0_bwd":{"total": 426.58, "avg": 13.33, "max": 12.74, "min": 14.09, "cnt": 32}, "backward-send-forward-recv":{"total": 3346.41, "avg": 115.39, "max": 1.82, "min": 703.62, "cnt": 29}, "backward-send":{"total": 3.26, "avg": 1.09, "max": 0.86, "min": 1.35, "cnt": 3}, "backward-recv":{"total": 136.56, "avg": 68.28, "max": 65.59, "min": 70.98, "cnt": 2}, "backward-params-all-reduce":{"total": 489.85, "avg": 489.85, "max": 489.85, "min": 489.85, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 256.78, "avg": 256.78, "max": 256.78, "min": 256.78, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 216.84, "avg": 216.84, "max": 216.84, "min": 216.84, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.30, "avg": 3.30, "max": 3.30, "min": 3.30, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 126, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 60.26, "avg": 20.09, "max": 0.99, "min": 57.92, "cnt": 3}, "forward-compute":{"total": 1997.22, "avg": 62.41, "max": 53.88, "min": 114.40, "cnt": 32}, "fwd-compute":{"total": 1993.98, "avg": 62.31, "max": 53.81, "min": 114.33, "cnt": 32}, "batch-generator":{"total": 46.10, "avg": 1.44, "max": 0.68, "min": 4.38, "cnt": 32}, "fwd-embedding":{"total": 0.68, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1935.36, "avg": 60.48, "max": 52.83, "min": 113.16, "cnt": 32}, "fwd-layernorm":{"total": 10.16, "avg": 0.08, "max": 0.06, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 109.60, "avg": 0.86, "max": 0.74, "min": 1.88, "cnt": 128}, "fwd-misc":{"total": 21.41, "avg": 0.17, "max": 0.11, "min": 0.38, "cnt": 128}, "fwd-MLP":{"total": 1773.07, "avg": 13.85, "max": 11.26, "min": 71.23, "cnt": 128}, "MoE_L0_fwd":{"total": 561.93, "avg": 17.56, "max": 12.62, "min": 71.15, "cnt": 32}, "MoEMLP":{"total": 1755.93, "avg": 13.72, "max": 11.16, "min": 71.11, "cnt": 128}, "MoE_L1_fwd":{"total": 392.81, "avg": 12.28, "max": 11.31, "min": 12.99, "cnt": 32}, "MoE_L2_fwd":{"total": 416.38, "avg": 13.01, "max": 12.39, "min": 14.08, "cnt": 32}, "MoE_L3_fwd":{"total": 391.13, "avg": 12.22, "max": 11.19, "min": 17.23, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.56, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 7.81, "avg": 3.91, "max": 0.90, "min": 6.91, "cnt": 2}, "forward-send-backward-recv":{"total": 969.48, "avg": 32.32, "max": 1.52, "min": 148.06, "cnt": 30}, "backward-compute":{"total": 1854.93, "avg": 57.97, "max": 54.14, "min": 63.34, "cnt": 32}, "MoE_L3_bwd":{"total": 436.50, "avg": 13.64, "max": 12.21, "min": 17.18, "cnt": 32}, "MoE_L2_bwd":{"total": 422.76, "avg": 13.21, "max": 12.63, "min": 13.89, "cnt": 32}, "MoE_L1_bwd":{"total": 343.11, "avg": 10.72, "max": 10.31, "min": 11.31, "cnt": 32}, "MoE_L0_bwd":{"total": 437.65, "avg": 13.68, "max": 12.91, "min": 15.76, "cnt": 32}, "backward-send-forward-recv":{"total": 2051.85, "avg": 70.75, "max": 1.59, "min": 490.66, "cnt": 29}, "backward-send":{"total": 3.32, "avg": 1.11, "max": 1.08, "min": 1.14, "cnt": 3}, "backward-recv":{"total": 407.30, "avg": 203.65, "max": 66.93, "min": 340.38, "cnt": 2}, "backward-params-all-reduce":{"total": 490.34, "avg": 490.34, "max": 490.34, "min": 490.34, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 261.87, "avg": 261.87, "max": 261.87, "min": 261.87, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 217.78, "avg": 217.78, "max": 217.78, "min": 217.78, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.83, "avg": 6.83, "max": 6.83, "min": 6.83, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}}}
{"type":"time", "iteration": 127, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 64.21, "avg": 21.40, "max": 1.02, "min": 61.61, "cnt": 3}, "forward-compute":{"total": 1951.21, "avg": 60.98, "max": 55.39, "min": 65.66, "cnt": 32}, "fwd-compute":{"total": 1947.82, "avg": 60.87, "max": 55.32, "min": 65.57, "cnt": 32}, "batch-generator":{"total": 43.18, "avg": 1.35, "max": 0.72, "min": 2.25, "cnt": 32}, "fwd-embedding":{"total": 0.72, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1891.17, "avg": 59.10, "max": 54.26, "min": 64.41, "cnt": 32}, "fwd-layernorm":{"total": 10.12, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 110.24, "avg": 0.86, "max": 0.74, "min": 1.49, "cnt": 128}, "fwd-misc":{"total": 21.45, "avg": 0.17, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1728.30, "avg": 13.50, "max": 11.53, "min": 20.45, "cnt": 128}, "MoE_L0_fwd":{"total": 494.75, "avg": 15.46, "max": 12.32, "min": 20.36, "cnt": 32}, "MoEMLP":{"total": 1711.13, "avg": 13.37, "max": 11.43, "min": 20.32, "cnt": 128}, "MoE_L1_fwd":{"total": 397.60, "avg": 12.42, "max": 11.50, "min": 13.48, "cnt": 32}, "MoE_L2_fwd":{"total": 437.74, "avg": 13.68, "max": 12.98, "min": 17.86, "cnt": 32}, "MoE_L3_fwd":{"total": 387.33, "avg": 12.10, "max": 11.47, "min": 13.48, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.94, "avg": 0.97, "max": 0.83, "min": 1.11, "cnt": 2}, "forward-send-backward-recv":{"total": 662.38, "avg": 22.08, "max": 1.62, "min": 187.33, "cnt": 30}, "backward-compute":{"total": 1861.83, "avg": 58.18, "max": 56.33, "min": 61.51, "cnt": 32}, "MoE_L3_bwd":{"total": 425.31, "avg": 13.29, "max": 11.94, "min": 16.57, "cnt": 32}, "MoE_L2_bwd":{"total": 447.79, "avg": 13.99, "max": 13.23, "min": 14.93, "cnt": 32}, "MoE_L1_bwd":{"total": 337.10, "avg": 10.53, "max": 9.92, "min": 10.97, "cnt": 32}, "MoE_L0_bwd":{"total": 438.57, "avg": 13.71, "max": 13.30, "min": 14.37, "cnt": 32}, "backward-send-forward-recv":{"total": 937.15, "avg": 32.32, "max": 1.92, "min": 178.74, "cnt": 29}, "backward-send":{"total": 2.67, "avg": 0.89, "max": 0.72, "min": 1.07, "cnt": 3}, "backward-recv":{"total": 772.10, "avg": 386.05, "max": 364.63, "min": 407.47, "cnt": 2}, "backward-params-all-reduce":{"total": 483.88, "avg": 483.88, "max": 483.88, "min": 483.88, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 261.42, "avg": 261.42, "max": 261.42, "min": 261.42, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 221.65, "avg": 221.65, "max": 221.65, "min": 221.65, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.31, "avg": 3.31, "max": 3.31, "min": 3.31, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 128, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 61.08, "avg": 20.36, "max": 0.99, "min": 58.82, "cnt": 3}, "forward-compute":{"total": 1985.17, "avg": 62.04, "max": 54.88, "min": 70.24, "cnt": 32}, "fwd-compute":{"total": 1982.01, "avg": 61.94, "max": 54.80, "min": 70.11, "cnt": 32}, "batch-generator":{"total": 54.72, "avg": 1.71, "max": 0.67, "min": 4.12, "cnt": 32}, "fwd-embedding":{"total": 0.69, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1914.69, "avg": 59.83, "max": 53.70, "min": 67.94, "cnt": 32}, "fwd-layernorm":{"total": 10.04, "avg": 0.08, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 112.49, "avg": 0.88, "max": 0.74, "min": 2.60, "cnt": 128}, "fwd-misc":{"total": 21.43, "avg": 0.17, "max": 0.11, "min": 0.52, "cnt": 128}, "fwd-MLP":{"total": 1749.55, "avg": 13.67, "max": 11.53, "min": 24.16, "cnt": 128}, "MoE_L0_fwd":{"total": 508.30, "avg": 15.88, "max": 13.01, "min": 23.99, "cnt": 32}, "MoEMLP":{"total": 1732.66, "avg": 13.54, "max": 11.40, "min": 23.91, "cnt": 128}, "MoE_L1_fwd":{"total": 404.70, "avg": 12.65, "max": 11.46, "min": 15.00, "cnt": 32}, "MoE_L2_fwd":{"total": 438.05, "avg": 13.69, "max": 12.93, "min": 17.32, "cnt": 32}, "MoE_L3_fwd":{"total": 387.83, "avg": 12.12, "max": 11.50, "min": 13.58, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.75, "avg": 0.87, "max": 0.87, "min": 0.88, "cnt": 2}, "forward-send-backward-recv":{"total": 191.53, "avg": 6.38, "max": 1.47, "min": 123.15, "cnt": 30}, "backward-compute":{"total": 1865.86, "avg": 58.31, "max": 56.37, "min": 60.30, "cnt": 32}, "MoE_L3_bwd":{"total": 425.60, "avg": 13.30, "max": 12.04, "min": 14.47, "cnt": 32}, "MoE_L2_bwd":{"total": 445.87, "avg": 13.93, "max": 13.14, "min": 15.07, "cnt": 32}, "MoE_L1_bwd":{"total": 344.28, "avg": 10.76, "max": 10.22, "min": 11.42, "cnt": 32}, "MoE_L0_bwd":{"total": 437.90, "avg": 13.68, "max": 13.19, "min": 14.12, "cnt": 32}, "backward-send-forward-recv":{"total": 3693.07, "avg": 127.35, "max": 1.76, "min": 501.29, "cnt": 29}, "backward-send":{"total": 3.02, "avg": 1.01, "max": 0.90, "min": 1.06, "cnt": 3}, "backward-recv":{"total": 147.69, "avg": 73.85, "max": 71.59, "min": 76.11, "cnt": 2}, "backward-params-all-reduce":{"total": 488.75, "avg": 488.75, "max": 488.75, "min": 488.75, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 255.98, "avg": 255.98, "max": 255.98, "min": 255.98, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 215.45, "avg": 215.45, "max": 215.45, "min": 215.45, "cnt": 1}, "optimizer-clip-main-grad":{"total": 4.07, "avg": 4.07, "max": 4.07, "min": 4.07, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 129, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 68.41, "avg": 22.80, "max": 1.24, "min": 63.70, "cnt": 3}, "forward-compute":{"total": 1943.65, "avg": 60.74, "max": 55.24, "min": 70.52, "cnt": 32}, "fwd-compute":{"total": 1940.68, "avg": 60.65, "max": 55.17, "min": 70.43, "cnt": 32}, "batch-generator":{"total": 36.66, "avg": 1.15, "max": 0.68, "min": 2.43, "cnt": 32}, "fwd-embedding":{"total": 0.56, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1891.73, "avg": 59.12, "max": 54.18, "min": 68.26, "cnt": 32}, "fwd-layernorm":{"total": 9.11, "avg": 0.07, "max": 0.06, "min": 0.17, "cnt": 128}, "fwd-attn":{"total": 108.03, "avg": 0.84, "max": 0.74, "min": 2.19, "cnt": 128}, "fwd-misc":{"total": 20.53, "avg": 0.16, "max": 0.11, "min": 0.72, "cnt": 128}, "fwd-MLP":{"total": 1733.16, "avg": 13.54, "max": 11.45, "min": 20.48, "cnt": 128}, "MoE_L0_fwd":{"total": 501.85, "avg": 15.68, "max": 12.93, "min": 20.31, "cnt": 32}, "MoEMLP":{"total": 1716.58, "avg": 13.41, "max": 11.34, "min": 20.20, "cnt": 128}, "MoE_L1_fwd":{"total": 401.47, "avg": 12.55, "max": 11.39, "min": 16.31, "cnt": 32}, "MoE_L2_fwd":{"total": 430.51, "avg": 13.45, "max": 12.51, "min": 17.58, "cnt": 32}, "MoE_L3_fwd":{"total": 388.76, "avg": 12.15, "max": 11.38, "min": 13.52, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.89, "avg": 0.95, "max": 0.94, "min": 0.95, "cnt": 2}, "forward-send-backward-recv":{"total": 474.28, "avg": 15.81, "max": 1.33, "min": 122.78, "cnt": 30}, "backward-compute":{"total": 1853.46, "avg": 57.92, "max": 56.23, "min": 59.12, "cnt": 32}, "MoE_L3_bwd":{"total": 425.38, "avg": 13.29, "max": 12.48, "min": 14.82, "cnt": 32}, "MoE_L2_bwd":{"total": 429.99, "avg": 13.44, "max": 12.69, "min": 14.03, "cnt": 32}, "MoE_L1_bwd":{"total": 343.77, "avg": 10.74, "max": 10.16, "min": 11.39, "cnt": 32}, "MoE_L0_bwd":{"total": 440.00, "avg": 13.75, "max": 13.19, "min": 14.18, "cnt": 32}, "backward-send-forward-recv":{"total": 2566.95, "avg": 88.52, "max": 1.82, "min": 579.27, "cnt": 29}, "backward-send":{"total": 3.21, "avg": 1.07, "max": 0.93, "min": 1.19, "cnt": 3}, "backward-recv":{"total": 165.44, "avg": 82.72, "max": 72.42, "min": 93.01, "cnt": 2}, "backward-params-all-reduce":{"total": 486.82, "avg": 486.82, "max": 486.82, "min": 486.82, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 257.83, "avg": 257.83, "max": 257.83, "min": 257.83, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 217.98, "avg": 217.98, "max": 217.98, "min": 217.98, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.31, "avg": 3.31, "max": 3.31, "min": 3.31, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 130, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 69.16, "avg": 23.05, "max": 1.37, "min": 62.63, "cnt": 3}, "forward-compute":{"total": 1940.55, "avg": 60.64, "max": 54.93, "min": 66.30, "cnt": 32}, "fwd-compute":{"total": 1937.21, "avg": 60.54, "max": 54.86, "min": 66.18, "cnt": 32}, "batch-generator":{"total": 44.85, "avg": 1.40, "max": 0.66, "min": 3.57, "cnt": 32}, "fwd-embedding":{"total": 0.70, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1878.70, "avg": 58.71, "max": 53.75, "min": 64.08, "cnt": 32}, "fwd-layernorm":{"total": 10.10, "avg": 0.08, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 109.65, "avg": 0.86, "max": 0.74, "min": 1.52, "cnt": 128}, "fwd-misc":{"total": 20.90, "avg": 0.16, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1716.86, "avg": 13.41, "max": 11.16, "min": 18.88, "cnt": 128}, "MoE_L0_fwd":{"total": 492.83, "avg": 15.40, "max": 12.83, "min": 18.73, "cnt": 32}, "MoEMLP":{"total": 1699.51, "avg": 13.28, "max": 11.06, "min": 18.65, "cnt": 128}, "MoE_L1_fwd":{"total": 391.69, "avg": 12.24, "max": 11.10, "min": 14.78, "cnt": 32}, "MoE_L2_fwd":{"total": 426.87, "avg": 13.34, "max": 12.72, "min": 14.19, "cnt": 32}, "MoE_L3_fwd":{"total": 394.40, "avg": 12.32, "max": 11.31, "min": 16.02, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.94, "avg": 0.97, "max": 0.90, "min": 1.04, "cnt": 2}, "forward-send-backward-recv":{"total": 210.87, "avg": 7.03, "max": 1.53, "min": 123.72, "cnt": 30}, "backward-compute":{"total": 1855.84, "avg": 57.99, "max": 55.32, "min": 63.36, "cnt": 32}, "MoE_L3_bwd":{"total": 426.88, "avg": 13.34, "max": 12.47, "min": 14.58, "cnt": 32}, "MoE_L2_bwd":{"total": 433.59, "avg": 13.55, "max": 12.98, "min": 14.15, "cnt": 32}, "MoE_L1_bwd":{"total": 340.51, "avg": 10.64, "max": 9.97, "min": 13.65, "cnt": 32}, "MoE_L0_bwd":{"total": 441.16, "avg": 13.79, "max": 13.13, "min": 15.32, "cnt": 32}, "backward-send-forward-recv":{"total": 2701.09, "avg": 93.14, "max": 2.34, "min": 464.65, "cnt": 29}, "backward-send":{"total": 3.30, "avg": 1.10, "max": 1.03, "min": 1.18, "cnt": 3}, "backward-recv":{"total": 155.02, "avg": 77.51, "max": 65.90, "min": 89.13, "cnt": 2}, "backward-params-all-reduce":{"total": 484.30, "avg": 484.30, "max": 484.30, "min": 484.30, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 263.45, "avg": 263.45, "max": 263.45, "min": 263.45, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 223.54, "avg": 223.54, "max": 223.54, "min": 223.54, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.27, "avg": 3.27, "max": 3.27, "min": 3.27, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.48, "avg": 3.48, "max": 3.48, "min": 3.48, "cnt": 1}}}
{"type":"time", "iteration": 131, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 61.23, "avg": 20.41, "max": 0.93, "min": 59.14, "cnt": 3}, "forward-compute":{"total": 1974.93, "avg": 61.72, "max": 55.59, "min": 66.22, "cnt": 32}, "fwd-compute":{"total": 1971.63, "avg": 61.61, "max": 55.53, "min": 66.12, "cnt": 32}, "batch-generator":{"total": 54.35, "avg": 1.70, "max": 0.68, "min": 3.36, "cnt": 32}, "fwd-embedding":{"total": 0.71, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1904.88, "avg": 59.53, "max": 54.28, "min": 64.14, "cnt": 32}, "fwd-layernorm":{"total": 10.15, "avg": 0.08, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 110.39, "avg": 0.86, "max": 0.74, "min": 2.27, "cnt": 128}, "fwd-misc":{"total": 20.82, "avg": 0.16, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1742.86, "avg": 13.62, "max": 11.60, "min": 18.83, "cnt": 128}, "MoE_L0_fwd":{"total": 497.71, "avg": 15.55, "max": 12.43, "min": 18.70, "cnt": 32}, "MoEMLP":{"total": 1726.03, "avg": 13.48, "max": 11.48, "min": 18.62, "cnt": 128}, "MoE_L1_fwd":{"total": 399.75, "avg": 12.49, "max": 11.52, "min": 14.90, "cnt": 32}, "MoE_L2_fwd":{"total": 435.47, "avg": 13.61, "max": 12.97, "min": 17.35, "cnt": 32}, "MoE_L3_fwd":{"total": 399.29, "avg": 12.48, "max": 11.57, "min": 16.72, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 2.17, "avg": 1.08, "max": 0.88, "min": 1.28, "cnt": 2}, "forward-send-backward-recv":{"total": 303.50, "avg": 10.12, "max": 1.47, "min": 122.16, "cnt": 30}, "backward-compute":{"total": 1869.28, "avg": 58.42, "max": 56.14, "min": 60.41, "cnt": 32}, "MoE_L3_bwd":{"total": 431.81, "avg": 13.49, "max": 12.41, "min": 14.24, "cnt": 32}, "MoE_L2_bwd":{"total": 441.36, "avg": 13.79, "max": 13.26, "min": 14.84, "cnt": 32}, "MoE_L1_bwd":{"total": 343.26, "avg": 10.73, "max": 10.34, "min": 11.45, "cnt": 32}, "MoE_L0_bwd":{"total": 440.96, "avg": 13.78, "max": 13.30, "min": 14.01, "cnt": 32}, "backward-send-forward-recv":{"total": 2730.66, "avg": 94.16, "max": 1.88, "min": 450.54, "cnt": 29}, "backward-send":{"total": 3.01, "avg": 1.00, "max": 0.91, "min": 1.13, "cnt": 3}, "backward-recv":{"total": 133.71, "avg": 66.86, "max": 62.79, "min": 70.92, "cnt": 2}, "backward-params-all-reduce":{"total": 485.68, "avg": 485.68, "max": 485.68, "min": 485.68, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 257.51, "avg": 257.51, "max": 257.51, "min": 257.51, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 217.60, "avg": 217.60, "max": 217.60, "min": 217.60, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.35, "avg": 3.35, "max": 3.35, "min": 3.35, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 132, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 60.13, "avg": 20.04, "max": 1.06, "min": 57.98, "cnt": 3}, "forward-compute":{"total": 1995.17, "avg": 62.35, "max": 55.72, "min": 70.78, "cnt": 32}, "fwd-compute":{"total": 1991.98, "avg": 62.25, "max": 55.65, "min": 70.68, "cnt": 32}, "batch-generator":{"total": 39.20, "avg": 1.23, "max": 0.69, "min": 2.59, "cnt": 32}, "fwd-embedding":{"total": 0.64, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1939.67, "avg": 60.61, "max": 54.56, "min": 69.04, "cnt": 32}, "fwd-layernorm":{"total": 9.72, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 108.65, "avg": 0.85, "max": 0.74, "min": 1.48, "cnt": 128}, "fwd-misc":{"total": 20.53, "avg": 0.16, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1779.99, "avg": 13.91, "max": 11.34, "min": 24.14, "cnt": 128}, "MoE_L0_fwd":{"total": 537.34, "avg": 16.79, "max": 13.13, "min": 24.03, "cnt": 32}, "MoEMLP":{"total": 1763.29, "avg": 13.78, "max": 11.24, "min": 23.98, "cnt": 128}, "MoE_L1_fwd":{"total": 409.31, "avg": 12.79, "max": 11.59, "min": 16.43, "cnt": 32}, "MoE_L2_fwd":{"total": 427.27, "avg": 13.35, "max": 12.56, "min": 19.70, "cnt": 32}, "MoE_L3_fwd":{"total": 395.45, "avg": 12.36, "max": 11.28, "min": 16.72, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.70, "avg": 0.85, "max": 0.84, "min": 0.86, "cnt": 2}, "forward-send-backward-recv":{"total": 231.45, "avg": 7.71, "max": 1.57, "min": 122.16, "cnt": 30}, "backward-compute":{"total": 1877.49, "avg": 58.67, "max": 56.66, "min": 61.72, "cnt": 32}, "MoE_L3_bwd":{"total": 436.13, "avg": 13.63, "max": 12.08, "min": 16.79, "cnt": 32}, "MoE_L2_bwd":{"total": 433.68, "avg": 13.55, "max": 12.98, "min": 14.31, "cnt": 32}, "MoE_L1_bwd":{"total": 349.80, "avg": 10.93, "max": 10.36, "min": 13.02, "cnt": 32}, "MoE_L0_bwd":{"total": 444.33, "avg": 13.89, "max": 13.45, "min": 14.62, "cnt": 32}, "backward-send-forward-recv":{"total": 2367.41, "avg": 81.63, "max": 2.18, "min": 740.97, "cnt": 29}, "backward-send":{"total": 2.25, "avg": 0.75, "max": 0.51, "min": 1.11, "cnt": 3}, "backward-recv":{"total": 133.66, "avg": 66.83, "max": 57.39, "min": 76.27, "cnt": 2}, "backward-params-all-reduce":{"total": 489.60, "avg": 489.60, "max": 489.60, "min": 489.60, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 256.65, "avg": 256.65, "max": 256.65, "min": 256.65, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 216.74, "avg": 216.74, "max": 216.74, "min": 216.74, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 133, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 69.14, "avg": 23.05, "max": 0.91, "min": 67.27, "cnt": 3}, "forward-compute":{"total": 1974.66, "avg": 61.71, "max": 55.57, "min": 73.17, "cnt": 32}, "fwd-compute":{"total": 1971.38, "avg": 61.61, "max": 55.51, "min": 73.10, "cnt": 32}, "batch-generator":{"total": 40.93, "avg": 1.28, "max": 0.69, "min": 1.89, "cnt": 32}, "fwd-embedding":{"total": 0.72, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1917.53, "avg": 59.92, "max": 54.52, "min": 70.76, "cnt": 32}, "fwd-layernorm":{"total": 10.17, "avg": 0.08, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 112.35, "avg": 0.88, "max": 0.74, "min": 1.93, "cnt": 128}, "fwd-misc":{"total": 21.78, "avg": 0.17, "max": 0.11, "min": 0.57, "cnt": 128}, "fwd-MLP":{"total": 1751.74, "avg": 13.69, "max": 11.39, "min": 20.63, "cnt": 128}, "MoE_L0_fwd":{"total": 510.04, "avg": 15.94, "max": 12.78, "min": 20.51, "cnt": 32}, "MoEMLP":{"total": 1734.48, "avg": 13.55, "max": 11.27, "min": 20.44, "cnt": 128}, "MoE_L1_fwd":{"total": 412.52, "avg": 12.89, "max": 11.31, "min": 16.16, "cnt": 32}, "MoE_L2_fwd":{"total": 423.54, "avg": 13.24, "max": 12.40, "min": 17.49, "cnt": 32}, "MoE_L3_fwd":{"total": 394.77, "avg": 12.34, "max": 11.38, "min": 14.56, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.70, "avg": 0.85, "max": 0.85, "min": 0.86, "cnt": 2}, "forward-send-backward-recv":{"total": 195.74, "avg": 6.52, "max": 1.72, "min": 116.98, "cnt": 30}, "backward-compute":{"total": 1857.89, "avg": 58.06, "max": 55.71, "min": 59.86, "cnt": 32}, "MoE_L3_bwd":{"total": 417.63, "avg": 13.05, "max": 11.88, "min": 14.65, "cnt": 32}, "MoE_L2_bwd":{"total": 427.08, "avg": 13.35, "max": 12.55, "min": 13.96, "cnt": 32}, "MoE_L1_bwd":{"total": 356.54, "avg": 11.14, "max": 10.78, "min": 11.92, "cnt": 32}, "MoE_L0_bwd":{"total": 441.79, "avg": 13.81, "max": 13.16, "min": 14.41, "cnt": 32}, "backward-send-forward-recv":{"total": 1981.03, "avg": 68.31, "max": 2.26, "min": 404.46, "cnt": 29}, "backward-send":{"total": 2.41, "avg": 0.80, "max": 0.55, "min": 1.09, "cnt": 3}, "backward-recv":{"total": 127.56, "avg": 63.78, "max": 54.23, "min": 73.33, "cnt": 2}, "backward-params-all-reduce":{"total": 490.01, "avg": 490.01, "max": 490.01, "min": 490.01, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 255.94, "avg": 255.94, "max": 255.94, "min": 255.94, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 216.17, "avg": 216.17, "max": 216.17, "min": 216.17, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.30, "avg": 3.30, "max": 3.30, "min": 3.30, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 134, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 60.06, "avg": 20.02, "max": 1.05, "min": 57.93, "cnt": 3}, "forward-compute":{"total": 1937.34, "avg": 60.54, "max": 56.36, "min": 64.47, "cnt": 32}, "fwd-compute":{"total": 1934.34, "avg": 60.45, "max": 56.28, "min": 64.34, "cnt": 32}, "batch-generator":{"total": 41.27, "avg": 1.29, "max": 0.70, "min": 3.24, "cnt": 32}, "fwd-embedding":{"total": 0.56, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1881.17, "avg": 58.79, "max": 54.91, "min": 62.40, "cnt": 32}, "fwd-layernorm":{"total": 9.18, "avg": 0.07, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 106.87, "avg": 0.83, "max": 0.74, "min": 1.48, "cnt": 128}, "fwd-misc":{"total": 20.27, "avg": 0.16, "max": 0.11, "min": 0.34, "cnt": 128}, "fwd-MLP":{"total": 1725.01, "avg": 13.48, "max": 11.64, "min": 19.86, "cnt": 128}, "MoE_L0_fwd":{"total": 503.61, "avg": 15.74, "max": 13.15, "min": 19.78, "cnt": 32}, "MoEMLP":{"total": 1708.64, "avg": 13.35, "max": 11.53, "min": 19.74, "cnt": 128}, "MoE_L1_fwd":{"total": 403.53, "avg": 12.61, "max": 11.68, "min": 14.92, "cnt": 32}, "MoE_L2_fwd":{"total": 417.63, "avg": 13.05, "max": 12.21, "min": 14.11, "cnt": 32}, "MoE_L3_fwd":{"total": 389.89, "avg": 12.18, "max": 11.57, "min": 15.05, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.86, "avg": 0.93, "max": 0.92, "min": 0.94, "cnt": 2}, "forward-send-backward-recv":{"total": 177.62, "avg": 5.92, "max": 1.47, "min": 113.75, "cnt": 30}, "backward-compute":{"total": 1850.33, "avg": 57.82, "max": 56.70, "min": 59.71, "cnt": 32}, "MoE_L3_bwd":{"total": 429.11, "avg": 13.41, "max": 12.25, "min": 17.68, "cnt": 32}, "MoE_L2_bwd":{"total": 421.81, "avg": 13.18, "max": 12.62, "min": 13.89, "cnt": 32}, "MoE_L1_bwd":{"total": 345.44, "avg": 10.79, "max": 10.13, "min": 11.29, "cnt": 32}, "MoE_L0_bwd":{"total": 438.64, "avg": 13.71, "max": 13.11, "min": 14.50, "cnt": 32}, "backward-send-forward-recv":{"total": 2362.63, "avg": 81.47, "max": 2.34, "min": 979.23, "cnt": 29}, "backward-send":{"total": 3.11, "avg": 1.04, "max": 0.94, "min": 1.18, "cnt": 3}, "backward-recv":{"total": 124.49, "avg": 62.25, "max": 60.02, "min": 64.47, "cnt": 2}, "backward-params-all-reduce":{"total": 490.52, "avg": 490.52, "max": 490.52, "min": 490.52, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 253.09, "avg": 253.09, "max": 253.09, "min": 253.09, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 213.34, "avg": 213.34, "max": 213.34, "min": 213.34, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.21, "avg": 3.21, "max": 3.21, "min": 3.21, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 135, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 68.16, "avg": 22.72, "max": 0.93, "min": 66.20, "cnt": 3}, "forward-compute":{"total": 1984.59, "avg": 62.02, "max": 55.76, "min": 72.93, "cnt": 32}, "fwd-compute":{"total": 1981.02, "avg": 61.91, "max": 55.67, "min": 72.85, "cnt": 32}, "batch-generator":{"total": 43.00, "avg": 1.34, "max": 0.67, "min": 2.50, "cnt": 32}, "fwd-embedding":{"total": 0.71, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1924.95, "avg": 60.15, "max": 54.29, "min": 70.88, "cnt": 32}, "fwd-layernorm":{"total": 10.36, "avg": 0.08, "max": 0.06, "min": 0.22, "cnt": 128}, "fwd-attn":{"total": 113.10, "avg": 0.88, "max": 0.74, "min": 1.94, "cnt": 128}, "fwd-misc":{"total": 21.79, "avg": 0.17, "max": 0.11, "min": 0.40, "cnt": 128}, "fwd-MLP":{"total": 1757.91, "avg": 13.73, "max": 11.47, "min": 22.57, "cnt": 128}, "MoE_L0_fwd":{"total": 518.60, "avg": 16.21, "max": 12.88, "min": 22.48, "cnt": 32}, "MoEMLP":{"total": 1740.22, "avg": 13.60, "max": 11.36, "min": 22.44, "cnt": 128}, "MoE_L1_fwd":{"total": 412.48, "avg": 12.89, "max": 11.40, "min": 16.11, "cnt": 32}, "MoE_L2_fwd":{"total": 423.80, "avg": 13.24, "max": 12.54, "min": 15.41, "cnt": 32}, "MoE_L3_fwd":{"total": 391.74, "avg": 12.24, "max": 11.40, "min": 16.16, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.55, "avg": 0.77, "max": 0.73, "min": 0.82, "cnt": 2}, "forward-send-backward-recv":{"total": 349.65, "avg": 11.65, "max": 1.34, "min": 131.89, "cnt": 30}, "backward-compute":{"total": 1870.23, "avg": 58.44, "max": 55.07, "min": 61.10, "cnt": 32}, "MoE_L3_bwd":{"total": 427.18, "avg": 13.35, "max": 12.08, "min": 15.69, "cnt": 32}, "MoE_L2_bwd":{"total": 430.56, "avg": 13.45, "max": 12.72, "min": 14.31, "cnt": 32}, "MoE_L1_bwd":{"total": 351.99, "avg": 11.00, "max": 10.31, "min": 11.73, "cnt": 32}, "MoE_L0_bwd":{"total": 445.51, "avg": 13.92, "max": 13.20, "min": 15.37, "cnt": 32}, "backward-send-forward-recv":{"total": 1081.99, "avg": 37.31, "max": 2.20, "min": 234.47, "cnt": 29}, "backward-send":{"total": 3.11, "avg": 1.04, "max": 0.91, "min": 1.13, "cnt": 3}, "backward-recv":{"total": 173.04, "avg": 86.52, "max": 84.51, "min": 88.53, "cnt": 2}, "backward-params-all-reduce":{"total": 490.66, "avg": 490.66, "max": 490.66, "min": 490.66, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 256.84, "avg": 256.84, "max": 256.84, "min": 256.84, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 217.01, "avg": 217.01, "max": 217.01, "min": 217.01, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.32, "avg": 3.32, "max": 3.32, "min": 3.32, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 136, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.06, "avg": 0.06, "max": 0.06, "min": 0.06, "cnt": 1}, "forward-recv":{"total": 62.19, "avg": 20.73, "max": 0.91, "min": 60.31, "cnt": 3}, "forward-compute":{"total": 1985.83, "avg": 62.06, "max": 55.08, "min": 67.20, "cnt": 32}, "fwd-compute":{"total": 1982.67, "avg": 61.96, "max": 55.01, "min": 67.07, "cnt": 32}, "batch-generator":{"total": 46.90, "avg": 1.47, "max": 0.67, "min": 3.44, "cnt": 32}, "fwd-embedding":{"total": 0.64, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1923.04, "avg": 60.10, "max": 54.04, "min": 65.01, "cnt": 32}, "fwd-layernorm":{"total": 9.82, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 109.58, "avg": 0.86, "max": 0.74, "min": 2.09, "cnt": 128}, "fwd-misc":{"total": 20.79, "avg": 0.16, "max": 0.11, "min": 0.47, "cnt": 128}, "fwd-MLP":{"total": 1762.41, "avg": 13.77, "max": 11.52, "min": 23.81, "cnt": 128}, "MoE_L0_fwd":{"total": 539.33, "avg": 16.85, "max": 13.33, "min": 23.74, "cnt": 32}, "MoEMLP":{"total": 1745.78, "avg": 13.64, "max": 11.41, "min": 23.69, "cnt": 128}, "MoE_L1_fwd":{"total": 411.83, "avg": 12.87, "max": 11.48, "min": 17.09, "cnt": 32}, "MoE_L2_fwd":{"total": 412.40, "avg": 12.89, "max": 12.43, "min": 13.76, "cnt": 32}, "MoE_L3_fwd":{"total": 388.31, "avg": 12.13, "max": 11.45, "min": 13.69, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.56, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.78, "avg": 0.89, "max": 0.88, "min": 0.90, "cnt": 2}, "forward-send-backward-recv":{"total": 182.92, "avg": 6.10, "max": 1.88, "min": 121.87, "cnt": 30}, "backward-compute":{"total": 1856.37, "avg": 58.01, "max": 56.92, "min": 61.60, "cnt": 32}, "MoE_L3_bwd":{"total": 429.34, "avg": 13.42, "max": 12.68, "min": 17.37, "cnt": 32}, "MoE_L2_bwd":{"total": 421.41, "avg": 13.17, "max": 12.57, "min": 14.13, "cnt": 32}, "MoE_L1_bwd":{"total": 348.85, "avg": 10.90, "max": 10.39, "min": 12.62, "cnt": 32}, "MoE_L0_bwd":{"total": 442.19, "avg": 13.82, "max": 13.18, "min": 14.56, "cnt": 32}, "backward-send-forward-recv":{"total": 3497.62, "avg": 120.61, "max": 2.04, "min": 1041.94, "cnt": 29}, "backward-send":{"total": 3.15, "avg": 1.05, "max": 0.89, "min": 1.18, "cnt": 3}, "backward-recv":{"total": 133.35, "avg": 66.67, "max": 65.50, "min": 67.85, "cnt": 2}, "backward-params-all-reduce":{"total": 483.43, "avg": 483.43, "max": 483.43, "min": 483.43, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 255.93, "avg": 255.93, "max": 255.93, "min": 255.93, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 216.10, "avg": 216.10, "max": 216.10, "min": 216.10, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 137, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 80.72, "avg": 26.91, "max": 3.72, "min": 71.17, "cnt": 3}, "forward-compute":{"total": 1973.09, "avg": 61.66, "max": 55.65, "min": 67.79, "cnt": 32}, "fwd-compute":{"total": 1969.67, "avg": 61.55, "max": 55.58, "min": 67.70, "cnt": 32}, "batch-generator":{"total": 54.36, "avg": 1.70, "max": 0.66, "min": 4.06, "cnt": 32}, "fwd-embedding":{"total": 0.76, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1901.88, "avg": 59.43, "max": 54.55, "min": 64.21, "cnt": 32}, "fwd-layernorm":{"total": 10.71, "avg": 0.08, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 115.98, "avg": 0.91, "max": 0.74, "min": 1.74, "cnt": 128}, "fwd-misc":{"total": 22.91, "avg": 0.18, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1729.97, "avg": 13.52, "max": 11.41, "min": 20.23, "cnt": 128}, "MoE_L0_fwd":{"total": 502.31, "avg": 15.70, "max": 13.26, "min": 20.15, "cnt": 32}, "MoEMLP":{"total": 1711.78, "avg": 13.37, "max": 11.30, "min": 20.10, "cnt": 128}, "MoE_L1_fwd":{"total": 407.92, "avg": 12.75, "max": 11.46, "min": 16.12, "cnt": 32}, "MoE_L2_fwd":{"total": 415.92, "avg": 13.00, "max": 12.36, "min": 14.38, "cnt": 32}, "MoE_L3_fwd":{"total": 392.33, "avg": 12.26, "max": 11.34, "min": 16.45, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.05, "cnt": 32}, "forward-send":{"total": 1.81, "avg": 0.90, "max": 0.89, "min": 0.92, "cnt": 2}, "forward-send-backward-recv":{"total": 198.82, "avg": 6.63, "max": 1.71, "min": 114.48, "cnt": 30}, "backward-compute":{"total": 1839.55, "avg": 57.49, "max": 56.01, "min": 59.93, "cnt": 32}, "MoE_L3_bwd":{"total": 426.51, "avg": 13.33, "max": 12.11, "min": 15.38, "cnt": 32}, "MoE_L2_bwd":{"total": 412.77, "avg": 12.90, "max": 12.14, "min": 13.61, "cnt": 32}, "MoE_L1_bwd":{"total": 341.59, "avg": 10.67, "max": 10.27, "min": 11.44, "cnt": 32}, "MoE_L0_bwd":{"total": 442.57, "avg": 13.83, "max": 13.20, "min": 15.19, "cnt": 32}, "backward-send-forward-recv":{"total": 3225.20, "avg": 111.21, "max": 2.33, "min": 924.40, "cnt": 29}, "backward-send":{"total": 2.77, "avg": 0.92, "max": 0.56, "min": 1.14, "cnt": 3}, "backward-recv":{"total": 136.06, "avg": 68.03, "max": 65.24, "min": 70.82, "cnt": 2}, "backward-params-all-reduce":{"total": 486.05, "avg": 486.05, "max": 486.05, "min": 486.05, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 259.39, "avg": 259.39, "max": 259.39, "min": 259.39, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 219.61, "avg": 219.61, "max": 219.61, "min": 219.61, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.25, "avg": 3.25, "max": 3.25, "min": 3.25, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 138, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 63.97, "avg": 21.32, "max": 1.32, "min": 57.53, "cnt": 3}, "forward-compute":{"total": 1939.62, "avg": 60.61, "max": 55.41, "min": 65.77, "cnt": 32}, "fwd-compute":{"total": 1936.18, "avg": 60.51, "max": 55.31, "min": 65.70, "cnt": 32}, "batch-generator":{"total": 46.86, "avg": 1.46, "max": 0.72, "min": 3.06, "cnt": 32}, "fwd-embedding":{"total": 0.71, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1876.46, "avg": 58.64, "max": 54.17, "min": 64.63, "cnt": 32}, "fwd-layernorm":{"total": 10.48, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 113.29, "avg": 0.89, "max": 0.74, "min": 1.50, "cnt": 128}, "fwd-misc":{"total": 21.71, "avg": 0.17, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1709.20, "avg": 13.35, "max": 11.25, "min": 19.55, "cnt": 128}, "MoE_L0_fwd":{"total": 503.68, "avg": 15.74, "max": 13.22, "min": 19.47, "cnt": 32}, "MoEMLP":{"total": 1691.65, "avg": 13.22, "max": 11.14, "min": 19.42, "cnt": 128}, "MoE_L1_fwd":{"total": 394.44, "avg": 12.33, "max": 11.18, "min": 13.35, "cnt": 32}, "MoE_L2_fwd":{"total": 409.68, "avg": 12.80, "max": 12.24, "min": 13.72, "cnt": 32}, "MoE_L3_fwd":{"total": 390.24, "avg": 12.19, "max": 11.51, "min": 14.20, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.92, "avg": 0.96, "max": 0.93, "min": 1.00, "cnt": 2}, "forward-send-backward-recv":{"total": 390.89, "avg": 13.03, "max": 1.94, "min": 125.07, "cnt": 30}, "backward-compute":{"total": 1837.26, "avg": 57.41, "max": 55.12, "min": 59.32, "cnt": 32}, "MoE_L3_bwd":{"total": 418.53, "avg": 13.08, "max": 11.47, "min": 14.33, "cnt": 32}, "MoE_L2_bwd":{"total": 416.77, "avg": 13.02, "max": 12.24, "min": 14.01, "cnt": 32}, "MoE_L1_bwd":{"total": 344.07, "avg": 10.75, "max": 10.18, "min": 12.09, "cnt": 32}, "MoE_L0_bwd":{"total": 443.32, "avg": 13.85, "max": 13.24, "min": 14.33, "cnt": 32}, "backward-send-forward-recv":{"total": 2114.74, "avg": 72.92, "max": 2.31, "min": 313.74, "cnt": 29}, "backward-send":{"total": 2.50, "avg": 0.83, "max": 0.50, "min": 1.08, "cnt": 3}, "backward-recv":{"total": 437.57, "avg": 218.79, "max": 53.36, "min": 384.21, "cnt": 2}, "backward-params-all-reduce":{"total": 486.53, "avg": 486.53, "max": 486.53, "min": 486.53, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 256.68, "avg": 256.68, "max": 256.68, "min": 256.68, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 216.95, "avg": 216.95, "max": 216.95, "min": 216.95, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.29, "avg": 3.29, "max": 3.29, "min": 3.29, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 139, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 66.86, "avg": 22.29, "max": 1.27, "min": 64.28, "cnt": 3}, "forward-compute":{"total": 1936.09, "avg": 60.50, "max": 54.91, "min": 72.00, "cnt": 32}, "fwd-compute":{"total": 1933.03, "avg": 60.41, "max": 54.84, "min": 71.88, "cnt": 32}, "batch-generator":{"total": 37.63, "avg": 1.18, "max": 0.70, "min": 2.34, "cnt": 32}, "fwd-embedding":{"total": 0.57, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1883.47, "avg": 58.86, "max": 53.80, "min": 70.03, "cnt": 32}, "fwd-layernorm":{"total": 9.53, "avg": 0.07, "max": 0.06, "min": 0.18, "cnt": 128}, "fwd-attn":{"total": 110.86, "avg": 0.87, "max": 0.74, "min": 2.18, "cnt": 128}, "fwd-misc":{"total": 20.95, "avg": 0.16, "max": 0.11, "min": 0.40, "cnt": 128}, "fwd-MLP":{"total": 1721.56, "avg": 13.45, "max": 11.20, "min": 20.32, "cnt": 128}, "MoE_L0_fwd":{"total": 495.62, "avg": 15.49, "max": 13.05, "min": 20.17, "cnt": 32}, "MoEMLP":{"total": 1704.45, "avg": 13.32, "max": 11.07, "min": 20.09, "cnt": 128}, "MoE_L1_fwd":{"total": 404.45, "avg": 12.64, "max": 11.30, "min": 17.55, "cnt": 32}, "MoE_L2_fwd":{"total": 414.50, "avg": 12.95, "max": 12.37, "min": 15.80, "cnt": 32}, "MoE_L3_fwd":{"total": 395.97, "avg": 12.37, "max": 11.11, "min": 17.50, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.87, "avg": 0.93, "max": 0.90, "min": 0.97, "cnt": 2}, "forward-send-backward-recv":{"total": 207.85, "avg": 6.93, "max": 1.28, "min": 124.51, "cnt": 30}, "backward-compute":{"total": 1848.83, "avg": 57.78, "max": 55.90, "min": 61.16, "cnt": 32}, "MoE_L3_bwd":{"total": 427.91, "avg": 13.37, "max": 12.44, "min": 15.64, "cnt": 32}, "MoE_L2_bwd":{"total": 420.25, "avg": 13.13, "max": 12.41, "min": 13.78, "cnt": 32}, "MoE_L1_bwd":{"total": 340.25, "avg": 10.63, "max": 10.20, "min": 11.35, "cnt": 32}, "MoE_L0_bwd":{"total": 445.46, "avg": 13.92, "max": 13.45, "min": 14.85, "cnt": 32}, "backward-send-forward-recv":{"total": 1830.50, "avg": 63.12, "max": 1.90, "min": 317.98, "cnt": 29}, "backward-send":{"total": 3.29, "avg": 1.10, "max": 1.02, "min": 1.14, "cnt": 3}, "backward-recv":{"total": 298.92, "avg": 149.46, "max": 52.89, "min": 246.03, "cnt": 2}, "backward-params-all-reduce":{"total": 486.13, "avg": 486.13, "max": 486.13, "min": 486.13, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 259.82, "avg": 259.82, "max": 259.82, "min": 259.82, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 220.16, "avg": 220.16, "max": 220.16, "min": 220.16, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.25, "avg": 3.25, "max": 3.25, "min": 3.25, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}}}
{"type":"time", "iteration": 140, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 71.15, "avg": 23.72, "max": 1.91, "min": 60.75, "cnt": 3}, "forward-compute":{"total": 1948.27, "avg": 60.88, "max": 54.39, "min": 66.99, "cnt": 32}, "fwd-compute":{"total": 1944.93, "avg": 60.78, "max": 54.31, "min": 66.85, "cnt": 32}, "batch-generator":{"total": 42.14, "avg": 1.32, "max": 0.66, "min": 3.15, "cnt": 32}, "fwd-embedding":{"total": 0.66, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1889.53, "avg": 59.05, "max": 53.20, "min": 64.60, "cnt": 32}, "fwd-layernorm":{"total": 10.23, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 113.42, "avg": 0.89, "max": 0.74, "min": 2.37, "cnt": 128}, "fwd-misc":{"total": 21.97, "avg": 0.17, "max": 0.11, "min": 0.40, "cnt": 128}, "fwd-MLP":{"total": 1721.88, "avg": 13.45, "max": 11.31, "min": 18.97, "cnt": 128}, "MoE_L0_fwd":{"total": 493.96, "avg": 15.44, "max": 12.65, "min": 18.88, "cnt": 32}, "MoEMLP":{"total": 1703.97, "avg": 13.31, "max": 11.20, "min": 18.83, "cnt": 128}, "MoE_L1_fwd":{"total": 395.56, "avg": 12.36, "max": 11.38, "min": 14.84, "cnt": 32}, "MoE_L2_fwd":{"total": 421.70, "avg": 13.18, "max": 12.43, "min": 16.58, "cnt": 32}, "MoE_L3_fwd":{"total": 399.15, "avg": 12.47, "max": 11.24, "min": 17.74, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.05, "cnt": 32}, "forward-send":{"total": 1.83, "avg": 0.92, "max": 0.82, "min": 1.01, "cnt": 2}, "forward-send-backward-recv":{"total": 878.99, "avg": 29.30, "max": 1.40, "min": 190.98, "cnt": 30}, "backward-compute":{"total": 1836.34, "avg": 57.39, "max": 55.77, "min": 60.43, "cnt": 32}, "MoE_L3_bwd":{"total": 426.45, "avg": 13.33, "max": 12.28, "min": 16.58, "cnt": 32}, "MoE_L2_bwd":{"total": 417.95, "avg": 13.06, "max": 12.42, "min": 13.66, "cnt": 32}, "MoE_L1_bwd":{"total": 336.86, "avg": 10.53, "max": 10.15, "min": 11.42, "cnt": 32}, "MoE_L0_bwd":{"total": 439.30, "avg": 13.73, "max": 13.43, "min": 14.18, "cnt": 32}, "backward-send-forward-recv":{"total": 1286.87, "avg": 44.37, "max": 1.79, "min": 246.55, "cnt": 29}, "backward-send":{"total": 3.21, "avg": 1.07, "max": 0.97, "min": 1.12, "cnt": 3}, "backward-recv":{"total": 273.20, "avg": 136.60, "max": 73.21, "min": 199.99, "cnt": 2}, "backward-params-all-reduce":{"total": 487.62, "avg": 487.62, "max": 487.62, "min": 487.62, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 258.43, "avg": 258.43, "max": 258.43, "min": 258.43, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 218.65, "avg": 218.65, "max": 218.65, "min": 218.65, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.28, "avg": 3.28, "max": 3.28, "min": 3.28, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 141, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.06, "avg": 0.06, "max": 0.06, "min": 0.06, "cnt": 1}, "forward-recv":{"total": 73.35, "avg": 24.45, "max": 2.58, "min": 62.57, "cnt": 3}, "forward-compute":{"total": 1942.71, "avg": 60.71, "max": 55.45, "min": 65.52, "cnt": 32}, "fwd-compute":{"total": 1939.12, "avg": 60.60, "max": 55.38, "min": 65.45, "cnt": 32}, "batch-generator":{"total": 43.30, "avg": 1.35, "max": 0.69, "min": 1.97, "cnt": 32}, "fwd-embedding":{"total": 0.82, "avg": 0.03, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1881.49, "avg": 58.80, "max": 54.30, "min": 64.03, "cnt": 32}, "fwd-layernorm":{"total": 10.88, "avg": 0.09, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 115.57, "avg": 0.90, "max": 0.74, "min": 2.03, "cnt": 128}, "fwd-misc":{"total": 22.77, "avg": 0.18, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1709.67, "avg": 13.36, "max": 11.33, "min": 17.28, "cnt": 128}, "MoE_L0_fwd":{"total": 498.93, "avg": 15.59, "max": 13.58, "min": 17.20, "cnt": 32}, "MoEMLP":{"total": 1691.49, "avg": 13.21, "max": 11.22, "min": 17.14, "cnt": 128}, "MoE_L1_fwd":{"total": 400.79, "avg": 12.52, "max": 11.26, "min": 15.70, "cnt": 32}, "MoE_L2_fwd":{"total": 419.14, "avg": 13.10, "max": 12.37, "min": 15.76, "cnt": 32}, "MoE_L3_fwd":{"total": 379.23, "avg": 11.85, "max": 11.30, "min": 12.73, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.82, "avg": 0.91, "max": 0.86, "min": 0.96, "cnt": 2}, "forward-send-backward-recv":{"total": 1133.48, "avg": 37.78, "max": 1.92, "min": 184.91, "cnt": 30}, "backward-compute":{"total": 1828.04, "avg": 57.13, "max": 55.38, "min": 58.51, "cnt": 32}, "MoE_L3_bwd":{"total": 415.06, "avg": 12.97, "max": 11.77, "min": 13.98, "cnt": 32}, "MoE_L2_bwd":{"total": 418.44, "avg": 13.08, "max": 12.17, "min": 13.94, "cnt": 32}, "MoE_L1_bwd":{"total": 334.14, "avg": 10.44, "max": 10.08, "min": 11.39, "cnt": 32}, "MoE_L0_bwd":{"total": 444.17, "avg": 13.88, "max": 13.34, "min": 14.40, "cnt": 32}, "backward-send-forward-recv":{"total": 602.46, "avg": 20.77, "max": 2.39, "min": 148.31, "cnt": 29}, "backward-send":{"total": 2.35, "avg": 0.78, "max": 0.72, "min": 0.85, "cnt": 3}, "backward-recv":{"total": 193.34, "avg": 96.67, "max": 79.21, "min": 114.12, "cnt": 2}, "backward-params-all-reduce":{"total": 487.21, "avg": 487.21, "max": 487.21, "min": 487.21, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 261.46, "avg": 261.46, "max": 261.46, "min": 261.46, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 221.60, "avg": 221.60, "max": 221.60, "min": 221.60, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 142, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 69.57, "avg": 23.19, "max": 1.07, "min": 61.46, "cnt": 3}, "forward-compute":{"total": 2026.63, "avg": 63.33, "max": 56.48, "min": 130.26, "cnt": 32}, "fwd-compute":{"total": 2023.18, "avg": 63.22, "max": 56.39, "min": 130.18, "cnt": 32}, "batch-generator":{"total": 42.62, "avg": 1.33, "max": 0.71, "min": 2.48, "cnt": 32}, "fwd-embedding":{"total": 0.80, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1967.25, "avg": 61.48, "max": 55.28, "min": 129.07, "cnt": 32}, "fwd-layernorm":{"total": 10.74, "avg": 0.08, "max": 0.06, "min": 0.18, "cnt": 128}, "fwd-attn":{"total": 115.38, "avg": 0.90, "max": 0.74, "min": 2.09, "cnt": 128}, "fwd-misc":{"total": 22.30, "avg": 0.17, "max": 0.11, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1796.30, "avg": 14.03, "max": 11.24, "min": 86.61, "cnt": 128}, "MoE_L0_fwd":{"total": 591.58, "avg": 18.49, "max": 13.43, "min": 86.50, "cnt": 32}, "MoEMLP":{"total": 1778.15, "avg": 13.89, "max": 11.14, "min": 86.45, "cnt": 128}, "MoE_L1_fwd":{"total": 393.67, "avg": 12.30, "max": 11.51, "min": 14.16, "cnt": 32}, "MoE_L2_fwd":{"total": 420.16, "avg": 13.13, "max": 12.38, "min": 14.85, "cnt": 32}, "MoE_L3_fwd":{"total": 379.36, "avg": 11.86, "max": 11.18, "min": 14.08, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.46, "avg": 0.73, "max": 0.70, "min": 0.76, "cnt": 2}, "forward-send-backward-recv":{"total": 992.22, "avg": 33.07, "max": 1.94, "min": 284.18, "cnt": 30}, "backward-compute":{"total": 1823.98, "avg": 57.00, "max": 54.32, "min": 61.52, "cnt": 32}, "MoE_L3_bwd":{"total": 412.35, "avg": 12.89, "max": 11.72, "min": 14.47, "cnt": 32}, "MoE_L2_bwd":{"total": 415.53, "avg": 12.99, "max": 12.21, "min": 13.79, "cnt": 32}, "MoE_L1_bwd":{"total": 336.58, "avg": 10.52, "max": 9.60, "min": 14.06, "cnt": 32}, "MoE_L0_bwd":{"total": 443.78, "avg": 13.87, "max": 13.35, "min": 14.17, "cnt": 32}, "backward-send-forward-recv":{"total": 1690.96, "avg": 58.31, "max": 2.32, "min": 289.24, "cnt": 29}, "backward-send":{"total": 2.89, "avg": 0.96, "max": 0.72, "min": 1.18, "cnt": 3}, "backward-recv":{"total": 241.69, "avg": 120.85, "max": 69.64, "min": 172.06, "cnt": 2}, "backward-params-all-reduce":{"total": 488.32, "avg": 488.32, "max": 488.32, "min": 488.32, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 260.63, "avg": 260.63, "max": 260.63, "min": 260.63, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 220.93, "avg": 220.93, "max": 220.93, "min": 220.93, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.25, "avg": 3.25, "max": 3.25, "min": 3.25, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 143, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 65.09, "avg": 21.70, "max": 0.90, "min": 63.06, "cnt": 3}, "forward-compute":{"total": 1924.64, "avg": 60.15, "max": 54.75, "min": 67.78, "cnt": 32}, "fwd-compute":{"total": 1921.38, "avg": 60.04, "max": 54.68, "min": 67.71, "cnt": 32}, "batch-generator":{"total": 43.21, "avg": 1.35, "max": 0.74, "min": 2.53, "cnt": 32}, "fwd-embedding":{"total": 0.65, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1865.28, "avg": 58.29, "max": 53.39, "min": 65.54, "cnt": 32}, "fwd-layernorm":{"total": 9.84, "avg": 0.08, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 110.49, "avg": 0.86, "max": 0.74, "min": 2.45, "cnt": 128}, "fwd-misc":{"total": 21.29, "avg": 0.17, "max": 0.11, "min": 0.45, "cnt": 128}, "fwd-MLP":{"total": 1702.49, "avg": 13.30, "max": 11.17, "min": 18.78, "cnt": 128}, "MoE_L0_fwd":{"total": 499.17, "avg": 15.60, "max": 12.97, "min": 18.63, "cnt": 32}, "MoEMLP":{"total": 1685.01, "avg": 13.16, "max": 11.05, "min": 18.55, "cnt": 128}, "MoE_L1_fwd":{"total": 402.17, "avg": 12.57, "max": 11.20, "min": 15.50, "cnt": 32}, "MoE_L2_fwd":{"total": 410.76, "avg": 12.84, "max": 12.14, "min": 13.61, "cnt": 32}, "MoE_L3_fwd":{"total": 379.37, "avg": 11.86, "max": 11.09, "min": 16.13, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 7.86, "avg": 3.93, "max": 0.91, "min": 6.95, "cnt": 2}, "forward-send-backward-recv":{"total": 262.21, "avg": 8.74, "max": 1.68, "min": 117.17, "cnt": 30}, "backward-compute":{"total": 1828.28, "avg": 57.13, "max": 54.86, "min": 60.06, "cnt": 32}, "MoE_L3_bwd":{"total": 411.70, "avg": 12.87, "max": 12.06, "min": 15.58, "cnt": 32}, "MoE_L2_bwd":{"total": 415.96, "avg": 13.00, "max": 12.07, "min": 13.68, "cnt": 32}, "MoE_L1_bwd":{"total": 338.55, "avg": 10.58, "max": 10.20, "min": 11.32, "cnt": 32}, "MoE_L0_bwd":{"total": 447.35, "avg": 13.98, "max": 13.38, "min": 14.62, "cnt": 32}, "backward-send-forward-recv":{"total": 1521.39, "avg": 52.46, "max": 2.12, "min": 189.85, "cnt": 29}, "backward-send":{"total": 3.10, "avg": 1.03, "max": 0.97, "min": 1.11, "cnt": 3}, "backward-recv":{"total": 231.86, "avg": 115.93, "max": 68.93, "min": 162.93, "cnt": 2}, "backward-params-all-reduce":{"total": 486.24, "avg": 486.24, "max": 486.24, "min": 486.24, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 269.23, "avg": 269.23, "max": 269.23, "min": 269.23, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 225.11, "avg": 225.11, "max": 225.11, "min": 225.11, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.78, "avg": 6.78, "max": 6.78, "min": 6.78, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 144, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.06, "avg": 0.06, "max": 0.06, "min": 0.06, "cnt": 1}, "forward-recv":{"total": 66.43, "avg": 22.14, "max": 2.35, "min": 58.61, "cnt": 3}, "forward-compute":{"total": 1964.59, "avg": 61.39, "max": 55.47, "min": 69.47, "cnt": 32}, "fwd-compute":{"total": 1961.01, "avg": 61.28, "max": 55.40, "min": 69.35, "cnt": 32}, "batch-generator":{"total": 47.22, "avg": 1.48, "max": 0.68, "min": 2.19, "cnt": 32}, "fwd-embedding":{"total": 0.72, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1900.59, "avg": 59.39, "max": 54.41, "min": 67.28, "cnt": 32}, "fwd-layernorm":{"total": 10.42, "avg": 0.08, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 114.75, "avg": 0.90, "max": 0.75, "min": 1.52, "cnt": 128}, "fwd-misc":{"total": 22.61, "avg": 0.18, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1730.81, "avg": 13.52, "max": 11.15, "min": 19.73, "cnt": 128}, "MoE_L0_fwd":{"total": 515.84, "avg": 16.12, "max": 12.97, "min": 19.61, "cnt": 32}, "MoEMLP":{"total": 1712.99, "avg": 13.38, "max": 11.03, "min": 19.54, "cnt": 128}, "MoE_L1_fwd":{"total": 394.66, "avg": 12.33, "max": 11.50, "min": 13.99, "cnt": 32}, "MoE_L2_fwd":{"total": 425.71, "avg": 13.30, "max": 12.32, "min": 19.37, "cnt": 32}, "MoE_L3_fwd":{"total": 383.30, "avg": 11.98, "max": 11.08, "min": 14.54, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.62, "avg": 0.02, "max": 0.02, "min": 0.04, "cnt": 32}, "forward-send":{"total": 1.80, "avg": 0.90, "max": 0.87, "min": 0.93, "cnt": 2}, "forward-send-backward-recv":{"total": 596.94, "avg": 19.90, "max": 1.47, "min": 160.67, "cnt": 30}, "backward-compute":{"total": 1846.31, "avg": 57.70, "max": 55.95, "min": 59.24, "cnt": 32}, "MoE_L3_bwd":{"total": 410.45, "avg": 12.83, "max": 12.08, "min": 13.96, "cnt": 32}, "MoE_L2_bwd":{"total": 423.28, "avg": 13.23, "max": 12.34, "min": 14.89, "cnt": 32}, "MoE_L1_bwd":{"total": 348.16, "avg": 10.88, "max": 10.34, "min": 11.29, "cnt": 32}, "MoE_L0_bwd":{"total": 448.02, "avg": 14.00, "max": 13.60, "min": 14.36, "cnt": 32}, "backward-send-forward-recv":{"total": 1327.51, "avg": 45.78, "max": 2.35, "min": 190.92, "cnt": 29}, "backward-send":{"total": 3.18, "avg": 1.06, "max": 0.97, "min": 1.14, "cnt": 3}, "backward-recv":{"total": 328.01, "avg": 164.01, "max": 60.38, "min": 267.63, "cnt": 2}, "backward-params-all-reduce":{"total": 481.69, "avg": 481.69, "max": 481.69, "min": 481.69, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 268.36, "avg": 268.36, "max": 268.36, "min": 268.36, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 224.30, "avg": 224.30, "max": 224.30, "min": 224.30, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.73, "avg": 6.73, "max": 6.73, "min": 6.73, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 145, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 65.49, "avg": 21.83, "max": 0.98, "min": 57.44, "cnt": 3}, "forward-compute":{"total": 1928.37, "avg": 60.26, "max": 54.28, "min": 67.57, "cnt": 32}, "fwd-compute":{"total": 1925.10, "avg": 60.16, "max": 54.22, "min": 67.49, "cnt": 32}, "batch-generator":{"total": 40.90, "avg": 1.28, "max": 0.66, "min": 2.25, "cnt": 32}, "fwd-embedding":{"total": 0.68, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1871.30, "avg": 58.48, "max": 53.26, "min": 64.91, "cnt": 32}, "fwd-layernorm":{"total": 9.97, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 110.49, "avg": 0.86, "max": 0.74, "min": 1.99, "cnt": 128}, "fwd-misc":{"total": 21.45, "avg": 0.17, "max": 0.11, "min": 0.58, "cnt": 128}, "fwd-MLP":{"total": 1708.38, "avg": 13.35, "max": 10.97, "min": 19.82, "cnt": 128}, "MoE_L0_fwd":{"total": 515.28, "avg": 16.10, "max": 13.15, "min": 19.74, "cnt": 32}, "MoEMLP":{"total": 1691.38, "avg": 13.21, "max": 10.86, "min": 19.69, "cnt": 128}, "MoE_L1_fwd":{"total": 394.33, "avg": 12.32, "max": 11.18, "min": 14.00, "cnt": 32}, "MoE_L2_fwd":{"total": 412.38, "avg": 12.89, "max": 12.23, "min": 14.71, "cnt": 32}, "MoE_L3_fwd":{"total": 375.58, "avg": 11.74, "max": 10.90, "min": 14.85, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.91, "avg": 0.95, "max": 0.89, "min": 1.02, "cnt": 2}, "forward-send-backward-recv":{"total": 193.65, "avg": 6.45, "max": 1.43, "min": 119.76, "cnt": 30}, "backward-compute":{"total": 1831.97, "avg": 57.25, "max": 55.52, "min": 59.09, "cnt": 32}, "MoE_L3_bwd":{"total": 400.16, "avg": 12.51, "max": 11.75, "min": 14.48, "cnt": 32}, "MoE_L2_bwd":{"total": 418.51, "avg": 13.08, "max": 12.35, "min": 13.97, "cnt": 32}, "MoE_L1_bwd":{"total": 348.24, "avg": 10.88, "max": 10.28, "min": 12.86, "cnt": 32}, "MoE_L0_bwd":{"total": 448.56, "avg": 14.02, "max": 13.64, "min": 14.33, "cnt": 32}, "backward-send-forward-recv":{"total": 3561.74, "avg": 122.82, "max": 2.36, "min": 594.80, "cnt": 29}, "backward-send":{"total": 2.67, "avg": 0.89, "max": 0.72, "min": 1.13, "cnt": 3}, "backward-recv":{"total": 121.85, "avg": 60.93, "max": 53.33, "min": 68.53, "cnt": 2}, "backward-params-all-reduce":{"total": 489.74, "avg": 489.74, "max": 489.74, "min": 489.74, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 254.07, "avg": 254.07, "max": 254.07, "min": 254.07, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 214.29, "avg": 214.29, "max": 214.29, "min": 214.29, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.25, "avg": 3.25, "max": 3.25, "min": 3.25, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 146, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 64.95, "avg": 21.65, "max": 0.91, "min": 59.58, "cnt": 3}, "forward-compute":{"total": 1976.08, "avg": 61.75, "max": 55.56, "min": 67.14, "cnt": 32}, "fwd-compute":{"total": 1972.74, "avg": 61.65, "max": 55.48, "min": 67.01, "cnt": 32}, "batch-generator":{"total": 46.64, "avg": 1.46, "max": 0.68, "min": 4.09, "cnt": 32}, "fwd-embedding":{"total": 0.72, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1912.24, "avg": 59.76, "max": 54.33, "min": 65.01, "cnt": 32}, "fwd-layernorm":{"total": 10.33, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 113.46, "avg": 0.89, "max": 0.74, "min": 1.96, "cnt": 128}, "fwd-misc":{"total": 21.59, "avg": 0.17, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1745.07, "avg": 13.63, "max": 11.20, "min": 20.39, "cnt": 128}, "MoE_L0_fwd":{"total": 515.92, "avg": 16.12, "max": 12.99, "min": 20.24, "cnt": 32}, "MoEMLP":{"total": 1727.37, "avg": 13.50, "max": 11.07, "min": 20.16, "cnt": 128}, "MoE_L1_fwd":{"total": 420.79, "avg": 13.15, "max": 12.20, "min": 15.72, "cnt": 32}, "MoE_L2_fwd":{"total": 420.42, "avg": 13.14, "max": 12.40, "min": 14.25, "cnt": 32}, "MoE_L3_fwd":{"total": 376.69, "avg": 11.77, "max": 11.11, "min": 14.84, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.49, "avg": 0.74, "max": 0.65, "min": 0.84, "cnt": 2}, "forward-send-backward-recv":{"total": 213.48, "avg": 7.12, "max": 1.51, "min": 122.78, "cnt": 30}, "backward-compute":{"total": 1833.78, "avg": 57.31, "max": 55.44, "min": 58.38, "cnt": 32}, "MoE_L3_bwd":{"total": 394.98, "avg": 12.34, "max": 11.54, "min": 13.28, "cnt": 32}, "MoE_L2_bwd":{"total": 420.79, "avg": 13.15, "max": 12.26, "min": 14.28, "cnt": 32}, "MoE_L1_bwd":{"total": 356.27, "avg": 11.13, "max": 10.76, "min": 11.68, "cnt": 32}, "MoE_L0_bwd":{"total": 445.86, "avg": 13.93, "max": 13.34, "min": 14.81, "cnt": 32}, "backward-send-forward-recv":{"total": 1720.89, "avg": 59.34, "max": 2.37, "min": 604.88, "cnt": 29}, "backward-send":{"total": 2.76, "avg": 0.92, "max": 0.53, "min": 1.17, "cnt": 3}, "backward-recv":{"total": 192.34, "avg": 96.17, "max": 63.67, "min": 128.67, "cnt": 2}, "backward-params-all-reduce":{"total": 490.63, "avg": 490.63, "max": 490.63, "min": 490.63, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 250.46, "avg": 250.46, "max": 250.46, "min": 250.46, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 210.71, "avg": 210.71, "max": 210.71, "min": 210.71, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.26, "avg": 3.26, "max": 3.26, "min": 3.26, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 147, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 66.15, "avg": 22.05, "max": 1.05, "min": 60.05, "cnt": 3}, "forward-compute":{"total": 1939.59, "avg": 60.61, "max": 55.20, "min": 66.43, "cnt": 32}, "fwd-compute":{"total": 1936.23, "avg": 60.51, "max": 55.14, "min": 66.29, "cnt": 32}, "batch-generator":{"total": 43.36, "avg": 1.36, "max": 0.67, "min": 2.49, "cnt": 32}, "fwd-embedding":{"total": 0.72, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1880.17, "avg": 58.76, "max": 54.11, "min": 64.42, "cnt": 32}, "fwd-layernorm":{"total": 10.39, "avg": 0.08, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 112.86, "avg": 0.88, "max": 0.74, "min": 1.62, "cnt": 128}, "fwd-misc":{"total": 21.44, "avg": 0.17, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1713.68, "avg": 13.39, "max": 10.87, "min": 20.06, "cnt": 128}, "MoE_L0_fwd":{"total": 510.45, "avg": 15.95, "max": 12.97, "min": 19.98, "cnt": 32}, "MoEMLP":{"total": 1696.03, "avg": 13.25, "max": 10.76, "min": 19.93, "cnt": 128}, "MoE_L1_fwd":{"total": 410.77, "avg": 12.84, "max": 11.69, "min": 15.05, "cnt": 32}, "MoE_L2_fwd":{"total": 415.95, "avg": 13.00, "max": 12.30, "min": 14.77, "cnt": 32}, "MoE_L3_fwd":{"total": 365.23, "avg": 11.41, "max": 10.80, "min": 12.69, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.56, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.39, "avg": 0.70, "max": 0.58, "min": 0.81, "cnt": 2}, "forward-send-backward-recv":{"total": 841.67, "avg": 28.06, "max": 1.81, "min": 186.91, "cnt": 30}, "backward-compute":{"total": 1844.39, "avg": 57.64, "max": 56.13, "min": 61.23, "cnt": 32}, "MoE_L3_bwd":{"total": 398.66, "avg": 12.46, "max": 11.73, "min": 14.13, "cnt": 32}, "MoE_L2_bwd":{"total": 420.65, "avg": 13.15, "max": 12.46, "min": 16.50, "cnt": 32}, "MoE_L1_bwd":{"total": 361.71, "avg": 11.30, "max": 10.81, "min": 11.89, "cnt": 32}, "MoE_L0_bwd":{"total": 447.27, "avg": 13.98, "max": 13.55, "min": 14.87, "cnt": 32}, "backward-send-forward-recv":{"total": 1814.32, "avg": 62.56, "max": 1.58, "min": 419.05, "cnt": 29}, "backward-send":{"total": 2.43, "avg": 0.81, "max": 0.67, "min": 1.01, "cnt": 3}, "backward-recv":{"total": 125.15, "avg": 62.58, "max": 55.06, "min": 70.10, "cnt": 2}, "backward-params-all-reduce":{"total": 493.03, "avg": 493.03, "max": 493.03, "min": 493.03, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.04, "avg": 0.04, "max": 0.04, "min": 0.04, "cnt": 1}, "optimizer":{"total": 266.30, "avg": 266.30, "max": 266.30, "min": 266.30, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 226.40, "avg": 226.40, "max": 226.40, "min": 226.40, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.47, "avg": 3.47, "max": 3.47, "min": 3.47, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 148, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 66.24, "avg": 22.08, "max": 3.42, "min": 58.62, "cnt": 3}, "forward-compute":{"total": 1931.42, "avg": 60.36, "max": 53.13, "min": 73.35, "cnt": 32}, "fwd-compute":{"total": 1928.13, "avg": 60.25, "max": 53.05, "min": 73.27, "cnt": 32}, "batch-generator":{"total": 41.34, "avg": 1.29, "max": 0.64, "min": 2.22, "cnt": 32}, "fwd-embedding":{"total": 0.69, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1873.59, "avg": 58.55, "max": 52.11, "min": 70.60, "cnt": 32}, "fwd-layernorm":{"total": 10.11, "avg": 0.08, "max": 0.06, "min": 0.18, "cnt": 128}, "fwd-attn":{"total": 111.88, "avg": 0.87, "max": 0.74, "min": 1.50, "cnt": 128}, "fwd-misc":{"total": 21.31, "avg": 0.17, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1708.87, "avg": 13.35, "max": 10.64, "min": 22.55, "cnt": 128}, "MoE_L0_fwd":{"total": 512.03, "avg": 16.00, "max": 12.77, "min": 22.39, "cnt": 32}, "MoEMLP":{"total": 1691.62, "avg": 13.22, "max": 10.54, "min": 22.30, "cnt": 128}, "MoE_L1_fwd":{"total": 397.36, "avg": 12.42, "max": 11.28, "min": 16.79, "cnt": 32}, "MoE_L2_fwd":{"total": 419.61, "avg": 13.11, "max": 12.33, "min": 15.33, "cnt": 32}, "MoE_L3_fwd":{"total": 368.91, "avg": 11.53, "max": 10.58, "min": 17.35, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.57, "avg": 0.78, "max": 0.72, "min": 0.84, "cnt": 2}, "forward-send-backward-recv":{"total": 1134.35, "avg": 37.81, "max": 1.58, "min": 359.76, "cnt": 30}, "backward-compute":{"total": 1832.39, "avg": 57.26, "max": 55.08, "min": 61.26, "cnt": 32}, "MoE_L3_bwd":{"total": 394.16, "avg": 12.32, "max": 10.89, "min": 14.15, "cnt": 32}, "MoE_L2_bwd":{"total": 416.95, "avg": 13.03, "max": 12.55, "min": 13.58, "cnt": 32}, "MoE_L1_bwd":{"total": 356.88, "avg": 11.15, "max": 10.41, "min": 11.45, "cnt": 32}, "MoE_L0_bwd":{"total": 449.03, "avg": 14.03, "max": 13.50, "min": 16.47, "cnt": 32}, "backward-send-forward-recv":{"total": 2605.11, "avg": 89.83, "max": 1.52, "min": 580.98, "cnt": 29}, "backward-send":{"total": 2.58, "avg": 0.86, "max": 0.74, "min": 1.07, "cnt": 3}, "backward-recv":{"total": 216.87, "avg": 108.43, "max": 75.61, "min": 141.26, "cnt": 2}, "backward-params-all-reduce":{"total": 488.18, "avg": 488.18, "max": 488.18, "min": 488.18, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 260.88, "avg": 260.88, "max": 260.88, "min": 260.88, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 221.24, "avg": 221.24, "max": 221.24, "min": 221.24, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.24, "avg": 3.24, "max": 3.24, "min": 3.24, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 149, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.06, "avg": 0.06, "max": 0.06, "min": 0.06, "cnt": 1}, "forward-recv":{"total": 60.18, "avg": 20.06, "max": 0.92, "min": 58.02, "cnt": 3}, "forward-compute":{"total": 1938.89, "avg": 60.59, "max": 54.06, "min": 65.03, "cnt": 32}, "fwd-compute":{"total": 1935.72, "avg": 60.49, "max": 53.99, "min": 64.90, "cnt": 32}, "batch-generator":{"total": 49.94, "avg": 1.56, "max": 0.70, "min": 3.46, "cnt": 32}, "fwd-embedding":{"total": 0.66, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1873.05, "avg": 58.53, "max": 52.93, "min": 62.79, "cnt": 32}, "fwd-layernorm":{"total": 9.99, "avg": 0.08, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 111.36, "avg": 0.87, "max": 0.74, "min": 2.23, "cnt": 128}, "fwd-misc":{"total": 21.26, "avg": 0.17, "max": 0.11, "min": 0.38, "cnt": 128}, "fwd-MLP":{"total": 1709.47, "avg": 13.36, "max": 10.74, "min": 18.98, "cnt": 128}, "MoE_L0_fwd":{"total": 490.78, "avg": 15.34, "max": 12.82, "min": 18.83, "cnt": 32}, "MoEMLP":{"total": 1692.50, "avg": 13.22, "max": 10.64, "min": 18.75, "cnt": 128}, "MoE_L1_fwd":{"total": 416.07, "avg": 13.00, "max": 11.71, "min": 16.15, "cnt": 32}, "MoE_L2_fwd":{"total": 429.32, "avg": 13.42, "max": 12.48, "min": 15.34, "cnt": 32}, "MoE_L3_fwd":{"total": 362.53, "avg": 11.33, "max": 10.68, "min": 13.42, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 3.78, "avg": 1.89, "max": 0.79, "min": 2.99, "cnt": 2}, "forward-send-backward-recv":{"total": 186.24, "avg": 6.21, "max": 1.61, "min": 119.64, "cnt": 30}, "backward-compute":{"total": 1841.86, "avg": 57.56, "max": 55.12, "min": 60.30, "cnt": 32}, "MoE_L3_bwd":{"total": 391.00, "avg": 12.22, "max": 11.61, "min": 14.91, "cnt": 32}, "MoE_L2_bwd":{"total": 417.48, "avg": 13.05, "max": 12.57, "min": 13.41, "cnt": 32}, "MoE_L1_bwd":{"total": 366.51, "avg": 11.45, "max": 11.03, "min": 12.31, "cnt": 32}, "MoE_L0_bwd":{"total": 449.91, "avg": 14.06, "max": 13.23, "min": 14.52, "cnt": 32}, "backward-send-forward-recv":{"total": 2831.09, "avg": 97.62, "max": 2.33, "min": 388.50, "cnt": 29}, "backward-send":{"total": 3.59, "avg": 1.20, "max": 0.97, "min": 1.63, "cnt": 3}, "backward-recv":{"total": 137.23, "avg": 68.61, "max": 63.90, "min": 73.33, "cnt": 2}, "backward-params-all-reduce":{"total": 485.60, "avg": 485.60, "max": 485.60, "min": 485.60, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 254.30, "avg": 254.30, "max": 254.30, "min": 254.30, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 214.53, "avg": 214.53, "max": 214.53, "min": 214.53, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.32, "avg": 3.32, "max": 3.32, "min": 3.32, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 150, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.10, "avg": 0.10, "max": 0.10, "min": 0.10, "cnt": 1}, "forward-recv":{"total": 73.29, "avg": 24.43, "max": 0.90, "min": 71.43, "cnt": 3}, "forward-compute":{"total": 1920.20, "avg": 60.01, "max": 54.68, "min": 64.83, "cnt": 32}, "fwd-compute":{"total": 1917.05, "avg": 59.91, "max": 54.59, "min": 64.75, "cnt": 32}, "batch-generator":{"total": 42.62, "avg": 1.33, "max": 0.68, "min": 3.02, "cnt": 32}, "fwd-embedding":{"total": 0.65, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1861.41, "avg": 58.17, "max": 52.75, "min": 63.44, "cnt": 32}, "fwd-layernorm":{"total": 9.78, "avg": 0.08, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 108.81, "avg": 0.85, "max": 0.75, "min": 1.52, "cnt": 128}, "fwd-misc":{"total": 21.23, "avg": 0.17, "max": 0.11, "min": 0.40, "cnt": 128}, "fwd-MLP":{"total": 1700.66, "avg": 13.29, "max": 10.90, "min": 20.74, "cnt": 128}, "MoE_L0_fwd":{"total": 500.70, "avg": 15.65, "max": 12.88, "min": 20.49, "cnt": 32}, "MoEMLP":{"total": 1683.49, "avg": 13.15, "max": 10.78, "min": 20.45, "cnt": 128}, "MoE_L1_fwd":{"total": 398.71, "avg": 12.46, "max": 11.39, "min": 17.19, "cnt": 32}, "MoE_L2_fwd":{"total": 414.46, "avg": 12.95, "max": 12.09, "min": 16.50, "cnt": 32}, "MoE_L3_fwd":{"total": 375.87, "avg": 11.75, "max": 10.82, "min": 14.53, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.52, "avg": 0.76, "max": 0.70, "min": 0.82, "cnt": 2}, "forward-send-backward-recv":{"total": 193.32, "avg": 6.44, "max": 1.28, "min": 111.10, "cnt": 30}, "backward-compute":{"total": 1847.07, "avg": 57.72, "max": 56.36, "min": 61.57, "cnt": 32}, "MoE_L3_bwd":{"total": 397.00, "avg": 12.41, "max": 11.75, "min": 15.48, "cnt": 32}, "MoE_L2_bwd":{"total": 423.69, "avg": 13.24, "max": 12.02, "min": 16.81, "cnt": 32}, "MoE_L1_bwd":{"total": 361.93, "avg": 11.31, "max": 10.61, "min": 11.83, "cnt": 32}, "MoE_L0_bwd":{"total": 447.06, "avg": 13.97, "max": 13.62, "min": 14.42, "cnt": 32}, "backward-send-forward-recv":{"total": 2255.42, "avg": 77.77, "max": 2.19, "min": 310.54, "cnt": 29}, "backward-send":{"total": 1.91, "avg": 0.64, "max": 0.54, "min": 0.83, "cnt": 3}, "backward-recv":{"total": 446.88, "avg": 223.44, "max": 59.02, "min": 387.86, "cnt": 2}, "backward-params-all-reduce":{"total": 488.75, "avg": 488.75, "max": 488.75, "min": 488.75, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 253.05, "avg": 253.05, "max": 253.05, "min": 253.05, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 213.32, "avg": 213.32, "max": 213.32, "min": 213.32, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.31, "avg": 3.31, "max": 3.31, "min": 3.31, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}}}
{"type":"time", "iteration": 151, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 60.73, "avg": 20.24, "max": 0.96, "min": 58.50, "cnt": 3}, "forward-compute":{"total": 1959.71, "avg": 61.24, "max": 54.00, "min": 127.42, "cnt": 32}, "fwd-compute":{"total": 1956.73, "avg": 61.15, "max": 53.93, "min": 127.35, "cnt": 32}, "batch-generator":{"total": 42.45, "avg": 1.33, "max": 0.65, "min": 5.48, "cnt": 32}, "fwd-embedding":{"total": 0.64, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1901.95, "avg": 59.44, "max": 52.92, "min": 126.12, "cnt": 32}, "fwd-layernorm":{"total": 9.60, "avg": 0.07, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 109.55, "avg": 0.86, "max": 0.75, "min": 1.57, "cnt": 128}, "fwd-misc":{"total": 20.74, "avg": 0.16, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1741.57, "avg": 13.61, "max": 10.49, "min": 82.94, "cnt": 128}, "MoE_L0_fwd":{"total": 503.55, "avg": 15.74, "max": 13.21, "min": 21.60, "cnt": 32}, "MoEMLP":{"total": 1724.80, "avg": 13.48, "max": 10.38, "min": 82.81, "cnt": 128}, "MoE_L1_fwd":{"total": 384.35, "avg": 12.01, "max": 11.21, "min": 12.80, "cnt": 32}, "MoE_L2_fwd":{"total": 481.95, "avg": 15.06, "max": 12.07, "min": 82.86, "cnt": 32}, "MoE_L3_fwd":{"total": 361.10, "avg": 11.28, "max": 10.42, "min": 15.68, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.60, "avg": 0.80, "max": 0.74, "min": 0.86, "cnt": 2}, "forward-send-backward-recv":{"total": 430.28, "avg": 14.34, "max": 1.28, "min": 138.38, "cnt": 30}, "backward-compute":{"total": 1822.19, "avg": 56.94, "max": 55.56, "min": 58.10, "cnt": 32}, "MoE_L3_bwd":{"total": 385.70, "avg": 12.05, "max": 11.07, "min": 12.98, "cnt": 32}, "MoE_L2_bwd":{"total": 415.13, "avg": 12.97, "max": 12.23, "min": 13.75, "cnt": 32}, "MoE_L1_bwd":{"total": 355.37, "avg": 11.11, "max": 10.55, "min": 11.74, "cnt": 32}, "MoE_L0_bwd":{"total": 451.16, "avg": 14.10, "max": 13.64, "min": 14.51, "cnt": 32}, "backward-send-forward-recv":{"total": 2518.41, "avg": 86.84, "max": 1.86, "min": 1052.44, "cnt": 29}, "backward-send":{"total": 3.20, "avg": 1.07, "max": 0.95, "min": 1.19, "cnt": 3}, "backward-recv":{"total": 114.39, "avg": 57.19, "max": 51.62, "min": 62.77, "cnt": 2}, "backward-params-all-reduce":{"total": 492.55, "avg": 492.55, "max": 492.55, "min": 492.55, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 261.73, "avg": 261.73, "max": 261.73, "min": 261.73, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 221.87, "avg": 221.87, "max": 221.87, "min": 221.87, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.25, "avg": 3.25, "max": 3.25, "min": 3.25, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.49, "avg": 3.49, "max": 3.49, "min": 3.49, "cnt": 1}}}
{"type":"time", "iteration": 152, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 58.14, "avg": 19.38, "max": 0.96, "min": 56.02, "cnt": 3}, "forward-compute":{"total": 1903.24, "avg": 59.48, "max": 54.45, "min": 68.39, "cnt": 32}, "fwd-compute":{"total": 1899.93, "avg": 59.37, "max": 54.38, "min": 68.25, "cnt": 32}, "batch-generator":{"total": 42.59, "avg": 1.33, "max": 0.71, "min": 2.26, "cnt": 32}, "fwd-embedding":{"total": 0.73, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1843.97, "avg": 57.62, "max": 53.34, "min": 66.27, "cnt": 32}, "fwd-layernorm":{"total": 10.56, "avg": 0.08, "max": 0.06, "min": 0.22, "cnt": 128}, "fwd-attn":{"total": 114.91, "avg": 0.90, "max": 0.74, "min": 1.84, "cnt": 128}, "fwd-misc":{"total": 22.34, "avg": 0.17, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1673.84, "avg": 13.08, "max": 10.56, "min": 18.85, "cnt": 128}, "MoE_L0_fwd":{"total": 501.08, "avg": 15.66, "max": 13.05, "min": 18.76, "cnt": 32}, "MoEMLP":{"total": 1655.52, "avg": 12.93, "max": 10.44, "min": 18.72, "cnt": 128}, "MoE_L1_fwd":{"total": 392.93, "avg": 12.28, "max": 11.52, "min": 14.83, "cnt": 32}, "MoE_L2_fwd":{"total": 409.53, "avg": 12.80, "max": 11.92, "min": 15.67, "cnt": 32}, "MoE_L3_fwd":{"total": 358.64, "avg": 11.21, "max": 10.50, "min": 13.90, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.56, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.68, "avg": 0.84, "max": 0.80, "min": 0.88, "cnt": 2}, "forward-send-backward-recv":{"total": 252.39, "avg": 8.41, "max": 1.32, "min": 119.54, "cnt": 30}, "backward-compute":{"total": 1814.57, "avg": 56.71, "max": 55.59, "min": 59.04, "cnt": 32}, "MoE_L3_bwd":{"total": 378.27, "avg": 11.82, "max": 10.99, "min": 12.77, "cnt": 32}, "MoE_L2_bwd":{"total": 413.18, "avg": 12.91, "max": 12.18, "min": 15.16, "cnt": 32}, "MoE_L1_bwd":{"total": 356.68, "avg": 11.15, "max": 10.76, "min": 11.57, "cnt": 32}, "MoE_L0_bwd":{"total": 451.22, "avg": 14.10, "max": 13.57, "min": 14.67, "cnt": 32}, "backward-send-forward-recv":{"total": 1092.95, "avg": 37.69, "max": 2.38, "min": 150.35, "cnt": 29}, "backward-send":{"total": 3.18, "avg": 1.06, "max": 1.02, "min": 1.09, "cnt": 3}, "backward-recv":{"total": 122.17, "avg": 61.09, "max": 52.02, "min": 70.16, "cnt": 2}, "backward-params-all-reduce":{"total": 484.81, "avg": 484.81, "max": 484.81, "min": 484.81, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 255.77, "avg": 255.77, "max": 255.77, "min": 255.77, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 216.03, "avg": 216.03, "max": 216.03, "min": 216.03, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.26, "avg": 3.26, "max": 3.26, "min": 3.26, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 153, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.06, "avg": 0.06, "max": 0.06, "min": 0.06, "cnt": 1}, "forward-recv":{"total": 59.84, "avg": 19.95, "max": 0.92, "min": 57.68, "cnt": 3}, "forward-compute":{"total": 1919.57, "avg": 59.99, "max": 53.50, "min": 65.45, "cnt": 32}, "fwd-compute":{"total": 1916.37, "avg": 59.89, "max": 53.43, "min": 65.31, "cnt": 32}, "batch-generator":{"total": 43.18, "avg": 1.35, "max": 0.68, "min": 2.62, "cnt": 32}, "fwd-embedding":{"total": 0.72, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1860.17, "avg": 58.13, "max": 52.22, "min": 63.18, "cnt": 32}, "fwd-layernorm":{"total": 10.14, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 112.03, "avg": 0.88, "max": 0.75, "min": 2.42, "cnt": 128}, "fwd-misc":{"total": 21.58, "avg": 0.17, "max": 0.11, "min": 0.39, "cnt": 128}, "fwd-MLP":{"total": 1695.14, "avg": 13.24, "max": 10.64, "min": 22.62, "cnt": 128}, "MoE_L0_fwd":{"total": 523.78, "avg": 16.37, "max": 12.96, "min": 22.50, "cnt": 32}, "MoEMLP":{"total": 1677.90, "avg": 13.11, "max": 10.51, "min": 22.46, "cnt": 128}, "MoE_L1_fwd":{"total": 387.74, "avg": 12.12, "max": 11.30, "min": 15.13, "cnt": 32}, "MoE_L2_fwd":{"total": 406.68, "avg": 12.71, "max": 12.03, "min": 13.99, "cnt": 32}, "MoE_L3_fwd":{"total": 365.94, "avg": 11.44, "max": 10.56, "min": 15.98, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 3.80, "avg": 1.90, "max": 0.91, "min": 2.90, "cnt": 2}, "forward-send-backward-recv":{"total": 640.20, "avg": 21.34, "max": 1.45, "min": 223.54, "cnt": 30}, "backward-compute":{"total": 1820.50, "avg": 56.89, "max": 55.01, "min": 59.78, "cnt": 32}, "MoE_L3_bwd":{"total": 391.40, "avg": 12.23, "max": 11.29, "min": 14.47, "cnt": 32}, "MoE_L2_bwd":{"total": 406.39, "avg": 12.70, "max": 11.49, "min": 14.14, "cnt": 32}, "MoE_L1_bwd":{"total": 352.05, "avg": 11.00, "max": 10.47, "min": 11.28, "cnt": 32}, "MoE_L0_bwd":{"total": 456.50, "avg": 14.27, "max": 13.83, "min": 14.72, "cnt": 32}, "backward-send-forward-recv":{"total": 1489.95, "avg": 51.38, "max": 1.93, "min": 304.06, "cnt": 29}, "backward-send":{"total": 2.32, "avg": 0.77, "max": 0.69, "min": 0.84, "cnt": 3}, "backward-recv":{"total": 150.34, "avg": 75.17, "max": 67.64, "min": 82.69, "cnt": 2}, "backward-params-all-reduce":{"total": 485.45, "avg": 485.45, "max": 485.45, "min": 485.45, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 255.39, "avg": 255.39, "max": 255.39, "min": 255.39, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 215.76, "avg": 215.76, "max": 215.76, "min": 215.76, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.25, "avg": 3.25, "max": 3.25, "min": 3.25, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 154, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.06, "avg": 0.06, "max": 0.06, "min": 0.06, "cnt": 1}, "forward-recv":{"total": 59.79, "avg": 19.93, "max": 1.01, "min": 57.65, "cnt": 3}, "forward-compute":{"total": 1904.24, "avg": 59.51, "max": 54.60, "min": 67.07, "cnt": 32}, "fwd-compute":{"total": 1901.10, "avg": 59.41, "max": 54.52, "min": 66.95, "cnt": 32}, "batch-generator":{"total": 36.67, "avg": 1.15, "max": 0.68, "min": 1.69, "cnt": 32}, "fwd-embedding":{"total": 0.75, "avg": 0.02, "max": 0.01, "min": 0.14, "cnt": 32}, "fwd-encoder":{"total": 1851.78, "avg": 57.87, "max": 53.37, "min": 65.22, "cnt": 32}, "fwd-layernorm":{"total": 9.54, "avg": 0.07, "max": 0.05, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 109.23, "avg": 0.85, "max": 0.74, "min": 2.05, "cnt": 128}, "fwd-misc":{"total": 21.09, "avg": 0.16, "max": 0.11, "min": 0.58, "cnt": 128}, "fwd-MLP":{"total": 1691.02, "avg": 13.21, "max": 10.45, "min": 19.99, "cnt": 128}, "MoE_L0_fwd":{"total": 525.41, "avg": 16.42, "max": 13.81, "min": 19.89, "cnt": 32}, "MoEMLP":{"total": 1674.00, "avg": 13.08, "max": 10.35, "min": 19.84, "cnt": 128}, "MoE_L1_fwd":{"total": 386.76, "avg": 12.09, "max": 11.11, "min": 15.29, "cnt": 32}, "MoE_L2_fwd":{"total": 408.03, "avg": 12.75, "max": 11.93, "min": 14.20, "cnt": 32}, "MoE_L3_fwd":{"total": 359.99, "avg": 11.25, "max": 10.39, "min": 15.74, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.56, "avg": 0.78, "max": 0.70, "min": 0.86, "cnt": 2}, "forward-send-backward-recv":{"total": 444.30, "avg": 14.81, "max": 1.44, "min": 125.50, "cnt": 30}, "backward-compute":{"total": 1795.76, "avg": 56.12, "max": 53.31, "min": 58.01, "cnt": 32}, "MoE_L3_bwd":{"total": 384.42, "avg": 12.01, "max": 11.36, "min": 12.89, "cnt": 32}, "MoE_L2_bwd":{"total": 402.91, "avg": 12.59, "max": 11.66, "min": 13.14, "cnt": 32}, "MoE_L1_bwd":{"total": 342.03, "avg": 10.69, "max": 10.14, "min": 11.11, "cnt": 32}, "MoE_L0_bwd":{"total": 449.75, "avg": 14.05, "max": 13.50, "min": 14.42, "cnt": 32}, "backward-send-forward-recv":{"total": 1110.98, "avg": 38.31, "max": 1.56, "min": 218.13, "cnt": 29}, "backward-send":{"total": 2.37, "avg": 0.79, "max": 0.49, "min": 1.02, "cnt": 3}, "backward-recv":{"total": 218.86, "avg": 109.43, "max": 54.60, "min": 164.26, "cnt": 2}, "backward-params-all-reduce":{"total": 485.48, "avg": 485.48, "max": 485.48, "min": 485.48, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 253.48, "avg": 253.48, "max": 253.48, "min": 253.48, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 213.80, "avg": 213.80, "max": 213.80, "min": 213.80, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.27, "avg": 3.27, "max": 3.27, "min": 3.27, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 155, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 67.71, "avg": 22.57, "max": 0.83, "min": 65.41, "cnt": 3}, "forward-compute":{"total": 1923.83, "avg": 60.12, "max": 52.68, "min": 66.02, "cnt": 32}, "fwd-compute":{"total": 1920.43, "avg": 60.01, "max": 52.61, "min": 65.94, "cnt": 32}, "batch-generator":{"total": 46.73, "avg": 1.46, "max": 0.63, "min": 3.74, "cnt": 32}, "fwd-embedding":{"total": 0.77, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1860.83, "avg": 58.15, "max": 51.60, "min": 63.76, "cnt": 32}, "fwd-layernorm":{"total": 10.38, "avg": 0.08, "max": 0.06, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 113.27, "avg": 0.88, "max": 0.74, "min": 2.83, "cnt": 128}, "fwd-misc":{"total": 21.26, "avg": 0.17, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1694.90, "avg": 13.24, "max": 10.49, "min": 19.06, "cnt": 128}, "MoE_L0_fwd":{"total": 519.52, "avg": 16.24, "max": 12.61, "min": 18.97, "cnt": 32}, "MoEMLP":{"total": 1677.76, "avg": 13.11, "max": 10.39, "min": 18.92, "cnt": 128}, "MoE_L1_fwd":{"total": 391.52, "avg": 12.23, "max": 11.30, "min": 16.82, "cnt": 32}, "MoE_L2_fwd":{"total": 411.57, "avg": 12.86, "max": 11.94, "min": 17.16, "cnt": 32}, "MoE_L3_fwd":{"total": 361.47, "avg": 11.30, "max": 10.42, "min": 14.02, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.55, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 16.31, "avg": 8.15, "max": 0.77, "min": 15.53, "cnt": 2}, "forward-send-backward-recv":{"total": 688.03, "avg": 22.93, "max": 1.56, "min": 183.87, "cnt": 30}, "backward-compute":{"total": 1793.57, "avg": 56.05, "max": 54.14, "min": 58.01, "cnt": 32}, "MoE_L3_bwd":{"total": 385.92, "avg": 12.06, "max": 11.29, "min": 14.11, "cnt": 32}, "MoE_L2_bwd":{"total": 398.13, "avg": 12.44, "max": 11.86, "min": 13.45, "cnt": 32}, "MoE_L1_bwd":{"total": 345.84, "avg": 10.81, "max": 10.01, "min": 11.65, "cnt": 32}, "MoE_L0_bwd":{"total": 448.55, "avg": 14.02, "max": 13.34, "min": 15.57, "cnt": 32}, "backward-send-forward-recv":{"total": 3549.00, "avg": 122.38, "max": 1.78, "min": 1071.93, "cnt": 29}, "backward-send":{"total": 2.75, "avg": 0.92, "max": 0.56, "min": 1.12, "cnt": 3}, "backward-recv":{"total": 175.35, "avg": 87.67, "max": 67.79, "min": 107.55, "cnt": 2}, "backward-params-all-reduce":{"total": 495.64, "avg": 495.64, "max": 495.64, "min": 495.64, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 248.62, "avg": 248.62, "max": 248.62, "min": 248.62, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 204.52, "avg": 204.52, "max": 204.52, "min": 204.52, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.86, "avg": 6.86, "max": 6.86, "min": 6.86, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}}}
{"type":"time", "iteration": 156, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 63.78, "avg": 21.26, "max": 1.18, "min": 57.37, "cnt": 3}, "forward-compute":{"total": 1907.55, "avg": 59.61, "max": 52.49, "min": 65.12, "cnt": 32}, "fwd-compute":{"total": 1904.30, "avg": 59.51, "max": 52.42, "min": 65.04, "cnt": 32}, "batch-generator":{"total": 50.79, "avg": 1.59, "max": 0.69, "min": 3.60, "cnt": 32}, "fwd-embedding":{"total": 0.67, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1840.89, "avg": 57.53, "max": 51.44, "min": 62.59, "cnt": 32}, "fwd-layernorm":{"total": 9.80, "avg": 0.08, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 109.71, "avg": 0.86, "max": 0.74, "min": 1.97, "cnt": 128}, "fwd-misc":{"total": 20.61, "avg": 0.16, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1680.35, "avg": 13.13, "max": 10.42, "min": 19.44, "cnt": 128}, "MoE_L0_fwd":{"total": 508.05, "avg": 15.88, "max": 13.03, "min": 19.35, "cnt": 32}, "MoEMLP":{"total": 1663.86, "avg": 13.00, "max": 10.31, "min": 19.30, "cnt": 128}, "MoE_L1_fwd":{"total": 385.10, "avg": 12.03, "max": 10.69, "min": 15.12, "cnt": 32}, "MoE_L2_fwd":{"total": 418.06, "avg": 13.06, "max": 12.07, "min": 15.87, "cnt": 32}, "MoE_L3_fwd":{"total": 358.75, "avg": 11.21, "max": 10.35, "min": 12.25, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.73, "avg": 0.87, "max": 0.83, "min": 0.90, "cnt": 2}, "forward-send-backward-recv":{"total": 179.92, "avg": 6.00, "max": 1.79, "min": 115.58, "cnt": 30}, "backward-compute":{"total": 1777.19, "avg": 55.54, "max": 52.96, "min": 56.36, "cnt": 32}, "MoE_L3_bwd":{"total": 381.92, "avg": 11.93, "max": 11.40, "min": 12.63, "cnt": 32}, "MoE_L2_bwd":{"total": 398.45, "avg": 12.45, "max": 11.87, "min": 13.31, "cnt": 32}, "MoE_L1_bwd":{"total": 330.95, "avg": 10.34, "max": 9.85, "min": 10.99, "cnt": 32}, "MoE_L0_bwd":{"total": 450.40, "avg": 14.08, "max": 13.31, "min": 14.57, "cnt": 32}, "backward-send-forward-recv":{"total": 2051.01, "avg": 70.72, "max": 1.76, "min": 291.72, "cnt": 29}, "backward-send":{"total": 2.72, "avg": 0.91, "max": 0.63, "min": 1.19, "cnt": 3}, "backward-recv":{"total": 134.16, "avg": 67.08, "max": 63.41, "min": 70.76, "cnt": 2}, "backward-params-all-reduce":{"total": 485.72, "avg": 485.72, "max": 485.72, "min": 485.72, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 260.85, "avg": 260.85, "max": 260.85, "min": 260.85, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 216.86, "avg": 216.86, "max": 216.86, "min": 216.86, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.76, "avg": 6.76, "max": 6.76, "min": 6.76, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 157, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.06, "avg": 0.06, "max": 0.06, "min": 0.06, "cnt": 1}, "forward-recv":{"total": 67.80, "avg": 22.60, "max": 1.12, "min": 59.27, "cnt": 3}, "forward-compute":{"total": 1870.08, "avg": 58.44, "max": 53.72, "min": 68.82, "cnt": 32}, "fwd-compute":{"total": 1866.97, "avg": 58.34, "max": 53.65, "min": 68.74, "cnt": 32}, "batch-generator":{"total": 36.88, "avg": 1.15, "max": 0.70, "min": 2.12, "cnt": 32}, "fwd-embedding":{"total": 0.62, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1817.45, "avg": 56.80, "max": 52.47, "min": 67.46, "cnt": 32}, "fwd-layernorm":{"total": 9.50, "avg": 0.07, "max": 0.06, "min": 0.18, "cnt": 128}, "fwd-attn":{"total": 108.36, "avg": 0.85, "max": 0.74, "min": 1.49, "cnt": 128}, "fwd-misc":{"total": 20.40, "avg": 0.16, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1658.55, "avg": 12.96, "max": 10.40, "min": 26.03, "cnt": 128}, "MoE_L0_fwd":{"total": 516.12, "avg": 16.13, "max": 12.84, "min": 25.91, "cnt": 32}, "MoEMLP":{"total": 1641.89, "avg": 12.83, "max": 10.29, "min": 25.86, "cnt": 128}, "MoE_L1_fwd":{"total": 385.73, "avg": 12.05, "max": 11.28, "min": 13.43, "cnt": 32}, "MoE_L2_fwd":{"total": 396.26, "avg": 12.38, "max": 11.41, "min": 13.54, "cnt": 32}, "MoE_L3_fwd":{"total": 349.81, "avg": 10.93, "max": 10.33, "min": 12.01, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.56, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.65, "avg": 0.83, "max": 0.80, "min": 0.85, "cnt": 2}, "forward-send-backward-recv":{"total": 250.57, "avg": 8.35, "max": 1.55, "min": 107.04, "cnt": 30}, "backward-compute":{"total": 1793.13, "avg": 56.04, "max": 54.78, "min": 58.88, "cnt": 32}, "MoE_L3_bwd":{"total": 379.58, "avg": 11.86, "max": 11.08, "min": 13.59, "cnt": 32}, "MoE_L2_bwd":{"total": 395.33, "avg": 12.35, "max": 11.80, "min": 13.19, "cnt": 32}, "MoE_L1_bwd":{"total": 347.11, "avg": 10.85, "max": 10.29, "min": 12.76, "cnt": 32}, "MoE_L0_bwd":{"total": 455.24, "avg": 14.23, "max": 13.76, "min": 15.23, "cnt": 32}, "backward-send-forward-recv":{"total": 1868.86, "avg": 64.44, "max": 2.41, "min": 401.68, "cnt": 29}, "backward-send":{"total": 2.19, "avg": 0.73, "max": 0.54, "min": 1.01, "cnt": 3}, "backward-recv":{"total": 204.32, "avg": 102.16, "max": 67.98, "min": 136.34, "cnt": 2}, "backward-params-all-reduce":{"total": 491.35, "avg": 491.35, "max": 491.35, "min": 491.35, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 254.62, "avg": 254.62, "max": 254.62, "min": 254.62, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 210.67, "avg": 210.67, "max": 210.67, "min": 210.67, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.77, "avg": 6.77, "max": 6.77, "min": 6.77, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}}}
{"type":"time", "iteration": 158, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 63.22, "avg": 21.07, "max": 0.97, "min": 59.92, "cnt": 3}, "forward-compute":{"total": 1919.73, "avg": 59.99, "max": 52.23, "min": 132.17, "cnt": 32}, "fwd-compute":{"total": 1916.62, "avg": 59.89, "max": 52.16, "min": 132.10, "cnt": 32}, "batch-generator":{"total": 38.98, "avg": 1.22, "max": 0.65, "min": 3.65, "cnt": 32}, "fwd-embedding":{"total": 0.65, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1864.84, "avg": 58.28, "max": 51.13, "min": 131.14, "cnt": 32}, "fwd-layernorm":{"total": 9.55, "avg": 0.07, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 108.66, "avg": 0.85, "max": 0.74, "min": 2.11, "cnt": 128}, "fwd-misc":{"total": 20.49, "avg": 0.16, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1705.60, "avg": 13.33, "max": 10.52, "min": 90.59, "cnt": 128}, "MoE_L0_fwd":{"total": 571.28, "avg": 17.85, "max": 13.04, "min": 90.52, "cnt": 32}, "MoEMLP":{"total": 1689.31, "avg": 13.20, "max": 10.41, "min": 90.48, "cnt": 128}, "MoE_L1_fwd":{"total": 377.06, "avg": 11.78, "max": 10.71, "min": 17.14, "cnt": 32}, "MoE_L2_fwd":{"total": 391.19, "avg": 12.22, "max": 11.41, "min": 14.35, "cnt": 32}, "MoE_L3_fwd":{"total": 355.75, "avg": 11.12, "max": 10.45, "min": 12.76, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.56, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 6.07, "avg": 3.04, "max": 0.93, "min": 5.15, "cnt": 2}, "forward-send-backward-recv":{"total": 110.18, "avg": 3.67, "max": 1.41, "min": 44.16, "cnt": 30}, "backward-compute":{"total": 1773.75, "avg": 55.43, "max": 53.55, "min": 58.59, "cnt": 32}, "MoE_L3_bwd":{"total": 383.85, "avg": 12.00, "max": 10.42, "min": 14.48, "cnt": 32}, "MoE_L2_bwd":{"total": 385.06, "avg": 12.03, "max": 11.46, "min": 13.22, "cnt": 32}, "MoE_L1_bwd":{"total": 334.14, "avg": 10.44, "max": 9.88, "min": 11.42, "cnt": 32}, "MoE_L0_bwd":{"total": 453.06, "avg": 14.16, "max": 13.55, "min": 16.55, "cnt": 32}, "backward-send-forward-recv":{"total": 2017.48, "avg": 69.57, "max": 1.64, "min": 548.44, "cnt": 29}, "backward-send":{"total": 2.73, "avg": 0.91, "max": 0.79, "min": 1.07, "cnt": 3}, "backward-recv":{"total": 135.28, "avg": 67.64, "max": 64.21, "min": 71.07, "cnt": 2}, "backward-params-all-reduce":{"total": 485.43, "avg": 485.43, "max": 485.43, "min": 485.43, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 265.46, "avg": 265.46, "max": 265.46, "min": 265.46, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 221.32, "avg": 221.32, "max": 221.32, "min": 221.32, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.76, "avg": 6.76, "max": 6.76, "min": 6.76, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 159, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 64.15, "avg": 21.38, "max": 0.84, "min": 61.10, "cnt": 3}, "forward-compute":{"total": 1877.94, "avg": 58.69, "max": 54.57, "min": 62.01, "cnt": 32}, "fwd-compute":{"total": 1874.28, "avg": 58.57, "max": 54.51, "min": 61.92, "cnt": 32}, "batch-generator":{"total": 43.84, "avg": 1.37, "max": 0.70, "min": 1.73, "cnt": 32}, "fwd-embedding":{"total": 0.83, "avg": 0.03, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1816.91, "avg": 56.78, "max": 53.51, "min": 60.67, "cnt": 32}, "fwd-layernorm":{"total": 11.20, "avg": 0.09, "max": 0.05, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 117.31, "avg": 0.92, "max": 0.74, "min": 2.10, "cnt": 128}, "fwd-misc":{"total": 23.38, "avg": 0.18, "max": 0.11, "min": 0.57, "cnt": 128}, "fwd-MLP":{"total": 1642.28, "avg": 12.83, "max": 10.43, "min": 19.46, "cnt": 128}, "MoE_L0_fwd":{"total": 513.75, "avg": 16.05, "max": 13.29, "min": 19.37, "cnt": 32}, "MoEMLP":{"total": 1623.82, "avg": 12.69, "max": 10.32, "min": 19.32, "cnt": 128}, "MoE_L1_fwd":{"total": 379.65, "avg": 11.86, "max": 11.06, "min": 13.37, "cnt": 32}, "MoE_L2_fwd":{"total": 383.98, "avg": 12.00, "max": 11.54, "min": 13.22, "cnt": 32}, "MoE_L3_fwd":{"total": 353.18, "avg": 11.04, "max": 10.36, "min": 11.72, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.54, "avg": 0.77, "max": 0.69, "min": 0.85, "cnt": 2}, "forward-send-backward-recv":{"total": 1463.51, "avg": 48.78, "max": 1.95, "min": 295.61, "cnt": 30}, "backward-compute":{"total": 1759.93, "avg": 55.00, "max": 53.75, "min": 56.60, "cnt": 32}, "MoE_L3_bwd":{"total": 386.51, "avg": 12.08, "max": 11.13, "min": 13.03, "cnt": 32}, "MoE_L2_bwd":{"total": 371.38, "avg": 11.61, "max": 10.98, "min": 12.31, "cnt": 32}, "MoE_L1_bwd":{"total": 338.80, "avg": 10.59, "max": 10.21, "min": 11.35, "cnt": 32}, "MoE_L0_bwd":{"total": 448.91, "avg": 14.03, "max": 13.65, "min": 14.89, "cnt": 32}, "backward-send-forward-recv":{"total": 565.59, "avg": 19.50, "max": 1.73, "min": 163.33, "cnt": 29}, "backward-send":{"total": 3.10, "avg": 1.03, "max": 0.91, "min": 1.10, "cnt": 3}, "backward-recv":{"total": 358.42, "avg": 179.21, "max": 72.90, "min": 285.52, "cnt": 2}, "backward-params-all-reduce":{"total": 483.58, "avg": 483.58, "max": 483.58, "min": 483.58, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 261.32, "avg": 261.32, "max": 261.32, "min": 261.32, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 221.46, "avg": 221.46, "max": 221.46, "min": 221.46, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.28, "avg": 3.28, "max": 3.28, "min": 3.28, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 160, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 70.43, "avg": 23.48, "max": 5.94, "min": 58.00, "cnt": 3}, "forward-compute":{"total": 1877.10, "avg": 58.66, "max": 54.02, "min": 66.20, "cnt": 32}, "fwd-compute":{"total": 1873.51, "avg": 58.55, "max": 53.93, "min": 66.07, "cnt": 32}, "batch-generator":{"total": 45.79, "avg": 1.43, "max": 0.69, "min": 2.64, "cnt": 32}, "fwd-embedding":{"total": 0.80, "avg": 0.03, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1813.67, "avg": 56.68, "max": 52.79, "min": 64.03, "cnt": 32}, "fwd-layernorm":{"total": 10.74, "avg": 0.08, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 113.89, "avg": 0.89, "max": 0.74, "min": 2.06, "cnt": 128}, "fwd-misc":{"total": 21.92, "avg": 0.17, "max": 0.11, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1645.16, "avg": 12.85, "max": 10.34, "min": 18.76, "cnt": 128}, "MoE_L0_fwd":{"total": 493.54, "avg": 15.42, "max": 12.82, "min": 18.67, "cnt": 32}, "MoEMLP":{"total": 1627.48, "avg": 12.71, "max": 10.23, "min": 18.62, "cnt": 128}, "MoE_L1_fwd":{"total": 384.53, "avg": 12.02, "max": 10.86, "min": 16.33, "cnt": 32}, "MoE_L2_fwd":{"total": 392.89, "avg": 12.28, "max": 11.48, "min": 15.30, "cnt": 32}, "MoE_L3_fwd":{"total": 362.94, "avg": 11.34, "max": 10.27, "min": 16.85, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.51, "avg": 0.75, "max": 0.72, "min": 0.79, "cnt": 2}, "forward-send-backward-recv":{"total": 1148.71, "avg": 38.29, "max": 1.84, "min": 237.35, "cnt": 30}, "backward-compute":{"total": 1774.08, "avg": 55.44, "max": 53.91, "min": 56.71, "cnt": 32}, "MoE_L3_bwd":{"total": 381.69, "avg": 11.93, "max": 11.17, "min": 13.07, "cnt": 32}, "MoE_L2_bwd":{"total": 385.97, "avg": 12.06, "max": 11.10, "min": 13.63, "cnt": 32}, "MoE_L1_bwd":{"total": 342.12, "avg": 10.69, "max": 10.08, "min": 12.07, "cnt": 32}, "MoE_L0_bwd":{"total": 449.94, "avg": 14.06, "max": 13.64, "min": 14.47, "cnt": 32}, "backward-send-forward-recv":{"total": 1318.03, "avg": 45.45, "max": 1.63, "min": 589.92, "cnt": 29}, "backward-send":{"total": 3.29, "avg": 1.10, "max": 1.08, "min": 1.11, "cnt": 3}, "backward-recv":{"total": 153.91, "avg": 76.95, "max": 74.52, "min": 79.39, "cnt": 2}, "backward-params-all-reduce":{"total": 490.13, "avg": 490.13, "max": 490.13, "min": 490.13, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 258.77, "avg": 258.77, "max": 258.77, "min": 258.77, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.36, "avg": 3.36, "max": 3.36, "min": 3.36, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 214.66, "avg": 214.66, "max": 214.66, "min": 214.66, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.82, "avg": 6.82, "max": 6.82, "min": 6.82, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 161, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.06, "avg": 0.06, "max": 0.06, "min": 0.06, "cnt": 1}, "forward-recv":{"total": 69.78, "avg": 23.26, "max": 0.97, "min": 60.67, "cnt": 3}, "forward-compute":{"total": 1901.74, "avg": 59.43, "max": 55.50, "min": 63.49, "cnt": 32}, "fwd-compute":{"total": 1898.25, "avg": 59.32, "max": 55.41, "min": 63.36, "cnt": 32}, "batch-generator":{"total": 46.73, "avg": 1.46, "max": 0.67, "min": 1.96, "cnt": 32}, "fwd-embedding":{"total": 0.80, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1837.53, "avg": 57.42, "max": 53.96, "min": 61.34, "cnt": 32}, "fwd-layernorm":{"total": 10.95, "avg": 0.09, "max": 0.06, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 116.98, "avg": 0.91, "max": 0.74, "min": 2.78, "cnt": 128}, "fwd-misc":{"total": 22.85, "avg": 0.18, "max": 0.11, "min": 0.47, "cnt": 128}, "fwd-MLP":{"total": 1664.27, "avg": 13.00, "max": 10.56, "min": 20.82, "cnt": 128}, "MoE_L0_fwd":{"total": 519.66, "avg": 16.24, "max": 14.00, "min": 20.71, "cnt": 32}, "MoEMLP":{"total": 1646.04, "avg": 12.86, "max": 10.44, "min": 20.67, "cnt": 128}, "MoE_L1_fwd":{"total": 387.98, "avg": 12.12, "max": 11.01, "min": 14.17, "cnt": 32}, "MoE_L2_fwd":{"total": 385.51, "avg": 12.05, "max": 11.57, "min": 12.77, "cnt": 32}, "MoE_L3_fwd":{"total": 359.55, "avg": 11.24, "max": 10.49, "min": 12.09, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.51, "avg": 0.76, "max": 0.73, "min": 0.78, "cnt": 2}, "forward-send-backward-recv":{"total": 561.64, "avg": 18.72, "max": 1.74, "min": 200.56, "cnt": 30}, "backward-compute":{"total": 1792.42, "avg": 56.01, "max": 53.06, "min": 59.85, "cnt": 32}, "MoE_L3_bwd":{"total": 390.12, "avg": 12.19, "max": 10.96, "min": 14.56, "cnt": 32}, "MoE_L2_bwd":{"total": 394.45, "avg": 12.33, "max": 11.33, "min": 13.76, "cnt": 32}, "MoE_L1_bwd":{"total": 340.32, "avg": 10.63, "max": 10.20, "min": 13.73, "cnt": 32}, "MoE_L0_bwd":{"total": 450.44, "avg": 14.08, "max": 13.28, "min": 14.69, "cnt": 32}, "backward-send-forward-recv":{"total": 978.80, "avg": 33.75, "max": 1.64, "min": 170.74, "cnt": 29}, "backward-send":{"total": 2.95, "avg": 0.98, "max": 0.91, "min": 1.12, "cnt": 3}, "backward-recv":{"total": 134.11, "avg": 67.06, "max": 66.07, "min": 68.04, "cnt": 2}, "backward-params-all-reduce":{"total": 494.12, "avg": 494.12, "max": 494.12, "min": 494.12, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 252.89, "avg": 252.89, "max": 252.89, "min": 252.89, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 208.86, "avg": 208.86, "max": 208.86, "min": 208.86, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.76, "avg": 6.76, "max": 6.76, "min": 6.76, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}}}
{"type":"time", "iteration": 162, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.06, "avg": 0.06, "max": 0.06, "min": 0.06, "cnt": 1}, "forward-recv":{"total": 62.45, "avg": 20.82, "max": 0.90, "min": 59.60, "cnt": 3}, "forward-compute":{"total": 1888.04, "avg": 59.00, "max": 53.30, "min": 66.73, "cnt": 32}, "fwd-compute":{"total": 1884.86, "avg": 58.90, "max": 53.21, "min": 66.58, "cnt": 32}, "batch-generator":{"total": 40.38, "avg": 1.26, "max": 0.67, "min": 2.38, "cnt": 32}, "fwd-embedding":{"total": 0.66, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1832.03, "avg": 57.25, "max": 52.04, "min": 64.38, "cnt": 32}, "fwd-layernorm":{"total": 9.77, "avg": 0.08, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 110.34, "avg": 0.86, "max": 0.74, "min": 1.70, "cnt": 128}, "fwd-misc":{"total": 20.61, "avg": 0.16, "max": 0.11, "min": 0.34, "cnt": 128}, "fwd-MLP":{"total": 1670.43, "avg": 13.05, "max": 10.62, "min": 21.58, "cnt": 128}, "MoE_L0_fwd":{"total": 517.82, "avg": 16.18, "max": 13.35, "min": 21.49, "cnt": 32}, "MoEMLP":{"total": 1653.71, "avg": 12.92, "max": 10.52, "min": 21.45, "cnt": 128}, "MoE_L1_fwd":{"total": 395.24, "avg": 12.35, "max": 11.28, "min": 17.28, "cnt": 32}, "MoE_L2_fwd":{"total": 383.45, "avg": 11.98, "max": 10.86, "min": 16.70, "cnt": 32}, "MoE_L3_fwd":{"total": 363.28, "avg": 11.35, "max": 10.56, "min": 14.70, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.55, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.31, "avg": 0.65, "max": 0.52, "min": 0.78, "cnt": 2}, "forward-send-backward-recv":{"total": 467.69, "avg": 15.59, "max": 1.28, "min": 130.58, "cnt": 30}, "backward-compute":{"total": 1779.32, "avg": 55.60, "max": 54.37, "min": 56.83, "cnt": 32}, "MoE_L3_bwd":{"total": 387.94, "avg": 12.12, "max": 11.05, "min": 13.70, "cnt": 32}, "MoE_L2_bwd":{"total": 381.19, "avg": 11.91, "max": 10.93, "min": 13.30, "cnt": 32}, "MoE_L1_bwd":{"total": 351.04, "avg": 10.97, "max": 10.54, "min": 11.45, "cnt": 32}, "MoE_L0_bwd":{"total": 444.86, "avg": 13.90, "max": 13.30, "min": 14.29, "cnt": 32}, "backward-send-forward-recv":{"total": 2045.29, "avg": 70.53, "max": 1.60, "min": 1041.60, "cnt": 29}, "backward-send":{"total": 3.16, "avg": 1.05, "max": 0.89, "min": 1.16, "cnt": 3}, "backward-recv":{"total": 266.47, "avg": 133.23, "max": 67.86, "min": 198.61, "cnt": 2}, "backward-params-all-reduce":{"total": 484.93, "avg": 484.93, "max": 484.93, "min": 484.93, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 262.45, "avg": 262.45, "max": 262.45, "min": 262.45, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 218.40, "avg": 218.40, "max": 218.40, "min": 218.40, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.76, "avg": 6.76, "max": 6.76, "min": 6.76, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 163, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.06, "avg": 0.06, "max": 0.06, "min": 0.06, "cnt": 1}, "forward-recv":{"total": 63.03, "avg": 21.01, "max": 0.94, "min": 60.56, "cnt": 3}, "forward-compute":{"total": 1924.55, "avg": 60.14, "max": 53.91, "min": 67.23, "cnt": 32}, "fwd-compute":{"total": 1920.81, "avg": 60.03, "max": 53.83, "min": 67.15, "cnt": 32}, "batch-generator":{"total": 49.68, "avg": 1.55, "max": 0.63, "min": 3.07, "cnt": 32}, "fwd-embedding":{"total": 0.92, "avg": 0.03, "max": 0.01, "min": 0.06, "cnt": 32}, "fwd-encoder":{"total": 1856.86, "avg": 58.03, "max": 52.77, "min": 65.90, "cnt": 32}, "fwd-layernorm":{"total": 11.31, "avg": 0.09, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 120.37, "avg": 0.94, "max": 0.75, "min": 1.57, "cnt": 128}, "fwd-misc":{"total": 23.45, "avg": 0.18, "max": 0.11, "min": 0.42, "cnt": 128}, "fwd-MLP":{"total": 1678.42, "avg": 13.11, "max": 10.61, "min": 19.47, "cnt": 128}, "MoE_L0_fwd":{"total": 518.84, "avg": 16.21, "max": 13.34, "min": 19.39, "cnt": 32}, "MoEMLP":{"total": 1659.77, "avg": 12.97, "max": 10.49, "min": 19.34, "cnt": 128}, "MoE_L1_fwd":{"total": 389.32, "avg": 12.17, "max": 11.05, "min": 15.75, "cnt": 32}, "MoE_L2_fwd":{"total": 392.95, "avg": 12.28, "max": 11.44, "min": 17.64, "cnt": 32}, "MoE_L3_fwd":{"total": 365.39, "avg": 11.42, "max": 10.53, "min": 17.04, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.41, "avg": 0.71, "max": 0.55, "min": 0.87, "cnt": 2}, "forward-send-backward-recv":{"total": 357.11, "avg": 11.90, "max": 1.41, "min": 126.77, "cnt": 30}, "backward-compute":{"total": 1772.44, "avg": 55.39, "max": 52.60, "min": 57.59, "cnt": 32}, "MoE_L3_bwd":{"total": 385.88, "avg": 12.06, "max": 11.15, "min": 13.25, "cnt": 32}, "MoE_L2_bwd":{"total": 377.67, "avg": 11.80, "max": 11.05, "min": 13.23, "cnt": 32}, "MoE_L1_bwd":{"total": 340.98, "avg": 10.66, "max": 10.14, "min": 11.88, "cnt": 32}, "MoE_L0_bwd":{"total": 452.41, "avg": 14.14, "max": 13.49, "min": 16.33, "cnt": 32}, "backward-send-forward-recv":{"total": 555.86, "avg": 19.17, "max": 1.34, "min": 179.57, "cnt": 29}, "backward-send":{"total": 2.88, "avg": 0.96, "max": 0.84, "min": 1.07, "cnt": 3}, "backward-recv":{"total": 140.33, "avg": 70.16, "max": 68.48, "min": 71.85, "cnt": 2}, "backward-params-all-reduce":{"total": 487.64, "avg": 487.64, "max": 487.64, "min": 487.64, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 255.94, "avg": 255.94, "max": 255.94, "min": 255.94, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 216.14, "avg": 216.14, "max": 216.14, "min": 216.14, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.30, "avg": 3.30, "max": 3.30, "min": 3.30, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 164, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.06, "avg": 0.06, "max": 0.06, "min": 0.06, "cnt": 1}, "forward-recv":{"total": 172.24, "avg": 57.41, "max": 0.91, "min": 104.98, "cnt": 3}, "forward-compute":{"total": 1911.21, "avg": 59.73, "max": 53.27, "min": 64.71, "cnt": 32}, "fwd-compute":{"total": 1907.63, "avg": 59.61, "max": 53.20, "min": 64.60, "cnt": 32}, "batch-generator":{"total": 45.50, "avg": 1.42, "max": 0.68, "min": 2.91, "cnt": 32}, "fwd-embedding":{"total": 0.81, "avg": 0.03, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1848.88, "avg": 57.78, "max": 52.09, "min": 63.07, "cnt": 32}, "fwd-layernorm":{"total": 10.72, "avg": 0.08, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 114.58, "avg": 0.90, "max": 0.74, "min": 1.49, "cnt": 128}, "fwd-misc":{"total": 22.17, "avg": 0.17, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1679.55, "avg": 13.12, "max": 10.54, "min": 20.72, "cnt": 128}, "MoE_L0_fwd":{"total": 529.39, "avg": 16.54, "max": 13.67, "min": 20.63, "cnt": 32}, "MoEMLP":{"total": 1661.89, "avg": 12.98, "max": 10.43, "min": 20.58, "cnt": 128}, "MoE_L1_fwd":{"total": 388.61, "avg": 12.14, "max": 11.25, "min": 12.84, "cnt": 32}, "MoE_L2_fwd":{"total": 378.30, "avg": 11.82, "max": 11.28, "min": 13.00, "cnt": 32}, "MoE_L3_fwd":{"total": 372.02, "avg": 11.63, "max": 10.47, "min": 15.40, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.27, "avg": 0.64, "max": 0.50, "min": 0.77, "cnt": 2}, "forward-send-backward-recv":{"total": 399.94, "avg": 13.33, "max": 1.40, "min": 96.64, "cnt": 30}, "backward-compute":{"total": 1769.09, "avg": 55.28, "max": 53.99, "min": 56.51, "cnt": 32}, "MoE_L3_bwd":{"total": 388.65, "avg": 12.15, "max": 11.10, "min": 13.30, "cnt": 32}, "MoE_L2_bwd":{"total": 373.09, "avg": 11.66, "max": 10.74, "min": 12.87, "cnt": 32}, "MoE_L1_bwd":{"total": 340.11, "avg": 10.63, "max": 10.03, "min": 11.52, "cnt": 32}, "MoE_L0_bwd":{"total": 450.20, "avg": 14.07, "max": 13.63, "min": 14.85, "cnt": 32}, "backward-send-forward-recv":{"total": 1224.03, "avg": 42.21, "max": 1.94, "min": 548.85, "cnt": 29}, "backward-send":{"total": 3.06, "avg": 1.02, "max": 0.94, "min": 1.09, "cnt": 3}, "backward-recv":{"total": 197.95, "avg": 98.97, "max": 69.74, "min": 128.20, "cnt": 2}, "backward-params-all-reduce":{"total": 485.40, "avg": 485.40, "max": 485.40, "min": 485.40, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 255.24, "avg": 255.24, "max": 255.24, "min": 255.24, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 215.46, "avg": 215.46, "max": 215.46, "min": 215.46, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.29, "avg": 3.29, "max": 3.29, "min": 3.29, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 165, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 64.06, "avg": 21.35, "max": 0.79, "min": 62.24, "cnt": 3}, "forward-compute":{"total": 1844.92, "avg": 57.65, "max": 52.51, "min": 63.93, "cnt": 32}, "fwd-compute":{"total": 1841.76, "avg": 57.56, "max": 52.45, "min": 63.85, "cnt": 32}, "batch-generator":{"total": 43.97, "avg": 1.37, "max": 0.68, "min": 2.50, "cnt": 32}, "fwd-embedding":{"total": 0.68, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1785.34, "avg": 55.79, "max": 51.41, "min": 62.16, "cnt": 32}, "fwd-layernorm":{"total": 9.99, "avg": 0.08, "max": 0.05, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 112.99, "avg": 0.88, "max": 0.74, "min": 2.57, "cnt": 128}, "fwd-misc":{"total": 20.82, "avg": 0.16, "max": 0.11, "min": 0.38, "cnt": 128}, "fwd-MLP":{"total": 1620.61, "avg": 12.66, "max": 10.54, "min": 20.77, "cnt": 128}, "MoE_L0_fwd":{"total": 501.79, "avg": 15.68, "max": 13.39, "min": 20.67, "cnt": 32}, "MoEMLP":{"total": 1603.67, "avg": 12.53, "max": 10.42, "min": 20.62, "cnt": 128}, "MoE_L1_fwd":{"total": 378.18, "avg": 11.82, "max": 10.99, "min": 13.72, "cnt": 32}, "MoE_L2_fwd":{"total": 372.14, "avg": 11.63, "max": 11.14, "min": 13.04, "cnt": 32}, "MoE_L3_fwd":{"total": 357.74, "avg": 11.18, "max": 10.46, "min": 12.35, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 10.97, "avg": 5.48, "max": 0.92, "min": 10.04, "cnt": 2}, "forward-send-backward-recv":{"total": 184.49, "avg": 6.15, "max": 1.13, "min": 116.41, "cnt": 30}, "backward-compute":{"total": 1767.24, "avg": 55.23, "max": 53.17, "min": 58.79, "cnt": 32}, "MoE_L3_bwd":{"total": 395.87, "avg": 12.37, "max": 11.50, "min": 15.51, "cnt": 32}, "MoE_L2_bwd":{"total": 366.56, "avg": 11.45, "max": 10.59, "min": 12.14, "cnt": 32}, "MoE_L1_bwd":{"total": 345.06, "avg": 10.78, "max": 10.39, "min": 11.55, "cnt": 32}, "MoE_L0_bwd":{"total": 445.98, "avg": 13.94, "max": 13.39, "min": 14.29, "cnt": 32}, "backward-send-forward-recv":{"total": 3346.18, "avg": 115.39, "max": 2.43, "min": 654.67, "cnt": 29}, "backward-send":{"total": 2.86, "avg": 0.95, "max": 0.87, "min": 1.07, "cnt": 3}, "backward-recv":{"total": 147.36, "avg": 73.68, "max": 70.27, "min": 77.09, "cnt": 2}, "backward-params-all-reduce":{"total": 489.82, "avg": 489.82, "max": 489.82, "min": 489.82, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 261.65, "avg": 261.65, "max": 261.65, "min": 261.65, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 217.60, "avg": 217.60, "max": 217.60, "min": 217.60, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.72, "avg": 6.72, "max": 6.72, "min": 6.72, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 166, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.06, "avg": 0.06, "max": 0.06, "min": 0.06, "cnt": 1}, "forward-recv":{"total": 59.07, "avg": 19.69, "max": 0.95, "min": 57.13, "cnt": 3}, "forward-compute":{"total": 1839.17, "avg": 57.47, "max": 53.22, "min": 62.89, "cnt": 32}, "fwd-compute":{"total": 1836.14, "avg": 57.38, "max": 53.15, "min": 62.79, "cnt": 32}, "batch-generator":{"total": 45.28, "avg": 1.41, "max": 0.66, "min": 3.36, "cnt": 32}, "fwd-embedding":{"total": 0.63, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1778.26, "avg": 55.57, "max": 51.45, "min": 61.24, "cnt": 32}, "fwd-layernorm":{"total": 9.72, "avg": 0.08, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 108.06, "avg": 0.84, "max": 0.74, "min": 2.97, "cnt": 128}, "fwd-misc":{"total": 20.59, "avg": 0.16, "max": 0.11, "min": 0.54, "cnt": 128}, "fwd-MLP":{"total": 1619.51, "avg": 12.65, "max": 10.66, "min": 20.32, "cnt": 128}, "MoE_L0_fwd":{"total": 501.15, "avg": 15.66, "max": 13.19, "min": 20.22, "cnt": 32}, "MoEMLP":{"total": 1602.98, "avg": 12.52, "max": 10.56, "min": 20.16, "cnt": 128}, "MoE_L1_fwd":{"total": 378.98, "avg": 11.84, "max": 10.92, "min": 13.33, "cnt": 32}, "MoE_L2_fwd":{"total": 365.92, "avg": 11.44, "max": 10.87, "min": 12.68, "cnt": 32}, "MoE_L3_fwd":{"total": 362.96, "avg": 11.34, "max": 10.60, "min": 15.31, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.56, "avg": 0.78, "max": 0.78, "min": 0.78, "cnt": 2}, "forward-send-backward-recv":{"total": 442.66, "avg": 14.76, "max": 1.78, "min": 204.94, "cnt": 30}, "backward-compute":{"total": 1773.15, "avg": 55.41, "max": 53.29, "min": 58.19, "cnt": 32}, "MoE_L3_bwd":{"total": 392.35, "avg": 12.26, "max": 11.09, "min": 15.29, "cnt": 32}, "MoE_L2_bwd":{"total": 369.81, "avg": 11.56, "max": 10.71, "min": 12.55, "cnt": 32}, "MoE_L1_bwd":{"total": 347.94, "avg": 10.87, "max": 10.44, "min": 11.69, "cnt": 32}, "MoE_L0_bwd":{"total": 446.13, "avg": 13.94, "max": 13.50, "min": 14.32, "cnt": 32}, "backward-send-forward-recv":{"total": 3463.12, "avg": 119.42, "max": 2.13, "min": 818.96, "cnt": 29}, "backward-send":{"total": 2.94, "avg": 0.98, "max": 0.80, "min": 1.08, "cnt": 3}, "backward-recv":{"total": 273.53, "avg": 136.77, "max": 65.09, "min": 208.44, "cnt": 2}, "backward-params-all-reduce":{"total": 483.19, "avg": 483.19, "max": 483.19, "min": 483.19, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 256.66, "avg": 256.66, "max": 256.66, "min": 256.66, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 216.86, "avg": 216.86, "max": 216.86, "min": 216.86, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.29, "avg": 3.29, "max": 3.29, "min": 3.29, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 167, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 67.58, "avg": 22.53, "max": 0.94, "min": 63.60, "cnt": 3}, "forward-compute":{"total": 1874.18, "avg": 58.57, "max": 52.10, "min": 67.92, "cnt": 32}, "fwd-compute":{"total": 1870.78, "avg": 58.46, "max": 52.04, "min": 67.61, "cnt": 32}, "batch-generator":{"total": 44.29, "avg": 1.38, "max": 0.67, "min": 4.86, "cnt": 32}, "fwd-embedding":{"total": 0.67, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1813.60, "avg": 56.68, "max": 51.04, "min": 64.34, "cnt": 32}, "fwd-layernorm":{"total": 9.80, "avg": 0.08, "max": 0.05, "min": 0.22, "cnt": 128}, "fwd-attn":{"total": 109.97, "avg": 0.86, "max": 0.74, "min": 1.96, "cnt": 128}, "fwd-misc":{"total": 20.53, "avg": 0.16, "max": 0.11, "min": 0.42, "cnt": 128}, "fwd-MLP":{"total": 1652.68, "avg": 12.91, "max": 10.57, "min": 22.33, "cnt": 128}, "MoE_L0_fwd":{"total": 512.67, "avg": 16.02, "max": 13.03, "min": 22.24, "cnt": 32}, "MoEMLP":{"total": 1636.16, "avg": 12.78, "max": 10.46, "min": 22.20, "cnt": 128}, "MoE_L1_fwd":{"total": 388.51, "avg": 12.14, "max": 11.07, "min": 15.46, "cnt": 32}, "MoE_L2_fwd":{"total": 376.10, "avg": 11.75, "max": 10.99, "min": 14.50, "cnt": 32}, "MoE_L3_fwd":{"total": 364.91, "avg": 11.40, "max": 10.50, "min": 15.94, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.96, "avg": 0.98, "max": 0.78, "min": 1.18, "cnt": 2}, "forward-send-backward-recv":{"total": 303.95, "avg": 10.13, "max": 1.58, "min": 122.77, "cnt": 30}, "backward-compute":{"total": 1775.59, "avg": 55.49, "max": 53.62, "min": 59.49, "cnt": 32}, "MoE_L3_bwd":{"total": 393.47, "avg": 12.30, "max": 11.29, "min": 15.26, "cnt": 32}, "MoE_L2_bwd":{"total": 374.26, "avg": 11.70, "max": 10.73, "min": 13.41, "cnt": 32}, "MoE_L1_bwd":{"total": 344.67, "avg": 10.77, "max": 10.17, "min": 11.45, "cnt": 32}, "MoE_L0_bwd":{"total": 447.57, "avg": 13.99, "max": 13.39, "min": 14.48, "cnt": 32}, "backward-send-forward-recv":{"total": 2019.19, "avg": 69.63, "max": 2.39, "min": 508.91, "cnt": 29}, "backward-send":{"total": 3.15, "avg": 1.05, "max": 0.87, "min": 1.22, "cnt": 3}, "backward-recv":{"total": 120.91, "avg": 60.45, "max": 55.47, "min": 65.44, "cnt": 2}, "backward-params-all-reduce":{"total": 487.53, "avg": 487.53, "max": 487.53, "min": 487.53, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 257.93, "avg": 257.93, "max": 257.93, "min": 257.93, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 213.84, "avg": 213.84, "max": 213.84, "min": 213.84, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.80, "avg": 6.80, "max": 6.80, "min": 6.80, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 168, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 63.83, "avg": 21.28, "max": 0.93, "min": 57.24, "cnt": 3}, "forward-compute":{"total": 1899.19, "avg": 59.35, "max": 52.83, "min": 112.54, "cnt": 32}, "fwd-compute":{"total": 1896.10, "avg": 59.25, "max": 52.77, "min": 112.47, "cnt": 32}, "batch-generator":{"total": 39.15, "avg": 1.22, "max": 0.68, "min": 2.17, "cnt": 32}, "fwd-embedding":{"total": 0.66, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1844.45, "avg": 57.64, "max": 51.73, "min": 111.36, "cnt": 32}, "fwd-layernorm":{"total": 9.99, "avg": 0.08, "max": 0.05, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 110.03, "avg": 0.86, "max": 0.74, "min": 1.54, "cnt": 128}, "fwd-misc":{"total": 20.88, "avg": 0.16, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1682.37, "avg": 13.14, "max": 10.49, "min": 72.69, "cnt": 128}, "MoE_L0_fwd":{"total": 560.34, "avg": 17.51, "max": 13.11, "min": 72.62, "cnt": 32}, "MoEMLP":{"total": 1665.39, "avg": 13.01, "max": 10.39, "min": 72.57, "cnt": 128}, "MoE_L1_fwd":{"total": 388.60, "avg": 12.14, "max": 11.29, "min": 13.64, "cnt": 32}, "MoE_L2_fwd":{"total": 369.23, "avg": 11.54, "max": 10.95, "min": 13.44, "cnt": 32}, "MoE_L3_fwd":{"total": 353.47, "avg": 11.05, "max": 10.42, "min": 13.43, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.23, "avg": 0.62, "max": 0.57, "min": 0.66, "cnt": 2}, "forward-send-backward-recv":{"total": 810.09, "avg": 27.00, "max": 1.36, "min": 261.35, "cnt": 30}, "backward-compute":{"total": 1829.81, "avg": 57.18, "max": 53.11, "min": 126.27, "cnt": 32}, "MoE_L3_bwd":{"total": 383.64, "avg": 11.99, "max": 10.83, "min": 14.49, "cnt": 32}, "MoE_L2_bwd":{"total": 430.19, "avg": 13.44, "max": 10.66, "min": 78.43, "cnt": 32}, "MoE_L1_bwd":{"total": 350.74, "avg": 10.96, "max": 10.14, "min": 14.44, "cnt": 32}, "MoE_L0_bwd":{"total": 450.57, "avg": 14.08, "max": 13.52, "min": 15.94, "cnt": 32}, "backward-send-forward-recv":{"total": 1361.27, "avg": 46.94, "max": 1.99, "min": 191.00, "cnt": 29}, "backward-send":{"total": 1.79, "avg": 0.60, "max": 0.52, "min": 0.70, "cnt": 3}, "backward-recv":{"total": 140.41, "avg": 70.21, "max": 67.27, "min": 73.14, "cnt": 2}, "backward-params-all-reduce":{"total": 485.39, "avg": 485.39, "max": 485.39, "min": 485.39, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 261.75, "avg": 261.75, "max": 261.75, "min": 261.75, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 217.64, "avg": 217.64, "max": 217.64, "min": 217.64, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.85, "avg": 6.85, "max": 6.85, "min": 6.85, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 169, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.06, "avg": 0.06, "max": 0.06, "min": 0.06, "cnt": 1}, "forward-recv":{"total": 60.68, "avg": 20.23, "max": 1.06, "min": 56.74, "cnt": 3}, "forward-compute":{"total": 1942.59, "avg": 60.71, "max": 52.61, "min": 119.94, "cnt": 32}, "fwd-compute":{"total": 1939.41, "avg": 60.61, "max": 52.53, "min": 119.87, "cnt": 32}, "batch-generator":{"total": 54.16, "avg": 1.69, "max": 0.74, "min": 4.46, "cnt": 32}, "fwd-embedding":{"total": 0.69, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1872.50, "avg": 58.52, "max": 51.22, "min": 117.58, "cnt": 32}, "fwd-layernorm":{"total": 10.11, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 108.95, "avg": 0.85, "max": 0.74, "min": 1.58, "cnt": 128}, "fwd-misc":{"total": 21.05, "avg": 0.16, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1711.38, "avg": 13.37, "max": 10.55, "min": 77.99, "cnt": 128}, "MoE_L0_fwd":{"total": 589.03, "avg": 18.41, "max": 13.33, "min": 77.90, "cnt": 32}, "MoEMLP":{"total": 1694.25, "avg": 13.24, "max": 10.45, "min": 77.86, "cnt": 128}, "MoE_L1_fwd":{"total": 390.78, "avg": 12.21, "max": 11.22, "min": 13.69, "cnt": 32}, "MoE_L2_fwd":{"total": 367.07, "avg": 11.47, "max": 11.02, "min": 13.78, "cnt": 32}, "MoE_L3_fwd":{"total": 353.58, "avg": 11.05, "max": 10.48, "min": 11.87, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.71, "avg": 0.86, "max": 0.83, "min": 0.89, "cnt": 2}, "forward-send-backward-recv":{"total": 210.17, "avg": 7.01, "max": 1.46, "min": 114.61, "cnt": 30}, "backward-compute":{"total": 1765.18, "avg": 55.16, "max": 53.56, "min": 57.91, "cnt": 32}, "MoE_L3_bwd":{"total": 384.92, "avg": 12.03, "max": 11.45, "min": 13.82, "cnt": 32}, "MoE_L2_bwd":{"total": 362.08, "avg": 11.32, "max": 10.59, "min": 12.90, "cnt": 32}, "MoE_L1_bwd":{"total": 353.24, "avg": 11.04, "max": 10.49, "min": 11.99, "cnt": 32}, "MoE_L0_bwd":{"total": 448.52, "avg": 14.02, "max": 13.57, "min": 16.22, "cnt": 32}, "backward-send-forward-recv":{"total": 4386.85, "avg": 151.27, "max": 1.67, "min": 676.48, "cnt": 29}, "backward-send":{"total": 2.77, "avg": 0.92, "max": 0.84, "min": 1.01, "cnt": 3}, "backward-recv":{"total": 128.69, "avg": 64.35, "max": 59.55, "min": 69.14, "cnt": 2}, "backward-params-all-reduce":{"total": 490.32, "avg": 490.32, "max": 490.32, "min": 490.32, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 254.20, "avg": 254.20, "max": 254.20, "min": 254.20, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 214.53, "avg": 214.53, "max": 214.53, "min": 214.53, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.26, "avg": 3.26, "max": 3.26, "min": 3.26, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 170, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.06, "avg": 0.06, "max": 0.06, "min": 0.06, "cnt": 1}, "forward-recv":{"total": 80.73, "avg": 26.91, "max": 4.58, "min": 67.69, "cnt": 3}, "forward-compute":{"total": 1845.45, "avg": 57.67, "max": 52.49, "min": 65.42, "cnt": 32}, "fwd-compute":{"total": 1842.40, "avg": 57.57, "max": 52.42, "min": 65.34, "cnt": 32}, "batch-generator":{"total": 39.38, "avg": 1.23, "max": 0.68, "min": 2.34, "cnt": 32}, "fwd-embedding":{"total": 0.65, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1790.48, "avg": 55.95, "max": 51.34, "min": 63.39, "cnt": 32}, "fwd-layernorm":{"total": 9.86, "avg": 0.08, "max": 0.05, "min": 0.18, "cnt": 128}, "fwd-attn":{"total": 109.73, "avg": 0.86, "max": 0.74, "min": 1.50, "cnt": 128}, "fwd-misc":{"total": 20.73, "avg": 0.16, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1629.35, "avg": 12.73, "max": 10.56, "min": 18.88, "cnt": 128}, "MoE_L0_fwd":{"total": 503.33, "avg": 15.73, "max": 13.31, "min": 18.73, "cnt": 32}, "MoEMLP":{"total": 1612.21, "avg": 12.60, "max": 10.46, "min": 18.65, "cnt": 128}, "MoE_L1_fwd":{"total": 389.85, "avg": 12.18, "max": 11.12, "min": 16.53, "cnt": 32}, "MoE_L2_fwd":{"total": 372.98, "avg": 11.66, "max": 10.94, "min": 16.93, "cnt": 32}, "MoE_L3_fwd":{"total": 352.20, "avg": 11.01, "max": 10.50, "min": 12.17, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.39, "avg": 0.70, "max": 0.67, "min": 0.72, "cnt": 2}, "forward-send-backward-recv":{"total": 564.07, "avg": 18.80, "max": 1.39, "min": 121.51, "cnt": 30}, "backward-compute":{"total": 1764.41, "avg": 55.14, "max": 54.16, "min": 56.08, "cnt": 32}, "MoE_L3_bwd":{"total": 384.58, "avg": 12.02, "max": 11.24, "min": 12.98, "cnt": 32}, "MoE_L2_bwd":{"total": 364.32, "avg": 11.38, "max": 10.59, "min": 11.96, "cnt": 32}, "MoE_L1_bwd":{"total": 352.45, "avg": 11.01, "max": 10.49, "min": 11.73, "cnt": 32}, "MoE_L0_bwd":{"total": 447.01, "avg": 13.97, "max": 13.50, "min": 14.47, "cnt": 32}, "backward-send-forward-recv":{"total": 2100.82, "avg": 72.44, "max": 1.82, "min": 643.24, "cnt": 29}, "backward-send":{"total": 2.91, "avg": 0.97, "max": 0.84, "min": 1.15, "cnt": 3}, "backward-recv":{"total": 202.91, "avg": 101.46, "max": 69.32, "min": 133.59, "cnt": 2}, "backward-params-all-reduce":{"total": 485.58, "avg": 485.58, "max": 485.58, "min": 485.58, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 252.28, "avg": 252.28, "max": 252.28, "min": 252.28, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.36, "avg": 3.36, "max": 3.36, "min": 3.36, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 212.56, "avg": 212.56, "max": 212.56, "min": 212.56, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.30, "avg": 3.30, "max": 3.30, "min": 3.30, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 171, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.06, "avg": 0.06, "max": 0.06, "min": 0.06, "cnt": 1}, "forward-recv":{"total": 69.40, "avg": 23.13, "max": 0.96, "min": 67.45, "cnt": 3}, "forward-compute":{"total": 1900.49, "avg": 59.39, "max": 53.26, "min": 80.88, "cnt": 32}, "fwd-compute":{"total": 1897.27, "avg": 59.29, "max": 53.19, "min": 80.80, "cnt": 32}, "batch-generator":{"total": 45.01, "avg": 1.41, "max": 0.67, "min": 3.77, "cnt": 32}, "fwd-embedding":{"total": 0.69, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1839.51, "avg": 57.48, "max": 52.03, "min": 79.44, "cnt": 32}, "fwd-layernorm":{"total": 10.01, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 110.56, "avg": 0.86, "max": 0.75, "min": 1.58, "cnt": 128}, "fwd-misc":{"total": 21.43, "avg": 0.17, "max": 0.11, "min": 0.38, "cnt": 128}, "fwd-MLP":{"total": 1676.81, "avg": 13.10, "max": 10.50, "min": 38.34, "cnt": 128}, "MoE_L0_fwd":{"total": 532.46, "avg": 16.64, "max": 12.94, "min": 38.26, "cnt": 32}, "MoEMLP":{"total": 1659.96, "avg": 12.97, "max": 10.36, "min": 38.20, "cnt": 128}, "MoE_L1_fwd":{"total": 393.49, "avg": 12.30, "max": 11.36, "min": 14.60, "cnt": 32}, "MoE_L2_fwd":{"total": 380.87, "avg": 11.90, "max": 10.95, "min": 16.48, "cnt": 32}, "MoE_L3_fwd":{"total": 359.31, "avg": 11.23, "max": 10.41, "min": 14.23, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.61, "avg": 0.81, "max": 0.80, "min": 0.81, "cnt": 2}, "forward-send-backward-recv":{"total": 226.13, "avg": 7.54, "max": 1.48, "min": 119.49, "cnt": 30}, "backward-compute":{"total": 1753.75, "avg": 54.80, "max": 53.78, "min": 56.56, "cnt": 32}, "MoE_L3_bwd":{"total": 381.61, "avg": 11.93, "max": 11.24, "min": 14.24, "cnt": 32}, "MoE_L2_bwd":{"total": 355.02, "avg": 11.09, "max": 10.62, "min": 11.65, "cnt": 32}, "MoE_L1_bwd":{"total": 348.80, "avg": 10.90, "max": 10.52, "min": 11.92, "cnt": 32}, "MoE_L0_bwd":{"total": 449.20, "avg": 14.04, "max": 13.47, "min": 15.50, "cnt": 32}, "backward-send-forward-recv":{"total": 3152.46, "avg": 108.71, "max": 2.25, "min": 521.52, "cnt": 29}, "backward-send":{"total": 2.91, "avg": 0.97, "max": 0.84, "min": 1.11, "cnt": 3}, "backward-recv":{"total": 117.58, "avg": 58.79, "max": 52.28, "min": 65.30, "cnt": 2}, "backward-params-all-reduce":{"total": 489.46, "avg": 489.46, "max": 489.46, "min": 489.46, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 256.14, "avg": 256.14, "max": 256.14, "min": 256.14, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 212.14, "avg": 212.14, "max": 212.14, "min": 212.14, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.77, "avg": 6.77, "max": 6.77, "min": 6.77, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}}}
{"type":"time", "iteration": 172, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 62.16, "avg": 20.72, "max": 1.11, "min": 59.87, "cnt": 3}, "forward-compute":{"total": 1927.51, "avg": 60.23, "max": 54.61, "min": 65.13, "cnt": 32}, "fwd-compute":{"total": 1923.98, "avg": 60.12, "max": 54.54, "min": 65.05, "cnt": 32}, "batch-generator":{"total": 41.62, "avg": 1.30, "max": 0.66, "min": 2.09, "cnt": 32}, "fwd-embedding":{"total": 0.78, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1868.71, "avg": 58.40, "max": 53.58, "min": 63.52, "cnt": 32}, "fwd-layernorm":{"total": 10.47, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 111.65, "avg": 0.87, "max": 0.74, "min": 1.52, "cnt": 128}, "fwd-misc":{"total": 21.90, "avg": 0.17, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1703.09, "avg": 13.31, "max": 10.86, "min": 21.34, "cnt": 128}, "MoE_L0_fwd":{"total": 543.07, "avg": 16.97, "max": 13.73, "min": 21.25, "cnt": 32}, "MoEMLP":{"total": 1685.43, "avg": 13.17, "max": 10.76, "min": 21.20, "cnt": 128}, "MoE_L1_fwd":{"total": 404.68, "avg": 12.65, "max": 11.21, "min": 14.48, "cnt": 32}, "MoE_L2_fwd":{"total": 383.17, "avg": 11.97, "max": 11.05, "min": 12.96, "cnt": 32}, "MoE_L3_fwd":{"total": 360.92, "avg": 11.28, "max": 10.80, "min": 12.21, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.40, "avg": 0.70, "max": 0.69, "min": 0.71, "cnt": 2}, "forward-send-backward-recv":{"total": 886.53, "avg": 29.55, "max": 1.53, "min": 161.19, "cnt": 30}, "backward-compute":{"total": 1761.77, "avg": 55.06, "max": 53.27, "min": 57.62, "cnt": 32}, "MoE_L3_bwd":{"total": 386.59, "avg": 12.08, "max": 11.18, "min": 13.56, "cnt": 32}, "MoE_L2_bwd":{"total": 349.70, "avg": 10.93, "max": 10.04, "min": 12.45, "cnt": 32}, "MoE_L1_bwd":{"total": 357.61, "avg": 11.18, "max": 10.57, "min": 12.49, "cnt": 32}, "MoE_L0_bwd":{"total": 448.91, "avg": 14.03, "max": 13.48, "min": 15.22, "cnt": 32}, "backward-send-forward-recv":{"total": 298.84, "avg": 10.30, "max": 1.33, "min": 82.56, "cnt": 29}, "backward-send":{"total": 2.58, "avg": 0.86, "max": 0.75, "min": 1.04, "cnt": 3}, "backward-recv":{"total": 155.08, "avg": 77.54, "max": 70.47, "min": 84.61, "cnt": 2}, "backward-params-all-reduce":{"total": 485.32, "avg": 485.32, "max": 485.32, "min": 485.32, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 252.69, "avg": 252.69, "max": 252.69, "min": 252.69, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 212.69, "avg": 212.69, "max": 212.69, "min": 212.69, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.33, "avg": 3.33, "max": 3.33, "min": 3.33, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 173, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.06, "avg": 0.06, "max": 0.06, "min": 0.06, "cnt": 1}, "forward-recv":{"total": 60.50, "avg": 20.17, "max": 0.88, "min": 58.69, "cnt": 3}, "forward-compute":{"total": 1874.22, "avg": 58.57, "max": 54.14, "min": 66.35, "cnt": 32}, "fwd-compute":{"total": 1870.98, "avg": 58.47, "max": 54.06, "min": 66.20, "cnt": 32}, "batch-generator":{"total": 39.13, "avg": 1.22, "max": 0.62, "min": 1.67, "cnt": 32}, "fwd-embedding":{"total": 0.68, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1819.39, "avg": 56.86, "max": 52.63, "min": 64.31, "cnt": 32}, "fwd-layernorm":{"total": 9.86, "avg": 0.08, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 110.23, "avg": 0.86, "max": 0.74, "min": 1.47, "cnt": 128}, "fwd-misc":{"total": 21.23, "avg": 0.17, "max": 0.11, "min": 0.39, "cnt": 128}, "fwd-MLP":{"total": 1657.29, "avg": 12.95, "max": 10.68, "min": 21.01, "cnt": 128}, "MoE_L0_fwd":{"total": 503.96, "avg": 15.75, "max": 13.04, "min": 20.90, "cnt": 32}, "MoEMLP":{"total": 1640.64, "avg": 12.82, "max": 10.56, "min": 20.83, "cnt": 128}, "MoE_L1_fwd":{"total": 403.25, "avg": 12.60, "max": 11.80, "min": 14.11, "cnt": 32}, "MoE_L2_fwd":{"total": 379.88, "avg": 11.87, "max": 11.26, "min": 13.44, "cnt": 32}, "MoE_L3_fwd":{"total": 359.72, "avg": 11.24, "max": 10.61, "min": 14.42, "cnt": 32}, "fwd-pooler":{"total": 0.31, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.04, "cnt": 32}, "forward-send":{"total": 1.20, "avg": 0.60, "max": 0.56, "min": 0.64, "cnt": 2}, "forward-send-backward-recv":{"total": 262.29, "avg": 8.74, "max": 1.36, "min": 118.57, "cnt": 30}, "backward-compute":{"total": 1765.44, "avg": 55.17, "max": 54.05, "min": 57.15, "cnt": 32}, "MoE_L3_bwd":{"total": 391.71, "avg": 12.24, "max": 11.45, "min": 14.08, "cnt": 32}, "MoE_L2_bwd":{"total": 351.56, "avg": 10.99, "max": 10.38, "min": 11.65, "cnt": 32}, "MoE_L1_bwd":{"total": 356.90, "avg": 11.15, "max": 10.85, "min": 11.59, "cnt": 32}, "MoE_L0_bwd":{"total": 449.79, "avg": 14.06, "max": 13.71, "min": 14.75, "cnt": 32}, "backward-send-forward-recv":{"total": 1663.72, "avg": 57.37, "max": 2.19, "min": 465.39, "cnt": 29}, "backward-send":{"total": 3.04, "avg": 1.01, "max": 0.95, "min": 1.07, "cnt": 3}, "backward-recv":{"total": 151.22, "avg": 75.61, "max": 70.86, "min": 80.36, "cnt": 2}, "backward-params-all-reduce":{"total": 489.74, "avg": 489.74, "max": 489.74, "min": 489.74, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 267.80, "avg": 267.80, "max": 267.80, "min": 267.80, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 223.63, "avg": 223.63, "max": 223.63, "min": 223.63, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.87, "avg": 6.87, "max": 6.87, "min": 6.87, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}}}
{"type":"time", "iteration": 174, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 58.00, "avg": 19.33, "max": 0.90, "min": 56.17, "cnt": 3}, "forward-compute":{"total": 1917.71, "avg": 59.93, "max": 53.78, "min": 65.74, "cnt": 32}, "fwd-compute":{"total": 1914.37, "avg": 59.82, "max": 53.70, "min": 65.65, "cnt": 32}, "batch-generator":{"total": 46.63, "avg": 1.46, "max": 0.70, "min": 2.96, "cnt": 32}, "fwd-embedding":{"total": 0.81, "avg": 0.03, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1854.27, "avg": 57.95, "max": 52.43, "min": 62.35, "cnt": 32}, "fwd-layernorm":{"total": 10.51, "avg": 0.08, "max": 0.05, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 111.64, "avg": 0.87, "max": 0.74, "min": 1.57, "cnt": 128}, "fwd-misc":{"total": 21.52, "avg": 0.17, "max": 0.11, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1689.22, "avg": 13.20, "max": 10.56, "min": 19.95, "cnt": 128}, "MoE_L0_fwd":{"total": 526.90, "avg": 16.47, "max": 13.19, "min": 19.87, "cnt": 32}, "MoEMLP":{"total": 1671.95, "avg": 13.06, "max": 10.46, "min": 19.82, "cnt": 128}, "MoE_L1_fwd":{"total": 413.82, "avg": 12.93, "max": 11.53, "min": 15.11, "cnt": 32}, "MoE_L2_fwd":{"total": 377.58, "avg": 11.80, "max": 10.99, "min": 13.02, "cnt": 32}, "MoE_L3_fwd":{"total": 359.97, "avg": 11.25, "max": 10.50, "min": 14.45, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.56, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 2.11, "avg": 1.05, "max": 0.78, "min": 1.33, "cnt": 2}, "forward-send-backward-recv":{"total": 210.40, "avg": 7.01, "max": 1.43, "min": 113.62, "cnt": 30}, "backward-compute":{"total": 1773.98, "avg": 55.44, "max": 53.90, "min": 57.76, "cnt": 32}, "MoE_L3_bwd":{"total": 380.40, "avg": 11.89, "max": 11.09, "min": 13.68, "cnt": 32}, "MoE_L2_bwd":{"total": 363.81, "avg": 11.37, "max": 10.03, "min": 12.19, "cnt": 32}, "MoE_L1_bwd":{"total": 357.76, "avg": 11.18, "max": 10.58, "min": 11.69, "cnt": 32}, "MoE_L0_bwd":{"total": 456.38, "avg": 14.26, "max": 13.56, "min": 16.09, "cnt": 32}, "backward-send-forward-recv":{"total": 1259.35, "avg": 43.43, "max": 1.47, "min": 249.80, "cnt": 29}, "backward-send":{"total": 2.90, "avg": 0.97, "max": 0.89, "min": 1.11, "cnt": 3}, "backward-recv":{"total": 129.69, "avg": 64.84, "max": 58.06, "min": 71.63, "cnt": 2}, "backward-params-all-reduce":{"total": 497.66, "avg": 497.66, "max": 497.66, "min": 497.66, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 247.31, "avg": 247.31, "max": 247.31, "min": 247.31, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 203.28, "avg": 203.28, "max": 203.28, "min": 203.28, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.77, "avg": 6.77, "max": 6.77, "min": 6.77, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 175, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.10, "avg": 0.10, "max": 0.10, "min": 0.10, "cnt": 1}, "forward-recv":{"total": 59.65, "avg": 19.88, "max": 1.07, "min": 55.31, "cnt": 3}, "forward-compute":{"total": 1860.18, "avg": 58.13, "max": 51.62, "min": 62.38, "cnt": 32}, "fwd-compute":{"total": 1856.79, "avg": 58.02, "max": 51.55, "min": 62.25, "cnt": 32}, "batch-generator":{"total": 45.02, "avg": 1.41, "max": 0.67, "min": 2.59, "cnt": 32}, "fwd-embedding":{"total": 0.75, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1798.09, "avg": 56.19, "max": 50.55, "min": 60.20, "cnt": 32}, "fwd-layernorm":{"total": 10.41, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 112.81, "avg": 0.88, "max": 0.74, "min": 1.56, "cnt": 128}, "fwd-misc":{"total": 23.62, "avg": 0.18, "max": 0.11, "min": 2.13, "cnt": 128}, "fwd-MLP":{"total": 1629.67, "avg": 12.73, "max": 10.61, "min": 18.78, "cnt": 128}, "MoE_L0_fwd":{"total": 512.25, "avg": 16.01, "max": 12.97, "min": 18.70, "cnt": 32}, "MoEMLP":{"total": 1612.17, "avg": 12.60, "max": 10.51, "min": 18.65, "cnt": 128}, "MoE_L1_fwd":{"total": 387.29, "avg": 12.10, "max": 11.09, "min": 14.33, "cnt": 32}, "MoE_L2_fwd":{"total": 364.94, "avg": 11.40, "max": 10.72, "min": 12.10, "cnt": 32}, "MoE_L3_fwd":{"total": 354.02, "avg": 11.06, "max": 10.54, "min": 12.19, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.53, "avg": 0.77, "max": 0.75, "min": 0.78, "cnt": 2}, "forward-send-backward-recv":{"total": 315.65, "avg": 10.52, "max": 1.66, "min": 113.90, "cnt": 30}, "backward-compute":{"total": 1790.68, "avg": 55.96, "max": 53.97, "min": 79.58, "cnt": 32}, "MoE_L3_bwd":{"total": 408.44, "avg": 12.76, "max": 11.44, "min": 39.37, "cnt": 32}, "MoE_L2_bwd":{"total": 361.99, "avg": 11.31, "max": 10.20, "min": 12.67, "cnt": 32}, "MoE_L1_bwd":{"total": 353.14, "avg": 11.04, "max": 10.32, "min": 12.90, "cnt": 32}, "MoE_L0_bwd":{"total": 449.34, "avg": 14.04, "max": 13.71, "min": 14.50, "cnt": 32}, "backward-send-forward-recv":{"total": 1313.82, "avg": 45.30, "max": 2.09, "min": 233.93, "cnt": 29}, "backward-send":{"total": 3.44, "avg": 1.15, "max": 1.12, "min": 1.19, "cnt": 3}, "backward-recv":{"total": 178.60, "avg": 89.30, "max": 62.49, "min": 116.11, "cnt": 2}, "backward-params-all-reduce":{"total": 489.24, "avg": 489.24, "max": 489.24, "min": 489.24, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 254.18, "avg": 254.18, "max": 254.18, "min": 254.18, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 210.06, "avg": 210.06, "max": 210.06, "min": 210.06, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.74, "avg": 6.74, "max": 6.74, "min": 6.74, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 176, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.06, "avg": 0.06, "max": 0.06, "min": 0.06, "cnt": 1}, "forward-recv":{"total": 61.05, "avg": 20.35, "max": 0.92, "min": 59.20, "cnt": 3}, "forward-compute":{"total": 1891.56, "avg": 59.11, "max": 53.84, "min": 66.02, "cnt": 32}, "fwd-compute":{"total": 1888.30, "avg": 59.01, "max": 53.76, "min": 65.94, "cnt": 32}, "batch-generator":{"total": 44.19, "avg": 1.38, "max": 0.69, "min": 3.34, "cnt": 32}, "fwd-embedding":{"total": 0.69, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1831.59, "avg": 57.24, "max": 52.51, "min": 63.02, "cnt": 32}, "fwd-layernorm":{"total": 9.99, "avg": 0.08, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 112.45, "avg": 0.88, "max": 0.74, "min": 3.29, "cnt": 128}, "fwd-misc":{"total": 21.29, "avg": 0.17, "max": 0.11, "min": 0.47, "cnt": 128}, "fwd-MLP":{"total": 1666.99, "avg": 13.02, "max": 10.53, "min": 21.77, "cnt": 128}, "MoE_L0_fwd":{"total": 522.62, "avg": 16.33, "max": 13.61, "min": 21.70, "cnt": 32}, "MoEMLP":{"total": 1650.12, "avg": 12.89, "max": 10.43, "min": 21.66, "cnt": 128}, "MoE_L1_fwd":{"total": 407.52, "avg": 12.73, "max": 11.25, "min": 17.29, "cnt": 32}, "MoE_L2_fwd":{"total": 371.44, "avg": 11.61, "max": 10.74, "min": 14.60, "cnt": 32}, "MoE_L3_fwd":{"total": 354.78, "avg": 11.09, "max": 10.46, "min": 11.81, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 6.75, "avg": 3.37, "max": 0.57, "min": 6.18, "cnt": 2}, "forward-send-backward-recv":{"total": 647.89, "avg": 21.60, "max": 1.43, "min": 217.70, "cnt": 30}, "backward-compute":{"total": 1764.74, "avg": 55.15, "max": 53.46, "min": 57.77, "cnt": 32}, "MoE_L3_bwd":{"total": 386.68, "avg": 12.08, "max": 11.41, "min": 14.28, "cnt": 32}, "MoE_L2_bwd":{"total": 357.81, "avg": 11.18, "max": 10.41, "min": 13.81, "cnt": 32}, "MoE_L1_bwd":{"total": 351.68, "avg": 10.99, "max": 10.50, "min": 11.40, "cnt": 32}, "MoE_L0_bwd":{"total": 455.06, "avg": 14.22, "max": 13.79, "min": 15.75, "cnt": 32}, "backward-send-forward-recv":{"total": 2515.51, "avg": 86.74, "max": 1.49, "min": 769.27, "cnt": 29}, "backward-send":{"total": 2.78, "avg": 0.93, "max": 0.76, "min": 1.19, "cnt": 3}, "backward-recv":{"total": 157.34, "avg": 78.67, "max": 77.23, "min": 80.10, "cnt": 2}, "backward-params-all-reduce":{"total": 484.52, "avg": 484.52, "max": 484.52, "min": 484.52, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 254.87, "avg": 254.87, "max": 254.87, "min": 254.87, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 215.12, "avg": 215.12, "max": 215.12, "min": 215.12, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.29, "avg": 3.29, "max": 3.29, "min": 3.29, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 177, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 68.98, "avg": 22.99, "max": 0.93, "min": 66.89, "cnt": 3}, "forward-compute":{"total": 1872.54, "avg": 58.52, "max": 51.38, "min": 69.16, "cnt": 32}, "fwd-compute":{"total": 1869.34, "avg": 58.42, "max": 51.31, "min": 69.08, "cnt": 32}, "batch-generator":{"total": 42.88, "avg": 1.34, "max": 0.70, "min": 3.05, "cnt": 32}, "fwd-embedding":{"total": 0.64, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1813.98, "avg": 56.69, "max": 50.29, "min": 67.50, "cnt": 32}, "fwd-layernorm":{"total": 9.63, "avg": 0.08, "max": 0.06, "min": 0.17, "cnt": 128}, "fwd-attn":{"total": 108.79, "avg": 0.85, "max": 0.74, "min": 1.47, "cnt": 128}, "fwd-misc":{"total": 21.00, "avg": 0.16, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1654.05, "avg": 12.92, "max": 10.63, "min": 21.33, "cnt": 128}, "MoE_L0_fwd":{"total": 514.85, "avg": 16.09, "max": 13.05, "min": 21.24, "cnt": 32}, "MoEMLP":{"total": 1637.13, "avg": 12.79, "max": 10.52, "min": 21.19, "cnt": 128}, "MoE_L1_fwd":{"total": 392.21, "avg": 12.26, "max": 10.88, "min": 16.02, "cnt": 32}, "MoE_L2_fwd":{"total": 368.59, "avg": 11.52, "max": 10.56, "min": 16.49, "cnt": 32}, "MoE_L3_fwd":{"total": 367.57, "avg": 11.49, "max": 10.86, "min": 15.66, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.56, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 6.39, "avg": 3.19, "max": 0.85, "min": 5.54, "cnt": 2}, "forward-send-backward-recv":{"total": 185.37, "avg": 6.18, "max": 1.30, "min": 119.42, "cnt": 30}, "backward-compute":{"total": 1772.86, "avg": 55.40, "max": 52.97, "min": 58.93, "cnt": 32}, "MoE_L3_bwd":{"total": 390.24, "avg": 12.19, "max": 10.99, "min": 14.44, "cnt": 32}, "MoE_L2_bwd":{"total": 353.59, "avg": 11.05, "max": 10.25, "min": 11.97, "cnt": 32}, "MoE_L1_bwd":{"total": 358.43, "avg": 11.20, "max": 10.57, "min": 11.86, "cnt": 32}, "MoE_L0_bwd":{"total": 453.61, "avg": 14.18, "max": 13.55, "min": 14.85, "cnt": 32}, "backward-send-forward-recv":{"total": 2024.69, "avg": 69.82, "max": 2.43, "min": 277.03, "cnt": 29}, "backward-send":{"total": 2.65, "avg": 0.88, "max": 0.67, "min": 1.01, "cnt": 3}, "backward-recv":{"total": 142.26, "avg": 71.13, "max": 67.04, "min": 75.22, "cnt": 2}, "backward-params-all-reduce":{"total": 483.22, "avg": 483.22, "max": 483.22, "min": 483.22, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 264.37, "avg": 264.37, "max": 264.37, "min": 264.37, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.36, "avg": 3.36, "max": 3.36, "min": 3.36, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 220.29, "avg": 220.29, "max": 220.29, "min": 220.29, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.79, "avg": 6.79, "max": 6.79, "min": 6.79, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 178, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.06, "avg": 0.06, "max": 0.06, "min": 0.06, "cnt": 1}, "forward-recv":{"total": 57.17, "avg": 19.06, "max": 1.18, "min": 54.15, "cnt": 3}, "forward-compute":{"total": 1853.91, "avg": 57.93, "max": 51.48, "min": 68.31, "cnt": 32}, "fwd-compute":{"total": 1850.83, "avg": 57.84, "max": 51.41, "min": 68.23, "cnt": 32}, "batch-generator":{"total": 38.63, "avg": 1.21, "max": 0.65, "min": 2.21, "cnt": 32}, "fwd-embedding":{"total": 0.59, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1799.71, "avg": 56.24, "max": 50.36, "min": 66.43, "cnt": 32}, "fwd-layernorm":{"total": 9.63, "avg": 0.08, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 111.05, "avg": 0.87, "max": 0.74, "min": 1.50, "cnt": 128}, "fwd-misc":{"total": 21.05, "avg": 0.16, "max": 0.11, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1636.67, "avg": 12.79, "max": 10.73, "min": 19.76, "cnt": 128}, "MoE_L0_fwd":{"total": 506.29, "avg": 15.82, "max": 12.92, "min": 19.60, "cnt": 32}, "MoEMLP":{"total": 1619.54, "avg": 12.65, "max": 10.62, "min": 19.53, "cnt": 128}, "MoE_L1_fwd":{"total": 389.81, "avg": 12.18, "max": 11.19, "min": 15.95, "cnt": 32}, "MoE_L2_fwd":{"total": 366.49, "avg": 11.45, "max": 10.81, "min": 16.63, "cnt": 32}, "MoE_L3_fwd":{"total": 363.10, "avg": 11.35, "max": 10.66, "min": 14.48, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 7.16, "avg": 3.58, "max": 0.68, "min": 6.48, "cnt": 2}, "forward-send-backward-recv":{"total": 205.06, "avg": 6.84, "max": 1.44, "min": 115.96, "cnt": 30}, "backward-compute":{"total": 1772.67, "avg": 55.40, "max": 53.92, "min": 58.97, "cnt": 32}, "MoE_L3_bwd":{"total": 389.92, "avg": 12.19, "max": 11.27, "min": 15.39, "cnt": 32}, "MoE_L2_bwd":{"total": 364.04, "avg": 11.38, "max": 10.41, "min": 14.11, "cnt": 32}, "MoE_L1_bwd":{"total": 355.40, "avg": 11.11, "max": 10.62, "min": 11.81, "cnt": 32}, "MoE_L0_bwd":{"total": 446.98, "avg": 13.97, "max": 13.58, "min": 14.53, "cnt": 32}, "backward-send-forward-recv":{"total": 2276.78, "avg": 78.51, "max": 2.41, "min": 479.17, "cnt": 29}, "backward-send":{"total": 2.62, "avg": 0.87, "max": 0.78, "min": 0.92, "cnt": 3}, "backward-recv":{"total": 126.51, "avg": 63.25, "max": 55.63, "min": 70.88, "cnt": 2}, "backward-params-all-reduce":{"total": 485.34, "avg": 485.34, "max": 485.34, "min": 485.34, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 257.85, "avg": 257.85, "max": 257.85, "min": 257.85, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 213.82, "avg": 213.82, "max": 213.82, "min": 213.82, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.77, "avg": 6.77, "max": 6.77, "min": 6.77, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}}}
{"type":"time", "iteration": 179, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 64.84, "avg": 21.61, "max": 0.95, "min": 61.94, "cnt": 3}, "forward-compute":{"total": 1886.16, "avg": 58.94, "max": 52.94, "min": 64.40, "cnt": 32}, "fwd-compute":{"total": 1882.94, "avg": 58.84, "max": 52.86, "min": 64.28, "cnt": 32}, "batch-generator":{"total": 39.14, "avg": 1.22, "max": 0.66, "min": 1.79, "cnt": 32}, "fwd-embedding":{"total": 0.62, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1831.33, "avg": 57.23, "max": 51.81, "min": 62.50, "cnt": 32}, "fwd-layernorm":{"total": 9.79, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 109.53, "avg": 0.86, "max": 0.75, "min": 1.53, "cnt": 128}, "fwd-misc":{"total": 20.87, "avg": 0.16, "max": 0.11, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1670.38, "avg": 13.05, "max": 10.71, "min": 20.60, "cnt": 128}, "MoE_L0_fwd":{"total": 525.48, "avg": 16.42, "max": 13.22, "min": 20.47, "cnt": 32}, "MoEMLP":{"total": 1653.49, "avg": 12.92, "max": 10.60, "min": 20.37, "cnt": 128}, "MoE_L1_fwd":{"total": 392.05, "avg": 12.25, "max": 11.05, "min": 14.20, "cnt": 32}, "MoE_L2_fwd":{"total": 378.45, "avg": 11.83, "max": 10.76, "min": 16.76, "cnt": 32}, "MoE_L3_fwd":{"total": 363.70, "avg": 11.37, "max": 10.64, "min": 13.11, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.52, "avg": 0.76, "max": 0.64, "min": 0.88, "cnt": 2}, "forward-send-backward-recv":{"total": 1219.84, "avg": 40.66, "max": 1.79, "min": 254.14, "cnt": 30}, "backward-compute":{"total": 1775.02, "avg": 55.47, "max": 52.89, "min": 56.74, "cnt": 32}, "MoE_L3_bwd":{"total": 389.17, "avg": 12.16, "max": 10.75, "min": 13.62, "cnt": 32}, "MoE_L2_bwd":{"total": 358.80, "avg": 11.21, "max": 10.35, "min": 11.76, "cnt": 32}, "MoE_L1_bwd":{"total": 359.78, "avg": 11.24, "max": 10.30, "min": 11.74, "cnt": 32}, "MoE_L0_bwd":{"total": 450.14, "avg": 14.07, "max": 13.39, "min": 15.25, "cnt": 32}, "backward-send-forward-recv":{"total": 1869.87, "avg": 64.48, "max": 1.66, "min": 500.21, "cnt": 29}, "backward-send":{"total": 2.19, "avg": 0.73, "max": 0.51, "min": 1.09, "cnt": 3}, "backward-recv":{"total": 528.96, "avg": 264.48, "max": 74.70, "min": 454.26, "cnt": 2}, "backward-params-all-reduce":{"total": 489.64, "avg": 489.64, "max": 489.64, "min": 489.64, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 255.52, "avg": 255.52, "max": 255.52, "min": 255.52, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 211.35, "avg": 211.35, "max": 211.35, "min": 211.35, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.83, "avg": 6.83, "max": 6.83, "min": 6.83, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 180, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 63.98, "avg": 21.33, "max": 0.91, "min": 56.77, "cnt": 3}, "forward-compute":{"total": 1881.12, "avg": 58.79, "max": 52.05, "min": 65.27, "cnt": 32}, "fwd-compute":{"total": 1878.00, "avg": 58.69, "max": 51.98, "min": 65.20, "cnt": 32}, "batch-generator":{"total": 42.03, "avg": 1.31, "max": 0.67, "min": 2.51, "cnt": 32}, "fwd-embedding":{"total": 0.70, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1823.13, "avg": 56.97, "max": 51.01, "min": 63.52, "cnt": 32}, "fwd-layernorm":{"total": 10.02, "avg": 0.08, "max": 0.06, "min": 0.18, "cnt": 128}, "fwd-attn":{"total": 110.69, "avg": 0.86, "max": 0.74, "min": 1.61, "cnt": 128}, "fwd-misc":{"total": 20.99, "avg": 0.16, "max": 0.11, "min": 0.54, "cnt": 128}, "fwd-MLP":{"total": 1660.30, "avg": 12.97, "max": 10.85, "min": 20.16, "cnt": 128}, "MoE_L0_fwd":{"total": 503.68, "avg": 15.74, "max": 12.90, "min": 20.08, "cnt": 32}, "MoEMLP":{"total": 1643.63, "avg": 12.84, "max": 10.75, "min": 20.03, "cnt": 128}, "MoE_L1_fwd":{"total": 390.88, "avg": 12.22, "max": 11.33, "min": 16.03, "cnt": 32}, "MoE_L2_fwd":{"total": 376.84, "avg": 11.78, "max": 10.79, "min": 13.10, "cnt": 32}, "MoE_L3_fwd":{"total": 378.34, "avg": 11.82, "max": 11.03, "min": 16.27, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.56, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.73, "avg": 0.87, "max": 0.83, "min": 0.90, "cnt": 2}, "forward-send-backward-recv":{"total": 229.08, "avg": 7.64, "max": 1.86, "min": 131.23, "cnt": 30}, "backward-compute":{"total": 1785.94, "avg": 55.81, "max": 54.01, "min": 59.14, "cnt": 32}, "MoE_L3_bwd":{"total": 393.61, "avg": 12.30, "max": 10.94, "min": 14.69, "cnt": 32}, "MoE_L2_bwd":{"total": 363.84, "avg": 11.37, "max": 10.56, "min": 12.37, "cnt": 32}, "MoE_L1_bwd":{"total": 358.74, "avg": 11.21, "max": 10.62, "min": 11.88, "cnt": 32}, "MoE_L0_bwd":{"total": 452.37, "avg": 14.14, "max": 13.56, "min": 17.26, "cnt": 32}, "backward-send-forward-recv":{"total": 1176.16, "avg": 40.56, "max": 1.87, "min": 180.33, "cnt": 29}, "backward-send":{"total": 3.11, "avg": 1.04, "max": 1.01, "min": 1.07, "cnt": 3}, "backward-recv":{"total": 141.03, "avg": 70.51, "max": 65.36, "min": 75.67, "cnt": 2}, "backward-params-all-reduce":{"total": 485.73, "avg": 485.73, "max": 485.73, "min": 485.73, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 257.62, "avg": 257.62, "max": 257.62, "min": 257.62, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 213.59, "avg": 213.59, "max": 213.59, "min": 213.59, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.81, "avg": 6.81, "max": 6.81, "min": 6.81, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 181, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.06, "avg": 0.06, "max": 0.06, "min": 0.06, "cnt": 1}, "forward-recv":{"total": 59.09, "avg": 19.70, "max": 0.91, "min": 57.10, "cnt": 3}, "forward-compute":{"total": 1917.94, "avg": 59.94, "max": 52.88, "min": 66.52, "cnt": 32}, "fwd-compute":{"total": 1914.29, "avg": 59.82, "max": 52.81, "min": 66.39, "cnt": 32}, "batch-generator":{"total": 45.20, "avg": 1.41, "max": 0.72, "min": 2.15, "cnt": 32}, "fwd-embedding":{"total": 0.84, "avg": 0.03, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1854.90, "avg": 57.97, "max": 51.76, "min": 64.37, "cnt": 32}, "fwd-layernorm":{"total": 11.18, "avg": 0.09, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 116.86, "avg": 0.91, "max": 0.74, "min": 2.14, "cnt": 128}, "fwd-misc":{"total": 23.75, "avg": 0.19, "max": 0.11, "min": 0.47, "cnt": 128}, "fwd-MLP":{"total": 1680.18, "avg": 13.13, "max": 10.76, "min": 20.69, "cnt": 128}, "MoE_L0_fwd":{"total": 519.60, "avg": 16.24, "max": 13.37, "min": 20.60, "cnt": 32}, "MoEMLP":{"total": 1661.81, "avg": 12.98, "max": 10.62, "min": 20.55, "cnt": 128}, "MoE_L1_fwd":{"total": 395.91, "avg": 12.37, "max": 11.31, "min": 14.80, "cnt": 32}, "MoE_L2_fwd":{"total": 371.42, "avg": 11.61, "max": 10.67, "min": 15.34, "cnt": 32}, "MoE_L3_fwd":{"total": 381.63, "avg": 11.93, "max": 10.96, "min": 15.48, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 9.25, "avg": 4.62, "max": 0.92, "min": 8.33, "cnt": 2}, "forward-send-backward-recv":{"total": 581.56, "avg": 19.39, "max": 1.68, "min": 174.76, "cnt": 30}, "backward-compute":{"total": 1776.06, "avg": 55.50, "max": 53.62, "min": 58.41, "cnt": 32}, "MoE_L3_bwd":{"total": 399.00, "avg": 12.47, "max": 11.54, "min": 14.42, "cnt": 32}, "MoE_L2_bwd":{"total": 355.83, "avg": 11.12, "max": 10.28, "min": 12.77, "cnt": 32}, "MoE_L1_bwd":{"total": 363.59, "avg": 11.36, "max": 10.87, "min": 12.19, "cnt": 32}, "MoE_L0_bwd":{"total": 442.47, "avg": 13.83, "max": 13.21, "min": 14.87, "cnt": 32}, "backward-send-forward-recv":{"total": 590.28, "avg": 20.35, "max": 1.70, "min": 167.95, "cnt": 29}, "backward-send":{"total": 2.95, "avg": 0.98, "max": 0.91, "min": 1.06, "cnt": 3}, "backward-recv":{"total": 130.90, "avg": 65.45, "max": 59.19, "min": 71.71, "cnt": 2}, "backward-params-all-reduce":{"total": 485.61, "avg": 485.61, "max": 485.61, "min": 485.61, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 259.86, "avg": 259.86, "max": 259.86, "min": 259.86, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 215.83, "avg": 215.83, "max": 215.83, "min": 215.83, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.78, "avg": 6.78, "max": 6.78, "min": 6.78, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.41, "avg": 3.41, "max": 3.41, "min": 3.41, "cnt": 1}}}
{"type":"time", "iteration": 182, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 58.36, "avg": 19.45, "max": 1.15, "min": 55.39, "cnt": 3}, "forward-compute":{"total": 1882.64, "avg": 58.83, "max": 52.25, "min": 65.01, "cnt": 32}, "fwd-compute":{"total": 1879.07, "avg": 58.72, "max": 52.16, "min": 64.88, "cnt": 32}, "batch-generator":{"total": 43.43, "avg": 1.36, "max": 0.66, "min": 2.32, "cnt": 32}, "fwd-embedding":{"total": 0.80, "avg": 0.03, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1821.99, "avg": 56.94, "max": 51.06, "min": 62.83, "cnt": 32}, "fwd-layernorm":{"total": 10.71, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 115.08, "avg": 0.90, "max": 0.75, "min": 1.52, "cnt": 128}, "fwd-misc":{"total": 22.68, "avg": 0.18, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1651.38, "avg": 12.90, "max": 10.77, "min": 21.41, "cnt": 128}, "MoE_L0_fwd":{"total": 513.16, "avg": 16.04, "max": 12.78, "min": 21.32, "cnt": 32}, "MoEMLP":{"total": 1633.18, "avg": 12.76, "max": 10.66, "min": 21.27, "cnt": 128}, "MoE_L1_fwd":{"total": 394.15, "avg": 12.32, "max": 11.38, "min": 17.38, "cnt": 32}, "MoE_L2_fwd":{"total": 361.86, "avg": 11.31, "max": 10.70, "min": 12.46, "cnt": 32}, "MoE_L3_fwd":{"total": 370.57, "avg": 11.58, "max": 10.83, "min": 16.61, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.77, "avg": 0.88, "max": 0.86, "min": 0.91, "cnt": 2}, "forward-send-backward-recv":{"total": 368.85, "avg": 12.29, "max": 1.93, "min": 125.96, "cnt": 30}, "backward-compute":{"total": 1767.06, "avg": 55.22, "max": 53.91, "min": 60.21, "cnt": 32}, "MoE_L3_bwd":{"total": 391.86, "avg": 12.25, "max": 11.48, "min": 15.52, "cnt": 32}, "MoE_L2_bwd":{"total": 355.56, "avg": 11.11, "max": 10.43, "min": 12.49, "cnt": 32}, "MoE_L1_bwd":{"total": 364.05, "avg": 11.38, "max": 10.89, "min": 12.00, "cnt": 32}, "MoE_L0_bwd":{"total": 437.66, "avg": 13.68, "max": 12.85, "min": 15.42, "cnt": 32}, "backward-send-forward-recv":{"total": 473.62, "avg": 16.33, "max": 1.46, "min": 95.03, "cnt": 29}, "backward-send":{"total": 2.58, "avg": 0.86, "max": 0.48, "min": 1.18, "cnt": 3}, "backward-recv":{"total": 137.10, "avg": 68.55, "max": 66.84, "min": 70.26, "cnt": 2}, "backward-params-all-reduce":{"total": 492.13, "avg": 492.13, "max": 492.13, "min": 492.13, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 251.31, "avg": 251.31, "max": 251.31, "min": 251.31, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 207.33, "avg": 207.33, "max": 207.33, "min": 207.33, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.76, "avg": 6.76, "max": 6.76, "min": 6.76, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 183, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 65.18, "avg": 21.73, "max": 0.97, "min": 56.16, "cnt": 3}, "forward-compute":{"total": 1898.67, "avg": 59.33, "max": 53.27, "min": 67.32, "cnt": 32}, "fwd-compute":{"total": 1895.05, "avg": 59.22, "max": 53.18, "min": 67.16, "cnt": 32}, "batch-generator":{"total": 50.52, "avg": 1.58, "max": 0.72, "min": 4.78, "cnt": 32}, "fwd-embedding":{"total": 0.76, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1830.74, "avg": 57.21, "max": 50.63, "min": 63.87, "cnt": 32}, "fwd-layernorm":{"total": 10.66, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 113.49, "avg": 0.89, "max": 0.74, "min": 1.50, "cnt": 128}, "fwd-misc":{"total": 22.09, "avg": 0.17, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1662.31, "avg": 12.99, "max": 10.82, "min": 19.31, "cnt": 128}, "MoE_L0_fwd":{"total": 510.91, "avg": 15.97, "max": 12.63, "min": 19.22, "cnt": 32}, "MoEMLP":{"total": 1644.41, "avg": 12.85, "max": 10.70, "min": 19.16, "cnt": 128}, "MoE_L1_fwd":{"total": 397.73, "avg": 12.43, "max": 11.28, "min": 15.78, "cnt": 32}, "MoE_L2_fwd":{"total": 367.56, "avg": 11.49, "max": 10.87, "min": 12.96, "cnt": 32}, "MoE_L3_fwd":{"total": 374.67, "avg": 11.71, "max": 10.74, "min": 16.30, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.91, "avg": 0.96, "max": 0.88, "min": 1.04, "cnt": 2}, "forward-send-backward-recv":{"total": 454.58, "avg": 15.15, "max": 1.41, "min": 153.04, "cnt": 30}, "backward-compute":{"total": 1768.20, "avg": 55.26, "max": 54.10, "min": 56.75, "cnt": 32}, "MoE_L3_bwd":{"total": 387.51, "avg": 12.11, "max": 10.96, "min": 13.48, "cnt": 32}, "MoE_L2_bwd":{"total": 358.12, "avg": 11.19, "max": 10.35, "min": 11.95, "cnt": 32}, "MoE_L1_bwd":{"total": 366.53, "avg": 11.45, "max": 10.98, "min": 12.31, "cnt": 32}, "MoE_L0_bwd":{"total": 438.37, "avg": 13.70, "max": 13.20, "min": 14.08, "cnt": 32}, "backward-send-forward-recv":{"total": 5522.73, "avg": 190.44, "max": 1.72, "min": 1875.41, "cnt": 29}, "backward-send":{"total": 2.44, "avg": 0.81, "max": 0.67, "min": 0.94, "cnt": 3}, "backward-recv":{"total": 136.84, "avg": 68.42, "max": 67.64, "min": 69.20, "cnt": 2}, "backward-params-all-reduce":{"total": 485.61, "avg": 485.61, "max": 485.61, "min": 485.61, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 259.54, "avg": 259.54, "max": 259.54, "min": 259.54, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 215.39, "avg": 215.39, "max": 215.39, "min": 215.39, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.81, "avg": 6.81, "max": 6.81, "min": 6.81, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 184, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 67.49, "avg": 22.50, "max": 1.42, "min": 61.64, "cnt": 3}, "forward-compute":{"total": 1887.79, "avg": 58.99, "max": 52.36, "min": 71.15, "cnt": 32}, "fwd-compute":{"total": 1884.57, "avg": 58.89, "max": 52.29, "min": 71.07, "cnt": 32}, "batch-generator":{"total": 47.36, "avg": 1.48, "max": 0.66, "min": 4.28, "cnt": 32}, "fwd-embedding":{"total": 0.66, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1824.58, "avg": 57.02, "max": 51.32, "min": 68.22, "cnt": 32}, "fwd-layernorm":{"total": 10.28, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 112.96, "avg": 0.88, "max": 0.75, "min": 2.30, "cnt": 128}, "fwd-misc":{"total": 21.72, "avg": 0.17, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1657.74, "avg": 12.95, "max": 10.63, "min": 20.83, "cnt": 128}, "MoE_L0_fwd":{"total": 497.14, "avg": 15.54, "max": 12.65, "min": 20.75, "cnt": 32}, "MoEMLP":{"total": 1640.04, "avg": 12.81, "max": 10.53, "min": 20.71, "cnt": 128}, "MoE_L1_fwd":{"total": 400.33, "avg": 12.51, "max": 11.57, "min": 15.92, "cnt": 32}, "MoE_L2_fwd":{"total": 375.06, "avg": 11.72, "max": 10.56, "min": 15.99, "cnt": 32}, "MoE_L3_fwd":{"total": 373.94, "avg": 11.69, "max": 10.89, "min": 15.97, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.76, "avg": 0.88, "max": 0.83, "min": 0.94, "cnt": 2}, "forward-send-backward-recv":{"total": 192.63, "avg": 6.42, "max": 1.46, "min": 123.67, "cnt": 30}, "backward-compute":{"total": 1775.97, "avg": 55.50, "max": 53.64, "min": 59.52, "cnt": 32}, "MoE_L3_bwd":{"total": 394.60, "avg": 12.33, "max": 11.43, "min": 14.47, "cnt": 32}, "MoE_L2_bwd":{"total": 360.01, "avg": 11.25, "max": 10.50, "min": 13.86, "cnt": 32}, "MoE_L1_bwd":{"total": 370.32, "avg": 11.57, "max": 11.05, "min": 12.23, "cnt": 32}, "MoE_L0_bwd":{"total": 433.36, "avg": 13.54, "max": 12.98, "min": 14.98, "cnt": 32}, "backward-send-forward-recv":{"total": 1261.74, "avg": 43.51, "max": 2.25, "min": 153.45, "cnt": 29}, "backward-send":{"total": 2.75, "avg": 0.92, "max": 0.68, "min": 1.06, "cnt": 3}, "backward-recv":{"total": 137.86, "avg": 68.93, "max": 66.41, "min": 71.45, "cnt": 2}, "backward-params-all-reduce":{"total": 485.89, "avg": 485.89, "max": 485.89, "min": 485.89, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 258.74, "avg": 258.74, "max": 258.74, "min": 258.74, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 214.63, "avg": 214.63, "max": 214.63, "min": 214.63, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.77, "avg": 6.77, "max": 6.77, "min": 6.77, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 185, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 58.25, "avg": 19.42, "max": 1.14, "min": 55.94, "cnt": 3}, "forward-compute":{"total": 1889.64, "avg": 59.05, "max": 53.06, "min": 64.88, "cnt": 32}, "fwd-compute":{"total": 1886.27, "avg": 58.95, "max": 52.99, "min": 64.78, "cnt": 32}, "batch-generator":{"total": 47.02, "avg": 1.47, "max": 0.70, "min": 3.16, "cnt": 32}, "fwd-embedding":{"total": 0.75, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1826.05, "avg": 57.06, "max": 51.86, "min": 63.44, "cnt": 32}, "fwd-layernorm":{"total": 10.80, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 114.51, "avg": 0.89, "max": 0.74, "min": 2.40, "cnt": 128}, "fwd-misc":{"total": 22.33, "avg": 0.17, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1656.24, "avg": 12.94, "max": 10.64, "min": 18.89, "cnt": 128}, "MoE_L0_fwd":{"total": 501.70, "avg": 15.68, "max": 13.20, "min": 18.72, "cnt": 32}, "MoEMLP":{"total": 1638.10, "avg": 12.80, "max": 10.53, "min": 18.63, "cnt": 128}, "MoE_L1_fwd":{"total": 401.00, "avg": 12.53, "max": 11.35, "min": 14.59, "cnt": 32}, "MoE_L2_fwd":{"total": 364.35, "avg": 11.39, "max": 10.57, "min": 13.53, "cnt": 32}, "MoE_L3_fwd":{"total": 377.60, "avg": 11.80, "max": 10.83, "min": 14.40, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 6.87, "avg": 3.43, "max": 0.86, "min": 6.01, "cnt": 2}, "forward-send-backward-recv":{"total": 795.66, "avg": 26.52, "max": 1.71, "min": 131.45, "cnt": 30}, "backward-compute":{"total": 1781.49, "avg": 55.67, "max": 52.98, "min": 59.12, "cnt": 32}, "MoE_L3_bwd":{"total": 408.68, "avg": 12.77, "max": 11.43, "min": 14.78, "cnt": 32}, "MoE_L2_bwd":{"total": 347.44, "avg": 10.86, "max": 9.86, "min": 11.65, "cnt": 32}, "MoE_L1_bwd":{"total": 368.79, "avg": 11.52, "max": 10.91, "min": 11.98, "cnt": 32}, "MoE_L0_bwd":{"total": 438.46, "avg": 13.70, "max": 12.90, "min": 14.91, "cnt": 32}, "backward-send-forward-recv":{"total": 1041.14, "avg": 35.90, "max": 1.59, "min": 305.13, "cnt": 29}, "backward-send":{"total": 3.14, "avg": 1.05, "max": 0.93, "min": 1.14, "cnt": 3}, "backward-recv":{"total": 366.01, "avg": 183.00, "max": 69.00, "min": 297.01, "cnt": 2}, "backward-params-all-reduce":{"total": 485.05, "avg": 485.05, "max": 485.05, "min": 485.05, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 258.46, "avg": 258.46, "max": 258.46, "min": 258.46, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 214.29, "avg": 214.29, "max": 214.29, "min": 214.29, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.84, "avg": 6.84, "max": 6.84, "min": 6.84, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 186, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 59.20, "avg": 19.73, "max": 0.91, "min": 57.21, "cnt": 3}, "forward-compute":{"total": 1908.97, "avg": 59.66, "max": 52.18, "min": 69.39, "cnt": 32}, "fwd-compute":{"total": 1905.56, "avg": 59.55, "max": 52.11, "min": 69.31, "cnt": 32}, "batch-generator":{"total": 45.56, "avg": 1.42, "max": 0.68, "min": 2.60, "cnt": 32}, "fwd-embedding":{"total": 0.77, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1846.23, "avg": 57.69, "max": 51.14, "min": 67.01, "cnt": 32}, "fwd-layernorm":{"total": 10.74, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 114.57, "avg": 0.90, "max": 0.75, "min": 2.69, "cnt": 128}, "fwd-misc":{"total": 22.50, "avg": 0.18, "max": 0.11, "min": 0.46, "cnt": 128}, "fwd-MLP":{"total": 1676.15, "avg": 13.09, "max": 10.70, "min": 24.68, "cnt": 128}, "MoE_L0_fwd":{"total": 511.52, "avg": 15.99, "max": 12.80, "min": 24.53, "cnt": 32}, "MoEMLP":{"total": 1658.13, "avg": 12.95, "max": 10.58, "min": 24.45, "cnt": 128}, "MoE_L1_fwd":{"total": 407.97, "avg": 12.75, "max": 11.43, "min": 18.81, "cnt": 32}, "MoE_L2_fwd":{"total": 369.25, "avg": 11.54, "max": 10.62, "min": 14.39, "cnt": 32}, "MoE_L3_fwd":{"total": 375.99, "avg": 11.75, "max": 10.89, "min": 16.43, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.04, "cnt": 32}, "forward-send":{"total": 2.07, "avg": 1.04, "max": 0.88, "min": 1.19, "cnt": 2}, "forward-send-backward-recv":{"total": 205.64, "avg": 6.85, "max": 1.65, "min": 121.35, "cnt": 30}, "backward-compute":{"total": 1756.16, "avg": 54.88, "max": 53.38, "min": 56.13, "cnt": 32}, "MoE_L3_bwd":{"total": 388.66, "avg": 12.15, "max": 11.35, "min": 12.94, "cnt": 32}, "MoE_L2_bwd":{"total": 348.52, "avg": 10.89, "max": 10.12, "min": 11.71, "cnt": 32}, "MoE_L1_bwd":{"total": 364.90, "avg": 11.40, "max": 10.82, "min": 12.03, "cnt": 32}, "MoE_L0_bwd":{"total": 437.51, "avg": 13.67, "max": 13.30, "min": 14.35, "cnt": 32}, "backward-send-forward-recv":{"total": 2633.39, "avg": 90.81, "max": 2.24, "min": 1317.25, "cnt": 29}, "backward-send":{"total": 3.12, "avg": 1.04, "max": 0.82, "min": 1.19, "cnt": 3}, "backward-recv":{"total": 207.94, "avg": 103.97, "max": 67.34, "min": 140.60, "cnt": 2}, "backward-params-all-reduce":{"total": 488.79, "avg": 488.79, "max": 488.79, "min": 488.79, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 248.13, "avg": 248.13, "max": 248.13, "min": 248.13, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 208.22, "avg": 208.22, "max": 208.22, "min": 208.22, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 187, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 57.05, "avg": 19.02, "max": 0.90, "min": 55.23, "cnt": 3}, "forward-compute":{"total": 1880.73, "avg": 58.77, "max": 52.02, "min": 62.83, "cnt": 32}, "fwd-compute":{"total": 1877.16, "avg": 58.66, "max": 51.95, "min": 62.67, "cnt": 32}, "batch-generator":{"total": 44.30, "avg": 1.38, "max": 0.71, "min": 2.78, "cnt": 32}, "fwd-embedding":{"total": 0.78, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1818.99, "avg": 56.84, "max": 50.85, "min": 61.33, "cnt": 32}, "fwd-layernorm":{"total": 10.97, "avg": 0.09, "max": 0.05, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 116.28, "avg": 0.91, "max": 0.75, "min": 2.52, "cnt": 128}, "fwd-misc":{"total": 22.61, "avg": 0.18, "max": 0.11, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1646.13, "avg": 12.86, "max": 10.73, "min": 21.88, "cnt": 128}, "MoE_L0_fwd":{"total": 517.82, "avg": 16.18, "max": 12.60, "min": 21.79, "cnt": 32}, "MoEMLP":{"total": 1627.64, "avg": 12.72, "max": 10.62, "min": 21.74, "cnt": 128}, "MoE_L1_fwd":{"total": 391.86, "avg": 12.25, "max": 11.36, "min": 13.94, "cnt": 32}, "MoE_L2_fwd":{"total": 357.93, "avg": 11.19, "max": 10.66, "min": 12.13, "cnt": 32}, "MoE_L3_fwd":{"total": 366.76, "avg": 11.46, "max": 10.91, "min": 12.81, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 11.37, "avg": 5.68, "max": 1.19, "min": 10.18, "cnt": 2}, "forward-send-backward-recv":{"total": 227.10, "avg": 7.57, "max": 1.44, "min": 123.51, "cnt": 30}, "backward-compute":{"total": 1760.08, "avg": 55.00, "max": 52.48, "min": 57.46, "cnt": 32}, "MoE_L3_bwd":{"total": 389.44, "avg": 12.17, "max": 11.21, "min": 14.57, "cnt": 32}, "MoE_L2_bwd":{"total": 353.25, "avg": 11.04, "max": 9.95, "min": 12.86, "cnt": 32}, "MoE_L1_bwd":{"total": 368.19, "avg": 11.51, "max": 11.05, "min": 12.20, "cnt": 32}, "MoE_L0_bwd":{"total": 431.89, "avg": 13.50, "max": 13.07, "min": 13.86, "cnt": 32}, "backward-send-forward-recv":{"total": 1702.51, "avg": 58.71, "max": 2.37, "min": 392.60, "cnt": 29}, "backward-send":{"total": 2.59, "avg": 0.86, "max": 0.49, "min": 1.11, "cnt": 3}, "backward-recv":{"total": 135.88, "avg": 67.94, "max": 67.72, "min": 68.16, "cnt": 2}, "backward-params-all-reduce":{"total": 485.61, "avg": 485.61, "max": 485.61, "min": 485.61, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 257.47, "avg": 257.47, "max": 257.47, "min": 257.47, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 213.20, "avg": 213.20, "max": 213.20, "min": 213.20, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.93, "avg": 6.93, "max": 6.93, "min": 6.93, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 188, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.06, "avg": 0.06, "max": 0.06, "min": 0.06, "cnt": 1}, "forward-recv":{"total": 68.35, "avg": 22.78, "max": 1.04, "min": 66.20, "cnt": 3}, "forward-compute":{"total": 1946.70, "avg": 60.83, "max": 55.88, "min": 73.38, "cnt": 32}, "fwd-compute":{"total": 1943.18, "avg": 60.72, "max": 55.81, "min": 73.29, "cnt": 32}, "batch-generator":{"total": 53.85, "avg": 1.68, "max": 0.73, "min": 2.83, "cnt": 32}, "fwd-embedding":{"total": 0.86, "avg": 0.03, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1875.75, "avg": 58.62, "max": 53.81, "min": 71.83, "cnt": 32}, "fwd-layernorm":{"total": 11.39, "avg": 0.09, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 121.86, "avg": 0.95, "max": 0.75, "min": 2.27, "cnt": 128}, "fwd-misc":{"total": 23.44, "avg": 0.18, "max": 0.11, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1695.95, "avg": 13.25, "max": 10.89, "min": 19.95, "cnt": 128}, "MoE_L0_fwd":{"total": 514.64, "avg": 16.08, "max": 13.02, "min": 19.87, "cnt": 32}, "MoEMLP":{"total": 1677.03, "avg": 13.10, "max": 10.76, "min": 19.82, "cnt": 128}, "MoE_L1_fwd":{"total": 416.80, "avg": 13.03, "max": 11.81, "min": 18.82, "cnt": 32}, "MoE_L2_fwd":{"total": 383.55, "avg": 11.99, "max": 10.84, "min": 17.16, "cnt": 32}, "MoE_L3_fwd":{"total": 368.88, "avg": 11.53, "max": 10.81, "min": 15.45, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.56, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 2.70, "avg": 1.35, "max": 0.67, "min": 2.04, "cnt": 2}, "forward-send-backward-recv":{"total": 197.97, "avg": 6.60, "max": 1.70, "min": 121.74, "cnt": 30}, "backward-compute":{"total": 1782.08, "avg": 55.69, "max": 53.87, "min": 59.61, "cnt": 32}, "MoE_L3_bwd":{"total": 391.78, "avg": 12.24, "max": 11.34, "min": 13.97, "cnt": 32}, "MoE_L2_bwd":{"total": 357.29, "avg": 11.17, "max": 10.44, "min": 12.10, "cnt": 32}, "MoE_L1_bwd":{"total": 374.91, "avg": 11.72, "max": 11.11, "min": 12.73, "cnt": 32}, "MoE_L0_bwd":{"total": 437.65, "avg": 13.68, "max": 13.17, "min": 17.32, "cnt": 32}, "backward-send-forward-recv":{"total": 2387.46, "avg": 82.33, "max": 1.80, "min": 612.29, "cnt": 29}, "backward-send":{"total": 2.67, "avg": 0.89, "max": 0.66, "min": 1.05, "cnt": 3}, "backward-recv":{"total": 131.61, "avg": 65.81, "max": 64.10, "min": 67.52, "cnt": 2}, "backward-params-all-reduce":{"total": 484.86, "avg": 484.86, "max": 484.86, "min": 484.86, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 258.58, "avg": 258.58, "max": 258.58, "min": 258.58, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 214.58, "avg": 214.58, "max": 214.58, "min": 214.58, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.76, "avg": 6.76, "max": 6.76, "min": 6.76, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 189, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 57.67, "avg": 19.22, "max": 0.97, "min": 55.08, "cnt": 3}, "forward-compute":{"total": 1906.05, "avg": 59.56, "max": 52.77, "min": 69.82, "cnt": 32}, "fwd-compute":{"total": 1902.25, "avg": 59.45, "max": 52.66, "min": 69.46, "cnt": 32}, "batch-generator":{"total": 46.12, "avg": 1.44, "max": 0.66, "min": 2.58, "cnt": 32}, "fwd-embedding":{"total": 0.74, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1841.41, "avg": 57.54, "max": 51.55, "min": 66.04, "cnt": 32}, "fwd-layernorm":{"total": 10.63, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 113.56, "avg": 0.89, "max": 0.74, "min": 2.84, "cnt": 128}, "fwd-misc":{"total": 22.28, "avg": 0.17, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1672.10, "avg": 13.06, "max": 10.84, "min": 23.36, "cnt": 128}, "MoE_L0_fwd":{"total": 507.64, "avg": 15.86, "max": 12.61, "min": 23.21, "cnt": 32}, "MoEMLP":{"total": 1654.02, "avg": 12.92, "max": 10.74, "min": 23.13, "cnt": 128}, "MoE_L1_fwd":{"total": 404.31, "avg": 12.63, "max": 11.45, "min": 16.24, "cnt": 32}, "MoE_L2_fwd":{"total": 373.49, "avg": 11.67, "max": 10.79, "min": 16.02, "cnt": 32}, "MoE_L3_fwd":{"total": 375.08, "avg": 11.72, "max": 10.78, "min": 15.84, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.62, "avg": 0.02, "max": 0.02, "min": 0.04, "cnt": 32}, "forward-send":{"total": 1.45, "avg": 0.72, "max": 0.71, "min": 0.73, "cnt": 2}, "forward-send-backward-recv":{"total": 321.42, "avg": 10.71, "max": 1.40, "min": 124.57, "cnt": 30}, "backward-compute":{"total": 1756.12, "avg": 54.88, "max": 53.75, "min": 56.45, "cnt": 32}, "MoE_L3_bwd":{"total": 393.30, "avg": 12.29, "max": 11.32, "min": 13.75, "cnt": 32}, "MoE_L2_bwd":{"total": 351.98, "avg": 11.00, "max": 10.31, "min": 12.09, "cnt": 32}, "MoE_L1_bwd":{"total": 365.32, "avg": 11.42, "max": 10.74, "min": 11.89, "cnt": 32}, "MoE_L0_bwd":{"total": 424.10, "avg": 13.25, "max": 12.23, "min": 14.73, "cnt": 32}, "backward-send-forward-recv":{"total": 823.68, "avg": 28.40, "max": 1.81, "min": 393.55, "cnt": 29}, "backward-send":{"total": 2.86, "avg": 0.95, "max": 0.89, "min": 0.99, "cnt": 3}, "backward-recv":{"total": 126.06, "avg": 63.03, "max": 57.59, "min": 68.48, "cnt": 2}, "backward-params-all-reduce":{"total": 487.35, "avg": 487.35, "max": 487.35, "min": 487.35, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 259.29, "avg": 259.29, "max": 259.29, "min": 259.29, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 215.15, "avg": 215.15, "max": 215.15, "min": 215.15, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.72, "avg": 6.72, "max": 6.72, "min": 6.72, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.49, "avg": 3.49, "max": 3.49, "min": 3.49, "cnt": 1}}}
{"type":"time", "iteration": 190, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 58.66, "avg": 19.55, "max": 1.06, "min": 56.42, "cnt": 3}, "forward-compute":{"total": 1897.73, "avg": 59.30, "max": 53.33, "min": 65.88, "cnt": 32}, "fwd-compute":{"total": 1894.25, "avg": 59.20, "max": 53.25, "min": 65.75, "cnt": 32}, "batch-generator":{"total": 43.27, "avg": 1.35, "max": 0.72, "min": 2.15, "cnt": 32}, "fwd-embedding":{"total": 0.87, "avg": 0.03, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1837.21, "avg": 57.41, "max": 52.15, "min": 63.68, "cnt": 32}, "fwd-layernorm":{"total": 10.94, "avg": 0.09, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 115.97, "avg": 0.91, "max": 0.74, "min": 1.51, "cnt": 128}, "fwd-misc":{"total": 22.74, "avg": 0.18, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1664.49, "avg": 13.00, "max": 10.84, "min": 18.98, "cnt": 128}, "MoE_L0_fwd":{"total": 488.60, "avg": 15.27, "max": 12.47, "min": 18.89, "cnt": 32}, "MoEMLP":{"total": 1645.74, "avg": 12.86, "max": 10.73, "min": 18.84, "cnt": 128}, "MoE_L1_fwd":{"total": 404.25, "avg": 12.63, "max": 11.49, "min": 16.82, "cnt": 32}, "MoE_L2_fwd":{"total": 383.67, "avg": 11.99, "max": 11.05, "min": 14.92, "cnt": 32}, "MoE_L3_fwd":{"total": 375.90, "avg": 11.75, "max": 10.77, "min": 17.36, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 9.15, "avg": 4.57, "max": 1.02, "min": 8.13, "cnt": 2}, "forward-send-backward-recv":{"total": 740.21, "avg": 24.67, "max": 1.46, "min": 187.05, "cnt": 30}, "backward-compute":{"total": 1776.30, "avg": 55.51, "max": 51.95, "min": 60.61, "cnt": 32}, "MoE_L3_bwd":{"total": 403.54, "avg": 12.61, "max": 11.32, "min": 14.03, "cnt": 32}, "MoE_L2_bwd":{"total": 357.68, "avg": 11.18, "max": 9.82, "min": 14.50, "cnt": 32}, "MoE_L1_bwd":{"total": 366.00, "avg": 11.44, "max": 11.02, "min": 13.72, "cnt": 32}, "MoE_L0_bwd":{"total": 434.43, "avg": 13.58, "max": 12.86, "min": 16.83, "cnt": 32}, "backward-send-forward-recv":{"total": 484.39, "avg": 16.70, "max": 2.00, "min": 126.91, "cnt": 29}, "backward-send":{"total": 3.13, "avg": 1.04, "max": 0.96, "min": 1.11, "cnt": 3}, "backward-recv":{"total": 141.12, "avg": 70.56, "max": 69.67, "min": 71.45, "cnt": 2}, "backward-params-all-reduce":{"total": 484.83, "avg": 484.83, "max": 484.83, "min": 484.83, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 250.88, "avg": 250.88, "max": 250.88, "min": 250.88, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 211.03, "avg": 211.03, "max": 211.03, "min": 211.03, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.25, "avg": 3.25, "max": 3.25, "min": 3.25, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.48, "avg": 3.48, "max": 3.48, "min": 3.48, "cnt": 1}}}
{"type":"time", "iteration": 191, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 62.91, "avg": 20.97, "max": 1.24, "min": 60.00, "cnt": 3}, "forward-compute":{"total": 1904.74, "avg": 59.52, "max": 52.40, "min": 68.10, "cnt": 32}, "fwd-compute":{"total": 1900.88, "avg": 59.40, "max": 52.33, "min": 67.99, "cnt": 32}, "batch-generator":{"total": 45.33, "avg": 1.42, "max": 0.73, "min": 2.57, "cnt": 32}, "fwd-embedding":{"total": 0.86, "avg": 0.03, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1841.58, "avg": 57.55, "max": 51.28, "min": 65.77, "cnt": 32}, "fwd-layernorm":{"total": 11.40, "avg": 0.09, "max": 0.06, "min": 0.22, "cnt": 128}, "fwd-attn":{"total": 117.48, "avg": 0.92, "max": 0.74, "min": 1.97, "cnt": 128}, "fwd-misc":{"total": 23.28, "avg": 0.18, "max": 0.11, "min": 0.40, "cnt": 128}, "fwd-MLP":{"total": 1666.05, "avg": 13.02, "max": 10.64, "min": 20.23, "cnt": 128}, "MoE_L0_fwd":{"total": 505.62, "avg": 15.80, "max": 12.50, "min": 20.08, "cnt": 32}, "MoEMLP":{"total": 1647.22, "avg": 12.87, "max": 10.53, "min": 20.00, "cnt": 128}, "MoE_L1_fwd":{"total": 405.57, "avg": 12.67, "max": 11.48, "min": 16.10, "cnt": 32}, "MoE_L2_fwd":{"total": 378.97, "avg": 11.84, "max": 11.01, "min": 17.94, "cnt": 32}, "MoE_L3_fwd":{"total": 363.82, "avg": 11.37, "max": 10.57, "min": 15.19, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.56, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 2.80, "avg": 1.40, "max": 0.92, "min": 1.89, "cnt": 2}, "forward-send-backward-recv":{"total": 864.24, "avg": 28.81, "max": 1.57, "min": 159.23, "cnt": 30}, "backward-compute":{"total": 1748.18, "avg": 54.63, "max": 52.56, "min": 57.81, "cnt": 32}, "MoE_L3_bwd":{"total": 393.27, "avg": 12.29, "max": 11.49, "min": 14.11, "cnt": 32}, "MoE_L2_bwd":{"total": 348.74, "avg": 10.90, "max": 9.79, "min": 11.37, "cnt": 32}, "MoE_L1_bwd":{"total": 366.79, "avg": 11.46, "max": 11.02, "min": 12.37, "cnt": 32}, "MoE_L0_bwd":{"total": 421.77, "avg": 13.18, "max": 12.47, "min": 13.98, "cnt": 32}, "backward-send-forward-recv":{"total": 162.62, "avg": 5.61, "max": 1.92, "min": 51.69, "cnt": 29}, "backward-send":{"total": 3.08, "avg": 1.03, "max": 0.97, "min": 1.09, "cnt": 3}, "backward-recv":{"total": 191.36, "avg": 95.68, "max": 67.69, "min": 123.67, "cnt": 2}, "backward-params-all-reduce":{"total": 486.86, "avg": 486.86, "max": 486.86, "min": 486.86, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 252.65, "avg": 252.65, "max": 252.65, "min": 252.65, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 212.77, "avg": 212.77, "max": 212.77, "min": 212.77, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}}}
{"type":"time", "iteration": 192, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 59.35, "avg": 19.78, "max": 0.94, "min": 57.16, "cnt": 3}, "forward-compute":{"total": 1966.44, "avg": 61.45, "max": 53.44, "min": 118.81, "cnt": 32}, "fwd-compute":{"total": 1962.54, "avg": 61.33, "max": 53.36, "min": 118.71, "cnt": 32}, "batch-generator":{"total": 46.12, "avg": 1.44, "max": 0.72, "min": 2.12, "cnt": 32}, "fwd-embedding":{"total": 0.90, "avg": 0.03, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1901.47, "avg": 59.42, "max": 52.28, "min": 117.60, "cnt": 32}, "fwd-layernorm":{"total": 11.64, "avg": 0.09, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 119.30, "avg": 0.93, "max": 0.74, "min": 1.54, "cnt": 128}, "fwd-misc":{"total": 24.01, "avg": 0.19, "max": 0.11, "min": 0.38, "cnt": 128}, "fwd-MLP":{"total": 1722.53, "avg": 13.46, "max": 10.43, "min": 79.54, "cnt": 128}, "MoE_L0_fwd":{"total": 581.73, "avg": 18.18, "max": 12.78, "min": 79.46, "cnt": 32}, "MoEMLP":{"total": 1703.27, "avg": 13.31, "max": 10.33, "min": 79.42, "cnt": 128}, "MoE_L1_fwd":{"total": 404.81, "avg": 12.65, "max": 11.73, "min": 14.08, "cnt": 32}, "MoE_L2_fwd":{"total": 367.57, "avg": 11.49, "max": 10.62, "min": 12.30, "cnt": 32}, "MoE_L3_fwd":{"total": 356.08, "avg": 11.13, "max": 10.36, "min": 13.50, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.04, "cnt": 32}, "forward-send":{"total": 3.55, "avg": 1.78, "max": 0.90, "min": 2.65, "cnt": 2}, "forward-send-backward-recv":{"total": 953.62, "avg": 31.79, "max": 4.74, "min": 220.24, "cnt": 30}, "backward-compute":{"total": 1741.39, "avg": 54.42, "max": 51.37, "min": 56.40, "cnt": 32}, "MoE_L3_bwd":{"total": 389.82, "avg": 12.18, "max": 11.37, "min": 13.60, "cnt": 32}, "MoE_L2_bwd":{"total": 346.85, "avg": 10.84, "max": 10.18, "min": 11.35, "cnt": 32}, "MoE_L1_bwd":{"total": 370.03, "avg": 11.56, "max": 11.08, "min": 12.10, "cnt": 32}, "MoE_L0_bwd":{"total": 421.02, "avg": 13.16, "max": 12.05, "min": 16.12, "cnt": 32}, "backward-send-forward-recv":{"total": 65.57, "avg": 2.26, "max": 1.60, "min": 3.27, "cnt": 29}, "backward-send":{"total": 4.33, "avg": 1.44, "max": 1.17, "min": 1.96, "cnt": 3}, "backward-recv":{"total": 136.23, "avg": 68.12, "max": 67.79, "min": 68.45, "cnt": 2}, "backward-params-all-reduce":{"total": 489.34, "avg": 489.34, "max": 489.34, "min": 489.34, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 257.20, "avg": 257.20, "max": 257.20, "min": 257.20, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 212.99, "avg": 212.99, "max": 212.99, "min": 212.99, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.85, "avg": 6.85, "max": 6.85, "min": 6.85, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.47, "avg": 3.47, "max": 3.47, "min": 3.47, "cnt": 1}}}
{"type":"time", "iteration": 193, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.10, "avg": 0.10, "max": 0.10, "min": 0.10, "cnt": 1}, "forward-recv":{"total": 58.18, "avg": 19.39, "max": 1.05, "min": 56.03, "cnt": 3}, "forward-compute":{"total": 1852.26, "avg": 57.88, "max": 52.25, "min": 64.40, "cnt": 32}, "fwd-compute":{"total": 1849.14, "avg": 57.79, "max": 52.18, "min": 64.33, "cnt": 32}, "batch-generator":{"total": 53.14, "avg": 1.66, "max": 0.70, "min": 3.92, "cnt": 32}, "fwd-embedding":{"total": 0.64, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1783.68, "avg": 55.74, "max": 51.19, "min": 60.40, "cnt": 32}, "fwd-layernorm":{"total": 9.92, "avg": 0.08, "max": 0.06, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 107.73, "avg": 0.84, "max": 0.74, "min": 1.49, "cnt": 128}, "fwd-misc":{"total": 20.98, "avg": 0.16, "max": 0.11, "min": 0.45, "cnt": 128}, "fwd-MLP":{"total": 1624.36, "avg": 12.69, "max": 10.41, "min": 20.31, "cnt": 128}, "MoE_L0_fwd":{"total": 486.71, "avg": 15.21, "max": 12.24, "min": 20.23, "cnt": 32}, "MoEMLP":{"total": 1607.26, "avg": 12.56, "max": 10.31, "min": 20.18, "cnt": 128}, "MoE_L1_fwd":{"total": 402.62, "avg": 12.58, "max": 11.63, "min": 15.19, "cnt": 32}, "MoE_L2_fwd":{"total": 367.36, "avg": 11.48, "max": 10.87, "min": 15.83, "cnt": 32}, "MoE_L3_fwd":{"total": 356.77, "avg": 11.15, "max": 10.35, "min": 12.88, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.93, "avg": 0.96, "max": 0.91, "min": 1.02, "cnt": 2}, "forward-send-backward-recv":{"total": 480.13, "avg": 16.00, "max": 1.80, "min": 159.14, "cnt": 30}, "backward-compute":{"total": 1750.78, "avg": 54.71, "max": 52.15, "min": 57.47, "cnt": 32}, "MoE_L3_bwd":{"total": 386.41, "avg": 12.08, "max": 10.30, "min": 14.62, "cnt": 32}, "MoE_L2_bwd":{"total": 354.46, "avg": 11.08, "max": 9.98, "min": 12.09, "cnt": 32}, "MoE_L1_bwd":{"total": 373.65, "avg": 11.68, "max": 11.23, "min": 12.20, "cnt": 32}, "MoE_L0_bwd":{"total": 420.53, "avg": 13.14, "max": 12.80, "min": 13.48, "cnt": 32}, "backward-send-forward-recv":{"total": 2976.51, "avg": 102.64, "max": 1.83, "min": 601.71, "cnt": 29}, "backward-send":{"total": 2.92, "avg": 0.97, "max": 0.82, "min": 1.11, "cnt": 3}, "backward-recv":{"total": 168.05, "avg": 84.03, "max": 54.03, "min": 114.03, "cnt": 2}, "backward-params-all-reduce":{"total": 483.47, "avg": 483.47, "max": 483.47, "min": 483.47, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "optimizer":{"total": 259.02, "avg": 259.02, "max": 259.02, "min": 259.02, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 214.75, "avg": 214.75, "max": 214.75, "min": 214.75, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.82, "avg": 6.82, "max": 6.82, "min": 6.82, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 194, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.06, "avg": 0.06, "max": 0.06, "min": 0.06, "cnt": 1}, "forward-recv":{"total": 57.28, "avg": 19.09, "max": 0.90, "min": 55.45, "cnt": 3}, "forward-compute":{"total": 1882.08, "avg": 58.81, "max": 53.74, "min": 66.46, "cnt": 32}, "fwd-compute":{"total": 1878.59, "avg": 58.71, "max": 53.67, "min": 66.34, "cnt": 32}, "batch-generator":{"total": 45.75, "avg": 1.43, "max": 0.65, "min": 1.96, "cnt": 32}, "fwd-embedding":{"total": 0.80, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1819.47, "avg": 56.86, "max": 52.58, "min": 64.32, "cnt": 32}, "fwd-layernorm":{"total": 11.12, "avg": 0.09, "max": 0.06, "min": 0.22, "cnt": 128}, "fwd-attn":{"total": 118.29, "avg": 0.92, "max": 0.74, "min": 3.42, "cnt": 128}, "fwd-misc":{"total": 23.51, "avg": 0.18, "max": 0.11, "min": 0.50, "cnt": 128}, "fwd-MLP":{"total": 1644.13, "avg": 12.84, "max": 10.54, "min": 18.50, "cnt": 128}, "MoE_L0_fwd":{"total": 494.86, "avg": 15.46, "max": 12.54, "min": 18.41, "cnt": 32}, "MoEMLP":{"total": 1626.09, "avg": 12.70, "max": 10.41, "min": 18.37, "cnt": 128}, "MoE_L1_fwd":{"total": 405.90, "avg": 12.68, "max": 11.75, "min": 15.01, "cnt": 32}, "MoE_L2_fwd":{"total": 371.63, "avg": 11.61, "max": 10.91, "min": 17.36, "cnt": 32}, "MoE_L3_fwd":{"total": 360.25, "avg": 11.26, "max": 10.46, "min": 15.86, "cnt": 32}, "fwd-pooler":{"total": 0.31, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 2.73, "avg": 1.37, "max": 0.76, "min": 1.98, "cnt": 2}, "forward-send-backward-recv":{"total": 317.32, "avg": 10.58, "max": 1.37, "min": 129.49, "cnt": 30}, "backward-compute":{"total": 1741.06, "avg": 54.41, "max": 53.06, "min": 55.98, "cnt": 32}, "MoE_L3_bwd":{"total": 393.27, "avg": 12.29, "max": 11.44, "min": 13.49, "cnt": 32}, "MoE_L2_bwd":{"total": 341.10, "avg": 10.66, "max": 10.18, "min": 11.50, "cnt": 32}, "MoE_L1_bwd":{"total": 371.77, "avg": 11.62, "max": 11.08, "min": 13.19, "cnt": 32}, "MoE_L0_bwd":{"total": 419.03, "avg": 13.09, "max": 12.32, "min": 13.65, "cnt": 32}, "backward-send-forward-recv":{"total": 1203.10, "avg": 41.49, "max": 1.88, "min": 400.71, "cnt": 29}, "backward-send":{"total": 3.14, "avg": 1.05, "max": 0.83, "min": 1.24, "cnt": 3}, "backward-recv":{"total": 139.62, "avg": 69.81, "max": 69.28, "min": 70.33, "cnt": 2}, "backward-params-all-reduce":{"total": 487.21, "avg": 487.21, "max": 487.21, "min": 487.21, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 254.73, "avg": 254.73, "max": 254.73, "min": 254.73, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 210.72, "avg": 210.72, "max": 210.72, "min": 210.72, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.82, "avg": 6.82, "max": 6.82, "min": 6.82, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 195, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 58.82, "avg": 19.61, "max": 1.34, "min": 55.84, "cnt": 3}, "forward-compute":{"total": 1887.84, "avg": 58.99, "max": 52.41, "min": 64.71, "cnt": 32}, "fwd-compute":{"total": 1884.17, "avg": 58.88, "max": 52.32, "min": 64.54, "cnt": 32}, "batch-generator":{"total": 46.02, "avg": 1.44, "max": 0.74, "min": 2.60, "cnt": 32}, "fwd-embedding":{"total": 0.81, "avg": 0.03, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1824.20, "avg": 57.01, "max": 51.14, "min": 62.46, "cnt": 32}, "fwd-layernorm":{"total": 10.75, "avg": 0.08, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 117.16, "avg": 0.92, "max": 0.74, "min": 2.12, "cnt": 128}, "fwd-misc":{"total": 22.24, "avg": 0.17, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1651.58, "avg": 12.90, "max": 10.68, "min": 19.14, "cnt": 128}, "MoE_L0_fwd":{"total": 499.02, "avg": 15.59, "max": 12.77, "min": 19.06, "cnt": 32}, "MoEMLP":{"total": 1633.46, "avg": 12.76, "max": 10.58, "min": 19.01, "cnt": 128}, "MoE_L1_fwd":{"total": 410.03, "avg": 12.81, "max": 11.90, "min": 15.24, "cnt": 32}, "MoE_L2_fwd":{"total": 371.61, "avg": 11.61, "max": 11.07, "min": 15.79, "cnt": 32}, "MoE_L3_fwd":{"total": 359.34, "avg": 11.23, "max": 10.62, "min": 16.26, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.57, "avg": 0.79, "max": 0.64, "min": 0.93, "cnt": 2}, "forward-send-backward-recv":{"total": 250.71, "avg": 8.36, "max": 1.23, "min": 113.97, "cnt": 30}, "backward-compute":{"total": 1757.75, "avg": 54.93, "max": 53.03, "min": 60.79, "cnt": 32}, "MoE_L3_bwd":{"total": 383.99, "avg": 12.00, "max": 11.08, "min": 13.37, "cnt": 32}, "MoE_L2_bwd":{"total": 355.50, "avg": 11.11, "max": 10.49, "min": 13.12, "cnt": 32}, "MoE_L1_bwd":{"total": 374.72, "avg": 11.71, "max": 11.05, "min": 16.72, "cnt": 32}, "MoE_L0_bwd":{"total": 428.52, "avg": 13.39, "max": 12.58, "min": 14.92, "cnt": 32}, "backward-send-forward-recv":{"total": 1644.53, "avg": 56.71, "max": 1.62, "min": 445.53, "cnt": 29}, "backward-send":{"total": 2.43, "avg": 0.81, "max": 0.64, "min": 0.97, "cnt": 3}, "backward-recv":{"total": 136.23, "avg": 68.11, "max": 67.94, "min": 68.28, "cnt": 2}, "backward-params-all-reduce":{"total": 489.58, "avg": 489.58, "max": 489.58, "min": 489.58, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 250.62, "avg": 250.62, "max": 250.62, "min": 250.62, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 210.76, "avg": 210.76, "max": 210.76, "min": 210.76, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.24, "avg": 3.24, "max": 3.24, "min": 3.24, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 196, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 66.53, "avg": 22.18, "max": 1.68, "min": 63.10, "cnt": 3}, "forward-compute":{"total": 1893.28, "avg": 59.16, "max": 54.76, "min": 62.34, "cnt": 32}, "fwd-compute":{"total": 1889.81, "avg": 59.06, "max": 54.69, "min": 62.23, "cnt": 32}, "batch-generator":{"total": 46.13, "avg": 1.44, "max": 0.69, "min": 3.51, "cnt": 32}, "fwd-embedding":{"total": 0.81, "avg": 0.03, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1830.11, "avg": 57.19, "max": 53.30, "min": 60.44, "cnt": 32}, "fwd-layernorm":{"total": 10.78, "avg": 0.08, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 116.75, "avg": 0.91, "max": 0.74, "min": 2.10, "cnt": 128}, "fwd-misc":{"total": 22.79, "avg": 0.18, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1657.41, "avg": 12.95, "max": 10.31, "min": 19.55, "cnt": 128}, "MoE_L0_fwd":{"total": 514.51, "avg": 16.08, "max": 12.76, "min": 19.47, "cnt": 32}, "MoEMLP":{"total": 1639.30, "avg": 12.81, "max": 10.21, "min": 19.43, "cnt": 128}, "MoE_L1_fwd":{"total": 405.30, "avg": 12.67, "max": 11.67, "min": 13.55, "cnt": 32}, "MoE_L2_fwd":{"total": 377.15, "avg": 11.79, "max": 11.01, "min": 13.03, "cnt": 32}, "MoE_L3_fwd":{"total": 348.86, "avg": 10.90, "max": 10.24, "min": 14.36, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.68, "avg": 0.84, "max": 0.72, "min": 0.96, "cnt": 2}, "forward-send-backward-recv":{"total": 443.11, "avg": 14.77, "max": 1.55, "min": 123.73, "cnt": 30}, "backward-compute":{"total": 1772.54, "avg": 55.39, "max": 53.84, "min": 57.81, "cnt": 32}, "MoE_L3_bwd":{"total": 393.15, "avg": 12.29, "max": 11.30, "min": 14.26, "cnt": 32}, "MoE_L2_bwd":{"total": 361.59, "avg": 11.30, "max": 10.75, "min": 13.62, "cnt": 32}, "MoE_L1_bwd":{"total": 367.91, "avg": 11.50, "max": 10.85, "min": 12.35, "cnt": 32}, "MoE_L0_bwd":{"total": 433.45, "avg": 13.55, "max": 12.93, "min": 15.02, "cnt": 32}, "backward-send-forward-recv":{"total": 467.53, "avg": 16.12, "max": 1.97, "min": 94.54, "cnt": 29}, "backward-send":{"total": 2.65, "avg": 0.88, "max": 0.75, "min": 0.97, "cnt": 3}, "backward-recv":{"total": 124.05, "avg": 62.02, "max": 59.93, "min": 64.11, "cnt": 2}, "backward-params-all-reduce":{"total": 487.08, "avg": 487.08, "max": 487.08, "min": 487.08, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 256.71, "avg": 256.71, "max": 256.71, "min": 256.71, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 212.66, "avg": 212.66, "max": 212.66, "min": 212.66, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.78, "avg": 6.78, "max": 6.78, "min": 6.78, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 197, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 65.40, "avg": 21.80, "max": 0.97, "min": 60.91, "cnt": 3}, "forward-compute":{"total": 1873.73, "avg": 58.55, "max": 51.11, "min": 62.41, "cnt": 32}, "fwd-compute":{"total": 1870.21, "avg": 58.44, "max": 51.04, "min": 62.33, "cnt": 32}, "batch-generator":{"total": 45.08, "avg": 1.41, "max": 0.67, "min": 2.50, "cnt": 32}, "fwd-embedding":{"total": 0.83, "avg": 0.03, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1810.54, "avg": 56.58, "max": 50.01, "min": 60.27, "cnt": 32}, "fwd-layernorm":{"total": 11.08, "avg": 0.09, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 115.14, "avg": 0.90, "max": 0.74, "min": 1.59, "cnt": 128}, "fwd-misc":{"total": 23.13, "avg": 0.18, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1638.46, "avg": 12.80, "max": 10.34, "min": 19.48, "cnt": 128}, "MoE_L0_fwd":{"total": 500.92, "avg": 15.65, "max": 12.64, "min": 19.40, "cnt": 32}, "MoEMLP":{"total": 1620.02, "avg": 12.66, "max": 10.22, "min": 19.35, "cnt": 128}, "MoE_L1_fwd":{"total": 396.46, "avg": 12.39, "max": 11.41, "min": 14.19, "cnt": 32}, "MoE_L2_fwd":{"total": 377.74, "avg": 11.80, "max": 10.99, "min": 15.14, "cnt": 32}, "MoE_L3_fwd":{"total": 351.66, "avg": 10.99, "max": 10.27, "min": 11.87, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 7.57, "avg": 3.79, "max": 0.61, "min": 6.97, "cnt": 2}, "forward-send-backward-recv":{"total": 329.64, "avg": 10.99, "max": 1.28, "min": 132.51, "cnt": 30}, "backward-compute":{"total": 1773.57, "avg": 55.42, "max": 53.88, "min": 58.47, "cnt": 32}, "MoE_L3_bwd":{"total": 386.30, "avg": 12.07, "max": 11.43, "min": 13.62, "cnt": 32}, "MoE_L2_bwd":{"total": 370.01, "avg": 11.56, "max": 10.41, "min": 12.43, "cnt": 32}, "MoE_L1_bwd":{"total": 370.24, "avg": 11.57, "max": 11.14, "min": 13.47, "cnt": 32}, "MoE_L0_bwd":{"total": 429.00, "avg": 13.41, "max": 12.91, "min": 13.90, "cnt": 32}, "backward-send-forward-recv":{"total": 435.38, "avg": 15.01, "max": 1.94, "min": 143.66, "cnt": 29}, "backward-send":{"total": 31.65, "avg": 10.55, "max": 0.82, "min": 29.65, "cnt": 3}, "backward-recv":{"total": 136.35, "avg": 68.17, "max": 66.04, "min": 70.30, "cnt": 2}, "backward-params-all-reduce":{"total": 481.59, "avg": 481.59, "max": 481.59, "min": 481.59, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 254.41, "avg": 254.41, "max": 254.41, "min": 254.41, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 210.26, "avg": 210.26, "max": 210.26, "min": 210.26, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.82, "avg": 6.82, "max": 6.82, "min": 6.82, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 198, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 85.04, "avg": 28.35, "max": 0.87, "min": 77.16, "cnt": 3}, "forward-compute":{"total": 1867.32, "avg": 58.35, "max": 52.69, "min": 66.63, "cnt": 32}, "fwd-compute":{"total": 1863.98, "avg": 58.25, "max": 52.63, "min": 66.47, "cnt": 32}, "batch-generator":{"total": 54.69, "avg": 1.71, "max": 0.71, "min": 3.70, "cnt": 32}, "fwd-embedding":{"total": 0.80, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1795.59, "avg": 56.11, "max": 51.62, "min": 64.04, "cnt": 32}, "fwd-layernorm":{"total": 10.95, "avg": 0.09, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 113.44, "avg": 0.89, "max": 0.74, "min": 1.55, "cnt": 128}, "fwd-misc":{"total": 22.33, "avg": 0.17, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1626.54, "avg": 12.71, "max": 10.07, "min": 19.10, "cnt": 128}, "MoE_L0_fwd":{"total": 494.39, "avg": 15.45, "max": 12.92, "min": 19.02, "cnt": 32}, "MoEMLP":{"total": 1608.46, "avg": 12.57, "max": 9.96, "min": 18.97, "cnt": 128}, "MoE_L1_fwd":{"total": 398.66, "avg": 12.46, "max": 11.19, "min": 15.29, "cnt": 32}, "MoE_L2_fwd":{"total": 375.72, "avg": 11.74, "max": 11.19, "min": 13.26, "cnt": 32}, "MoE_L3_fwd":{"total": 346.29, "avg": 10.82, "max": 10.00, "min": 15.69, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.24, "avg": 0.62, "max": 0.57, "min": 0.67, "cnt": 2}, "forward-send-backward-recv":{"total": 175.35, "avg": 5.85, "max": 1.38, "min": 110.42, "cnt": 30}, "backward-compute":{"total": 1769.73, "avg": 55.30, "max": 52.54, "min": 58.92, "cnt": 32}, "MoE_L3_bwd":{"total": 388.20, "avg": 12.13, "max": 11.11, "min": 14.79, "cnt": 32}, "MoE_L2_bwd":{"total": 373.98, "avg": 11.69, "max": 10.63, "min": 12.72, "cnt": 32}, "MoE_L1_bwd":{"total": 362.57, "avg": 11.33, "max": 10.69, "min": 12.82, "cnt": 32}, "MoE_L0_bwd":{"total": 426.90, "avg": 13.34, "max": 12.74, "min": 15.06, "cnt": 32}, "backward-send-forward-recv":{"total": 1600.27, "avg": 55.18, "max": 2.75, "min": 250.05, "cnt": 29}, "backward-send":{"total": 3.27, "avg": 1.09, "max": 1.03, "min": 1.16, "cnt": 3}, "backward-recv":{"total": 135.70, "avg": 67.85, "max": 66.37, "min": 69.32, "cnt": 2}, "backward-params-all-reduce":{"total": 483.32, "avg": 483.32, "max": 483.32, "min": 483.32, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 256.36, "avg": 256.36, "max": 256.36, "min": 256.36, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.40, "avg": 3.40, "max": 3.40, "min": 3.40, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 216.38, "avg": 216.38, "max": 216.38, "min": 216.38, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.36, "avg": 3.36, "max": 3.36, "min": 3.36, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 199, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.06, "avg": 0.06, "max": 0.06, "min": 0.06, "cnt": 1}, "forward-recv":{"total": 61.79, "avg": 20.60, "max": 2.46, "min": 56.52, "cnt": 3}, "forward-compute":{"total": 1870.46, "avg": 58.45, "max": 52.31, "min": 64.28, "cnt": 32}, "fwd-compute":{"total": 1866.79, "avg": 58.34, "max": 52.23, "min": 64.12, "cnt": 32}, "batch-generator":{"total": 46.25, "avg": 1.45, "max": 0.72, "min": 2.36, "cnt": 32}, "fwd-embedding":{"total": 0.80, "avg": 0.03, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1806.80, "avg": 56.46, "max": 50.72, "min": 61.97, "cnt": 32}, "fwd-layernorm":{"total": 10.97, "avg": 0.09, "max": 0.06, "min": 0.27, "cnt": 128}, "fwd-attn":{"total": 114.63, "avg": 0.90, "max": 0.74, "min": 2.60, "cnt": 128}, "fwd-misc":{"total": 22.72, "avg": 0.18, "max": 0.11, "min": 0.38, "cnt": 128}, "fwd-MLP":{"total": 1635.98, "avg": 12.78, "max": 10.10, "min": 19.27, "cnt": 128}, "MoE_L0_fwd":{"total": 502.17, "avg": 15.69, "max": 12.33, "min": 19.14, "cnt": 32}, "MoEMLP":{"total": 1617.94, "avg": 12.64, "max": 9.99, "min": 19.10, "cnt": 128}, "MoE_L1_fwd":{"total": 390.68, "avg": 12.21, "max": 11.30, "min": 14.23, "cnt": 32}, "MoE_L2_fwd":{"total": 379.85, "avg": 11.87, "max": 11.00, "min": 12.98, "cnt": 32}, "MoE_L3_fwd":{"total": 351.80, "avg": 10.99, "max": 10.03, "min": 15.09, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.04, "cnt": 32}, "forward-send":{"total": 1.45, "avg": 0.72, "max": 0.64, "min": 0.81, "cnt": 2}, "forward-send-backward-recv":{"total": 1022.26, "avg": 34.08, "max": 1.62, "min": 334.42, "cnt": 30}, "backward-compute":{"total": 1727.40, "avg": 53.98, "max": 52.24, "min": 55.58, "cnt": 32}, "MoE_L3_bwd":{"total": 381.68, "avg": 11.93, "max": 11.06, "min": 13.96, "cnt": 32}, "MoE_L2_bwd":{"total": 348.53, "avg": 10.89, "max": 10.28, "min": 11.53, "cnt": 32}, "MoE_L1_bwd":{"total": 353.91, "avg": 11.06, "max": 10.45, "min": 11.70, "cnt": 32}, "MoE_L0_bwd":{"total": 426.03, "avg": 13.31, "max": 12.64, "min": 13.83, "cnt": 32}, "backward-send-forward-recv":{"total": 1437.64, "avg": 49.57, "max": 2.26, "min": 464.43, "cnt": 29}, "backward-send":{"total": 2.57, "avg": 0.86, "max": 0.69, "min": 0.98, "cnt": 3}, "backward-recv":{"total": 137.08, "avg": 68.54, "max": 64.96, "min": 72.12, "cnt": 2}, "backward-params-all-reduce":{"total": 490.81, "avg": 490.81, "max": 490.81, "min": 490.81, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 252.94, "avg": 252.94, "max": 252.94, "min": 252.94, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.36, "avg": 3.36, "max": 3.36, "min": 3.36, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 213.18, "avg": 213.18, "max": 213.18, "min": 213.18, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.31, "avg": 3.31, "max": 3.31, "min": 3.31, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 200, "rank": 20, "tp_rank": 0, "pp_rank": 1, "dp_rank": 4, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 64.75, "avg": 21.58, "max": 0.87, "min": 62.28, "cnt": 3}, "forward-compute":{"total": 1856.15, "avg": 58.00, "max": 50.86, "min": 67.98, "cnt": 32}, "fwd-compute":{"total": 1852.69, "avg": 57.90, "max": 50.79, "min": 67.87, "cnt": 32}, "batch-generator":{"total": 41.05, "avg": 1.28, "max": 0.70, "min": 1.96, "cnt": 32}, "fwd-embedding":{"total": 0.74, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1798.64, "avg": 56.21, "max": 49.77, "min": 66.34, "cnt": 32}, "fwd-layernorm":{"total": 10.35, "avg": 0.08, "max": 0.05, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 112.70, "avg": 0.88, "max": 0.74, "min": 1.59, "cnt": 128}, "fwd-misc":{"total": 21.87, "avg": 0.17, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1632.01, "avg": 12.75, "max": 10.24, "min": 21.43, "cnt": 128}, "MoE_L0_fwd":{"total": 511.87, "avg": 16.00, "max": 12.53, "min": 21.33, "cnt": 32}, "MoEMLP":{"total": 1614.70, "avg": 12.61, "max": 10.13, "min": 21.27, "cnt": 128}, "MoE_L1_fwd":{"total": 388.79, "avg": 12.15, "max": 11.14, "min": 15.96, "cnt": 32}, "MoE_L2_fwd":{"total": 378.25, "avg": 11.82, "max": 10.92, "min": 14.84, "cnt": 32}, "MoE_L3_fwd":{"total": 342.02, "avg": 10.69, "max": 10.17, "min": 11.46, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.55, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 4.52, "avg": 2.26, "max": 0.67, "min": 3.84, "cnt": 2}, "forward-send-backward-recv":{"total": 1062.58, "avg": 35.42, "max": 1.75, "min": 300.27, "cnt": 30}, "backward-compute":{"total": 1736.64, "avg": 54.27, "max": 52.04, "min": 58.38, "cnt": 32}, "MoE_L3_bwd":{"total": 385.25, "avg": 12.04, "max": 10.69, "min": 14.57, "cnt": 32}, "MoE_L2_bwd":{"total": 352.14, "avg": 11.00, "max": 10.37, "min": 11.84, "cnt": 32}, "MoE_L1_bwd":{"total": 349.83, "avg": 10.93, "max": 10.31, "min": 11.44, "cnt": 32}, "MoE_L0_bwd":{"total": 431.96, "avg": 13.50, "max": 12.72, "min": 17.30, "cnt": 32}, "backward-send-forward-recv":{"total": 1984.88, "avg": 68.44, "max": 1.94, "min": 651.29, "cnt": 29}, "backward-send":{"total": 3.12, "avg": 1.04, "max": 1.00, "min": 1.06, "cnt": 3}, "backward-recv":{"total": 139.00, "avg": 69.50, "max": 69.28, "min": 69.72, "cnt": 2}, "backward-params-all-reduce":{"total": 489.87, "avg": 489.87, "max": 489.87, "min": 489.87, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 260.61, "avg": 260.61, "max": 260.61, "min": 260.61, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 220.83, "avg": 220.83, "max": 220.83, "min": 220.83, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.27, "avg": 3.27, "max": 3.27, "min": 3.27, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}}}
