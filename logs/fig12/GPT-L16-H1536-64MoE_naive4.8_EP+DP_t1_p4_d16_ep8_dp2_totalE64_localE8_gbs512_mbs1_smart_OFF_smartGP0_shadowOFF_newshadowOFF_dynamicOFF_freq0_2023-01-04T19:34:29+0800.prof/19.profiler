{"type":"time", "iteration": -1, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 6958.31, "avg": 6958.31, "max": 6958.31, "min": 6958.31, "cnt": 1}, "train/valid/test-data-iterators-setup":{"total": 14766.63, "avg": 14766.63, "max": 14766.63, "min": 14766.63, "cnt": 1}}}
{"type":"time", "iteration": 1, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.88, "avg": 0.88, "max": 0.88, "min": 0.88, "cnt": 1}, "forward-recv":{"total": 4609.56, "avg": 1536.52, "max": 1.18, "min": 4606.99, "cnt": 3}, "forward-compute":{"total": 4000.64, "avg": 125.02, "max": 54.52, "min": 1521.26, "cnt": 32}, "fwd-compute":{"total": 3997.04, "avg": 124.91, "max": 54.44, "min": 1521.03, "cnt": 32}, "batch-generator":{"total": 58.35, "avg": 1.82, "max": 0.78, "min": 6.41, "cnt": 32}, "fwd-embedding":{"total": 0.67, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 3924.78, "avg": 122.65, "max": 53.25, "min": 1513.80, "cnt": 32}, "fwd-layernorm":{"total": 10.85, "avg": 0.08, "max": 0.05, "min": 0.29, "cnt": 128}, "fwd-attn":{"total": 696.53, "avg": 5.44, "max": 0.74, "min": 535.77, "cnt": 128}, "fwd-misc":{"total": 540.83, "avg": 4.23, "max": 0.11, "min": 518.41, "cnt": 128}, "fwd-MLP":{"total": 2649.10, "avg": 20.70, "max": 10.70, "min": 392.01, "cnt": 128}, "MoE_L0_fwd":{"total": 1435.62, "avg": 44.86, "max": 12.76, "min": 391.84, "cnt": 32}, "MoEMLP":{"total": 2630.84, "avg": 20.55, "max": 10.58, "min": 391.76, "cnt": 128}, "MoE_L1_fwd":{"total": 417.94, "avg": 13.06, "max": 10.83, "min": 17.78, "cnt": 32}, "MoE_L2_fwd":{"total": 402.37, "avg": 12.57, "max": 10.62, "min": 17.30, "cnt": 32}, "MoE_L3_fwd":{"total": 381.37, "avg": 11.92, "max": 10.81, "min": 17.29, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.64, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1795.42, "avg": 897.71, "max": 87.21, "min": 1708.22, "cnt": 2}, "forward-send-backward-recv":{"total": 3087.21, "avg": 102.91, "max": 1.03, "min": 2111.83, "cnt": 30}, "backward-compute":{"total": 1977.80, "avg": 61.81, "max": 46.69, "min": 444.71, "cnt": 32}, "MoE_L3_bwd":{"total": 455.46, "avg": 14.23, "max": 11.53, "min": 43.06, "cnt": 32}, "MoE_L2_bwd":{"total": 371.76, "avg": 11.62, "max": 9.92, "min": 38.49, "cnt": 32}, "MoE_L1_bwd":{"total": 297.10, "avg": 9.28, "max": 8.49, "min": 11.15, "cnt": 32}, "MoE_L0_bwd":{"total": 293.53, "avg": 9.17, "max": 8.75, "min": 11.58, "cnt": 32}, "backward-send-forward-recv":{"total": 8561.20, "avg": 295.21, "max": 1.23, "min": 1223.29, "cnt": 29}, "backward-send":{"total": 2.47, "avg": 0.82, "max": 0.63, "min": 1.16, "cnt": 3}, "backward-recv":{"total": 690.60, "avg": 345.30, "max": 68.72, "min": 621.89, "cnt": 2}, "backward-params-all-reduce":{"total": 833.96, "avg": 833.96, "max": 833.96, "min": 833.96, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.06, "avg": 0.06, "max": 0.06, "min": 0.06, "cnt": 1}, "optimizer":{"total": 501.94, "avg": 501.94, "max": 501.94, "min": 501.94, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 291.89, "avg": 291.89, "max": 291.89, "min": 291.89, "cnt": 1}, "optimizer-clip-main-grad":{"total": 7.71, "avg": 7.71, "max": 7.71, "min": 7.71, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.96, "avg": 3.96, "max": 3.96, "min": 3.96, "cnt": 1}}}
{"type":"time", "iteration": 2, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.12, "avg": 0.12, "max": 0.12, "min": 0.12, "cnt": 1}, "forward-recv":{"total": 169.30, "avg": 56.43, "max": 1.10, "min": 165.45, "cnt": 3}, "forward-compute":{"total": 2433.90, "avg": 76.06, "max": 52.75, "min": 162.69, "cnt": 32}, "fwd-compute":{"total": 2430.34, "avg": 75.95, "max": 52.66, "min": 162.53, "cnt": 32}, "batch-generator":{"total": 97.01, "avg": 3.03, "max": 0.70, "min": 37.91, "cnt": 32}, "fwd-embedding":{"total": 0.67, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 2320.08, "avg": 72.50, "max": 50.21, "min": 160.31, "cnt": 32}, "fwd-layernorm":{"total": 10.33, "avg": 0.08, "max": 0.05, "min": 0.23, "cnt": 128}, "fwd-attn":{"total": 111.21, "avg": 0.87, "max": 0.74, "min": 1.67, "cnt": 128}, "fwd-misc":{"total": 22.29, "avg": 0.17, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 2154.23, "avg": 16.83, "max": 10.40, "min": 119.33, "cnt": 128}, "MoE_L0_fwd":{"total": 1034.45, "avg": 32.33, "max": 12.48, "min": 119.19, "cnt": 32}, "MoEMLP":{"total": 2136.52, "avg": 16.69, "max": 10.29, "min": 119.12, "cnt": 128}, "MoE_L1_fwd":{"total": 377.66, "avg": 11.80, "max": 10.76, "min": 13.14, "cnt": 32}, "MoE_L2_fwd":{"total": 350.05, "avg": 10.94, "max": 10.33, "min": 14.67, "cnt": 32}, "MoE_L3_fwd":{"total": 380.87, "avg": 11.90, "max": 10.68, "min": 21.71, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.62, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.62, "avg": 0.81, "max": 0.81, "min": 0.81, "cnt": 2}, "forward-send-backward-recv":{"total": 1195.40, "avg": 39.85, "max": 1.14, "min": 210.21, "cnt": 30}, "backward-compute":{"total": 1749.62, "avg": 54.68, "max": 49.53, "min": 59.61, "cnt": 32}, "MoE_L3_bwd":{"total": 441.90, "avg": 13.81, "max": 11.88, "min": 18.78, "cnt": 32}, "MoE_L2_bwd":{"total": 368.39, "avg": 11.51, "max": 10.41, "min": 12.62, "cnt": 32}, "MoE_L1_bwd":{"total": 353.56, "avg": 11.05, "max": 10.22, "min": 13.00, "cnt": 32}, "MoE_L0_bwd":{"total": 367.33, "avg": 11.48, "max": 10.70, "min": 13.21, "cnt": 32}, "backward-send-forward-recv":{"total": 9807.60, "avg": 338.19, "max": 1.76, "min": 1130.92, "cnt": 29}, "backward-send":{"total": 2.87, "avg": 0.96, "max": 0.79, "min": 1.22, "cnt": 3}, "backward-recv":{"total": 816.07, "avg": 408.04, "max": 61.83, "min": 754.24, "cnt": 2}, "backward-params-all-reduce":{"total": 499.30, "avg": 499.30, "max": 499.30, "min": 499.30, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 242.53, "avg": 242.53, "max": 242.53, "min": 242.53, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 197.41, "avg": 197.41, "max": 197.41, "min": 197.41, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.91, "avg": 6.91, "max": 6.91, "min": 6.91, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 3, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.10, "avg": 0.10, "max": 0.10, "min": 0.10, "cnt": 1}, "forward-recv":{"total": 87.93, "avg": 29.31, "max": 4.28, "min": 74.14, "cnt": 3}, "forward-compute":{"total": 2915.94, "avg": 91.12, "max": 52.43, "min": 462.15, "cnt": 32}, "fwd-compute":{"total": 2912.82, "avg": 91.03, "max": 52.36, "min": 462.05, "cnt": 32}, "batch-generator":{"total": 107.35, "avg": 3.35, "max": 0.63, "min": 63.23, "cnt": 32}, "fwd-embedding":{"total": 0.62, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 2793.05, "avg": 87.28, "max": 51.43, "min": 460.54, "cnt": 32}, "fwd-layernorm":{"total": 9.67, "avg": 0.08, "max": 0.05, "min": 0.23, "cnt": 128}, "fwd-attn":{"total": 108.68, "avg": 0.85, "max": 0.74, "min": 1.91, "cnt": 128}, "fwd-misc":{"total": 21.35, "avg": 0.17, "max": 0.11, "min": 0.38, "cnt": 128}, "fwd-MLP":{"total": 2632.02, "avg": 20.56, "max": 11.01, "min": 419.60, "cnt": 128}, "MoE_L0_fwd":{"total": 1435.91, "avg": 44.87, "max": 11.44, "min": 419.52, "cnt": 32}, "MoEMLP":{"total": 2614.86, "avg": 20.43, "max": 10.90, "min": 419.47, "cnt": 128}, "MoE_L1_fwd":{"total": 423.08, "avg": 13.22, "max": 12.33, "min": 15.33, "cnt": 32}, "MoE_L2_fwd":{"total": 383.23, "avg": 11.98, "max": 11.37, "min": 13.15, "cnt": 32}, "MoE_L3_fwd":{"total": 378.80, "avg": 11.84, "max": 10.94, "min": 15.20, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.48, "avg": 0.74, "max": 0.73, "min": 0.75, "cnt": 2}, "forward-send-backward-recv":{"total": 182.45, "avg": 6.08, "max": 1.29, "min": 116.83, "cnt": 30}, "backward-compute":{"total": 1906.14, "avg": 59.57, "max": 56.38, "min": 62.28, "cnt": 32}, "MoE_L3_bwd":{"total": 438.49, "avg": 13.70, "max": 12.81, "min": 14.71, "cnt": 32}, "MoE_L2_bwd":{"total": 435.94, "avg": 13.62, "max": 12.88, "min": 14.88, "cnt": 32}, "MoE_L1_bwd":{"total": 448.42, "avg": 14.01, "max": 13.29, "min": 15.85, "cnt": 32}, "MoE_L0_bwd":{"total": 370.08, "avg": 11.56, "max": 10.81, "min": 12.95, "cnt": 32}, "backward-send-forward-recv":{"total": 8850.62, "avg": 305.19, "max": 1.62, "min": 937.05, "cnt": 29}, "backward-send":{"total": 2.96, "avg": 0.99, "max": 0.90, "min": 1.05, "cnt": 3}, "backward-recv":{"total": 198.51, "avg": 99.25, "max": 74.37, "min": 124.14, "cnt": 2}, "backward-params-all-reduce":{"total": 488.54, "avg": 488.54, "max": 488.54, "min": 488.54, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.04, "avg": 0.04, "max": 0.04, "min": 0.04, "cnt": 1}, "optimizer":{"total": 243.62, "avg": 243.62, "max": 243.62, "min": 243.62, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 199.27, "avg": 199.27, "max": 199.27, "min": 199.27, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.83, "avg": 6.83, "max": 6.83, "min": 6.83, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.49, "avg": 3.49, "max": 3.49, "min": 3.49, "cnt": 1}}}
{"type":"time", "iteration": 4, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 84.21, "avg": 28.07, "max": 1.40, "min": 80.07, "cnt": 3}, "forward-compute":{"total": 3135.01, "avg": 97.97, "max": 53.17, "min": 442.65, "cnt": 32}, "fwd-compute":{"total": 3132.03, "avg": 97.88, "max": 53.08, "min": 442.57, "cnt": 32}, "batch-generator":{"total": 422.41, "avg": 13.20, "max": 0.75, "min": 383.70, "cnt": 32}, "fwd-embedding":{"total": 0.50, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 2697.64, "avg": 84.30, "max": 51.97, "min": 322.08, "cnt": 32}, "fwd-layernorm":{"total": 9.38, "avg": 0.07, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 106.09, "avg": 0.83, "max": 0.74, "min": 1.64, "cnt": 128}, "fwd-misc":{"total": 20.39, "avg": 0.16, "max": 0.11, "min": 0.34, "cnt": 128}, "fwd-MLP":{"total": 2541.12, "avg": 19.85, "max": 11.26, "min": 281.36, "cnt": 128}, "MoE_L0_fwd":{"total": 1354.00, "avg": 42.31, "max": 12.00, "min": 281.28, "cnt": 32}, "MoEMLP":{"total": 2524.09, "avg": 19.72, "max": 11.14, "min": 281.23, "cnt": 128}, "MoE_L1_fwd":{"total": 409.64, "avg": 12.80, "max": 11.76, "min": 16.36, "cnt": 32}, "MoE_L2_fwd":{"total": 382.77, "avg": 11.96, "max": 11.31, "min": 13.12, "cnt": 32}, "MoE_L3_fwd":{"total": 383.74, "avg": 11.99, "max": 11.18, "min": 15.61, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 5.15, "avg": 2.58, "max": 1.00, "min": 4.15, "cnt": 2}, "forward-send-backward-recv":{"total": 236.75, "avg": 7.89, "max": 1.22, "min": 121.37, "cnt": 30}, "backward-compute":{"total": 1794.44, "avg": 56.08, "max": 53.40, "min": 63.85, "cnt": 32}, "MoE_L3_bwd":{"total": 446.05, "avg": 13.94, "max": 12.33, "min": 20.16, "cnt": 32}, "MoE_L2_bwd":{"total": 391.59, "avg": 12.24, "max": 11.72, "min": 13.67, "cnt": 32}, "MoE_L1_bwd":{"total": 371.36, "avg": 11.60, "max": 11.17, "min": 13.70, "cnt": 32}, "MoE_L0_bwd":{"total": 371.72, "avg": 11.62, "max": 10.92, "min": 12.84, "cnt": 32}, "backward-send-forward-recv":{"total": 11471.80, "avg": 395.58, "max": 1.11, "min": 2085.28, "cnt": 29}, "backward-send":{"total": 1.77, "avg": 0.59, "max": 0.43, "min": 0.78, "cnt": 3}, "backward-recv":{"total": 132.60, "avg": 66.30, "max": 65.84, "min": 66.77, "cnt": 2}, "backward-params-all-reduce":{"total": 503.68, "avg": 503.68, "max": 503.68, "min": 503.68, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.04, "avg": 0.04, "max": 0.04, "min": 0.04, "cnt": 1}, "optimizer":{"total": 246.17, "avg": 246.17, "max": 246.17, "min": 246.17, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.40, "avg": 3.40, "max": 3.40, "min": 3.40, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 201.96, "avg": 201.96, "max": 201.96, "min": 201.96, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.87, "avg": 6.87, "max": 6.87, "min": 6.87, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 5, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 333.83, "avg": 111.28, "max": 0.95, "min": 262.17, "cnt": 3}, "forward-compute":{"total": 2360.77, "avg": 73.77, "max": 52.95, "min": 179.81, "cnt": 32}, "fwd-compute":{"total": 2357.69, "avg": 73.68, "max": 52.87, "min": 179.72, "cnt": 32}, "batch-generator":{"total": 45.46, "avg": 1.42, "max": 0.71, "min": 4.59, "cnt": 32}, "fwd-embedding":{"total": 0.60, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 2299.45, "avg": 71.86, "max": 51.37, "min": 177.67, "cnt": 32}, "fwd-layernorm":{"total": 9.87, "avg": 0.08, "max": 0.05, "min": 0.18, "cnt": 128}, "fwd-attn":{"total": 108.90, "avg": 0.85, "max": 0.75, "min": 1.51, "cnt": 128}, "fwd-misc":{"total": 21.59, "avg": 0.17, "max": 0.11, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 2137.51, "avg": 16.70, "max": 10.73, "min": 135.38, "cnt": 128}, "MoE_L0_fwd":{"total": 969.80, "avg": 30.31, "max": 11.70, "min": 135.11, "cnt": 32}, "MoEMLP":{"total": 2120.07, "avg": 16.56, "max": 10.61, "min": 135.06, "cnt": 128}, "MoE_L1_fwd":{"total": 417.12, "avg": 13.03, "max": 12.22, "min": 13.99, "cnt": 32}, "MoE_L2_fwd":{"total": 381.49, "avg": 11.92, "max": 11.10, "min": 13.12, "cnt": 32}, "MoE_L3_fwd":{"total": 357.97, "avg": 11.19, "max": 10.66, "min": 13.07, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 4.83, "avg": 2.42, "max": 0.88, "min": 3.96, "cnt": 2}, "forward-send-backward-recv":{"total": 75.35, "avg": 2.51, "max": 1.52, "min": 7.44, "cnt": 30}, "backward-compute":{"total": 1815.62, "avg": 56.74, "max": 54.09, "min": 59.70, "cnt": 32}, "MoE_L3_bwd":{"total": 410.99, "avg": 12.84, "max": 11.70, "min": 14.36, "cnt": 32}, "MoE_L2_bwd":{"total": 406.86, "avg": 12.71, "max": 11.74, "min": 13.58, "cnt": 32}, "MoE_L1_bwd":{"total": 423.22, "avg": 13.23, "max": 12.25, "min": 15.75, "cnt": 32}, "MoE_L0_bwd":{"total": 358.73, "avg": 11.21, "max": 10.86, "min": 11.91, "cnt": 32}, "backward-send-forward-recv":{"total": 7256.91, "avg": 250.24, "max": 1.52, "min": 742.22, "cnt": 29}, "backward-send":{"total": 2.89, "avg": 0.96, "max": 0.83, "min": 1.12, "cnt": 3}, "backward-recv":{"total": 163.94, "avg": 81.97, "max": 67.33, "min": 96.61, "cnt": 2}, "backward-params-all-reduce":{"total": 492.23, "avg": 492.23, "max": 492.23, "min": 492.23, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.04, "avg": 0.04, "max": 0.04, "min": 0.04, "cnt": 1}, "optimizer":{"total": 247.41, "avg": 247.41, "max": 247.41, "min": 247.41, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 203.04, "avg": 203.04, "max": 203.04, "min": 203.04, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.83, "avg": 6.83, "max": 6.83, "min": 6.83, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 6, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 88.28, "avg": 29.43, "max": 1.98, "min": 80.58, "cnt": 3}, "forward-compute":{"total": 1966.84, "avg": 61.46, "max": 54.73, "min": 75.89, "cnt": 32}, "fwd-compute":{"total": 1963.70, "avg": 61.37, "max": 54.66, "min": 75.80, "cnt": 32}, "batch-generator":{"total": 44.34, "avg": 1.39, "max": 0.68, "min": 2.73, "cnt": 32}, "fwd-embedding":{"total": 0.60, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1907.14, "avg": 59.60, "max": 53.64, "min": 73.86, "cnt": 32}, "fwd-layernorm":{"total": 9.63, "avg": 0.08, "max": 0.05, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 108.24, "avg": 0.85, "max": 0.74, "min": 1.51, "cnt": 128}, "fwd-misc":{"total": 21.32, "avg": 0.17, "max": 0.11, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1747.15, "avg": 13.65, "max": 10.34, "min": 32.58, "cnt": 128}, "MoE_L0_fwd":{"total": 571.56, "avg": 17.86, "max": 13.43, "min": 32.48, "cnt": 32}, "MoEMLP":{"total": 1730.34, "avg": 13.52, "max": 10.25, "min": 32.43, "cnt": 128}, "MoE_L1_fwd":{"total": 455.15, "avg": 14.22, "max": 13.29, "min": 16.23, "cnt": 32}, "MoE_L2_fwd":{"total": 345.57, "avg": 10.80, "max": 10.28, "min": 13.59, "cnt": 32}, "MoE_L3_fwd":{"total": 364.19, "avg": 11.38, "max": 10.53, "min": 15.45, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.64, "avg": 0.82, "max": 0.77, "min": 0.87, "cnt": 2}, "forward-send-backward-recv":{"total": 209.28, "avg": 6.98, "max": 1.04, "min": 129.62, "cnt": 30}, "backward-compute":{"total": 1915.83, "avg": 59.87, "max": 56.76, "min": 62.36, "cnt": 32}, "MoE_L3_bwd":{"total": 416.90, "avg": 13.03, "max": 10.75, "min": 14.92, "cnt": 32}, "MoE_L2_bwd":{"total": 364.81, "avg": 11.40, "max": 10.84, "min": 12.44, "cnt": 32}, "MoE_L1_bwd":{"total": 469.62, "avg": 14.68, "max": 14.08, "min": 15.91, "cnt": 32}, "MoE_L0_bwd":{"total": 449.69, "avg": 14.05, "max": 13.35, "min": 15.22, "cnt": 32}, "backward-send-forward-recv":{"total": 8183.72, "avg": 282.20, "max": 1.11, "min": 833.50, "cnt": 29}, "backward-send":{"total": 2.85, "avg": 0.95, "max": 0.79, "min": 1.11, "cnt": 3}, "backward-recv":{"total": 123.54, "avg": 61.77, "max": 57.10, "min": 66.43, "cnt": 2}, "backward-params-all-reduce":{"total": 487.72, "avg": 487.72, "max": 487.72, "min": 487.72, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 246.17, "avg": 246.17, "max": 246.17, "min": 246.17, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 201.99, "avg": 201.99, "max": 201.99, "min": 201.99, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.78, "avg": 6.78, "max": 6.78, "min": 6.78, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 7, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 85.90, "avg": 28.63, "max": 1.14, "min": 80.16, "cnt": 3}, "forward-compute":{"total": 2174.97, "avg": 67.97, "max": 58.67, "min": 163.91, "cnt": 32}, "fwd-compute":{"total": 2171.87, "avg": 67.87, "max": 58.57, "min": 163.83, "cnt": 32}, "batch-generator":{"total": 154.58, "avg": 4.83, "max": 0.67, "min": 102.31, "cnt": 32}, "fwd-embedding":{"total": 0.54, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 2005.49, "avg": 62.67, "max": 57.10, "min": 87.83, "cnt": 32}, "fwd-layernorm":{"total": 9.11, "avg": 0.07, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 103.44, "avg": 0.81, "max": 0.74, "min": 1.54, "cnt": 128}, "fwd-misc":{"total": 20.14, "avg": 0.16, "max": 0.11, "min": 0.42, "cnt": 128}, "fwd-MLP":{"total": 1853.09, "avg": 14.48, "max": 10.75, "min": 45.45, "cnt": 128}, "MoE_L0_fwd":{"total": 585.21, "avg": 18.29, "max": 13.89, "min": 45.38, "cnt": 32}, "MoEMLP":{"total": 1837.10, "avg": 14.35, "max": 10.63, "min": 45.33, "cnt": 128}, "MoE_L1_fwd":{"total": 394.33, "avg": 12.32, "max": 10.68, "min": 17.97, "cnt": 32}, "MoE_L2_fwd":{"total": 453.35, "avg": 14.17, "max": 13.47, "min": 16.97, "cnt": 32}, "MoE_L3_fwd":{"total": 410.13, "avg": 12.82, "max": 12.31, "min": 13.70, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.87, "avg": 0.94, "max": 0.93, "min": 0.94, "cnt": 2}, "forward-send-backward-recv":{"total": 768.37, "avg": 25.61, "max": 1.55, "min": 248.49, "cnt": 30}, "backward-compute":{"total": 2089.33, "avg": 65.29, "max": 64.06, "min": 68.97, "cnt": 32}, "MoE_L3_bwd":{"total": 481.39, "avg": 15.04, "max": 13.80, "min": 17.18, "cnt": 32}, "MoE_L2_bwd":{"total": 536.23, "avg": 16.76, "max": 15.72, "min": 18.71, "cnt": 32}, "MoE_L1_bwd":{"total": 349.91, "avg": 10.93, "max": 10.49, "min": 11.85, "cnt": 32}, "MoE_L0_bwd":{"total": 511.69, "avg": 15.99, "max": 15.44, "min": 16.77, "cnt": 32}, "backward-send-forward-recv":{"total": 9133.97, "avg": 314.96, "max": 1.06, "min": 1134.90, "cnt": 29}, "backward-send":{"total": 2.55, "avg": 0.85, "max": 0.71, "min": 0.93, "cnt": 3}, "backward-recv":{"total": 168.78, "avg": 84.39, "max": 68.32, "min": 100.46, "cnt": 2}, "backward-params-all-reduce":{"total": 489.81, "avg": 489.81, "max": 489.81, "min": 489.81, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.04, "avg": 0.04, "max": 0.04, "min": 0.04, "cnt": 1}, "optimizer":{"total": 246.36, "avg": 246.36, "max": 246.36, "min": 246.36, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 202.18, "avg": 202.18, "max": 202.18, "min": 202.18, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.71, "avg": 6.71, "max": 6.71, "min": 6.71, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 8, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 84.11, "avg": 28.04, "max": 0.66, "min": 82.46, "cnt": 3}, "forward-compute":{"total": 1946.57, "avg": 60.83, "max": 53.68, "min": 68.48, "cnt": 32}, "fwd-compute":{"total": 1943.22, "avg": 60.73, "max": 53.60, "min": 68.40, "cnt": 32}, "batch-generator":{"total": 58.98, "avg": 1.84, "max": 0.69, "min": 3.61, "cnt": 32}, "fwd-embedding":{"total": 0.67, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1871.26, "avg": 58.48, "max": 52.56, "min": 65.13, "cnt": 32}, "fwd-layernorm":{"total": 10.29, "avg": 0.08, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 111.05, "avg": 0.87, "max": 0.74, "min": 2.25, "cnt": 128}, "fwd-misc":{"total": 22.51, "avg": 0.18, "max": 0.12, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1705.15, "avg": 13.32, "max": 11.06, "min": 22.31, "cnt": 128}, "MoE_L0_fwd":{"total": 474.20, "avg": 14.82, "max": 11.17, "min": 22.22, "cnt": 32}, "MoEMLP":{"total": 1687.12, "avg": 13.18, "max": 10.95, "min": 22.18, "cnt": 128}, "MoE_L1_fwd":{"total": 390.39, "avg": 12.20, "max": 11.20, "min": 12.95, "cnt": 32}, "MoE_L2_fwd":{"total": 450.49, "avg": 14.08, "max": 13.45, "min": 15.76, "cnt": 32}, "MoE_L3_fwd":{"total": 378.71, "avg": 11.83, "max": 10.99, "min": 15.29, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.64, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 11.88, "avg": 5.94, "max": 0.78, "min": 11.10, "cnt": 2}, "forward-send-backward-recv":{"total": 231.44, "avg": 7.71, "max": 0.86, "min": 128.01, "cnt": 30}, "backward-compute":{"total": 1890.03, "avg": 59.06, "max": 55.21, "min": 61.66, "cnt": 32}, "MoE_L3_bwd":{"total": 439.36, "avg": 13.73, "max": 12.57, "min": 14.83, "cnt": 32}, "MoE_L2_bwd":{"total": 534.09, "avg": 16.69, "max": 15.53, "min": 18.58, "cnt": 32}, "MoE_L1_bwd":{"total": 373.72, "avg": 11.68, "max": 11.05, "min": 12.06, "cnt": 32}, "MoE_L0_bwd":{"total": 330.60, "avg": 10.33, "max": 9.24, "min": 10.96, "cnt": 32}, "backward-send-forward-recv":{"total": 8786.98, "avg": 303.00, "max": 1.32, "min": 1097.85, "cnt": 29}, "backward-send":{"total": 2.34, "avg": 0.78, "max": 0.63, "min": 0.89, "cnt": 3}, "backward-recv":{"total": 139.04, "avg": 69.52, "max": 67.52, "min": 71.52, "cnt": 2}, "backward-params-all-reduce":{"total": 492.75, "avg": 492.75, "max": 492.75, "min": 492.75, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 244.93, "avg": 244.93, "max": 244.93, "min": 244.93, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 200.64, "avg": 200.64, "max": 200.64, "min": 200.64, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.95, "avg": 6.95, "max": 6.95, "min": 6.95, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 9, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 78.85, "avg": 26.28, "max": 0.68, "min": 77.41, "cnt": 3}, "forward-compute":{"total": 2019.68, "avg": 63.12, "max": 54.69, "min": 150.34, "cnt": 32}, "fwd-compute":{"total": 2016.66, "avg": 63.02, "max": 54.61, "min": 150.26, "cnt": 32}, "batch-generator":{"total": 53.72, "avg": 1.68, "max": 0.66, "min": 4.57, "cnt": 32}, "fwd-embedding":{"total": 0.62, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1950.55, "avg": 60.95, "max": 53.54, "min": 148.97, "cnt": 32}, "fwd-layernorm":{"total": 9.81, "avg": 0.08, "max": 0.05, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 109.38, "avg": 0.85, "max": 0.74, "min": 1.88, "cnt": 128}, "fwd-misc":{"total": 21.71, "avg": 0.17, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1788.39, "avg": 13.97, "max": 10.94, "min": 106.93, "cnt": 128}, "MoE_L0_fwd":{"total": 613.87, "avg": 19.18, "max": 12.71, "min": 106.85, "cnt": 32}, "MoEMLP":{"total": 1771.24, "avg": 13.84, "max": 10.82, "min": 106.81, "cnt": 128}, "MoE_L1_fwd":{"total": 394.58, "avg": 12.33, "max": 11.36, "min": 15.99, "cnt": 32}, "MoE_L2_fwd":{"total": 382.99, "avg": 11.97, "max": 10.86, "min": 13.89, "cnt": 32}, "MoE_L3_fwd":{"total": 386.09, "avg": 12.07, "max": 11.21, "min": 14.23, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 12.43, "avg": 6.21, "max": 0.53, "min": 11.89, "cnt": 2}, "forward-send-backward-recv":{"total": 211.90, "avg": 7.06, "max": 0.92, "min": 115.86, "cnt": 30}, "backward-compute":{"total": 1728.86, "avg": 54.03, "max": 50.94, "min": 58.71, "cnt": 32}, "MoE_L3_bwd":{"total": 442.80, "avg": 13.84, "max": 12.62, "min": 15.01, "cnt": 32}, "MoE_L2_bwd":{"total": 381.34, "avg": 11.92, "max": 10.61, "min": 15.74, "cnt": 32}, "MoE_L1_bwd":{"total": 346.48, "avg": 10.83, "max": 10.14, "min": 11.86, "cnt": 32}, "MoE_L0_bwd":{"total": 344.91, "avg": 10.78, "max": 9.92, "min": 12.53, "cnt": 32}, "backward-send-forward-recv":{"total": 9577.67, "avg": 330.26, "max": 1.27, "min": 1086.74, "cnt": 29}, "backward-send":{"total": 2.98, "avg": 0.99, "max": 0.98, "min": 1.01, "cnt": 3}, "backward-recv":{"total": 133.98, "avg": 66.99, "max": 59.98, "min": 74.00, "cnt": 2}, "backward-params-all-reduce":{"total": 493.88, "avg": 493.88, "max": 493.88, "min": 493.88, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 211.05, "avg": 211.05, "max": 211.05, "min": 211.05, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.48, "avg": 3.48, "max": 3.48, "min": 3.48, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 204.16, "avg": 204.16, "max": 204.16, "min": 204.16, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.33, "avg": 3.33, "max": 3.33, "min": 3.33, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}}}
{"type":"time", "iteration": 10, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.13, "avg": 0.13, "max": 0.13, "min": 0.13, "cnt": 1}, "forward-recv":{"total": 78.81, "avg": 26.27, "max": 0.84, "min": 75.16, "cnt": 3}, "forward-compute":{"total": 1978.76, "avg": 61.84, "max": 54.22, "min": 81.66, "cnt": 32}, "fwd-compute":{"total": 1975.46, "avg": 61.73, "max": 54.14, "min": 81.58, "cnt": 32}, "batch-generator":{"total": 66.20, "avg": 2.07, "max": 0.63, "min": 4.51, "cnt": 32}, "fwd-embedding":{"total": 0.72, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1896.04, "avg": 59.25, "max": 53.07, "min": 78.84, "cnt": 32}, "fwd-layernorm":{"total": 10.43, "avg": 0.08, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 110.79, "avg": 0.87, "max": 0.74, "min": 1.56, "cnt": 128}, "fwd-misc":{"total": 21.91, "avg": 0.17, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1730.91, "avg": 13.52, "max": 11.22, "min": 32.88, "cnt": 128}, "MoE_L0_fwd":{"total": 538.26, "avg": 16.82, "max": 12.09, "min": 32.80, "cnt": 32}, "MoEMLP":{"total": 1713.37, "avg": 13.39, "max": 11.10, "min": 32.74, "cnt": 128}, "MoE_L1_fwd":{"total": 402.83, "avg": 12.59, "max": 11.15, "min": 16.59, "cnt": 32}, "MoE_L2_fwd":{"total": 391.12, "avg": 12.22, "max": 11.38, "min": 18.28, "cnt": 32}, "MoE_L3_fwd":{"total": 387.64, "avg": 12.11, "max": 11.29, "min": 17.82, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.62, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 3.61, "avg": 1.81, "max": 0.54, "min": 3.07, "cnt": 2}, "forward-send-backward-recv":{"total": 202.32, "avg": 6.74, "max": 0.89, "min": 118.13, "cnt": 30}, "backward-compute":{"total": 1706.42, "avg": 53.33, "max": 51.69, "min": 55.47, "cnt": 32}, "MoE_L3_bwd":{"total": 438.84, "avg": 13.71, "max": 12.86, "min": 14.72, "cnt": 32}, "MoE_L2_bwd":{"total": 370.35, "avg": 11.57, "max": 10.65, "min": 12.51, "cnt": 32}, "MoE_L1_bwd":{"total": 341.99, "avg": 10.69, "max": 10.02, "min": 11.80, "cnt": 32}, "MoE_L0_bwd":{"total": 340.40, "avg": 10.64, "max": 10.08, "min": 11.13, "cnt": 32}, "backward-send-forward-recv":{"total": 6786.36, "avg": 234.01, "max": 1.86, "min": 991.09, "cnt": 29}, "backward-send":{"total": 2.79, "avg": 0.93, "max": 0.73, "min": 1.16, "cnt": 3}, "backward-recv":{"total": 323.90, "avg": 161.95, "max": 64.77, "min": 259.12, "cnt": 2}, "backward-params-all-reduce":{"total": 484.51, "avg": 484.51, "max": 484.51, "min": 484.51, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 228.83, "avg": 228.83, "max": 228.83, "min": 228.83, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 209.31, "avg": 209.31, "max": 209.31, "min": 209.31, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}}}
{"type":"time", "iteration": 11, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 71.36, "avg": 23.79, "max": 1.95, "min": 63.32, "cnt": 3}, "forward-compute":{"total": 1964.49, "avg": 61.39, "max": 53.55, "min": 81.34, "cnt": 32}, "fwd-compute":{"total": 1961.41, "avg": 61.29, "max": 53.45, "min": 81.25, "cnt": 32}, "batch-generator":{"total": 44.99, "avg": 1.41, "max": 0.77, "min": 2.77, "cnt": 32}, "fwd-embedding":{"total": 0.62, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1903.74, "avg": 59.49, "max": 52.27, "min": 79.41, "cnt": 32}, "fwd-layernorm":{"total": 9.78, "avg": 0.08, "max": 0.06, "min": 0.18, "cnt": 128}, "fwd-attn":{"total": 112.54, "avg": 0.88, "max": 0.74, "min": 3.19, "cnt": 128}, "fwd-misc":{"total": 22.45, "avg": 0.18, "max": 0.11, "min": 0.47, "cnt": 128}, "fwd-MLP":{"total": 1737.17, "avg": 13.57, "max": 11.03, "min": 35.56, "cnt": 128}, "MoE_L0_fwd":{"total": 551.21, "avg": 17.23, "max": 12.67, "min": 35.46, "cnt": 32}, "MoEMLP":{"total": 1719.52, "avg": 13.43, "max": 10.93, "min": 35.42, "cnt": 128}, "MoE_L1_fwd":{"total": 399.45, "avg": 12.48, "max": 10.97, "min": 16.60, "cnt": 32}, "MoE_L2_fwd":{"total": 386.25, "avg": 12.07, "max": 11.02, "min": 14.18, "cnt": 32}, "MoE_L3_fwd":{"total": 388.98, "avg": 12.16, "max": 11.43, "min": 14.58, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.62, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.72, "avg": 0.86, "max": 0.69, "min": 1.03, "cnt": 2}, "forward-send-backward-recv":{"total": 212.26, "avg": 7.08, "max": 1.09, "min": 129.47, "cnt": 30}, "backward-compute":{"total": 1727.28, "avg": 53.98, "max": 50.35, "min": 57.70, "cnt": 32}, "MoE_L3_bwd":{"total": 452.47, "avg": 14.14, "max": 12.97, "min": 17.90, "cnt": 32}, "MoE_L2_bwd":{"total": 376.00, "avg": 11.75, "max": 10.37, "min": 14.23, "cnt": 32}, "MoE_L1_bwd":{"total": 344.25, "avg": 10.76, "max": 10.00, "min": 11.46, "cnt": 32}, "MoE_L0_bwd":{"total": 341.54, "avg": 10.67, "max": 10.12, "min": 12.29, "cnt": 32}, "backward-send-forward-recv":{"total": 7415.59, "avg": 255.71, "max": 2.29, "min": 903.88, "cnt": 29}, "backward-send":{"total": 2.77, "avg": 0.92, "max": 0.89, "min": 0.97, "cnt": 3}, "backward-recv":{"total": 133.61, "avg": 66.81, "max": 60.83, "min": 72.78, "cnt": 2}, "backward-params-all-reduce":{"total": 487.94, "avg": 487.94, "max": 487.94, "min": 487.94, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 215.40, "avg": 215.40, "max": 215.40, "min": 215.40, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 204.87, "avg": 204.87, "max": 204.87, "min": 204.87, "cnt": 1}, "optimizer-clip-main-grad":{"total": 7.03, "avg": 7.03, "max": 7.03, "min": 7.03, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}}}
{"type":"time", "iteration": 12, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 83.48, "avg": 27.83, "max": 0.78, "min": 80.81, "cnt": 3}, "forward-compute":{"total": 2015.27, "avg": 62.98, "max": 52.48, "min": 98.60, "cnt": 32}, "fwd-compute":{"total": 2012.04, "avg": 62.88, "max": 52.39, "min": 98.50, "cnt": 32}, "batch-generator":{"total": 43.80, "avg": 1.37, "max": 0.75, "min": 3.34, "cnt": 32}, "fwd-embedding":{"total": 0.61, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1954.80, "avg": 61.09, "max": 51.14, "min": 96.49, "cnt": 32}, "fwd-layernorm":{"total": 9.90, "avg": 0.08, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 110.06, "avg": 0.86, "max": 0.74, "min": 1.53, "cnt": 128}, "fwd-misc":{"total": 21.75, "avg": 0.17, "max": 0.11, "min": 0.40, "cnt": 128}, "fwd-MLP":{"total": 1791.06, "avg": 13.99, "max": 11.12, "min": 53.01, "cnt": 128}, "MoE_L0_fwd":{"total": 588.87, "avg": 18.40, "max": 12.07, "min": 52.93, "cnt": 32}, "MoEMLP":{"total": 1773.04, "avg": 13.85, "max": 11.00, "min": 52.88, "cnt": 128}, "MoE_L1_fwd":{"total": 396.90, "avg": 12.40, "max": 11.17, "min": 16.05, "cnt": 32}, "MoE_L2_fwd":{"total": 389.63, "avg": 12.18, "max": 11.04, "min": 16.04, "cnt": 32}, "MoE_L3_fwd":{"total": 404.06, "avg": 12.63, "max": 11.40, "min": 20.00, "cnt": 32}, "fwd-pooler":{"total": 0.36, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.63, "avg": 0.02, "max": 0.02, "min": 0.05, "cnt": 32}, "forward-send":{"total": 5.03, "avg": 2.52, "max": 0.53, "min": 4.50, "cnt": 2}, "forward-send-backward-recv":{"total": 202.89, "avg": 6.76, "max": 1.07, "min": 120.43, "cnt": 30}, "backward-compute":{"total": 1739.35, "avg": 54.35, "max": 52.04, "min": 57.13, "cnt": 32}, "MoE_L3_bwd":{"total": 451.59, "avg": 14.11, "max": 12.46, "min": 16.31, "cnt": 32}, "MoE_L2_bwd":{"total": 386.93, "avg": 12.09, "max": 11.02, "min": 13.45, "cnt": 32}, "MoE_L1_bwd":{"total": 347.10, "avg": 10.85, "max": 10.49, "min": 11.25, "cnt": 32}, "MoE_L0_bwd":{"total": 340.50, "avg": 10.64, "max": 9.55, "min": 11.25, "cnt": 32}, "backward-send-forward-recv":{"total": 8004.45, "avg": 276.02, "max": 2.39, "min": 1405.80, "cnt": 29}, "backward-send":{"total": 3.07, "avg": 1.02, "max": 1.02, "min": 1.03, "cnt": 3}, "backward-recv":{"total": 178.03, "avg": 89.02, "max": 72.78, "min": 105.25, "cnt": 2}, "backward-params-all-reduce":{"total": 488.42, "avg": 488.42, "max": 488.42, "min": 488.42, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 217.91, "avg": 217.91, "max": 217.91, "min": 217.91, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 207.52, "avg": 207.52, "max": 207.52, "min": 207.52, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.80, "avg": 6.80, "max": 6.80, "min": 6.80, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}}}
{"type":"time", "iteration": 13, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 89.12, "avg": 29.71, "max": 1.84, "min": 79.98, "cnt": 3}, "forward-compute":{"total": 1930.96, "avg": 60.34, "max": 51.67, "min": 71.97, "cnt": 32}, "fwd-compute":{"total": 1927.85, "avg": 60.25, "max": 51.60, "min": 71.88, "cnt": 32}, "batch-generator":{"total": 45.80, "avg": 1.43, "max": 0.71, "min": 3.49, "cnt": 32}, "fwd-embedding":{"total": 0.57, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1869.28, "avg": 58.42, "max": 50.58, "min": 69.30, "cnt": 32}, "fwd-layernorm":{"total": 9.59, "avg": 0.07, "max": 0.05, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 106.10, "avg": 0.83, "max": 0.74, "min": 1.58, "cnt": 128}, "fwd-misc":{"total": 21.37, "avg": 0.17, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1711.34, "avg": 13.37, "max": 11.19, "min": 24.16, "cnt": 128}, "MoE_L0_fwd":{"total": 523.43, "avg": 16.36, "max": 11.96, "min": 24.08, "cnt": 32}, "MoEMLP":{"total": 1694.27, "avg": 13.24, "max": 11.07, "min": 24.04, "cnt": 128}, "MoE_L1_fwd":{"total": 409.74, "avg": 12.80, "max": 11.12, "min": 15.43, "cnt": 32}, "MoE_L2_fwd":{"total": 384.50, "avg": 12.02, "max": 11.18, "min": 15.11, "cnt": 32}, "MoE_L3_fwd":{"total": 382.83, "avg": 11.96, "max": 11.32, "min": 13.19, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.62, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.41, "avg": 0.71, "max": 0.69, "min": 0.73, "cnt": 2}, "forward-send-backward-recv":{"total": 1611.16, "avg": 53.71, "max": 0.98, "min": 524.96, "cnt": 30}, "backward-compute":{"total": 1727.51, "avg": 53.98, "max": 51.83, "min": 59.39, "cnt": 32}, "MoE_L3_bwd":{"total": 445.86, "avg": 13.93, "max": 12.28, "min": 19.09, "cnt": 32}, "MoE_L2_bwd":{"total": 382.38, "avg": 11.95, "max": 10.72, "min": 13.61, "cnt": 32}, "MoE_L1_bwd":{"total": 346.26, "avg": 10.82, "max": 10.30, "min": 11.81, "cnt": 32}, "MoE_L0_bwd":{"total": 338.55, "avg": 10.58, "max": 10.09, "min": 11.80, "cnt": 32}, "backward-send-forward-recv":{"total": 5988.82, "avg": 206.51, "max": 2.28, "min": 967.71, "cnt": 29}, "backward-send":{"total": 3.00, "avg": 1.00, "max": 0.94, "min": 1.05, "cnt": 3}, "backward-recv":{"total": 381.21, "avg": 190.60, "max": 78.98, "min": 302.22, "cnt": 2}, "backward-params-all-reduce":{"total": 486.69, "avg": 486.69, "max": 486.69, "min": 486.69, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 242.69, "avg": 242.69, "max": 242.69, "min": 242.69, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 198.47, "avg": 198.47, "max": 198.47, "min": 198.47, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.84, "avg": 6.84, "max": 6.84, "min": 6.84, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 14, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.10, "avg": 0.10, "max": 0.10, "min": 0.10, "cnt": 1}, "forward-recv":{"total": 82.96, "avg": 27.65, "max": 0.70, "min": 77.42, "cnt": 3}, "forward-compute":{"total": 1789.70, "avg": 55.93, "max": 50.01, "min": 63.54, "cnt": 32}, "fwd-compute":{"total": 1786.32, "avg": 55.82, "max": 49.94, "min": 63.35, "cnt": 32}, "batch-generator":{"total": 64.02, "avg": 2.00, "max": 0.70, "min": 4.58, "cnt": 32}, "fwd-embedding":{"total": 0.64, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1709.07, "avg": 53.41, "max": 48.92, "min": 58.38, "cnt": 32}, "fwd-layernorm":{"total": 9.92, "avg": 0.08, "max": 0.05, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 107.14, "avg": 0.84, "max": 0.74, "min": 1.74, "cnt": 128}, "fwd-misc":{"total": 21.58, "avg": 0.17, "max": 0.11, "min": 0.40, "cnt": 128}, "fwd-MLP":{"total": 1549.29, "avg": 12.10, "max": 10.35, "min": 18.16, "cnt": 128}, "MoE_L0_fwd":{"total": 441.61, "avg": 13.80, "max": 11.03, "min": 18.09, "cnt": 32}, "MoEMLP":{"total": 1532.03, "avg": 11.97, "max": 10.23, "min": 18.05, "cnt": 128}, "MoE_L1_fwd":{"total": 401.47, "avg": 12.55, "max": 11.45, "min": 14.52, "cnt": 32}, "MoE_L2_fwd":{"total": 351.64, "avg": 10.99, "max": 10.73, "min": 11.47, "cnt": 32}, "MoE_L3_fwd":{"total": 343.66, "avg": 10.74, "max": 10.27, "min": 11.86, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 12.09, "avg": 6.05, "max": 0.67, "min": 11.42, "cnt": 2}, "forward-send-backward-recv":{"total": 320.78, "avg": 10.69, "max": 0.95, "min": 125.51, "cnt": 30}, "backward-compute":{"total": 1766.35, "avg": 55.20, "max": 51.81, "min": 60.42, "cnt": 32}, "MoE_L3_bwd":{"total": 416.15, "avg": 13.00, "max": 11.85, "min": 15.85, "cnt": 32}, "MoE_L2_bwd":{"total": 404.96, "avg": 12.66, "max": 11.78, "min": 14.97, "cnt": 32}, "MoE_L1_bwd":{"total": 381.62, "avg": 11.93, "max": 11.44, "min": 12.64, "cnt": 32}, "MoE_L0_bwd":{"total": 350.32, "avg": 10.95, "max": 10.16, "min": 12.65, "cnt": 32}, "backward-send-forward-recv":{"total": 8207.24, "avg": 283.01, "max": 1.09, "min": 1653.71, "cnt": 29}, "backward-send":{"total": 3.15, "avg": 1.05, "max": 0.98, "min": 1.15, "cnt": 3}, "backward-recv":{"total": 321.98, "avg": 160.99, "max": 69.67, "min": 252.31, "cnt": 2}, "backward-params-all-reduce":{"total": 489.29, "avg": 489.29, "max": 489.29, "min": 489.29, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.04, "avg": 0.04, "max": 0.04, "min": 0.04, "cnt": 1}, "optimizer":{"total": 243.50, "avg": 243.50, "max": 243.50, "min": 243.50, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.48, "avg": 3.48, "max": 3.48, "min": 3.48, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 199.16, "avg": 199.16, "max": 199.16, "min": 199.16, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.78, "avg": 6.78, "max": 6.78, "min": 6.78, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 15, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 88.67, "avg": 29.56, "max": 2.50, "min": 75.93, "cnt": 3}, "forward-compute":{"total": 1802.57, "avg": 56.33, "max": 49.93, "min": 60.41, "cnt": 32}, "fwd-compute":{"total": 1799.44, "avg": 56.23, "max": 49.86, "min": 60.33, "cnt": 32}, "batch-generator":{"total": 43.08, "avg": 1.35, "max": 0.75, "min": 3.63, "cnt": 32}, "fwd-embedding":{"total": 0.64, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1743.92, "avg": 54.50, "max": 48.81, "min": 58.78, "cnt": 32}, "fwd-layernorm":{"total": 10.00, "avg": 0.08, "max": 0.05, "min": 0.22, "cnt": 128}, "fwd-attn":{"total": 113.04, "avg": 0.88, "max": 0.74, "min": 1.74, "cnt": 128}, "fwd-misc":{"total": 22.39, "avg": 0.17, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1576.47, "avg": 12.32, "max": 10.25, "min": 18.58, "cnt": 128}, "MoE_L0_fwd":{"total": 466.72, "avg": 14.59, "max": 10.63, "min": 18.42, "cnt": 32}, "MoEMLP":{"total": 1558.11, "avg": 12.17, "max": 10.13, "min": 18.36, "cnt": 128}, "MoE_L1_fwd":{"total": 393.28, "avg": 12.29, "max": 11.20, "min": 13.52, "cnt": 32}, "MoE_L2_fwd":{"total": 354.19, "avg": 11.07, "max": 10.74, "min": 13.25, "cnt": 32}, "MoE_L3_fwd":{"total": 350.54, "avg": 10.95, "max": 10.18, "min": 11.43, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.30, "avg": 0.65, "max": 0.63, "min": 0.67, "cnt": 2}, "forward-send-backward-recv":{"total": 249.30, "avg": 8.31, "max": 1.65, "min": 126.49, "cnt": 30}, "backward-compute":{"total": 1757.09, "avg": 54.91, "max": 52.77, "min": 57.87, "cnt": 32}, "MoE_L3_bwd":{"total": 412.49, "avg": 12.89, "max": 11.72, "min": 14.26, "cnt": 32}, "MoE_L2_bwd":{"total": 399.41, "avg": 12.48, "max": 11.67, "min": 14.13, "cnt": 32}, "MoE_L1_bwd":{"total": 381.22, "avg": 11.91, "max": 11.19, "min": 12.14, "cnt": 32}, "MoE_L0_bwd":{"total": 351.59, "avg": 10.99, "max": 10.29, "min": 11.32, "cnt": 32}, "backward-send-forward-recv":{"total": 6061.58, "avg": 209.02, "max": 2.40, "min": 759.50, "cnt": 29}, "backward-send":{"total": 3.07, "avg": 1.02, "max": 0.72, "min": 1.17, "cnt": 3}, "backward-recv":{"total": 205.70, "avg": 102.85, "max": 69.91, "min": 135.79, "cnt": 2}, "backward-params-all-reduce":{"total": 488.99, "avg": 488.99, "max": 488.99, "min": 488.99, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 243.98, "avg": 243.98, "max": 243.98, "min": 243.98, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 199.85, "avg": 199.85, "max": 199.85, "min": 199.85, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.80, "avg": 6.80, "max": 6.80, "min": 6.80, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 16, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 81.86, "avg": 27.29, "max": 2.71, "min": 72.54, "cnt": 3}, "forward-compute":{"total": 1938.42, "avg": 60.58, "max": 49.96, "min": 112.71, "cnt": 32}, "fwd-compute":{"total": 1935.09, "avg": 60.47, "max": 49.89, "min": 112.63, "cnt": 32}, "batch-generator":{"total": 56.56, "avg": 1.77, "max": 0.72, "min": 3.89, "cnt": 32}, "fwd-embedding":{"total": 0.70, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1865.76, "avg": 58.31, "max": 48.81, "min": 111.43, "cnt": 32}, "fwd-layernorm":{"total": 10.25, "avg": 0.08, "max": 0.05, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 110.29, "avg": 0.86, "max": 0.74, "min": 1.50, "cnt": 128}, "fwd-misc":{"total": 21.92, "avg": 0.17, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1701.71, "avg": 13.29, "max": 10.46, "min": 70.99, "cnt": 128}, "MoE_L0_fwd":{"total": 560.85, "avg": 17.53, "max": 10.80, "min": 70.88, "cnt": 32}, "MoEMLP":{"total": 1684.20, "avg": 13.16, "max": 10.35, "min": 70.83, "cnt": 128}, "MoE_L1_fwd":{"total": 404.95, "avg": 12.65, "max": 11.52, "min": 15.96, "cnt": 32}, "MoE_L2_fwd":{"total": 369.50, "avg": 11.55, "max": 10.77, "min": 15.50, "cnt": 32}, "MoE_L3_fwd":{"total": 355.40, "avg": 11.11, "max": 10.39, "min": 15.04, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.92, "avg": 0.96, "max": 0.83, "min": 1.09, "cnt": 2}, "forward-send-backward-recv":{"total": 243.85, "avg": 8.13, "max": 1.04, "min": 120.42, "cnt": 30}, "backward-compute":{"total": 1714.56, "avg": 53.58, "max": 51.25, "min": 56.78, "cnt": 32}, "MoE_L3_bwd":{"total": 392.51, "avg": 12.27, "max": 11.19, "min": 14.48, "cnt": 32}, "MoE_L2_bwd":{"total": 378.46, "avg": 11.83, "max": 11.41, "min": 12.54, "cnt": 32}, "MoE_L1_bwd":{"total": 381.24, "avg": 11.91, "max": 11.48, "min": 12.23, "cnt": 32}, "MoE_L0_bwd":{"total": 345.36, "avg": 10.79, "max": 9.99, "min": 11.96, "cnt": 32}, "backward-send-forward-recv":{"total": 5313.39, "avg": 183.22, "max": 1.91, "min": 538.50, "cnt": 29}, "backward-send":{"total": 3.26, "avg": 1.09, "max": 0.97, "min": 1.20, "cnt": 3}, "backward-recv":{"total": 130.73, "avg": 65.37, "max": 63.94, "min": 66.79, "cnt": 2}, "backward-params-all-reduce":{"total": 490.54, "avg": 490.54, "max": 490.54, "min": 490.54, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 244.70, "avg": 244.70, "max": 244.70, "min": 244.70, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 200.53, "avg": 200.53, "max": 200.53, "min": 200.53, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.87, "avg": 6.87, "max": 6.87, "min": 6.87, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 17, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.11, "avg": 0.11, "max": 0.11, "min": 0.11, "cnt": 1}, "forward-recv":{"total": 73.12, "avg": 24.37, "max": 0.98, "min": 70.93, "cnt": 3}, "forward-compute":{"total": 1812.93, "avg": 56.65, "max": 49.55, "min": 64.21, "cnt": 32}, "fwd-compute":{"total": 1809.58, "avg": 56.55, "max": 49.48, "min": 64.12, "cnt": 32}, "batch-generator":{"total": 55.75, "avg": 1.74, "max": 0.67, "min": 4.69, "cnt": 32}, "fwd-embedding":{"total": 0.71, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1740.50, "avg": 54.39, "max": 48.48, "min": 62.49, "cnt": 32}, "fwd-layernorm":{"total": 10.49, "avg": 0.08, "max": 0.05, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 111.21, "avg": 0.87, "max": 0.74, "min": 1.54, "cnt": 128}, "fwd-misc":{"total": 22.16, "avg": 0.17, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1574.33, "avg": 12.30, "max": 10.22, "min": 22.13, "cnt": 128}, "MoE_L0_fwd":{"total": 470.69, "avg": 14.71, "max": 10.14, "min": 22.05, "cnt": 32}, "MoEMLP":{"total": 1556.31, "avg": 12.16, "max": 10.09, "min": 22.01, "cnt": 128}, "MoE_L1_fwd":{"total": 391.31, "avg": 12.23, "max": 11.43, "min": 14.50, "cnt": 32}, "MoE_L2_fwd":{"total": 357.85, "avg": 11.18, "max": 10.64, "min": 12.89, "cnt": 32}, "MoE_L3_fwd":{"total": 342.98, "avg": 10.72, "max": 10.33, "min": 11.43, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 9.28, "avg": 4.64, "max": 1.00, "min": 8.28, "cnt": 2}, "forward-send-backward-recv":{"total": 235.27, "avg": 7.84, "max": 0.88, "min": 121.17, "cnt": 30}, "backward-compute":{"total": 1724.77, "avg": 53.90, "max": 50.66, "min": 57.81, "cnt": 32}, "MoE_L3_bwd":{"total": 396.34, "avg": 12.39, "max": 11.45, "min": 15.43, "cnt": 32}, "MoE_L2_bwd":{"total": 383.27, "avg": 11.98, "max": 11.14, "min": 14.46, "cnt": 32}, "MoE_L1_bwd":{"total": 383.44, "avg": 11.98, "max": 11.21, "min": 13.00, "cnt": 32}, "MoE_L0_bwd":{"total": 349.15, "avg": 10.91, "max": 10.19, "min": 12.39, "cnt": 32}, "backward-send-forward-recv":{"total": 7273.68, "avg": 250.82, "max": 1.98, "min": 1369.94, "cnt": 29}, "backward-send":{"total": 2.33, "avg": 0.78, "max": 0.53, "min": 1.00, "cnt": 3}, "backward-recv":{"total": 126.19, "avg": 63.09, "max": 60.51, "min": 65.67, "cnt": 2}, "backward-params-all-reduce":{"total": 494.21, "avg": 494.21, "max": 494.21, "min": 494.21, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 248.33, "avg": 248.33, "max": 248.33, "min": 248.33, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 204.03, "avg": 204.03, "max": 204.03, "min": 204.03, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.72, "avg": 6.72, "max": 6.72, "min": 6.72, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.47, "avg": 3.47, "max": 3.47, "min": 3.47, "cnt": 1}}}
{"type":"time", "iteration": 18, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 75.27, "avg": 25.09, "max": 0.93, "min": 68.68, "cnt": 3}, "forward-compute":{"total": 1803.77, "avg": 56.37, "max": 49.25, "min": 67.17, "cnt": 32}, "fwd-compute":{"total": 1800.54, "avg": 56.27, "max": 49.16, "min": 67.09, "cnt": 32}, "batch-generator":{"total": 60.00, "avg": 1.87, "max": 0.63, "min": 4.16, "cnt": 32}, "fwd-embedding":{"total": 0.58, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1728.51, "avg": 54.02, "max": 48.07, "min": 62.51, "cnt": 32}, "fwd-layernorm":{"total": 9.50, "avg": 0.07, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 106.50, "avg": 0.83, "max": 0.73, "min": 1.51, "cnt": 128}, "fwd-misc":{"total": 20.24, "avg": 0.16, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1571.86, "avg": 12.28, "max": 10.43, "min": 21.35, "cnt": 128}, "MoE_L0_fwd":{"total": 457.94, "avg": 14.31, "max": 10.71, "min": 21.19, "cnt": 32}, "MoEMLP":{"total": 1555.37, "avg": 12.15, "max": 10.31, "min": 21.11, "cnt": 128}, "MoE_L1_fwd":{"total": 398.13, "avg": 12.44, "max": 11.21, "min": 15.49, "cnt": 32}, "MoE_L2_fwd":{"total": 359.67, "avg": 11.24, "max": 10.64, "min": 14.29, "cnt": 32}, "MoE_L3_fwd":{"total": 345.78, "avg": 10.81, "max": 10.35, "min": 13.13, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 2.58, "avg": 1.29, "max": 1.02, "min": 1.56, "cnt": 2}, "forward-send-backward-recv":{"total": 446.88, "avg": 14.90, "max": 1.15, "min": 132.85, "cnt": 30}, "backward-compute":{"total": 1714.39, "avg": 53.57, "max": 50.23, "min": 55.44, "cnt": 32}, "MoE_L3_bwd":{"total": 389.59, "avg": 12.17, "max": 11.47, "min": 13.75, "cnt": 32}, "MoE_L2_bwd":{"total": 383.16, "avg": 11.97, "max": 10.49, "min": 12.78, "cnt": 32}, "MoE_L1_bwd":{"total": 382.20, "avg": 11.94, "max": 11.30, "min": 12.24, "cnt": 32}, "MoE_L0_bwd":{"total": 348.09, "avg": 10.88, "max": 10.45, "min": 11.09, "cnt": 32}, "backward-send-forward-recv":{"total": 6659.20, "avg": 229.63, "max": 1.04, "min": 905.97, "cnt": 29}, "backward-send":{"total": 2.33, "avg": 0.78, "max": 0.46, "min": 0.95, "cnt": 3}, "backward-recv":{"total": 509.87, "avg": 254.93, "max": 107.26, "min": 402.61, "cnt": 2}, "backward-params-all-reduce":{"total": 487.70, "avg": 487.70, "max": 487.70, "min": 487.70, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 245.96, "avg": 245.96, "max": 245.96, "min": 245.96, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 201.83, "avg": 201.83, "max": 201.83, "min": 201.83, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.79, "avg": 6.79, "max": 6.79, "min": 6.79, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 19, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 69.58, "avg": 23.19, "max": 0.76, "min": 67.91, "cnt": 3}, "forward-compute":{"total": 1802.20, "avg": 56.32, "max": 49.86, "min": 64.70, "cnt": 32}, "fwd-compute":{"total": 1798.99, "avg": 56.22, "max": 49.79, "min": 64.61, "cnt": 32}, "batch-generator":{"total": 64.42, "avg": 2.01, "max": 0.67, "min": 4.45, "cnt": 32}, "fwd-embedding":{"total": 0.63, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1722.12, "avg": 53.82, "max": 48.79, "min": 61.04, "cnt": 32}, "fwd-layernorm":{"total": 9.92, "avg": 0.08, "max": 0.05, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 107.77, "avg": 0.84, "max": 0.74, "min": 1.52, "cnt": 128}, "fwd-misc":{"total": 21.13, "avg": 0.17, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1562.26, "avg": 12.21, "max": 10.53, "min": 21.28, "cnt": 128}, "MoE_L0_fwd":{"total": 443.49, "avg": 13.86, "max": 10.89, "min": 21.19, "cnt": 32}, "MoEMLP":{"total": 1545.17, "avg": 12.07, "max": 10.43, "min": 21.15, "cnt": 128}, "MoE_L1_fwd":{"total": 402.13, "avg": 12.57, "max": 11.32, "min": 16.20, "cnt": 32}, "MoE_L2_fwd":{"total": 355.79, "avg": 11.12, "max": 10.70, "min": 12.63, "cnt": 32}, "MoE_L3_fwd":{"total": 350.06, "avg": 10.94, "max": 10.46, "min": 14.76, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 3.00, "avg": 1.50, "max": 0.81, "min": 2.20, "cnt": 2}, "forward-send-backward-recv":{"total": 233.41, "avg": 7.78, "max": 1.70, "min": 122.07, "cnt": 30}, "backward-compute":{"total": 1714.15, "avg": 53.57, "max": 51.66, "min": 55.01, "cnt": 32}, "MoE_L3_bwd":{"total": 391.09, "avg": 12.22, "max": 11.30, "min": 13.36, "cnt": 32}, "MoE_L2_bwd":{"total": 381.16, "avg": 11.91, "max": 11.30, "min": 12.61, "cnt": 32}, "MoE_L1_bwd":{"total": 382.12, "avg": 11.94, "max": 11.51, "min": 12.45, "cnt": 32}, "MoE_L0_bwd":{"total": 346.83, "avg": 10.84, "max": 10.05, "min": 11.94, "cnt": 32}, "backward-send-forward-recv":{"total": 7526.34, "avg": 259.53, "max": 1.95, "min": 1002.12, "cnt": 29}, "backward-send":{"total": 2.92, "avg": 0.97, "max": 0.77, "min": 1.08, "cnt": 3}, "backward-recv":{"total": 138.94, "avg": 69.47, "max": 67.82, "min": 71.12, "cnt": 2}, "backward-params-all-reduce":{"total": 490.11, "avg": 490.11, "max": 490.11, "min": 490.11, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 247.78, "avg": 247.78, "max": 247.78, "min": 247.78, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 203.56, "avg": 203.56, "max": 203.56, "min": 203.56, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.82, "avg": 6.82, "max": 6.82, "min": 6.82, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 20, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 68.67, "avg": 22.89, "max": 1.02, "min": 66.35, "cnt": 3}, "forward-compute":{"total": 1927.14, "avg": 60.22, "max": 50.31, "min": 132.55, "cnt": 32}, "fwd-compute":{"total": 1924.34, "avg": 60.14, "max": 50.24, "min": 132.45, "cnt": 32}, "batch-generator":{"total": 40.77, "avg": 1.27, "max": 0.74, "min": 3.53, "cnt": 32}, "fwd-embedding":{"total": 0.46, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1871.82, "avg": 58.49, "max": 49.14, "min": 130.92, "cnt": 32}, "fwd-layernorm":{"total": 8.90, "avg": 0.07, "max": 0.05, "min": 0.17, "cnt": 128}, "fwd-attn":{"total": 103.15, "avg": 0.81, "max": 0.74, "min": 1.46, "cnt": 128}, "fwd-misc":{"total": 20.27, "avg": 0.16, "max": 0.11, "min": 0.34, "cnt": 128}, "fwd-MLP":{"total": 1718.95, "avg": 13.43, "max": 10.58, "min": 92.84, "cnt": 128}, "MoE_L0_fwd":{"total": 493.87, "avg": 15.43, "max": 10.71, "min": 21.86, "cnt": 32}, "MoEMLP":{"total": 1702.28, "avg": 13.30, "max": 10.46, "min": 92.71, "cnt": 128}, "MoE_L1_fwd":{"total": 403.20, "avg": 12.60, "max": 11.35, "min": 17.74, "cnt": 32}, "MoE_L2_fwd":{"total": 371.15, "avg": 11.60, "max": 10.82, "min": 16.61, "cnt": 32}, "MoE_L3_fwd":{"total": 440.17, "avg": 13.76, "max": 10.51, "min": 92.76, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.62, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 3.73, "avg": 1.86, "max": 1.01, "min": 2.72, "cnt": 2}, "forward-send-backward-recv":{"total": 644.58, "avg": 21.49, "max": 1.37, "min": 202.08, "cnt": 30}, "backward-compute":{"total": 1722.61, "avg": 53.83, "max": 50.75, "min": 55.19, "cnt": 32}, "MoE_L3_bwd":{"total": 398.38, "avg": 12.45, "max": 11.48, "min": 13.63, "cnt": 32}, "MoE_L2_bwd":{"total": 378.90, "avg": 11.84, "max": 10.93, "min": 12.54, "cnt": 32}, "MoE_L1_bwd":{"total": 383.98, "avg": 12.00, "max": 11.28, "min": 13.07, "cnt": 32}, "MoE_L0_bwd":{"total": 346.60, "avg": 10.83, "max": 10.40, "min": 11.25, "cnt": 32}, "backward-send-forward-recv":{"total": 5165.54, "avg": 178.12, "max": 2.15, "min": 457.29, "cnt": 29}, "backward-send":{"total": 3.18, "avg": 1.06, "max": 0.99, "min": 1.10, "cnt": 3}, "backward-recv":{"total": 318.59, "avg": 159.30, "max": 69.00, "min": 249.59, "cnt": 2}, "backward-params-all-reduce":{"total": 496.01, "avg": 496.01, "max": 496.01, "min": 496.01, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 246.23, "avg": 246.23, "max": 246.23, "min": 246.23, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.36, "avg": 3.36, "max": 3.36, "min": 3.36, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 196.68, "avg": 196.68, "max": 196.68, "min": 196.68, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.94, "avg": 6.94, "max": 6.94, "min": 6.94, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.41, "avg": 3.41, "max": 3.41, "min": 3.41, "cnt": 1}}}
{"type":"time", "iteration": 21, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 79.21, "avg": 26.40, "max": 1.12, "min": 76.80, "cnt": 3}, "forward-compute":{"total": 1796.45, "avg": 56.14, "max": 50.34, "min": 62.45, "cnt": 32}, "fwd-compute":{"total": 1793.57, "avg": 56.05, "max": 50.26, "min": 62.37, "cnt": 32}, "batch-generator":{"total": 42.09, "avg": 1.32, "max": 0.68, "min": 2.97, "cnt": 32}, "fwd-embedding":{"total": 0.51, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1739.81, "avg": 54.37, "max": 49.12, "min": 59.14, "cnt": 32}, "fwd-layernorm":{"total": 9.17, "avg": 0.07, "max": 0.05, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 104.23, "avg": 0.81, "max": 0.74, "min": 1.50, "cnt": 128}, "fwd-misc":{"total": 20.60, "avg": 0.16, "max": 0.12, "min": 0.33, "cnt": 128}, "fwd-MLP":{"total": 1585.24, "avg": 12.38, "max": 10.77, "min": 18.79, "cnt": 128}, "MoE_L0_fwd":{"total": 462.44, "avg": 14.45, "max": 10.95, "min": 18.71, "cnt": 32}, "MoEMLP":{"total": 1568.33, "avg": 12.25, "max": 10.65, "min": 18.67, "cnt": 128}, "MoE_L1_fwd":{"total": 391.60, "avg": 12.24, "max": 11.05, "min": 15.02, "cnt": 32}, "MoE_L2_fwd":{"total": 360.04, "avg": 11.25, "max": 10.87, "min": 13.02, "cnt": 32}, "MoE_L3_fwd":{"total": 360.42, "avg": 11.26, "max": 10.69, "min": 14.39, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.93, "avg": 0.97, "max": 0.94, "min": 1.00, "cnt": 2}, "forward-send-backward-recv":{"total": 504.59, "avg": 16.82, "max": 1.21, "min": 133.44, "cnt": 30}, "backward-compute":{"total": 1740.66, "avg": 54.40, "max": 50.90, "min": 56.14, "cnt": 32}, "MoE_L3_bwd":{"total": 411.75, "avg": 12.87, "max": 11.96, "min": 14.34, "cnt": 32}, "MoE_L2_bwd":{"total": 378.64, "avg": 11.83, "max": 10.70, "min": 13.18, "cnt": 32}, "MoE_L1_bwd":{"total": 381.67, "avg": 11.93, "max": 11.33, "min": 12.37, "cnt": 32}, "MoE_L0_bwd":{"total": 354.07, "avg": 11.06, "max": 10.35, "min": 11.75, "cnt": 32}, "backward-send-forward-recv":{"total": 6919.33, "avg": 238.60, "max": 2.41, "min": 1068.55, "cnt": 29}, "backward-send":{"total": 1.50, "avg": 0.50, "max": 0.43, "min": 0.56, "cnt": 3}, "backward-recv":{"total": 663.00, "avg": 331.50, "max": 71.30, "min": 591.71, "cnt": 2}, "backward-params-all-reduce":{"total": 484.83, "avg": 484.83, "max": 484.83, "min": 484.83, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.04, "avg": 0.04, "max": 0.04, "min": 0.04, "cnt": 1}, "optimizer":{"total": 251.06, "avg": 251.06, "max": 251.06, "min": 251.06, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 206.94, "avg": 206.94, "max": 206.94, "min": 206.94, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.74, "avg": 6.74, "max": 6.74, "min": 6.74, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 22, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 81.42, "avg": 27.14, "max": 0.99, "min": 78.06, "cnt": 3}, "forward-compute":{"total": 1826.79, "avg": 57.09, "max": 50.09, "min": 69.82, "cnt": 32}, "fwd-compute":{"total": 1823.71, "avg": 56.99, "max": 50.02, "min": 69.72, "cnt": 32}, "batch-generator":{"total": 49.14, "avg": 1.54, "max": 0.69, "min": 5.23, "cnt": 32}, "fwd-embedding":{"total": 0.60, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1761.43, "avg": 55.04, "max": 49.01, "min": 68.48, "cnt": 32}, "fwd-layernorm":{"total": 9.79, "avg": 0.08, "max": 0.05, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 109.01, "avg": 0.85, "max": 0.74, "min": 1.95, "cnt": 128}, "fwd-misc":{"total": 21.61, "avg": 0.17, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1599.14, "avg": 12.49, "max": 10.64, "min": 18.42, "cnt": 128}, "MoE_L0_fwd":{"total": 460.31, "avg": 14.38, "max": 10.57, "min": 18.34, "cnt": 32}, "MoEMLP":{"total": 1581.43, "avg": 12.35, "max": 10.53, "min": 18.29, "cnt": 128}, "MoE_L1_fwd":{"total": 387.93, "avg": 12.12, "max": 10.96, "min": 15.58, "cnt": 32}, "MoE_L2_fwd":{"total": 365.78, "avg": 11.43, "max": 10.70, "min": 17.39, "cnt": 32}, "MoE_L3_fwd":{"total": 373.77, "avg": 11.68, "max": 10.94, "min": 13.64, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.62, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 9.95, "avg": 4.98, "max": 0.95, "min": 9.00, "cnt": 2}, "forward-send-backward-recv":{"total": 205.69, "avg": 6.86, "max": 1.16, "min": 130.67, "cnt": 30}, "backward-compute":{"total": 1756.42, "avg": 54.89, "max": 52.46, "min": 57.78, "cnt": 32}, "MoE_L3_bwd":{"total": 421.29, "avg": 13.17, "max": 11.93, "min": 15.33, "cnt": 32}, "MoE_L2_bwd":{"total": 377.88, "avg": 11.81, "max": 11.24, "min": 12.40, "cnt": 32}, "MoE_L1_bwd":{"total": 382.71, "avg": 11.96, "max": 11.56, "min": 12.89, "cnt": 32}, "MoE_L0_bwd":{"total": 362.67, "avg": 11.33, "max": 10.56, "min": 12.56, "cnt": 32}, "backward-send-forward-recv":{"total": 6623.37, "avg": 228.39, "max": 1.10, "min": 1228.00, "cnt": 29}, "backward-send":{"total": 3.10, "avg": 1.03, "max": 0.93, "min": 1.11, "cnt": 3}, "backward-recv":{"total": 137.12, "avg": 68.56, "max": 65.95, "min": 71.17, "cnt": 2}, "backward-params-all-reduce":{"total": 488.04, "avg": 488.04, "max": 488.04, "min": 488.04, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.04, "avg": 0.04, "max": 0.04, "min": 0.04, "cnt": 1}, "optimizer":{"total": 248.06, "avg": 248.06, "max": 248.06, "min": 248.06, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 203.44, "avg": 203.44, "max": 203.44, "min": 203.44, "cnt": 1}, "optimizer-clip-main-grad":{"total": 7.06, "avg": 7.06, "max": 7.06, "min": 7.06, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 23, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 91.05, "avg": 30.35, "max": 2.89, "min": 83.76, "cnt": 3}, "forward-compute":{"total": 1807.65, "avg": 56.49, "max": 51.04, "min": 64.69, "cnt": 32}, "fwd-compute":{"total": 1804.42, "avg": 56.39, "max": 50.96, "min": 64.60, "cnt": 32}, "batch-generator":{"total": 59.53, "avg": 1.86, "max": 0.67, "min": 4.50, "cnt": 32}, "fwd-embedding":{"total": 0.65, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1732.36, "avg": 54.14, "max": 49.92, "min": 63.52, "cnt": 32}, "fwd-layernorm":{"total": 9.65, "avg": 0.08, "max": 0.05, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 106.17, "avg": 0.83, "max": 0.74, "min": 1.53, "cnt": 128}, "fwd-misc":{"total": 20.88, "avg": 0.16, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1574.79, "avg": 12.30, "max": 10.82, "min": 24.70, "cnt": 128}, "MoE_L0_fwd":{"total": 467.65, "avg": 14.61, "max": 11.63, "min": 24.62, "cnt": 32}, "MoEMLP":{"total": 1558.06, "avg": 12.17, "max": 10.71, "min": 24.57, "cnt": 128}, "MoE_L1_fwd":{"total": 385.45, "avg": 12.05, "max": 11.08, "min": 14.62, "cnt": 32}, "MoE_L2_fwd":{"total": 353.61, "avg": 11.05, "max": 10.75, "min": 12.64, "cnt": 32}, "MoE_L3_fwd":{"total": 357.59, "avg": 11.17, "max": 10.84, "min": 11.99, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 2.00, "avg": 1.00, "max": 0.82, "min": 1.18, "cnt": 2}, "forward-send-backward-recv":{"total": 852.83, "avg": 28.43, "max": 1.63, "min": 147.82, "cnt": 30}, "backward-compute":{"total": 1758.55, "avg": 54.95, "max": 52.57, "min": 56.27, "cnt": 32}, "MoE_L3_bwd":{"total": 413.66, "avg": 12.93, "max": 11.85, "min": 14.50, "cnt": 32}, "MoE_L2_bwd":{"total": 384.43, "avg": 12.01, "max": 11.28, "min": 13.06, "cnt": 32}, "MoE_L1_bwd":{"total": 382.10, "avg": 11.94, "max": 11.22, "min": 12.26, "cnt": 32}, "MoE_L0_bwd":{"total": 365.95, "avg": 11.44, "max": 10.66, "min": 12.79, "cnt": 32}, "backward-send-forward-recv":{"total": 4397.00, "avg": 151.62, "max": 2.47, "min": 494.66, "cnt": 29}, "backward-send":{"total": 2.18, "avg": 0.73, "max": 0.52, "min": 1.07, "cnt": 3}, "backward-recv":{"total": 326.22, "avg": 163.11, "max": 61.70, "min": 264.51, "cnt": 2}, "backward-params-all-reduce":{"total": 489.60, "avg": 489.60, "max": 489.60, "min": 489.60, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 244.39, "avg": 244.39, "max": 244.39, "min": 244.39, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 200.29, "avg": 200.29, "max": 200.29, "min": 200.29, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.82, "avg": 6.82, "max": 6.82, "min": 6.82, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 24, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 65.45, "avg": 21.82, "max": 1.32, "min": 62.71, "cnt": 3}, "forward-compute":{"total": 1870.52, "avg": 58.45, "max": 49.78, "min": 68.48, "cnt": 32}, "fwd-compute":{"total": 1867.58, "avg": 58.36, "max": 49.71, "min": 68.41, "cnt": 32}, "batch-generator":{"total": 54.52, "avg": 1.70, "max": 0.68, "min": 3.60, "cnt": 32}, "fwd-embedding":{"total": 0.50, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1801.25, "avg": 56.29, "max": 48.73, "min": 67.31, "cnt": 32}, "fwd-layernorm":{"total": 9.06, "avg": 0.07, "max": 0.05, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 103.62, "avg": 0.81, "max": 0.74, "min": 1.60, "cnt": 128}, "fwd-misc":{"total": 20.35, "avg": 0.16, "max": 0.12, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1647.99, "avg": 12.87, "max": 10.58, "min": 24.51, "cnt": 128}, "MoE_L0_fwd":{"total": 490.55, "avg": 15.33, "max": 10.99, "min": 24.45, "cnt": 32}, "MoEMLP":{"total": 1631.39, "avg": 12.75, "max": 10.47, "min": 24.41, "cnt": 128}, "MoE_L1_fwd":{"total": 413.28, "avg": 12.92, "max": 11.34, "min": 16.67, "cnt": 32}, "MoE_L2_fwd":{"total": 372.24, "avg": 11.63, "max": 10.74, "min": 13.89, "cnt": 32}, "MoE_L3_fwd":{"total": 361.43, "avg": 11.29, "max": 10.51, "min": 14.72, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.91, "avg": 0.96, "max": 0.95, "min": 0.96, "cnt": 2}, "forward-send-backward-recv":{"total": 234.91, "avg": 7.83, "max": 1.08, "min": 133.04, "cnt": 30}, "backward-compute":{"total": 1751.85, "avg": 54.75, "max": 50.57, "min": 57.57, "cnt": 32}, "MoE_L3_bwd":{"total": 402.75, "avg": 12.59, "max": 11.38, "min": 13.71, "cnt": 32}, "MoE_L2_bwd":{"total": 384.77, "avg": 12.02, "max": 11.21, "min": 14.05, "cnt": 32}, "MoE_L1_bwd":{"total": 382.84, "avg": 11.96, "max": 11.02, "min": 12.52, "cnt": 32}, "MoE_L0_bwd":{"total": 367.57, "avg": 11.49, "max": 10.57, "min": 14.73, "cnt": 32}, "backward-send-forward-recv":{"total": 4861.69, "avg": 167.64, "max": 1.26, "min": 338.88, "cnt": 29}, "backward-send":{"total": 2.66, "avg": 0.89, "max": 0.70, "min": 1.06, "cnt": 3}, "backward-recv":{"total": 137.57, "avg": 68.79, "max": 68.78, "min": 68.79, "cnt": 2}, "backward-params-all-reduce":{"total": 491.46, "avg": 491.46, "max": 491.46, "min": 491.46, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 247.21, "avg": 247.21, "max": 247.21, "min": 247.21, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.47, "avg": 3.47, "max": 3.47, "min": 3.47, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 202.92, "avg": 202.92, "max": 202.92, "min": 202.92, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.80, "avg": 6.80, "max": 6.80, "min": 6.80, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.47, "avg": 3.47, "max": 3.47, "min": 3.47, "cnt": 1}}}
{"type":"time", "iteration": 25, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 87.80, "avg": 29.27, "max": 1.07, "min": 78.21, "cnt": 3}, "forward-compute":{"total": 1831.13, "avg": 57.22, "max": 49.45, "min": 71.02, "cnt": 32}, "fwd-compute":{"total": 1828.29, "avg": 57.13, "max": 49.39, "min": 70.93, "cnt": 32}, "batch-generator":{"total": 41.47, "avg": 1.30, "max": 0.69, "min": 2.34, "cnt": 32}, "fwd-embedding":{"total": 0.51, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1774.94, "avg": 55.47, "max": 48.40, "min": 69.61, "cnt": 32}, "fwd-layernorm":{"total": 9.13, "avg": 0.07, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 107.10, "avg": 0.84, "max": 0.74, "min": 1.78, "cnt": 128}, "fwd-misc":{"total": 20.69, "avg": 0.16, "max": 0.11, "min": 0.34, "cnt": 128}, "fwd-MLP":{"total": 1617.30, "avg": 12.64, "max": 10.44, "min": 26.91, "cnt": 128}, "MoE_L0_fwd":{"total": 502.87, "avg": 15.71, "max": 11.05, "min": 26.83, "cnt": 32}, "MoEMLP":{"total": 1600.40, "avg": 12.50, "max": 10.33, "min": 26.79, "cnt": 128}, "MoE_L1_fwd":{"total": 394.33, "avg": 12.32, "max": 11.18, "min": 20.17, "cnt": 32}, "MoE_L2_fwd":{"total": 358.08, "avg": 11.19, "max": 10.69, "min": 13.41, "cnt": 32}, "MoE_L3_fwd":{"total": 351.22, "avg": 10.98, "max": 10.37, "min": 13.39, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.63, "avg": 0.82, "max": 0.66, "min": 0.97, "cnt": 2}, "forward-send-backward-recv":{"total": 211.34, "avg": 7.04, "max": 1.79, "min": 123.63, "cnt": 30}, "backward-compute":{"total": 1725.55, "avg": 53.92, "max": 50.79, "min": 55.39, "cnt": 32}, "MoE_L3_bwd":{"total": 395.46, "avg": 12.36, "max": 11.75, "min": 13.77, "cnt": 32}, "MoE_L2_bwd":{"total": 378.37, "avg": 11.82, "max": 10.93, "min": 12.32, "cnt": 32}, "MoE_L1_bwd":{"total": 379.87, "avg": 11.87, "max": 11.11, "min": 12.26, "cnt": 32}, "MoE_L0_bwd":{"total": 357.62, "avg": 11.18, "max": 10.44, "min": 11.51, "cnt": 32}, "backward-send-forward-recv":{"total": 6808.80, "avg": 234.79, "max": 2.39, "min": 805.54, "cnt": 29}, "backward-send":{"total": 3.11, "avg": 1.04, "max": 0.91, "min": 1.11, "cnt": 3}, "backward-recv":{"total": 144.86, "avg": 72.43, "max": 68.29, "min": 76.57, "cnt": 2}, "backward-params-all-reduce":{"total": 493.07, "avg": 493.07, "max": 493.07, "min": 493.07, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 252.10, "avg": 252.10, "max": 252.10, "min": 252.10, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 207.89, "avg": 207.89, "max": 207.89, "min": 207.89, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.89, "avg": 6.89, "max": 6.89, "min": 6.89, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 26, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.06, "avg": 0.06, "max": 0.06, "min": 0.06, "cnt": 1}, "forward-recv":{"total": 88.27, "avg": 29.42, "max": 1.14, "min": 85.97, "cnt": 3}, "forward-compute":{"total": 1771.64, "avg": 55.36, "max": 49.21, "min": 68.34, "cnt": 32}, "fwd-compute":{"total": 1768.87, "avg": 55.28, "max": 49.14, "min": 68.25, "cnt": 32}, "batch-generator":{"total": 50.83, "avg": 1.59, "max": 0.67, "min": 3.19, "cnt": 32}, "fwd-embedding":{"total": 0.55, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1705.97, "avg": 53.31, "max": 47.76, "min": 66.94, "cnt": 32}, "fwd-layernorm":{"total": 9.28, "avg": 0.07, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 104.22, "avg": 0.81, "max": 0.74, "min": 1.52, "cnt": 128}, "fwd-misc":{"total": 20.36, "avg": 0.16, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1551.50, "avg": 12.12, "max": 10.37, "min": 26.92, "cnt": 128}, "MoE_L0_fwd":{"total": 451.21, "avg": 14.10, "max": 10.42, "min": 26.84, "cnt": 32}, "MoEMLP":{"total": 1534.50, "avg": 11.99, "max": 10.26, "min": 26.79, "cnt": 128}, "MoE_L1_fwd":{"total": 382.91, "avg": 11.97, "max": 11.08, "min": 16.83, "cnt": 32}, "MoE_L2_fwd":{"total": 363.51, "avg": 11.36, "max": 10.59, "min": 15.31, "cnt": 32}, "MoE_L3_fwd":{"total": 342.96, "avg": 10.72, "max": 10.30, "min": 11.33, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 8.13, "avg": 4.07, "max": 0.99, "min": 7.14, "cnt": 2}, "forward-send-backward-recv":{"total": 419.90, "avg": 14.00, "max": 1.36, "min": 176.99, "cnt": 30}, "backward-compute":{"total": 1774.15, "avg": 55.44, "max": 51.27, "min": 106.31, "cnt": 32}, "MoE_L3_bwd":{"total": 446.75, "avg": 13.96, "max": 11.61, "min": 65.73, "cnt": 32}, "MoE_L2_bwd":{"total": 378.92, "avg": 11.84, "max": 11.20, "min": 13.12, "cnt": 32}, "MoE_L1_bwd":{"total": 381.67, "avg": 11.93, "max": 11.35, "min": 12.35, "cnt": 32}, "MoE_L0_bwd":{"total": 353.18, "avg": 11.04, "max": 10.38, "min": 12.00, "cnt": 32}, "backward-send-forward-recv":{"total": 8209.54, "avg": 283.09, "max": 2.36, "min": 673.31, "cnt": 29}, "backward-send":{"total": 2.41, "avg": 0.80, "max": 0.60, "min": 1.02, "cnt": 3}, "backward-recv":{"total": 146.95, "avg": 73.47, "max": 67.14, "min": 79.81, "cnt": 2}, "backward-params-all-reduce":{"total": 485.98, "avg": 485.98, "max": 485.98, "min": 485.98, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 258.29, "avg": 258.29, "max": 258.29, "min": 258.29, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 206.20, "avg": 206.20, "max": 206.20, "min": 206.20, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.80, "avg": 6.80, "max": 6.80, "min": 6.80, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.41, "avg": 3.41, "max": 3.41, "min": 3.41, "cnt": 1}}}
{"type":"time", "iteration": 27, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.11, "avg": 0.11, "max": 0.11, "min": 0.11, "cnt": 1}, "forward-recv":{"total": 833.89, "avg": 277.96, "max": 62.81, "min": 702.79, "cnt": 3}, "forward-compute":{"total": 1792.20, "avg": 56.01, "max": 49.37, "min": 61.03, "cnt": 32}, "fwd-compute":{"total": 1789.01, "avg": 55.91, "max": 49.30, "min": 60.95, "cnt": 32}, "batch-generator":{"total": 50.58, "avg": 1.58, "max": 0.74, "min": 3.33, "cnt": 32}, "fwd-embedding":{"total": 0.61, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1725.64, "avg": 53.93, "max": 47.34, "min": 59.71, "cnt": 32}, "fwd-layernorm":{"total": 9.41, "avg": 0.07, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 104.94, "avg": 0.82, "max": 0.74, "min": 1.46, "cnt": 128}, "fwd-misc":{"total": 20.89, "avg": 0.16, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1569.33, "avg": 12.26, "max": 10.33, "min": 19.30, "cnt": 128}, "MoE_L0_fwd":{"total": 444.93, "avg": 13.90, "max": 10.25, "min": 19.22, "cnt": 32}, "MoEMLP":{"total": 1552.54, "avg": 12.13, "max": 10.21, "min": 19.17, "cnt": 128}, "MoE_L1_fwd":{"total": 388.92, "avg": 12.15, "max": 11.13, "min": 14.64, "cnt": 32}, "MoE_L2_fwd":{"total": 363.54, "avg": 11.36, "max": 10.75, "min": 17.80, "cnt": 32}, "MoE_L3_fwd":{"total": 361.25, "avg": 11.29, "max": 10.46, "min": 15.09, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.88, "avg": 0.94, "max": 0.93, "min": 0.95, "cnt": 2}, "forward-send-backward-recv":{"total": 1669.06, "avg": 55.64, "max": 1.63, "min": 304.85, "cnt": 30}, "backward-compute":{"total": 1730.73, "avg": 54.09, "max": 51.18, "min": 55.49, "cnt": 32}, "MoE_L3_bwd":{"total": 395.82, "avg": 12.37, "max": 11.16, "min": 13.49, "cnt": 32}, "MoE_L2_bwd":{"total": 381.17, "avg": 11.91, "max": 11.36, "min": 14.10, "cnt": 32}, "MoE_L1_bwd":{"total": 382.81, "avg": 11.96, "max": 11.65, "min": 13.58, "cnt": 32}, "MoE_L0_bwd":{"total": 354.65, "avg": 11.08, "max": 10.24, "min": 13.06, "cnt": 32}, "backward-send-forward-recv":{"total": 4361.44, "avg": 150.39, "max": 1.95, "min": 952.34, "cnt": 29}, "backward-send":{"total": 2.59, "avg": 0.86, "max": 0.75, "min": 1.06, "cnt": 3}, "backward-recv":{"total": 425.10, "avg": 212.55, "max": 161.49, "min": 263.61, "cnt": 2}, "backward-params-all-reduce":{"total": 486.08, "avg": 486.08, "max": 486.08, "min": 486.08, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 255.57, "avg": 255.57, "max": 255.57, "min": 255.57, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 211.40, "avg": 211.40, "max": 211.40, "min": 211.40, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.83, "avg": 6.83, "max": 6.83, "min": 6.83, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}}}
{"type":"time", "iteration": 28, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 79.01, "avg": 26.34, "max": 3.38, "min": 70.21, "cnt": 3}, "forward-compute":{"total": 1785.25, "avg": 55.79, "max": 49.26, "min": 63.52, "cnt": 32}, "fwd-compute":{"total": 1782.27, "avg": 55.70, "max": 49.19, "min": 63.44, "cnt": 32}, "batch-generator":{"total": 45.98, "avg": 1.44, "max": 0.70, "min": 3.12, "cnt": 32}, "fwd-embedding":{"total": 0.51, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1724.54, "avg": 53.89, "max": 48.16, "min": 61.64, "cnt": 32}, "fwd-layernorm":{"total": 8.99, "avg": 0.07, "max": 0.05, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 103.35, "avg": 0.81, "max": 0.74, "min": 1.71, "cnt": 128}, "fwd-misc":{"total": 19.80, "avg": 0.15, "max": 0.11, "min": 0.34, "cnt": 128}, "fwd-MLP":{"total": 1572.47, "avg": 12.28, "max": 10.54, "min": 19.87, "cnt": 128}, "MoE_L0_fwd":{"total": 454.58, "avg": 14.21, "max": 10.47, "min": 19.79, "cnt": 32}, "MoEMLP":{"total": 1556.38, "avg": 12.16, "max": 10.42, "min": 19.74, "cnt": 128}, "MoE_L1_fwd":{"total": 400.01, "avg": 12.50, "max": 11.11, "min": 16.62, "cnt": 32}, "MoE_L2_fwd":{"total": 354.66, "avg": 11.08, "max": 10.62, "min": 12.34, "cnt": 32}, "MoE_L3_fwd":{"total": 353.00, "avg": 11.03, "max": 10.47, "min": 12.22, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 3.15, "avg": 1.57, "max": 0.92, "min": 2.23, "cnt": 2}, "forward-send-backward-recv":{"total": 496.66, "avg": 16.56, "max": 1.58, "min": 189.18, "cnt": 30}, "backward-compute":{"total": 1749.30, "avg": 54.67, "max": 50.14, "min": 56.88, "cnt": 32}, "MoE_L3_bwd":{"total": 415.29, "avg": 12.98, "max": 11.63, "min": 14.66, "cnt": 32}, "MoE_L2_bwd":{"total": 381.60, "avg": 11.93, "max": 10.85, "min": 12.41, "cnt": 32}, "MoE_L1_bwd":{"total": 383.52, "avg": 11.98, "max": 11.20, "min": 13.01, "cnt": 32}, "MoE_L0_bwd":{"total": 354.27, "avg": 11.07, "max": 10.28, "min": 12.68, "cnt": 32}, "backward-send-forward-recv":{"total": 5953.98, "avg": 205.31, "max": 2.34, "min": 757.63, "cnt": 29}, "backward-send":{"total": 2.36, "avg": 0.79, "max": 0.63, "min": 1.07, "cnt": 3}, "backward-recv":{"total": 139.24, "avg": 69.62, "max": 63.26, "min": 75.98, "cnt": 2}, "backward-params-all-reduce":{"total": 501.61, "avg": 501.61, "max": 501.61, "min": 501.61, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 237.02, "avg": 237.02, "max": 237.02, "min": 237.02, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 192.84, "avg": 192.84, "max": 192.84, "min": 192.84, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.80, "avg": 6.80, "max": 6.80, "min": 6.80, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.47, "avg": 3.47, "max": 3.47, "min": 3.47, "cnt": 1}}}
{"type":"time", "iteration": 29, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 92.50, "avg": 30.83, "max": 1.33, "min": 80.27, "cnt": 3}, "forward-compute":{"total": 1836.71, "avg": 57.40, "max": 50.43, "min": 68.10, "cnt": 32}, "fwd-compute":{"total": 1833.74, "avg": 57.30, "max": 50.34, "min": 68.02, "cnt": 32}, "batch-generator":{"total": 38.62, "avg": 1.21, "max": 0.74, "min": 2.24, "cnt": 32}, "fwd-embedding":{"total": 0.56, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1783.12, "avg": 55.72, "max": 48.59, "min": 66.61, "cnt": 32}, "fwd-layernorm":{"total": 9.64, "avg": 0.08, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 110.33, "avg": 0.86, "max": 0.74, "min": 2.46, "cnt": 128}, "fwd-misc":{"total": 21.98, "avg": 0.17, "max": 0.11, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1619.57, "avg": 12.65, "max": 10.64, "min": 24.97, "cnt": 128}, "MoE_L0_fwd":{"total": 479.29, "avg": 14.98, "max": 10.64, "min": 24.82, "cnt": 32}, "MoEMLP":{"total": 1602.06, "avg": 12.52, "max": 10.53, "min": 24.73, "cnt": 128}, "MoE_L1_fwd":{"total": 399.53, "avg": 12.49, "max": 11.33, "min": 15.49, "cnt": 32}, "MoE_L2_fwd":{"total": 368.08, "avg": 11.50, "max": 10.64, "min": 14.68, "cnt": 32}, "MoE_L3_fwd":{"total": 361.54, "avg": 11.30, "max": 10.57, "min": 14.69, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.61, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.71, "avg": 0.85, "max": 0.81, "min": 0.90, "cnt": 2}, "forward-send-backward-recv":{"total": 199.73, "avg": 6.66, "max": 1.51, "min": 112.03, "cnt": 30}, "backward-compute":{"total": 1731.38, "avg": 54.11, "max": 51.60, "min": 56.17, "cnt": 32}, "MoE_L3_bwd":{"total": 410.09, "avg": 12.82, "max": 12.07, "min": 14.16, "cnt": 32}, "MoE_L2_bwd":{"total": 379.73, "avg": 11.87, "max": 11.05, "min": 12.59, "cnt": 32}, "MoE_L1_bwd":{"total": 381.95, "avg": 11.94, "max": 11.12, "min": 12.50, "cnt": 32}, "MoE_L0_bwd":{"total": 346.55, "avg": 10.83, "max": 10.19, "min": 11.62, "cnt": 32}, "backward-send-forward-recv":{"total": 6471.00, "avg": 223.14, "max": 2.40, "min": 1304.66, "cnt": 29}, "backward-send":{"total": 3.44, "avg": 1.15, "max": 0.62, "min": 2.16, "cnt": 3}, "backward-recv":{"total": 152.29, "avg": 76.15, "max": 74.99, "min": 77.31, "cnt": 2}, "backward-params-all-reduce":{"total": 487.15, "avg": 487.15, "max": 487.15, "min": 487.15, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 254.71, "avg": 254.71, "max": 254.71, "min": 254.71, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.36, "avg": 3.36, "max": 3.36, "min": 3.36, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 210.06, "avg": 210.06, "max": 210.06, "min": 210.06, "cnt": 1}, "optimizer-clip-main-grad":{"total": 7.59, "avg": 7.59, "max": 7.59, "min": 7.59, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}}}
{"type":"time", "iteration": 30, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 84.41, "avg": 28.14, "max": 5.75, "min": 71.48, "cnt": 3}, "forward-compute":{"total": 1764.14, "avg": 55.13, "max": 49.79, "min": 64.20, "cnt": 32}, "fwd-compute":{"total": 1761.14, "avg": 55.04, "max": 49.72, "min": 64.12, "cnt": 32}, "batch-generator":{"total": 47.16, "avg": 1.47, "max": 0.69, "min": 3.81, "cnt": 32}, "fwd-embedding":{"total": 0.57, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1701.86, "avg": 53.18, "max": 48.71, "min": 62.83, "cnt": 32}, "fwd-layernorm":{"total": 9.12, "avg": 0.07, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 104.13, "avg": 0.81, "max": 0.73, "min": 1.53, "cnt": 128}, "fwd-misc":{"total": 20.03, "avg": 0.16, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1548.34, "avg": 12.10, "max": 10.72, "min": 22.93, "cnt": 128}, "MoE_L0_fwd":{"total": 444.48, "avg": 13.89, "max": 10.83, "min": 22.85, "cnt": 32}, "MoEMLP":{"total": 1531.93, "avg": 11.97, "max": 10.62, "min": 22.80, "cnt": 128}, "MoE_L1_fwd":{"total": 383.11, "avg": 11.97, "max": 11.30, "min": 13.79, "cnt": 32}, "MoE_L2_fwd":{"total": 354.30, "avg": 11.07, "max": 10.67, "min": 12.97, "cnt": 32}, "MoE_L3_fwd":{"total": 356.00, "avg": 11.12, "max": 10.65, "min": 13.03, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.87, "avg": 0.93, "max": 0.93, "min": 0.94, "cnt": 2}, "forward-send-backward-recv":{"total": 224.59, "avg": 7.49, "max": 1.81, "min": 132.05, "cnt": 30}, "backward-compute":{"total": 1742.66, "avg": 54.46, "max": 52.39, "min": 56.72, "cnt": 32}, "MoE_L3_bwd":{"total": 413.37, "avg": 12.92, "max": 11.77, "min": 15.15, "cnt": 32}, "MoE_L2_bwd":{"total": 380.76, "avg": 11.90, "max": 11.08, "min": 13.97, "cnt": 32}, "MoE_L1_bwd":{"total": 380.28, "avg": 11.88, "max": 11.27, "min": 12.43, "cnt": 32}, "MoE_L0_bwd":{"total": 353.31, "avg": 11.04, "max": 10.18, "min": 13.75, "cnt": 32}, "backward-send-forward-recv":{"total": 5508.14, "avg": 189.94, "max": 2.35, "min": 749.02, "cnt": 29}, "backward-send":{"total": 2.82, "avg": 0.94, "max": 0.54, "min": 1.17, "cnt": 3}, "backward-recv":{"total": 142.76, "avg": 71.38, "max": 65.75, "min": 77.00, "cnt": 2}, "backward-params-all-reduce":{"total": 485.24, "avg": 485.24, "max": 485.24, "min": 485.24, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 263.04, "avg": 263.04, "max": 263.04, "min": 263.04, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.36, "avg": 3.36, "max": 3.36, "min": 3.36, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 218.81, "avg": 218.81, "max": 218.81, "min": 218.81, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.97, "avg": 6.97, "max": 6.97, "min": 6.97, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 31, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 85.92, "avg": 28.64, "max": 4.16, "min": 76.59, "cnt": 3}, "forward-compute":{"total": 1899.02, "avg": 59.34, "max": 49.80, "min": 132.59, "cnt": 32}, "fwd-compute":{"total": 1895.87, "avg": 59.25, "max": 49.72, "min": 132.50, "cnt": 32}, "batch-generator":{"total": 46.23, "avg": 1.44, "max": 0.69, "min": 2.63, "cnt": 32}, "fwd-embedding":{"total": 0.66, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1836.84, "avg": 57.40, "max": 48.64, "min": 129.67, "cnt": 32}, "fwd-layernorm":{"total": 10.06, "avg": 0.08, "max": 0.05, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 111.73, "avg": 0.87, "max": 0.74, "min": 1.53, "cnt": 128}, "fwd-misc":{"total": 21.99, "avg": 0.17, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1670.89, "avg": 13.05, "max": 10.62, "min": 85.59, "cnt": 128}, "MoE_L0_fwd":{"total": 465.13, "avg": 14.54, "max": 11.30, "min": 18.84, "cnt": 32}, "MoEMLP":{"total": 1653.38, "avg": 12.92, "max": 10.51, "min": 85.46, "cnt": 128}, "MoE_L1_fwd":{"total": 392.02, "avg": 12.25, "max": 11.30, "min": 15.27, "cnt": 32}, "MoE_L2_fwd":{"total": 356.70, "avg": 11.15, "max": 10.56, "min": 13.53, "cnt": 32}, "MoE_L3_fwd":{"total": 445.95, "avg": 13.94, "max": 10.55, "min": 85.51, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 2.54, "avg": 1.27, "max": 0.98, "min": 1.55, "cnt": 2}, "forward-send-backward-recv":{"total": 607.54, "avg": 20.25, "max": 0.98, "min": 203.01, "cnt": 30}, "backward-compute":{"total": 1748.89, "avg": 54.65, "max": 50.77, "min": 57.15, "cnt": 32}, "MoE_L3_bwd":{"total": 423.15, "avg": 13.22, "max": 11.93, "min": 14.94, "cnt": 32}, "MoE_L2_bwd":{"total": 371.17, "avg": 11.60, "max": 10.69, "min": 12.23, "cnt": 32}, "MoE_L1_bwd":{"total": 380.75, "avg": 11.90, "max": 11.40, "min": 12.33, "cnt": 32}, "MoE_L0_bwd":{"total": 360.31, "avg": 11.26, "max": 10.64, "min": 12.23, "cnt": 32}, "backward-send-forward-recv":{"total": 6965.29, "avg": 240.18, "max": 1.87, "min": 1398.86, "cnt": 29}, "backward-send":{"total": 3.06, "avg": 1.02, "max": 0.87, "min": 1.13, "cnt": 3}, "backward-recv":{"total": 151.13, "avg": 75.56, "max": 74.82, "min": 76.31, "cnt": 2}, "backward-params-all-reduce":{"total": 502.02, "avg": 502.02, "max": 502.02, "min": 502.02, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 254.42, "avg": 254.42, "max": 254.42, "min": 254.42, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 210.17, "avg": 210.17, "max": 210.17, "min": 210.17, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.76, "avg": 6.76, "max": 6.76, "min": 6.76, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 32, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 76.77, "avg": 25.59, "max": 0.94, "min": 66.38, "cnt": 3}, "forward-compute":{"total": 1817.58, "avg": 56.80, "max": 51.84, "min": 62.88, "cnt": 32}, "fwd-compute":{"total": 1814.45, "avg": 56.70, "max": 51.74, "min": 62.80, "cnt": 32}, "batch-generator":{"total": 64.05, "avg": 2.00, "max": 0.67, "min": 6.25, "cnt": 32}, "fwd-embedding":{"total": 0.71, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1737.64, "avg": 54.30, "max": 50.16, "min": 59.58, "cnt": 32}, "fwd-layernorm":{"total": 10.04, "avg": 0.08, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 108.10, "avg": 0.84, "max": 0.73, "min": 1.54, "cnt": 128}, "fwd-misc":{"total": 21.34, "avg": 0.17, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1576.78, "avg": 12.32, "max": 10.65, "min": 17.93, "cnt": 128}, "MoE_L0_fwd":{"total": 461.42, "avg": 14.42, "max": 11.77, "min": 17.86, "cnt": 32}, "MoEMLP":{"total": 1559.47, "avg": 12.18, "max": 10.54, "min": 17.81, "cnt": 128}, "MoE_L1_fwd":{"total": 382.84, "avg": 11.96, "max": 11.08, "min": 13.57, "cnt": 32}, "MoE_L2_fwd":{"total": 354.58, "avg": 11.08, "max": 10.58, "min": 11.85, "cnt": 32}, "MoE_L3_fwd":{"total": 366.97, "avg": 11.47, "max": 10.61, "min": 13.26, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.61, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.47, "avg": 0.74, "max": 0.70, "min": 0.77, "cnt": 2}, "forward-send-backward-recv":{"total": 214.60, "avg": 7.15, "max": 1.74, "min": 120.59, "cnt": 30}, "backward-compute":{"total": 1749.55, "avg": 54.67, "max": 51.41, "min": 57.03, "cnt": 32}, "MoE_L3_bwd":{"total": 409.32, "avg": 12.79, "max": 12.00, "min": 14.98, "cnt": 32}, "MoE_L2_bwd":{"total": 376.05, "avg": 11.75, "max": 11.09, "min": 12.46, "cnt": 32}, "MoE_L1_bwd":{"total": 382.24, "avg": 11.94, "max": 11.11, "min": 12.36, "cnt": 32}, "MoE_L0_bwd":{"total": 366.41, "avg": 11.45, "max": 10.63, "min": 12.33, "cnt": 32}, "backward-send-forward-recv":{"total": 6210.44, "avg": 214.15, "max": 2.27, "min": 877.55, "cnt": 29}, "backward-send":{"total": 2.50, "avg": 0.83, "max": 0.63, "min": 1.13, "cnt": 3}, "backward-recv":{"total": 1883.28, "avg": 941.64, "max": 744.59, "min": 1138.68, "cnt": 2}, "backward-params-all-reduce":{"total": 487.49, "avg": 487.49, "max": 487.49, "min": 487.49, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 255.02, "avg": 255.02, "max": 255.02, "min": 255.02, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 206.49, "avg": 206.49, "max": 206.49, "min": 206.49, "cnt": 1}, "optimizer-clip-main-grad":{"total": 9.65, "avg": 9.65, "max": 9.65, "min": 9.65, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}}}
{"type":"time", "iteration": 33, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 84.01, "avg": 28.00, "max": 4.96, "min": 72.56, "cnt": 3}, "forward-compute":{"total": 1808.24, "avg": 56.51, "max": 51.01, "min": 62.71, "cnt": 32}, "fwd-compute":{"total": 1804.76, "avg": 56.40, "max": 50.94, "min": 62.62, "cnt": 32}, "batch-generator":{"total": 52.25, "avg": 1.63, "max": 0.72, "min": 3.49, "cnt": 32}, "fwd-embedding":{"total": 0.67, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1739.32, "avg": 54.35, "max": 49.91, "min": 58.76, "cnt": 32}, "fwd-layernorm":{"total": 10.22, "avg": 0.08, "max": 0.05, "min": 0.22, "cnt": 128}, "fwd-attn":{"total": 109.43, "avg": 0.85, "max": 0.74, "min": 1.58, "cnt": 128}, "fwd-misc":{"total": 21.63, "avg": 0.17, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1576.37, "avg": 12.32, "max": 10.66, "min": 19.10, "cnt": 128}, "MoE_L0_fwd":{"total": 464.03, "avg": 14.50, "max": 11.83, "min": 19.02, "cnt": 32}, "MoEMLP":{"total": 1558.94, "avg": 12.18, "max": 10.56, "min": 18.98, "cnt": 128}, "MoE_L1_fwd":{"total": 382.12, "avg": 11.94, "max": 11.07, "min": 16.19, "cnt": 32}, "MoE_L2_fwd":{"total": 357.89, "avg": 11.18, "max": 10.60, "min": 12.77, "cnt": 32}, "MoE_L3_fwd":{"total": 361.33, "avg": 11.29, "max": 10.68, "min": 13.92, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 2.29, "avg": 1.14, "max": 0.90, "min": 1.39, "cnt": 2}, "forward-send-backward-recv":{"total": 1075.77, "avg": 35.86, "max": 1.77, "min": 260.71, "cnt": 30}, "backward-compute":{"total": 1747.49, "avg": 54.61, "max": 52.47, "min": 56.18, "cnt": 32}, "MoE_L3_bwd":{"total": 404.87, "avg": 12.65, "max": 11.78, "min": 13.55, "cnt": 32}, "MoE_L2_bwd":{"total": 377.97, "avg": 11.81, "max": 10.89, "min": 12.52, "cnt": 32}, "MoE_L1_bwd":{"total": 385.01, "avg": 12.03, "max": 11.32, "min": 12.46, "cnt": 32}, "MoE_L0_bwd":{"total": 366.16, "avg": 11.44, "max": 10.99, "min": 11.87, "cnt": 32}, "backward-send-forward-recv":{"total": 8801.38, "avg": 303.50, "max": 2.41, "min": 1248.74, "cnt": 29}, "backward-send":{"total": 3.24, "avg": 1.08, "max": 0.95, "min": 1.18, "cnt": 3}, "backward-recv":{"total": 290.27, "avg": 145.13, "max": 134.96, "min": 155.30, "cnt": 2}, "backward-params-all-reduce":{"total": 487.35, "avg": 487.35, "max": 487.35, "min": 487.35, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.04, "avg": 0.04, "max": 0.04, "min": 0.04, "cnt": 1}, "optimizer":{"total": 258.28, "avg": 258.28, "max": 258.28, "min": 258.28, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 207.31, "avg": 207.31, "max": 207.31, "min": 207.31, "cnt": 1}, "optimizer-clip-main-grad":{"total": 9.70, "avg": 9.70, "max": 9.70, "min": 9.70, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 34, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 79.27, "avg": 26.42, "max": 5.44, "min": 65.34, "cnt": 3}, "forward-compute":{"total": 1798.79, "avg": 56.21, "max": 50.61, "min": 61.64, "cnt": 32}, "fwd-compute":{"total": 1795.67, "avg": 56.11, "max": 50.53, "min": 61.55, "cnt": 32}, "batch-generator":{"total": 62.71, "avg": 1.96, "max": 0.66, "min": 4.48, "cnt": 32}, "fwd-embedding":{"total": 0.68, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1720.38, "avg": 53.76, "max": 49.37, "min": 58.91, "cnt": 32}, "fwd-layernorm":{"total": 9.86, "avg": 0.08, "max": 0.05, "min": 0.24, "cnt": 128}, "fwd-attn":{"total": 107.55, "avg": 0.84, "max": 0.74, "min": 1.79, "cnt": 128}, "fwd-misc":{"total": 21.13, "avg": 0.17, "max": 0.11, "min": 0.38, "cnt": 128}, "fwd-MLP":{"total": 1560.86, "avg": 12.19, "max": 10.77, "min": 20.05, "cnt": 128}, "MoE_L0_fwd":{"total": 448.09, "avg": 14.00, "max": 11.49, "min": 19.97, "cnt": 32}, "MoEMLP":{"total": 1543.94, "avg": 12.06, "max": 10.66, "min": 19.91, "cnt": 128}, "MoE_L1_fwd":{"total": 392.54, "avg": 12.27, "max": 11.02, "min": 15.84, "cnt": 32}, "MoE_L2_fwd":{"total": 357.58, "avg": 11.17, "max": 10.72, "min": 12.41, "cnt": 32}, "MoE_L3_fwd":{"total": 352.02, "avg": 11.00, "max": 10.70, "min": 11.83, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.75, "avg": 0.87, "max": 0.86, "min": 0.89, "cnt": 2}, "forward-send-backward-recv":{"total": 361.29, "avg": 12.04, "max": 1.34, "min": 156.00, "cnt": 30}, "backward-compute":{"total": 1764.55, "avg": 55.14, "max": 53.68, "min": 57.70, "cnt": 32}, "MoE_L3_bwd":{"total": 407.27, "avg": 12.73, "max": 12.08, "min": 13.99, "cnt": 32}, "MoE_L2_bwd":{"total": 378.96, "avg": 11.84, "max": 10.98, "min": 12.33, "cnt": 32}, "MoE_L1_bwd":{"total": 389.70, "avg": 12.18, "max": 11.36, "min": 13.60, "cnt": 32}, "MoE_L0_bwd":{"total": 372.02, "avg": 11.63, "max": 11.31, "min": 12.94, "cnt": 32}, "backward-send-forward-recv":{"total": 10897.24, "avg": 375.77, "max": 2.35, "min": 1918.27, "cnt": 29}, "backward-send":{"total": 2.85, "avg": 0.95, "max": 0.90, "min": 1.06, "cnt": 3}, "backward-recv":{"total": 341.39, "avg": 170.69, "max": 112.07, "min": 229.31, "cnt": 2}, "backward-params-all-reduce":{"total": 487.13, "avg": 487.13, "max": 487.13, "min": 487.13, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 250.91, "avg": 250.91, "max": 250.91, "min": 250.91, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.36, "avg": 3.36, "max": 3.36, "min": 3.36, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 206.89, "avg": 206.89, "max": 206.89, "min": 206.89, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.75, "avg": 6.75, "max": 6.75, "min": 6.75, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}}}
{"type":"time", "iteration": 35, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.10, "avg": 0.10, "max": 0.10, "min": 0.10, "cnt": 1}, "forward-recv":{"total": 82.12, "avg": 27.37, "max": 1.22, "min": 74.82, "cnt": 3}, "forward-compute":{"total": 1788.61, "avg": 55.89, "max": 51.01, "min": 62.73, "cnt": 32}, "fwd-compute":{"total": 1785.48, "avg": 55.80, "max": 50.93, "min": 62.63, "cnt": 32}, "batch-generator":{"total": 41.93, "avg": 1.31, "max": 0.67, "min": 3.42, "cnt": 32}, "fwd-embedding":{"total": 0.55, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1730.70, "avg": 54.08, "max": 49.53, "min": 59.24, "cnt": 32}, "fwd-layernorm":{"total": 9.66, "avg": 0.08, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 109.19, "avg": 0.85, "max": 0.74, "min": 1.57, "cnt": 128}, "fwd-misc":{"total": 21.11, "avg": 0.16, "max": 0.11, "min": 0.41, "cnt": 128}, "fwd-MLP":{"total": 1569.26, "avg": 12.26, "max": 10.73, "min": 18.79, "cnt": 128}, "MoE_L0_fwd":{"total": 465.78, "avg": 14.56, "max": 11.39, "min": 18.71, "cnt": 32}, "MoEMLP":{"total": 1551.98, "avg": 12.12, "max": 10.62, "min": 18.66, "cnt": 128}, "MoE_L1_fwd":{"total": 375.67, "avg": 11.74, "max": 10.94, "min": 14.82, "cnt": 32}, "MoE_L2_fwd":{"total": 359.26, "avg": 11.23, "max": 10.87, "min": 12.92, "cnt": 32}, "MoE_L3_fwd":{"total": 357.55, "avg": 11.17, "max": 10.67, "min": 12.55, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.96, "avg": 0.98, "max": 0.96, "min": 1.00, "cnt": 2}, "forward-send-backward-recv":{"total": 655.01, "avg": 21.83, "max": 1.37, "min": 195.73, "cnt": 30}, "backward-compute":{"total": 1738.57, "avg": 54.33, "max": 51.13, "min": 57.15, "cnt": 32}, "MoE_L3_bwd":{"total": 405.76, "avg": 12.68, "max": 12.03, "min": 13.68, "cnt": 32}, "MoE_L2_bwd":{"total": 377.48, "avg": 11.80, "max": 11.00, "min": 13.76, "cnt": 32}, "MoE_L1_bwd":{"total": 364.30, "avg": 11.38, "max": 10.74, "min": 12.17, "cnt": 32}, "MoE_L0_bwd":{"total": 373.21, "avg": 11.66, "max": 10.96, "min": 12.85, "cnt": 32}, "backward-send-forward-recv":{"total": 3981.95, "avg": 137.31, "max": 2.35, "min": 393.13, "cnt": 29}, "backward-send":{"total": 3.35, "avg": 1.12, "max": 1.06, "min": 1.16, "cnt": 3}, "backward-recv":{"total": 309.82, "avg": 154.91, "max": 80.48, "min": 229.34, "cnt": 2}, "backward-params-all-reduce":{"total": 488.01, "avg": 488.01, "max": 488.01, "min": 488.01, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 251.92, "avg": 251.92, "max": 251.92, "min": 251.92, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 207.73, "avg": 207.73, "max": 207.73, "min": 207.73, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.89, "avg": 6.89, "max": 6.89, "min": 6.89, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 36, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.06, "avg": 0.06, "max": 0.06, "min": 0.06, "cnt": 1}, "forward-recv":{"total": 80.23, "avg": 26.74, "max": 0.72, "min": 75.32, "cnt": 3}, "forward-compute":{"total": 1825.91, "avg": 57.06, "max": 49.33, "min": 73.07, "cnt": 32}, "fwd-compute":{"total": 1823.03, "avg": 56.97, "max": 49.26, "min": 72.98, "cnt": 32}, "batch-generator":{"total": 44.91, "avg": 1.40, "max": 0.65, "min": 3.84, "cnt": 32}, "fwd-embedding":{"total": 0.58, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1765.98, "avg": 55.19, "max": 48.23, "min": 70.50, "cnt": 32}, "fwd-layernorm":{"total": 9.48, "avg": 0.07, "max": 0.05, "min": 0.23, "cnt": 128}, "fwd-attn":{"total": 107.29, "avg": 0.84, "max": 0.74, "min": 1.57, "cnt": 128}, "fwd-misc":{"total": 20.83, "avg": 0.16, "max": 0.11, "min": 0.41, "cnt": 128}, "fwd-MLP":{"total": 1607.43, "avg": 12.56, "max": 10.58, "min": 30.61, "cnt": 128}, "MoE_L0_fwd":{"total": 497.53, "avg": 15.55, "max": 11.54, "min": 30.47, "cnt": 32}, "MoEMLP":{"total": 1589.97, "avg": 12.42, "max": 10.47, "min": 30.39, "cnt": 128}, "MoE_L1_fwd":{"total": 378.46, "avg": 11.83, "max": 10.63, "min": 15.54, "cnt": 32}, "MoE_L2_fwd":{"total": 368.22, "avg": 11.51, "max": 10.51, "min": 12.77, "cnt": 32}, "MoE_L3_fwd":{"total": 351.79, "avg": 10.99, "max": 10.56, "min": 11.74, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 12.51, "avg": 6.26, "max": 1.02, "min": 11.50, "cnt": 2}, "forward-send-backward-recv":{"total": 211.49, "avg": 7.05, "max": 1.28, "min": 139.41, "cnt": 30}, "backward-compute":{"total": 1722.94, "avg": 53.84, "max": 51.26, "min": 56.67, "cnt": 32}, "MoE_L3_bwd":{"total": 405.18, "avg": 12.66, "max": 11.97, "min": 13.56, "cnt": 32}, "MoE_L2_bwd":{"total": 375.09, "avg": 11.72, "max": 10.83, "min": 13.00, "cnt": 32}, "MoE_L1_bwd":{"total": 350.85, "avg": 10.96, "max": 10.47, "min": 12.43, "cnt": 32}, "MoE_L0_bwd":{"total": 379.68, "avg": 11.86, "max": 11.44, "min": 13.15, "cnt": 32}, "backward-send-forward-recv":{"total": 7379.72, "avg": 254.47, "max": 11.01, "min": 1065.69, "cnt": 29}, "backward-send":{"total": 2.54, "avg": 0.85, "max": 0.51, "min": 1.02, "cnt": 3}, "backward-recv":{"total": 164.14, "avg": 82.07, "max": 82.06, "min": 82.07, "cnt": 2}, "backward-params-all-reduce":{"total": 484.31, "avg": 484.31, "max": 484.31, "min": 484.31, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 261.91, "avg": 261.91, "max": 261.91, "min": 261.91, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 209.76, "avg": 209.76, "max": 209.76, "min": 209.76, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.87, "avg": 6.87, "max": 6.87, "min": 6.87, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 37, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.10, "avg": 0.10, "max": 0.10, "min": 0.10, "cnt": 1}, "forward-recv":{"total": 77.09, "avg": 25.70, "max": 4.36, "min": 66.90, "cnt": 3}, "forward-compute":{"total": 1798.89, "avg": 56.22, "max": 50.25, "min": 65.50, "cnt": 32}, "fwd-compute":{"total": 1795.59, "avg": 56.11, "max": 50.17, "min": 65.42, "cnt": 32}, "batch-generator":{"total": 47.29, "avg": 1.48, "max": 0.68, "min": 3.57, "cnt": 32}, "fwd-embedding":{"total": 0.57, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1735.57, "avg": 54.24, "max": 49.01, "min": 63.81, "cnt": 32}, "fwd-layernorm":{"total": 9.47, "avg": 0.07, "max": 0.05, "min": 0.18, "cnt": 128}, "fwd-attn":{"total": 107.17, "avg": 0.84, "max": 0.74, "min": 1.48, "cnt": 128}, "fwd-misc":{"total": 20.35, "avg": 0.16, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1577.62, "avg": 12.33, "max": 10.51, "min": 21.38, "cnt": 128}, "MoE_L0_fwd":{"total": 486.96, "avg": 15.22, "max": 11.60, "min": 21.24, "cnt": 32}, "MoEMLP":{"total": 1560.84, "avg": 12.19, "max": 10.40, "min": 21.16, "cnt": 128}, "MoE_L1_fwd":{"total": 374.81, "avg": 11.71, "max": 10.77, "min": 13.61, "cnt": 32}, "MoE_L2_fwd":{"total": 357.14, "avg": 11.16, "max": 10.67, "min": 12.12, "cnt": 32}, "MoE_L3_fwd":{"total": 348.00, "avg": 10.87, "max": 10.44, "min": 11.61, "cnt": 32}, "fwd-pooler":{"total": 0.36, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.79, "avg": 0.90, "max": 0.79, "min": 1.01, "cnt": 2}, "forward-send-backward-recv":{"total": 732.07, "avg": 24.40, "max": 1.55, "min": 192.78, "cnt": 30}, "backward-compute":{"total": 1723.13, "avg": 53.85, "max": 50.32, "min": 55.96, "cnt": 32}, "MoE_L3_bwd":{"total": 410.72, "avg": 12.84, "max": 11.75, "min": 14.65, "cnt": 32}, "MoE_L2_bwd":{"total": 368.47, "avg": 11.51, "max": 10.75, "min": 11.90, "cnt": 32}, "MoE_L1_bwd":{"total": 351.35, "avg": 10.98, "max": 10.42, "min": 11.46, "cnt": 32}, "MoE_L0_bwd":{"total": 376.48, "avg": 11.77, "max": 10.86, "min": 12.63, "cnt": 32}, "backward-send-forward-recv":{"total": 6667.37, "avg": 229.91, "max": 2.10, "min": 876.23, "cnt": 29}, "backward-send":{"total": 2.51, "avg": 0.84, "max": 0.64, "min": 1.16, "cnt": 3}, "backward-recv":{"total": 156.02, "avg": 78.01, "max": 74.05, "min": 81.97, "cnt": 2}, "backward-params-all-reduce":{"total": 487.81, "avg": 487.81, "max": 487.81, "min": 487.81, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.04, "avg": 0.04, "max": 0.04, "min": 0.04, "cnt": 1}, "optimizer":{"total": 259.13, "avg": 259.13, "max": 259.13, "min": 259.13, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 208.15, "avg": 208.15, "max": 208.15, "min": 208.15, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.78, "avg": 6.78, "max": 6.78, "min": 6.78, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.49, "avg": 3.49, "max": 3.49, "min": 3.49, "cnt": 1}}}
{"type":"time", "iteration": 38, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 87.69, "avg": 29.23, "max": 6.32, "min": 71.07, "cnt": 3}, "forward-compute":{"total": 1777.07, "avg": 55.53, "max": 50.33, "min": 63.97, "cnt": 32}, "fwd-compute":{"total": 1773.64, "avg": 55.43, "max": 50.23, "min": 63.86, "cnt": 32}, "batch-generator":{"total": 43.04, "avg": 1.35, "max": 0.76, "min": 4.49, "cnt": 32}, "fwd-embedding":{"total": 0.60, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1717.75, "avg": 53.68, "max": 48.86, "min": 61.96, "cnt": 32}, "fwd-layernorm":{"total": 9.57, "avg": 0.07, "max": 0.05, "min": 0.27, "cnt": 128}, "fwd-attn":{"total": 108.23, "avg": 0.85, "max": 0.74, "min": 2.68, "cnt": 128}, "fwd-misc":{"total": 20.85, "avg": 0.16, "max": 0.11, "min": 0.44, "cnt": 128}, "fwd-MLP":{"total": 1558.07, "avg": 12.17, "max": 10.47, "min": 19.17, "cnt": 128}, "MoE_L0_fwd":{"total": 458.43, "avg": 14.33, "max": 11.22, "min": 19.09, "cnt": 32}, "MoEMLP":{"total": 1541.09, "avg": 12.04, "max": 10.35, "min": 19.04, "cnt": 128}, "MoE_L1_fwd":{"total": 371.48, "avg": 11.61, "max": 10.61, "min": 15.09, "cnt": 32}, "MoE_L2_fwd":{"total": 365.87, "avg": 11.43, "max": 10.39, "min": 12.70, "cnt": 32}, "MoE_L3_fwd":{"total": 351.45, "avg": 10.98, "max": 10.42, "min": 12.62, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 2.01, "avg": 1.00, "max": 0.99, "min": 1.02, "cnt": 2}, "forward-send-backward-recv":{"total": 208.59, "avg": 6.95, "max": 0.89, "min": 117.86, "cnt": 30}, "backward-compute":{"total": 1730.98, "avg": 54.09, "max": 51.71, "min": 56.27, "cnt": 32}, "MoE_L3_bwd":{"total": 396.74, "avg": 12.40, "max": 11.60, "min": 14.17, "cnt": 32}, "MoE_L2_bwd":{"total": 390.85, "avg": 12.21, "max": 10.93, "min": 13.58, "cnt": 32}, "MoE_L1_bwd":{"total": 356.24, "avg": 11.13, "max": 10.55, "min": 11.75, "cnt": 32}, "MoE_L0_bwd":{"total": 375.08, "avg": 11.72, "max": 10.88, "min": 12.95, "cnt": 32}, "backward-send-forward-recv":{"total": 6706.93, "avg": 231.27, "max": 2.36, "min": 839.82, "cnt": 29}, "backward-send":{"total": 2.00, "avg": 0.67, "max": 0.49, "min": 0.92, "cnt": 3}, "backward-recv":{"total": 147.32, "avg": 73.66, "max": 65.23, "min": 82.08, "cnt": 2}, "backward-params-all-reduce":{"total": 484.65, "avg": 484.65, "max": 484.65, "min": 484.65, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 258.94, "avg": 258.94, "max": 258.94, "min": 258.94, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 214.66, "avg": 214.66, "max": 214.66, "min": 214.66, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.77, "avg": 6.77, "max": 6.77, "min": 6.77, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 39, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 80.83, "avg": 26.94, "max": 4.47, "min": 71.12, "cnt": 3}, "forward-compute":{"total": 1842.59, "avg": 57.58, "max": 51.35, "min": 64.97, "cnt": 32}, "fwd-compute":{"total": 1839.49, "avg": 57.48, "max": 51.27, "min": 64.88, "cnt": 32}, "batch-generator":{"total": 48.22, "avg": 1.51, "max": 0.62, "min": 4.33, "cnt": 32}, "fwd-embedding":{"total": 0.59, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1778.79, "avg": 55.59, "max": 50.14, "min": 62.99, "cnt": 32}, "fwd-layernorm":{"total": 9.66, "avg": 0.08, "max": 0.05, "min": 0.27, "cnt": 128}, "fwd-attn":{"total": 110.17, "avg": 0.86, "max": 0.73, "min": 2.59, "cnt": 128}, "fwd-misc":{"total": 21.16, "avg": 0.17, "max": 0.11, "min": 0.52, "cnt": 128}, "fwd-MLP":{"total": 1616.68, "avg": 12.63, "max": 10.51, "min": 22.05, "cnt": 128}, "MoE_L0_fwd":{"total": 505.04, "avg": 15.78, "max": 12.43, "min": 21.97, "cnt": 32}, "MoEMLP":{"total": 1599.44, "avg": 12.50, "max": 10.41, "min": 21.92, "cnt": 128}, "MoE_L1_fwd":{"total": 379.13, "avg": 11.85, "max": 10.53, "min": 16.39, "cnt": 32}, "MoE_L2_fwd":{"total": 371.39, "avg": 11.61, "max": 10.69, "min": 12.66, "cnt": 32}, "MoE_L3_fwd":{"total": 350.15, "avg": 10.94, "max": 10.45, "min": 13.56, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.68, "avg": 0.84, "max": 0.78, "min": 0.90, "cnt": 2}, "forward-send-backward-recv":{"total": 214.30, "avg": 7.14, "max": 1.24, "min": 125.95, "cnt": 30}, "backward-compute":{"total": 1745.74, "avg": 54.55, "max": 52.13, "min": 57.37, "cnt": 32}, "MoE_L3_bwd":{"total": 404.69, "avg": 12.65, "max": 11.72, "min": 13.81, "cnt": 32}, "MoE_L2_bwd":{"total": 393.08, "avg": 12.28, "max": 11.36, "min": 13.40, "cnt": 32}, "MoE_L1_bwd":{"total": 357.87, "avg": 11.18, "max": 10.56, "min": 12.18, "cnt": 32}, "MoE_L0_bwd":{"total": 377.57, "avg": 11.80, "max": 11.34, "min": 13.56, "cnt": 32}, "backward-send-forward-recv":{"total": 6146.76, "avg": 211.96, "max": 2.17, "min": 1047.16, "cnt": 29}, "backward-send":{"total": 2.20, "avg": 0.73, "max": 0.62, "min": 0.90, "cnt": 3}, "backward-recv":{"total": 145.29, "avg": 72.64, "max": 71.37, "min": 73.92, "cnt": 2}, "backward-params-all-reduce":{"total": 566.08, "avg": 566.08, "max": 566.08, "min": 566.08, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 259.46, "avg": 259.46, "max": 259.46, "min": 259.46, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 215.14, "avg": 215.14, "max": 215.14, "min": 215.14, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.84, "avg": 6.84, "max": 6.84, "min": 6.84, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 40, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 95.64, "avg": 31.88, "max": 9.01, "min": 77.25, "cnt": 3}, "forward-compute":{"total": 1789.41, "avg": 55.92, "max": 49.93, "min": 66.83, "cnt": 32}, "fwd-compute":{"total": 1786.32, "avg": 55.82, "max": 49.87, "min": 66.73, "cnt": 32}, "batch-generator":{"total": 41.56, "avg": 1.30, "max": 0.67, "min": 2.74, "cnt": 32}, "fwd-embedding":{"total": 0.48, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1732.97, "avg": 54.16, "max": 48.90, "min": 65.11, "cnt": 32}, "fwd-layernorm":{"total": 8.64, "avg": 0.07, "max": 0.05, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 102.95, "avg": 0.80, "max": 0.74, "min": 1.48, "cnt": 128}, "fwd-misc":{"total": 19.27, "avg": 0.15, "max": 0.11, "min": 0.33, "cnt": 128}, "fwd-MLP":{"total": 1582.56, "avg": 12.36, "max": 10.46, "min": 23.08, "cnt": 128}, "MoE_L0_fwd":{"total": 475.72, "avg": 14.87, "max": 11.36, "min": 22.99, "cnt": 32}, "MoEMLP":{"total": 1566.68, "avg": 12.24, "max": 10.35, "min": 22.94, "cnt": 128}, "MoE_L1_fwd":{"total": 377.02, "avg": 11.78, "max": 10.62, "min": 13.19, "cnt": 32}, "MoE_L2_fwd":{"total": 369.18, "avg": 11.54, "max": 10.53, "min": 12.69, "cnt": 32}, "MoE_L3_fwd":{"total": 350.58, "avg": 10.96, "max": 10.39, "min": 12.97, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.61, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.69, "avg": 0.84, "max": 0.82, "min": 0.86, "cnt": 2}, "forward-send-backward-recv":{"total": 347.74, "avg": 11.59, "max": 1.79, "min": 266.85, "cnt": 30}, "backward-compute":{"total": 1763.82, "avg": 55.12, "max": 51.66, "min": 57.88, "cnt": 32}, "MoE_L3_bwd":{"total": 407.74, "avg": 12.74, "max": 11.89, "min": 13.76, "cnt": 32}, "MoE_L2_bwd":{"total": 399.48, "avg": 12.48, "max": 11.44, "min": 14.42, "cnt": 32}, "MoE_L1_bwd":{"total": 367.89, "avg": 11.50, "max": 10.42, "min": 12.37, "cnt": 32}, "MoE_L0_bwd":{"total": 373.25, "avg": 11.66, "max": 10.77, "min": 13.84, "cnt": 32}, "backward-send-forward-recv":{"total": 5207.13, "avg": 179.56, "max": 2.17, "min": 773.13, "cnt": 29}, "backward-send":{"total": 3.19, "avg": 1.06, "max": 1.01, "min": 1.10, "cnt": 3}, "backward-recv":{"total": 161.26, "avg": 80.63, "max": 80.38, "min": 80.88, "cnt": 2}, "backward-params-all-reduce":{"total": 488.92, "avg": 488.92, "max": 488.92, "min": 488.92, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 254.34, "avg": 254.34, "max": 254.34, "min": 254.34, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.36, "avg": 3.36, "max": 3.36, "min": 3.36, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 210.14, "avg": 210.14, "max": 210.14, "min": 210.14, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.84, "avg": 6.84, "max": 6.84, "min": 6.84, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}}}
{"type":"time", "iteration": 41, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 86.58, "avg": 28.86, "max": 1.44, "min": 81.68, "cnt": 3}, "forward-compute":{"total": 1829.60, "avg": 57.17, "max": 51.34, "min": 65.66, "cnt": 32}, "fwd-compute":{"total": 1826.63, "avg": 57.08, "max": 51.27, "min": 65.56, "cnt": 32}, "batch-generator":{"total": 45.35, "avg": 1.42, "max": 0.64, "min": 4.41, "cnt": 32}, "fwd-embedding":{"total": 0.54, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1769.13, "avg": 55.29, "max": 50.23, "min": 63.58, "cnt": 32}, "fwd-layernorm":{"total": 9.48, "avg": 0.07, "max": 0.05, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 107.50, "avg": 0.84, "max": 0.74, "min": 2.26, "cnt": 128}, "fwd-misc":{"total": 21.02, "avg": 0.16, "max": 0.11, "min": 0.38, "cnt": 128}, "fwd-MLP":{"total": 1610.12, "avg": 12.58, "max": 10.58, "min": 21.59, "cnt": 128}, "MoE_L0_fwd":{"total": 485.68, "avg": 15.18, "max": 11.76, "min": 21.36, "cnt": 32}, "MoEMLP":{"total": 1592.95, "avg": 12.44, "max": 10.46, "min": 21.27, "cnt": 128}, "MoE_L1_fwd":{"total": 394.03, "avg": 12.31, "max": 11.30, "min": 14.12, "cnt": 32}, "MoE_L2_fwd":{"total": 366.48, "avg": 11.45, "max": 11.06, "min": 12.05, "cnt": 32}, "MoE_L3_fwd":{"total": 352.98, "avg": 11.03, "max": 10.50, "min": 15.20, "cnt": 32}, "fwd-pooler":{"total": 0.37, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.62, "avg": 0.02, "max": 0.02, "min": 0.05, "cnt": 32}, "forward-send":{"total": 7.54, "avg": 3.77, "max": 0.90, "min": 6.64, "cnt": 2}, "forward-send-backward-recv":{"total": 198.47, "avg": 6.62, "max": 1.39, "min": 124.68, "cnt": 30}, "backward-compute":{"total": 1784.77, "avg": 55.77, "max": 53.64, "min": 62.81, "cnt": 32}, "MoE_L3_bwd":{"total": 407.19, "avg": 12.72, "max": 11.95, "min": 14.42, "cnt": 32}, "MoE_L2_bwd":{"total": 397.97, "avg": 12.44, "max": 11.59, "min": 17.50, "cnt": 32}, "MoE_L1_bwd":{"total": 385.76, "avg": 12.06, "max": 11.27, "min": 13.58, "cnt": 32}, "MoE_L0_bwd":{"total": 380.58, "avg": 11.89, "max": 11.41, "min": 12.80, "cnt": 32}, "backward-send-forward-recv":{"total": 6749.63, "avg": 232.75, "max": 2.21, "min": 839.64, "cnt": 29}, "backward-send":{"total": 2.85, "avg": 0.95, "max": 0.77, "min": 1.23, "cnt": 3}, "backward-recv":{"total": 138.18, "avg": 69.09, "max": 61.91, "min": 76.27, "cnt": 2}, "backward-params-all-reduce":{"total": 485.48, "avg": 485.48, "max": 485.48, "min": 485.48, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 257.07, "avg": 257.07, "max": 257.07, "min": 257.07, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 212.91, "avg": 212.91, "max": 212.91, "min": 212.91, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.78, "avg": 6.78, "max": 6.78, "min": 6.78, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 42, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 75.09, "avg": 25.03, "max": 0.89, "min": 70.13, "cnt": 3}, "forward-compute":{"total": 1917.68, "avg": 59.93, "max": 53.07, "min": 101.63, "cnt": 32}, "fwd-compute":{"total": 1914.43, "avg": 59.83, "max": 52.98, "min": 101.55, "cnt": 32}, "batch-generator":{"total": 61.40, "avg": 1.92, "max": 0.67, "min": 4.17, "cnt": 32}, "fwd-embedding":{"total": 0.64, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1840.54, "avg": 57.52, "max": 51.80, "min": 97.83, "cnt": 32}, "fwd-layernorm":{"total": 9.61, "avg": 0.08, "max": 0.05, "min": 0.18, "cnt": 128}, "fwd-attn":{"total": 105.05, "avg": 0.82, "max": 0.74, "min": 1.49, "cnt": 128}, "fwd-misc":{"total": 20.80, "avg": 0.16, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1684.65, "avg": 13.16, "max": 10.57, "min": 58.42, "cnt": 128}, "MoE_L0_fwd":{"total": 531.98, "avg": 16.62, "max": 11.99, "min": 58.34, "cnt": 32}, "MoEMLP":{"total": 1668.01, "avg": 13.03, "max": 10.47, "min": 58.29, "cnt": 128}, "MoE_L1_fwd":{"total": 407.55, "avg": 12.74, "max": 11.72, "min": 16.87, "cnt": 32}, "MoE_L2_fwd":{"total": 372.72, "avg": 11.65, "max": 11.05, "min": 14.82, "cnt": 32}, "MoE_L3_fwd":{"total": 361.90, "avg": 11.31, "max": 10.50, "min": 13.39, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.61, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.14, "avg": 0.57, "max": 0.55, "min": 0.59, "cnt": 2}, "forward-send-backward-recv":{"total": 634.66, "avg": 21.16, "max": 1.52, "min": 207.27, "cnt": 30}, "backward-compute":{"total": 1791.98, "avg": 56.00, "max": 54.21, "min": 57.84, "cnt": 32}, "MoE_L3_bwd":{"total": 413.43, "avg": 12.92, "max": 11.88, "min": 14.84, "cnt": 32}, "MoE_L2_bwd":{"total": 388.15, "avg": 12.13, "max": 11.38, "min": 13.50, "cnt": 32}, "MoE_L1_bwd":{"total": 390.32, "avg": 12.20, "max": 11.69, "min": 13.86, "cnt": 32}, "MoE_L0_bwd":{"total": 386.50, "avg": 12.08, "max": 11.77, "min": 13.18, "cnt": 32}, "backward-send-forward-recv":{"total": 5817.57, "avg": 200.61, "max": 1.97, "min": 1185.38, "cnt": 29}, "backward-send":{"total": 1.84, "avg": 0.61, "max": 0.46, "min": 0.73, "cnt": 3}, "backward-recv":{"total": 657.33, "avg": 328.67, "max": 72.70, "min": 584.63, "cnt": 2}, "backward-params-all-reduce":{"total": 485.36, "avg": 485.36, "max": 485.36, "min": 485.36, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 255.21, "avg": 255.21, "max": 255.21, "min": 255.21, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 211.15, "avg": 211.15, "max": 211.15, "min": 211.15, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.78, "avg": 6.78, "max": 6.78, "min": 6.78, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 43, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 85.01, "avg": 28.34, "max": 3.33, "min": 76.84, "cnt": 3}, "forward-compute":{"total": 1892.39, "avg": 59.14, "max": 49.99, "min": 107.69, "cnt": 32}, "fwd-compute":{"total": 1889.30, "avg": 59.04, "max": 49.92, "min": 107.62, "cnt": 32}, "batch-generator":{"total": 43.31, "avg": 1.35, "max": 0.67, "min": 4.42, "cnt": 32}, "fwd-embedding":{"total": 0.50, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1833.06, "avg": 57.28, "max": 48.94, "min": 106.14, "cnt": 32}, "fwd-layernorm":{"total": 9.18, "avg": 0.07, "max": 0.05, "min": 0.18, "cnt": 128}, "fwd-attn":{"total": 105.98, "avg": 0.83, "max": 0.74, "min": 1.73, "cnt": 128}, "fwd-misc":{"total": 20.22, "avg": 0.16, "max": 0.11, "min": 0.33, "cnt": 128}, "fwd-MLP":{"total": 1676.70, "avg": 13.10, "max": 10.74, "min": 66.85, "cnt": 128}, "MoE_L0_fwd":{"total": 535.35, "avg": 16.73, "max": 11.86, "min": 66.76, "cnt": 32}, "MoEMLP":{"total": 1659.65, "avg": 12.97, "max": 10.62, "min": 66.72, "cnt": 128}, "MoE_L1_fwd":{"total": 390.87, "avg": 12.21, "max": 10.75, "min": 14.33, "cnt": 32}, "MoE_L2_fwd":{"total": 367.61, "avg": 11.49, "max": 11.01, "min": 12.80, "cnt": 32}, "MoE_L3_fwd":{"total": 372.02, "avg": 11.63, "max": 10.66, "min": 13.70, "cnt": 32}, "fwd-pooler":{"total": 0.37, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.66, "avg": 0.02, "max": 0.02, "min": 0.08, "cnt": 32}, "forward-send":{"total": 2.70, "avg": 1.35, "max": 0.96, "min": 1.75, "cnt": 2}, "forward-send-backward-recv":{"total": 194.03, "avg": 6.47, "max": 1.22, "min": 122.86, "cnt": 30}, "backward-compute":{"total": 1792.77, "avg": 56.02, "max": 53.50, "min": 57.64, "cnt": 32}, "MoE_L3_bwd":{"total": 426.31, "avg": 13.32, "max": 11.92, "min": 15.15, "cnt": 32}, "MoE_L2_bwd":{"total": 381.25, "avg": 11.91, "max": 11.13, "min": 12.56, "cnt": 32}, "MoE_L1_bwd":{"total": 372.40, "avg": 11.64, "max": 10.87, "min": 12.25, "cnt": 32}, "MoE_L0_bwd":{"total": 392.23, "avg": 12.26, "max": 11.30, "min": 13.48, "cnt": 32}, "backward-send-forward-recv":{"total": 4769.87, "avg": 164.48, "max": 2.41, "min": 417.06, "cnt": 29}, "backward-send":{"total": 3.11, "avg": 1.04, "max": 0.95, "min": 1.16, "cnt": 3}, "backward-recv":{"total": 132.08, "avg": 66.04, "max": 60.29, "min": 71.80, "cnt": 2}, "backward-params-all-reduce":{"total": 492.94, "avg": 492.94, "max": 492.94, "min": 492.94, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 337.63, "avg": 337.63, "max": 337.63, "min": 337.63, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 286.20, "avg": 286.20, "max": 286.20, "min": 286.20, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.84, "avg": 6.84, "max": 6.84, "min": 6.84, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 44, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 70.89, "avg": 23.63, "max": 0.90, "min": 66.73, "cnt": 3}, "forward-compute":{"total": 1843.96, "avg": 57.62, "max": 51.52, "min": 70.22, "cnt": 32}, "fwd-compute":{"total": 1840.82, "avg": 57.53, "max": 51.46, "min": 70.14, "cnt": 32}, "batch-generator":{"total": 42.69, "avg": 1.33, "max": 0.64, "min": 3.02, "cnt": 32}, "fwd-embedding":{"total": 0.55, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1786.11, "avg": 55.82, "max": 50.54, "min": 68.62, "cnt": 32}, "fwd-layernorm":{"total": 9.43, "avg": 0.07, "max": 0.05, "min": 0.22, "cnt": 128}, "fwd-attn":{"total": 108.20, "avg": 0.85, "max": 0.74, "min": 1.94, "cnt": 128}, "fwd-misc":{"total": 20.49, "avg": 0.16, "max": 0.11, "min": 0.38, "cnt": 128}, "fwd-MLP":{"total": 1627.33, "avg": 12.71, "max": 10.60, "min": 22.69, "cnt": 128}, "MoE_L0_fwd":{"total": 498.37, "avg": 15.57, "max": 12.12, "min": 22.59, "cnt": 32}, "MoEMLP":{"total": 1610.77, "avg": 12.58, "max": 10.49, "min": 22.55, "cnt": 128}, "MoE_L1_fwd":{"total": 367.96, "avg": 11.50, "max": 10.53, "min": 13.72, "cnt": 32}, "MoE_L2_fwd":{"total": 364.23, "avg": 11.38, "max": 10.54, "min": 13.05, "cnt": 32}, "MoE_L3_fwd":{"total": 386.29, "avg": 12.07, "max": 10.97, "min": 16.29, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.04, "cnt": 32}, "forward-send":{"total": 7.87, "avg": 3.93, "max": 0.74, "min": 7.12, "cnt": 2}, "forward-send-backward-recv":{"total": 211.87, "avg": 7.06, "max": 1.23, "min": 130.99, "cnt": 30}, "backward-compute":{"total": 1783.63, "avg": 55.74, "max": 52.72, "min": 58.48, "cnt": 32}, "MoE_L3_bwd":{"total": 436.40, "avg": 13.64, "max": 12.68, "min": 15.15, "cnt": 32}, "MoE_L2_bwd":{"total": 381.24, "avg": 11.91, "max": 10.58, "min": 13.04, "cnt": 32}, "MoE_L1_bwd":{"total": 365.09, "avg": 11.41, "max": 10.89, "min": 12.46, "cnt": 32}, "MoE_L0_bwd":{"total": 388.79, "avg": 12.15, "max": 11.69, "min": 13.91, "cnt": 32}, "backward-send-forward-recv":{"total": 6915.53, "avg": 238.47, "max": 2.24, "min": 1553.85, "cnt": 29}, "backward-send":{"total": 2.26, "avg": 0.75, "max": 0.67, "min": 0.89, "cnt": 3}, "backward-recv":{"total": 187.49, "avg": 93.74, "max": 66.73, "min": 120.76, "cnt": 2}, "backward-params-all-reduce":{"total": 488.09, "avg": 488.09, "max": 488.09, "min": 488.09, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 252.78, "avg": 252.78, "max": 252.78, "min": 252.78, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 208.45, "avg": 208.45, "max": 208.45, "min": 208.45, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.81, "avg": 6.81, "max": 6.81, "min": 6.81, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 45, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 84.14, "avg": 28.05, "max": 6.15, "min": 70.10, "cnt": 3}, "forward-compute":{"total": 1862.14, "avg": 58.19, "max": 51.40, "min": 64.83, "cnt": 32}, "fwd-compute":{"total": 1859.32, "avg": 58.10, "max": 51.33, "min": 64.74, "cnt": 32}, "batch-generator":{"total": 37.54, "avg": 1.17, "max": 0.64, "min": 2.96, "cnt": 32}, "fwd-embedding":{"total": 0.48, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1809.56, "avg": 56.55, "max": 50.39, "min": 63.47, "cnt": 32}, "fwd-layernorm":{"total": 8.94, "avg": 0.07, "max": 0.05, "min": 0.18, "cnt": 128}, "fwd-attn":{"total": 104.10, "avg": 0.81, "max": 0.74, "min": 1.50, "cnt": 128}, "fwd-misc":{"total": 20.00, "avg": 0.16, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1656.30, "avg": 12.94, "max": 10.55, "min": 22.35, "cnt": 128}, "MoE_L0_fwd":{"total": 486.66, "avg": 15.21, "max": 11.55, "min": 22.25, "cnt": 32}, "MoEMLP":{"total": 1639.65, "avg": 12.81, "max": 10.42, "min": 22.21, "cnt": 128}, "MoE_L1_fwd":{"total": 381.23, "avg": 11.91, "max": 10.60, "min": 13.71, "cnt": 32}, "MoE_L2_fwd":{"total": 365.50, "avg": 11.42, "max": 10.47, "min": 12.42, "cnt": 32}, "MoE_L3_fwd":{"total": 412.22, "avg": 12.88, "max": 11.67, "min": 15.23, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.61, "avg": 0.02, "max": 0.02, "min": 0.04, "cnt": 32}, "forward-send":{"total": 1.64, "avg": 0.82, "max": 0.81, "min": 0.82, "cnt": 2}, "forward-send-backward-recv":{"total": 192.94, "avg": 6.43, "max": 1.03, "min": 114.78, "cnt": 30}, "backward-compute":{"total": 1811.38, "avg": 56.61, "max": 52.90, "min": 60.74, "cnt": 32}, "MoE_L3_bwd":{"total": 470.01, "avg": 14.69, "max": 13.35, "min": 18.74, "cnt": 32}, "MoE_L2_bwd":{"total": 376.75, "avg": 11.77, "max": 10.39, "min": 12.68, "cnt": 32}, "MoE_L1_bwd":{"total": 364.57, "avg": 11.39, "max": 10.87, "min": 12.04, "cnt": 32}, "MoE_L0_bwd":{"total": 388.34, "avg": 12.14, "max": 11.23, "min": 14.19, "cnt": 32}, "backward-send-forward-recv":{"total": 4281.12, "avg": 147.62, "max": 2.19, "min": 308.65, "cnt": 29}, "backward-send":{"total": 2.92, "avg": 0.97, "max": 0.85, "min": 1.09, "cnt": 3}, "backward-recv":{"total": 122.45, "avg": 61.22, "max": 50.45, "min": 72.00, "cnt": 2}, "backward-params-all-reduce":{"total": 490.62, "avg": 490.62, "max": 490.62, "min": 490.62, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.04, "avg": 0.04, "max": 0.04, "min": 0.04, "cnt": 1}, "optimizer":{"total": 253.27, "avg": 253.27, "max": 253.27, "min": 253.27, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 209.00, "avg": 209.00, "max": 209.00, "min": 209.00, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.89, "avg": 6.89, "max": 6.89, "min": 6.89, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 46, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 86.30, "avg": 28.77, "max": 2.21, "min": 74.13, "cnt": 3}, "forward-compute":{"total": 1819.74, "avg": 56.87, "max": 50.06, "min": 64.99, "cnt": 32}, "fwd-compute":{"total": 1816.73, "avg": 56.77, "max": 49.99, "min": 64.91, "cnt": 32}, "batch-generator":{"total": 44.90, "avg": 1.40, "max": 0.67, "min": 2.73, "cnt": 32}, "fwd-embedding":{"total": 0.65, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1759.31, "avg": 54.98, "max": 48.95, "min": 63.48, "cnt": 32}, "fwd-layernorm":{"total": 10.03, "avg": 0.08, "max": 0.05, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 111.49, "avg": 0.87, "max": 0.74, "min": 1.68, "cnt": 128}, "fwd-misc":{"total": 21.68, "avg": 0.17, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1594.36, "avg": 12.46, "max": 9.78, "min": 23.02, "cnt": 128}, "MoE_L0_fwd":{"total": 499.81, "avg": 15.62, "max": 11.91, "min": 22.94, "cnt": 32}, "MoEMLP":{"total": 1576.98, "avg": 12.32, "max": 9.68, "min": 22.90, "cnt": 128}, "MoE_L1_fwd":{"total": 369.84, "avg": 11.56, "max": 10.39, "min": 13.83, "cnt": 32}, "MoE_L2_fwd":{"total": 355.13, "avg": 11.10, "max": 9.72, "min": 12.43, "cnt": 32}, "MoE_L3_fwd":{"total": 358.54, "avg": 11.20, "max": 10.67, "min": 13.63, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.43, "avg": 0.72, "max": 0.67, "min": 0.77, "cnt": 2}, "forward-send-backward-recv":{"total": 203.33, "avg": 6.78, "max": 1.31, "min": 120.41, "cnt": 30}, "backward-compute":{"total": 1749.96, "avg": 54.69, "max": 51.17, "min": 55.87, "cnt": 32}, "MoE_L3_bwd":{"total": 423.72, "avg": 13.24, "max": 12.15, "min": 14.67, "cnt": 32}, "MoE_L2_bwd":{"total": 375.60, "avg": 11.74, "max": 10.77, "min": 12.50, "cnt": 32}, "MoE_L1_bwd":{"total": 349.78, "avg": 10.93, "max": 10.05, "min": 11.73, "cnt": 32}, "MoE_L0_bwd":{"total": 387.34, "avg": 12.10, "max": 11.57, "min": 12.96, "cnt": 32}, "backward-send-forward-recv":{"total": 7142.31, "avg": 246.29, "max": 1.85, "min": 2257.69, "cnt": 29}, "backward-send":{"total": 3.26, "avg": 1.09, "max": 1.03, "min": 1.12, "cnt": 3}, "backward-recv":{"total": 139.79, "avg": 69.90, "max": 57.48, "min": 82.31, "cnt": 2}, "backward-params-all-reduce":{"total": 488.93, "avg": 488.93, "max": 488.93, "min": 488.93, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 256.64, "avg": 256.64, "max": 256.64, "min": 256.64, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 212.29, "avg": 212.29, "max": 212.29, "min": 212.29, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.92, "avg": 6.92, "max": 6.92, "min": 6.92, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 47, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 110.71, "avg": 36.90, "max": 4.42, "min": 97.75, "cnt": 3}, "forward-compute":{"total": 1799.96, "avg": 56.25, "max": 49.53, "min": 70.01, "cnt": 32}, "fwd-compute":{"total": 1796.67, "avg": 56.15, "max": 49.45, "min": 69.92, "cnt": 32}, "batch-generator":{"total": 44.24, "avg": 1.38, "max": 0.74, "min": 2.40, "cnt": 32}, "fwd-embedding":{"total": 0.62, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1739.89, "avg": 54.37, "max": 48.40, "min": 67.42, "cnt": 32}, "fwd-layernorm":{"total": 10.02, "avg": 0.08, "max": 0.05, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 109.65, "avg": 0.86, "max": 0.74, "min": 1.91, "cnt": 128}, "fwd-misc":{"total": 21.30, "avg": 0.17, "max": 0.11, "min": 0.40, "cnt": 128}, "fwd-MLP":{"total": 1577.12, "avg": 12.32, "max": 9.96, "min": 25.58, "cnt": 128}, "MoE_L0_fwd":{"total": 497.32, "avg": 15.54, "max": 11.43, "min": 25.50, "cnt": 32}, "MoEMLP":{"total": 1559.56, "avg": 12.18, "max": 9.85, "min": 25.45, "cnt": 128}, "MoE_L1_fwd":{"total": 381.39, "avg": 11.92, "max": 10.87, "min": 13.42, "cnt": 32}, "MoE_L2_fwd":{"total": 343.02, "avg": 10.72, "max": 9.92, "min": 11.80, "cnt": 32}, "MoE_L3_fwd":{"total": 344.20, "avg": 10.76, "max": 9.89, "min": 15.86, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.60, "avg": 0.80, "max": 0.75, "min": 0.86, "cnt": 2}, "forward-send-backward-recv":{"total": 200.08, "avg": 6.67, "max": 0.99, "min": 118.97, "cnt": 30}, "backward-compute":{"total": 1709.93, "avg": 53.44, "max": 50.20, "min": 58.05, "cnt": 32}, "MoE_L3_bwd":{"total": 393.53, "avg": 12.30, "max": 10.73, "min": 15.90, "cnt": 32}, "MoE_L2_bwd":{"total": 357.65, "avg": 11.18, "max": 10.13, "min": 12.15, "cnt": 32}, "MoE_L1_bwd":{"total": 362.01, "avg": 11.31, "max": 10.72, "min": 12.01, "cnt": 32}, "MoE_L0_bwd":{"total": 380.53, "avg": 11.89, "max": 11.36, "min": 12.22, "cnt": 32}, "backward-send-forward-recv":{"total": 5886.63, "avg": 202.99, "max": 2.47, "min": 814.34, "cnt": 29}, "backward-send":{"total": 3.71, "avg": 1.24, "max": 0.46, "min": 2.29, "cnt": 3}, "backward-recv":{"total": 118.54, "avg": 59.27, "max": 50.37, "min": 68.17, "cnt": 2}, "backward-params-all-reduce":{"total": 490.89, "avg": 490.89, "max": 490.89, "min": 490.89, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.04, "avg": 0.04, "max": 0.04, "min": 0.04, "cnt": 1}, "optimizer":{"total": 245.67, "avg": 245.67, "max": 245.67, "min": 245.67, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 201.33, "avg": 201.33, "max": 201.33, "min": 201.33, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.81, "avg": 6.81, "max": 6.81, "min": 6.81, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.51, "avg": 3.51, "max": 3.51, "min": 3.51, "cnt": 1}}}
{"type":"time", "iteration": 48, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.10, "avg": 0.10, "max": 0.10, "min": 0.10, "cnt": 1}, "forward-recv":{"total": 78.61, "avg": 26.20, "max": 3.22, "min": 70.19, "cnt": 3}, "forward-compute":{"total": 1840.25, "avg": 57.51, "max": 50.49, "min": 65.65, "cnt": 32}, "fwd-compute":{"total": 1836.92, "avg": 57.40, "max": 50.43, "min": 65.52, "cnt": 32}, "batch-generator":{"total": 46.43, "avg": 1.45, "max": 0.65, "min": 3.12, "cnt": 32}, "fwd-embedding":{"total": 0.67, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1777.47, "avg": 55.55, "max": 49.49, "min": 63.25, "cnt": 32}, "fwd-layernorm":{"total": 9.75, "avg": 0.08, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 108.07, "avg": 0.84, "max": 0.74, "min": 1.62, "cnt": 128}, "fwd-misc":{"total": 21.12, "avg": 0.16, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1617.34, "avg": 12.64, "max": 10.26, "min": 20.34, "cnt": 128}, "MoE_L0_fwd":{"total": 483.83, "avg": 15.12, "max": 11.63, "min": 20.25, "cnt": 32}, "MoEMLP":{"total": 1600.27, "avg": 12.50, "max": 10.15, "min": 20.20, "cnt": 128}, "MoE_L1_fwd":{"total": 379.83, "avg": 11.87, "max": 10.88, "min": 13.99, "cnt": 32}, "MoE_L2_fwd":{"total": 350.28, "avg": 10.95, "max": 10.19, "min": 12.34, "cnt": 32}, "MoE_L3_fwd":{"total": 392.55, "avg": 12.27, "max": 11.51, "min": 15.02, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.60, "avg": 0.80, "max": 0.70, "min": 0.90, "cnt": 2}, "forward-send-backward-recv":{"total": 489.13, "avg": 16.30, "max": 1.05, "min": 141.03, "cnt": 30}, "backward-compute":{"total": 1788.21, "avg": 55.88, "max": 54.09, "min": 64.87, "cnt": 32}, "MoE_L3_bwd":{"total": 467.28, "avg": 14.60, "max": 13.32, "min": 22.68, "cnt": 32}, "MoE_L2_bwd":{"total": 363.63, "avg": 11.36, "max": 10.39, "min": 12.53, "cnt": 32}, "MoE_L1_bwd":{"total": 367.67, "avg": 11.49, "max": 10.54, "min": 12.71, "cnt": 32}, "MoE_L0_bwd":{"total": 375.56, "avg": 11.74, "max": 11.22, "min": 12.51, "cnt": 32}, "backward-send-forward-recv":{"total": 3607.43, "avg": 124.39, "max": 1.98, "min": 711.64, "cnt": 29}, "backward-send":{"total": 3.25, "avg": 1.08, "max": 0.97, "min": 1.16, "cnt": 3}, "backward-recv":{"total": 265.48, "avg": 132.74, "max": 69.84, "min": 195.64, "cnt": 2}, "backward-params-all-reduce":{"total": 487.93, "avg": 487.93, "max": 487.93, "min": 487.93, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.04, "avg": 0.04, "max": 0.04, "min": 0.04, "cnt": 1}, "optimizer":{"total": 250.59, "avg": 250.59, "max": 250.59, "min": 250.59, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 206.18, "avg": 206.18, "max": 206.18, "min": 206.18, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.86, "avg": 6.86, "max": 6.86, "min": 6.86, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 49, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.10, "avg": 0.10, "max": 0.10, "min": 0.10, "cnt": 1}, "forward-recv":{"total": 80.61, "avg": 26.87, "max": 1.96, "min": 73.39, "cnt": 3}, "forward-compute":{"total": 1881.80, "avg": 58.81, "max": 52.06, "min": 72.20, "cnt": 32}, "fwd-compute":{"total": 1878.38, "avg": 58.70, "max": 51.95, "min": 72.11, "cnt": 32}, "batch-generator":{"total": 44.79, "avg": 1.40, "max": 0.70, "min": 2.52, "cnt": 32}, "fwd-embedding":{"total": 0.65, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1820.12, "avg": 56.88, "max": 50.51, "min": 70.45, "cnt": 32}, "fwd-layernorm":{"total": 10.24, "avg": 0.08, "max": 0.05, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 110.64, "avg": 0.86, "max": 0.74, "min": 1.86, "cnt": 128}, "fwd-misc":{"total": 21.81, "avg": 0.17, "max": 0.11, "min": 0.34, "cnt": 128}, "fwd-MLP":{"total": 1655.61, "avg": 12.93, "max": 10.75, "min": 25.33, "cnt": 128}, "MoE_L0_fwd":{"total": 508.47, "avg": 15.89, "max": 11.26, "min": 25.24, "cnt": 32}, "MoEMLP":{"total": 1637.59, "avg": 12.79, "max": 10.65, "min": 25.19, "cnt": 128}, "MoE_L1_fwd":{"total": 381.88, "avg": 11.93, "max": 10.72, "min": 15.17, "cnt": 32}, "MoE_L2_fwd":{"total": 364.56, "avg": 11.39, "max": 10.69, "min": 13.91, "cnt": 32}, "MoE_L3_fwd":{"total": 389.15, "avg": 12.16, "max": 11.41, "min": 13.68, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 2.59, "avg": 1.30, "max": 0.85, "min": 1.74, "cnt": 2}, "forward-send-backward-recv":{"total": 673.49, "avg": 22.45, "max": 1.62, "min": 120.52, "cnt": 30}, "backward-compute":{"total": 1758.72, "avg": 54.96, "max": 53.65, "min": 56.09, "cnt": 32}, "MoE_L3_bwd":{"total": 439.95, "avg": 13.75, "max": 13.26, "min": 14.76, "cnt": 32}, "MoE_L2_bwd":{"total": 370.09, "avg": 11.57, "max": 11.09, "min": 12.81, "cnt": 32}, "MoE_L1_bwd":{"total": 357.05, "avg": 11.16, "max": 10.91, "min": 13.11, "cnt": 32}, "MoE_L0_bwd":{"total": 376.20, "avg": 11.76, "max": 10.94, "min": 12.34, "cnt": 32}, "backward-send-forward-recv":{"total": 5066.72, "avg": 174.71, "max": 1.59, "min": 722.70, "cnt": 29}, "backward-send":{"total": 2.26, "avg": 0.75, "max": 0.57, "min": 0.85, "cnt": 3}, "backward-recv":{"total": 571.37, "avg": 285.68, "max": 63.93, "min": 507.44, "cnt": 2}, "backward-params-all-reduce":{"total": 497.11, "avg": 497.11, "max": 497.11, "min": 497.11, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.05, "avg": 0.05, "max": 0.05, "min": 0.05, "cnt": 1}, "optimizer":{"total": 231.99, "avg": 231.99, "max": 231.99, "min": 231.99, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 192.11, "avg": 192.11, "max": 192.11, "min": 192.11, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.22, "avg": 3.22, "max": 3.22, "min": 3.22, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 50, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 81.74, "avg": 27.25, "max": 0.91, "min": 79.84, "cnt": 3}, "forward-compute":{"total": 1869.67, "avg": 58.43, "max": 51.90, "min": 64.96, "cnt": 32}, "fwd-compute":{"total": 1866.53, "avg": 58.33, "max": 51.82, "min": 64.88, "cnt": 32}, "batch-generator":{"total": 56.82, "avg": 1.78, "max": 0.72, "min": 4.26, "cnt": 32}, "fwd-embedding":{"total": 0.60, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1797.12, "avg": 56.16, "max": 50.68, "min": 63.42, "cnt": 32}, "fwd-layernorm":{"total": 9.80, "avg": 0.08, "max": 0.05, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 108.04, "avg": 0.84, "max": 0.74, "min": 1.67, "cnt": 128}, "fwd-misc":{"total": 21.00, "avg": 0.16, "max": 0.11, "min": 0.34, "cnt": 128}, "fwd-MLP":{"total": 1637.25, "avg": 12.79, "max": 10.69, "min": 22.87, "cnt": 128}, "MoE_L0_fwd":{"total": 490.82, "avg": 15.34, "max": 11.80, "min": 22.78, "cnt": 32}, "MoEMLP":{"total": 1620.17, "avg": 12.66, "max": 10.58, "min": 22.73, "cnt": 128}, "MoE_L1_fwd":{"total": 384.32, "avg": 12.01, "max": 10.62, "min": 16.99, "cnt": 32}, "MoE_L2_fwd":{"total": 365.52, "avg": 11.42, "max": 10.68, "min": 14.14, "cnt": 32}, "MoE_L3_fwd":{"total": 385.83, "avg": 12.06, "max": 11.67, "min": 12.95, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.55, "avg": 0.77, "max": 0.77, "min": 0.78, "cnt": 2}, "forward-send-backward-recv":{"total": 325.68, "avg": 10.86, "max": 1.38, "min": 119.98, "cnt": 30}, "backward-compute":{"total": 1781.24, "avg": 55.66, "max": 53.83, "min": 59.10, "cnt": 32}, "MoE_L3_bwd":{"total": 436.36, "avg": 13.64, "max": 12.64, "min": 15.56, "cnt": 32}, "MoE_L2_bwd":{"total": 381.46, "avg": 11.92, "max": 10.88, "min": 14.41, "cnt": 32}, "MoE_L1_bwd":{"total": 360.32, "avg": 11.26, "max": 10.58, "min": 11.56, "cnt": 32}, "MoE_L0_bwd":{"total": 389.30, "avg": 12.17, "max": 11.39, "min": 14.28, "cnt": 32}, "backward-send-forward-recv":{"total": 5894.21, "avg": 203.25, "max": 2.19, "min": 1859.28, "cnt": 29}, "backward-send":{"total": 3.21, "avg": 1.07, "max": 1.05, "min": 1.08, "cnt": 3}, "backward-recv":{"total": 134.93, "avg": 67.46, "max": 62.05, "min": 72.88, "cnt": 2}, "backward-params-all-reduce":{"total": 489.70, "avg": 489.70, "max": 489.70, "min": 489.70, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 245.92, "avg": 245.92, "max": 245.92, "min": 245.92, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 206.10, "avg": 206.10, "max": 206.10, "min": 206.10, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.34, "avg": 3.34, "max": 3.34, "min": 3.34, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 51, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 89.29, "avg": 29.76, "max": 0.65, "min": 87.71, "cnt": 3}, "forward-compute":{"total": 1916.47, "avg": 59.89, "max": 52.34, "min": 69.81, "cnt": 32}, "fwd-compute":{"total": 1913.52, "avg": 59.80, "max": 52.27, "min": 69.72, "cnt": 32}, "batch-generator":{"total": 41.80, "avg": 1.31, "max": 0.67, "min": 4.39, "cnt": 32}, "fwd-embedding":{"total": 0.59, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1859.01, "avg": 58.09, "max": 51.04, "min": 67.04, "cnt": 32}, "fwd-layernorm":{"total": 9.24, "avg": 0.07, "max": 0.05, "min": 0.18, "cnt": 128}, "fwd-attn":{"total": 107.03, "avg": 0.84, "max": 0.74, "min": 1.50, "cnt": 128}, "fwd-misc":{"total": 20.55, "avg": 0.16, "max": 0.11, "min": 0.34, "cnt": 128}, "fwd-MLP":{"total": 1701.54, "avg": 13.29, "max": 10.89, "min": 24.70, "cnt": 128}, "MoE_L0_fwd":{"total": 552.70, "avg": 17.27, "max": 12.21, "min": 24.53, "cnt": 32}, "MoEMLP":{"total": 1684.85, "avg": 13.16, "max": 10.79, "min": 24.42, "cnt": 128}, "MoE_L1_fwd":{"total": 380.01, "avg": 11.88, "max": 10.83, "min": 14.21, "cnt": 32}, "MoE_L2_fwd":{"total": 369.20, "avg": 11.54, "max": 10.83, "min": 14.70, "cnt": 32}, "MoE_L3_fwd":{"total": 389.06, "avg": 12.16, "max": 11.42, "min": 14.13, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.53, "avg": 0.76, "max": 0.75, "min": 0.78, "cnt": 2}, "forward-send-backward-recv":{"total": 258.79, "avg": 8.63, "max": 1.48, "min": 122.24, "cnt": 30}, "backward-compute":{"total": 1781.47, "avg": 55.67, "max": 52.09, "min": 58.98, "cnt": 32}, "MoE_L3_bwd":{"total": 434.99, "avg": 13.59, "max": 12.05, "min": 14.79, "cnt": 32}, "MoE_L2_bwd":{"total": 379.54, "avg": 11.86, "max": 10.55, "min": 13.98, "cnt": 32}, "MoE_L1_bwd":{"total": 364.41, "avg": 11.39, "max": 10.63, "min": 12.14, "cnt": 32}, "MoE_L0_bwd":{"total": 387.65, "avg": 12.11, "max": 11.32, "min": 12.97, "cnt": 32}, "backward-send-forward-recv":{"total": 4801.31, "avg": 165.56, "max": 1.93, "min": 645.98, "cnt": 29}, "backward-send":{"total": 3.33, "avg": 1.11, "max": 1.00, "min": 1.26, "cnt": 3}, "backward-recv":{"total": 127.69, "avg": 63.85, "max": 55.84, "min": 71.85, "cnt": 2}, "backward-params-all-reduce":{"total": 486.51, "avg": 486.51, "max": 486.51, "min": 486.51, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.04, "avg": 0.04, "max": 0.04, "min": 0.04, "cnt": 1}, "optimizer":{"total": 248.18, "avg": 248.18, "max": 248.18, "min": 248.18, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 208.21, "avg": 208.21, "max": 208.21, "min": 208.21, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.31, "avg": 3.31, "max": 3.31, "min": 3.31, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 52, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 79.10, "avg": 26.37, "max": 0.74, "min": 76.90, "cnt": 3}, "forward-compute":{"total": 1924.08, "avg": 60.13, "max": 52.56, "min": 132.31, "cnt": 32}, "fwd-compute":{"total": 1920.62, "avg": 60.02, "max": 52.48, "min": 132.15, "cnt": 32}, "batch-generator":{"total": 53.00, "avg": 1.66, "max": 0.61, "min": 3.08, "cnt": 32}, "fwd-embedding":{"total": 0.63, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1854.94, "avg": 57.97, "max": 49.96, "min": 128.61, "cnt": 32}, "fwd-layernorm":{"total": 9.76, "avg": 0.08, "max": 0.05, "min": 0.22, "cnt": 128}, "fwd-attn":{"total": 108.81, "avg": 0.85, "max": 0.74, "min": 1.61, "cnt": 128}, "fwd-misc":{"total": 21.02, "avg": 0.16, "max": 0.11, "min": 0.42, "cnt": 128}, "fwd-MLP":{"total": 1694.17, "avg": 13.24, "max": 10.15, "min": 82.70, "cnt": 128}, "MoE_L0_fwd":{"total": 484.67, "avg": 15.15, "max": 11.48, "min": 19.54, "cnt": 32}, "MoEMLP":{"total": 1676.94, "avg": 13.10, "max": 10.02, "min": 82.55, "cnt": 128}, "MoE_L1_fwd":{"total": 459.16, "avg": 14.35, "max": 11.15, "min": 82.61, "cnt": 32}, "MoE_L2_fwd":{"total": 351.53, "avg": 10.99, "max": 10.07, "min": 13.49, "cnt": 32}, "MoE_L3_fwd":{"total": 387.87, "avg": 12.12, "max": 11.46, "min": 13.21, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 6.73, "avg": 3.36, "max": 0.82, "min": 5.91, "cnt": 2}, "forward-send-backward-recv":{"total": 254.36, "avg": 8.48, "max": 1.37, "min": 124.05, "cnt": 30}, "backward-compute":{"total": 1714.57, "avg": 53.58, "max": 50.96, "min": 55.95, "cnt": 32}, "MoE_L3_bwd":{"total": 435.10, "avg": 13.60, "max": 12.44, "min": 15.49, "cnt": 32}, "MoE_L2_bwd":{"total": 331.58, "avg": 10.36, "max": 9.79, "min": 10.96, "cnt": 32}, "MoE_L1_bwd":{"total": 361.93, "avg": 11.31, "max": 10.71, "min": 11.64, "cnt": 32}, "MoE_L0_bwd":{"total": 372.46, "avg": 11.64, "max": 10.86, "min": 12.75, "cnt": 32}, "backward-send-forward-recv":{"total": 4996.67, "avg": 172.30, "max": 2.06, "min": 750.68, "cnt": 29}, "backward-send":{"total": 2.11, "avg": 0.70, "max": 0.58, "min": 0.85, "cnt": 3}, "backward-recv":{"total": 261.39, "avg": 130.69, "max": 77.59, "min": 183.80, "cnt": 2}, "backward-params-all-reduce":{"total": 489.30, "avg": 489.30, "max": 489.30, "min": 489.30, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.04, "avg": 0.04, "max": 0.04, "min": 0.04, "cnt": 1}, "optimizer":{"total": 245.46, "avg": 245.46, "max": 245.46, "min": 245.46, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 205.63, "avg": 205.63, "max": 205.63, "min": 205.63, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.30, "avg": 3.30, "max": 3.30, "min": 3.30, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 53, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 73.68, "avg": 24.56, "max": 1.28, "min": 69.55, "cnt": 3}, "forward-compute":{"total": 1872.06, "avg": 58.50, "max": 52.25, "min": 66.02, "cnt": 32}, "fwd-compute":{"total": 1868.75, "avg": 58.40, "max": 52.19, "min": 65.87, "cnt": 32}, "batch-generator":{"total": 55.90, "avg": 1.75, "max": 0.70, "min": 4.04, "cnt": 32}, "fwd-embedding":{"total": 0.74, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1799.03, "avg": 56.22, "max": 51.13, "min": 63.60, "cnt": 32}, "fwd-layernorm":{"total": 10.70, "avg": 0.08, "max": 0.05, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 114.17, "avg": 0.89, "max": 0.74, "min": 1.66, "cnt": 128}, "fwd-misc":{"total": 23.00, "avg": 0.18, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1628.57, "avg": 12.72, "max": 10.40, "min": 18.24, "cnt": 128}, "MoE_L0_fwd":{"total": 487.27, "avg": 15.23, "max": 12.39, "min": 18.18, "cnt": 32}, "MoEMLP":{"total": 1610.22, "avg": 12.58, "max": 10.28, "min": 18.14, "cnt": 128}, "MoE_L1_fwd":{"total": 385.81, "avg": 12.06, "max": 11.16, "min": 16.13, "cnt": 32}, "MoE_L2_fwd":{"total": 354.75, "avg": 11.09, "max": 10.32, "min": 12.72, "cnt": 32}, "MoE_L3_fwd":{"total": 389.12, "avg": 12.16, "max": 11.33, "min": 14.80, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.61, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 5.86, "avg": 2.93, "max": 0.90, "min": 4.96, "cnt": 2}, "forward-send-backward-recv":{"total": 291.82, "avg": 9.73, "max": 0.88, "min": 123.43, "cnt": 30}, "backward-compute":{"total": 1699.20, "avg": 53.10, "max": 49.65, "min": 57.93, "cnt": 32}, "MoE_L3_bwd":{"total": 439.57, "avg": 13.74, "max": 12.28, "min": 17.98, "cnt": 32}, "MoE_L2_bwd":{"total": 343.93, "avg": 10.75, "max": 9.69, "min": 12.37, "cnt": 32}, "MoE_L1_bwd":{"total": 327.42, "avg": 10.23, "max": 9.56, "min": 10.95, "cnt": 32}, "MoE_L0_bwd":{"total": 373.27, "avg": 11.66, "max": 10.55, "min": 12.71, "cnt": 32}, "backward-send-forward-recv":{"total": 5241.03, "avg": 180.73, "max": 2.34, "min": 1054.38, "cnt": 29}, "backward-send":{"total": 3.66, "avg": 1.22, "max": 1.16, "min": 1.34, "cnt": 3}, "backward-recv":{"total": 155.49, "avg": 77.74, "max": 76.91, "min": 78.58, "cnt": 2}, "backward-params-all-reduce":{"total": 486.95, "avg": 486.95, "max": 486.95, "min": 486.95, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 243.06, "avg": 243.06, "max": 243.06, "min": 243.06, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 203.31, "avg": 203.31, "max": 203.31, "min": 203.31, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.18, "avg": 3.18, "max": 3.18, "min": 3.18, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 54, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 74.12, "avg": 24.71, "max": 1.08, "min": 71.80, "cnt": 3}, "forward-compute":{"total": 1870.60, "avg": 58.46, "max": 52.61, "min": 64.36, "cnt": 32}, "fwd-compute":{"total": 1867.39, "avg": 58.36, "max": 52.53, "min": 64.21, "cnt": 32}, "batch-generator":{"total": 56.21, "avg": 1.76, "max": 0.61, "min": 5.62, "cnt": 32}, "fwd-embedding":{"total": 0.63, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1798.27, "avg": 56.20, "max": 51.29, "min": 61.48, "cnt": 32}, "fwd-layernorm":{"total": 9.93, "avg": 0.08, "max": 0.05, "min": 0.26, "cnt": 128}, "fwd-attn":{"total": 108.85, "avg": 0.85, "max": 0.74, "min": 2.29, "cnt": 128}, "fwd-misc":{"total": 21.25, "avg": 0.17, "max": 0.11, "min": 0.43, "cnt": 128}, "fwd-MLP":{"total": 1636.88, "avg": 12.79, "max": 10.27, "min": 19.58, "cnt": 128}, "MoE_L0_fwd":{"total": 509.03, "avg": 15.91, "max": 13.74, "min": 19.44, "cnt": 32}, "MoEMLP":{"total": 1619.80, "avg": 12.65, "max": 10.15, "min": 19.36, "cnt": 128}, "MoE_L1_fwd":{"total": 386.12, "avg": 12.07, "max": 10.90, "min": 15.13, "cnt": 32}, "MoE_L2_fwd":{"total": 347.70, "avg": 10.87, "max": 10.19, "min": 12.26, "cnt": 32}, "MoE_L3_fwd":{"total": 383.16, "avg": 11.97, "max": 11.30, "min": 13.10, "cnt": 32}, "fwd-pooler":{"total": 0.36, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 3.25, "avg": 1.63, "max": 0.95, "min": 2.31, "cnt": 2}, "forward-send-backward-recv":{"total": 1219.35, "avg": 40.65, "max": 1.90, "min": 234.63, "cnt": 30}, "backward-compute":{"total": 1720.14, "avg": 53.75, "max": 51.50, "min": 60.31, "cnt": 32}, "MoE_L3_bwd":{"total": 437.97, "avg": 13.69, "max": 12.89, "min": 19.22, "cnt": 32}, "MoE_L2_bwd":{"total": 351.43, "avg": 10.98, "max": 10.24, "min": 11.94, "cnt": 32}, "MoE_L1_bwd":{"total": 323.33, "avg": 10.10, "max": 9.65, "min": 10.51, "cnt": 32}, "MoE_L0_bwd":{"total": 392.60, "avg": 12.27, "max": 11.40, "min": 13.86, "cnt": 32}, "backward-send-forward-recv":{"total": 3857.69, "avg": 133.02, "max": 1.49, "min": 819.94, "cnt": 29}, "backward-send":{"total": 3.04, "avg": 1.01, "max": 0.94, "min": 1.09, "cnt": 3}, "backward-recv":{"total": 195.60, "avg": 97.80, "max": 74.95, "min": 120.64, "cnt": 2}, "backward-params-all-reduce":{"total": 488.23, "avg": 488.23, "max": 488.23, "min": 488.23, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.04, "avg": 0.04, "max": 0.04, "min": 0.04, "cnt": 1}, "optimizer":{"total": 245.27, "avg": 245.27, "max": 245.27, "min": 245.27, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 205.37, "avg": 205.37, "max": 205.37, "min": 205.37, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.27, "avg": 3.27, "max": 3.27, "min": 3.27, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 55, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 76.57, "avg": 25.52, "max": 0.99, "min": 74.49, "cnt": 3}, "forward-compute":{"total": 1843.37, "avg": 57.61, "max": 51.63, "min": 64.52, "cnt": 32}, "fwd-compute":{"total": 1840.42, "avg": 57.51, "max": 51.56, "min": 64.44, "cnt": 32}, "batch-generator":{"total": 45.46, "avg": 1.42, "max": 0.68, "min": 3.81, "cnt": 32}, "fwd-embedding":{"total": 0.62, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1782.48, "avg": 55.70, "max": 50.57, "min": 63.18, "cnt": 32}, "fwd-layernorm":{"total": 9.71, "avg": 0.08, "max": 0.05, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 109.66, "avg": 0.86, "max": 0.74, "min": 1.54, "cnt": 128}, "fwd-misc":{"total": 21.34, "avg": 0.17, "max": 0.11, "min": 0.48, "cnt": 128}, "fwd-MLP":{"total": 1620.73, "avg": 12.66, "max": 10.40, "min": 22.96, "cnt": 128}, "MoE_L0_fwd":{"total": 494.50, "avg": 15.45, "max": 12.56, "min": 22.88, "cnt": 32}, "MoEMLP":{"total": 1603.35, "avg": 12.53, "max": 10.30, "min": 22.83, "cnt": 128}, "MoE_L1_fwd":{"total": 378.23, "avg": 11.82, "max": 11.08, "min": 12.94, "cnt": 32}, "MoE_L2_fwd":{"total": 347.87, "avg": 10.87, "max": 10.33, "min": 11.77, "cnt": 32}, "MoE_L3_fwd":{"total": 389.07, "avg": 12.16, "max": 11.59, "min": 13.06, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.66, "avg": 0.83, "max": 0.81, "min": 0.85, "cnt": 2}, "forward-send-backward-recv":{"total": 221.49, "avg": 7.38, "max": 1.30, "min": 129.63, "cnt": 30}, "backward-compute":{"total": 1735.69, "avg": 54.24, "max": 51.79, "min": 55.67, "cnt": 32}, "MoE_L3_bwd":{"total": 435.80, "avg": 13.62, "max": 12.89, "min": 14.72, "cnt": 32}, "MoE_L2_bwd":{"total": 350.68, "avg": 10.96, "max": 10.32, "min": 11.86, "cnt": 32}, "MoE_L1_bwd":{"total": 343.35, "avg": 10.73, "max": 10.13, "min": 11.27, "cnt": 32}, "MoE_L0_bwd":{"total": 391.76, "avg": 12.24, "max": 11.71, "min": 12.89, "cnt": 32}, "backward-send-forward-recv":{"total": 4360.08, "avg": 150.35, "max": 2.31, "min": 432.86, "cnt": 29}, "backward-send":{"total": 2.84, "avg": 0.95, "max": 0.84, "min": 1.01, "cnt": 3}, "backward-recv":{"total": 152.93, "avg": 76.47, "max": 73.95, "min": 78.98, "cnt": 2}, "backward-params-all-reduce":{"total": 488.75, "avg": 488.75, "max": 488.75, "min": 488.75, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 245.11, "avg": 245.11, "max": 245.11, "min": 245.11, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 205.32, "avg": 205.32, "max": 205.32, "min": 205.32, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.28, "avg": 3.28, "max": 3.28, "min": 3.28, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 56, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 85.63, "avg": 28.54, "max": 0.80, "min": 83.36, "cnt": 3}, "forward-compute":{"total": 1821.32, "avg": 56.92, "max": 51.20, "min": 64.75, "cnt": 32}, "fwd-compute":{"total": 1818.36, "avg": 56.82, "max": 51.12, "min": 64.67, "cnt": 32}, "batch-generator":{"total": 37.83, "avg": 1.18, "max": 0.75, "min": 2.50, "cnt": 32}, "fwd-embedding":{"total": 0.51, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1768.75, "avg": 55.27, "max": 50.02, "min": 62.95, "cnt": 32}, "fwd-layernorm":{"total": 9.16, "avg": 0.07, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 108.31, "avg": 0.85, "max": 0.74, "min": 1.82, "cnt": 128}, "fwd-misc":{"total": 20.41, "avg": 0.16, "max": 0.12, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1610.12, "avg": 12.58, "max": 10.77, "min": 22.13, "cnt": 128}, "MoE_L0_fwd":{"total": 476.73, "avg": 14.90, "max": 11.27, "min": 21.90, "cnt": 32}, "MoEMLP":{"total": 1593.11, "avg": 12.45, "max": 10.65, "min": 21.85, "cnt": 128}, "MoE_L1_fwd":{"total": 376.48, "avg": 11.76, "max": 10.78, "min": 13.32, "cnt": 32}, "MoE_L2_fwd":{"total": 357.10, "avg": 11.16, "max": 10.70, "min": 12.15, "cnt": 32}, "MoE_L3_fwd":{"total": 388.86, "avg": 12.15, "max": 11.58, "min": 15.18, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 5.18, "avg": 2.59, "max": 0.89, "min": 4.28, "cnt": 2}, "forward-send-backward-recv":{"total": 287.04, "avg": 9.57, "max": 0.94, "min": 125.71, "cnt": 30}, "backward-compute":{"total": 1711.40, "avg": 53.48, "max": 50.83, "min": 56.90, "cnt": 32}, "MoE_L3_bwd":{"total": 437.70, "avg": 13.68, "max": 12.67, "min": 16.66, "cnt": 32}, "MoE_L2_bwd":{"total": 367.65, "avg": 11.49, "max": 10.36, "min": 12.41, "cnt": 32}, "MoE_L1_bwd":{"total": 337.03, "avg": 10.53, "max": 9.94, "min": 11.25, "cnt": 32}, "MoE_L0_bwd":{"total": 354.65, "avg": 11.08, "max": 10.52, "min": 11.95, "cnt": 32}, "backward-send-forward-recv":{"total": 4701.36, "avg": 162.12, "max": 2.33, "min": 572.92, "cnt": 29}, "backward-send":{"total": 2.85, "avg": 0.95, "max": 0.82, "min": 1.09, "cnt": 3}, "backward-recv":{"total": 145.85, "avg": 72.93, "max": 71.60, "min": 74.25, "cnt": 2}, "backward-params-all-reduce":{"total": 498.77, "avg": 498.77, "max": 498.77, "min": 498.77, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 249.96, "avg": 249.96, "max": 249.96, "min": 249.96, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 202.85, "avg": 202.85, "max": 202.85, "min": 202.85, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.25, "avg": 3.25, "max": 3.25, "min": 3.25, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 57, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 71.60, "avg": 23.87, "max": 0.71, "min": 63.87, "cnt": 3}, "forward-compute":{"total": 1818.44, "avg": 56.83, "max": 51.02, "min": 62.26, "cnt": 32}, "fwd-compute":{"total": 1815.58, "avg": 56.74, "max": 50.95, "min": 62.17, "cnt": 32}, "batch-generator":{"total": 40.76, "avg": 1.27, "max": 0.66, "min": 2.71, "cnt": 32}, "fwd-embedding":{"total": 0.57, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1762.48, "avg": 55.08, "max": 49.91, "min": 60.63, "cnt": 32}, "fwd-layernorm":{"total": 9.57, "avg": 0.07, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 108.18, "avg": 0.85, "max": 0.74, "min": 1.81, "cnt": 128}, "fwd-misc":{"total": 21.64, "avg": 0.17, "max": 0.11, "min": 0.53, "cnt": 128}, "fwd-MLP":{"total": 1601.57, "avg": 12.51, "max": 10.50, "min": 20.79, "cnt": 128}, "MoE_L0_fwd":{"total": 471.61, "avg": 14.74, "max": 11.19, "min": 20.69, "cnt": 32}, "MoEMLP":{"total": 1584.28, "avg": 12.38, "max": 10.39, "min": 20.65, "cnt": 128}, "MoE_L1_fwd":{"total": 381.80, "avg": 11.93, "max": 11.29, "min": 14.52, "cnt": 32}, "MoE_L2_fwd":{"total": 349.03, "avg": 10.91, "max": 10.43, "min": 11.73, "cnt": 32}, "MoE_L3_fwd":{"total": 388.14, "avg": 12.13, "max": 11.53, "min": 13.41, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 8.92, "avg": 4.46, "max": 0.71, "min": 8.21, "cnt": 2}, "forward-send-backward-recv":{"total": 228.10, "avg": 7.60, "max": 1.77, "min": 125.85, "cnt": 30}, "backward-compute":{"total": 1676.62, "avg": 52.39, "max": 50.42, "min": 53.35, "cnt": 32}, "MoE_L3_bwd":{"total": 430.27, "avg": 13.45, "max": 12.74, "min": 14.65, "cnt": 32}, "MoE_L2_bwd":{"total": 367.52, "avg": 11.48, "max": 10.78, "min": 12.67, "cnt": 32}, "MoE_L1_bwd":{"total": 347.39, "avg": 10.86, "max": 10.48, "min": 11.26, "cnt": 32}, "MoE_L0_bwd":{"total": 317.45, "avg": 9.92, "max": 9.26, "min": 10.73, "cnt": 32}, "backward-send-forward-recv":{"total": 5690.89, "avg": 196.24, "max": 2.27, "min": 529.03, "cnt": 29}, "backward-send":{"total": 2.45, "avg": 0.82, "max": 0.74, "min": 0.93, "cnt": 3}, "backward-recv":{"total": 131.72, "avg": 65.86, "max": 58.39, "min": 73.33, "cnt": 2}, "backward-params-all-reduce":{"total": 488.50, "avg": 488.50, "max": 488.50, "min": 488.50, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 242.30, "avg": 242.30, "max": 242.30, "min": 242.30, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 202.54, "avg": 202.54, "max": 202.54, "min": 202.54, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.23, "avg": 3.23, "max": 3.23, "min": 3.23, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 58, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 77.13, "avg": 25.71, "max": 0.73, "min": 75.23, "cnt": 3}, "forward-compute":{"total": 1873.12, "avg": 58.53, "max": 53.99, "min": 64.82, "cnt": 32}, "fwd-compute":{"total": 1869.79, "avg": 58.43, "max": 53.91, "min": 64.70, "cnt": 32}, "batch-generator":{"total": 42.11, "avg": 1.32, "max": 0.75, "min": 2.59, "cnt": 32}, "fwd-embedding":{"total": 0.68, "avg": 0.02, "max": 0.01, "min": 0.06, "cnt": 32}, "fwd-encoder":{"total": 1815.02, "avg": 56.72, "max": 52.78, "min": 62.77, "cnt": 32}, "fwd-layernorm":{"total": 10.11, "avg": 0.08, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 110.77, "avg": 0.87, "max": 0.74, "min": 1.49, "cnt": 128}, "fwd-misc":{"total": 21.43, "avg": 0.17, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1651.13, "avg": 12.90, "max": 10.63, "min": 18.95, "cnt": 128}, "MoE_L0_fwd":{"total": 495.85, "avg": 15.50, "max": 12.35, "min": 18.87, "cnt": 32}, "MoEMLP":{"total": 1633.55, "avg": 12.76, "max": 10.53, "min": 18.82, "cnt": 128}, "MoE_L1_fwd":{"total": 400.01, "avg": 12.50, "max": 11.38, "min": 17.10, "cnt": 32}, "MoE_L2_fwd":{"total": 355.75, "avg": 11.12, "max": 10.57, "min": 12.47, "cnt": 32}, "MoE_L3_fwd":{"total": 388.39, "avg": 12.14, "max": 11.55, "min": 13.54, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 3.88, "avg": 1.94, "max": 0.78, "min": 3.10, "cnt": 2}, "forward-send-backward-recv":{"total": 2357.20, "avg": 78.57, "max": 1.34, "min": 345.80, "cnt": 30}, "backward-compute":{"total": 1745.41, "avg": 54.54, "max": 52.37, "min": 56.69, "cnt": 32}, "MoE_L3_bwd":{"total": 438.91, "avg": 13.72, "max": 12.24, "min": 14.96, "cnt": 32}, "MoE_L2_bwd":{"total": 369.28, "avg": 11.54, "max": 10.75, "min": 14.28, "cnt": 32}, "MoE_L1_bwd":{"total": 368.34, "avg": 11.51, "max": 11.00, "min": 12.14, "cnt": 32}, "MoE_L0_bwd":{"total": 354.03, "avg": 11.06, "max": 10.63, "min": 11.39, "cnt": 32}, "backward-send-forward-recv":{"total": 1765.05, "avg": 60.86, "max": 1.29, "min": 420.10, "cnt": 29}, "backward-send":{"total": 3.13, "avg": 1.04, "max": 1.00, "min": 1.11, "cnt": 3}, "backward-recv":{"total": 399.55, "avg": 199.78, "max": 81.47, "min": 318.08, "cnt": 2}, "backward-params-all-reduce":{"total": 488.31, "avg": 488.31, "max": 488.31, "min": 488.31, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 246.66, "avg": 246.66, "max": 246.66, "min": 246.66, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 206.63, "avg": 206.63, "max": 206.63, "min": 206.63, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 59, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 70.60, "avg": 23.53, "max": 0.77, "min": 68.77, "cnt": 3}, "forward-compute":{"total": 1866.77, "avg": 58.34, "max": 53.22, "min": 65.02, "cnt": 32}, "fwd-compute":{"total": 1863.64, "avg": 58.24, "max": 53.13, "min": 64.95, "cnt": 32}, "batch-generator":{"total": 42.32, "avg": 1.32, "max": 0.69, "min": 2.19, "cnt": 32}, "fwd-embedding":{"total": 0.58, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1808.90, "avg": 56.53, "max": 51.12, "min": 63.15, "cnt": 32}, "fwd-layernorm":{"total": 9.39, "avg": 0.07, "max": 0.05, "min": 0.18, "cnt": 128}, "fwd-attn":{"total": 106.96, "avg": 0.84, "max": 0.74, "min": 2.03, "cnt": 128}, "fwd-misc":{"total": 20.31, "avg": 0.16, "max": 0.11, "min": 0.34, "cnt": 128}, "fwd-MLP":{"total": 1651.83, "avg": 12.90, "max": 10.43, "min": 21.73, "cnt": 128}, "MoE_L0_fwd":{"total": 499.70, "avg": 15.62, "max": 11.47, "min": 21.62, "cnt": 32}, "MoEMLP":{"total": 1635.45, "avg": 12.78, "max": 10.31, "min": 21.57, "cnt": 128}, "MoE_L1_fwd":{"total": 401.56, "avg": 12.55, "max": 11.51, "min": 17.58, "cnt": 32}, "MoE_L2_fwd":{"total": 357.31, "avg": 11.17, "max": 10.36, "min": 13.07, "cnt": 32}, "MoE_L3_fwd":{"total": 382.89, "avg": 11.97, "max": 11.48, "min": 13.11, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 3.89, "avg": 1.94, "max": 0.83, "min": 3.06, "cnt": 2}, "forward-send-backward-recv":{"total": 214.86, "avg": 7.16, "max": 0.95, "min": 127.27, "cnt": 30}, "backward-compute":{"total": 1738.82, "avg": 54.34, "max": 51.53, "min": 58.66, "cnt": 32}, "MoE_L3_bwd":{"total": 420.20, "avg": 13.13, "max": 12.20, "min": 14.40, "cnt": 32}, "MoE_L2_bwd":{"total": 370.08, "avg": 11.56, "max": 10.53, "min": 15.52, "cnt": 32}, "MoE_L1_bwd":{"total": 373.81, "avg": 11.68, "max": 10.96, "min": 12.86, "cnt": 32}, "MoE_L0_bwd":{"total": 361.31, "avg": 11.29, "max": 10.60, "min": 12.18, "cnt": 32}, "backward-send-forward-recv":{"total": 5111.71, "avg": 176.27, "max": 2.17, "min": 537.65, "cnt": 29}, "backward-send":{"total": 2.86, "avg": 0.95, "max": 0.87, "min": 1.09, "cnt": 3}, "backward-recv":{"total": 142.42, "avg": 71.21, "max": 61.13, "min": 81.29, "cnt": 2}, "backward-params-all-reduce":{"total": 485.24, "avg": 485.24, "max": 485.24, "min": 485.24, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 241.64, "avg": 241.64, "max": 241.64, "min": 241.64, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.36, "avg": 3.36, "max": 3.36, "min": 3.36, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 201.77, "avg": 201.77, "max": 201.77, "min": 201.77, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.33, "avg": 3.33, "max": 3.33, "min": 3.33, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}}}
{"type":"time", "iteration": 60, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 70.90, "avg": 23.63, "max": 1.04, "min": 68.82, "cnt": 3}, "forward-compute":{"total": 1850.69, "avg": 57.83, "max": 51.18, "min": 64.34, "cnt": 32}, "fwd-compute":{"total": 1847.55, "avg": 57.74, "max": 51.11, "min": 64.26, "cnt": 32}, "batch-generator":{"total": 40.38, "avg": 1.26, "max": 0.64, "min": 2.27, "cnt": 32}, "fwd-embedding":{"total": 0.65, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1793.75, "avg": 56.05, "max": 50.09, "min": 62.97, "cnt": 32}, "fwd-layernorm":{"total": 10.00, "avg": 0.08, "max": 0.05, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 109.70, "avg": 0.86, "max": 0.74, "min": 1.59, "cnt": 128}, "fwd-misc":{"total": 21.73, "avg": 0.17, "max": 0.12, "min": 0.44, "cnt": 128}, "fwd-MLP":{"total": 1630.30, "avg": 12.74, "max": 10.56, "min": 21.69, "cnt": 128}, "MoE_L0_fwd":{"total": 493.35, "avg": 15.42, "max": 11.61, "min": 21.58, "cnt": 32}, "MoEMLP":{"total": 1612.65, "avg": 12.60, "max": 10.44, "min": 21.54, "cnt": 128}, "MoE_L1_fwd":{"total": 384.35, "avg": 12.01, "max": 11.17, "min": 13.14, "cnt": 32}, "MoE_L2_fwd":{"total": 354.31, "avg": 11.07, "max": 10.48, "min": 12.19, "cnt": 32}, "MoE_L3_fwd":{"total": 387.04, "avg": 12.09, "max": 11.71, "min": 13.50, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.62, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 5.57, "avg": 2.79, "max": 0.87, "min": 4.70, "cnt": 2}, "forward-send-backward-recv":{"total": 444.69, "avg": 14.82, "max": 1.14, "min": 133.82, "cnt": 30}, "backward-compute":{"total": 1753.59, "avg": 54.80, "max": 51.17, "min": 57.66, "cnt": 32}, "MoE_L3_bwd":{"total": 443.96, "avg": 13.87, "max": 12.61, "min": 16.20, "cnt": 32}, "MoE_L2_bwd":{"total": 372.14, "avg": 11.63, "max": 11.09, "min": 12.53, "cnt": 32}, "MoE_L1_bwd":{"total": 362.34, "avg": 11.32, "max": 10.62, "min": 11.73, "cnt": 32}, "MoE_L0_bwd":{"total": 361.09, "avg": 11.28, "max": 10.38, "min": 11.85, "cnt": 32}, "backward-send-forward-recv":{"total": 4409.43, "avg": 152.05, "max": 2.18, "min": 647.79, "cnt": 29}, "backward-send":{"total": 3.00, "avg": 1.00, "max": 0.95, "min": 1.07, "cnt": 3}, "backward-recv":{"total": 421.67, "avg": 210.83, "max": 77.45, "min": 344.22, "cnt": 2}, "backward-params-all-reduce":{"total": 485.04, "avg": 485.04, "max": 485.04, "min": 485.04, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 242.15, "avg": 242.15, "max": 242.15, "min": 242.15, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 202.31, "avg": 202.31, "max": 202.31, "min": 202.31, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.36, "avg": 3.36, "max": 3.36, "min": 3.36, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.41, "avg": 3.41, "max": 3.41, "min": 3.41, "cnt": 1}}}
{"type":"time", "iteration": 61, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 82.77, "avg": 27.59, "max": 0.98, "min": 80.59, "cnt": 3}, "forward-compute":{"total": 1839.37, "avg": 57.48, "max": 50.90, "min": 63.85, "cnt": 32}, "fwd-compute":{"total": 1836.34, "avg": 57.39, "max": 50.83, "min": 63.74, "cnt": 32}, "batch-generator":{"total": 47.44, "avg": 1.48, "max": 0.66, "min": 3.74, "cnt": 32}, "fwd-embedding":{"total": 0.63, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1776.30, "avg": 55.51, "max": 49.71, "min": 61.97, "cnt": 32}, "fwd-layernorm":{"total": 9.77, "avg": 0.08, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 108.78, "avg": 0.85, "max": 0.74, "min": 1.66, "cnt": 128}, "fwd-misc":{"total": 21.18, "avg": 0.17, "max": 0.11, "min": 0.53, "cnt": 128}, "fwd-MLP":{"total": 1615.14, "avg": 12.62, "max": 10.51, "min": 20.59, "cnt": 128}, "MoE_L0_fwd":{"total": 481.09, "avg": 15.03, "max": 11.91, "min": 20.48, "cnt": 32}, "MoEMLP":{"total": 1598.18, "avg": 12.49, "max": 10.38, "min": 20.43, "cnt": 128}, "MoE_L1_fwd":{"total": 375.85, "avg": 11.75, "max": 10.95, "min": 15.16, "cnt": 32}, "MoE_L2_fwd":{"total": 358.11, "avg": 11.19, "max": 10.43, "min": 15.51, "cnt": 32}, "MoE_L3_fwd":{"total": 389.35, "avg": 12.17, "max": 11.49, "min": 13.84, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 4.36, "avg": 2.18, "max": 0.91, "min": 3.45, "cnt": 2}, "forward-send-backward-recv":{"total": 203.02, "avg": 6.77, "max": 1.25, "min": 121.56, "cnt": 30}, "backward-compute":{"total": 1713.44, "avg": 53.55, "max": 51.91, "min": 56.40, "cnt": 32}, "MoE_L3_bwd":{"total": 436.88, "avg": 13.65, "max": 12.89, "min": 16.06, "cnt": 32}, "MoE_L2_bwd":{"total": 369.96, "avg": 11.56, "max": 10.81, "min": 12.58, "cnt": 32}, "MoE_L1_bwd":{"total": 343.85, "avg": 10.75, "max": 10.07, "min": 11.84, "cnt": 32}, "MoE_L0_bwd":{"total": 350.16, "avg": 10.94, "max": 10.46, "min": 11.25, "cnt": 32}, "backward-send-forward-recv":{"total": 5625.77, "avg": 193.99, "max": 2.13, "min": 940.37, "cnt": 29}, "backward-send":{"total": 3.42, "avg": 1.14, "max": 0.93, "min": 1.33, "cnt": 3}, "backward-recv":{"total": 147.67, "avg": 73.84, "max": 69.64, "min": 78.03, "cnt": 2}, "backward-params-all-reduce":{"total": 488.96, "avg": 488.96, "max": 488.96, "min": 488.96, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 246.81, "avg": 246.81, "max": 246.81, "min": 246.81, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 206.99, "avg": 206.99, "max": 206.99, "min": 206.99, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.31, "avg": 3.31, "max": 3.31, "min": 3.31, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 62, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 75.73, "avg": 25.24, "max": 0.62, "min": 73.68, "cnt": 3}, "forward-compute":{"total": 1809.21, "avg": 56.54, "max": 49.76, "min": 68.09, "cnt": 32}, "fwd-compute":{"total": 1806.19, "avg": 56.44, "max": 49.70, "min": 67.99, "cnt": 32}, "batch-generator":{"total": 52.12, "avg": 1.63, "max": 0.63, "min": 4.54, "cnt": 32}, "fwd-embedding":{"total": 0.64, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1741.13, "avg": 54.41, "max": 48.68, "min": 65.78, "cnt": 32}, "fwd-layernorm":{"total": 9.56, "avg": 0.07, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 107.35, "avg": 0.84, "max": 0.74, "min": 1.50, "cnt": 128}, "fwd-misc":{"total": 20.64, "avg": 0.16, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1583.04, "avg": 12.37, "max": 10.36, "min": 23.75, "cnt": 128}, "MoE_L0_fwd":{"total": 465.92, "avg": 14.56, "max": 11.21, "min": 23.65, "cnt": 32}, "MoEMLP":{"total": 1566.38, "avg": 12.24, "max": 10.24, "min": 23.60, "cnt": 128}, "MoE_L1_fwd":{"total": 361.01, "avg": 11.28, "max": 10.70, "min": 13.06, "cnt": 32}, "MoE_L2_fwd":{"total": 354.52, "avg": 11.08, "max": 10.30, "min": 14.94, "cnt": 32}, "MoE_L3_fwd":{"total": 391.02, "avg": 12.22, "max": 11.48, "min": 14.37, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 6.19, "avg": 3.09, "max": 0.96, "min": 5.23, "cnt": 2}, "forward-send-backward-recv":{"total": 238.00, "avg": 7.93, "max": 0.85, "min": 124.42, "cnt": 30}, "backward-compute":{"total": 1657.81, "avg": 51.81, "max": 48.75, "min": 55.74, "cnt": 32}, "MoE_L3_bwd":{"total": 439.55, "avg": 13.74, "max": 12.22, "min": 16.25, "cnt": 32}, "MoE_L2_bwd":{"total": 355.81, "avg": 11.12, "max": 10.33, "min": 11.79, "cnt": 32}, "MoE_L1_bwd":{"total": 323.62, "avg": 10.11, "max": 9.37, "min": 10.62, "cnt": 32}, "MoE_L0_bwd":{"total": 325.60, "avg": 10.18, "max": 9.71, "min": 11.07, "cnt": 32}, "backward-send-forward-recv":{"total": 6778.51, "avg": 233.74, "max": 2.11, "min": 1050.16, "cnt": 29}, "backward-send":{"total": 3.08, "avg": 1.03, "max": 0.94, "min": 1.10, "cnt": 3}, "backward-recv":{"total": 330.86, "avg": 165.43, "max": 77.04, "min": 253.82, "cnt": 2}, "backward-params-all-reduce":{"total": 486.48, "avg": 486.48, "max": 486.48, "min": 486.48, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 241.29, "avg": 241.29, "max": 241.29, "min": 241.29, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 201.48, "avg": 201.48, "max": 201.48, "min": 201.48, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.25, "avg": 3.25, "max": 3.25, "min": 3.25, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.49, "avg": 3.49, "max": 3.49, "min": 3.49, "cnt": 1}}}
{"type":"time", "iteration": 63, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.10, "avg": 0.10, "max": 0.10, "min": 0.10, "cnt": 1}, "forward-recv":{"total": 96.27, "avg": 32.09, "max": 6.94, "min": 76.94, "cnt": 3}, "forward-compute":{"total": 1795.21, "avg": 56.10, "max": 48.90, "min": 64.06, "cnt": 32}, "fwd-compute":{"total": 1792.21, "avg": 56.01, "max": 48.84, "min": 63.98, "cnt": 32}, "batch-generator":{"total": 40.17, "avg": 1.26, "max": 0.72, "min": 2.30, "cnt": 32}, "fwd-embedding":{"total": 0.56, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1739.88, "avg": 54.37, "max": 47.82, "min": 62.67, "cnt": 32}, "fwd-layernorm":{"total": 9.31, "avg": 0.07, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 107.42, "avg": 0.84, "max": 0.74, "min": 1.61, "cnt": 128}, "fwd-misc":{"total": 20.49, "avg": 0.16, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1582.40, "avg": 12.36, "max": 10.45, "min": 20.13, "cnt": 128}, "MoE_L0_fwd":{"total": 476.81, "avg": 14.90, "max": 10.74, "min": 20.05, "cnt": 32}, "MoEMLP":{"total": 1565.94, "avg": 12.23, "max": 10.33, "min": 20.00, "cnt": 128}, "MoE_L1_fwd":{"total": 360.79, "avg": 11.27, "max": 10.39, "min": 12.96, "cnt": 32}, "MoE_L2_fwd":{"total": 356.54, "avg": 11.14, "max": 10.37, "min": 15.36, "cnt": 32}, "MoE_L3_fwd":{"total": 377.79, "avg": 11.81, "max": 11.25, "min": 14.29, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 3.43, "avg": 1.71, "max": 0.97, "min": 2.45, "cnt": 2}, "forward-send-backward-recv":{"total": 394.29, "avg": 13.14, "max": 1.40, "min": 125.18, "cnt": 30}, "backward-compute":{"total": 1633.81, "avg": 51.06, "max": 49.44, "min": 52.47, "cnt": 32}, "MoE_L3_bwd":{"total": 426.29, "avg": 13.32, "max": 12.39, "min": 14.83, "cnt": 32}, "MoE_L2_bwd":{"total": 357.65, "avg": 11.18, "max": 10.59, "min": 12.17, "cnt": 32}, "MoE_L1_bwd":{"total": 310.81, "avg": 9.71, "max": 9.25, "min": 10.17, "cnt": 32}, "MoE_L0_bwd":{"total": 324.06, "avg": 10.13, "max": 9.76, "min": 10.86, "cnt": 32}, "backward-send-forward-recv":{"total": 3328.17, "avg": 114.76, "max": 2.44, "min": 294.73, "cnt": 29}, "backward-send":{"total": 2.43, "avg": 0.81, "max": 0.55, "min": 1.13, "cnt": 3}, "backward-recv":{"total": 229.23, "avg": 114.62, "max": 75.65, "min": 153.58, "cnt": 2}, "backward-params-all-reduce":{"total": 487.99, "avg": 487.99, "max": 487.99, "min": 487.99, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 241.18, "avg": 241.18, "max": 241.18, "min": 241.18, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 201.13, "avg": 201.13, "max": 201.13, "min": 201.13, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.48, "avg": 3.48, "max": 3.48, "min": 3.48, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 64, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 81.55, "avg": 27.18, "max": 1.64, "min": 76.34, "cnt": 3}, "forward-compute":{"total": 1799.91, "avg": 56.25, "max": 48.73, "min": 61.91, "cnt": 32}, "fwd-compute":{"total": 1796.93, "avg": 56.15, "max": 48.67, "min": 61.81, "cnt": 32}, "batch-generator":{"total": 42.20, "avg": 1.32, "max": 0.68, "min": 2.71, "cnt": 32}, "fwd-embedding":{"total": 0.56, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1742.28, "avg": 54.45, "max": 47.60, "min": 60.22, "cnt": 32}, "fwd-layernorm":{"total": 9.46, "avg": 0.07, "max": 0.05, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 108.01, "avg": 0.84, "max": 0.74, "min": 1.94, "cnt": 128}, "fwd-misc":{"total": 20.21, "avg": 0.16, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1583.75, "avg": 12.37, "max": 10.25, "min": 19.89, "cnt": 128}, "MoE_L0_fwd":{"total": 473.14, "avg": 14.79, "max": 10.69, "min": 19.81, "cnt": 32}, "MoEMLP":{"total": 1567.17, "avg": 12.24, "max": 10.14, "min": 19.75, "cnt": 128}, "MoE_L1_fwd":{"total": 369.26, "avg": 11.54, "max": 10.31, "min": 16.15, "cnt": 32}, "MoE_L2_fwd":{"total": 358.84, "avg": 11.21, "max": 10.18, "min": 15.23, "cnt": 32}, "MoE_L3_fwd":{"total": 371.96, "avg": 11.62, "max": 11.16, "min": 13.09, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.61, "avg": 0.02, "max": 0.02, "min": 0.04, "cnt": 32}, "forward-send":{"total": 5.04, "avg": 2.52, "max": 0.94, "min": 4.10, "cnt": 2}, "forward-send-backward-recv":{"total": 463.18, "avg": 15.44, "max": 1.51, "min": 124.94, "cnt": 30}, "backward-compute":{"total": 1594.53, "avg": 49.83, "max": 47.12, "min": 51.65, "cnt": 32}, "MoE_L3_bwd":{"total": 424.51, "avg": 13.27, "max": 12.47, "min": 14.82, "cnt": 32}, "MoE_L2_bwd":{"total": 340.88, "avg": 10.65, "max": 10.22, "min": 12.15, "cnt": 32}, "MoE_L1_bwd":{"total": 307.34, "avg": 9.60, "max": 8.98, "min": 10.19, "cnt": 32}, "MoE_L0_bwd":{"total": 306.72, "avg": 9.59, "max": 8.76, "min": 9.92, "cnt": 32}, "backward-send-forward-recv":{"total": 3993.85, "avg": 137.72, "max": 1.09, "min": 575.75, "cnt": 29}, "backward-send":{"total": 2.74, "avg": 0.91, "max": 0.76, "min": 1.12, "cnt": 3}, "backward-recv":{"total": 256.24, "avg": 128.12, "max": 103.61, "min": 152.63, "cnt": 2}, "backward-params-all-reduce":{"total": 488.89, "avg": 488.89, "max": 488.89, "min": 488.89, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 241.39, "avg": 241.39, "max": 241.39, "min": 241.39, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 201.73, "avg": 201.73, "max": 201.73, "min": 201.73, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.21, "avg": 3.21, "max": 3.21, "min": 3.21, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}}}
{"type":"time", "iteration": 65, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 300.37, "avg": 100.12, "max": 1.21, "min": 229.48, "cnt": 3}, "forward-compute":{"total": 1768.78, "avg": 55.27, "max": 50.36, "min": 65.74, "cnt": 32}, "fwd-compute":{"total": 1765.78, "avg": 55.18, "max": 50.27, "min": 65.66, "cnt": 32}, "batch-generator":{"total": 44.77, "avg": 1.40, "max": 0.76, "min": 3.54, "cnt": 32}, "fwd-embedding":{"total": 0.49, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1709.23, "avg": 53.41, "max": 49.02, "min": 63.78, "cnt": 32}, "fwd-layernorm":{"total": 8.83, "avg": 0.07, "max": 0.05, "min": 0.18, "cnt": 128}, "fwd-attn":{"total": 104.19, "avg": 0.81, "max": 0.74, "min": 1.42, "cnt": 128}, "fwd-misc":{"total": 20.04, "avg": 0.16, "max": 0.11, "min": 0.41, "cnt": 128}, "fwd-MLP":{"total": 1556.32, "avg": 12.16, "max": 10.24, "min": 23.24, "cnt": 128}, "MoE_L0_fwd":{"total": 471.04, "avg": 14.72, "max": 11.38, "min": 23.16, "cnt": 32}, "MoEMLP":{"total": 1540.29, "avg": 12.03, "max": 10.12, "min": 23.11, "cnt": 128}, "MoE_L1_fwd":{"total": 361.05, "avg": 11.28, "max": 10.39, "min": 13.18, "cnt": 32}, "MoE_L2_fwd":{"total": 343.41, "avg": 10.73, "max": 10.16, "min": 11.59, "cnt": 32}, "MoE_L3_fwd":{"total": 370.57, "avg": 11.58, "max": 11.19, "min": 12.95, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 5.74, "avg": 2.87, "max": 0.91, "min": 4.82, "cnt": 2}, "forward-send-backward-recv":{"total": 209.57, "avg": 6.99, "max": 1.82, "min": 126.47, "cnt": 30}, "backward-compute":{"total": 1601.32, "avg": 50.04, "max": 48.14, "min": 50.99, "cnt": 32}, "MoE_L3_bwd":{"total": 421.33, "avg": 13.17, "max": 12.37, "min": 14.03, "cnt": 32}, "MoE_L2_bwd":{"total": 345.08, "avg": 10.78, "max": 10.25, "min": 11.51, "cnt": 32}, "MoE_L1_bwd":{"total": 304.13, "avg": 9.50, "max": 9.08, "min": 9.77, "cnt": 32}, "MoE_L0_bwd":{"total": 316.39, "avg": 9.89, "max": 9.28, "min": 10.23, "cnt": 32}, "backward-send-forward-recv":{"total": 4462.57, "avg": 153.88, "max": 7.27, "min": 586.50, "cnt": 29}, "backward-send":{"total": 2.81, "avg": 0.94, "max": 0.68, "min": 1.12, "cnt": 3}, "backward-recv":{"total": 140.13, "avg": 70.06, "max": 65.79, "min": 74.34, "cnt": 2}, "backward-params-all-reduce":{"total": 488.57, "avg": 488.57, "max": 488.57, "min": 488.57, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 242.50, "avg": 242.50, "max": 242.50, "min": 242.50, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 198.06, "avg": 198.06, "max": 198.06, "min": 198.06, "cnt": 1}, "optimizer-clip-main-grad":{"total": 5.84, "avg": 5.84, "max": 5.84, "min": 5.84, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}}}
{"type":"time", "iteration": 66, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 77.66, "avg": 25.89, "max": 1.06, "min": 69.70, "cnt": 3}, "forward-compute":{"total": 1788.97, "avg": 55.91, "max": 49.51, "min": 64.20, "cnt": 32}, "fwd-compute":{"total": 1786.14, "avg": 55.82, "max": 49.42, "min": 64.12, "cnt": 32}, "batch-generator":{"total": 44.19, "avg": 1.38, "max": 0.67, "min": 3.58, "cnt": 32}, "fwd-embedding":{"total": 0.50, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1730.16, "avg": 54.07, "max": 48.44, "min": 61.21, "cnt": 32}, "fwd-layernorm":{"total": 8.63, "avg": 0.07, "max": 0.05, "min": 0.18, "cnt": 128}, "fwd-attn":{"total": 102.42, "avg": 0.80, "max": 0.74, "min": 1.43, "cnt": 128}, "fwd-misc":{"total": 19.20, "avg": 0.15, "max": 0.11, "min": 0.34, "cnt": 128}, "fwd-MLP":{"total": 1580.42, "avg": 12.35, "max": 10.26, "min": 22.31, "cnt": 128}, "MoE_L0_fwd":{"total": 474.92, "avg": 14.84, "max": 11.12, "min": 22.23, "cnt": 32}, "MoEMLP":{"total": 1564.72, "avg": 12.22, "max": 10.15, "min": 22.19, "cnt": 128}, "MoE_L1_fwd":{"total": 366.91, "avg": 11.47, "max": 10.51, "min": 13.34, "cnt": 32}, "MoE_L2_fwd":{"total": 345.19, "avg": 10.79, "max": 10.19, "min": 12.19, "cnt": 32}, "MoE_L3_fwd":{"total": 383.49, "avg": 11.98, "max": 11.19, "min": 16.93, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.62, "avg": 0.02, "max": 0.02, "min": 0.04, "cnt": 32}, "forward-send":{"total": 1.84, "avg": 0.92, "max": 0.85, "min": 0.98, "cnt": 2}, "forward-send-backward-recv":{"total": 1007.63, "avg": 33.59, "max": 1.10, "min": 220.79, "cnt": 30}, "backward-compute":{"total": 1617.25, "avg": 50.54, "max": 47.72, "min": 52.44, "cnt": 32}, "MoE_L3_bwd":{"total": 438.36, "avg": 13.70, "max": 12.10, "min": 15.88, "cnt": 32}, "MoE_L2_bwd":{"total": 345.01, "avg": 10.78, "max": 10.19, "min": 11.38, "cnt": 32}, "MoE_L1_bwd":{"total": 305.76, "avg": 9.56, "max": 9.00, "min": 9.91, "cnt": 32}, "MoE_L0_bwd":{"total": 312.27, "avg": 9.76, "max": 9.33, "min": 10.60, "cnt": 32}, "backward-send-forward-recv":{"total": 4900.96, "avg": 169.00, "max": 1.05, "min": 874.58, "cnt": 29}, "backward-send":{"total": 2.40, "avg": 0.80, "max": 0.44, "min": 1.06, "cnt": 3}, "backward-recv":{"total": 333.54, "avg": 166.77, "max": 74.21, "min": 259.33, "cnt": 2}, "backward-params-all-reduce":{"total": 491.47, "avg": 491.47, "max": 491.47, "min": 491.47, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 250.34, "avg": 250.34, "max": 250.34, "min": 250.34, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 206.42, "avg": 206.42, "max": 206.42, "min": 206.42, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.09, "avg": 6.09, "max": 6.09, "min": 6.09, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 67, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 77.65, "avg": 25.88, "max": 4.76, "min": 65.74, "cnt": 3}, "forward-compute":{"total": 1784.98, "avg": 55.78, "max": 50.21, "min": 63.87, "cnt": 32}, "fwd-compute":{"total": 1781.65, "avg": 55.68, "max": 50.13, "min": 63.78, "cnt": 32}, "batch-generator":{"total": 53.69, "avg": 1.68, "max": 0.68, "min": 3.49, "cnt": 32}, "fwd-embedding":{"total": 0.71, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1714.99, "avg": 53.59, "max": 49.03, "min": 60.12, "cnt": 32}, "fwd-layernorm":{"total": 9.96, "avg": 0.08, "max": 0.05, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 108.39, "avg": 0.85, "max": 0.74, "min": 1.64, "cnt": 128}, "fwd-misc":{"total": 20.96, "avg": 0.16, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1554.56, "avg": 12.14, "max": 9.98, "min": 18.57, "cnt": 128}, "MoE_L0_fwd":{"total": 471.12, "avg": 14.72, "max": 11.78, "min": 18.44, "cnt": 32}, "MoEMLP":{"total": 1537.41, "avg": 12.01, "max": 9.88, "min": 18.39, "cnt": 128}, "MoE_L1_fwd":{"total": 356.35, "avg": 11.14, "max": 10.26, "min": 13.53, "cnt": 32}, "MoE_L2_fwd":{"total": 336.79, "avg": 10.52, "max": 9.91, "min": 11.31, "cnt": 32}, "MoE_L3_fwd":{"total": 379.39, "avg": 11.86, "max": 11.23, "min": 12.65, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.93, "avg": 0.97, "max": 0.83, "min": 1.10, "cnt": 2}, "forward-send-backward-recv":{"total": 1157.61, "avg": 38.59, "max": 1.24, "min": 292.12, "cnt": 30}, "backward-compute":{"total": 1619.40, "avg": 50.61, "max": 47.73, "min": 54.23, "cnt": 32}, "MoE_L3_bwd":{"total": 431.25, "avg": 13.48, "max": 11.91, "min": 16.83, "cnt": 32}, "MoE_L2_bwd":{"total": 328.39, "avg": 10.26, "max": 9.54, "min": 11.64, "cnt": 32}, "MoE_L1_bwd":{"total": 317.07, "avg": 9.91, "max": 9.45, "min": 11.77, "cnt": 32}, "MoE_L0_bwd":{"total": 326.40, "avg": 10.20, "max": 9.84, "min": 10.58, "cnt": 32}, "backward-send-forward-recv":{"total": 5274.51, "avg": 181.88, "max": 2.22, "min": 982.82, "cnt": 29}, "backward-send":{"total": 2.87, "avg": 0.96, "max": 0.72, "min": 1.10, "cnt": 3}, "backward-recv":{"total": 201.42, "avg": 100.71, "max": 71.31, "min": 130.11, "cnt": 2}, "backward-params-all-reduce":{"total": 481.98, "avg": 481.98, "max": 481.98, "min": 481.98, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 247.07, "avg": 247.07, "max": 247.07, "min": 247.07, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 207.18, "avg": 207.18, "max": 207.18, "min": 207.18, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.27, "avg": 3.27, "max": 3.27, "min": 3.27, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.47, "avg": 3.47, "max": 3.47, "min": 3.47, "cnt": 1}}}
{"type":"time", "iteration": 68, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 82.12, "avg": 27.37, "max": 3.28, "min": 70.42, "cnt": 3}, "forward-compute":{"total": 1812.66, "avg": 56.65, "max": 51.37, "min": 75.07, "cnt": 32}, "fwd-compute":{"total": 1809.62, "avg": 56.55, "max": 51.29, "min": 74.99, "cnt": 32}, "batch-generator":{"total": 39.94, "avg": 1.25, "max": 0.71, "min": 1.72, "cnt": 32}, "fwd-embedding":{"total": 0.56, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1757.50, "avg": 54.92, "max": 50.22, "min": 73.83, "cnt": 32}, "fwd-layernorm":{"total": 9.36, "avg": 0.07, "max": 0.05, "min": 0.18, "cnt": 128}, "fwd-attn":{"total": 106.60, "avg": 0.83, "max": 0.74, "min": 1.51, "cnt": 128}, "fwd-misc":{"total": 20.41, "avg": 0.16, "max": 0.11, "min": 0.33, "cnt": 128}, "fwd-MLP":{"total": 1600.50, "avg": 12.50, "max": 10.39, "min": 35.55, "cnt": 128}, "MoE_L0_fwd":{"total": 498.56, "avg": 15.58, "max": 12.06, "min": 35.43, "cnt": 32}, "MoEMLP":{"total": 1583.66, "avg": 12.37, "max": 10.29, "min": 35.38, "cnt": 128}, "MoE_L1_fwd":{"total": 356.56, "avg": 11.14, "max": 10.46, "min": 13.85, "cnt": 32}, "MoE_L2_fwd":{"total": 352.71, "avg": 11.02, "max": 10.32, "min": 15.23, "cnt": 32}, "MoE_L3_fwd":{"total": 382.08, "avg": 11.94, "max": 11.59, "min": 12.51, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.63, "avg": 0.82, "max": 0.73, "min": 0.90, "cnt": 2}, "forward-send-backward-recv":{"total": 905.65, "avg": 30.19, "max": 1.07, "min": 312.66, "cnt": 30}, "backward-compute":{"total": 1671.40, "avg": 52.23, "max": 50.89, "min": 54.62, "cnt": 32}, "MoE_L3_bwd":{"total": 426.73, "avg": 13.34, "max": 12.65, "min": 14.61, "cnt": 32}, "MoE_L2_bwd":{"total": 356.37, "avg": 11.14, "max": 10.38, "min": 11.71, "cnt": 32}, "MoE_L1_bwd":{"total": 307.44, "avg": 9.61, "max": 8.95, "min": 10.28, "cnt": 32}, "MoE_L0_bwd":{"total": 366.62, "avg": 11.46, "max": 10.91, "min": 12.80, "cnt": 32}, "backward-send-forward-recv":{"total": 2690.36, "avg": 92.77, "max": 1.54, "min": 281.62, "cnt": 29}, "backward-send":{"total": 3.29, "avg": 1.10, "max": 1.02, "min": 1.18, "cnt": 3}, "backward-recv":{"total": 247.47, "avg": 123.73, "max": 75.93, "min": 171.54, "cnt": 2}, "backward-params-all-reduce":{"total": 481.44, "avg": 481.44, "max": 481.44, "min": 481.44, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 245.72, "avg": 245.72, "max": 245.72, "min": 245.72, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 205.69, "avg": 205.69, "max": 205.69, "min": 205.69, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.49, "avg": 3.49, "max": 3.49, "min": 3.49, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 69, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.11, "avg": 0.11, "max": 0.11, "min": 0.11, "cnt": 1}, "forward-recv":{"total": 72.96, "avg": 24.32, "max": 1.04, "min": 68.56, "cnt": 3}, "forward-compute":{"total": 1841.87, "avg": 57.56, "max": 52.27, "min": 64.40, "cnt": 32}, "fwd-compute":{"total": 1838.67, "avg": 57.46, "max": 52.16, "min": 64.32, "cnt": 32}, "batch-generator":{"total": 55.83, "avg": 1.74, "max": 0.71, "min": 4.39, "cnt": 32}, "fwd-embedding":{"total": 0.60, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1770.49, "avg": 55.33, "max": 50.47, "min": 62.21, "cnt": 32}, "fwd-layernorm":{"total": 9.43, "avg": 0.07, "max": 0.05, "min": 0.26, "cnt": 128}, "fwd-attn":{"total": 107.05, "avg": 0.84, "max": 0.74, "min": 2.35, "cnt": 128}, "fwd-misc":{"total": 20.52, "avg": 0.16, "max": 0.11, "min": 0.44, "cnt": 128}, "fwd-MLP":{"total": 1612.81, "avg": 12.60, "max": 10.51, "min": 21.71, "cnt": 128}, "MoE_L0_fwd":{"total": 497.16, "avg": 15.54, "max": 12.01, "min": 21.60, "cnt": 32}, "MoEMLP":{"total": 1596.32, "avg": 12.47, "max": 10.40, "min": 21.53, "cnt": 128}, "MoE_L1_fwd":{"total": 371.74, "avg": 11.62, "max": 10.47, "min": 17.09, "cnt": 32}, "MoE_L2_fwd":{"total": 355.20, "avg": 11.10, "max": 10.44, "min": 13.29, "cnt": 32}, "MoE_L3_fwd":{"total": 378.24, "avg": 11.82, "max": 11.47, "min": 12.47, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.74, "avg": 0.87, "max": 0.73, "min": 1.01, "cnt": 2}, "forward-send-backward-recv":{"total": 203.19, "avg": 6.77, "max": 1.08, "min": 121.19, "cnt": 30}, "backward-compute":{"total": 1681.31, "avg": 52.54, "max": 50.50, "min": 55.01, "cnt": 32}, "MoE_L3_bwd":{"total": 432.56, "avg": 13.52, "max": 12.71, "min": 14.75, "cnt": 32}, "MoE_L2_bwd":{"total": 360.77, "avg": 11.27, "max": 10.76, "min": 11.77, "cnt": 32}, "MoE_L1_bwd":{"total": 306.16, "avg": 9.57, "max": 9.10, "min": 9.91, "cnt": 32}, "MoE_L0_bwd":{"total": 368.89, "avg": 11.53, "max": 11.10, "min": 12.49, "cnt": 32}, "backward-send-forward-recv":{"total": 7346.38, "avg": 253.32, "max": 1.61, "min": 1303.06, "cnt": 29}, "backward-send":{"total": 2.85, "avg": 0.95, "max": 0.76, "min": 1.09, "cnt": 3}, "backward-recv":{"total": 446.12, "avg": 223.06, "max": 63.66, "min": 382.46, "cnt": 2}, "backward-params-all-reduce":{"total": 483.65, "avg": 483.65, "max": 483.65, "min": 483.65, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.04, "avg": 0.04, "max": 0.04, "min": 0.04, "cnt": 1}, "optimizer":{"total": 249.76, "avg": 249.76, "max": 249.76, "min": 249.76, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 203.53, "avg": 203.53, "max": 203.53, "min": 203.53, "cnt": 1}, "optimizer-clip-main-grad":{"total": 5.96, "avg": 5.96, "max": 5.96, "min": 5.96, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.47, "avg": 3.47, "max": 3.47, "min": 3.47, "cnt": 1}}}
{"type":"time", "iteration": 70, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 71.28, "avg": 23.76, "max": 0.98, "min": 69.28, "cnt": 3}, "forward-compute":{"total": 1792.32, "avg": 56.01, "max": 49.36, "min": 63.75, "cnt": 32}, "fwd-compute":{"total": 1789.23, "avg": 55.91, "max": 49.29, "min": 63.66, "cnt": 32}, "batch-generator":{"total": 40.03, "avg": 1.25, "max": 0.64, "min": 2.96, "cnt": 32}, "fwd-embedding":{"total": 0.59, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1736.92, "avg": 54.28, "max": 48.36, "min": 62.30, "cnt": 32}, "fwd-layernorm":{"total": 9.41, "avg": 0.07, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 106.23, "avg": 0.83, "max": 0.74, "min": 1.44, "cnt": 128}, "fwd-misc":{"total": 20.38, "avg": 0.16, "max": 0.11, "min": 0.50, "cnt": 128}, "fwd-MLP":{"total": 1580.41, "avg": 12.35, "max": 9.72, "min": 19.88, "cnt": 128}, "MoE_L0_fwd":{"total": 478.39, "avg": 14.95, "max": 10.69, "min": 19.80, "cnt": 32}, "MoEMLP":{"total": 1563.99, "avg": 12.22, "max": 9.62, "min": 19.75, "cnt": 128}, "MoE_L1_fwd":{"total": 356.55, "avg": 11.14, "max": 9.66, "min": 15.12, "cnt": 32}, "MoE_L2_fwd":{"total": 357.85, "avg": 11.18, "max": 10.55, "min": 15.05, "cnt": 32}, "MoE_L3_fwd":{"total": 377.25, "avg": 11.79, "max": 11.44, "min": 13.55, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 4.74, "avg": 2.37, "max": 0.82, "min": 3.92, "cnt": 2}, "forward-send-backward-recv":{"total": 208.21, "avg": 6.94, "max": 1.16, "min": 124.17, "cnt": 30}, "backward-compute":{"total": 1651.21, "avg": 51.60, "max": 49.14, "min": 54.08, "cnt": 32}, "MoE_L3_bwd":{"total": 421.13, "avg": 13.16, "max": 12.11, "min": 14.21, "cnt": 32}, "MoE_L2_bwd":{"total": 359.15, "avg": 11.22, "max": 10.40, "min": 11.97, "cnt": 32}, "MoE_L1_bwd":{"total": 299.78, "avg": 9.37, "max": 8.56, "min": 10.00, "cnt": 32}, "MoE_L0_bwd":{"total": 356.04, "avg": 11.13, "max": 10.46, "min": 13.55, "cnt": 32}, "backward-send-forward-recv":{"total": 4161.15, "avg": 143.49, "max": 2.25, "min": 470.28, "cnt": 29}, "backward-send":{"total": 2.60, "avg": 0.87, "max": 0.46, "min": 1.17, "cnt": 3}, "backward-recv":{"total": 155.52, "avg": 77.76, "max": 71.92, "min": 83.60, "cnt": 2}, "backward-params-all-reduce":{"total": 491.60, "avg": 491.60, "max": 491.60, "min": 491.60, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 245.90, "avg": 245.90, "max": 245.90, "min": 245.90, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.36, "avg": 3.36, "max": 3.36, "min": 3.36, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 205.88, "avg": 205.88, "max": 205.88, "min": 205.88, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.48, "avg": 3.48, "max": 3.48, "min": 3.48, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 71, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 88.73, "avg": 29.58, "max": 3.10, "min": 75.46, "cnt": 3}, "forward-compute":{"total": 1800.72, "avg": 56.27, "max": 50.44, "min": 67.33, "cnt": 32}, "fwd-compute":{"total": 1797.76, "avg": 56.18, "max": 50.37, "min": 67.23, "cnt": 32}, "batch-generator":{"total": 46.83, "avg": 1.46, "max": 0.73, "min": 3.27, "cnt": 32}, "fwd-embedding":{"total": 0.57, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1738.94, "avg": 54.34, "max": 49.33, "min": 63.58, "cnt": 32}, "fwd-layernorm":{"total": 9.49, "avg": 0.07, "max": 0.05, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 106.60, "avg": 0.83, "max": 0.74, "min": 2.32, "cnt": 128}, "fwd-misc":{"total": 20.27, "avg": 0.16, "max": 0.11, "min": 0.42, "cnt": 128}, "fwd-MLP":{"total": 1582.04, "avg": 12.36, "max": 9.76, "min": 20.15, "cnt": 128}, "MoE_L0_fwd":{"total": 474.99, "avg": 14.84, "max": 11.25, "min": 20.08, "cnt": 32}, "MoEMLP":{"total": 1565.64, "avg": 12.23, "max": 9.65, "min": 20.03, "cnt": 128}, "MoE_L1_fwd":{"total": 357.68, "avg": 11.18, "max": 9.69, "min": 14.63, "cnt": 32}, "MoE_L2_fwd":{"total": 358.35, "avg": 11.20, "max": 10.31, "min": 15.23, "cnt": 32}, "MoE_L3_fwd":{"total": 380.66, "avg": 11.90, "max": 11.21, "min": 13.87, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.96, "avg": 0.98, "max": 0.94, "min": 1.02, "cnt": 2}, "forward-send-backward-recv":{"total": 202.17, "avg": 6.74, "max": 1.12, "min": 112.00, "cnt": 30}, "backward-compute":{"total": 1651.22, "avg": 51.60, "max": 48.65, "min": 54.22, "cnt": 32}, "MoE_L3_bwd":{"total": 428.84, "avg": 13.40, "max": 12.40, "min": 15.20, "cnt": 32}, "MoE_L2_bwd":{"total": 359.32, "avg": 11.23, "max": 10.42, "min": 11.92, "cnt": 32}, "MoE_L1_bwd":{"total": 296.74, "avg": 9.27, "max": 8.23, "min": 10.00, "cnt": 32}, "MoE_L0_bwd":{"total": 349.90, "avg": 10.93, "max": 10.58, "min": 11.50, "cnt": 32}, "backward-send-forward-recv":{"total": 5684.70, "avg": 196.02, "max": 1.85, "min": 942.95, "cnt": 29}, "backward-send":{"total": 1.71, "avg": 0.57, "max": 0.44, "min": 0.65, "cnt": 3}, "backward-recv":{"total": 131.59, "avg": 65.79, "max": 59.17, "min": 72.42, "cnt": 2}, "backward-params-all-reduce":{"total": 488.07, "avg": 488.07, "max": 488.07, "min": 488.07, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 244.90, "avg": 244.90, "max": 244.90, "min": 244.90, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.36, "avg": 3.36, "max": 3.36, "min": 3.36, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 205.05, "avg": 205.05, "max": 205.05, "min": 205.05, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.21, "avg": 3.21, "max": 3.21, "min": 3.21, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.50, "avg": 3.50, "max": 3.50, "min": 3.50, "cnt": 1}}}
{"type":"time", "iteration": 72, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.13, "avg": 0.13, "max": 0.13, "min": 0.13, "cnt": 1}, "forward-recv":{"total": 71.78, "avg": 23.93, "max": 1.72, "min": 64.99, "cnt": 3}, "forward-compute":{"total": 1825.15, "avg": 57.04, "max": 52.76, "min": 66.62, "cnt": 32}, "fwd-compute":{"total": 1821.84, "avg": 56.93, "max": 52.68, "min": 66.52, "cnt": 32}, "batch-generator":{"total": 42.76, "avg": 1.34, "max": 0.67, "min": 2.78, "cnt": 32}, "fwd-embedding":{"total": 0.64, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1766.28, "avg": 55.20, "max": 51.01, "min": 63.35, "cnt": 32}, "fwd-layernorm":{"total": 9.89, "avg": 0.08, "max": 0.05, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 111.19, "avg": 0.87, "max": 0.74, "min": 1.49, "cnt": 128}, "fwd-misc":{"total": 21.16, "avg": 0.17, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1602.91, "avg": 12.52, "max": 9.80, "min": 23.15, "cnt": 128}, "MoE_L0_fwd":{"total": 507.10, "avg": 15.85, "max": 12.59, "min": 23.07, "cnt": 32}, "MoEMLP":{"total": 1585.98, "avg": 12.39, "max": 9.67, "min": 23.02, "cnt": 128}, "MoE_L1_fwd":{"total": 357.35, "avg": 11.17, "max": 9.72, "min": 14.55, "cnt": 32}, "MoE_L2_fwd":{"total": 345.66, "avg": 10.80, "max": 10.27, "min": 11.51, "cnt": 32}, "MoE_L3_fwd":{"total": 381.96, "avg": 11.94, "max": 11.19, "min": 12.75, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.47, "avg": 0.73, "max": 0.69, "min": 0.78, "cnt": 2}, "forward-send-backward-recv":{"total": 191.23, "avg": 6.37, "max": 1.43, "min": 109.77, "cnt": 30}, "backward-compute":{"total": 1637.81, "avg": 51.18, "max": 47.96, "min": 55.41, "cnt": 32}, "MoE_L3_bwd":{"total": 429.71, "avg": 13.43, "max": 12.10, "min": 14.94, "cnt": 32}, "MoE_L2_bwd":{"total": 350.77, "avg": 10.96, "max": 10.49, "min": 11.39, "cnt": 32}, "MoE_L1_bwd":{"total": 292.15, "avg": 9.13, "max": 8.14, "min": 10.12, "cnt": 32}, "MoE_L0_bwd":{"total": 351.86, "avg": 11.00, "max": 10.42, "min": 14.95, "cnt": 32}, "backward-send-forward-recv":{"total": 5634.25, "avg": 194.28, "max": 1.41, "min": 808.41, "cnt": 29}, "backward-send":{"total": 1.52, "avg": 0.51, "max": 0.46, "min": 0.56, "cnt": 3}, "backward-recv":{"total": 144.74, "avg": 72.37, "max": 66.50, "min": 78.24, "cnt": 2}, "backward-params-all-reduce":{"total": 490.32, "avg": 490.32, "max": 490.32, "min": 490.32, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "optimizer":{"total": 239.04, "avg": 239.04, "max": 239.04, "min": 239.04, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 198.93, "avg": 198.93, "max": 198.93, "min": 198.93, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.36, "avg": 3.36, "max": 3.36, "min": 3.36, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 73, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 1265.10, "avg": 421.70, "max": 1.12, "min": 764.08, "cnt": 3}, "forward-compute":{"total": 1828.23, "avg": 57.13, "max": 51.92, "min": 62.85, "cnt": 32}, "fwd-compute":{"total": 1824.95, "avg": 57.03, "max": 51.84, "min": 62.67, "cnt": 32}, "batch-generator":{"total": 48.39, "avg": 1.51, "max": 0.74, "min": 4.37, "cnt": 32}, "fwd-embedding":{"total": 0.70, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1763.22, "avg": 55.10, "max": 50.70, "min": 59.36, "cnt": 32}, "fwd-layernorm":{"total": 9.93, "avg": 0.08, "max": 0.05, "min": 0.28, "cnt": 128}, "fwd-attn":{"total": 110.76, "avg": 0.87, "max": 0.74, "min": 2.39, "cnt": 128}, "fwd-misc":{"total": 21.18, "avg": 0.17, "max": 0.11, "min": 0.45, "cnt": 128}, "fwd-MLP":{"total": 1599.91, "avg": 12.50, "max": 10.08, "min": 20.12, "cnt": 128}, "MoE_L0_fwd":{"total": 494.06, "avg": 15.44, "max": 12.74, "min": 20.02, "cnt": 32}, "MoEMLP":{"total": 1582.80, "avg": 12.37, "max": 9.97, "min": 19.96, "cnt": 128}, "MoE_L1_fwd":{"total": 360.00, "avg": 11.25, "max": 10.40, "min": 12.38, "cnt": 32}, "MoE_L2_fwd":{"total": 341.37, "avg": 10.67, "max": 10.01, "min": 11.90, "cnt": 32}, "MoE_L3_fwd":{"total": 393.55, "avg": 12.30, "max": 11.70, "min": 14.09, "cnt": 32}, "fwd-pooler":{"total": 0.36, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.64, "avg": 0.02, "max": 0.02, "min": 0.07, "cnt": 32}, "forward-send":{"total": 4.51, "avg": 2.26, "max": 0.80, "min": 3.72, "cnt": 2}, "forward-send-backward-recv":{"total": 72.49, "avg": 2.42, "max": 1.05, "min": 10.11, "cnt": 30}, "backward-compute":{"total": 1654.12, "avg": 51.69, "max": 49.35, "min": 53.10, "cnt": 32}, "MoE_L3_bwd":{"total": 441.55, "avg": 13.80, "max": 12.71, "min": 14.78, "cnt": 32}, "MoE_L2_bwd":{"total": 341.25, "avg": 10.66, "max": 10.07, "min": 11.55, "cnt": 32}, "MoE_L1_bwd":{"total": 308.52, "avg": 9.64, "max": 8.73, "min": 12.75, "cnt": 32}, "MoE_L0_bwd":{"total": 349.27, "avg": 10.91, "max": 10.33, "min": 11.71, "cnt": 32}, "backward-send-forward-recv":{"total": 4578.92, "avg": 157.89, "max": 2.26, "min": 879.14, "cnt": 29}, "backward-send":{"total": 2.86, "avg": 0.95, "max": 0.71, "min": 1.18, "cnt": 3}, "backward-recv":{"total": 131.09, "avg": 65.55, "max": 59.53, "min": 71.56, "cnt": 2}, "backward-params-all-reduce":{"total": 484.46, "avg": 484.46, "max": 484.46, "min": 484.46, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.04, "avg": 0.04, "max": 0.04, "min": 0.04, "cnt": 1}, "optimizer":{"total": 240.10, "avg": 240.10, "max": 240.10, "min": 240.10, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 200.23, "avg": 200.23, "max": 200.23, "min": 200.23, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.24, "avg": 3.24, "max": 3.24, "min": 3.24, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.47, "avg": 3.47, "max": 3.47, "min": 3.47, "cnt": 1}}}
{"type":"time", "iteration": 74, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 74.30, "avg": 24.77, "max": 1.07, "min": 71.94, "cnt": 3}, "forward-compute":{"total": 1803.83, "avg": 56.37, "max": 49.78, "min": 62.18, "cnt": 32}, "fwd-compute":{"total": 1800.66, "avg": 56.27, "max": 49.71, "min": 62.10, "cnt": 32}, "batch-generator":{"total": 46.12, "avg": 1.44, "max": 0.70, "min": 4.77, "cnt": 32}, "fwd-embedding":{"total": 0.66, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1741.81, "avg": 54.43, "max": 48.69, "min": 60.86, "cnt": 32}, "fwd-layernorm":{"total": 9.95, "avg": 0.08, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 109.28, "avg": 0.85, "max": 0.74, "min": 1.55, "cnt": 128}, "fwd-misc":{"total": 21.38, "avg": 0.17, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1579.66, "avg": 12.34, "max": 9.69, "min": 20.95, "cnt": 128}, "MoE_L0_fwd":{"total": 490.24, "avg": 15.32, "max": 11.67, "min": 20.87, "cnt": 32}, "MoEMLP":{"total": 1562.29, "avg": 12.21, "max": 9.57, "min": 20.83, "cnt": 128}, "MoE_L1_fwd":{"total": 362.36, "avg": 11.32, "max": 10.31, "min": 13.95, "cnt": 32}, "MoE_L2_fwd":{"total": 327.37, "avg": 10.23, "max": 9.62, "min": 15.13, "cnt": 32}, "MoE_L3_fwd":{"total": 388.59, "avg": 12.14, "max": 11.71, "min": 12.79, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.90, "avg": 0.95, "max": 0.88, "min": 1.02, "cnt": 2}, "forward-send-backward-recv":{"total": 434.38, "avg": 14.48, "max": 0.98, "min": 123.23, "cnt": 30}, "backward-compute":{"total": 1654.84, "avg": 51.71, "max": 48.79, "min": 55.05, "cnt": 32}, "MoE_L3_bwd":{"total": 452.51, "avg": 14.14, "max": 13.42, "min": 16.30, "cnt": 32}, "MoE_L2_bwd":{"total": 322.63, "avg": 10.08, "max": 9.34, "min": 11.24, "cnt": 32}, "MoE_L1_bwd":{"total": 308.95, "avg": 9.65, "max": 8.98, "min": 11.69, "cnt": 32}, "MoE_L0_bwd":{"total": 355.35, "avg": 11.10, "max": 10.34, "min": 13.42, "cnt": 32}, "backward-send-forward-recv":{"total": 4677.71, "avg": 161.30, "max": 2.36, "min": 918.25, "cnt": 29}, "backward-send":{"total": 1.81, "avg": 0.60, "max": 0.43, "min": 0.92, "cnt": 3}, "backward-recv":{"total": 269.83, "avg": 134.91, "max": 78.47, "min": 191.36, "cnt": 2}, "backward-params-all-reduce":{"total": 486.98, "avg": 486.98, "max": 486.98, "min": 486.98, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 238.29, "avg": 238.29, "max": 238.29, "min": 238.29, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 198.45, "avg": 198.45, "max": 198.45, "min": 198.45, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.29, "avg": 3.29, "max": 3.29, "min": 3.29, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 75, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 73.96, "avg": 24.65, "max": 0.80, "min": 69.19, "cnt": 3}, "forward-compute":{"total": 1834.45, "avg": 57.33, "max": 50.75, "min": 134.65, "cnt": 32}, "fwd-compute":{"total": 1831.41, "avg": 57.23, "max": 50.66, "min": 134.57, "cnt": 32}, "batch-generator":{"total": 47.76, "avg": 1.49, "max": 0.71, "min": 3.29, "cnt": 32}, "fwd-embedding":{"total": 0.51, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1771.82, "avg": 55.37, "max": 48.68, "min": 133.26, "cnt": 32}, "fwd-layernorm":{"total": 9.02, "avg": 0.07, "max": 0.05, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 105.79, "avg": 0.83, "max": 0.74, "min": 1.44, "cnt": 128}, "fwd-misc":{"total": 19.82, "avg": 0.15, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1617.16, "avg": 12.63, "max": 9.39, "min": 96.76, "cnt": 128}, "MoE_L0_fwd":{"total": 539.82, "avg": 16.87, "max": 11.58, "min": 96.68, "cnt": 32}, "MoEMLP":{"total": 1601.07, "avg": 12.51, "max": 9.28, "min": 96.62, "cnt": 128}, "MoE_L1_fwd":{"total": 356.12, "avg": 11.13, "max": 10.08, "min": 13.14, "cnt": 32}, "MoE_L2_fwd":{"total": 317.22, "avg": 9.91, "max": 9.32, "min": 11.18, "cnt": 32}, "MoE_L3_fwd":{"total": 393.77, "avg": 12.31, "max": 11.81, "min": 14.96, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 7.67, "avg": 3.84, "max": 0.95, "min": 6.72, "cnt": 2}, "forward-send-backward-recv":{"total": 238.99, "avg": 7.97, "max": 1.66, "min": 134.88, "cnt": 30}, "backward-compute":{"total": 1653.53, "avg": 51.67, "max": 48.79, "min": 53.74, "cnt": 32}, "MoE_L3_bwd":{"total": 458.06, "avg": 14.31, "max": 13.11, "min": 15.93, "cnt": 32}, "MoE_L2_bwd":{"total": 308.31, "avg": 9.63, "max": 9.05, "min": 10.23, "cnt": 32}, "MoE_L1_bwd":{"total": 310.60, "avg": 9.71, "max": 9.11, "min": 11.59, "cnt": 32}, "MoE_L0_bwd":{"total": 365.27, "avg": 11.41, "max": 10.57, "min": 12.10, "cnt": 32}, "backward-send-forward-recv":{"total": 5255.09, "avg": 181.21, "max": 2.08, "min": 885.90, "cnt": 29}, "backward-send":{"total": 2.96, "avg": 0.99, "max": 0.84, "min": 1.10, "cnt": 3}, "backward-recv":{"total": 144.12, "avg": 72.06, "max": 68.18, "min": 75.94, "cnt": 2}, "backward-params-all-reduce":{"total": 488.52, "avg": 488.52, "max": 488.52, "min": 488.52, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 244.42, "avg": 244.42, "max": 244.42, "min": 244.42, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 199.31, "avg": 199.31, "max": 199.31, "min": 199.31, "cnt": 1}, "optimizer-clip-main-grad":{"total": 5.93, "avg": 5.93, "max": 5.93, "min": 5.93, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 76, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 92.28, "avg": 30.76, "max": 5.44, "min": 76.98, "cnt": 3}, "forward-compute":{"total": 1809.82, "avg": 56.56, "max": 51.03, "min": 63.34, "cnt": 32}, "fwd-compute":{"total": 1806.72, "avg": 56.46, "max": 50.96, "min": 63.25, "cnt": 32}, "batch-generator":{"total": 43.67, "avg": 1.36, "max": 0.71, "min": 3.03, "cnt": 32}, "fwd-embedding":{"total": 0.54, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1750.84, "avg": 54.71, "max": 49.72, "min": 61.72, "cnt": 32}, "fwd-layernorm":{"total": 9.23, "avg": 0.07, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 105.57, "avg": 0.82, "max": 0.74, "min": 2.26, "cnt": 128}, "fwd-misc":{"total": 20.60, "avg": 0.16, "max": 0.11, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1595.29, "avg": 12.46, "max": 9.30, "min": 19.66, "cnt": 128}, "MoE_L0_fwd":{"total": 484.46, "avg": 15.14, "max": 12.05, "min": 19.56, "cnt": 32}, "MoEMLP":{"total": 1578.79, "avg": 12.33, "max": 9.20, "min": 19.51, "cnt": 128}, "MoE_L1_fwd":{"total": 371.83, "avg": 11.62, "max": 10.45, "min": 14.30, "cnt": 32}, "MoE_L2_fwd":{"total": 322.59, "avg": 10.08, "max": 9.24, "min": 12.43, "cnt": 32}, "MoE_L3_fwd":{"total": 405.97, "avg": 12.69, "max": 12.21, "min": 14.06, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.70, "avg": 0.85, "max": 0.70, "min": 1.00, "cnt": 2}, "forward-send-backward-recv":{"total": 310.45, "avg": 10.35, "max": 1.68, "min": 113.97, "cnt": 30}, "backward-compute":{"total": 1668.42, "avg": 52.14, "max": 50.12, "min": 53.19, "cnt": 32}, "MoE_L3_bwd":{"total": 468.62, "avg": 14.64, "max": 13.88, "min": 15.59, "cnt": 32}, "MoE_L2_bwd":{"total": 300.76, "avg": 9.40, "max": 8.82, "min": 10.43, "cnt": 32}, "MoE_L1_bwd":{"total": 308.42, "avg": 9.64, "max": 9.10, "min": 10.06, "cnt": 32}, "MoE_L0_bwd":{"total": 375.75, "avg": 11.74, "max": 11.06, "min": 11.99, "cnt": 32}, "backward-send-forward-recv":{"total": 4856.04, "avg": 167.45, "max": 1.58, "min": 1358.29, "cnt": 29}, "backward-send":{"total": 2.92, "avg": 0.97, "max": 0.79, "min": 1.12, "cnt": 3}, "backward-recv":{"total": 141.73, "avg": 70.86, "max": 64.47, "min": 77.25, "cnt": 2}, "backward-params-all-reduce":{"total": 491.59, "avg": 491.59, "max": 491.59, "min": 491.59, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 243.81, "avg": 243.81, "max": 243.81, "min": 243.81, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.36, "avg": 3.36, "max": 3.36, "min": 3.36, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 203.90, "avg": 203.90, "max": 203.90, "min": 203.90, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}}}
{"type":"time", "iteration": 77, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 73.14, "avg": 24.38, "max": 0.76, "min": 70.48, "cnt": 3}, "forward-compute":{"total": 1799.56, "avg": 56.24, "max": 49.94, "min": 64.77, "cnt": 32}, "fwd-compute":{"total": 1796.46, "avg": 56.14, "max": 49.87, "min": 64.69, "cnt": 32}, "batch-generator":{"total": 45.90, "avg": 1.43, "max": 0.66, "min": 3.86, "cnt": 32}, "fwd-embedding":{"total": 0.59, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1737.97, "avg": 54.31, "max": 48.91, "min": 62.80, "cnt": 32}, "fwd-layernorm":{"total": 9.47, "avg": 0.07, "max": 0.05, "min": 0.23, "cnt": 128}, "fwd-attn":{"total": 107.14, "avg": 0.84, "max": 0.74, "min": 1.64, "cnt": 128}, "fwd-misc":{"total": 20.82, "avg": 0.16, "max": 0.11, "min": 0.42, "cnt": 128}, "fwd-MLP":{"total": 1579.65, "avg": 12.34, "max": 9.76, "min": 21.50, "cnt": 128}, "MoE_L0_fwd":{"total": 472.74, "avg": 14.77, "max": 11.30, "min": 21.34, "cnt": 32}, "MoEMLP":{"total": 1562.00, "avg": 12.20, "max": 9.65, "min": 21.29, "cnt": 128}, "MoE_L1_fwd":{"total": 368.88, "avg": 11.53, "max": 10.70, "min": 14.61, "cnt": 32}, "MoE_L2_fwd":{"total": 326.76, "avg": 10.21, "max": 9.69, "min": 10.82, "cnt": 32}, "MoE_L3_fwd":{"total": 399.68, "avg": 12.49, "max": 12.00, "min": 13.24, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 2.70, "avg": 1.35, "max": 0.86, "min": 1.83, "cnt": 2}, "forward-send-backward-recv":{"total": 218.86, "avg": 7.30, "max": 1.31, "min": 121.84, "cnt": 30}, "backward-compute":{"total": 1663.01, "avg": 51.97, "max": 49.32, "min": 55.41, "cnt": 32}, "MoE_L3_bwd":{"total": 449.92, "avg": 14.06, "max": 13.27, "min": 15.95, "cnt": 32}, "MoE_L2_bwd":{"total": 305.94, "avg": 9.56, "max": 8.70, "min": 12.18, "cnt": 32}, "MoE_L1_bwd":{"total": 314.45, "avg": 9.83, "max": 9.29, "min": 10.85, "cnt": 32}, "MoE_L0_bwd":{"total": 380.07, "avg": 11.88, "max": 11.13, "min": 12.64, "cnt": 32}, "backward-send-forward-recv":{"total": 6198.03, "avg": 213.73, "max": 2.29, "min": 1975.20, "cnt": 29}, "backward-send":{"total": 3.04, "avg": 1.01, "max": 0.89, "min": 1.21, "cnt": 3}, "backward-recv":{"total": 169.37, "avg": 84.68, "max": 74.88, "min": 94.49, "cnt": 2}, "backward-params-all-reduce":{"total": 485.57, "avg": 485.57, "max": 485.57, "min": 485.57, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 245.24, "avg": 245.24, "max": 245.24, "min": 245.24, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 205.46, "avg": 205.46, "max": 205.46, "min": 205.46, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.30, "avg": 3.30, "max": 3.30, "min": 3.30, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 78, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 76.37, "avg": 25.46, "max": 0.83, "min": 74.13, "cnt": 3}, "forward-compute":{"total": 1806.55, "avg": 56.45, "max": 51.02, "min": 63.38, "cnt": 32}, "fwd-compute":{"total": 1803.56, "avg": 56.36, "max": 50.93, "min": 63.29, "cnt": 32}, "batch-generator":{"total": 42.61, "avg": 1.33, "max": 0.69, "min": 2.60, "cnt": 32}, "fwd-embedding":{"total": 0.57, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1748.45, "avg": 54.64, "max": 49.76, "min": 61.59, "cnt": 32}, "fwd-layernorm":{"total": 9.51, "avg": 0.07, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 107.44, "avg": 0.84, "max": 0.74, "min": 2.34, "cnt": 128}, "fwd-misc":{"total": 20.85, "avg": 0.16, "max": 0.11, "min": 0.39, "cnt": 128}, "fwd-MLP":{"total": 1589.51, "avg": 12.42, "max": 9.45, "min": 18.21, "cnt": 128}, "MoE_L0_fwd":{"total": 470.43, "avg": 14.70, "max": 11.41, "min": 18.13, "cnt": 32}, "MoEMLP":{"total": 1572.54, "avg": 12.29, "max": 9.35, "min": 18.06, "cnt": 128}, "MoE_L1_fwd":{"total": 371.71, "avg": 11.62, "max": 10.79, "min": 12.51, "cnt": 32}, "MoE_L2_fwd":{"total": 332.85, "avg": 10.40, "max": 9.39, "min": 13.98, "cnt": 32}, "MoE_L3_fwd":{"total": 403.77, "avg": 12.62, "max": 12.12, "min": 14.26, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 6.54, "avg": 3.27, "max": 0.84, "min": 5.70, "cnt": 2}, "forward-send-backward-recv":{"total": 852.36, "avg": 28.41, "max": 1.26, "min": 177.69, "cnt": 30}, "backward-compute":{"total": 1672.66, "avg": 52.27, "max": 48.63, "min": 56.32, "cnt": 32}, "MoE_L3_bwd":{"total": 444.99, "avg": 13.91, "max": 12.45, "min": 16.20, "cnt": 32}, "MoE_L2_bwd":{"total": 308.39, "avg": 9.64, "max": 9.16, "min": 10.45, "cnt": 32}, "MoE_L1_bwd":{"total": 321.36, "avg": 10.04, "max": 9.55, "min": 11.12, "cnt": 32}, "MoE_L0_bwd":{"total": 377.63, "avg": 11.80, "max": 10.87, "min": 12.17, "cnt": 32}, "backward-send-forward-recv":{"total": 3171.74, "avg": 109.37, "max": 2.31, "min": 413.12, "cnt": 29}, "backward-send":{"total": 2.63, "avg": 0.88, "max": 0.75, "min": 0.95, "cnt": 3}, "backward-recv":{"total": 471.12, "avg": 235.56, "max": 74.57, "min": 396.55, "cnt": 2}, "backward-params-all-reduce":{"total": 486.99, "avg": 486.99, "max": 486.99, "min": 486.99, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 242.50, "avg": 242.50, "max": 242.50, "min": 242.50, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 199.14, "avg": 199.14, "max": 199.14, "min": 199.14, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.09, "avg": 6.09, "max": 6.09, "min": 6.09, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}}}
{"type":"time", "iteration": 79, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 70.05, "avg": 23.35, "max": 0.77, "min": 68.27, "cnt": 3}, "forward-compute":{"total": 1853.60, "avg": 57.92, "max": 50.44, "min": 64.67, "cnt": 32}, "fwd-compute":{"total": 1850.27, "avg": 57.82, "max": 50.38, "min": 64.34, "cnt": 32}, "batch-generator":{"total": 48.66, "avg": 1.52, "max": 0.69, "min": 3.76, "cnt": 32}, "fwd-embedding":{"total": 0.61, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1789.26, "avg": 55.91, "max": 49.39, "min": 61.92, "cnt": 32}, "fwd-layernorm":{"total": 9.61, "avg": 0.08, "max": 0.05, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 108.93, "avg": 0.85, "max": 0.74, "min": 1.78, "cnt": 128}, "fwd-misc":{"total": 20.46, "avg": 0.16, "max": 0.11, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1629.60, "avg": 12.73, "max": 9.42, "min": 20.11, "cnt": 128}, "MoE_L0_fwd":{"total": 496.82, "avg": 15.53, "max": 11.70, "min": 20.03, "cnt": 32}, "MoEMLP":{"total": 1613.02, "avg": 12.60, "max": 9.31, "min": 19.98, "cnt": 128}, "MoE_L1_fwd":{"total": 378.23, "avg": 11.82, "max": 10.85, "min": 14.12, "cnt": 32}, "MoE_L2_fwd":{"total": 334.68, "avg": 10.46, "max": 9.35, "min": 14.61, "cnt": 32}, "MoE_L3_fwd":{"total": 409.44, "avg": 12.80, "max": 11.98, "min": 15.68, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 12.05, "avg": 6.02, "max": 0.89, "min": 11.16, "cnt": 2}, "forward-send-backward-recv":{"total": 506.56, "avg": 16.89, "max": 1.66, "min": 128.27, "cnt": 30}, "backward-compute":{"total": 1695.12, "avg": 52.97, "max": 51.39, "min": 56.62, "cnt": 32}, "MoE_L3_bwd":{"total": 451.25, "avg": 14.10, "max": 13.19, "min": 14.87, "cnt": 32}, "MoE_L2_bwd":{"total": 315.95, "avg": 9.87, "max": 9.31, "min": 10.79, "cnt": 32}, "MoE_L1_bwd":{"total": 329.09, "avg": 10.28, "max": 9.80, "min": 12.84, "cnt": 32}, "MoE_L0_bwd":{"total": 382.57, "avg": 11.96, "max": 11.20, "min": 13.21, "cnt": 32}, "backward-send-forward-recv":{"total": 4171.05, "avg": 143.83, "max": 1.75, "min": 672.90, "cnt": 29}, "backward-send":{"total": 2.46, "avg": 0.82, "max": 0.48, "min": 1.08, "cnt": 3}, "backward-recv":{"total": 525.20, "avg": 262.60, "max": 115.24, "min": 409.96, "cnt": 2}, "backward-params-all-reduce":{"total": 485.25, "avg": 485.25, "max": 485.25, "min": 485.25, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.04, "avg": 0.04, "max": 0.04, "min": 0.04, "cnt": 1}, "optimizer":{"total": 241.48, "avg": 241.48, "max": 241.48, "min": 241.48, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 201.53, "avg": 201.53, "max": 201.53, "min": 201.53, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.30, "avg": 3.30, "max": 3.30, "min": 3.30, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 80, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 69.93, "avg": 23.31, "max": 0.97, "min": 67.91, "cnt": 3}, "forward-compute":{"total": 1852.52, "avg": 57.89, "max": 50.43, "min": 65.33, "cnt": 32}, "fwd-compute":{"total": 1849.44, "avg": 57.79, "max": 50.36, "min": 65.24, "cnt": 32}, "batch-generator":{"total": 65.23, "avg": 2.04, "max": 0.68, "min": 4.90, "cnt": 32}, "fwd-embedding":{"total": 0.66, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1771.52, "avg": 55.36, "max": 49.39, "min": 60.13, "cnt": 32}, "fwd-layernorm":{"total": 9.96, "avg": 0.08, "max": 0.05, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 109.78, "avg": 0.86, "max": 0.74, "min": 1.53, "cnt": 128}, "fwd-misc":{"total": 21.18, "avg": 0.17, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1609.64, "avg": 12.58, "max": 9.66, "min": 19.43, "cnt": 128}, "MoE_L0_fwd":{"total": 474.05, "avg": 14.81, "max": 11.57, "min": 19.34, "cnt": 32}, "MoEMLP":{"total": 1592.73, "avg": 12.44, "max": 9.54, "min": 19.30, "cnt": 128}, "MoE_L1_fwd":{"total": 382.95, "avg": 11.97, "max": 10.94, "min": 14.71, "cnt": 32}, "MoE_L2_fwd":{"total": 340.68, "avg": 10.65, "max": 9.59, "min": 14.69, "cnt": 32}, "MoE_L3_fwd":{"total": 401.30, "avg": 12.54, "max": 12.12, "min": 13.68, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.84, "avg": 0.92, "max": 0.82, "min": 1.01, "cnt": 2}, "forward-send-backward-recv":{"total": 227.70, "avg": 7.59, "max": 1.06, "min": 133.08, "cnt": 30}, "backward-compute":{"total": 1705.74, "avg": 53.30, "max": 50.98, "min": 54.68, "cnt": 32}, "MoE_L3_bwd":{"total": 453.55, "avg": 14.17, "max": 13.38, "min": 15.65, "cnt": 32}, "MoE_L2_bwd":{"total": 325.03, "avg": 10.16, "max": 9.07, "min": 11.72, "cnt": 32}, "MoE_L1_bwd":{"total": 332.49, "avg": 10.39, "max": 9.78, "min": 10.77, "cnt": 32}, "MoE_L0_bwd":{"total": 380.08, "avg": 11.88, "max": 11.31, "min": 12.47, "cnt": 32}, "backward-send-forward-recv":{"total": 3567.70, "avg": 123.02, "max": 1.06, "min": 408.60, "cnt": 29}, "backward-send":{"total": 2.95, "avg": 0.98, "max": 0.91, "min": 1.06, "cnt": 3}, "backward-recv":{"total": 138.37, "avg": 69.18, "max": 68.37, "min": 69.99, "cnt": 2}, "backward-params-all-reduce":{"total": 488.63, "avg": 488.63, "max": 488.63, "min": 488.63, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 236.71, "avg": 236.71, "max": 236.71, "min": 236.71, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 196.95, "avg": 196.95, "max": 196.95, "min": 196.95, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.26, "avg": 3.26, "max": 3.26, "min": 3.26, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}}}
{"type":"time", "iteration": 81, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 77.54, "avg": 25.85, "max": 1.17, "min": 73.87, "cnt": 3}, "forward-compute":{"total": 1860.55, "avg": 58.14, "max": 50.96, "min": 63.55, "cnt": 32}, "fwd-compute":{"total": 1857.19, "avg": 58.04, "max": 50.89, "min": 63.41, "cnt": 32}, "batch-generator":{"total": 50.25, "avg": 1.57, "max": 0.67, "min": 3.26, "cnt": 32}, "fwd-embedding":{"total": 0.66, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1794.13, "avg": 56.07, "max": 49.93, "min": 61.33, "cnt": 32}, "fwd-layernorm":{"total": 9.99, "avg": 0.08, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 109.15, "avg": 0.85, "max": 0.74, "min": 1.56, "cnt": 128}, "fwd-misc":{"total": 21.40, "avg": 0.17, "max": 0.11, "min": 0.34, "cnt": 128}, "fwd-MLP":{"total": 1632.15, "avg": 12.75, "max": 10.28, "min": 19.28, "cnt": 128}, "MoE_L0_fwd":{"total": 485.23, "avg": 15.16, "max": 11.31, "min": 19.19, "cnt": 32}, "MoEMLP":{"total": 1614.97, "avg": 12.62, "max": 10.17, "min": 19.14, "cnt": 128}, "MoE_L1_fwd":{"total": 394.29, "avg": 12.32, "max": 11.00, "min": 15.90, "cnt": 32}, "MoE_L2_fwd":{"total": 343.22, "avg": 10.73, "max": 10.21, "min": 12.61, "cnt": 32}, "MoE_L3_fwd":{"total": 398.62, "avg": 12.46, "max": 11.83, "min": 15.90, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.61, "avg": 0.02, "max": 0.02, "min": 0.04, "cnt": 32}, "forward-send":{"total": 1.88, "avg": 0.94, "max": 0.88, "min": 1.00, "cnt": 2}, "forward-send-backward-recv":{"total": 750.58, "avg": 25.02, "max": 1.26, "min": 236.58, "cnt": 30}, "backward-compute":{"total": 1749.43, "avg": 54.67, "max": 51.64, "min": 57.85, "cnt": 32}, "MoE_L3_bwd":{"total": 452.75, "avg": 14.15, "max": 13.05, "min": 16.97, "cnt": 32}, "MoE_L2_bwd":{"total": 355.02, "avg": 11.09, "max": 10.14, "min": 14.10, "cnt": 32}, "MoE_L1_bwd":{"total": 347.25, "avg": 10.85, "max": 10.16, "min": 11.27, "cnt": 32}, "MoE_L0_bwd":{"total": 380.93, "avg": 11.90, "max": 11.15, "min": 12.45, "cnt": 32}, "backward-send-forward-recv":{"total": 4188.25, "avg": 144.42, "max": 2.14, "min": 938.68, "cnt": 29}, "backward-send":{"total": 2.66, "avg": 0.89, "max": 0.47, "min": 1.30, "cnt": 3}, "backward-recv":{"total": 239.92, "avg": 119.96, "max": 69.65, "min": 170.27, "cnt": 2}, "backward-params-all-reduce":{"total": 484.65, "avg": 484.65, "max": 484.65, "min": 484.65, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 238.29, "avg": 238.29, "max": 238.29, "min": 238.29, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 198.42, "avg": 198.42, "max": 198.42, "min": 198.42, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.40, "avg": 3.40, "max": 3.40, "min": 3.40, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.41, "avg": 3.41, "max": 3.41, "min": 3.41, "cnt": 1}}}
{"type":"time", "iteration": 82, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.13, "avg": 0.13, "max": 0.13, "min": 0.13, "cnt": 1}, "forward-recv":{"total": 80.48, "avg": 26.83, "max": 0.92, "min": 69.47, "cnt": 3}, "forward-compute":{"total": 1830.26, "avg": 57.20, "max": 51.33, "min": 64.06, "cnt": 32}, "fwd-compute":{"total": 1827.21, "avg": 57.10, "max": 51.24, "min": 63.98, "cnt": 32}, "batch-generator":{"total": 47.83, "avg": 1.49, "max": 0.64, "min": 3.12, "cnt": 32}, "fwd-embedding":{"total": 0.65, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1766.66, "avg": 55.21, "max": 50.17, "min": 62.57, "cnt": 32}, "fwd-layernorm":{"total": 9.78, "avg": 0.08, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 108.71, "avg": 0.85, "max": 0.74, "min": 1.54, "cnt": 128}, "fwd-misc":{"total": 21.44, "avg": 0.17, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1605.18, "avg": 12.54, "max": 10.11, "min": 20.68, "cnt": 128}, "MoE_L0_fwd":{"total": 466.18, "avg": 14.57, "max": 11.68, "min": 20.54, "cnt": 32}, "MoEMLP":{"total": 1587.68, "avg": 12.40, "max": 9.99, "min": 20.46, "cnt": 128}, "MoE_L1_fwd":{"total": 376.12, "avg": 11.75, "max": 10.80, "min": 14.64, "cnt": 32}, "MoE_L2_fwd":{"total": 346.73, "avg": 10.84, "max": 10.04, "min": 13.88, "cnt": 32}, "MoE_L3_fwd":{"total": 404.94, "avg": 12.65, "max": 12.12, "min": 14.19, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.80, "avg": 0.90, "max": 0.87, "min": 0.93, "cnt": 2}, "forward-send-backward-recv":{"total": 203.38, "avg": 6.78, "max": 1.30, "min": 133.41, "cnt": 30}, "backward-compute":{"total": 1736.46, "avg": 54.26, "max": 50.88, "min": 58.00, "cnt": 32}, "MoE_L3_bwd":{"total": 450.64, "avg": 14.08, "max": 13.10, "min": 16.73, "cnt": 32}, "MoE_L2_bwd":{"total": 350.07, "avg": 10.94, "max": 9.84, "min": 12.17, "cnt": 32}, "MoE_L1_bwd":{"total": 340.03, "avg": 10.63, "max": 10.01, "min": 10.93, "cnt": 32}, "MoE_L0_bwd":{"total": 379.28, "avg": 11.85, "max": 11.36, "min": 12.08, "cnt": 32}, "backward-send-forward-recv":{"total": 2822.31, "avg": 97.32, "max": 2.41, "min": 415.64, "cnt": 29}, "backward-send":{"total": 2.64, "avg": 0.88, "max": 0.82, "min": 0.97, "cnt": 3}, "backward-recv":{"total": 184.97, "avg": 92.48, "max": 59.81, "min": 125.16, "cnt": 2}, "backward-params-all-reduce":{"total": 486.18, "avg": 486.18, "max": 486.18, "min": 486.18, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "optimizer":{"total": 240.90, "avg": 240.90, "max": 240.90, "min": 240.90, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.40, "avg": 3.40, "max": 3.40, "min": 3.40, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 200.81, "avg": 200.81, "max": 200.81, "min": 200.81, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.35, "avg": 3.35, "max": 3.35, "min": 3.35, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 83, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 77.14, "avg": 25.71, "max": 1.24, "min": 68.38, "cnt": 3}, "forward-compute":{"total": 1928.65, "avg": 60.27, "max": 51.37, "min": 119.25, "cnt": 32}, "fwd-compute":{"total": 1925.44, "avg": 60.17, "max": 51.30, "min": 119.12, "cnt": 32}, "batch-generator":{"total": 46.76, "avg": 1.46, "max": 0.65, "min": 3.62, "cnt": 32}, "fwd-embedding":{"total": 0.56, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1866.08, "avg": 58.31, "max": 50.29, "min": 117.09, "cnt": 32}, "fwd-layernorm":{"total": 9.29, "avg": 0.07, "max": 0.05, "min": 0.18, "cnt": 128}, "fwd-attn":{"total": 105.51, "avg": 0.82, "max": 0.74, "min": 1.51, "cnt": 128}, "fwd-misc":{"total": 20.17, "avg": 0.16, "max": 0.11, "min": 0.34, "cnt": 128}, "fwd-MLP":{"total": 1710.88, "avg": 13.37, "max": 10.55, "min": 77.35, "cnt": 128}, "MoE_L0_fwd":{"total": 553.04, "avg": 17.28, "max": 11.52, "min": 77.18, "cnt": 32}, "MoEMLP":{"total": 1694.52, "avg": 13.24, "max": 10.44, "min": 77.10, "cnt": 128}, "MoE_L1_fwd":{"total": 380.45, "avg": 11.89, "max": 10.71, "min": 16.33, "cnt": 32}, "MoE_L2_fwd":{"total": 359.99, "avg": 11.25, "max": 10.48, "min": 16.08, "cnt": 32}, "MoE_L3_fwd":{"total": 407.05, "avg": 12.72, "max": 11.99, "min": 17.90, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.62, "avg": 0.02, "max": 0.02, "min": 0.05, "cnt": 32}, "forward-send":{"total": 5.06, "avg": 2.53, "max": 1.08, "min": 3.98, "cnt": 2}, "forward-send-backward-recv":{"total": 181.74, "avg": 6.06, "max": 1.34, "min": 112.88, "cnt": 30}, "backward-compute":{"total": 1756.59, "avg": 54.89, "max": 51.80, "min": 59.05, "cnt": 32}, "MoE_L3_bwd":{"total": 455.00, "avg": 14.22, "max": 13.07, "min": 17.00, "cnt": 32}, "MoE_L2_bwd":{"total": 366.19, "avg": 11.44, "max": 10.05, "min": 13.89, "cnt": 32}, "MoE_L1_bwd":{"total": 337.86, "avg": 10.56, "max": 10.20, "min": 11.40, "cnt": 32}, "MoE_L0_bwd":{"total": 382.71, "avg": 11.96, "max": 11.49, "min": 13.24, "cnt": 32}, "backward-send-forward-recv":{"total": 2864.92, "avg": 98.79, "max": 0.99, "min": 305.95, "cnt": 29}, "backward-send":{"total": 2.79, "avg": 0.93, "max": 0.75, "min": 1.03, "cnt": 3}, "backward-recv":{"total": 127.68, "avg": 63.84, "max": 63.65, "min": 64.03, "cnt": 2}, "backward-params-all-reduce":{"total": 486.26, "avg": 486.26, "max": 486.26, "min": 486.26, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 241.04, "avg": 241.04, "max": 241.04, "min": 241.04, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 200.78, "avg": 200.78, "max": 200.78, "min": 200.78, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.58, "avg": 3.58, "max": 3.58, "min": 3.58, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 84, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 75.52, "avg": 25.17, "max": 1.10, "min": 73.26, "cnt": 3}, "forward-compute":{"total": 1835.46, "avg": 57.36, "max": 52.10, "min": 62.50, "cnt": 32}, "fwd-compute":{"total": 1832.45, "avg": 57.26, "max": 51.99, "min": 62.42, "cnt": 32}, "batch-generator":{"total": 44.71, "avg": 1.40, "max": 0.69, "min": 2.83, "cnt": 32}, "fwd-embedding":{"total": 0.61, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1775.27, "avg": 55.48, "max": 50.54, "min": 61.03, "cnt": 32}, "fwd-layernorm":{"total": 9.62, "avg": 0.08, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 110.08, "avg": 0.86, "max": 0.74, "min": 1.82, "cnt": 128}, "fwd-misc":{"total": 20.22, "avg": 0.16, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1614.51, "avg": 12.61, "max": 10.99, "min": 20.83, "cnt": 128}, "MoE_L0_fwd":{"total": 476.62, "avg": 14.89, "max": 11.60, "min": 20.75, "cnt": 32}, "MoEMLP":{"total": 1597.98, "avg": 12.48, "max": 10.87, "min": 20.70, "cnt": 128}, "MoE_L1_fwd":{"total": 375.76, "avg": 11.74, "max": 10.91, "min": 13.13, "cnt": 32}, "MoE_L2_fwd":{"total": 364.37, "avg": 11.39, "max": 10.98, "min": 12.41, "cnt": 32}, "MoE_L3_fwd":{"total": 387.31, "avg": 12.10, "max": 11.46, "min": 13.29, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.54, "avg": 0.77, "max": 0.70, "min": 0.84, "cnt": 2}, "forward-send-backward-recv":{"total": 551.84, "avg": 18.39, "max": 1.83, "min": 130.04, "cnt": 30}, "backward-compute":{"total": 1751.52, "avg": 54.73, "max": 52.16, "min": 56.33, "cnt": 32}, "MoE_L3_bwd":{"total": 435.49, "avg": 13.61, "max": 12.45, "min": 14.51, "cnt": 32}, "MoE_L2_bwd":{"total": 381.31, "avg": 11.92, "max": 11.00, "min": 13.05, "cnt": 32}, "MoE_L1_bwd":{"total": 346.10, "avg": 10.82, "max": 10.22, "min": 12.20, "cnt": 32}, "MoE_L0_bwd":{"total": 374.53, "avg": 11.70, "max": 11.02, "min": 12.00, "cnt": 32}, "backward-send-forward-recv":{"total": 3691.77, "avg": 127.30, "max": 2.49, "min": 439.81, "cnt": 29}, "backward-send":{"total": 2.49, "avg": 0.83, "max": 0.67, "min": 1.10, "cnt": 3}, "backward-recv":{"total": 139.44, "avg": 69.72, "max": 64.63, "min": 74.81, "cnt": 2}, "backward-params-all-reduce":{"total": 490.75, "avg": 490.75, "max": 490.75, "min": 490.75, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 239.98, "avg": 239.98, "max": 239.98, "min": 239.98, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 200.20, "avg": 200.20, "max": 200.20, "min": 200.20, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.24, "avg": 3.24, "max": 3.24, "min": 3.24, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 85, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 73.57, "avg": 24.52, "max": 0.77, "min": 71.07, "cnt": 3}, "forward-compute":{"total": 1831.20, "avg": 57.23, "max": 51.06, "min": 64.77, "cnt": 32}, "fwd-compute":{"total": 1827.87, "avg": 57.12, "max": 50.98, "min": 64.41, "cnt": 32}, "batch-generator":{"total": 66.46, "avg": 2.08, "max": 0.71, "min": 5.26, "cnt": 32}, "fwd-embedding":{"total": 0.73, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1748.48, "avg": 54.64, "max": 49.74, "min": 61.26, "cnt": 32}, "fwd-layernorm":{"total": 10.45, "avg": 0.08, "max": 0.05, "min": 0.27, "cnt": 128}, "fwd-attn":{"total": 112.89, "avg": 0.88, "max": 0.74, "min": 2.48, "cnt": 128}, "fwd-misc":{"total": 22.33, "avg": 0.17, "max": 0.12, "min": 0.44, "cnt": 128}, "fwd-MLP":{"total": 1580.92, "avg": 12.35, "max": 10.94, "min": 18.07, "cnt": 128}, "MoE_L0_fwd":{"total": 440.37, "avg": 13.76, "max": 11.41, "min": 17.98, "cnt": 32}, "MoEMLP":{"total": 1563.33, "avg": 12.21, "max": 10.83, "min": 17.94, "cnt": 128}, "MoE_L1_fwd":{"total": 380.04, "avg": 11.88, "max": 10.91, "min": 14.74, "cnt": 32}, "MoE_L2_fwd":{"total": 366.56, "avg": 11.45, "max": 10.87, "min": 14.57, "cnt": 32}, "MoE_L3_fwd":{"total": 382.86, "avg": 11.96, "max": 11.39, "min": 14.15, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.62, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 3.13, "avg": 1.57, "max": 1.01, "min": 2.12, "cnt": 2}, "forward-send-backward-recv":{"total": 220.52, "avg": 7.35, "max": 1.58, "min": 136.47, "cnt": 30}, "backward-compute":{"total": 1755.35, "avg": 54.85, "max": 52.66, "min": 58.95, "cnt": 32}, "MoE_L3_bwd":{"total": 435.58, "avg": 13.61, "max": 12.55, "min": 14.65, "cnt": 32}, "MoE_L2_bwd":{"total": 381.49, "avg": 11.92, "max": 10.69, "min": 12.88, "cnt": 32}, "MoE_L1_bwd":{"total": 351.55, "avg": 10.99, "max": 10.45, "min": 13.67, "cnt": 32}, "MoE_L0_bwd":{"total": 373.89, "avg": 11.68, "max": 11.30, "min": 12.38, "cnt": 32}, "backward-send-forward-recv":{"total": 3706.85, "avg": 127.82, "max": 2.27, "min": 354.14, "cnt": 29}, "backward-send":{"total": 3.49, "avg": 1.16, "max": 1.15, "min": 1.17, "cnt": 3}, "backward-recv":{"total": 130.62, "avg": 65.31, "max": 65.01, "min": 65.61, "cnt": 2}, "backward-params-all-reduce":{"total": 485.17, "avg": 485.17, "max": 485.17, "min": 485.17, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 242.37, "avg": 242.37, "max": 242.37, "min": 242.37, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 202.52, "avg": 202.52, "max": 202.52, "min": 202.52, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.25, "avg": 3.25, "max": 3.25, "min": 3.25, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.47, "avg": 3.47, "max": 3.47, "min": 3.47, "cnt": 1}}}
{"type":"time", "iteration": 86, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 496.72, "avg": 165.57, "max": 1.23, "min": 427.55, "cnt": 3}, "forward-compute":{"total": 1878.50, "avg": 58.70, "max": 51.25, "min": 65.43, "cnt": 32}, "fwd-compute":{"total": 1875.48, "avg": 58.61, "max": 51.18, "min": 65.35, "cnt": 32}, "batch-generator":{"total": 45.73, "avg": 1.43, "max": 0.73, "min": 3.40, "cnt": 32}, "fwd-embedding":{"total": 0.56, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1817.45, "avg": 56.80, "max": 49.79, "min": 64.05, "cnt": 32}, "fwd-layernorm":{"total": 9.15, "avg": 0.07, "max": 0.05, "min": 0.17, "cnt": 128}, "fwd-attn":{"total": 107.96, "avg": 0.84, "max": 0.74, "min": 3.48, "cnt": 128}, "fwd-misc":{"total": 20.62, "avg": 0.16, "max": 0.11, "min": 0.48, "cnt": 128}, "fwd-MLP":{"total": 1659.69, "avg": 12.97, "max": 10.86, "min": 20.68, "cnt": 128}, "MoE_L0_fwd":{"total": 496.34, "avg": 15.51, "max": 11.30, "min": 20.54, "cnt": 32}, "MoEMLP":{"total": 1643.17, "avg": 12.84, "max": 10.75, "min": 20.49, "cnt": 128}, "MoE_L1_fwd":{"total": 382.39, "avg": 11.95, "max": 10.79, "min": 15.30, "cnt": 32}, "MoE_L2_fwd":{"total": 389.59, "avg": 12.17, "max": 11.37, "min": 13.80, "cnt": 32}, "MoE_L3_fwd":{"total": 380.83, "avg": 11.90, "max": 11.29, "min": 16.50, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.61, "avg": 0.02, "max": 0.02, "min": 0.04, "cnt": 32}, "forward-send":{"total": 3.58, "avg": 1.79, "max": 1.03, "min": 2.55, "cnt": 2}, "forward-send-backward-recv":{"total": 69.72, "avg": 2.32, "max": 1.10, "min": 6.82, "cnt": 30}, "backward-compute":{"total": 1763.94, "avg": 55.12, "max": 53.16, "min": 58.22, "cnt": 32}, "MoE_L3_bwd":{"total": 440.03, "avg": 13.75, "max": 12.76, "min": 16.46, "cnt": 32}, "MoE_L2_bwd":{"total": 390.51, "avg": 12.20, "max": 11.47, "min": 12.67, "cnt": 32}, "MoE_L1_bwd":{"total": 334.86, "avg": 10.46, "max": 9.91, "min": 11.00, "cnt": 32}, "MoE_L0_bwd":{"total": 384.79, "avg": 12.02, "max": 11.23, "min": 12.63, "cnt": 32}, "backward-send-forward-recv":{"total": 5156.44, "avg": 177.81, "max": 1.94, "min": 863.60, "cnt": 29}, "backward-send":{"total": 2.37, "avg": 0.79, "max": 0.59, "min": 1.08, "cnt": 3}, "backward-recv":{"total": 131.47, "avg": 65.74, "max": 64.52, "min": 66.95, "cnt": 2}, "backward-params-all-reduce":{"total": 487.95, "avg": 487.95, "max": 487.95, "min": 487.95, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 247.42, "avg": 247.42, "max": 247.42, "min": 247.42, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.36, "avg": 3.36, "max": 3.36, "min": 3.36, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 204.65, "avg": 204.65, "max": 204.65, "min": 204.65, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.32, "avg": 3.32, "max": 3.32, "min": 3.32, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.41, "avg": 3.41, "max": 3.41, "min": 3.41, "cnt": 1}}}
{"type":"time", "iteration": 87, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 74.78, "avg": 24.93, "max": 0.81, "min": 71.29, "cnt": 3}, "forward-compute":{"total": 1909.29, "avg": 59.67, "max": 52.54, "min": 67.46, "cnt": 32}, "fwd-compute":{"total": 1905.99, "avg": 59.56, "max": 52.47, "min": 67.37, "cnt": 32}, "batch-generator":{"total": 49.13, "avg": 1.54, "max": 0.66, "min": 3.25, "cnt": 32}, "fwd-embedding":{"total": 0.65, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1843.97, "avg": 57.62, "max": 51.52, "min": 65.89, "cnt": 32}, "fwd-layernorm":{"total": 10.29, "avg": 0.08, "max": 0.05, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 113.61, "avg": 0.89, "max": 0.74, "min": 2.14, "cnt": 128}, "fwd-misc":{"total": 22.43, "avg": 0.18, "max": 0.11, "min": 0.44, "cnt": 128}, "fwd-MLP":{"total": 1674.93, "avg": 13.09, "max": 10.61, "min": 19.43, "cnt": 128}, "MoE_L0_fwd":{"total": 497.66, "avg": 15.55, "max": 12.52, "min": 19.25, "cnt": 32}, "MoEMLP":{"total": 1656.93, "avg": 12.94, "max": 10.49, "min": 19.20, "cnt": 128}, "MoE_L1_fwd":{"total": 383.72, "avg": 11.99, "max": 10.53, "min": 14.54, "cnt": 32}, "MoE_L2_fwd":{"total": 393.26, "avg": 12.29, "max": 11.62, "min": 16.08, "cnt": 32}, "MoE_L3_fwd":{"total": 388.92, "avg": 12.15, "max": 11.30, "min": 17.45, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 9.47, "avg": 4.73, "max": 0.94, "min": 8.53, "cnt": 2}, "forward-send-backward-recv":{"total": 388.33, "avg": 12.94, "max": 1.05, "min": 133.43, "cnt": 30}, "backward-compute":{"total": 1807.31, "avg": 56.48, "max": 53.79, "min": 58.14, "cnt": 32}, "MoE_L3_bwd":{"total": 430.04, "avg": 13.44, "max": 12.46, "min": 14.78, "cnt": 32}, "MoE_L2_bwd":{"total": 412.00, "avg": 12.88, "max": 11.97, "min": 13.73, "cnt": 32}, "MoE_L1_bwd":{"total": 339.43, "avg": 10.61, "max": 10.07, "min": 11.64, "cnt": 32}, "MoE_L0_bwd":{"total": 412.41, "avg": 12.89, "max": 12.42, "min": 13.79, "cnt": 32}, "backward-send-forward-recv":{"total": 4935.27, "avg": 170.18, "max": 1.55, "min": 692.73, "cnt": 29}, "backward-send":{"total": 3.28, "avg": 1.09, "max": 0.93, "min": 1.26, "cnt": 3}, "backward-recv":{"total": 138.72, "avg": 69.36, "max": 67.22, "min": 71.50, "cnt": 2}, "backward-params-all-reduce":{"total": 493.82, "avg": 493.82, "max": 493.82, "min": 493.82, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 247.15, "avg": 247.15, "max": 247.15, "min": 247.15, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.36, "avg": 3.36, "max": 3.36, "min": 3.36, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 203.04, "avg": 203.04, "max": 203.04, "min": 203.04, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.71, "avg": 6.71, "max": 6.71, "min": 6.71, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 88, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.10, "avg": 0.10, "max": 0.10, "min": 0.10, "cnt": 1}, "forward-recv":{"total": 73.42, "avg": 24.47, "max": 0.94, "min": 71.27, "cnt": 3}, "forward-compute":{"total": 1876.77, "avg": 58.65, "max": 52.75, "min": 63.03, "cnt": 32}, "fwd-compute":{"total": 1873.84, "avg": 58.56, "max": 52.69, "min": 62.95, "cnt": 32}, "batch-generator":{"total": 37.69, "avg": 1.18, "max": 0.68, "min": 2.84, "cnt": 32}, "fwd-embedding":{"total": 0.53, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1824.15, "avg": 57.00, "max": 51.71, "min": 61.79, "cnt": 32}, "fwd-layernorm":{"total": 9.01, "avg": 0.07, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 104.59, "avg": 0.82, "max": 0.74, "min": 1.56, "cnt": 128}, "fwd-misc":{"total": 19.92, "avg": 0.16, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1670.49, "avg": 13.05, "max": 10.56, "min": 21.82, "cnt": 128}, "MoE_L0_fwd":{"total": 514.24, "avg": 16.07, "max": 12.73, "min": 21.75, "cnt": 32}, "MoEMLP":{"total": 1654.25, "avg": 12.92, "max": 10.45, "min": 21.71, "cnt": 128}, "MoE_L1_fwd":{"total": 371.05, "avg": 11.60, "max": 10.49, "min": 15.46, "cnt": 32}, "MoE_L2_fwd":{"total": 392.93, "avg": 12.28, "max": 11.35, "min": 16.26, "cnt": 32}, "MoE_L3_fwd":{"total": 381.89, "avg": 11.93, "max": 11.41, "min": 14.01, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.76, "avg": 0.88, "max": 0.80, "min": 0.96, "cnt": 2}, "forward-send-backward-recv":{"total": 193.03, "avg": 6.43, "max": 1.72, "min": 116.16, "cnt": 30}, "backward-compute":{"total": 1826.67, "avg": 57.08, "max": 54.53, "min": 59.60, "cnt": 32}, "MoE_L3_bwd":{"total": 434.61, "avg": 13.58, "max": 12.52, "min": 15.35, "cnt": 32}, "MoE_L2_bwd":{"total": 408.04, "avg": 12.75, "max": 11.90, "min": 13.21, "cnt": 32}, "MoE_L1_bwd":{"total": 322.25, "avg": 10.07, "max": 9.30, "min": 11.02, "cnt": 32}, "MoE_L0_bwd":{"total": 449.05, "avg": 14.03, "max": 13.51, "min": 14.87, "cnt": 32}, "backward-send-forward-recv":{"total": 3396.77, "avg": 117.13, "max": 2.06, "min": 646.02, "cnt": 29}, "backward-send":{"total": 2.42, "avg": 0.81, "max": 0.54, "min": 0.98, "cnt": 3}, "backward-recv":{"total": 128.85, "avg": 64.43, "max": 61.86, "min": 66.99, "cnt": 2}, "backward-params-all-reduce":{"total": 489.75, "avg": 489.75, "max": 489.75, "min": 489.75, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.04, "avg": 0.04, "max": 0.04, "min": 0.04, "cnt": 1}, "optimizer":{"total": 249.92, "avg": 249.92, "max": 249.92, "min": 249.92, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 210.01, "avg": 210.01, "max": 210.01, "min": 210.01, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.28, "avg": 3.28, "max": 3.28, "min": 3.28, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.49, "avg": 3.49, "max": 3.49, "min": 3.49, "cnt": 1}}}
{"type":"time", "iteration": 89, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 441.34, "avg": 147.11, "max": 1.18, "min": 363.24, "cnt": 3}, "forward-compute":{"total": 1880.73, "avg": 58.77, "max": 52.85, "min": 64.33, "cnt": 32}, "fwd-compute":{"total": 1877.55, "avg": 58.67, "max": 52.78, "min": 64.25, "cnt": 32}, "batch-generator":{"total": 56.36, "avg": 1.76, "max": 0.67, "min": 3.57, "cnt": 32}, "fwd-embedding":{"total": 0.63, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1808.54, "avg": 56.52, "max": 51.81, "min": 60.68, "cnt": 32}, "fwd-layernorm":{"total": 9.76, "avg": 0.08, "max": 0.05, "min": 0.18, "cnt": 128}, "fwd-attn":{"total": 109.64, "avg": 0.86, "max": 0.74, "min": 1.96, "cnt": 128}, "fwd-misc":{"total": 20.55, "avg": 0.16, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1647.84, "avg": 12.87, "max": 10.25, "min": 19.53, "cnt": 128}, "MoE_L0_fwd":{"total": 512.08, "avg": 16.00, "max": 12.88, "min": 19.44, "cnt": 32}, "MoEMLP":{"total": 1631.03, "avg": 12.74, "max": 10.14, "min": 19.40, "cnt": 128}, "MoE_L1_fwd":{"total": 361.90, "avg": 11.31, "max": 10.18, "min": 13.04, "cnt": 32}, "MoE_L2_fwd":{"total": 376.02, "avg": 11.75, "max": 11.12, "min": 12.96, "cnt": 32}, "MoE_L3_fwd":{"total": 387.18, "avg": 12.10, "max": 11.50, "min": 12.70, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 11.24, "avg": 5.62, "max": 0.94, "min": 10.31, "cnt": 2}, "forward-send-backward-recv":{"total": 61.95, "avg": 2.06, "max": 1.42, "min": 5.02, "cnt": 30}, "backward-compute":{"total": 1806.54, "avg": 56.45, "max": 53.70, "min": 58.46, "cnt": 32}, "MoE_L3_bwd":{"total": 431.18, "avg": 13.47, "max": 12.03, "min": 14.80, "cnt": 32}, "MoE_L2_bwd":{"total": 405.34, "avg": 12.67, "max": 12.26, "min": 13.57, "cnt": 32}, "MoE_L1_bwd":{"total": 305.96, "avg": 9.56, "max": 9.05, "min": 10.33, "cnt": 32}, "MoE_L0_bwd":{"total": 453.48, "avg": 14.17, "max": 13.49, "min": 16.05, "cnt": 32}, "backward-send-forward-recv":{"total": 4336.43, "avg": 149.53, "max": 1.90, "min": 512.12, "cnt": 29}, "backward-send":{"total": 3.10, "avg": 1.03, "max": 0.92, "min": 1.14, "cnt": 3}, "backward-recv":{"total": 164.00, "avg": 82.00, "max": 73.56, "min": 90.44, "cnt": 2}, "backward-params-all-reduce":{"total": 487.30, "avg": 487.30, "max": 487.30, "min": 487.30, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 244.25, "avg": 244.25, "max": 244.25, "min": 244.25, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.36, "avg": 3.36, "max": 3.36, "min": 3.36, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 204.27, "avg": 204.27, "max": 204.27, "min": 204.27, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.35, "avg": 3.35, "max": 3.35, "min": 3.35, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.41, "avg": 3.41, "max": 3.41, "min": 3.41, "cnt": 1}}}
{"type":"time", "iteration": 90, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 202.60, "avg": 67.53, "max": 1.03, "min": 196.99, "cnt": 3}, "forward-compute":{"total": 1876.86, "avg": 58.65, "max": 53.75, "min": 64.88, "cnt": 32}, "fwd-compute":{"total": 1873.68, "avg": 58.55, "max": 53.68, "min": 64.79, "cnt": 32}, "batch-generator":{"total": 41.57, "avg": 1.30, "max": 0.71, "min": 3.17, "cnt": 32}, "fwd-embedding":{"total": 0.62, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1820.00, "avg": 56.87, "max": 51.98, "min": 63.15, "cnt": 32}, "fwd-layernorm":{"total": 9.64, "avg": 0.08, "max": 0.05, "min": 0.18, "cnt": 128}, "fwd-attn":{"total": 111.04, "avg": 0.87, "max": 0.74, "min": 2.12, "cnt": 128}, "fwd-misc":{"total": 21.14, "avg": 0.17, "max": 0.11, "min": 0.48, "cnt": 128}, "fwd-MLP":{"total": 1657.26, "avg": 12.95, "max": 10.58, "min": 20.94, "cnt": 128}, "MoE_L0_fwd":{"total": 512.33, "avg": 16.01, "max": 12.65, "min": 20.86, "cnt": 32}, "MoEMLP":{"total": 1640.45, "avg": 12.82, "max": 10.46, "min": 20.82, "cnt": 128}, "MoE_L1_fwd":{"total": 358.16, "avg": 11.19, "max": 10.51, "min": 12.52, "cnt": 32}, "MoE_L2_fwd":{"total": 386.52, "avg": 12.08, "max": 11.11, "min": 14.49, "cnt": 32}, "MoE_L3_fwd":{"total": 389.58, "avg": 12.17, "max": 11.58, "min": 13.57, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.61, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.88, "avg": 0.94, "max": 0.92, "min": 0.96, "cnt": 2}, "forward-send-backward-recv":{"total": 1214.21, "avg": 40.47, "max": 1.53, "min": 240.47, "cnt": 30}, "backward-compute":{"total": 1799.44, "avg": 56.23, "max": 53.77, "min": 59.04, "cnt": 32}, "MoE_L3_bwd":{"total": 435.37, "avg": 13.61, "max": 12.50, "min": 15.60, "cnt": 32}, "MoE_L2_bwd":{"total": 403.27, "avg": 12.60, "max": 11.70, "min": 13.27, "cnt": 32}, "MoE_L1_bwd":{"total": 303.21, "avg": 9.48, "max": 9.13, "min": 10.13, "cnt": 32}, "MoE_L0_bwd":{"total": 445.78, "avg": 13.93, "max": 13.53, "min": 14.91, "cnt": 32}, "backward-send-forward-recv":{"total": 3611.65, "avg": 124.54, "max": 2.09, "min": 521.42, "cnt": 29}, "backward-send":{"total": 2.67, "avg": 0.89, "max": 0.79, "min": 1.03, "cnt": 3}, "backward-recv":{"total": 127.22, "avg": 63.61, "max": 59.88, "min": 67.33, "cnt": 2}, "backward-params-all-reduce":{"total": 494.37, "avg": 494.37, "max": 494.37, "min": 494.37, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 245.62, "avg": 245.62, "max": 245.62, "min": 245.62, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 205.78, "avg": 205.78, "max": 205.78, "min": 205.78, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.25, "avg": 3.25, "max": 3.25, "min": 3.25, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 91, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 80.79, "avg": 26.93, "max": 1.12, "min": 71.99, "cnt": 3}, "forward-compute":{"total": 1894.14, "avg": 59.19, "max": 51.61, "min": 67.16, "cnt": 32}, "fwd-compute":{"total": 1890.80, "avg": 59.09, "max": 51.53, "min": 67.03, "cnt": 32}, "batch-generator":{"total": 48.12, "avg": 1.50, "max": 0.70, "min": 5.18, "cnt": 32}, "fwd-embedding":{"total": 0.70, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1829.64, "avg": 57.18, "max": 50.53, "min": 64.91, "cnt": 32}, "fwd-layernorm":{"total": 10.55, "avg": 0.08, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 112.79, "avg": 0.88, "max": 0.74, "min": 1.60, "cnt": 128}, "fwd-misc":{"total": 21.89, "avg": 0.17, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1662.00, "avg": 12.98, "max": 10.38, "min": 21.08, "cnt": 128}, "MoE_L0_fwd":{"total": 513.91, "avg": 16.06, "max": 12.31, "min": 20.99, "cnt": 32}, "MoEMLP":{"total": 1643.92, "avg": 12.84, "max": 10.26, "min": 20.94, "cnt": 128}, "MoE_L1_fwd":{"total": 365.17, "avg": 11.41, "max": 10.31, "min": 13.80, "cnt": 32}, "MoE_L2_fwd":{"total": 384.53, "avg": 12.02, "max": 11.43, "min": 15.41, "cnt": 32}, "MoE_L3_fwd":{"total": 386.88, "avg": 12.09, "max": 11.52, "min": 15.02, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.94, "avg": 0.97, "max": 0.97, "min": 0.97, "cnt": 2}, "forward-send-backward-recv":{"total": 200.13, "avg": 6.67, "max": 1.39, "min": 124.39, "cnt": 30}, "backward-compute":{"total": 1783.41, "avg": 55.73, "max": 54.19, "min": 56.54, "cnt": 32}, "MoE_L3_bwd":{"total": 439.33, "avg": 13.73, "max": 12.66, "min": 14.65, "cnt": 32}, "MoE_L2_bwd":{"total": 398.01, "avg": 12.44, "max": 11.45, "min": 13.04, "cnt": 32}, "MoE_L1_bwd":{"total": 298.97, "avg": 9.34, "max": 8.78, "min": 10.61, "cnt": 32}, "MoE_L0_bwd":{"total": 432.25, "avg": 13.51, "max": 13.10, "min": 13.99, "cnt": 32}, "backward-send-forward-recv":{"total": 3645.51, "avg": 125.71, "max": 2.24, "min": 923.89, "cnt": 29}, "backward-send":{"total": 3.39, "avg": 1.13, "max": 1.11, "min": 1.17, "cnt": 3}, "backward-recv":{"total": 138.57, "avg": 69.29, "max": 68.75, "min": 69.82, "cnt": 2}, "backward-params-all-reduce":{"total": 484.48, "avg": 484.48, "max": 484.48, "min": 484.48, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 250.79, "avg": 250.79, "max": 250.79, "min": 250.79, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 205.46, "avg": 205.46, "max": 205.46, "min": 205.46, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.18, "avg": 6.18, "max": 6.18, "min": 6.18, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}}}
{"type":"time", "iteration": 92, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 64.09, "avg": 21.36, "max": 1.26, "min": 61.48, "cnt": 3}, "forward-compute":{"total": 1891.57, "avg": 59.11, "max": 51.17, "min": 68.54, "cnt": 32}, "fwd-compute":{"total": 1888.13, "avg": 59.00, "max": 51.10, "min": 68.44, "cnt": 32}, "batch-generator":{"total": 48.68, "avg": 1.52, "max": 0.68, "min": 3.12, "cnt": 32}, "fwd-embedding":{"total": 0.69, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1826.53, "avg": 57.08, "max": 50.13, "min": 66.47, "cnt": 32}, "fwd-layernorm":{"total": 10.27, "avg": 0.08, "max": 0.05, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 110.82, "avg": 0.87, "max": 0.74, "min": 2.11, "cnt": 128}, "fwd-misc":{"total": 21.75, "avg": 0.17, "max": 0.11, "min": 0.34, "cnt": 128}, "fwd-MLP":{"total": 1662.21, "avg": 12.99, "max": 9.98, "min": 22.94, "cnt": 128}, "MoE_L0_fwd":{"total": 516.57, "avg": 16.14, "max": 12.38, "min": 22.86, "cnt": 32}, "MoEMLP":{"total": 1644.93, "avg": 12.85, "max": 9.87, "min": 22.81, "cnt": 128}, "MoE_L1_fwd":{"total": 365.76, "avg": 11.43, "max": 9.91, "min": 15.26, "cnt": 32}, "MoE_L2_fwd":{"total": 381.54, "avg": 11.92, "max": 11.15, "min": 13.81, "cnt": 32}, "MoE_L3_fwd":{"total": 387.40, "avg": 12.11, "max": 11.55, "min": 13.34, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.88, "avg": 0.94, "max": 0.91, "min": 0.97, "cnt": 2}, "forward-send-backward-recv":{"total": 1495.17, "avg": 49.84, "max": 1.77, "min": 235.20, "cnt": 30}, "backward-compute":{"total": 1791.27, "avg": 55.98, "max": 52.11, "min": 64.79, "cnt": 32}, "MoE_L3_bwd":{"total": 444.73, "avg": 13.90, "max": 12.17, "min": 21.94, "cnt": 32}, "MoE_L2_bwd":{"total": 392.89, "avg": 12.28, "max": 11.66, "min": 13.16, "cnt": 32}, "MoE_L1_bwd":{"total": 300.23, "avg": 9.38, "max": 8.69, "min": 12.97, "cnt": 32}, "MoE_L0_bwd":{"total": 439.30, "avg": 13.73, "max": 13.03, "min": 16.16, "cnt": 32}, "backward-send-forward-recv":{"total": 2027.47, "avg": 69.91, "max": 1.37, "min": 337.21, "cnt": 29}, "backward-send":{"total": 3.13, "avg": 1.04, "max": 0.93, "min": 1.19, "cnt": 3}, "backward-recv":{"total": 134.64, "avg": 67.32, "max": 60.60, "min": 74.04, "cnt": 2}, "backward-params-all-reduce":{"total": 485.97, "avg": 485.97, "max": 485.97, "min": 485.97, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 241.13, "avg": 241.13, "max": 241.13, "min": 241.13, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 201.14, "avg": 201.14, "max": 201.14, "min": 201.14, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.30, "avg": 3.30, "max": 3.30, "min": 3.30, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 93, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 73.57, "avg": 24.52, "max": 0.72, "min": 64.93, "cnt": 3}, "forward-compute":{"total": 3590.84, "avg": 112.21, "max": 52.40, "min": 1823.08, "cnt": 32}, "fwd-compute":{"total": 3587.74, "avg": 112.12, "max": 52.33, "min": 1822.99, "cnt": 32}, "batch-generator":{"total": 37.35, "avg": 1.17, "max": 0.70, "min": 1.67, "cnt": 32}, "fwd-embedding":{"total": 0.61, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 3537.77, "avg": 110.56, "max": 51.33, "min": 1821.76, "cnt": 32}, "fwd-layernorm":{"total": 9.45, "avg": 0.07, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 107.25, "avg": 0.84, "max": 0.74, "min": 1.47, "cnt": 128}, "fwd-misc":{"total": 19.93, "avg": 0.16, "max": 0.11, "min": 0.34, "cnt": 128}, "fwd-MLP":{"total": 3380.76, "avg": 26.41, "max": 9.82, "min": 1780.22, "cnt": 128}, "MoE_L0_fwd":{"total": 2266.50, "avg": 70.83, "max": 12.66, "min": 1780.12, "cnt": 32}, "MoEMLP":{"total": 3364.38, "avg": 26.28, "max": 9.71, "min": 1780.06, "cnt": 128}, "MoE_L1_fwd":{"total": 348.41, "avg": 10.89, "max": 9.75, "min": 13.72, "cnt": 32}, "MoE_L2_fwd":{"total": 374.86, "avg": 11.71, "max": 10.96, "min": 14.18, "cnt": 32}, "MoE_L3_fwd":{"total": 380.62, "avg": 11.89, "max": 11.37, "min": 13.18, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 4.56, "avg": 2.28, "max": 0.76, "min": 3.80, "cnt": 2}, "forward-send-backward-recv":{"total": 1501.98, "avg": 50.07, "max": 1.69, "min": 344.46, "cnt": 30}, "backward-compute":{"total": 1843.29, "avg": 57.60, "max": 53.82, "min": 125.66, "cnt": 32}, "MoE_L3_bwd":{"total": 510.59, "avg": 15.96, "max": 12.45, "min": 86.81, "cnt": 32}, "MoE_L2_bwd":{"total": 392.29, "avg": 12.26, "max": 11.33, "min": 13.25, "cnt": 32}, "MoE_L1_bwd":{"total": 290.69, "avg": 9.08, "max": 8.68, "min": 9.86, "cnt": 32}, "MoE_L0_bwd":{"total": 435.99, "avg": 13.62, "max": 12.93, "min": 14.10, "cnt": 32}, "backward-send-forward-recv":{"total": 3264.36, "avg": 112.56, "max": 2.23, "min": 442.44, "cnt": 29}, "backward-send":{"total": 2.68, "avg": 0.89, "max": 0.78, "min": 1.08, "cnt": 3}, "backward-recv":{"total": 335.39, "avg": 167.69, "max": 67.91, "min": 267.48, "cnt": 2}, "backward-params-all-reduce":{"total": 487.44, "avg": 487.44, "max": 487.44, "min": 487.44, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 234.53, "avg": 234.53, "max": 234.53, "min": 234.53, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.36, "avg": 3.36, "max": 3.36, "min": 3.36, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 194.82, "avg": 194.82, "max": 194.82, "min": 194.82, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.22, "avg": 3.22, "max": 3.22, "min": 3.22, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.41, "avg": 3.41, "max": 3.41, "min": 3.41, "cnt": 1}}}
{"type":"time", "iteration": 94, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.12, "avg": 0.12, "max": 0.12, "min": 0.12, "cnt": 1}, "forward-recv":{"total": 72.44, "avg": 24.15, "max": 1.03, "min": 70.23, "cnt": 3}, "forward-compute":{"total": 1827.65, "avg": 57.11, "max": 51.23, "min": 64.15, "cnt": 32}, "fwd-compute":{"total": 1824.48, "avg": 57.02, "max": 51.16, "min": 64.06, "cnt": 32}, "batch-generator":{"total": 42.48, "avg": 1.33, "max": 0.71, "min": 2.22, "cnt": 32}, "fwd-embedding":{"total": 0.67, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1769.53, "avg": 55.30, "max": 50.12, "min": 62.62, "cnt": 32}, "fwd-layernorm":{"total": 9.91, "avg": 0.08, "max": 0.05, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 108.69, "avg": 0.85, "max": 0.74, "min": 2.09, "cnt": 128}, "fwd-misc":{"total": 20.99, "avg": 0.16, "max": 0.11, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1608.79, "avg": 12.57, "max": 10.02, "min": 21.29, "cnt": 128}, "MoE_L0_fwd":{"total": 494.71, "avg": 15.46, "max": 12.33, "min": 21.21, "cnt": 32}, "MoEMLP":{"total": 1591.66, "avg": 12.43, "max": 9.91, "min": 21.16, "cnt": 128}, "MoE_L1_fwd":{"total": 356.10, "avg": 11.13, "max": 9.95, "min": 17.21, "cnt": 32}, "MoE_L2_fwd":{"total": 366.07, "avg": 11.44, "max": 10.52, "min": 12.59, "cnt": 32}, "MoE_L3_fwd":{"total": 380.98, "avg": 11.91, "max": 11.31, "min": 15.02, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.86, "avg": 0.93, "max": 0.85, "min": 1.01, "cnt": 2}, "forward-send-backward-recv":{"total": 199.19, "avg": 6.64, "max": 1.87, "min": 127.49, "cnt": 30}, "backward-compute":{"total": 1761.94, "avg": 55.06, "max": 53.41, "min": 61.08, "cnt": 32}, "MoE_L3_bwd":{"total": 436.37, "avg": 13.64, "max": 12.90, "min": 14.97, "cnt": 32}, "MoE_L2_bwd":{"total": 382.21, "avg": 11.94, "max": 11.19, "min": 12.69, "cnt": 32}, "MoE_L1_bwd":{"total": 291.87, "avg": 9.12, "max": 8.69, "min": 11.25, "cnt": 32}, "MoE_L0_bwd":{"total": 435.55, "avg": 13.61, "max": 13.05, "min": 19.65, "cnt": 32}, "backward-send-forward-recv":{"total": 3891.00, "avg": 134.17, "max": 1.54, "min": 485.37, "cnt": 29}, "backward-send":{"total": 2.79, "avg": 0.93, "max": 0.88, "min": 1.03, "cnt": 3}, "backward-recv":{"total": 124.36, "avg": 62.18, "max": 54.20, "min": 70.17, "cnt": 2}, "backward-params-all-reduce":{"total": 480.26, "avg": 480.26, "max": 480.26, "min": 480.26, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.06, "avg": 0.06, "max": 0.06, "min": 0.06, "cnt": 1}, "optimizer":{"total": 248.90, "avg": 248.90, "max": 248.90, "min": 248.90, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 208.84, "avg": 208.84, "max": 208.84, "min": 208.84, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.26, "avg": 3.26, "max": 3.26, "min": 3.26, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}}}
{"type":"time", "iteration": 95, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 83.46, "avg": 27.82, "max": 2.61, "min": 70.44, "cnt": 3}, "forward-compute":{"total": 1789.79, "avg": 55.93, "max": 51.44, "min": 61.57, "cnt": 32}, "fwd-compute":{"total": 1786.64, "avg": 55.83, "max": 51.37, "min": 61.49, "cnt": 32}, "batch-generator":{"total": 42.57, "avg": 1.33, "max": 0.68, "min": 2.71, "cnt": 32}, "fwd-embedding":{"total": 0.59, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1730.42, "avg": 54.08, "max": 50.14, "min": 58.41, "cnt": 32}, "fwd-layernorm":{"total": 9.50, "avg": 0.07, "max": 0.05, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 108.51, "avg": 0.85, "max": 0.74, "min": 2.58, "cnt": 128}, "fwd-misc":{"total": 20.61, "avg": 0.16, "max": 0.11, "min": 0.51, "cnt": 128}, "fwd-MLP":{"total": 1570.80, "avg": 12.27, "max": 9.80, "min": 19.29, "cnt": 128}, "MoE_L0_fwd":{"total": 484.77, "avg": 15.15, "max": 12.20, "min": 19.21, "cnt": 32}, "MoEMLP":{"total": 1553.89, "avg": 12.14, "max": 9.68, "min": 19.16, "cnt": 128}, "MoE_L1_fwd":{"total": 341.29, "avg": 10.67, "max": 9.73, "min": 14.51, "cnt": 32}, "MoE_L2_fwd":{"total": 366.13, "avg": 11.44, "max": 10.73, "min": 12.41, "cnt": 32}, "MoE_L3_fwd":{"total": 367.81, "avg": 11.49, "max": 10.91, "min": 12.69, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.63, "avg": 0.02, "max": 0.02, "min": 0.06, "cnt": 32}, "forward-send":{"total": 1.87, "avg": 0.94, "max": 0.87, "min": 1.00, "cnt": 2}, "forward-send-backward-recv":{"total": 187.06, "avg": 6.24, "max": 1.64, "min": 117.07, "cnt": 30}, "backward-compute":{"total": 1742.98, "avg": 54.47, "max": 51.70, "min": 57.56, "cnt": 32}, "MoE_L3_bwd":{"total": 414.75, "avg": 12.96, "max": 11.79, "min": 15.01, "cnt": 32}, "MoE_L2_bwd":{"total": 388.05, "avg": 12.13, "max": 11.08, "min": 12.77, "cnt": 32}, "MoE_L1_bwd":{"total": 297.85, "avg": 9.31, "max": 8.70, "min": 11.66, "cnt": 32}, "MoE_L0_bwd":{"total": 427.61, "avg": 13.36, "max": 12.73, "min": 13.86, "cnt": 32}, "backward-send-forward-recv":{"total": 4216.54, "avg": 145.40, "max": 2.33, "min": 1082.93, "cnt": 29}, "backward-send":{"total": 2.61, "avg": 0.87, "max": 0.69, "min": 1.12, "cnt": 3}, "backward-recv":{"total": 121.56, "avg": 60.78, "max": 54.63, "min": 66.94, "cnt": 2}, "backward-params-all-reduce":{"total": 500.29, "avg": 500.29, "max": 500.29, "min": 500.29, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 246.18, "avg": 246.18, "max": 246.18, "min": 246.18, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 206.23, "avg": 206.23, "max": 206.23, "min": 206.23, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 96, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 81.22, "avg": 27.07, "max": 0.80, "min": 76.32, "cnt": 3}, "forward-compute":{"total": 1784.95, "avg": 55.78, "max": 49.64, "min": 62.65, "cnt": 32}, "fwd-compute":{"total": 1781.87, "avg": 55.68, "max": 49.55, "min": 62.57, "cnt": 32}, "batch-generator":{"total": 48.81, "avg": 1.53, "max": 0.71, "min": 2.76, "cnt": 32}, "fwd-embedding":{"total": 0.62, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1720.97, "avg": 53.78, "max": 48.55, "min": 61.22, "cnt": 32}, "fwd-layernorm":{"total": 9.78, "avg": 0.08, "max": 0.05, "min": 0.18, "cnt": 128}, "fwd-attn":{"total": 109.60, "avg": 0.86, "max": 0.74, "min": 2.27, "cnt": 128}, "fwd-misc":{"total": 21.02, "avg": 0.16, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1559.55, "avg": 12.18, "max": 9.86, "min": 20.91, "cnt": 128}, "MoE_L0_fwd":{"total": 470.45, "avg": 14.70, "max": 12.01, "min": 20.83, "cnt": 32}, "MoEMLP":{"total": 1542.53, "avg": 12.05, "max": 9.76, "min": 20.79, "cnt": 128}, "MoE_L1_fwd":{"total": 347.67, "avg": 10.86, "max": 9.80, "min": 12.97, "cnt": 32}, "MoE_L2_fwd":{"total": 360.26, "avg": 11.26, "max": 10.61, "min": 12.20, "cnt": 32}, "MoE_L3_fwd":{"total": 370.36, "avg": 11.57, "max": 10.77, "min": 12.54, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 4.84, "avg": 2.42, "max": 0.94, "min": 3.90, "cnt": 2}, "forward-send-backward-recv":{"total": 925.48, "avg": 30.85, "max": 1.72, "min": 239.96, "cnt": 30}, "backward-compute":{"total": 1735.91, "avg": 54.25, "max": 51.20, "min": 55.93, "cnt": 32}, "MoE_L3_bwd":{"total": 421.63, "avg": 13.18, "max": 12.44, "min": 15.82, "cnt": 32}, "MoE_L2_bwd":{"total": 383.37, "avg": 11.98, "max": 11.34, "min": 13.04, "cnt": 32}, "MoE_L1_bwd":{"total": 297.32, "avg": 9.29, "max": 8.32, "min": 10.06, "cnt": 32}, "MoE_L0_bwd":{"total": 419.10, "avg": 13.10, "max": 12.17, "min": 13.77, "cnt": 32}, "backward-send-forward-recv":{"total": 6257.13, "avg": 215.76, "max": 2.29, "min": 1117.86, "cnt": 29}, "backward-send":{"total": 2.46, "avg": 0.82, "max": 0.77, "min": 0.90, "cnt": 3}, "backward-recv":{"total": 299.72, "avg": 149.86, "max": 70.27, "min": 229.45, "cnt": 2}, "backward-params-all-reduce":{"total": 484.71, "avg": 484.71, "max": 484.71, "min": 484.71, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 244.37, "avg": 244.37, "max": 244.37, "min": 244.37, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.36, "avg": 3.36, "max": 3.36, "min": 3.36, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 204.50, "avg": 204.50, "max": 204.50, "min": 204.50, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.29, "avg": 3.29, "max": 3.29, "min": 3.29, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 97, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 87.36, "avg": 29.12, "max": 2.78, "min": 81.49, "cnt": 3}, "forward-compute":{"total": 1810.70, "avg": 56.58, "max": 50.18, "min": 61.56, "cnt": 32}, "fwd-compute":{"total": 1807.71, "avg": 56.49, "max": 50.12, "min": 61.47, "cnt": 32}, "batch-generator":{"total": 50.76, "avg": 1.59, "max": 0.68, "min": 3.54, "cnt": 32}, "fwd-embedding":{"total": 0.61, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1744.68, "avg": 54.52, "max": 49.15, "min": 58.74, "cnt": 32}, "fwd-layernorm":{"total": 9.48, "avg": 0.07, "max": 0.05, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 106.45, "avg": 0.83, "max": 0.74, "min": 1.53, "cnt": 128}, "fwd-misc":{"total": 20.35, "avg": 0.16, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1587.75, "avg": 12.40, "max": 9.98, "min": 20.91, "cnt": 128}, "MoE_L0_fwd":{"total": 487.51, "avg": 15.23, "max": 11.96, "min": 20.83, "cnt": 32}, "MoEMLP":{"total": 1571.29, "avg": 12.28, "max": 9.88, "min": 20.78, "cnt": 128}, "MoE_L1_fwd":{"total": 345.61, "avg": 10.80, "max": 9.92, "min": 12.78, "cnt": 32}, "MoE_L2_fwd":{"total": 366.70, "avg": 11.46, "max": 10.63, "min": 12.26, "cnt": 32}, "MoE_L3_fwd":{"total": 377.51, "avg": 11.80, "max": 10.80, "min": 13.17, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.88, "avg": 0.94, "max": 0.93, "min": 0.95, "cnt": 2}, "forward-send-backward-recv":{"total": 209.56, "avg": 6.99, "max": 1.81, "min": 130.92, "cnt": 30}, "backward-compute":{"total": 1745.01, "avg": 54.53, "max": 52.73, "min": 57.05, "cnt": 32}, "MoE_L3_bwd":{"total": 427.16, "avg": 13.35, "max": 11.91, "min": 16.01, "cnt": 32}, "MoE_L2_bwd":{"total": 386.62, "avg": 12.08, "max": 11.23, "min": 12.88, "cnt": 32}, "MoE_L1_bwd":{"total": 296.19, "avg": 9.26, "max": 8.74, "min": 10.36, "cnt": 32}, "MoE_L0_bwd":{"total": 422.59, "avg": 13.21, "max": 12.72, "min": 13.78, "cnt": 32}, "backward-send-forward-recv":{"total": 5310.29, "avg": 183.11, "max": 1.31, "min": 872.20, "cnt": 29}, "backward-send":{"total": 3.17, "avg": 1.06, "max": 0.97, "min": 1.14, "cnt": 3}, "backward-recv":{"total": 159.82, "avg": 79.91, "max": 60.39, "min": 99.42, "cnt": 2}, "backward-params-all-reduce":{"total": 487.83, "avg": 487.83, "max": 487.83, "min": 487.83, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 241.71, "avg": 241.71, "max": 241.71, "min": 241.71, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.36, "avg": 3.36, "max": 3.36, "min": 3.36, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 202.00, "avg": 202.00, "max": 202.00, "min": 202.00, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.26, "avg": 3.26, "max": 3.26, "min": 3.26, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}}}
{"type":"time", "iteration": 98, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 80.89, "avg": 26.96, "max": 0.91, "min": 78.01, "cnt": 3}, "forward-compute":{"total": 1923.73, "avg": 60.12, "max": 50.71, "min": 133.77, "cnt": 32}, "fwd-compute":{"total": 1920.43, "avg": 60.01, "max": 50.64, "min": 133.69, "cnt": 32}, "batch-generator":{"total": 53.93, "avg": 1.69, "max": 0.69, "min": 3.26, "cnt": 32}, "fwd-embedding":{"total": 0.66, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1853.96, "avg": 57.94, "max": 49.58, "min": 132.62, "cnt": 32}, "fwd-layernorm":{"total": 9.84, "avg": 0.08, "max": 0.05, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 110.45, "avg": 0.86, "max": 0.74, "min": 1.78, "cnt": 128}, "fwd-misc":{"total": 20.91, "avg": 0.16, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1691.59, "avg": 13.22, "max": 10.05, "min": 92.97, "cnt": 128}, "MoE_L0_fwd":{"total": 485.63, "avg": 15.18, "max": 12.32, "min": 19.85, "cnt": 32}, "MoEMLP":{"total": 1674.76, "avg": 13.08, "max": 9.95, "min": 92.86, "cnt": 128}, "MoE_L1_fwd":{"total": 347.22, "avg": 10.85, "max": 9.99, "min": 12.63, "cnt": 32}, "MoE_L2_fwd":{"total": 466.67, "avg": 14.58, "max": 11.43, "min": 92.90, "cnt": 32}, "MoE_L3_fwd":{"total": 381.42, "avg": 11.92, "max": 10.89, "min": 15.19, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 3.26, "avg": 1.63, "max": 1.02, "min": 2.24, "cnt": 2}, "forward-send-backward-recv":{"total": 127.49, "avg": 4.25, "max": 1.86, "min": 40.07, "cnt": 30}, "backward-compute":{"total": 1780.61, "avg": 55.64, "max": 52.88, "min": 66.44, "cnt": 32}, "MoE_L3_bwd":{"total": 434.05, "avg": 13.56, "max": 11.99, "min": 24.49, "cnt": 32}, "MoE_L2_bwd":{"total": 399.03, "avg": 12.47, "max": 11.70, "min": 13.19, "cnt": 32}, "MoE_L1_bwd":{"total": 296.35, "avg": 9.26, "max": 8.92, "min": 10.18, "cnt": 32}, "MoE_L0_bwd":{"total": 435.27, "avg": 13.60, "max": 12.94, "min": 14.24, "cnt": 32}, "backward-send-forward-recv":{"total": 3186.26, "avg": 109.87, "max": 2.41, "min": 335.37, "cnt": 29}, "backward-send":{"total": 2.69, "avg": 0.90, "max": 0.82, "min": 0.96, "cnt": 3}, "backward-recv":{"total": 201.72, "avg": 100.86, "max": 67.05, "min": 134.67, "cnt": 2}, "backward-params-all-reduce":{"total": 488.94, "avg": 488.94, "max": 488.94, "min": 488.94, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 246.23, "avg": 246.23, "max": 246.23, "min": 246.23, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.36, "avg": 3.36, "max": 3.36, "min": 3.36, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 202.48, "avg": 202.48, "max": 202.48, "min": 202.48, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.30, "avg": 3.30, "max": 3.30, "min": 3.30, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 99, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 66.85, "avg": 22.28, "max": 0.64, "min": 65.19, "cnt": 3}, "forward-compute":{"total": 1903.36, "avg": 59.48, "max": 52.46, "min": 71.18, "cnt": 32}, "fwd-compute":{"total": 1900.19, "avg": 59.38, "max": 52.39, "min": 71.04, "cnt": 32}, "batch-generator":{"total": 47.29, "avg": 1.48, "max": 0.65, "min": 4.19, "cnt": 32}, "fwd-embedding":{"total": 0.64, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1840.49, "avg": 57.52, "max": 51.24, "min": 68.92, "cnt": 32}, "fwd-layernorm":{"total": 9.70, "avg": 0.08, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 110.50, "avg": 0.86, "max": 0.74, "min": 2.07, "cnt": 128}, "fwd-misc":{"total": 20.50, "avg": 0.16, "max": 0.11, "min": 0.39, "cnt": 128}, "fwd-MLP":{"total": 1679.03, "avg": 13.12, "max": 10.50, "min": 19.53, "cnt": 128}, "MoE_L0_fwd":{"total": 518.95, "avg": 16.22, "max": 12.73, "min": 19.45, "cnt": 32}, "MoEMLP":{"total": 1662.40, "avg": 12.99, "max": 10.39, "min": 19.41, "cnt": 128}, "MoE_L1_fwd":{"total": 379.24, "avg": 11.85, "max": 10.43, "min": 16.94, "cnt": 32}, "MoE_L2_fwd":{"total": 392.85, "avg": 12.28, "max": 11.51, "min": 17.17, "cnt": 32}, "MoE_L3_fwd":{"total": 377.44, "avg": 11.80, "max": 10.74, "min": 13.20, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 3.43, "avg": 1.71, "max": 1.01, "min": 2.41, "cnt": 2}, "forward-send-backward-recv":{"total": 174.92, "avg": 5.83, "max": 1.16, "min": 123.94, "cnt": 30}, "backward-compute":{"total": 1786.35, "avg": 55.82, "max": 53.40, "min": 58.88, "cnt": 32}, "MoE_L3_bwd":{"total": 434.41, "avg": 13.58, "max": 11.91, "min": 16.75, "cnt": 32}, "MoE_L2_bwd":{"total": 401.04, "avg": 12.53, "max": 11.54, "min": 13.55, "cnt": 32}, "MoE_L1_bwd":{"total": 301.52, "avg": 9.42, "max": 8.79, "min": 11.13, "cnt": 32}, "MoE_L0_bwd":{"total": 436.57, "avg": 13.64, "max": 13.12, "min": 14.54, "cnt": 32}, "backward-send-forward-recv":{"total": 5214.05, "avg": 179.79, "max": 1.84, "min": 1279.97, "cnt": 29}, "backward-send":{"total": 3.21, "avg": 1.07, "max": 1.05, "min": 1.09, "cnt": 3}, "backward-recv":{"total": 117.28, "avg": 58.64, "max": 53.46, "min": 63.83, "cnt": 2}, "backward-params-all-reduce":{"total": 487.68, "avg": 487.68, "max": 487.68, "min": 487.68, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.04, "avg": 0.04, "max": 0.04, "min": 0.04, "cnt": 1}, "optimizer":{"total": 245.44, "avg": 245.44, "max": 245.44, "min": 245.44, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.49, "avg": 3.49, "max": 3.49, "min": 3.49, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 205.46, "avg": 205.46, "max": 205.46, "min": 205.46, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.26, "avg": 3.26, "max": 3.26, "min": 3.26, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 100, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 75.93, "avg": 25.31, "max": 1.22, "min": 69.50, "cnt": 3}, "forward-compute":{"total": 1864.08, "avg": 58.25, "max": 51.85, "min": 66.23, "cnt": 32}, "fwd-compute":{"total": 1861.22, "avg": 58.16, "max": 51.78, "min": 66.14, "cnt": 32}, "batch-generator":{"total": 47.55, "avg": 1.49, "max": 0.68, "min": 4.31, "cnt": 32}, "fwd-embedding":{"total": 0.52, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1801.57, "avg": 56.30, "max": 50.73, "min": 63.53, "cnt": 32}, "fwd-layernorm":{"total": 9.16, "avg": 0.07, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 105.80, "avg": 0.83, "max": 0.74, "min": 2.26, "cnt": 128}, "fwd-misc":{"total": 20.01, "avg": 0.16, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1646.42, "avg": 12.86, "max": 10.20, "min": 24.48, "cnt": 128}, "MoE_L0_fwd":{"total": 500.93, "avg": 15.65, "max": 12.26, "min": 24.40, "cnt": 32}, "MoEMLP":{"total": 1630.18, "avg": 12.74, "max": 10.09, "min": 24.35, "cnt": 128}, "MoE_L1_fwd":{"total": 365.96, "avg": 11.44, "max": 10.13, "min": 15.56, "cnt": 32}, "MoE_L2_fwd":{"total": 395.07, "avg": 12.35, "max": 11.09, "min": 14.69, "cnt": 32}, "MoE_L3_fwd":{"total": 374.24, "avg": 11.69, "max": 10.91, "min": 13.18, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.82, "avg": 0.91, "max": 0.89, "min": 0.94, "cnt": 2}, "forward-send-backward-recv":{"total": 193.82, "avg": 6.46, "max": 1.53, "min": 119.26, "cnt": 30}, "backward-compute":{"total": 1780.00, "avg": 55.63, "max": 53.39, "min": 57.67, "cnt": 32}, "MoE_L3_bwd":{"total": 434.42, "avg": 13.58, "max": 12.07, "min": 15.77, "cnt": 32}, "MoE_L2_bwd":{"total": 396.79, "avg": 12.40, "max": 11.90, "min": 13.31, "cnt": 32}, "MoE_L1_bwd":{"total": 309.54, "avg": 9.67, "max": 8.89, "min": 11.60, "cnt": 32}, "MoE_L0_bwd":{"total": 425.80, "avg": 13.31, "max": 12.87, "min": 14.02, "cnt": 32}, "backward-send-forward-recv":{"total": 6411.26, "avg": 221.08, "max": 2.10, "min": 812.82, "cnt": 29}, "backward-send":{"total": 2.50, "avg": 0.83, "max": 0.55, "min": 1.06, "cnt": 3}, "backward-recv":{"total": 129.55, "avg": 64.77, "max": 58.23, "min": 71.32, "cnt": 2}, "backward-params-all-reduce":{"total": 481.84, "avg": 481.84, "max": 481.84, "min": 481.84, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 249.43, "avg": 249.43, "max": 249.43, "min": 249.43, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 209.38, "avg": 209.38, "max": 209.38, "min": 209.38, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.51, "avg": 3.51, "max": 3.51, "min": 3.51, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 101, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 72.24, "avg": 24.08, "max": 0.79, "min": 70.14, "cnt": 3}, "forward-compute":{"total": 1924.05, "avg": 60.13, "max": 53.78, "min": 97.23, "cnt": 32}, "fwd-compute":{"total": 1921.03, "avg": 60.03, "max": 53.71, "min": 97.16, "cnt": 32}, "batch-generator":{"total": 37.77, "avg": 1.18, "max": 0.66, "min": 1.67, "cnt": 32}, "fwd-embedding":{"total": 0.60, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1871.01, "avg": 58.47, "max": 52.74, "min": 95.85, "cnt": 32}, "fwd-layernorm":{"total": 9.28, "avg": 0.07, "max": 0.05, "min": 0.18, "cnt": 128}, "fwd-attn":{"total": 107.70, "avg": 0.84, "max": 0.74, "min": 2.40, "cnt": 128}, "fwd-misc":{"total": 20.10, "avg": 0.16, "max": 0.11, "min": 0.32, "cnt": 128}, "fwd-MLP":{"total": 1713.43, "avg": 13.39, "max": 10.44, "min": 55.83, "cnt": 128}, "MoE_L0_fwd":{"total": 552.78, "avg": 17.27, "max": 13.31, "min": 55.71, "cnt": 32}, "MoEMLP":{"total": 1696.96, "avg": 13.26, "max": 10.31, "min": 55.66, "cnt": 128}, "MoE_L1_fwd":{"total": 364.65, "avg": 11.40, "max": 10.36, "min": 12.55, "cnt": 32}, "MoE_L2_fwd":{"total": 400.82, "avg": 12.53, "max": 11.59, "min": 13.86, "cnt": 32}, "MoE_L3_fwd":{"total": 384.64, "avg": 12.02, "max": 11.45, "min": 12.68, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.77, "avg": 0.89, "max": 0.78, "min": 0.99, "cnt": 2}, "forward-send-backward-recv":{"total": 408.41, "avg": 13.61, "max": 0.87, "min": 175.81, "cnt": 30}, "backward-compute":{"total": 1803.03, "avg": 56.34, "max": 54.15, "min": 60.10, "cnt": 32}, "MoE_L3_bwd":{"total": 449.87, "avg": 14.06, "max": 12.91, "min": 17.36, "cnt": 32}, "MoE_L2_bwd":{"total": 403.23, "avg": 12.60, "max": 11.88, "min": 13.25, "cnt": 32}, "MoE_L1_bwd":{"total": 304.82, "avg": 9.53, "max": 8.76, "min": 9.96, "cnt": 32}, "MoE_L0_bwd":{"total": 431.72, "avg": 13.49, "max": 12.85, "min": 14.19, "cnt": 32}, "backward-send-forward-recv":{"total": 3705.79, "avg": 127.79, "max": 2.28, "min": 1215.50, "cnt": 29}, "backward-send":{"total": 2.63, "avg": 0.88, "max": 0.54, "min": 1.07, "cnt": 3}, "backward-recv":{"total": 278.04, "avg": 139.02, "max": 73.83, "min": 204.20, "cnt": 2}, "backward-params-all-reduce":{"total": 487.12, "avg": 487.12, "max": 487.12, "min": 487.12, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 243.58, "avg": 243.58, "max": 243.58, "min": 243.58, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 203.64, "avg": 203.64, "max": 203.64, "min": 203.64, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.34, "avg": 3.34, "max": 3.34, "min": 3.34, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 102, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.12, "avg": 0.12, "max": 0.12, "min": 0.12, "cnt": 1}, "forward-recv":{"total": 85.12, "avg": 28.37, "max": 1.23, "min": 77.17, "cnt": 3}, "forward-compute":{"total": 1918.81, "avg": 59.96, "max": 52.29, "min": 65.76, "cnt": 32}, "fwd-compute":{"total": 1915.66, "avg": 59.86, "max": 52.22, "min": 65.68, "cnt": 32}, "batch-generator":{"total": 45.55, "avg": 1.42, "max": 0.67, "min": 5.24, "cnt": 32}, "fwd-embedding":{"total": 0.64, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1857.45, "avg": 58.05, "max": 51.27, "min": 63.22, "cnt": 32}, "fwd-layernorm":{"total": 9.61, "avg": 0.08, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 108.93, "avg": 0.85, "max": 0.74, "min": 1.54, "cnt": 128}, "fwd-misc":{"total": 21.21, "avg": 0.17, "max": 0.11, "min": 0.40, "cnt": 128}, "fwd-MLP":{"total": 1696.92, "avg": 13.26, "max": 10.47, "min": 21.32, "cnt": 128}, "MoE_L0_fwd":{"total": 522.54, "avg": 16.33, "max": 12.43, "min": 21.25, "cnt": 32}, "MoEMLP":{"total": 1680.09, "avg": 13.13, "max": 10.36, "min": 21.21, "cnt": 128}, "MoE_L1_fwd":{"total": 369.95, "avg": 11.56, "max": 10.40, "min": 13.34, "cnt": 32}, "MoE_L2_fwd":{"total": 394.48, "avg": 12.33, "max": 11.62, "min": 17.20, "cnt": 32}, "MoE_L3_fwd":{"total": 399.29, "avg": 12.48, "max": 11.63, "min": 15.59, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.86, "avg": 0.93, "max": 0.86, "min": 1.00, "cnt": 2}, "forward-send-backward-recv":{"total": 171.22, "avg": 5.71, "max": 0.86, "min": 116.53, "cnt": 30}, "backward-compute":{"total": 1831.67, "avg": 57.24, "max": 53.77, "min": 60.11, "cnt": 32}, "MoE_L3_bwd":{"total": 471.73, "avg": 14.74, "max": 12.27, "min": 16.62, "cnt": 32}, "MoE_L2_bwd":{"total": 411.17, "avg": 12.85, "max": 12.07, "min": 15.04, "cnt": 32}, "MoE_L1_bwd":{"total": 311.06, "avg": 9.72, "max": 9.27, "min": 10.34, "cnt": 32}, "MoE_L0_bwd":{"total": 426.02, "avg": 13.31, "max": 12.76, "min": 14.16, "cnt": 32}, "backward-send-forward-recv":{"total": 2929.73, "avg": 101.03, "max": 0.95, "min": 374.43, "cnt": 29}, "backward-send":{"total": 2.63, "avg": 0.88, "max": 0.82, "min": 0.96, "cnt": 3}, "backward-recv":{"total": 147.02, "avg": 73.51, "max": 70.79, "min": 76.23, "cnt": 2}, "backward-params-all-reduce":{"total": 489.29, "avg": 489.29, "max": 489.29, "min": 489.29, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 239.11, "avg": 239.11, "max": 239.11, "min": 239.11, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.36, "avg": 3.36, "max": 3.36, "min": 3.36, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 199.22, "avg": 199.22, "max": 199.22, "min": 199.22, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.28, "avg": 3.28, "max": 3.28, "min": 3.28, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}}}
{"type":"time", "iteration": 103, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 70.13, "avg": 23.38, "max": 0.64, "min": 68.82, "cnt": 3}, "forward-compute":{"total": 1899.11, "avg": 59.35, "max": 53.31, "min": 69.47, "cnt": 32}, "fwd-compute":{"total": 1896.04, "avg": 59.25, "max": 53.24, "min": 69.38, "cnt": 32}, "batch-generator":{"total": 46.69, "avg": 1.46, "max": 0.65, "min": 2.70, "cnt": 32}, "fwd-embedding":{"total": 0.72, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1836.72, "avg": 57.40, "max": 52.33, "min": 66.25, "cnt": 32}, "fwd-layernorm":{"total": 10.26, "avg": 0.08, "max": 0.05, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 113.02, "avg": 0.88, "max": 0.74, "min": 2.29, "cnt": 128}, "fwd-misc":{"total": 21.78, "avg": 0.17, "max": 0.11, "min": 0.34, "cnt": 128}, "fwd-MLP":{"total": 1670.24, "avg": 13.05, "max": 10.66, "min": 25.41, "cnt": 128}, "MoE_L0_fwd":{"total": 499.10, "avg": 15.60, "max": 12.40, "min": 25.34, "cnt": 32}, "MoEMLP":{"total": 1652.66, "avg": 12.91, "max": 10.56, "min": 25.29, "cnt": 128}, "MoE_L1_fwd":{"total": 373.87, "avg": 11.68, "max": 10.60, "min": 14.60, "cnt": 32}, "MoE_L2_fwd":{"total": 391.99, "avg": 12.25, "max": 11.63, "min": 14.94, "cnt": 32}, "MoE_L3_fwd":{"total": 394.16, "avg": 12.32, "max": 11.77, "min": 13.51, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 5.81, "avg": 2.90, "max": 0.67, "min": 5.14, "cnt": 2}, "forward-send-backward-recv":{"total": 248.97, "avg": 8.30, "max": 1.05, "min": 122.58, "cnt": 30}, "backward-compute":{"total": 1776.64, "avg": 55.52, "max": 52.67, "min": 57.60, "cnt": 32}, "MoE_L3_bwd":{"total": 448.80, "avg": 14.02, "max": 12.87, "min": 16.47, "cnt": 32}, "MoE_L2_bwd":{"total": 402.23, "avg": 12.57, "max": 11.65, "min": 13.91, "cnt": 32}, "MoE_L1_bwd":{"total": 309.70, "avg": 9.68, "max": 9.09, "min": 9.97, "cnt": 32}, "MoE_L0_bwd":{"total": 403.07, "avg": 12.60, "max": 12.00, "min": 13.83, "cnt": 32}, "backward-send-forward-recv":{"total": 3070.99, "avg": 105.90, "max": 1.75, "min": 676.63, "cnt": 29}, "backward-send":{"total": 2.36, "avg": 0.79, "max": 0.65, "min": 0.90, "cnt": 3}, "backward-recv":{"total": 143.72, "avg": 71.86, "max": 71.35, "min": 72.38, "cnt": 2}, "backward-params-all-reduce":{"total": 487.28, "avg": 487.28, "max": 487.28, "min": 487.28, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 241.66, "avg": 241.66, "max": 241.66, "min": 241.66, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 201.79, "avg": 201.79, "max": 201.79, "min": 201.79, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.32, "avg": 3.32, "max": 3.32, "min": 3.32, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}}}
{"type":"time", "iteration": 104, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 1671.36, "avg": 557.12, "max": 1.61, "min": 1664.14, "cnt": 3}, "forward-compute":{"total": 1959.45, "avg": 61.23, "max": 53.82, "min": 68.88, "cnt": 32}, "fwd-compute":{"total": 1956.38, "avg": 61.14, "max": 53.76, "min": 68.80, "cnt": 32}, "batch-generator":{"total": 53.85, "avg": 1.68, "max": 0.73, "min": 4.69, "cnt": 32}, "fwd-embedding":{"total": 0.71, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1889.81, "avg": 59.06, "max": 52.73, "min": 66.62, "cnt": 32}, "fwd-layernorm":{"total": 10.05, "avg": 0.08, "max": 0.05, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 109.40, "avg": 0.85, "max": 0.74, "min": 1.53, "cnt": 128}, "fwd-misc":{"total": 21.36, "avg": 0.17, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1727.73, "avg": 13.50, "max": 10.84, "min": 21.50, "cnt": 128}, "MoE_L0_fwd":{"total": 528.02, "avg": 16.50, "max": 12.99, "min": 21.40, "cnt": 32}, "MoEMLP":{"total": 1710.37, "avg": 13.36, "max": 10.72, "min": 21.35, "cnt": 128}, "MoE_L1_fwd":{"total": 386.00, "avg": 12.06, "max": 10.76, "min": 15.94, "cnt": 32}, "MoE_L2_fwd":{"total": 400.80, "avg": 12.53, "max": 11.72, "min": 16.18, "cnt": 32}, "MoE_L3_fwd":{"total": 401.91, "avg": 12.56, "max": 11.71, "min": 16.14, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.92, "avg": 0.96, "max": 0.92, "min": 1.00, "cnt": 2}, "forward-send-backward-recv":{"total": 199.80, "avg": 6.66, "max": 0.89, "min": 126.27, "cnt": 30}, "backward-compute":{"total": 1809.12, "avg": 56.54, "max": 53.02, "min": 61.22, "cnt": 32}, "MoE_L3_bwd":{"total": 453.14, "avg": 14.16, "max": 12.72, "min": 16.37, "cnt": 32}, "MoE_L2_bwd":{"total": 407.32, "avg": 12.73, "max": 12.10, "min": 13.43, "cnt": 32}, "MoE_L1_bwd":{"total": 319.18, "avg": 9.97, "max": 9.39, "min": 13.80, "cnt": 32}, "MoE_L0_bwd":{"total": 418.13, "avg": 13.07, "max": 12.07, "min": 14.45, "cnt": 32}, "backward-send-forward-recv":{"total": 2313.77, "avg": 79.79, "max": 1.10, "min": 386.24, "cnt": 29}, "backward-send":{"total": 3.10, "avg": 1.03, "max": 0.95, "min": 1.12, "cnt": 3}, "backward-recv":{"total": 124.82, "avg": 62.41, "max": 60.72, "min": 64.10, "cnt": 2}, "backward-params-all-reduce":{"total": 487.12, "avg": 487.12, "max": 487.12, "min": 487.12, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 257.42, "avg": 257.42, "max": 257.42, "min": 257.42, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.36, "avg": 3.36, "max": 3.36, "min": 3.36, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 205.10, "avg": 205.10, "max": 205.10, "min": 205.10, "cnt": 1}, "optimizer-clip-main-grad":{"total": 7.36, "avg": 7.36, "max": 7.36, "min": 7.36, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 105, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 70.99, "avg": 23.66, "max": 1.42, "min": 65.92, "cnt": 3}, "forward-compute":{"total": 1891.36, "avg": 59.11, "max": 52.45, "min": 63.62, "cnt": 32}, "fwd-compute":{"total": 1887.99, "avg": 59.00, "max": 52.38, "min": 63.42, "cnt": 32}, "batch-generator":{"total": 48.52, "avg": 1.52, "max": 0.73, "min": 4.57, "cnt": 32}, "fwd-embedding":{"total": 0.68, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1826.62, "avg": 57.08, "max": 51.35, "min": 61.95, "cnt": 32}, "fwd-layernorm":{"total": 10.17, "avg": 0.08, "max": 0.05, "min": 0.29, "cnt": 128}, "fwd-attn":{"total": 112.43, "avg": 0.88, "max": 0.74, "min": 2.37, "cnt": 128}, "fwd-misc":{"total": 21.67, "avg": 0.17, "max": 0.11, "min": 0.43, "cnt": 128}, "fwd-MLP":{"total": 1660.77, "avg": 12.97, "max": 10.71, "min": 18.72, "cnt": 128}, "MoE_L0_fwd":{"total": 485.52, "avg": 15.17, "max": 12.53, "min": 18.64, "cnt": 32}, "MoEMLP":{"total": 1643.44, "avg": 12.84, "max": 10.58, "min": 18.59, "cnt": 128}, "MoE_L1_fwd":{"total": 373.23, "avg": 11.66, "max": 10.63, "min": 16.06, "cnt": 32}, "MoE_L2_fwd":{"total": 390.50, "avg": 12.20, "max": 11.71, "min": 13.05, "cnt": 32}, "MoE_L3_fwd":{"total": 400.53, "avg": 12.52, "max": 11.71, "min": 13.39, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 2.69, "avg": 1.35, "max": 0.95, "min": 1.75, "cnt": 2}, "forward-send-backward-recv":{"total": 1037.29, "avg": 34.58, "max": 1.48, "min": 265.54, "cnt": 30}, "backward-compute":{"total": 1809.95, "avg": 56.56, "max": 54.66, "min": 60.72, "cnt": 32}, "MoE_L3_bwd":{"total": 461.64, "avg": 14.43, "max": 12.74, "min": 18.42, "cnt": 32}, "MoE_L2_bwd":{"total": 399.68, "avg": 12.49, "max": 11.79, "min": 13.47, "cnt": 32}, "MoE_L1_bwd":{"total": 314.60, "avg": 9.83, "max": 9.48, "min": 10.52, "cnt": 32}, "MoE_L0_bwd":{"total": 423.59, "avg": 13.24, "max": 12.72, "min": 14.32, "cnt": 32}, "backward-send-forward-recv":{"total": 2074.84, "avg": 71.55, "max": 2.15, "min": 285.37, "cnt": 29}, "backward-send":{"total": 2.63, "avg": 0.88, "max": 0.75, "min": 1.11, "cnt": 3}, "backward-recv":{"total": 179.20, "avg": 89.60, "max": 71.09, "min": 108.12, "cnt": 2}, "backward-params-all-reduce":{"total": 486.88, "avg": 486.88, "max": 486.88, "min": 486.88, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 249.48, "avg": 249.48, "max": 249.48, "min": 249.48, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 209.59, "avg": 209.59, "max": 209.59, "min": 209.59, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.32, "avg": 3.32, "max": 3.32, "min": 3.32, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 106, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 74.51, "avg": 24.84, "max": 1.54, "min": 70.53, "cnt": 3}, "forward-compute":{"total": 1935.23, "avg": 60.48, "max": 53.46, "min": 79.14, "cnt": 32}, "fwd-compute":{"total": 1932.13, "avg": 60.38, "max": 53.39, "min": 79.07, "cnt": 32}, "batch-generator":{"total": 57.01, "avg": 1.78, "max": 0.66, "min": 3.52, "cnt": 32}, "fwd-embedding":{"total": 0.57, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1863.36, "avg": 58.23, "max": 51.70, "min": 77.55, "cnt": 32}, "fwd-layernorm":{"total": 9.15, "avg": 0.07, "max": 0.05, "min": 0.17, "cnt": 128}, "fwd-attn":{"total": 104.79, "avg": 0.82, "max": 0.74, "min": 1.51, "cnt": 128}, "fwd-misc":{"total": 19.62, "avg": 0.15, "max": 0.11, "min": 0.34, "cnt": 128}, "fwd-MLP":{"total": 1709.94, "avg": 13.36, "max": 10.72, "min": 37.09, "cnt": 128}, "MoE_L0_fwd":{"total": 527.16, "avg": 16.47, "max": 12.33, "min": 37.02, "cnt": 32}, "MoEMLP":{"total": 1693.94, "avg": 13.23, "max": 10.62, "min": 36.98, "cnt": 128}, "MoE_L1_fwd":{"total": 381.48, "avg": 11.92, "max": 10.66, "min": 16.72, "cnt": 32}, "MoE_L2_fwd":{"total": 395.36, "avg": 12.35, "max": 11.59, "min": 14.98, "cnt": 32}, "MoE_L3_fwd":{"total": 395.85, "avg": 12.37, "max": 11.72, "min": 15.74, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.86, "avg": 0.93, "max": 0.92, "min": 0.94, "cnt": 2}, "forward-send-backward-recv":{"total": 308.91, "avg": 10.30, "max": 1.13, "min": 129.24, "cnt": 30}, "backward-compute":{"total": 1817.07, "avg": 56.78, "max": 53.66, "min": 59.02, "cnt": 32}, "MoE_L3_bwd":{"total": 450.06, "avg": 14.06, "max": 12.47, "min": 16.74, "cnt": 32}, "MoE_L2_bwd":{"total": 397.81, "avg": 12.43, "max": 11.59, "min": 13.18, "cnt": 32}, "MoE_L1_bwd":{"total": 324.15, "avg": 10.13, "max": 9.36, "min": 11.63, "cnt": 32}, "MoE_L0_bwd":{"total": 431.09, "avg": 13.47, "max": 12.77, "min": 14.00, "cnt": 32}, "backward-send-forward-recv":{"total": 3690.03, "avg": 127.24, "max": 1.73, "min": 700.44, "cnt": 29}, "backward-send":{"total": 2.09, "avg": 0.70, "max": 0.68, "min": 0.72, "cnt": 3}, "backward-recv":{"total": 200.14, "avg": 100.07, "max": 70.38, "min": 129.76, "cnt": 2}, "backward-params-all-reduce":{"total": 484.23, "avg": 484.23, "max": 484.23, "min": 484.23, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 254.62, "avg": 254.62, "max": 254.62, "min": 254.62, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 207.89, "avg": 207.89, "max": 207.89, "min": 207.89, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.28, "avg": 6.28, "max": 6.28, "min": 6.28, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 107, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 67.63, "avg": 22.54, "max": 1.29, "min": 64.08, "cnt": 3}, "forward-compute":{"total": 1928.69, "avg": 60.27, "max": 53.66, "min": 70.01, "cnt": 32}, "fwd-compute":{"total": 1925.38, "avg": 60.17, "max": 53.59, "min": 69.93, "cnt": 32}, "batch-generator":{"total": 40.93, "avg": 1.28, "max": 0.69, "min": 1.87, "cnt": 32}, "fwd-embedding":{"total": 0.70, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1871.80, "avg": 58.49, "max": 52.60, "min": 68.73, "cnt": 32}, "fwd-layernorm":{"total": 10.13, "avg": 0.08, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 111.17, "avg": 0.87, "max": 0.74, "min": 1.90, "cnt": 128}, "fwd-misc":{"total": 21.69, "avg": 0.17, "max": 0.11, "min": 0.52, "cnt": 128}, "fwd-MLP":{"total": 1707.42, "avg": 13.34, "max": 10.89, "min": 20.60, "cnt": 128}, "MoE_L0_fwd":{"total": 521.03, "avg": 16.28, "max": 12.90, "min": 20.52, "cnt": 32}, "MoEMLP":{"total": 1690.10, "avg": 13.20, "max": 10.77, "min": 20.48, "cnt": 128}, "MoE_L1_fwd":{"total": 384.44, "avg": 12.01, "max": 10.82, "min": 15.01, "cnt": 32}, "MoE_L2_fwd":{"total": 394.49, "avg": 12.33, "max": 11.61, "min": 15.38, "cnt": 32}, "MoE_L3_fwd":{"total": 396.47, "avg": 12.39, "max": 11.64, "min": 18.66, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.82, "avg": 0.91, "max": 0.89, "min": 0.94, "cnt": 2}, "forward-send-backward-recv":{"total": 1282.51, "avg": 42.75, "max": 1.80, "min": 259.14, "cnt": 30}, "backward-compute":{"total": 1823.58, "avg": 56.99, "max": 55.47, "min": 58.25, "cnt": 32}, "MoE_L3_bwd":{"total": 442.37, "avg": 13.82, "max": 12.66, "min": 14.62, "cnt": 32}, "MoE_L2_bwd":{"total": 411.25, "avg": 12.85, "max": 12.28, "min": 13.69, "cnt": 32}, "MoE_L1_bwd":{"total": 325.22, "avg": 10.16, "max": 9.71, "min": 10.99, "cnt": 32}, "MoE_L0_bwd":{"total": 430.23, "avg": 13.44, "max": 13.06, "min": 14.22, "cnt": 32}, "backward-send-forward-recv":{"total": 1939.85, "avg": 66.89, "max": 1.44, "min": 672.00, "cnt": 29}, "backward-send":{"total": 2.44, "avg": 0.81, "max": 0.46, "min": 1.05, "cnt": 3}, "backward-recv":{"total": 438.90, "avg": 219.45, "max": 70.25, "min": 368.65, "cnt": 2}, "backward-params-all-reduce":{"total": 484.26, "avg": 484.26, "max": 484.26, "min": 484.26, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 242.45, "avg": 242.45, "max": 242.45, "min": 242.45, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 202.60, "avg": 202.60, "max": 202.60, "min": 202.60, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.28, "avg": 3.28, "max": 3.28, "min": 3.28, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 108, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 82.62, "avg": 27.54, "max": 1.22, "min": 78.76, "cnt": 3}, "forward-compute":{"total": 1949.05, "avg": 60.91, "max": 53.84, "min": 70.88, "cnt": 32}, "fwd-compute":{"total": 1945.65, "avg": 60.80, "max": 53.75, "min": 70.81, "cnt": 32}, "batch-generator":{"total": 44.72, "avg": 1.40, "max": 0.67, "min": 3.71, "cnt": 32}, "fwd-embedding":{"total": 0.66, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1887.67, "avg": 58.99, "max": 52.57, "min": 69.00, "cnt": 32}, "fwd-layernorm":{"total": 10.07, "avg": 0.08, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 113.57, "avg": 0.89, "max": 0.74, "min": 1.97, "cnt": 128}, "fwd-misc":{"total": 22.32, "avg": 0.17, "max": 0.11, "min": 0.38, "cnt": 128}, "fwd-MLP":{"total": 1719.77, "avg": 13.44, "max": 10.85, "min": 23.13, "cnt": 128}, "MoE_L0_fwd":{"total": 526.90, "avg": 16.47, "max": 12.70, "min": 23.05, "cnt": 32}, "MoEMLP":{"total": 1701.94, "avg": 13.30, "max": 10.74, "min": 23.00, "cnt": 128}, "MoE_L1_fwd":{"total": 382.12, "avg": 11.94, "max": 10.78, "min": 16.34, "cnt": 32}, "MoE_L2_fwd":{"total": 400.10, "avg": 12.50, "max": 11.80, "min": 14.45, "cnt": 32}, "MoE_L3_fwd":{"total": 399.29, "avg": 12.48, "max": 11.57, "min": 14.12, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.62, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.83, "avg": 0.92, "max": 0.91, "min": 0.92, "cnt": 2}, "forward-send-backward-recv":{"total": 1335.30, "avg": 44.51, "max": 1.07, "min": 369.32, "cnt": 30}, "backward-compute":{"total": 1828.12, "avg": 57.13, "max": 54.51, "min": 60.31, "cnt": 32}, "MoE_L3_bwd":{"total": 461.63, "avg": 14.43, "max": 13.48, "min": 18.19, "cnt": 32}, "MoE_L2_bwd":{"total": 419.68, "avg": 13.12, "max": 12.60, "min": 13.84, "cnt": 32}, "MoE_L1_bwd":{"total": 317.19, "avg": 9.91, "max": 9.51, "min": 10.75, "cnt": 32}, "MoE_L0_bwd":{"total": 417.65, "avg": 13.05, "max": 12.36, "min": 13.83, "cnt": 32}, "backward-send-forward-recv":{"total": 2102.68, "avg": 72.51, "max": 1.57, "min": 327.97, "cnt": 29}, "backward-send":{"total": 3.10, "avg": 1.03, "max": 0.90, "min": 1.13, "cnt": 3}, "backward-recv":{"total": 434.04, "avg": 217.02, "max": 69.80, "min": 364.25, "cnt": 2}, "backward-params-all-reduce":{"total": 484.79, "avg": 484.79, "max": 484.79, "min": 484.79, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 247.35, "avg": 247.35, "max": 247.35, "min": 247.35, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.36, "avg": 3.36, "max": 3.36, "min": 3.36, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 207.61, "avg": 207.61, "max": 207.61, "min": 207.61, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.31, "avg": 3.31, "max": 3.31, "min": 3.31, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 109, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 81.99, "avg": 27.33, "max": 3.17, "min": 72.47, "cnt": 3}, "forward-compute":{"total": 1867.01, "avg": 58.34, "max": 53.08, "min": 63.76, "cnt": 32}, "fwd-compute":{"total": 1864.00, "avg": 58.25, "max": 53.01, "min": 63.65, "cnt": 32}, "batch-generator":{"total": 37.43, "avg": 1.17, "max": 0.67, "min": 2.21, "cnt": 32}, "fwd-embedding":{"total": 0.57, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1814.47, "avg": 56.70, "max": 52.00, "min": 61.75, "cnt": 32}, "fwd-layernorm":{"total": 9.36, "avg": 0.07, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 108.97, "avg": 0.85, "max": 0.74, "min": 1.50, "cnt": 128}, "fwd-misc":{"total": 20.32, "avg": 0.16, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1654.81, "avg": 12.93, "max": 10.62, "min": 19.39, "cnt": 128}, "MoE_L0_fwd":{"total": 472.67, "avg": 14.77, "max": 12.65, "min": 19.28, "cnt": 32}, "MoEMLP":{"total": 1637.74, "avg": 12.79, "max": 10.51, "min": 19.23, "cnt": 128}, "MoE_L1_fwd":{"total": 376.06, "avg": 11.75, "max": 10.55, "min": 13.95, "cnt": 32}, "MoE_L2_fwd":{"total": 400.97, "avg": 12.53, "max": 12.09, "min": 13.63, "cnt": 32}, "MoE_L3_fwd":{"total": 394.12, "avg": 12.32, "max": 11.70, "min": 14.42, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 2.11, "avg": 1.05, "max": 0.81, "min": 1.30, "cnt": 2}, "forward-send-backward-recv":{"total": 259.98, "avg": 8.67, "max": 0.85, "min": 127.76, "cnt": 30}, "backward-compute":{"total": 1809.53, "avg": 56.55, "max": 54.16, "min": 57.81, "cnt": 32}, "MoE_L3_bwd":{"total": 455.03, "avg": 14.22, "max": 13.46, "min": 15.91, "cnt": 32}, "MoE_L2_bwd":{"total": 431.31, "avg": 13.48, "max": 12.90, "min": 14.47, "cnt": 32}, "MoE_L1_bwd":{"total": 308.99, "avg": 9.66, "max": 9.04, "min": 10.37, "cnt": 32}, "MoE_L0_bwd":{"total": 401.73, "avg": 12.55, "max": 11.94, "min": 13.19, "cnt": 32}, "backward-send-forward-recv":{"total": 2651.50, "avg": 91.43, "max": 1.29, "min": 385.98, "cnt": 29}, "backward-send":{"total": 1.74, "avg": 0.58, "max": 0.51, "min": 0.71, "cnt": 3}, "backward-recv":{"total": 122.56, "avg": 61.28, "max": 54.01, "min": 68.54, "cnt": 2}, "backward-params-all-reduce":{"total": 485.16, "avg": 485.16, "max": 485.16, "min": 485.16, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 246.07, "avg": 246.07, "max": 246.07, "min": 246.07, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.36, "avg": 3.36, "max": 3.36, "min": 3.36, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 206.39, "avg": 206.39, "max": 206.39, "min": 206.39, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.25, "avg": 3.25, "max": 3.25, "min": 3.25, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.41, "avg": 3.41, "max": 3.41, "min": 3.41, "cnt": 1}}}
{"type":"time", "iteration": 110, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 72.93, "avg": 24.31, "max": 0.78, "min": 71.17, "cnt": 3}, "forward-compute":{"total": 1914.99, "avg": 59.84, "max": 54.28, "min": 65.16, "cnt": 32}, "fwd-compute":{"total": 1911.54, "avg": 59.74, "max": 54.21, "min": 65.06, "cnt": 32}, "batch-generator":{"total": 49.07, "avg": 1.53, "max": 0.72, "min": 4.65, "cnt": 32}, "fwd-embedding":{"total": 0.72, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1849.25, "avg": 57.79, "max": 53.17, "min": 63.62, "cnt": 32}, "fwd-layernorm":{"total": 10.62, "avg": 0.08, "max": 0.05, "min": 0.22, "cnt": 128}, "fwd-attn":{"total": 113.85, "avg": 0.89, "max": 0.74, "min": 1.62, "cnt": 128}, "fwd-misc":{"total": 22.53, "avg": 0.18, "max": 0.11, "min": 0.44, "cnt": 128}, "fwd-MLP":{"total": 1679.83, "avg": 13.12, "max": 10.37, "min": 18.73, "cnt": 128}, "MoE_L0_fwd":{"total": 495.42, "avg": 15.48, "max": 13.27, "min": 18.62, "cnt": 32}, "MoEMLP":{"total": 1661.65, "avg": 12.98, "max": 10.26, "min": 18.56, "cnt": 128}, "MoE_L1_fwd":{"total": 363.58, "avg": 11.36, "max": 10.30, "min": 13.14, "cnt": 32}, "MoE_L2_fwd":{"total": 412.22, "avg": 12.88, "max": 12.38, "min": 15.06, "cnt": 32}, "MoE_L3_fwd":{"total": 397.05, "avg": 12.41, "max": 11.01, "min": 18.23, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 2.05, "avg": 1.02, "max": 0.67, "min": 1.38, "cnt": 2}, "forward-send-backward-recv":{"total": 1890.08, "avg": 63.00, "max": 1.89, "min": 310.03, "cnt": 30}, "backward-compute":{"total": 1797.10, "avg": 56.16, "max": 54.76, "min": 57.70, "cnt": 32}, "MoE_L3_bwd":{"total": 439.36, "avg": 13.73, "max": 12.13, "min": 14.95, "cnt": 32}, "MoE_L2_bwd":{"total": 436.80, "avg": 13.65, "max": 12.81, "min": 14.72, "cnt": 32}, "MoE_L1_bwd":{"total": 312.31, "avg": 9.76, "max": 9.22, "min": 11.96, "cnt": 32}, "MoE_L0_bwd":{"total": 395.22, "avg": 12.35, "max": 11.76, "min": 13.08, "cnt": 32}, "backward-send-forward-recv":{"total": 2076.52, "avg": 71.60, "max": 1.61, "min": 697.50, "cnt": 29}, "backward-send":{"total": 3.25, "avg": 1.08, "max": 1.02, "min": 1.12, "cnt": 3}, "backward-recv":{"total": 191.45, "avg": 95.73, "max": 67.15, "min": 124.30, "cnt": 2}, "backward-params-all-reduce":{"total": 483.54, "avg": 483.54, "max": 483.54, "min": 483.54, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 246.84, "avg": 246.84, "max": 246.84, "min": 246.84, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 206.92, "avg": 206.92, "max": 206.92, "min": 206.92, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.33, "avg": 3.33, "max": 3.33, "min": 3.33, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 111, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.06, "avg": 0.06, "max": 0.06, "min": 0.06, "cnt": 1}, "forward-recv":{"total": 80.49, "avg": 26.83, "max": 2.49, "min": 75.48, "cnt": 3}, "forward-compute":{"total": 1874.49, "avg": 58.58, "max": 53.44, "min": 63.84, "cnt": 32}, "fwd-compute":{"total": 1871.32, "avg": 58.48, "max": 53.34, "min": 63.77, "cnt": 32}, "batch-generator":{"total": 59.90, "avg": 1.87, "max": 0.71, "min": 3.68, "cnt": 32}, "fwd-embedding":{"total": 0.71, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1798.25, "avg": 56.20, "max": 51.27, "min": 60.55, "cnt": 32}, "fwd-layernorm":{"total": 10.03, "avg": 0.08, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 108.57, "avg": 0.85, "max": 0.74, "min": 1.47, "cnt": 128}, "fwd-misc":{"total": 21.13, "avg": 0.17, "max": 0.11, "min": 0.34, "cnt": 128}, "fwd-MLP":{"total": 1637.16, "avg": 12.79, "max": 10.04, "min": 18.56, "cnt": 128}, "MoE_L0_fwd":{"total": 464.87, "avg": 14.53, "max": 11.97, "min": 18.47, "cnt": 32}, "MoEMLP":{"total": 1620.09, "avg": 12.66, "max": 9.93, "min": 18.42, "cnt": 128}, "MoE_L1_fwd":{"total": 362.70, "avg": 11.33, "max": 9.97, "min": 13.57, "cnt": 32}, "MoE_L2_fwd":{"total": 418.13, "avg": 13.07, "max": 12.29, "min": 15.51, "cnt": 32}, "MoE_L3_fwd":{"total": 380.66, "avg": 11.90, "max": 11.11, "min": 13.65, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.56, "avg": 0.78, "max": 0.68, "min": 0.88, "cnt": 2}, "forward-send-backward-recv":{"total": 191.65, "avg": 6.39, "max": 1.65, "min": 122.83, "cnt": 30}, "backward-compute":{"total": 1802.21, "avg": 56.32, "max": 55.07, "min": 58.76, "cnt": 32}, "MoE_L3_bwd":{"total": 441.08, "avg": 13.78, "max": 12.62, "min": 14.85, "cnt": 32}, "MoE_L2_bwd":{"total": 441.57, "avg": 13.80, "max": 13.19, "min": 14.94, "cnt": 32}, "MoE_L1_bwd":{"total": 315.08, "avg": 9.85, "max": 9.21, "min": 10.82, "cnt": 32}, "MoE_L0_bwd":{"total": 390.79, "avg": 12.21, "max": 11.77, "min": 12.55, "cnt": 32}, "backward-send-forward-recv":{"total": 2422.76, "avg": 83.54, "max": 2.15, "min": 291.02, "cnt": 29}, "backward-send":{"total": 3.15, "avg": 1.05, "max": 0.96, "min": 1.13, "cnt": 3}, "backward-recv":{"total": 120.66, "avg": 60.33, "max": 54.56, "min": 66.09, "cnt": 2}, "backward-params-all-reduce":{"total": 486.65, "avg": 486.65, "max": 486.65, "min": 486.65, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 252.73, "avg": 252.73, "max": 252.73, "min": 252.73, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 206.28, "avg": 206.28, "max": 206.28, "min": 206.28, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.28, "avg": 3.28, "max": 3.28, "min": 3.28, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}}}
{"type":"time", "iteration": 112, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 77.31, "avg": 25.77, "max": 3.13, "min": 63.94, "cnt": 3}, "forward-compute":{"total": 1941.45, "avg": 60.67, "max": 53.30, "min": 119.86, "cnt": 32}, "fwd-compute":{"total": 1938.31, "avg": 60.57, "max": 53.23, "min": 119.73, "cnt": 32}, "batch-generator":{"total": 42.39, "avg": 1.32, "max": 0.68, "min": 3.25, "cnt": 32}, "fwd-embedding":{"total": 0.60, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1883.30, "avg": 58.85, "max": 52.18, "min": 117.54, "cnt": 32}, "fwd-layernorm":{"total": 9.78, "avg": 0.08, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 111.14, "avg": 0.87, "max": 0.74, "min": 1.99, "cnt": 128}, "fwd-misc":{"total": 21.33, "avg": 0.17, "max": 0.11, "min": 0.53, "cnt": 128}, "fwd-MLP":{"total": 1719.24, "avg": 13.43, "max": 10.38, "min": 74.91, "cnt": 128}, "MoE_L0_fwd":{"total": 543.64, "avg": 16.99, "max": 12.36, "min": 74.77, "cnt": 32}, "MoEMLP":{"total": 1701.76, "avg": 13.30, "max": 10.27, "min": 74.69, "cnt": 128}, "MoE_L1_fwd":{"total": 365.86, "avg": 11.43, "max": 10.31, "min": 16.01, "cnt": 32}, "MoE_L2_fwd":{"total": 424.14, "avg": 13.25, "max": 12.44, "min": 15.29, "cnt": 32}, "MoE_L3_fwd":{"total": 374.39, "avg": 11.70, "max": 10.83, "min": 14.55, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.83, "avg": 0.91, "max": 0.84, "min": 0.99, "cnt": 2}, "forward-send-backward-recv":{"total": 464.81, "avg": 15.49, "max": 1.21, "min": 167.68, "cnt": 30}, "backward-compute":{"total": 1797.35, "avg": 56.17, "max": 53.48, "min": 58.34, "cnt": 32}, "MoE_L3_bwd":{"total": 423.01, "avg": 13.22, "max": 12.04, "min": 14.90, "cnt": 32}, "MoE_L2_bwd":{"total": 448.69, "avg": 14.02, "max": 13.48, "min": 14.59, "cnt": 32}, "MoE_L1_bwd":{"total": 315.84, "avg": 9.87, "max": 9.45, "min": 10.39, "cnt": 32}, "MoE_L0_bwd":{"total": 396.50, "avg": 12.39, "max": 11.72, "min": 13.74, "cnt": 32}, "backward-send-forward-recv":{"total": 2949.78, "avg": 101.72, "max": 2.20, "min": 686.31, "cnt": 29}, "backward-send":{"total": 2.86, "avg": 0.95, "max": 0.90, "min": 0.99, "cnt": 3}, "backward-recv":{"total": 140.45, "avg": 70.22, "max": 69.38, "min": 71.07, "cnt": 2}, "backward-params-all-reduce":{"total": 482.48, "avg": 482.48, "max": 482.48, "min": 482.48, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 249.03, "avg": 249.03, "max": 249.03, "min": 249.03, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.36, "avg": 3.36, "max": 3.36, "min": 3.36, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 209.24, "avg": 209.24, "max": 209.24, "min": 209.24, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.31, "avg": 3.31, "max": 3.31, "min": 3.31, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.41, "avg": 3.41, "max": 3.41, "min": 3.41, "cnt": 1}}}
{"type":"time", "iteration": 113, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 2768.48, "avg": 922.83, "max": 0.95, "min": 2766.50, "cnt": 3}, "forward-compute":{"total": 1904.06, "avg": 59.50, "max": 53.17, "min": 66.89, "cnt": 32}, "fwd-compute":{"total": 1901.00, "avg": 59.41, "max": 53.09, "min": 66.80, "cnt": 32}, "batch-generator":{"total": 49.94, "avg": 1.56, "max": 0.74, "min": 7.69, "cnt": 32}, "fwd-embedding":{"total": 0.63, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1838.17, "avg": 57.44, "max": 50.53, "min": 65.17, "cnt": 32}, "fwd-layernorm":{"total": 9.87, "avg": 0.08, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 108.14, "avg": 0.84, "max": 0.74, "min": 2.02, "cnt": 128}, "fwd-misc":{"total": 20.78, "avg": 0.16, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1678.23, "avg": 13.11, "max": 10.65, "min": 20.60, "cnt": 128}, "MoE_L0_fwd":{"total": 495.56, "avg": 15.49, "max": 11.85, "min": 20.51, "cnt": 32}, "MoEMLP":{"total": 1661.14, "avg": 12.98, "max": 10.53, "min": 20.46, "cnt": 128}, "MoE_L1_fwd":{"total": 382.67, "avg": 11.96, "max": 10.58, "min": 16.24, "cnt": 32}, "MoE_L2_fwd":{"total": 412.24, "avg": 12.88, "max": 12.34, "min": 13.64, "cnt": 32}, "MoE_L3_fwd":{"total": 376.91, "avg": 11.78, "max": 11.05, "min": 14.69, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 9.75, "avg": 4.88, "max": 0.75, "min": 9.01, "cnt": 2}, "forward-send-backward-recv":{"total": 2384.60, "avg": 79.49, "max": 1.82, "min": 765.72, "cnt": 30}, "backward-compute":{"total": 1794.72, "avg": 56.08, "max": 54.59, "min": 58.48, "cnt": 32}, "MoE_L3_bwd":{"total": 428.94, "avg": 13.40, "max": 11.41, "min": 15.71, "cnt": 32}, "MoE_L2_bwd":{"total": 444.97, "avg": 13.91, "max": 13.13, "min": 15.16, "cnt": 32}, "MoE_L1_bwd":{"total": 314.28, "avg": 9.82, "max": 9.44, "min": 10.67, "cnt": 32}, "MoE_L0_bwd":{"total": 394.25, "avg": 12.32, "max": 11.56, "min": 12.86, "cnt": 32}, "backward-send-forward-recv":{"total": 2469.13, "avg": 85.14, "max": 1.03, "min": 482.97, "cnt": 29}, "backward-send":{"total": 2.37, "avg": 0.79, "max": 0.55, "min": 1.21, "cnt": 3}, "backward-recv":{"total": 395.80, "avg": 197.90, "max": 74.36, "min": 321.45, "cnt": 2}, "backward-params-all-reduce":{"total": 485.18, "avg": 485.18, "max": 485.18, "min": 485.18, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 255.70, "avg": 255.70, "max": 255.70, "min": 255.70, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 208.43, "avg": 208.43, "max": 208.43, "min": 208.43, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.30, "avg": 6.30, "max": 6.30, "min": 6.30, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 114, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 934.84, "avg": 311.61, "max": 0.71, "min": 933.17, "cnt": 3}, "forward-compute":{"total": 1881.43, "avg": 58.79, "max": 52.19, "min": 64.03, "cnt": 32}, "fwd-compute":{"total": 1878.28, "avg": 58.70, "max": 52.12, "min": 63.95, "cnt": 32}, "batch-generator":{"total": 51.99, "avg": 1.62, "max": 0.71, "min": 4.70, "cnt": 32}, "fwd-embedding":{"total": 0.66, "avg": 0.02, "max": 0.01, "min": 0.06, "cnt": 32}, "fwd-encoder":{"total": 1813.68, "avg": 56.68, "max": 51.12, "min": 61.33, "cnt": 32}, "fwd-layernorm":{"total": 9.70, "avg": 0.08, "max": 0.05, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 110.13, "avg": 0.86, "max": 0.74, "min": 2.13, "cnt": 128}, "fwd-misc":{"total": 21.01, "avg": 0.16, "max": 0.11, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1651.87, "avg": 12.91, "max": 10.64, "min": 19.54, "cnt": 128}, "MoE_L0_fwd":{"total": 485.48, "avg": 15.17, "max": 12.20, "min": 19.40, "cnt": 32}, "MoEMLP":{"total": 1635.02, "avg": 12.77, "max": 10.54, "min": 19.30, "cnt": 128}, "MoE_L1_fwd":{"total": 376.49, "avg": 11.77, "max": 10.58, "min": 16.05, "cnt": 32}, "MoE_L2_fwd":{"total": 411.41, "avg": 12.86, "max": 12.48, "min": 14.76, "cnt": 32}, "MoE_L3_fwd":{"total": 367.85, "avg": 11.50, "max": 11.00, "min": 12.30, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 9.78, "avg": 4.89, "max": 0.61, "min": 9.17, "cnt": 2}, "forward-send-backward-recv":{"total": 229.36, "avg": 7.65, "max": 1.66, "min": 142.51, "cnt": 30}, "backward-compute":{"total": 1784.46, "avg": 55.76, "max": 53.95, "min": 57.98, "cnt": 32}, "MoE_L3_bwd":{"total": 412.11, "avg": 12.88, "max": 11.35, "min": 14.42, "cnt": 32}, "MoE_L2_bwd":{"total": 438.13, "avg": 13.69, "max": 12.62, "min": 14.81, "cnt": 32}, "MoE_L1_bwd":{"total": 315.32, "avg": 9.85, "max": 9.43, "min": 10.37, "cnt": 32}, "MoE_L0_bwd":{"total": 406.08, "avg": 12.69, "max": 12.10, "min": 13.04, "cnt": 32}, "backward-send-forward-recv":{"total": 3413.96, "avg": 117.72, "max": 2.02, "min": 489.76, "cnt": 29}, "backward-send":{"total": 3.49, "avg": 1.16, "max": 1.14, "min": 1.17, "cnt": 3}, "backward-recv":{"total": 128.78, "avg": 64.39, "max": 62.17, "min": 66.60, "cnt": 2}, "backward-params-all-reduce":{"total": 482.51, "avg": 482.51, "max": 482.51, "min": 482.51, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.04, "avg": 0.04, "max": 0.04, "min": 0.04, "cnt": 1}, "optimizer":{"total": 246.57, "avg": 246.57, "max": 246.57, "min": 246.57, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 206.69, "avg": 206.69, "max": 206.69, "min": 206.69, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.23, "avg": 3.23, "max": 3.23, "min": 3.23, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 115, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 75.62, "avg": 25.21, "max": 0.69, "min": 72.76, "cnt": 3}, "forward-compute":{"total": 1852.37, "avg": 57.89, "max": 52.61, "min": 63.90, "cnt": 32}, "fwd-compute":{"total": 1849.34, "avg": 57.79, "max": 52.54, "min": 63.83, "cnt": 32}, "batch-generator":{"total": 45.76, "avg": 1.43, "max": 0.69, "min": 4.41, "cnt": 32}, "fwd-embedding":{"total": 0.51, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1791.33, "avg": 55.98, "max": 51.55, "min": 61.67, "cnt": 32}, "fwd-layernorm":{"total": 8.96, "avg": 0.07, "max": 0.05, "min": 0.26, "cnt": 128}, "fwd-attn":{"total": 104.68, "avg": 0.82, "max": 0.74, "min": 2.29, "cnt": 128}, "fwd-misc":{"total": 19.09, "avg": 0.15, "max": 0.11, "min": 0.42, "cnt": 128}, "fwd-MLP":{"total": 1638.48, "avg": 12.80, "max": 10.26, "min": 18.54, "cnt": 128}, "MoE_L0_fwd":{"total": 486.06, "avg": 15.19, "max": 12.56, "min": 18.47, "cnt": 32}, "MoEMLP":{"total": 1622.66, "avg": 12.68, "max": 10.14, "min": 18.43, "cnt": 128}, "MoE_L1_fwd":{"total": 361.64, "avg": 11.30, "max": 10.19, "min": 13.29, "cnt": 32}, "MoE_L2_fwd":{"total": 413.93, "avg": 12.94, "max": 12.24, "min": 15.72, "cnt": 32}, "MoE_L3_fwd":{"total": 366.76, "avg": 11.46, "max": 10.57, "min": 17.71, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 5.68, "avg": 2.84, "max": 0.90, "min": 4.78, "cnt": 2}, "forward-send-backward-recv":{"total": 509.12, "avg": 16.97, "max": 1.57, "min": 156.60, "cnt": 30}, "backward-compute":{"total": 1762.85, "avg": 55.09, "max": 52.53, "min": 59.34, "cnt": 32}, "MoE_L3_bwd":{"total": 405.63, "avg": 12.68, "max": 11.77, "min": 14.03, "cnt": 32}, "MoE_L2_bwd":{"total": 435.86, "avg": 13.62, "max": 12.58, "min": 14.37, "cnt": 32}, "MoE_L1_bwd":{"total": 312.14, "avg": 9.75, "max": 9.17, "min": 12.77, "cnt": 32}, "MoE_L0_bwd":{"total": 394.61, "avg": 12.33, "max": 11.92, "min": 12.85, "cnt": 32}, "backward-send-forward-recv":{"total": 4645.11, "avg": 160.18, "max": 1.74, "min": 1406.31, "cnt": 29}, "backward-send":{"total": 2.09, "avg": 0.70, "max": 0.45, "min": 0.93, "cnt": 3}, "backward-recv":{"total": 138.48, "avg": 69.24, "max": 64.69, "min": 73.79, "cnt": 2}, "backward-params-all-reduce":{"total": 490.18, "avg": 490.18, "max": 490.18, "min": 490.18, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 247.66, "avg": 247.66, "max": 247.66, "min": 247.66, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 203.75, "avg": 203.75, "max": 203.75, "min": 203.75, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.60, "avg": 3.60, "max": 3.60, "min": 3.60, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 116, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 86.11, "avg": 28.70, "max": 7.25, "min": 71.27, "cnt": 3}, "forward-compute":{"total": 1850.74, "avg": 57.84, "max": 53.04, "min": 63.42, "cnt": 32}, "fwd-compute":{"total": 1847.39, "avg": 57.73, "max": 52.96, "min": 63.34, "cnt": 32}, "batch-generator":{"total": 39.80, "avg": 1.24, "max": 0.71, "min": 2.22, "cnt": 32}, "fwd-embedding":{"total": 0.64, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1794.50, "avg": 56.08, "max": 51.90, "min": 62.18, "cnt": 32}, "fwd-layernorm":{"total": 9.51, "avg": 0.07, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 107.99, "avg": 0.84, "max": 0.74, "min": 1.75, "cnt": 128}, "fwd-misc":{"total": 21.03, "avg": 0.16, "max": 0.11, "min": 0.54, "cnt": 128}, "fwd-MLP":{"total": 1634.72, "avg": 12.77, "max": 10.53, "min": 19.99, "cnt": 128}, "MoE_L0_fwd":{"total": 466.99, "avg": 14.59, "max": 11.77, "min": 19.91, "cnt": 32}, "MoEMLP":{"total": 1617.71, "avg": 12.64, "max": 10.42, "min": 19.86, "cnt": 128}, "MoE_L1_fwd":{"total": 363.92, "avg": 11.37, "max": 10.46, "min": 13.28, "cnt": 32}, "MoE_L2_fwd":{"total": 421.04, "avg": 13.16, "max": 12.44, "min": 14.00, "cnt": 32}, "MoE_L3_fwd":{"total": 371.82, "avg": 11.62, "max": 10.76, "min": 14.49, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.62, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.73, "avg": 0.86, "max": 0.72, "min": 1.00, "cnt": 2}, "forward-send-backward-recv":{"total": 1030.38, "avg": 34.35, "max": 1.22, "min": 316.72, "cnt": 30}, "backward-compute":{"total": 1758.26, "avg": 54.95, "max": 53.77, "min": 55.92, "cnt": 32}, "MoE_L3_bwd":{"total": 401.48, "avg": 12.55, "max": 11.80, "min": 13.46, "cnt": 32}, "MoE_L2_bwd":{"total": 444.83, "avg": 13.90, "max": 13.42, "min": 15.12, "cnt": 32}, "MoE_L1_bwd":{"total": 307.42, "avg": 9.61, "max": 9.15, "min": 10.31, "cnt": 32}, "MoE_L0_bwd":{"total": 390.14, "avg": 12.19, "max": 11.67, "min": 12.88, "cnt": 32}, "backward-send-forward-recv":{"total": 1539.72, "avg": 53.09, "max": 0.95, "min": 173.32, "cnt": 29}, "backward-send":{"total": 2.71, "avg": 0.90, "max": 0.58, "min": 1.34, "cnt": 3}, "backward-recv":{"total": 148.97, "avg": 74.48, "max": 73.81, "min": 75.16, "cnt": 2}, "backward-params-all-reduce":{"total": 485.88, "avg": 485.88, "max": 485.88, "min": 485.88, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 250.71, "avg": 250.71, "max": 250.71, "min": 250.71, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 205.05, "avg": 205.05, "max": 205.05, "min": 205.05, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.25, "avg": 3.25, "max": 3.25, "min": 3.25, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 117, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.10, "avg": 0.10, "max": 0.10, "min": 0.10, "cnt": 1}, "forward-recv":{"total": 76.57, "avg": 25.52, "max": 1.07, "min": 74.29, "cnt": 3}, "forward-compute":{"total": 1873.01, "avg": 58.53, "max": 53.68, "min": 64.26, "cnt": 32}, "fwd-compute":{"total": 1869.65, "avg": 58.43, "max": 53.61, "min": 64.19, "cnt": 32}, "batch-generator":{"total": 47.70, "avg": 1.49, "max": 0.70, "min": 2.77, "cnt": 32}, "fwd-embedding":{"total": 0.66, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1808.99, "avg": 56.53, "max": 52.45, "min": 61.65, "cnt": 32}, "fwd-layernorm":{"total": 9.88, "avg": 0.08, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 110.64, "avg": 0.86, "max": 0.74, "min": 2.18, "cnt": 128}, "fwd-misc":{"total": 21.31, "avg": 0.17, "max": 0.11, "min": 0.40, "cnt": 128}, "fwd-MLP":{"total": 1645.94, "avg": 12.86, "max": 10.45, "min": 19.87, "cnt": 128}, "MoE_L0_fwd":{"total": 477.07, "avg": 14.91, "max": 11.96, "min": 19.75, "cnt": 32}, "MoEMLP":{"total": 1628.60, "avg": 12.72, "max": 10.33, "min": 19.71, "cnt": 128}, "MoE_L1_fwd":{"total": 363.34, "avg": 11.35, "max": 10.38, "min": 13.16, "cnt": 32}, "MoE_L2_fwd":{"total": 412.76, "avg": 12.90, "max": 12.31, "min": 14.12, "cnt": 32}, "MoE_L3_fwd":{"total": 381.82, "avg": 11.93, "max": 10.98, "min": 15.78, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.70, "avg": 0.85, "max": 0.76, "min": 0.94, "cnt": 2}, "forward-send-backward-recv":{"total": 832.65, "avg": 27.76, "max": 0.90, "min": 231.20, "cnt": 30}, "backward-compute":{"total": 1761.34, "avg": 55.04, "max": 52.87, "min": 58.39, "cnt": 32}, "MoE_L3_bwd":{"total": 408.95, "avg": 12.78, "max": 11.51, "min": 14.82, "cnt": 32}, "MoE_L2_bwd":{"total": 432.00, "avg": 13.50, "max": 12.67, "min": 16.49, "cnt": 32}, "MoE_L1_bwd":{"total": 306.78, "avg": 9.59, "max": 9.30, "min": 9.86, "cnt": 32}, "MoE_L0_bwd":{"total": 398.81, "avg": 12.46, "max": 11.87, "min": 14.04, "cnt": 32}, "backward-send-forward-recv":{"total": 1964.77, "avg": 67.75, "max": 1.18, "min": 311.48, "cnt": 29}, "backward-send":{"total": 3.04, "avg": 1.01, "max": 0.94, "min": 1.09, "cnt": 3}, "backward-recv":{"total": 256.74, "avg": 128.37, "max": 112.31, "min": 144.42, "cnt": 2}, "backward-params-all-reduce":{"total": 482.82, "avg": 482.82, "max": 482.82, "min": 482.82, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 246.14, "avg": 246.14, "max": 246.14, "min": 246.14, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 206.23, "avg": 206.23, "max": 206.23, "min": 206.23, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.24, "avg": 3.24, "max": 3.24, "min": 3.24, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 118, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 74.15, "avg": 24.72, "max": 1.04, "min": 71.82, "cnt": 3}, "forward-compute":{"total": 1875.52, "avg": 58.61, "max": 52.77, "min": 63.73, "cnt": 32}, "fwd-compute":{"total": 1872.33, "avg": 58.51, "max": 52.68, "min": 63.65, "cnt": 32}, "batch-generator":{"total": 47.66, "avg": 1.49, "max": 0.65, "min": 4.40, "cnt": 32}, "fwd-embedding":{"total": 0.57, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1811.77, "avg": 56.62, "max": 51.61, "min": 60.62, "cnt": 32}, "fwd-layernorm":{"total": 9.24, "avg": 0.07, "max": 0.05, "min": 0.18, "cnt": 128}, "fwd-attn":{"total": 107.12, "avg": 0.84, "max": 0.74, "min": 1.67, "cnt": 128}, "fwd-misc":{"total": 20.50, "avg": 0.16, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1654.23, "avg": 12.92, "max": 10.53, "min": 18.18, "cnt": 128}, "MoE_L0_fwd":{"total": 486.26, "avg": 15.20, "max": 11.76, "min": 18.10, "cnt": 32}, "MoEMLP":{"total": 1637.54, "avg": 12.79, "max": 10.43, "min": 18.05, "cnt": 128}, "MoE_L1_fwd":{"total": 377.25, "avg": 11.79, "max": 10.62, "min": 15.41, "cnt": 32}, "MoE_L2_fwd":{"total": 414.01, "avg": 12.94, "max": 12.37, "min": 14.33, "cnt": 32}, "MoE_L3_fwd":{"total": 366.06, "avg": 11.44, "max": 10.47, "min": 15.20, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.61, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.68, "avg": 0.84, "max": 0.77, "min": 0.91, "cnt": 2}, "forward-send-backward-recv":{"total": 318.73, "avg": 10.62, "max": 1.76, "min": 138.80, "cnt": 30}, "backward-compute":{"total": 1772.23, "avg": 55.38, "max": 54.00, "min": 58.03, "cnt": 32}, "MoE_L3_bwd":{"total": 399.39, "avg": 12.48, "max": 10.82, "min": 16.09, "cnt": 32}, "MoE_L2_bwd":{"total": 433.31, "avg": 13.54, "max": 12.49, "min": 15.15, "cnt": 32}, "MoE_L1_bwd":{"total": 316.13, "avg": 9.88, "max": 9.31, "min": 10.70, "cnt": 32}, "MoE_L0_bwd":{"total": 408.12, "avg": 12.75, "max": 12.22, "min": 13.41, "cnt": 32}, "backward-send-forward-recv":{"total": 2768.76, "avg": 95.47, "max": 2.29, "min": 556.53, "cnt": 29}, "backward-send":{"total": 2.36, "avg": 0.79, "max": 0.47, "min": 0.96, "cnt": 3}, "backward-recv":{"total": 204.20, "avg": 102.10, "max": 73.55, "min": 130.65, "cnt": 2}, "backward-params-all-reduce":{"total": 486.65, "avg": 486.65, "max": 486.65, "min": 486.65, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 246.69, "avg": 246.69, "max": 246.69, "min": 246.69, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 206.86, "avg": 206.86, "max": 206.86, "min": 206.86, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.28, "avg": 3.28, "max": 3.28, "min": 3.28, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 119, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 80.92, "avg": 26.97, "max": 0.81, "min": 73.27, "cnt": 3}, "forward-compute":{"total": 1893.96, "avg": 59.19, "max": 53.02, "min": 64.43, "cnt": 32}, "fwd-compute":{"total": 1890.90, "avg": 59.09, "max": 52.95, "min": 64.35, "cnt": 32}, "batch-generator":{"total": 45.04, "avg": 1.41, "max": 0.69, "min": 3.15, "cnt": 32}, "fwd-embedding":{"total": 0.54, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1833.95, "avg": 57.31, "max": 51.84, "min": 63.11, "cnt": 32}, "fwd-layernorm":{"total": 9.19, "avg": 0.07, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 105.66, "avg": 0.83, "max": 0.74, "min": 1.54, "cnt": 128}, "fwd-misc":{"total": 19.93, "avg": 0.16, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1679.12, "avg": 13.12, "max": 10.63, "min": 21.23, "cnt": 128}, "MoE_L0_fwd":{"total": 506.12, "avg": 15.82, "max": 12.07, "min": 21.10, "cnt": 32}, "MoEMLP":{"total": 1662.85, "avg": 12.99, "max": 10.53, "min": 21.03, "cnt": 128}, "MoE_L1_fwd":{"total": 377.68, "avg": 11.80, "max": 10.69, "min": 14.56, "cnt": 32}, "MoE_L2_fwd":{"total": 423.58, "avg": 13.24, "max": 12.39, "min": 16.60, "cnt": 32}, "MoE_L3_fwd":{"total": 361.42, "avg": 11.29, "max": 10.57, "min": 13.54, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.58, "avg": 0.79, "max": 0.71, "min": 0.87, "cnt": 2}, "forward-send-backward-recv":{"total": 1013.03, "avg": 33.77, "max": 1.02, "min": 282.63, "cnt": 30}, "backward-compute":{"total": 1788.67, "avg": 55.90, "max": 52.79, "min": 57.91, "cnt": 32}, "MoE_L3_bwd":{"total": 404.90, "avg": 12.65, "max": 11.75, "min": 14.51, "cnt": 32}, "MoE_L2_bwd":{"total": 443.73, "avg": 13.87, "max": 13.02, "min": 14.58, "cnt": 32}, "MoE_L1_bwd":{"total": 317.11, "avg": 9.91, "max": 9.55, "min": 11.90, "cnt": 32}, "MoE_L0_bwd":{"total": 407.61, "avg": 12.74, "max": 12.16, "min": 13.18, "cnt": 32}, "backward-send-forward-recv":{"total": 2622.82, "avg": 90.44, "max": 1.15, "min": 505.92, "cnt": 29}, "backward-send":{"total": 1.77, "avg": 0.59, "max": 0.48, "min": 0.68, "cnt": 3}, "backward-recv":{"total": 308.48, "avg": 154.24, "max": 75.13, "min": 233.35, "cnt": 2}, "backward-params-all-reduce":{"total": 487.71, "avg": 487.71, "max": 487.71, "min": 487.71, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 245.77, "avg": 245.77, "max": 245.77, "min": 245.77, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 205.68, "avg": 205.68, "max": 205.68, "min": 205.68, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.56, "avg": 3.56, "max": 3.56, "min": 3.56, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 120, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 81.68, "avg": 27.23, "max": 0.79, "min": 78.12, "cnt": 3}, "forward-compute":{"total": 1955.90, "avg": 61.12, "max": 52.98, "min": 119.81, "cnt": 32}, "fwd-compute":{"total": 1952.91, "avg": 61.03, "max": 52.90, "min": 119.68, "cnt": 32}, "batch-generator":{"total": 46.64, "avg": 1.46, "max": 0.69, "min": 3.38, "cnt": 32}, "fwd-embedding":{"total": 0.60, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1893.89, "avg": 59.18, "max": 51.90, "min": 117.77, "cnt": 32}, "fwd-layernorm":{"total": 9.34, "avg": 0.07, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 106.57, "avg": 0.83, "max": 0.74, "min": 1.51, "cnt": 128}, "fwd-misc":{"total": 20.23, "avg": 0.16, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1737.26, "avg": 13.57, "max": 10.88, "min": 76.47, "cnt": 128}, "MoE_L0_fwd":{"total": 536.38, "avg": 16.76, "max": 12.38, "min": 76.38, "cnt": 32}, "MoEMLP":{"total": 1720.63, "avg": 13.44, "max": 10.76, "min": 76.32, "cnt": 128}, "MoE_L1_fwd":{"total": 378.63, "avg": 11.83, "max": 10.81, "min": 15.73, "cnt": 32}, "MoE_L2_fwd":{"total": 428.60, "avg": 13.39, "max": 12.66, "min": 15.12, "cnt": 32}, "MoE_L3_fwd":{"total": 383.12, "avg": 11.97, "max": 10.95, "min": 13.70, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.61, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 2.92, "avg": 1.46, "max": 0.86, "min": 2.06, "cnt": 2}, "forward-send-backward-recv":{"total": 196.49, "avg": 6.55, "max": 1.28, "min": 126.37, "cnt": 30}, "backward-compute":{"total": 1815.02, "avg": 56.72, "max": 55.40, "min": 60.59, "cnt": 32}, "MoE_L3_bwd":{"total": 415.54, "avg": 12.99, "max": 11.78, "min": 16.20, "cnt": 32}, "MoE_L2_bwd":{"total": 445.82, "avg": 13.93, "max": 13.24, "min": 15.15, "cnt": 32}, "MoE_L1_bwd":{"total": 321.48, "avg": 10.05, "max": 9.51, "min": 10.50, "cnt": 32}, "MoE_L0_bwd":{"total": 416.74, "avg": 13.02, "max": 12.28, "min": 13.63, "cnt": 32}, "backward-send-forward-recv":{"total": 2188.71, "avg": 75.47, "max": 2.52, "min": 350.96, "cnt": 29}, "backward-send":{"total": 2.90, "avg": 0.97, "max": 0.86, "min": 1.13, "cnt": 3}, "backward-recv":{"total": 130.21, "avg": 65.11, "max": 63.82, "min": 66.39, "cnt": 2}, "backward-params-all-reduce":{"total": 489.48, "avg": 489.48, "max": 489.48, "min": 489.48, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 246.89, "avg": 246.89, "max": 246.89, "min": 246.89, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 206.89, "avg": 206.89, "max": 206.89, "min": 206.89, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.28, "avg": 3.28, "max": 3.28, "min": 3.28, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}}}
{"type":"time", "iteration": 121, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.12, "avg": 0.12, "max": 0.12, "min": 0.12, "cnt": 1}, "forward-recv":{"total": 76.93, "avg": 25.64, "max": 1.91, "min": 72.26, "cnt": 3}, "forward-compute":{"total": 1888.99, "avg": 59.03, "max": 52.95, "min": 65.46, "cnt": 32}, "fwd-compute":{"total": 1885.88, "avg": 58.93, "max": 52.88, "min": 65.37, "cnt": 32}, "batch-generator":{"total": 46.96, "avg": 1.47, "max": 0.68, "min": 3.53, "cnt": 32}, "fwd-embedding":{"total": 0.56, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1826.40, "avg": 57.08, "max": 51.87, "min": 63.25, "cnt": 32}, "fwd-layernorm":{"total": 9.59, "avg": 0.07, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 107.13, "avg": 0.84, "max": 0.74, "min": 1.45, "cnt": 128}, "fwd-misc":{"total": 20.42, "avg": 0.16, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1667.89, "avg": 13.03, "max": 10.80, "min": 19.45, "cnt": 128}, "MoE_L0_fwd":{"total": 475.09, "avg": 14.85, "max": 12.63, "min": 19.36, "cnt": 32}, "MoEMLP":{"total": 1651.03, "avg": 12.90, "max": 10.67, "min": 19.32, "cnt": 128}, "MoE_L1_fwd":{"total": 377.61, "avg": 11.80, "max": 10.71, "min": 13.93, "cnt": 32}, "MoE_L2_fwd":{"total": 421.07, "avg": 13.16, "max": 12.46, "min": 14.08, "cnt": 32}, "MoE_L3_fwd":{"total": 383.44, "avg": 11.98, "max": 10.89, "min": 17.36, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.79, "avg": 0.90, "max": 0.84, "min": 0.95, "cnt": 2}, "forward-send-backward-recv":{"total": 245.14, "avg": 8.17, "max": 1.58, "min": 139.90, "cnt": 30}, "backward-compute":{"total": 1826.96, "avg": 57.09, "max": 54.58, "min": 59.86, "cnt": 32}, "MoE_L3_bwd":{"total": 409.55, "avg": 12.80, "max": 11.46, "min": 13.99, "cnt": 32}, "MoE_L2_bwd":{"total": 440.97, "avg": 13.78, "max": 13.10, "min": 14.52, "cnt": 32}, "MoE_L1_bwd":{"total": 328.54, "avg": 10.27, "max": 9.70, "min": 10.92, "cnt": 32}, "MoE_L0_bwd":{"total": 434.53, "avg": 13.58, "max": 12.89, "min": 16.27, "cnt": 32}, "backward-send-forward-recv":{"total": 2355.49, "avg": 81.22, "max": 2.34, "min": 384.45, "cnt": 29}, "backward-send":{"total": 3.07, "avg": 1.02, "max": 0.95, "min": 1.15, "cnt": 3}, "backward-recv":{"total": 137.19, "avg": 68.60, "max": 66.65, "min": 70.55, "cnt": 2}, "backward-params-all-reduce":{"total": 484.86, "avg": 484.86, "max": 484.86, "min": 484.86, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 252.07, "avg": 252.07, "max": 252.07, "min": 252.07, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 211.71, "avg": 211.71, "max": 211.71, "min": 211.71, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.53, "avg": 3.53, "max": 3.53, "min": 3.53, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.51, "avg": 3.51, "max": 3.51, "min": 3.51, "cnt": 1}}}
{"type":"time", "iteration": 122, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.12, "avg": 0.12, "max": 0.12, "min": 0.12, "cnt": 1}, "forward-recv":{"total": 73.97, "avg": 24.66, "max": 1.13, "min": 71.43, "cnt": 3}, "forward-compute":{"total": 1916.17, "avg": 59.88, "max": 53.84, "min": 65.39, "cnt": 32}, "fwd-compute":{"total": 1913.21, "avg": 59.79, "max": 53.77, "min": 65.31, "cnt": 32}, "batch-generator":{"total": 47.67, "avg": 1.49, "max": 0.72, "min": 2.86, "cnt": 32}, "fwd-embedding":{"total": 0.57, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1853.70, "avg": 57.93, "max": 52.74, "min": 64.14, "cnt": 32}, "fwd-layernorm":{"total": 9.18, "avg": 0.07, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 106.29, "avg": 0.83, "max": 0.74, "min": 1.50, "cnt": 128}, "fwd-misc":{"total": 19.70, "avg": 0.15, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1698.45, "avg": 13.27, "max": 11.09, "min": 22.30, "cnt": 128}, "MoE_L0_fwd":{"total": 494.12, "avg": 15.44, "max": 12.21, "min": 22.23, "cnt": 32}, "MoEMLP":{"total": 1681.88, "avg": 13.14, "max": 10.98, "min": 22.19, "cnt": 128}, "MoE_L1_fwd":{"total": 385.95, "avg": 12.06, "max": 11.02, "min": 13.80, "cnt": 32}, "MoE_L2_fwd":{"total": 425.98, "avg": 13.31, "max": 12.51, "min": 15.25, "cnt": 32}, "MoE_L3_fwd":{"total": 381.89, "avg": 11.93, "max": 11.08, "min": 12.77, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 2.13, "avg": 1.06, "max": 1.02, "min": 1.11, "cnt": 2}, "forward-send-backward-recv":{"total": 209.05, "avg": 6.97, "max": 1.51, "min": 125.17, "cnt": 30}, "backward-compute":{"total": 1826.48, "avg": 57.08, "max": 54.59, "min": 58.67, "cnt": 32}, "MoE_L3_bwd":{"total": 421.81, "avg": 13.18, "max": 12.16, "min": 14.00, "cnt": 32}, "MoE_L2_bwd":{"total": 431.25, "avg": 13.48, "max": 12.67, "min": 14.29, "cnt": 32}, "MoE_L1_bwd":{"total": 332.52, "avg": 10.39, "max": 9.89, "min": 10.94, "cnt": 32}, "MoE_L0_bwd":{"total": 426.93, "avg": 13.34, "max": 12.77, "min": 14.22, "cnt": 32}, "backward-send-forward-recv":{"total": 2581.17, "avg": 89.01, "max": 2.19, "min": 301.90, "cnt": 29}, "backward-send":{"total": 2.74, "avg": 0.91, "max": 0.74, "min": 1.05, "cnt": 3}, "backward-recv":{"total": 134.02, "avg": 67.01, "max": 65.29, "min": 68.73, "cnt": 2}, "backward-params-all-reduce":{"total": 484.55, "avg": 484.55, "max": 484.55, "min": 484.55, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.06, "avg": 0.06, "max": 0.06, "min": 0.06, "cnt": 1}, "optimizer":{"total": 249.05, "avg": 249.05, "max": 249.05, "min": 249.05, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 209.03, "avg": 209.03, "max": 209.03, "min": 209.03, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.26, "avg": 3.26, "max": 3.26, "min": 3.26, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 123, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 77.03, "avg": 25.68, "max": 1.20, "min": 73.82, "cnt": 3}, "forward-compute":{"total": 1942.57, "avg": 60.71, "max": 54.03, "min": 70.44, "cnt": 32}, "fwd-compute":{"total": 1939.10, "avg": 60.60, "max": 53.97, "min": 70.36, "cnt": 32}, "batch-generator":{"total": 44.49, "avg": 1.39, "max": 0.64, "min": 2.69, "cnt": 32}, "fwd-embedding":{"total": 0.71, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1881.20, "avg": 58.79, "max": 53.01, "min": 68.83, "cnt": 32}, "fwd-layernorm":{"total": 10.04, "avg": 0.08, "max": 0.05, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 115.06, "avg": 0.90, "max": 0.74, "min": 2.77, "cnt": 128}, "fwd-misc":{"total": 21.39, "avg": 0.17, "max": 0.11, "min": 0.55, "cnt": 128}, "fwd-MLP":{"total": 1713.37, "avg": 13.39, "max": 10.89, "min": 24.93, "cnt": 128}, "MoE_L0_fwd":{"total": 498.71, "avg": 15.58, "max": 12.49, "min": 24.77, "cnt": 32}, "MoEMLP":{"total": 1696.39, "avg": 13.25, "max": 10.78, "min": 24.68, "cnt": 128}, "MoE_L1_fwd":{"total": 385.70, "avg": 12.05, "max": 10.82, "min": 13.54, "cnt": 32}, "MoE_L2_fwd":{"total": 425.70, "avg": 13.30, "max": 12.72, "min": 16.11, "cnt": 32}, "MoE_L3_fwd":{"total": 392.53, "avg": 12.27, "max": 11.32, "min": 16.07, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.63, "avg": 0.02, "max": 0.02, "min": 0.04, "cnt": 32}, "forward-send":{"total": 1.89, "avg": 0.95, "max": 0.88, "min": 1.01, "cnt": 2}, "forward-send-backward-recv":{"total": 224.52, "avg": 7.48, "max": 1.21, "min": 140.17, "cnt": 30}, "backward-compute":{"total": 1860.92, "avg": 58.15, "max": 55.55, "min": 61.03, "cnt": 32}, "MoE_L3_bwd":{"total": 435.99, "avg": 13.62, "max": 12.60, "min": 16.69, "cnt": 32}, "MoE_L2_bwd":{"total": 442.73, "avg": 13.84, "max": 12.89, "min": 14.72, "cnt": 32}, "MoE_L1_bwd":{"total": 339.49, "avg": 10.61, "max": 10.01, "min": 11.34, "cnt": 32}, "MoE_L0_bwd":{"total": 429.66, "avg": 13.43, "max": 12.74, "min": 14.90, "cnt": 32}, "backward-send-forward-recv":{"total": 2579.84, "avg": 88.96, "max": 1.76, "min": 585.63, "cnt": 29}, "backward-send":{"total": 1.99, "avg": 0.66, "max": 0.58, "min": 0.83, "cnt": 3}, "backward-recv":{"total": 125.93, "avg": 62.96, "max": 57.56, "min": 68.37, "cnt": 2}, "backward-params-all-reduce":{"total": 487.81, "avg": 487.81, "max": 487.81, "min": 487.81, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 252.49, "avg": 252.49, "max": 252.49, "min": 252.49, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 212.40, "avg": 212.40, "max": 212.40, "min": 212.40, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.40, "avg": 3.40, "max": 3.40, "min": 3.40, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.48, "avg": 3.48, "max": 3.48, "min": 3.48, "cnt": 1}}}
{"type":"time", "iteration": 124, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.06, "avg": 0.06, "max": 0.06, "min": 0.06, "cnt": 1}, "forward-recv":{"total": 78.21, "avg": 26.07, "max": 1.71, "min": 68.67, "cnt": 3}, "forward-compute":{"total": 1968.44, "avg": 61.51, "max": 54.84, "min": 70.81, "cnt": 32}, "fwd-compute":{"total": 1965.35, "avg": 61.42, "max": 54.77, "min": 70.72, "cnt": 32}, "batch-generator":{"total": 43.87, "avg": 1.37, "max": 0.69, "min": 3.39, "cnt": 32}, "fwd-embedding":{"total": 0.67, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1908.73, "avg": 59.65, "max": 53.71, "min": 69.43, "cnt": 32}, "fwd-layernorm":{"total": 9.98, "avg": 0.08, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 111.01, "avg": 0.87, "max": 0.74, "min": 2.51, "cnt": 128}, "fwd-misc":{"total": 21.23, "avg": 0.17, "max": 0.11, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1745.25, "avg": 13.63, "max": 11.28, "min": 21.71, "cnt": 128}, "MoE_L0_fwd":{"total": 519.21, "avg": 16.23, "max": 12.53, "min": 21.54, "cnt": 32}, "MoEMLP":{"total": 1728.30, "avg": 13.50, "max": 11.17, "min": 21.42, "cnt": 128}, "MoE_L1_fwd":{"total": 403.45, "avg": 12.61, "max": 11.21, "min": 18.10, "cnt": 32}, "MoE_L2_fwd":{"total": 426.13, "avg": 13.32, "max": 12.71, "min": 14.21, "cnt": 32}, "MoE_L3_fwd":{"total": 385.77, "avg": 12.06, "max": 11.34, "min": 13.22, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.90, "avg": 0.95, "max": 0.91, "min": 0.99, "cnt": 2}, "forward-send-backward-recv":{"total": 182.93, "avg": 6.10, "max": 0.86, "min": 116.60, "cnt": 30}, "backward-compute":{"total": 1867.85, "avg": 58.37, "max": 56.25, "min": 60.49, "cnt": 32}, "MoE_L3_bwd":{"total": 439.52, "avg": 13.73, "max": 12.39, "min": 15.67, "cnt": 32}, "MoE_L2_bwd":{"total": 444.64, "avg": 13.89, "max": 13.15, "min": 15.05, "cnt": 32}, "MoE_L1_bwd":{"total": 345.16, "avg": 10.79, "max": 10.31, "min": 12.54, "cnt": 32}, "MoE_L0_bwd":{"total": 426.68, "avg": 13.33, "max": 13.06, "min": 13.67, "cnt": 32}, "backward-send-forward-recv":{"total": 3072.42, "avg": 105.95, "max": 2.16, "min": 433.27, "cnt": 29}, "backward-send":{"total": 1.90, "avg": 0.63, "max": 0.44, "min": 0.94, "cnt": 3}, "backward-recv":{"total": 143.77, "avg": 71.88, "max": 70.74, "min": 73.03, "cnt": 2}, "backward-params-all-reduce":{"total": 560.27, "avg": 560.27, "max": 560.27, "min": 560.27, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 253.88, "avg": 253.88, "max": 253.88, "min": 253.88, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.36, "avg": 3.36, "max": 3.36, "min": 3.36, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 211.31, "avg": 211.31, "max": 211.31, "min": 211.31, "cnt": 1}, "optimizer-clip-main-grad":{"total": 5.82, "avg": 5.82, "max": 5.82, "min": 5.82, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.41, "avg": 3.41, "max": 3.41, "min": 3.41, "cnt": 1}}}
{"type":"time", "iteration": 125, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 67.97, "avg": 22.66, "max": 0.70, "min": 66.42, "cnt": 3}, "forward-compute":{"total": 1985.67, "avg": 62.05, "max": 57.31, "min": 73.05, "cnt": 32}, "fwd-compute":{"total": 1982.54, "avg": 61.95, "max": 57.21, "min": 72.93, "cnt": 32}, "batch-generator":{"total": 52.41, "avg": 1.64, "max": 0.71, "min": 3.84, "cnt": 32}, "fwd-embedding":{"total": 0.66, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1917.34, "avg": 59.92, "max": 54.28, "min": 70.95, "cnt": 32}, "fwd-layernorm":{"total": 9.87, "avg": 0.08, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 115.09, "avg": 0.90, "max": 0.74, "min": 5.51, "cnt": 128}, "fwd-misc":{"total": 21.34, "avg": 0.17, "max": 0.11, "min": 0.49, "cnt": 128}, "fwd-MLP":{"total": 1750.31, "avg": 13.67, "max": 11.33, "min": 19.69, "cnt": 128}, "MoE_L0_fwd":{"total": 501.74, "avg": 15.68, "max": 12.90, "min": 19.56, "cnt": 32}, "MoEMLP":{"total": 1732.37, "avg": 13.53, "max": 11.21, "min": 18.50, "cnt": 128}, "MoE_L1_fwd":{"total": 401.31, "avg": 12.54, "max": 11.26, "min": 16.71, "cnt": 32}, "MoE_L2_fwd":{"total": 439.94, "avg": 13.75, "max": 13.05, "min": 17.38, "cnt": 32}, "MoE_L3_fwd":{"total": 396.67, "avg": 12.40, "max": 11.34, "min": 18.53, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 3.93, "avg": 1.96, "max": 0.54, "min": 3.39, "cnt": 2}, "forward-send-backward-recv":{"total": 1007.92, "avg": 33.60, "max": 1.59, "min": 253.69, "cnt": 30}, "backward-compute":{"total": 1856.69, "avg": 58.02, "max": 55.83, "min": 60.21, "cnt": 32}, "MoE_L3_bwd":{"total": 431.07, "avg": 13.47, "max": 12.16, "min": 15.34, "cnt": 32}, "MoE_L2_bwd":{"total": 444.19, "avg": 13.88, "max": 13.07, "min": 16.38, "cnt": 32}, "MoE_L1_bwd":{"total": 335.63, "avg": 10.49, "max": 9.81, "min": 11.11, "cnt": 32}, "MoE_L0_bwd":{"total": 432.27, "avg": 13.51, "max": 12.95, "min": 14.35, "cnt": 32}, "backward-send-forward-recv":{"total": 3337.79, "avg": 115.10, "max": 1.26, "min": 704.36, "cnt": 29}, "backward-send":{"total": 2.75, "avg": 0.92, "max": 0.81, "min": 1.01, "cnt": 3}, "backward-recv":{"total": 135.92, "avg": 67.96, "max": 66.39, "min": 69.53, "cnt": 2}, "backward-params-all-reduce":{"total": 489.39, "avg": 489.39, "max": 489.39, "min": 489.39, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.04, "avg": 0.04, "max": 0.04, "min": 0.04, "cnt": 1}, "optimizer":{"total": 240.25, "avg": 240.25, "max": 240.25, "min": 240.25, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 200.40, "avg": 200.40, "max": 200.40, "min": 200.40, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.30, "avg": 3.30, "max": 3.30, "min": 3.30, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.47, "avg": 3.47, "max": 3.47, "min": 3.47, "cnt": 1}}}
{"type":"time", "iteration": 126, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.10, "avg": 0.10, "max": 0.10, "min": 0.10, "cnt": 1}, "forward-recv":{"total": 76.09, "avg": 25.36, "max": 0.79, "min": 74.21, "cnt": 3}, "forward-compute":{"total": 1995.11, "avg": 62.35, "max": 53.78, "min": 114.74, "cnt": 32}, "fwd-compute":{"total": 1991.76, "avg": 62.24, "max": 53.70, "min": 114.65, "cnt": 32}, "batch-generator":{"total": 47.04, "avg": 1.47, "max": 0.65, "min": 4.30, "cnt": 32}, "fwd-embedding":{"total": 0.69, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1931.12, "avg": 60.35, "max": 52.74, "min": 113.28, "cnt": 32}, "fwd-layernorm":{"total": 10.07, "avg": 0.08, "max": 0.05, "min": 0.18, "cnt": 128}, "fwd-attn":{"total": 110.37, "avg": 0.86, "max": 0.74, "min": 1.51, "cnt": 128}, "fwd-misc":{"total": 21.31, "avg": 0.17, "max": 0.11, "min": 0.34, "cnt": 128}, "fwd-MLP":{"total": 1767.98, "avg": 13.81, "max": 11.19, "min": 71.17, "cnt": 128}, "MoE_L0_fwd":{"total": 563.81, "avg": 17.62, "max": 12.92, "min": 71.08, "cnt": 32}, "MoEMLP":{"total": 1750.66, "avg": 13.68, "max": 11.09, "min": 71.03, "cnt": 128}, "MoE_L1_fwd":{"total": 388.87, "avg": 12.15, "max": 11.16, "min": 12.90, "cnt": 32}, "MoE_L2_fwd":{"total": 418.30, "avg": 13.07, "max": 12.59, "min": 14.12, "cnt": 32}, "MoE_L3_fwd":{"total": 385.97, "avg": 12.06, "max": 11.13, "min": 16.92, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 7.70, "avg": 3.85, "max": 0.76, "min": 6.94, "cnt": 2}, "forward-send-backward-recv":{"total": 963.67, "avg": 32.12, "max": 0.88, "min": 146.96, "cnt": 30}, "backward-compute":{"total": 1863.83, "avg": 58.24, "max": 54.67, "min": 60.50, "cnt": 32}, "MoE_L3_bwd":{"total": 435.24, "avg": 13.60, "max": 12.29, "min": 15.30, "cnt": 32}, "MoE_L2_bwd":{"total": 431.35, "avg": 13.48, "max": 12.47, "min": 14.55, "cnt": 32}, "MoE_L1_bwd":{"total": 340.46, "avg": 10.64, "max": 10.06, "min": 11.14, "cnt": 32}, "MoE_L0_bwd":{"total": 443.31, "avg": 13.85, "max": 13.13, "min": 15.86, "cnt": 32}, "backward-send-forward-recv":{"total": 2047.90, "avg": 70.62, "max": 1.45, "min": 490.40, "cnt": 29}, "backward-send":{"total": 3.46, "avg": 1.15, "max": 1.00, "min": 1.29, "cnt": 3}, "backward-recv":{"total": 409.93, "avg": 204.96, "max": 66.76, "min": 343.16, "cnt": 2}, "backward-params-all-reduce":{"total": 490.14, "avg": 490.14, "max": 490.14, "min": 490.14, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 245.02, "avg": 245.02, "max": 245.02, "min": 245.02, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 201.94, "avg": 201.94, "max": 201.94, "min": 201.94, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.36, "avg": 3.36, "max": 3.36, "min": 3.36, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 127, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 80.19, "avg": 26.73, "max": 1.31, "min": 77.21, "cnt": 3}, "forward-compute":{"total": 1951.38, "avg": 60.98, "max": 55.35, "min": 65.29, "cnt": 32}, "fwd-compute":{"total": 1947.93, "avg": 60.87, "max": 55.28, "min": 65.15, "cnt": 32}, "batch-generator":{"total": 44.22, "avg": 1.38, "max": 0.72, "min": 4.00, "cnt": 32}, "fwd-embedding":{"total": 0.79, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1890.14, "avg": 59.07, "max": 54.18, "min": 63.65, "cnt": 32}, "fwd-layernorm":{"total": 10.47, "avg": 0.08, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 112.18, "avg": 0.88, "max": 0.74, "min": 1.54, "cnt": 128}, "fwd-misc":{"total": 22.03, "avg": 0.17, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1723.62, "avg": 13.47, "max": 11.31, "min": 20.58, "cnt": 128}, "MoE_L0_fwd":{"total": 500.42, "avg": 15.64, "max": 12.47, "min": 20.40, "cnt": 32}, "MoEMLP":{"total": 1705.86, "avg": 13.33, "max": 11.20, "min": 20.36, "cnt": 128}, "MoE_L1_fwd":{"total": 387.92, "avg": 12.12, "max": 11.34, "min": 13.28, "cnt": 32}, "MoE_L2_fwd":{"total": 440.08, "avg": 13.75, "max": 13.05, "min": 17.92, "cnt": 32}, "MoE_L3_fwd":{"total": 383.91, "avg": 12.00, "max": 11.24, "min": 13.40, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.61, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.99, "avg": 0.99, "max": 0.92, "min": 1.07, "cnt": 2}, "forward-send-backward-recv":{"total": 662.79, "avg": 22.09, "max": 1.11, "min": 187.62, "cnt": 30}, "backward-compute":{"total": 1870.81, "avg": 58.46, "max": 56.08, "min": 61.57, "cnt": 32}, "MoE_L3_bwd":{"total": 426.01, "avg": 13.31, "max": 11.10, "min": 16.35, "cnt": 32}, "MoE_L2_bwd":{"total": 449.98, "avg": 14.06, "max": 12.56, "min": 15.17, "cnt": 32}, "MoE_L1_bwd":{"total": 335.40, "avg": 10.48, "max": 10.15, "min": 10.87, "cnt": 32}, "MoE_L0_bwd":{"total": 445.19, "avg": 13.91, "max": 13.55, "min": 14.48, "cnt": 32}, "backward-send-forward-recv":{"total": 927.67, "avg": 31.99, "max": 1.10, "min": 178.69, "cnt": 29}, "backward-send":{"total": 1.76, "avg": 0.59, "max": 0.46, "min": 0.68, "cnt": 3}, "backward-recv":{"total": 772.44, "avg": 386.22, "max": 365.06, "min": 407.37, "cnt": 2}, "backward-params-all-reduce":{"total": 484.49, "avg": 484.49, "max": 484.49, "min": 484.49, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 254.25, "avg": 254.25, "max": 254.25, "min": 254.25, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 207.60, "avg": 207.60, "max": 207.60, "min": 207.60, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.11, "avg": 6.11, "max": 6.11, "min": 6.11, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}}}
{"type":"time", "iteration": 128, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 67.31, "avg": 22.44, "max": 0.82, "min": 65.31, "cnt": 3}, "forward-compute":{"total": 1988.39, "avg": 62.14, "max": 54.95, "min": 70.30, "cnt": 32}, "fwd-compute":{"total": 1985.47, "avg": 62.05, "max": 54.87, "min": 70.21, "cnt": 32}, "batch-generator":{"total": 44.90, "avg": 1.40, "max": 0.66, "min": 5.66, "cnt": 32}, "fwd-embedding":{"total": 0.60, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1928.06, "avg": 60.25, "max": 53.81, "min": 68.80, "cnt": 32}, "fwd-layernorm":{"total": 9.59, "avg": 0.07, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 109.93, "avg": 0.86, "max": 0.74, "min": 2.64, "cnt": 128}, "fwd-misc":{"total": 20.54, "avg": 0.16, "max": 0.11, "min": 0.44, "cnt": 128}, "fwd-MLP":{"total": 1767.20, "avg": 13.81, "max": 11.29, "min": 25.69, "cnt": 128}, "MoE_L0_fwd":{"total": 533.02, "avg": 16.66, "max": 13.29, "min": 25.61, "cnt": 32}, "MoEMLP":{"total": 1750.46, "avg": 13.68, "max": 11.15, "min": 25.55, "cnt": 128}, "MoE_L1_fwd":{"total": 400.27, "avg": 12.51, "max": 11.20, "min": 14.33, "cnt": 32}, "MoE_L2_fwd":{"total": 438.81, "avg": 13.71, "max": 13.02, "min": 17.39, "cnt": 32}, "MoE_L3_fwd":{"total": 384.49, "avg": 12.02, "max": 11.29, "min": 13.42, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.85, "avg": 0.93, "max": 0.87, "min": 0.98, "cnt": 2}, "forward-send-backward-recv":{"total": 187.31, "avg": 6.24, "max": 0.88, "min": 123.56, "cnt": 30}, "backward-compute":{"total": 1876.54, "avg": 58.64, "max": 56.18, "min": 60.64, "cnt": 32}, "MoE_L3_bwd":{"total": 429.98, "avg": 13.44, "max": 11.75, "min": 14.69, "cnt": 32}, "MoE_L2_bwd":{"total": 448.09, "avg": 14.00, "max": 13.24, "min": 14.86, "cnt": 32}, "MoE_L1_bwd":{"total": 342.92, "avg": 10.72, "max": 10.28, "min": 11.42, "cnt": 32}, "MoE_L0_bwd":{"total": 443.99, "avg": 13.87, "max": 13.27, "min": 14.25, "cnt": 32}, "backward-send-forward-recv":{"total": 3683.90, "avg": 127.03, "max": 1.28, "min": 500.20, "cnt": 29}, "backward-send":{"total": 1.54, "avg": 0.51, "max": 0.43, "min": 0.66, "cnt": 3}, "backward-recv":{"total": 148.78, "avg": 74.39, "max": 71.65, "min": 77.13, "cnt": 2}, "backward-params-all-reduce":{"total": 489.22, "avg": 489.22, "max": 489.22, "min": 489.22, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 241.46, "avg": 241.46, "max": 241.46, "min": 241.46, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 201.62, "avg": 201.62, "max": 201.62, "min": 201.62, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.23, "avg": 3.23, "max": 3.23, "min": 3.23, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 129, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 82.93, "avg": 27.64, "max": 1.43, "min": 77.96, "cnt": 3}, "forward-compute":{"total": 1945.44, "avg": 60.79, "max": 55.34, "min": 70.41, "cnt": 32}, "fwd-compute":{"total": 1942.51, "avg": 60.70, "max": 55.27, "min": 70.31, "cnt": 32}, "batch-generator":{"total": 37.19, "avg": 1.16, "max": 0.65, "min": 2.61, "cnt": 32}, "fwd-embedding":{"total": 0.56, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1892.86, "avg": 59.15, "max": 54.22, "min": 67.83, "cnt": 32}, "fwd-layernorm":{"total": 9.13, "avg": 0.07, "max": 0.05, "min": 0.18, "cnt": 128}, "fwd-attn":{"total": 106.56, "avg": 0.83, "max": 0.74, "min": 1.49, "cnt": 128}, "fwd-misc":{"total": 20.17, "avg": 0.16, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1736.71, "avg": 13.57, "max": 11.40, "min": 20.73, "cnt": 128}, "MoE_L0_fwd":{"total": 508.19, "avg": 15.88, "max": 12.69, "min": 20.63, "cnt": 32}, "MoEMLP":{"total": 1720.62, "avg": 13.44, "max": 11.28, "min": 20.57, "cnt": 128}, "MoE_L1_fwd":{"total": 396.25, "avg": 12.38, "max": 11.34, "min": 15.58, "cnt": 32}, "MoE_L2_fwd":{"total": 436.26, "avg": 13.63, "max": 12.85, "min": 17.64, "cnt": 32}, "MoE_L3_fwd":{"total": 385.79, "avg": 12.06, "max": 11.32, "min": 13.46, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.54, "avg": 0.77, "max": 0.77, "min": 0.78, "cnt": 2}, "forward-send-backward-recv":{"total": 474.88, "avg": 15.83, "max": 1.34, "min": 122.85, "cnt": 30}, "backward-compute":{"total": 1857.92, "avg": 58.06, "max": 56.48, "min": 59.14, "cnt": 32}, "MoE_L3_bwd":{"total": 424.07, "avg": 13.25, "max": 12.39, "min": 14.18, "cnt": 32}, "MoE_L2_bwd":{"total": 434.65, "avg": 13.58, "max": 12.91, "min": 14.46, "cnt": 32}, "MoE_L1_bwd":{"total": 341.33, "avg": 10.67, "max": 10.18, "min": 11.54, "cnt": 32}, "MoE_L0_bwd":{"total": 444.78, "avg": 13.90, "max": 13.27, "min": 14.22, "cnt": 32}, "backward-send-forward-recv":{"total": 2560.99, "avg": 88.31, "max": 0.95, "min": 579.76, "cnt": 29}, "backward-send":{"total": 2.17, "avg": 0.72, "max": 0.51, "min": 1.03, "cnt": 3}, "backward-recv":{"total": 165.83, "avg": 82.92, "max": 72.89, "min": 92.94, "cnt": 2}, "backward-params-all-reduce":{"total": 487.64, "avg": 487.64, "max": 487.64, "min": 487.64, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 245.96, "avg": 245.96, "max": 245.96, "min": 245.96, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.36, "avg": 3.36, "max": 3.36, "min": 3.36, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 206.04, "avg": 206.04, "max": 206.04, "min": 206.04, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.33, "avg": 3.33, "max": 3.33, "min": 3.33, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}}}
{"type":"time", "iteration": 130, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 81.23, "avg": 27.08, "max": 1.11, "min": 74.61, "cnt": 3}, "forward-compute":{"total": 1939.75, "avg": 60.62, "max": 54.78, "min": 66.34, "cnt": 32}, "fwd-compute":{"total": 1936.49, "avg": 60.52, "max": 54.71, "min": 66.20, "cnt": 32}, "batch-generator":{"total": 45.97, "avg": 1.44, "max": 0.69, "min": 3.61, "cnt": 32}, "fwd-embedding":{"total": 0.69, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1877.75, "avg": 58.68, "max": 53.71, "min": 64.18, "cnt": 32}, "fwd-layernorm":{"total": 9.84, "avg": 0.08, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 111.76, "avg": 0.87, "max": 0.74, "min": 2.24, "cnt": 128}, "fwd-misc":{"total": 20.93, "avg": 0.16, "max": 0.11, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1714.00, "avg": 13.39, "max": 11.01, "min": 20.05, "cnt": 128}, "MoE_L0_fwd":{"total": 497.77, "avg": 15.56, "max": 12.92, "min": 19.97, "cnt": 32}, "MoEMLP":{"total": 1697.10, "avg": 13.26, "max": 10.90, "min": 19.92, "cnt": 128}, "MoE_L1_fwd":{"total": 386.00, "avg": 12.06, "max": 10.94, "min": 14.48, "cnt": 32}, "MoE_L2_fwd":{"total": 428.48, "avg": 13.39, "max": 12.74, "min": 14.18, "cnt": 32}, "MoE_L3_fwd":{"total": 391.15, "avg": 12.22, "max": 11.21, "min": 15.82, "cnt": 32}, "fwd-pooler":{"total": 0.36, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.49, "avg": 0.74, "max": 0.69, "min": 0.80, "cnt": 2}, "forward-send-backward-recv":{"total": 206.72, "avg": 6.89, "max": 1.05, "min": 122.77, "cnt": 30}, "backward-compute":{"total": 1867.61, "avg": 58.36, "max": 56.47, "min": 63.47, "cnt": 32}, "MoE_L3_bwd":{"total": 433.84, "avg": 13.56, "max": 12.63, "min": 15.06, "cnt": 32}, "MoE_L2_bwd":{"total": 436.86, "avg": 13.65, "max": 12.64, "min": 14.45, "cnt": 32}, "MoE_L1_bwd":{"total": 339.60, "avg": 10.61, "max": 9.79, "min": 13.72, "cnt": 32}, "MoE_L0_bwd":{"total": 445.86, "avg": 13.93, "max": 13.37, "min": 15.56, "cnt": 32}, "backward-send-forward-recv":{"total": 2695.60, "avg": 92.95, "max": 1.26, "min": 465.04, "cnt": 29}, "backward-send":{"total": 2.24, "avg": 0.75, "max": 0.58, "min": 1.04, "cnt": 3}, "backward-recv":{"total": 155.02, "avg": 77.51, "max": 65.45, "min": 89.57, "cnt": 2}, "backward-params-all-reduce":{"total": 484.81, "avg": 484.81, "max": 484.81, "min": 484.81, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 254.16, "avg": 254.16, "max": 254.16, "min": 254.16, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.36, "avg": 3.36, "max": 3.36, "min": 3.36, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 210.18, "avg": 210.18, "max": 210.18, "min": 210.18, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.29, "avg": 3.29, "max": 3.29, "min": 3.29, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 131, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 69.57, "avg": 23.19, "max": 1.01, "min": 67.54, "cnt": 3}, "forward-compute":{"total": 1977.62, "avg": 61.80, "max": 55.68, "min": 66.24, "cnt": 32}, "fwd-compute":{"total": 1974.40, "avg": 61.70, "max": 55.61, "min": 66.16, "cnt": 32}, "batch-generator":{"total": 47.55, "avg": 1.49, "max": 0.68, "min": 4.20, "cnt": 32}, "fwd-embedding":{"total": 0.61, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1914.33, "avg": 59.82, "max": 54.62, "min": 64.41, "cnt": 32}, "fwd-layernorm":{"total": 9.65, "avg": 0.08, "max": 0.05, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 108.17, "avg": 0.85, "max": 0.74, "min": 1.96, "cnt": 128}, "fwd-misc":{"total": 20.41, "avg": 0.16, "max": 0.11, "min": 0.34, "cnt": 128}, "fwd-MLP":{"total": 1755.08, "avg": 13.71, "max": 11.48, "min": 18.72, "cnt": 128}, "MoE_L0_fwd":{"total": 516.48, "avg": 16.14, "max": 13.34, "min": 18.56, "cnt": 32}, "MoEMLP":{"total": 1738.33, "avg": 13.58, "max": 11.36, "min": 18.47, "cnt": 128}, "MoE_L1_fwd":{"total": 394.61, "avg": 12.33, "max": 11.41, "min": 15.15, "cnt": 32}, "MoE_L2_fwd":{"total": 438.39, "avg": 13.70, "max": 13.03, "min": 17.32, "cnt": 32}, "MoE_L3_fwd":{"total": 395.08, "avg": 12.35, "max": 11.47, "min": 16.57, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.96, "avg": 0.98, "max": 0.84, "min": 1.12, "cnt": 2}, "forward-send-backward-recv":{"total": 300.98, "avg": 10.03, "max": 0.91, "min": 122.10, "cnt": 30}, "backward-compute":{"total": 1877.28, "avg": 58.67, "max": 56.65, "min": 60.96, "cnt": 32}, "MoE_L3_bwd":{"total": 431.35, "avg": 13.48, "max": 12.51, "min": 14.69, "cnt": 32}, "MoE_L2_bwd":{"total": 442.42, "avg": 13.83, "max": 13.26, "min": 14.69, "cnt": 32}, "MoE_L1_bwd":{"total": 340.80, "avg": 10.65, "max": 10.32, "min": 11.13, "cnt": 32}, "MoE_L0_bwd":{"total": 447.84, "avg": 14.00, "max": 13.68, "min": 14.45, "cnt": 32}, "backward-send-forward-recv":{"total": 2722.84, "avg": 93.89, "max": 2.16, "min": 450.41, "cnt": 29}, "backward-send":{"total": 3.33, "avg": 1.11, "max": 1.02, "min": 1.19, "cnt": 3}, "backward-recv":{"total": 132.00, "avg": 66.00, "max": 62.37, "min": 69.63, "cnt": 2}, "backward-params-all-reduce":{"total": 484.80, "avg": 484.80, "max": 484.80, "min": 484.80, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 241.78, "avg": 241.78, "max": 241.78, "min": 241.78, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 201.79, "avg": 201.79, "max": 201.79, "min": 201.79, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.27, "avg": 3.27, "max": 3.27, "min": 3.27, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.48, "avg": 3.48, "max": 3.48, "min": 3.48, "cnt": 1}}}
{"type":"time", "iteration": 132, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 76.76, "avg": 25.59, "max": 1.19, "min": 74.36, "cnt": 3}, "forward-compute":{"total": 1988.83, "avg": 62.15, "max": 55.38, "min": 70.74, "cnt": 32}, "fwd-compute":{"total": 1985.43, "avg": 62.04, "max": 55.31, "min": 70.61, "cnt": 32}, "batch-generator":{"total": 53.48, "avg": 1.67, "max": 0.73, "min": 5.74, "cnt": 32}, "fwd-embedding":{"total": 0.69, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1918.68, "avg": 59.96, "max": 54.22, "min": 68.53, "cnt": 32}, "fwd-layernorm":{"total": 10.10, "avg": 0.08, "max": 0.05, "min": 0.25, "cnt": 128}, "fwd-attn":{"total": 111.72, "avg": 0.87, "max": 0.74, "min": 2.33, "cnt": 128}, "fwd-misc":{"total": 21.64, "avg": 0.17, "max": 0.12, "min": 0.44, "cnt": 128}, "fwd-MLP":{"total": 1753.69, "avg": 13.70, "max": 11.28, "min": 24.09, "cnt": 128}, "MoE_L0_fwd":{"total": 520.81, "avg": 16.28, "max": 12.99, "min": 24.01, "cnt": 32}, "MoEMLP":{"total": 1736.55, "avg": 13.57, "max": 11.17, "min": 23.97, "cnt": 128}, "MoE_L1_fwd":{"total": 401.28, "avg": 12.54, "max": 11.44, "min": 16.21, "cnt": 32}, "MoE_L2_fwd":{"total": 427.83, "avg": 13.37, "max": 12.67, "min": 19.48, "cnt": 32}, "MoE_L3_fwd":{"total": 392.90, "avg": 12.28, "max": 11.22, "min": 17.29, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.61, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.99, "avg": 0.99, "max": 0.98, "min": 1.01, "cnt": 2}, "forward-send-backward-recv":{"total": 228.35, "avg": 7.61, "max": 1.11, "min": 122.45, "cnt": 30}, "backward-compute":{"total": 1888.17, "avg": 59.01, "max": 56.72, "min": 62.36, "cnt": 32}, "MoE_L3_bwd":{"total": 439.56, "avg": 13.74, "max": 12.06, "min": 16.71, "cnt": 32}, "MoE_L2_bwd":{"total": 436.32, "avg": 13.64, "max": 13.18, "min": 14.43, "cnt": 32}, "MoE_L1_bwd":{"total": 347.66, "avg": 10.86, "max": 10.37, "min": 12.92, "cnt": 32}, "MoE_L0_bwd":{"total": 451.34, "avg": 14.10, "max": 13.63, "min": 14.80, "cnt": 32}, "backward-send-forward-recv":{"total": 2365.52, "avg": 81.57, "max": 1.82, "min": 740.88, "cnt": 29}, "backward-send":{"total": 2.94, "avg": 0.98, "max": 0.77, "min": 1.15, "cnt": 3}, "backward-recv":{"total": 132.56, "avg": 66.28, "max": 57.71, "min": 74.84, "cnt": 2}, "backward-params-all-reduce":{"total": 489.05, "avg": 489.05, "max": 489.05, "min": 489.05, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.04, "avg": 0.04, "max": 0.04, "min": 0.04, "cnt": 1}, "optimizer":{"total": 243.81, "avg": 243.81, "max": 243.81, "min": 243.81, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 203.98, "avg": 203.98, "max": 203.98, "min": 203.98, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.26, "avg": 3.26, "max": 3.26, "min": 3.26, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 133, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 81.92, "avg": 27.31, "max": 0.85, "min": 80.05, "cnt": 3}, "forward-compute":{"total": 1974.09, "avg": 61.69, "max": 55.38, "min": 73.54, "cnt": 32}, "fwd-compute":{"total": 1970.73, "avg": 61.59, "max": 55.31, "min": 73.45, "cnt": 32}, "batch-generator":{"total": 50.35, "avg": 1.57, "max": 0.67, "min": 3.26, "cnt": 32}, "fwd-embedding":{"total": 0.66, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1907.11, "avg": 59.60, "max": 54.34, "min": 70.52, "cnt": 32}, "fwd-layernorm":{"total": 9.98, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 110.18, "avg": 0.86, "max": 0.74, "min": 1.51, "cnt": 128}, "fwd-misc":{"total": 21.25, "avg": 0.17, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1744.44, "avg": 13.63, "max": 11.33, "min": 19.28, "cnt": 128}, "MoE_L0_fwd":{"total": 506.66, "avg": 15.83, "max": 12.95, "min": 19.20, "cnt": 32}, "MoEMLP":{"total": 1727.37, "avg": 13.50, "max": 11.20, "min": 19.15, "cnt": 128}, "MoE_L1_fwd":{"total": 408.17, "avg": 12.76, "max": 11.63, "min": 16.70, "cnt": 32}, "MoE_L2_fwd":{"total": 427.47, "avg": 13.36, "max": 12.61, "min": 17.47, "cnt": 32}, "MoE_L3_fwd":{"total": 391.35, "avg": 12.23, "max": 11.25, "min": 14.47, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.58, "avg": 0.79, "max": 0.69, "min": 0.90, "cnt": 2}, "forward-send-backward-recv":{"total": 196.62, "avg": 6.55, "max": 1.25, "min": 117.13, "cnt": 30}, "backward-compute":{"total": 1861.90, "avg": 58.18, "max": 55.70, "min": 59.46, "cnt": 32}, "MoE_L3_bwd":{"total": 416.15, "avg": 13.00, "max": 11.93, "min": 13.59, "cnt": 32}, "MoE_L2_bwd":{"total": 429.19, "avg": 13.41, "max": 12.54, "min": 14.15, "cnt": 32}, "MoE_L1_bwd":{"total": 353.77, "avg": 11.06, "max": 10.53, "min": 11.88, "cnt": 32}, "MoE_L0_bwd":{"total": 447.69, "avg": 13.99, "max": 13.34, "min": 14.64, "cnt": 32}, "backward-send-forward-recv":{"total": 1976.72, "avg": 68.16, "max": 2.34, "min": 403.92, "cnt": 29}, "backward-send":{"total": 2.63, "avg": 0.88, "max": 0.68, "min": 1.04, "cnt": 3}, "backward-recv":{"total": 127.23, "avg": 63.61, "max": 54.18, "min": 73.05, "cnt": 2}, "backward-params-all-reduce":{"total": 489.96, "avg": 489.96, "max": 489.96, "min": 489.96, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 245.11, "avg": 245.11, "max": 245.11, "min": 245.11, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 205.20, "avg": 205.20, "max": 205.20, "min": 205.20, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.28, "avg": 3.28, "max": 3.28, "min": 3.28, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 134, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.13, "avg": 0.13, "max": 0.13, "min": 0.13, "cnt": 1}, "forward-recv":{"total": 71.37, "avg": 23.79, "max": 1.09, "min": 69.11, "cnt": 3}, "forward-compute":{"total": 1940.39, "avg": 60.64, "max": 56.37, "min": 65.38, "cnt": 32}, "fwd-compute":{"total": 1937.31, "avg": 60.54, "max": 56.29, "min": 65.29, "cnt": 32}, "batch-generator":{"total": 39.15, "avg": 1.22, "max": 0.70, "min": 2.65, "cnt": 32}, "fwd-embedding":{"total": 0.58, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1885.79, "avg": 58.93, "max": 54.52, "min": 64.11, "cnt": 32}, "fwd-layernorm":{"total": 9.25, "avg": 0.07, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 106.70, "avg": 0.83, "max": 0.74, "min": 1.79, "cnt": 128}, "fwd-misc":{"total": 20.48, "avg": 0.16, "max": 0.11, "min": 0.39, "cnt": 128}, "fwd-MLP":{"total": 1728.87, "avg": 13.51, "max": 11.24, "min": 21.03, "cnt": 128}, "MoE_L0_fwd":{"total": 515.25, "avg": 16.10, "max": 12.97, "min": 20.93, "cnt": 32}, "MoEMLP":{"total": 1712.22, "avg": 13.38, "max": 11.13, "min": 20.88, "cnt": 128}, "MoE_L1_fwd":{"total": 395.56, "avg": 12.36, "max": 11.17, "min": 14.71, "cnt": 32}, "MoE_L2_fwd":{"total": 422.42, "avg": 13.20, "max": 12.58, "min": 14.14, "cnt": 32}, "MoE_L3_fwd":{"total": 385.18, "avg": 12.04, "max": 11.36, "min": 14.89, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.44, "avg": 0.72, "max": 0.71, "min": 0.73, "cnt": 2}, "forward-send-backward-recv":{"total": 175.41, "avg": 5.85, "max": 0.89, "min": 114.27, "cnt": 30}, "backward-compute":{"total": 1858.40, "avg": 58.08, "max": 56.87, "min": 59.54, "cnt": 32}, "MoE_L3_bwd":{"total": 430.52, "avg": 13.45, "max": 12.31, "min": 17.28, "cnt": 32}, "MoE_L2_bwd":{"total": 428.15, "avg": 13.38, "max": 12.59, "min": 14.06, "cnt": 32}, "MoE_L1_bwd":{"total": 342.90, "avg": 10.72, "max": 10.06, "min": 11.06, "cnt": 32}, "MoE_L0_bwd":{"total": 444.57, "avg": 13.89, "max": 13.36, "min": 14.84, "cnt": 32}, "backward-send-forward-recv":{"total": 2353.81, "avg": 81.17, "max": 1.11, "min": 979.13, "cnt": 29}, "backward-send":{"total": 1.80, "avg": 0.60, "max": 0.43, "min": 0.93, "cnt": 3}, "backward-recv":{"total": 125.48, "avg": 62.74, "max": 59.89, "min": 65.58, "cnt": 2}, "backward-params-all-reduce":{"total": 491.34, "avg": 491.34, "max": 491.34, "min": 491.34, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.06, "avg": 0.06, "max": 0.06, "min": 0.06, "cnt": 1}, "optimizer":{"total": 240.85, "avg": 240.85, "max": 240.85, "min": 240.85, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 200.71, "avg": 200.71, "max": 200.71, "min": 200.71, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.31, "avg": 3.31, "max": 3.31, "min": 3.31, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.55, "avg": 3.55, "max": 3.55, "min": 3.55, "cnt": 1}}}
{"type":"time", "iteration": 135, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.10, "avg": 0.10, "max": 0.10, "min": 0.10, "cnt": 1}, "forward-recv":{"total": 80.73, "avg": 26.91, "max": 1.21, "min": 78.28, "cnt": 3}, "forward-compute":{"total": 1982.23, "avg": 61.94, "max": 55.46, "min": 73.08, "cnt": 32}, "fwd-compute":{"total": 1978.69, "avg": 61.83, "max": 55.39, "min": 73.00, "cnt": 32}, "batch-generator":{"total": 43.23, "avg": 1.35, "max": 0.68, "min": 1.76, "cnt": 32}, "fwd-embedding":{"total": 0.73, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1922.46, "avg": 60.08, "max": 54.40, "min": 71.69, "cnt": 32}, "fwd-layernorm":{"total": 10.26, "avg": 0.08, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 113.51, "avg": 0.89, "max": 0.74, "min": 1.56, "cnt": 128}, "fwd-misc":{"total": 21.61, "avg": 0.17, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1755.30, "avg": 13.71, "max": 11.36, "min": 23.91, "cnt": 128}, "MoE_L0_fwd":{"total": 523.70, "avg": 16.37, "max": 13.06, "min": 23.83, "cnt": 32}, "MoEMLP":{"total": 1737.77, "avg": 13.58, "max": 11.24, "min": 23.79, "cnt": 128}, "MoE_L1_fwd":{"total": 403.70, "avg": 12.62, "max": 11.53, "min": 16.77, "cnt": 32}, "MoE_L2_fwd":{"total": 427.96, "avg": 13.37, "max": 12.64, "min": 17.38, "cnt": 32}, "MoE_L3_fwd":{"total": 388.80, "avg": 12.15, "max": 11.28, "min": 16.05, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 2.02, "avg": 1.01, "max": 0.96, "min": 1.06, "cnt": 2}, "forward-send-backward-recv":{"total": 347.80, "avg": 11.59, "max": 1.40, "min": 131.92, "cnt": 30}, "backward-compute":{"total": 1878.00, "avg": 58.69, "max": 55.16, "min": 61.26, "cnt": 32}, "MoE_L3_bwd":{"total": 428.33, "avg": 13.39, "max": 11.89, "min": 15.66, "cnt": 32}, "MoE_L2_bwd":{"total": 435.27, "avg": 13.60, "max": 12.25, "min": 14.58, "cnt": 32}, "MoE_L1_bwd":{"total": 350.18, "avg": 10.94, "max": 10.29, "min": 11.60, "cnt": 32}, "MoE_L0_bwd":{"total": 450.89, "avg": 14.09, "max": 13.30, "min": 15.60, "cnt": 32}, "backward-send-forward-recv":{"total": 1078.21, "avg": 37.18, "max": 1.60, "min": 234.16, "cnt": 29}, "backward-send":{"total": 3.03, "avg": 1.01, "max": 0.91, "min": 1.14, "cnt": 3}, "backward-recv":{"total": 172.99, "avg": 86.50, "max": 85.10, "min": 87.89, "cnt": 2}, "backward-params-all-reduce":{"total": 490.12, "avg": 490.12, "max": 490.12, "min": 490.12, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.04, "avg": 0.04, "max": 0.04, "min": 0.04, "cnt": 1}, "optimizer":{"total": 243.38, "avg": 243.38, "max": 243.38, "min": 243.38, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 203.47, "avg": 203.47, "max": 203.47, "min": 203.47, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.32, "avg": 3.32, "max": 3.32, "min": 3.32, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 136, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 75.51, "avg": 25.17, "max": 0.67, "min": 73.79, "cnt": 3}, "forward-compute":{"total": 1984.06, "avg": 62.00, "max": 54.60, "min": 67.07, "cnt": 32}, "fwd-compute":{"total": 1980.85, "avg": 61.90, "max": 54.53, "min": 66.94, "cnt": 32}, "batch-generator":{"total": 46.06, "avg": 1.44, "max": 0.63, "min": 2.97, "cnt": 32}, "fwd-embedding":{"total": 0.64, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1922.04, "avg": 60.06, "max": 53.60, "min": 64.91, "cnt": 32}, "fwd-layernorm":{"total": 9.96, "avg": 0.08, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 109.86, "avg": 0.86, "max": 0.74, "min": 2.61, "cnt": 128}, "fwd-misc":{"total": 21.26, "avg": 0.17, "max": 0.11, "min": 0.46, "cnt": 128}, "fwd-MLP":{"total": 1759.40, "avg": 13.75, "max": 11.40, "min": 23.98, "cnt": 128}, "MoE_L0_fwd":{"total": 545.42, "avg": 17.04, "max": 13.16, "min": 23.90, "cnt": 32}, "MoEMLP":{"total": 1741.87, "avg": 13.61, "max": 11.29, "min": 23.86, "cnt": 128}, "MoE_L1_fwd":{"total": 403.84, "avg": 12.62, "max": 11.41, "min": 15.93, "cnt": 32}, "MoE_L2_fwd":{"total": 413.06, "avg": 12.91, "max": 12.51, "min": 13.83, "cnt": 32}, "MoE_L3_fwd":{"total": 385.90, "avg": 12.06, "max": 11.34, "min": 13.56, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 2.38, "avg": 1.19, "max": 0.76, "min": 1.62, "cnt": 2}, "forward-send-backward-recv":{"total": 180.53, "avg": 6.02, "max": 1.14, "min": 122.25, "cnt": 30}, "backward-compute":{"total": 1862.89, "avg": 58.22, "max": 57.30, "min": 61.75, "cnt": 32}, "MoE_L3_bwd":{"total": 431.87, "avg": 13.50, "max": 12.47, "min": 16.66, "cnt": 32}, "MoE_L2_bwd":{"total": 422.35, "avg": 13.20, "max": 12.58, "min": 13.80, "cnt": 32}, "MoE_L1_bwd":{"total": 348.23, "avg": 10.88, "max": 10.40, "min": 12.54, "cnt": 32}, "MoE_L0_bwd":{"total": 446.88, "avg": 13.96, "max": 13.30, "min": 14.79, "cnt": 32}, "backward-send-forward-recv":{"total": 3494.71, "avg": 120.51, "max": 1.80, "min": 1041.87, "cnt": 29}, "backward-send":{"total": 2.93, "avg": 0.98, "max": 0.90, "min": 1.09, "cnt": 3}, "backward-recv":{"total": 134.08, "avg": 67.04, "max": 66.18, "min": 67.89, "cnt": 2}, "backward-params-all-reduce":{"total": 483.23, "avg": 483.23, "max": 483.23, "min": 483.23, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 241.80, "avg": 241.80, "max": 241.80, "min": 241.80, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 201.94, "avg": 201.94, "max": 201.94, "min": 201.94, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.41, "avg": 3.41, "max": 3.41, "min": 3.41, "cnt": 1}}}
{"type":"time", "iteration": 137, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 94.16, "avg": 31.39, "max": 3.30, "min": 85.17, "cnt": 3}, "forward-compute":{"total": 1971.97, "avg": 61.62, "max": 55.57, "min": 67.89, "cnt": 32}, "fwd-compute":{"total": 1968.52, "avg": 61.52, "max": 55.48, "min": 67.79, "cnt": 32}, "batch-generator":{"total": 48.21, "avg": 1.51, "max": 0.75, "min": 4.86, "cnt": 32}, "fwd-embedding":{"total": 0.76, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1906.51, "avg": 59.58, "max": 54.39, "min": 65.69, "cnt": 32}, "fwd-layernorm":{"total": 10.67, "avg": 0.08, "max": 0.05, "min": 0.27, "cnt": 128}, "fwd-attn":{"total": 115.92, "avg": 0.91, "max": 0.74, "min": 2.34, "cnt": 128}, "fwd-misc":{"total": 22.79, "avg": 0.18, "max": 0.11, "min": 0.44, "cnt": 128}, "fwd-MLP":{"total": 1734.62, "avg": 13.55, "max": 11.33, "min": 19.57, "cnt": 128}, "MoE_L0_fwd":{"total": 513.80, "avg": 16.06, "max": 13.20, "min": 19.48, "cnt": 32}, "MoEMLP":{"total": 1716.60, "avg": 13.41, "max": 11.23, "min": 19.44, "cnt": 128}, "MoE_L1_fwd":{"total": 403.96, "avg": 12.62, "max": 11.61, "min": 16.12, "cnt": 32}, "MoE_L2_fwd":{"total": 416.68, "avg": 13.02, "max": 12.41, "min": 14.57, "cnt": 32}, "MoE_L3_fwd":{"total": 388.76, "avg": 12.15, "max": 11.27, "min": 16.34, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.81, "avg": 0.90, "max": 0.79, "min": 1.02, "cnt": 2}, "forward-send-backward-recv":{"total": 196.45, "avg": 6.55, "max": 1.00, "min": 114.45, "cnt": 30}, "backward-compute":{"total": 1848.12, "avg": 57.75, "max": 56.27, "min": 60.48, "cnt": 32}, "MoE_L3_bwd":{"total": 429.83, "avg": 13.43, "max": 12.39, "min": 16.09, "cnt": 32}, "MoE_L2_bwd":{"total": 417.28, "avg": 13.04, "max": 12.69, "min": 13.66, "cnt": 32}, "MoE_L1_bwd":{"total": 339.48, "avg": 10.61, "max": 10.19, "min": 11.44, "cnt": 32}, "MoE_L0_bwd":{"total": 446.51, "avg": 13.95, "max": 13.19, "min": 15.32, "cnt": 32}, "backward-send-forward-recv":{"total": 3221.87, "avg": 111.10, "max": 1.46, "min": 924.19, "cnt": 29}, "backward-send":{"total": 2.29, "avg": 0.76, "max": 0.45, "min": 0.96, "cnt": 3}, "backward-recv":{"total": 135.78, "avg": 67.89, "max": 65.38, "min": 70.40, "cnt": 2}, "backward-params-all-reduce":{"total": 486.14, "avg": 486.14, "max": 486.14, "min": 486.14, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 245.11, "avg": 245.11, "max": 245.11, "min": 245.11, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 205.21, "avg": 205.21, "max": 205.21, "min": 205.21, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.27, "avg": 3.27, "max": 3.27, "min": 3.27, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.47, "avg": 3.47, "max": 3.47, "min": 3.47, "cnt": 1}}}
{"type":"time", "iteration": 138, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 78.61, "avg": 26.20, "max": 1.00, "min": 72.12, "cnt": 3}, "forward-compute":{"total": 1944.13, "avg": 60.75, "max": 55.46, "min": 65.67, "cnt": 32}, "fwd-compute":{"total": 1940.80, "avg": 60.65, "max": 55.39, "min": 65.60, "cnt": 32}, "batch-generator":{"total": 41.51, "avg": 1.30, "max": 0.67, "min": 4.32, "cnt": 32}, "fwd-embedding":{"total": 0.68, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1886.68, "avg": 58.96, "max": 54.28, "min": 64.54, "cnt": 32}, "fwd-layernorm":{"total": 9.98, "avg": 0.08, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 111.71, "avg": 0.87, "max": 0.74, "min": 2.07, "cnt": 128}, "fwd-misc":{"total": 20.89, "avg": 0.16, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1722.82, "avg": 13.46, "max": 11.34, "min": 20.41, "cnt": 128}, "MoE_L0_fwd":{"total": 521.91, "avg": 16.31, "max": 13.73, "min": 20.33, "cnt": 32}, "MoEMLP":{"total": 1705.78, "avg": 13.33, "max": 11.24, "min": 20.28, "cnt": 128}, "MoE_L1_fwd":{"total": 393.58, "avg": 12.30, "max": 11.28, "min": 13.74, "cnt": 32}, "MoE_L2_fwd":{"total": 410.57, "avg": 12.83, "max": 12.24, "min": 13.90, "cnt": 32}, "MoE_L3_fwd":{"total": 385.90, "avg": 12.06, "max": 11.43, "min": 14.00, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.55, "avg": 0.78, "max": 0.76, "min": 0.79, "cnt": 2}, "forward-send-backward-recv":{"total": 393.03, "avg": 13.10, "max": 1.44, "min": 125.52, "cnt": 30}, "backward-compute":{"total": 1841.24, "avg": 57.54, "max": 55.15, "min": 59.06, "cnt": 32}, "MoE_L3_bwd":{"total": 417.75, "avg": 13.05, "max": 11.65, "min": 14.48, "cnt": 32}, "MoE_L2_bwd":{"total": 418.40, "avg": 13.08, "max": 12.15, "min": 14.45, "cnt": 32}, "MoE_L1_bwd":{"total": 342.00, "avg": 10.69, "max": 10.15, "min": 12.26, "cnt": 32}, "MoE_L0_bwd":{"total": 448.10, "avg": 14.00, "max": 13.31, "min": 14.50, "cnt": 32}, "backward-send-forward-recv":{"total": 2105.73, "avg": 72.61, "max": 0.99, "min": 313.88, "cnt": 29}, "backward-send":{"total": 2.53, "avg": 0.84, "max": 0.60, "min": 1.16, "cnt": 3}, "backward-recv":{"total": 436.22, "avg": 218.11, "max": 52.52, "min": 383.70, "cnt": 2}, "backward-params-all-reduce":{"total": 487.32, "avg": 487.32, "max": 487.32, "min": 487.32, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 243.09, "avg": 243.09, "max": 243.09, "min": 243.09, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 203.08, "avg": 203.08, "max": 203.08, "min": 203.08, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 139, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 80.14, "avg": 26.71, "max": 0.79, "min": 77.93, "cnt": 3}, "forward-compute":{"total": 1935.66, "avg": 60.49, "max": 54.79, "min": 71.43, "cnt": 32}, "fwd-compute":{"total": 1932.64, "avg": 60.39, "max": 54.72, "min": 71.28, "cnt": 32}, "batch-generator":{"total": 43.27, "avg": 1.35, "max": 0.66, "min": 3.23, "cnt": 32}, "fwd-embedding":{"total": 0.58, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1876.81, "avg": 58.65, "max": 53.68, "min": 69.35, "cnt": 32}, "fwd-layernorm":{"total": 9.28, "avg": 0.07, "max": 0.05, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 106.14, "avg": 0.83, "max": 0.74, "min": 1.50, "cnt": 128}, "fwd-misc":{"total": 20.09, "avg": 0.16, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1721.04, "avg": 13.45, "max": 11.14, "min": 20.20, "cnt": 128}, "MoE_L0_fwd":{"total": 497.56, "avg": 15.55, "max": 13.14, "min": 19.99, "cnt": 32}, "MoEMLP":{"total": 1704.75, "avg": 13.32, "max": 11.04, "min": 19.90, "cnt": 128}, "MoE_L1_fwd":{"total": 399.69, "avg": 12.49, "max": 11.32, "min": 17.52, "cnt": 32}, "MoE_L2_fwd":{"total": 420.83, "avg": 13.15, "max": 12.52, "min": 15.79, "cnt": 32}, "MoE_L3_fwd":{"total": 392.61, "avg": 12.27, "max": 11.08, "min": 16.71, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.64, "avg": 0.82, "max": 0.74, "min": 0.90, "cnt": 2}, "forward-send-backward-recv":{"total": 206.61, "avg": 6.89, "max": 1.10, "min": 124.31, "cnt": 30}, "backward-compute":{"total": 1855.85, "avg": 58.00, "max": 56.28, "min": 61.05, "cnt": 32}, "MoE_L3_bwd":{"total": 427.66, "avg": 13.36, "max": 12.69, "min": 15.37, "cnt": 32}, "MoE_L2_bwd":{"total": 425.56, "avg": 13.30, "max": 12.64, "min": 13.70, "cnt": 32}, "MoE_L1_bwd":{"total": 339.67, "avg": 10.61, "max": 10.12, "min": 11.61, "cnt": 32}, "MoE_L0_bwd":{"total": 449.45, "avg": 14.05, "max": 13.56, "min": 14.88, "cnt": 32}, "backward-send-forward-recv":{"total": 1825.78, "avg": 62.96, "max": 2.10, "min": 318.44, "cnt": 29}, "backward-send":{"total": 3.16, "avg": 1.05, "max": 1.01, "min": 1.09, "cnt": 3}, "backward-recv":{"total": 299.63, "avg": 149.82, "max": 53.68, "min": 245.95, "cnt": 2}, "backward-params-all-reduce":{"total": 485.95, "avg": 485.95, "max": 485.95, "min": 485.95, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 247.59, "avg": 247.59, "max": 247.59, "min": 247.59, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 207.63, "avg": 207.63, "max": 207.63, "min": 207.63, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}}}
{"type":"time", "iteration": 140, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 84.31, "avg": 28.10, "max": 2.25, "min": 73.65, "cnt": 3}, "forward-compute":{"total": 1945.27, "avg": 60.79, "max": 53.95, "min": 66.61, "cnt": 32}, "fwd-compute":{"total": 1942.04, "avg": 60.69, "max": 53.86, "min": 66.49, "cnt": 32}, "batch-generator":{"total": 40.07, "avg": 1.25, "max": 0.66, "min": 2.21, "cnt": 32}, "fwd-embedding":{"total": 0.66, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1889.20, "avg": 59.04, "max": 52.67, "min": 64.34, "cnt": 32}, "fwd-layernorm":{"total": 9.79, "avg": 0.08, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 111.18, "avg": 0.87, "max": 0.74, "min": 2.27, "cnt": 128}, "fwd-misc":{"total": 20.82, "avg": 0.16, "max": 0.11, "min": 0.34, "cnt": 128}, "fwd-MLP":{"total": 1726.36, "avg": 13.49, "max": 11.23, "min": 19.01, "cnt": 128}, "MoE_L0_fwd":{"total": 500.28, "avg": 15.63, "max": 12.82, "min": 18.84, "cnt": 32}, "MoEMLP":{"total": 1709.36, "avg": 13.35, "max": 11.12, "min": 18.75, "cnt": 128}, "MoE_L1_fwd":{"total": 396.98, "avg": 12.41, "max": 11.22, "min": 15.08, "cnt": 32}, "MoE_L2_fwd":{"total": 420.11, "avg": 13.13, "max": 12.43, "min": 16.13, "cnt": 32}, "MoE_L3_fwd":{"total": 398.15, "avg": 12.44, "max": 11.16, "min": 17.75, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 2.11, "avg": 1.05, "max": 0.91, "min": 1.19, "cnt": 2}, "forward-send-backward-recv":{"total": 879.54, "avg": 29.32, "max": 1.46, "min": 191.63, "cnt": 30}, "backward-compute":{"total": 1842.83, "avg": 57.59, "max": 55.41, "min": 60.94, "cnt": 32}, "MoE_L3_bwd":{"total": 428.13, "avg": 13.38, "max": 11.98, "min": 17.13, "cnt": 32}, "MoE_L2_bwd":{"total": 419.90, "avg": 13.12, "max": 12.39, "min": 13.73, "cnt": 32}, "MoE_L1_bwd":{"total": 337.08, "avg": 10.53, "max": 10.12, "min": 11.44, "cnt": 32}, "MoE_L0_bwd":{"total": 442.78, "avg": 13.84, "max": 13.50, "min": 14.10, "cnt": 32}, "backward-send-forward-recv":{"total": 1282.30, "avg": 44.22, "max": 1.45, "min": 246.24, "cnt": 29}, "backward-send":{"total": 1.83, "avg": 0.61, "max": 0.45, "min": 0.89, "cnt": 3}, "backward-recv":{"total": 275.37, "avg": 137.69, "max": 74.34, "min": 201.04, "cnt": 2}, "backward-params-all-reduce":{"total": 488.14, "avg": 488.14, "max": 488.14, "min": 488.14, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 244.19, "avg": 244.19, "max": 244.19, "min": 244.19, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 204.32, "avg": 204.32, "max": 204.32, "min": 204.32, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.30, "avg": 3.30, "max": 3.30, "min": 3.30, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 141, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 88.41, "avg": 29.47, "max": 2.83, "min": 77.57, "cnt": 3}, "forward-compute":{"total": 1940.86, "avg": 60.65, "max": 55.48, "min": 65.09, "cnt": 32}, "fwd-compute":{"total": 1937.37, "avg": 60.54, "max": 55.40, "min": 65.01, "cnt": 32}, "batch-generator":{"total": 43.50, "avg": 1.36, "max": 0.66, "min": 2.35, "cnt": 32}, "fwd-embedding":{"total": 0.78, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1880.69, "avg": 58.77, "max": 54.24, "min": 64.06, "cnt": 32}, "fwd-layernorm":{"total": 10.79, "avg": 0.08, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 115.02, "avg": 0.90, "max": 0.74, "min": 2.11, "cnt": 128}, "fwd-misc":{"total": 22.23, "avg": 0.17, "max": 0.11, "min": 0.34, "cnt": 128}, "fwd-MLP":{"total": 1710.14, "avg": 13.36, "max": 11.15, "min": 19.79, "cnt": 128}, "MoE_L0_fwd":{"total": 508.13, "avg": 15.88, "max": 13.75, "min": 19.70, "cnt": 32}, "MoEMLP":{"total": 1692.03, "avg": 13.22, "max": 11.05, "min": 19.64, "cnt": 128}, "MoE_L1_fwd":{"total": 396.88, "avg": 12.40, "max": 11.51, "min": 14.41, "cnt": 32}, "MoE_L2_fwd":{"total": 418.64, "avg": 13.08, "max": 12.34, "min": 15.79, "cnt": 32}, "MoE_L3_fwd":{"total": 374.91, "avg": 11.72, "max": 11.09, "min": 12.60, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.41, "avg": 0.71, "max": 0.66, "min": 0.75, "cnt": 2}, "forward-send-backward-recv":{"total": 1137.46, "avg": 37.92, "max": 1.00, "min": 185.32, "cnt": 30}, "backward-compute":{"total": 1832.30, "avg": 57.26, "max": 55.35, "min": 58.97, "cnt": 32}, "MoE_L3_bwd":{"total": 414.50, "avg": 12.95, "max": 12.29, "min": 14.07, "cnt": 32}, "MoE_L2_bwd":{"total": 419.43, "avg": 13.11, "max": 12.24, "min": 14.01, "cnt": 32}, "MoE_L1_bwd":{"total": 334.69, "avg": 10.46, "max": 10.06, "min": 11.02, "cnt": 32}, "MoE_L0_bwd":{"total": 447.67, "avg": 13.99, "max": 13.64, "min": 14.63, "cnt": 32}, "backward-send-forward-recv":{"total": 596.50, "avg": 20.57, "max": 0.94, "min": 148.87, "cnt": 29}, "backward-send":{"total": 2.15, "avg": 0.72, "max": 0.45, "min": 1.03, "cnt": 3}, "backward-recv":{"total": 192.70, "avg": 96.35, "max": 79.02, "min": 113.68, "cnt": 2}, "backward-params-all-reduce":{"total": 487.52, "avg": 487.52, "max": 487.52, "min": 487.52, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 248.02, "avg": 248.02, "max": 248.02, "min": 248.02, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.41, "avg": 3.41, "max": 3.41, "min": 3.41, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 208.10, "avg": 208.10, "max": 208.10, "min": 208.10, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.41, "avg": 3.41, "max": 3.41, "min": 3.41, "cnt": 1}}}
{"type":"time", "iteration": 142, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.13, "avg": 0.13, "max": 0.13, "min": 0.13, "cnt": 1}, "forward-recv":{"total": 82.37, "avg": 27.46, "max": 0.70, "min": 74.80, "cnt": 3}, "forward-compute":{"total": 1957.86, "avg": 61.18, "max": 56.23, "min": 68.46, "cnt": 32}, "fwd-compute":{"total": 1954.47, "avg": 61.08, "max": 56.16, "min": 68.33, "cnt": 32}, "batch-generator":{"total": 43.94, "avg": 1.37, "max": 0.65, "min": 2.81, "cnt": 32}, "fwd-embedding":{"total": 0.76, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1897.34, "avg": 59.29, "max": 54.93, "min": 66.04, "cnt": 32}, "fwd-layernorm":{"total": 10.41, "avg": 0.08, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 112.99, "avg": 0.88, "max": 0.74, "min": 1.84, "cnt": 128}, "fwd-misc":{"total": 21.89, "avg": 0.17, "max": 0.11, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1730.02, "avg": 13.52, "max": 11.11, "min": 21.73, "cnt": 128}, "MoE_L0_fwd":{"total": 528.44, "avg": 16.51, "max": 13.34, "min": 21.58, "cnt": 32}, "MoEMLP":{"total": 1712.22, "avg": 13.38, "max": 11.00, "min": 21.49, "cnt": 128}, "MoE_L1_fwd":{"total": 392.34, "avg": 12.26, "max": 11.38, "min": 14.50, "cnt": 32}, "MoE_L2_fwd":{"total": 421.01, "avg": 13.16, "max": 12.45, "min": 14.90, "cnt": 32}, "MoE_L3_fwd":{"total": 376.90, "avg": 11.78, "max": 11.05, "min": 13.75, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.60, "avg": 0.80, "max": 0.80, "min": 0.80, "cnt": 2}, "forward-send-backward-recv":{"total": 988.59, "avg": 32.95, "max": 1.01, "min": 284.42, "cnt": 30}, "backward-compute":{"total": 1834.28, "avg": 57.32, "max": 54.97, "min": 61.85, "cnt": 32}, "MoE_L3_bwd":{"total": 415.60, "avg": 12.99, "max": 11.81, "min": 14.55, "cnt": 32}, "MoE_L2_bwd":{"total": 419.93, "avg": 13.12, "max": 12.20, "min": 13.91, "cnt": 32}, "MoE_L1_bwd":{"total": 337.62, "avg": 10.55, "max": 9.82, "min": 14.15, "cnt": 32}, "MoE_L0_bwd":{"total": 446.76, "avg": 13.96, "max": 13.65, "min": 14.24, "cnt": 32}, "backward-send-forward-recv":{"total": 1754.05, "avg": 60.48, "max": 1.51, "min": 289.14, "cnt": 29}, "backward-send":{"total": 2.91, "avg": 0.97, "max": 0.94, "min": 0.98, "cnt": 3}, "backward-recv":{"total": 241.41, "avg": 120.71, "max": 69.35, "min": 172.07, "cnt": 2}, "backward-params-all-reduce":{"total": 488.56, "avg": 488.56, "max": 488.56, "min": 488.56, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "optimizer":{"total": 246.47, "avg": 246.47, "max": 246.47, "min": 246.47, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.41, "avg": 3.41, "max": 3.41, "min": 3.41, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 206.38, "avg": 206.38, "max": 206.38, "min": 206.38, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.34, "avg": 3.34, "max": 3.34, "min": 3.34, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.50, "avg": 3.50, "max": 3.50, "min": 3.50, "cnt": 1}}}
{"type":"time", "iteration": 143, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 78.66, "avg": 26.22, "max": 0.67, "min": 76.76, "cnt": 3}, "forward-compute":{"total": 1924.53, "avg": 60.14, "max": 54.45, "min": 67.85, "cnt": 32}, "fwd-compute":{"total": 1921.23, "avg": 60.04, "max": 54.38, "min": 67.78, "cnt": 32}, "batch-generator":{"total": 44.90, "avg": 1.40, "max": 0.70, "min": 2.71, "cnt": 32}, "fwd-embedding":{"total": 0.66, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1863.73, "avg": 58.24, "max": 53.32, "min": 65.22, "cnt": 32}, "fwd-layernorm":{"total": 9.64, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 108.88, "avg": 0.85, "max": 0.74, "min": 1.49, "cnt": 128}, "fwd-misc":{"total": 21.36, "avg": 0.17, "max": 0.11, "min": 0.39, "cnt": 128}, "fwd-MLP":{"total": 1702.97, "avg": 13.30, "max": 11.00, "min": 18.95, "cnt": 128}, "MoE_L0_fwd":{"total": 503.73, "avg": 15.74, "max": 13.07, "min": 18.81, "cnt": 32}, "MoEMLP":{"total": 1685.78, "avg": 13.17, "max": 10.89, "min": 18.75, "cnt": 128}, "MoE_L1_fwd":{"total": 402.38, "avg": 12.57, "max": 11.28, "min": 16.02, "cnt": 32}, "MoE_L2_fwd":{"total": 409.40, "avg": 12.79, "max": 12.32, "min": 13.52, "cnt": 32}, "MoE_L3_fwd":{"total": 376.48, "avg": 11.77, "max": 10.93, "min": 16.03, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 9.25, "avg": 4.62, "max": 1.03, "min": 8.21, "cnt": 2}, "forward-send-backward-recv":{"total": 260.76, "avg": 8.69, "max": 1.45, "min": 117.27, "cnt": 30}, "backward-compute":{"total": 1835.20, "avg": 57.35, "max": 55.00, "min": 60.57, "cnt": 32}, "MoE_L3_bwd":{"total": 414.10, "avg": 12.94, "max": 12.20, "min": 16.09, "cnt": 32}, "MoE_L2_bwd":{"total": 419.49, "avg": 13.11, "max": 12.39, "min": 14.24, "cnt": 32}, "MoE_L1_bwd":{"total": 337.99, "avg": 10.56, "max": 9.90, "min": 11.36, "cnt": 32}, "MoE_L0_bwd":{"total": 449.07, "avg": 14.03, "max": 13.52, "min": 14.58, "cnt": 32}, "backward-send-forward-recv":{"total": 1515.49, "avg": 52.26, "max": 2.16, "min": 189.06, "cnt": 29}, "backward-send":{"total": 3.27, "avg": 1.09, "max": 1.05, "min": 1.15, "cnt": 3}, "backward-recv":{"total": 231.28, "avg": 115.64, "max": 68.79, "min": 162.49, "cnt": 2}, "backward-params-all-reduce":{"total": 486.28, "avg": 486.28, "max": 486.28, "min": 486.28, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 252.09, "avg": 252.09, "max": 252.09, "min": 252.09, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 212.33, "avg": 212.33, "max": 212.33, "min": 212.33, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.29, "avg": 3.29, "max": 3.29, "min": 3.29, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 144, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 84.94, "avg": 28.31, "max": 2.96, "min": 76.16, "cnt": 3}, "forward-compute":{"total": 1960.90, "avg": 61.28, "max": 55.05, "min": 69.37, "cnt": 32}, "fwd-compute":{"total": 1957.38, "avg": 61.17, "max": 54.98, "min": 69.24, "cnt": 32}, "batch-generator":{"total": 45.40, "avg": 1.42, "max": 0.71, "min": 2.61, "cnt": 32}, "fwd-embedding":{"total": 0.77, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1897.94, "avg": 59.31, "max": 53.98, "min": 67.11, "cnt": 32}, "fwd-layernorm":{"total": 10.50, "avg": 0.08, "max": 0.06, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 114.16, "avg": 0.89, "max": 0.74, "min": 2.47, "cnt": 128}, "fwd-misc":{"total": 22.38, "avg": 0.17, "max": 0.11, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1728.37, "avg": 13.50, "max": 11.08, "min": 20.48, "cnt": 128}, "MoE_L0_fwd":{"total": 516.23, "avg": 16.13, "max": 13.30, "min": 20.39, "cnt": 32}, "MoEMLP":{"total": 1710.41, "avg": 13.36, "max": 10.97, "min": 20.35, "cnt": 128}, "MoE_L1_fwd":{"total": 394.27, "avg": 12.32, "max": 11.56, "min": 13.27, "cnt": 32}, "MoE_L2_fwd":{"total": 425.45, "avg": 13.30, "max": 12.45, "min": 18.69, "cnt": 32}, "MoE_L3_fwd":{"total": 381.04, "avg": 11.91, "max": 11.01, "min": 16.67, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.64, "avg": 0.82, "max": 0.81, "min": 0.83, "cnt": 2}, "forward-send-backward-recv":{"total": 596.92, "avg": 19.90, "max": 1.76, "min": 160.17, "cnt": 30}, "backward-compute":{"total": 1851.55, "avg": 57.86, "max": 56.53, "min": 59.45, "cnt": 32}, "MoE_L3_bwd":{"total": 409.25, "avg": 12.79, "max": 12.01, "min": 13.49, "cnt": 32}, "MoE_L2_bwd":{"total": 429.21, "avg": 13.41, "max": 12.81, "min": 15.12, "cnt": 32}, "MoE_L1_bwd":{"total": 348.79, "avg": 10.90, "max": 10.20, "min": 11.34, "cnt": 32}, "MoE_L0_bwd":{"total": 449.70, "avg": 14.05, "max": 13.55, "min": 14.42, "cnt": 32}, "backward-send-forward-recv":{"total": 1326.17, "avg": 45.73, "max": 1.08, "min": 191.23, "cnt": 29}, "backward-send":{"total": 2.73, "avg": 0.91, "max": 0.85, "min": 0.97, "cnt": 3}, "backward-recv":{"total": 327.33, "avg": 163.66, "max": 59.94, "min": 267.39, "cnt": 2}, "backward-params-all-reduce":{"total": 482.05, "avg": 482.05, "max": 482.05, "min": 482.05, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 250.28, "avg": 250.28, "max": 250.28, "min": 250.28, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.36, "avg": 3.36, "max": 3.36, "min": 3.36, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 210.49, "avg": 210.49, "max": 210.49, "min": 210.49, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.31, "avg": 3.31, "max": 3.31, "min": 3.31, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.40, "avg": 3.40, "max": 3.40, "min": 3.40, "cnt": 1}}}
{"type":"time", "iteration": 145, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 83.90, "avg": 27.97, "max": 0.91, "min": 75.73, "cnt": 3}, "forward-compute":{"total": 1922.24, "avg": 60.07, "max": 54.58, "min": 67.41, "cnt": 32}, "fwd-compute":{"total": 1919.03, "avg": 59.97, "max": 54.50, "min": 67.32, "cnt": 32}, "batch-generator":{"total": 40.72, "avg": 1.27, "max": 0.68, "min": 2.31, "cnt": 32}, "fwd-embedding":{"total": 0.62, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1866.06, "avg": 58.31, "max": 53.52, "min": 65.33, "cnt": 32}, "fwd-layernorm":{"total": 9.54, "avg": 0.07, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 108.63, "avg": 0.85, "max": 0.74, "min": 2.07, "cnt": 128}, "fwd-misc":{"total": 20.39, "avg": 0.16, "max": 0.11, "min": 0.33, "cnt": 128}, "fwd-MLP":{"total": 1707.53, "avg": 13.34, "max": 10.84, "min": 21.50, "cnt": 128}, "MoE_L0_fwd":{"total": 518.72, "avg": 16.21, "max": 13.09, "min": 21.42, "cnt": 32}, "MoEMLP":{"total": 1691.38, "avg": 13.21, "max": 10.73, "min": 21.37, "cnt": 128}, "MoE_L1_fwd":{"total": 392.55, "avg": 12.27, "max": 11.21, "min": 14.01, "cnt": 32}, "MoE_L2_fwd":{"total": 413.35, "avg": 12.92, "max": 12.25, "min": 14.69, "cnt": 32}, "MoE_L3_fwd":{"total": 372.72, "avg": 11.65, "max": 10.77, "min": 15.23, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.76, "avg": 0.88, "max": 0.86, "min": 0.90, "cnt": 2}, "forward-send-backward-recv":{"total": 185.46, "avg": 6.18, "max": 0.84, "min": 120.07, "cnt": 30}, "backward-compute":{"total": 1846.63, "avg": 57.71, "max": 55.38, "min": 59.37, "cnt": 32}, "MoE_L3_bwd":{"total": 412.95, "avg": 12.90, "max": 12.11, "min": 14.67, "cnt": 32}, "MoE_L2_bwd":{"total": 422.23, "avg": 13.19, "max": 12.20, "min": 13.98, "cnt": 32}, "MoE_L1_bwd":{"total": 350.19, "avg": 10.94, "max": 10.45, "min": 12.75, "cnt": 32}, "MoE_L0_bwd":{"total": 448.93, "avg": 14.03, "max": 13.56, "min": 14.46, "cnt": 32}, "backward-send-forward-recv":{"total": 3562.90, "avg": 122.86, "max": 2.27, "min": 594.83, "cnt": 29}, "backward-send":{"total": 2.28, "avg": 0.76, "max": 0.50, "min": 0.99, "cnt": 3}, "backward-recv":{"total": 121.81, "avg": 60.90, "max": 52.68, "min": 69.13, "cnt": 2}, "backward-params-all-reduce":{"total": 489.72, "avg": 489.72, "max": 489.72, "min": 489.72, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 239.79, "avg": 239.79, "max": 239.79, "min": 239.79, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 199.19, "avg": 199.19, "max": 199.19, "min": 199.19, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.30, "avg": 3.30, "max": 3.30, "min": 3.30, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}}}
{"type":"time", "iteration": 146, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 78.92, "avg": 26.31, "max": 1.15, "min": 73.27, "cnt": 3}, "forward-compute":{"total": 1974.79, "avg": 61.71, "max": 55.08, "min": 68.18, "cnt": 32}, "fwd-compute":{"total": 1971.64, "avg": 61.61, "max": 55.02, "min": 68.10, "cnt": 32}, "batch-generator":{"total": 40.31, "avg": 1.26, "max": 0.67, "min": 1.82, "cnt": 32}, "fwd-embedding":{"total": 0.72, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1918.85, "avg": 59.96, "max": 54.05, "min": 66.93, "cnt": 32}, "fwd-layernorm":{"total": 10.18, "avg": 0.08, "max": 0.05, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 114.09, "avg": 0.89, "max": 0.74, "min": 2.12, "cnt": 128}, "fwd-misc":{"total": 21.35, "avg": 0.17, "max": 0.11, "min": 0.47, "cnt": 128}, "fwd-MLP":{"total": 1751.56, "avg": 13.68, "max": 10.98, "min": 21.06, "cnt": 128}, "MoE_L0_fwd":{"total": 528.89, "avg": 16.53, "max": 13.15, "min": 20.93, "cnt": 32}, "MoEMLP":{"total": 1734.15, "avg": 13.55, "max": 10.88, "min": 20.83, "cnt": 128}, "MoE_L1_fwd":{"total": 419.95, "avg": 13.12, "max": 11.88, "min": 15.85, "cnt": 32}, "MoE_L2_fwd":{"total": 417.28, "avg": 13.04, "max": 12.31, "min": 14.17, "cnt": 32}, "MoE_L3_fwd":{"total": 374.46, "avg": 11.70, "max": 10.92, "min": 15.48, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.56, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 2.07, "avg": 1.03, "max": 0.90, "min": 1.17, "cnt": 2}, "forward-send-backward-recv":{"total": 202.80, "avg": 6.76, "max": 0.84, "min": 122.66, "cnt": 30}, "backward-compute":{"total": 1851.55, "avg": 57.86, "max": 55.78, "min": 59.41, "cnt": 32}, "MoE_L3_bwd":{"total": 407.86, "avg": 12.75, "max": 11.65, "min": 13.77, "cnt": 32}, "MoE_L2_bwd":{"total": 427.90, "avg": 13.37, "max": 12.49, "min": 14.20, "cnt": 32}, "MoE_L1_bwd":{"total": 357.96, "avg": 11.19, "max": 10.80, "min": 11.56, "cnt": 32}, "MoE_L0_bwd":{"total": 445.72, "avg": 13.93, "max": 13.34, "min": 14.76, "cnt": 32}, "backward-send-forward-recv":{"total": 1714.84, "avg": 59.13, "max": 1.08, "min": 604.64, "cnt": 29}, "backward-send":{"total": 3.04, "avg": 1.01, "max": 0.98, "min": 1.05, "cnt": 3}, "backward-recv":{"total": 192.18, "avg": 96.09, "max": 64.35, "min": 127.83, "cnt": 2}, "backward-params-all-reduce":{"total": 490.88, "avg": 490.88, "max": 490.88, "min": 490.88, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 237.48, "avg": 237.48, "max": 237.48, "min": 237.48, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 197.55, "avg": 197.55, "max": 197.55, "min": 197.55, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.51, "avg": 3.51, "max": 3.51, "min": 3.51, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 147, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 80.49, "avg": 26.83, "max": 0.89, "min": 74.93, "cnt": 3}, "forward-compute":{"total": 1955.95, "avg": 61.12, "max": 54.54, "min": 77.40, "cnt": 32}, "fwd-compute":{"total": 1952.44, "avg": 61.01, "max": 54.47, "min": 77.27, "cnt": 32}, "batch-generator":{"total": 46.07, "avg": 1.44, "max": 0.70, "min": 2.47, "cnt": 32}, "fwd-embedding":{"total": 0.76, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1892.90, "avg": 59.15, "max": 53.44, "min": 75.16, "cnt": 32}, "fwd-layernorm":{"total": 10.35, "avg": 0.08, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 114.00, "avg": 0.89, "max": 0.74, "min": 2.16, "cnt": 128}, "fwd-misc":{"total": 21.93, "avg": 0.17, "max": 0.11, "min": 0.45, "cnt": 128}, "fwd-MLP":{"total": 1724.65, "avg": 13.47, "max": 10.79, "min": 32.78, "cnt": 128}, "MoE_L0_fwd":{"total": 526.57, "avg": 16.46, "max": 12.84, "min": 32.65, "cnt": 32}, "MoEMLP":{"total": 1707.01, "avg": 13.34, "max": 10.68, "min": 32.58, "cnt": 128}, "MoE_L1_fwd":{"total": 408.92, "avg": 12.78, "max": 11.60, "min": 14.57, "cnt": 32}, "MoE_L2_fwd":{"total": 416.18, "avg": 13.01, "max": 12.42, "min": 14.88, "cnt": 32}, "MoE_L3_fwd":{"total": 361.71, "avg": 11.30, "max": 10.72, "min": 13.09, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 2.54, "avg": 1.27, "max": 0.94, "min": 1.60, "cnt": 2}, "forward-send-backward-recv":{"total": 845.12, "avg": 28.17, "max": 1.77, "min": 187.36, "cnt": 30}, "backward-compute":{"total": 1845.36, "avg": 57.67, "max": 56.35, "min": 61.35, "cnt": 32}, "MoE_L3_bwd":{"total": 394.02, "avg": 12.31, "max": 11.59, "min": 13.82, "cnt": 32}, "MoE_L2_bwd":{"total": 426.55, "avg": 13.33, "max": 12.36, "min": 16.07, "cnt": 32}, "MoE_L1_bwd":{"total": 361.69, "avg": 11.30, "max": 10.97, "min": 11.65, "cnt": 32}, "MoE_L0_bwd":{"total": 447.60, "avg": 13.99, "max": 13.53, "min": 14.80, "cnt": 32}, "backward-send-forward-recv":{"total": 1793.58, "avg": 61.85, "max": 1.52, "min": 418.91, "cnt": 29}, "backward-send":{"total": 2.39, "avg": 0.80, "max": 0.62, "min": 0.92, "cnt": 3}, "backward-recv":{"total": 124.77, "avg": 62.39, "max": 55.14, "min": 69.63, "cnt": 2}, "backward-params-all-reduce":{"total": 492.79, "avg": 492.79, "max": 492.79, "min": 492.79, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 251.62, "avg": 251.62, "max": 251.62, "min": 251.62, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 211.74, "avg": 211.74, "max": 211.74, "min": 211.74, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.31, "avg": 3.31, "max": 3.31, "min": 3.31, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 148, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 80.38, "avg": 26.79, "max": 3.47, "min": 72.93, "cnt": 3}, "forward-compute":{"total": 1928.46, "avg": 60.26, "max": 53.17, "min": 73.30, "cnt": 32}, "fwd-compute":{"total": 1925.20, "avg": 60.16, "max": 53.10, "min": 73.22, "cnt": 32}, "batch-generator":{"total": 42.65, "avg": 1.33, "max": 0.68, "min": 2.62, "cnt": 32}, "fwd-embedding":{"total": 0.67, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1869.90, "avg": 58.43, "max": 52.12, "min": 71.90, "cnt": 32}, "fwd-layernorm":{"total": 9.73, "avg": 0.08, "max": 0.05, "min": 0.18, "cnt": 128}, "fwd-attn":{"total": 112.18, "avg": 0.88, "max": 0.74, "min": 2.19, "cnt": 128}, "fwd-misc":{"total": 21.86, "avg": 0.17, "max": 0.11, "min": 0.74, "cnt": 128}, "fwd-MLP":{"total": 1704.73, "avg": 13.32, "max": 10.52, "min": 23.33, "cnt": 128}, "MoE_L0_fwd":{"total": 512.97, "avg": 16.03, "max": 12.59, "min": 23.19, "cnt": 32}, "MoEMLP":{"total": 1687.33, "avg": 13.18, "max": 10.41, "min": 23.10, "cnt": 128}, "MoE_L1_fwd":{"total": 395.68, "avg": 12.37, "max": 11.31, "min": 16.99, "cnt": 32}, "MoE_L2_fwd":{"total": 421.43, "avg": 13.17, "max": 12.34, "min": 15.51, "cnt": 32}, "MoE_L3_fwd":{"total": 363.54, "avg": 11.36, "max": 10.45, "min": 16.51, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.69, "avg": 0.84, "max": 0.81, "min": 0.88, "cnt": 2}, "forward-send-backward-recv":{"total": 1135.39, "avg": 37.85, "max": 1.43, "min": 359.95, "cnt": 30}, "backward-compute":{"total": 1835.99, "avg": 57.37, "max": 55.31, "min": 60.98, "cnt": 32}, "MoE_L3_bwd":{"total": 393.12, "avg": 12.29, "max": 10.39, "min": 14.33, "cnt": 32}, "MoE_L2_bwd":{"total": 422.64, "avg": 13.21, "max": 12.47, "min": 14.20, "cnt": 32}, "MoE_L1_bwd":{"total": 357.43, "avg": 11.17, "max": 10.55, "min": 11.52, "cnt": 32}, "MoE_L0_bwd":{"total": 448.89, "avg": 14.03, "max": 13.57, "min": 16.36, "cnt": 32}, "backward-send-forward-recv":{"total": 2603.99, "avg": 89.79, "max": 1.51, "min": 581.19, "cnt": 29}, "backward-send":{"total": 2.47, "avg": 0.82, "max": 0.61, "min": 1.06, "cnt": 3}, "backward-recv":{"total": 217.02, "avg": 108.51, "max": 76.58, "min": 140.44, "cnt": 2}, "backward-params-all-reduce":{"total": 488.02, "avg": 488.02, "max": 488.02, "min": 488.02, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 246.93, "avg": 246.93, "max": 246.93, "min": 246.93, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.36, "avg": 3.36, "max": 3.36, "min": 3.36, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 207.06, "avg": 207.06, "max": 207.06, "min": 207.06, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.30, "avg": 3.30, "max": 3.30, "min": 3.30, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}}}
{"type":"time", "iteration": 149, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 73.86, "avg": 24.62, "max": 0.96, "min": 71.94, "cnt": 3}, "forward-compute":{"total": 1937.21, "avg": 60.54, "max": 53.33, "min": 64.78, "cnt": 32}, "fwd-compute":{"total": 1933.97, "avg": 60.44, "max": 53.26, "min": 64.65, "cnt": 32}, "batch-generator":{"total": 45.49, "avg": 1.42, "max": 0.69, "min": 2.84, "cnt": 32}, "fwd-embedding":{"total": 0.67, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1875.25, "avg": 58.60, "max": 52.25, "min": 62.61, "cnt": 32}, "fwd-layernorm":{"total": 9.93, "avg": 0.08, "max": 0.05, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 109.53, "avg": 0.86, "max": 0.74, "min": 1.74, "cnt": 128}, "fwd-misc":{"total": 21.20, "avg": 0.17, "max": 0.11, "min": 0.44, "cnt": 128}, "fwd-MLP":{"total": 1713.53, "avg": 13.39, "max": 10.49, "min": 18.94, "cnt": 128}, "MoE_L0_fwd":{"total": 497.28, "avg": 15.54, "max": 12.84, "min": 18.86, "cnt": 32}, "MoEMLP":{"total": 1696.66, "avg": 13.26, "max": 10.37, "min": 18.81, "cnt": 128}, "MoE_L1_fwd":{"total": 416.27, "avg": 13.01, "max": 11.74, "min": 16.19, "cnt": 32}, "MoE_L2_fwd":{"total": 431.19, "avg": 13.47, "max": 12.50, "min": 15.32, "cnt": 32}, "MoE_L3_fwd":{"total": 358.07, "avg": 11.19, "max": 10.42, "min": 13.21, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 4.61, "avg": 2.31, "max": 0.91, "min": 3.70, "cnt": 2}, "forward-send-backward-recv":{"total": 190.17, "avg": 6.34, "max": 1.85, "min": 119.83, "cnt": 30}, "backward-compute":{"total": 1840.93, "avg": 57.53, "max": 55.09, "min": 60.13, "cnt": 32}, "MoE_L3_bwd":{"total": 384.70, "avg": 12.02, "max": 11.50, "min": 14.35, "cnt": 32}, "MoE_L2_bwd":{"total": 423.90, "avg": 13.25, "max": 12.60, "min": 13.81, "cnt": 32}, "MoE_L1_bwd":{"total": 365.75, "avg": 11.43, "max": 11.11, "min": 12.09, "cnt": 32}, "MoE_L0_bwd":{"total": 449.55, "avg": 14.05, "max": 13.29, "min": 14.57, "cnt": 32}, "backward-send-forward-recv":{"total": 2828.82, "avg": 97.55, "max": 1.63, "min": 388.31, "cnt": 29}, "backward-send":{"total": 3.09, "avg": 1.03, "max": 0.96, "min": 1.12, "cnt": 3}, "backward-recv":{"total": 137.98, "avg": 68.99, "max": 64.34, "min": 73.64, "cnt": 2}, "backward-params-all-reduce":{"total": 485.23, "avg": 485.23, "max": 485.23, "min": 485.23, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 243.19, "avg": 243.19, "max": 243.19, "min": 243.19, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 203.28, "avg": 203.28, "max": 203.28, "min": 203.28, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.29, "avg": 3.29, "max": 3.29, "min": 3.29, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 150, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 74.00, "avg": 24.67, "max": 1.09, "min": 71.69, "cnt": 3}, "forward-compute":{"total": 1916.55, "avg": 59.89, "max": 55.05, "min": 65.01, "cnt": 32}, "fwd-compute":{"total": 1913.39, "avg": 59.79, "max": 54.99, "min": 64.90, "cnt": 32}, "batch-generator":{"total": 45.80, "avg": 1.43, "max": 0.70, "min": 4.28, "cnt": 32}, "fwd-embedding":{"total": 0.61, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1854.72, "avg": 57.96, "max": 53.75, "min": 63.50, "cnt": 32}, "fwd-layernorm":{"total": 9.53, "avg": 0.07, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 108.94, "avg": 0.85, "max": 0.74, "min": 1.53, "cnt": 128}, "fwd-misc":{"total": 20.97, "avg": 0.16, "max": 0.11, "min": 0.40, "cnt": 128}, "fwd-MLP":{"total": 1694.33, "avg": 13.24, "max": 10.80, "min": 19.94, "cnt": 128}, "MoE_L0_fwd":{"total": 499.07, "avg": 15.60, "max": 12.83, "min": 19.86, "cnt": 32}, "MoEMLP":{"total": 1677.46, "avg": 13.11, "max": 10.69, "min": 19.82, "cnt": 128}, "MoE_L1_fwd":{"total": 399.88, "avg": 12.50, "max": 11.48, "min": 18.25, "cnt": 32}, "MoE_L2_fwd":{"total": 414.49, "avg": 12.95, "max": 12.26, "min": 16.53, "cnt": 32}, "MoE_L3_fwd":{"total": 370.19, "avg": 11.57, "max": 10.73, "min": 14.69, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.82, "avg": 0.91, "max": 0.88, "min": 0.94, "cnt": 2}, "forward-send-backward-recv":{"total": 195.39, "avg": 6.51, "max": 1.21, "min": 111.83, "cnt": 30}, "backward-compute":{"total": 1847.93, "avg": 57.75, "max": 55.55, "min": 61.38, "cnt": 32}, "MoE_L3_bwd":{"total": 394.09, "avg": 12.32, "max": 11.65, "min": 14.88, "cnt": 32}, "MoE_L2_bwd":{"total": 430.56, "avg": 13.45, "max": 12.60, "min": 16.94, "cnt": 32}, "MoE_L1_bwd":{"total": 360.90, "avg": 11.28, "max": 10.66, "min": 11.80, "cnt": 32}, "MoE_L0_bwd":{"total": 447.16, "avg": 13.97, "max": 13.53, "min": 14.45, "cnt": 32}, "backward-send-forward-recv":{"total": 2254.42, "avg": 77.74, "max": 1.58, "min": 310.62, "cnt": 29}, "backward-send":{"total": 2.19, "avg": 0.73, "max": 0.56, "min": 0.88, "cnt": 3}, "backward-recv":{"total": 447.13, "avg": 223.57, "max": 59.14, "min": 387.99, "cnt": 2}, "backward-params-all-reduce":{"total": 488.72, "avg": 488.72, "max": 488.72, "min": 488.72, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 239.51, "avg": 239.51, "max": 239.51, "min": 239.51, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 199.82, "avg": 199.82, "max": 199.82, "min": 199.82, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.24, "avg": 3.24, "max": 3.24, "min": 3.24, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.41, "avg": 3.41, "max": 3.41, "min": 3.41, "cnt": 1}}}
{"type":"time", "iteration": 151, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.06, "avg": 0.06, "max": 0.06, "min": 0.06, "cnt": 1}, "forward-recv":{"total": 73.91, "avg": 24.64, "max": 0.80, "min": 72.12, "cnt": 3}, "forward-compute":{"total": 1955.82, "avg": 61.12, "max": 54.30, "min": 126.39, "cnt": 32}, "fwd-compute":{"total": 1952.71, "avg": 61.02, "max": 54.20, "min": 126.31, "cnt": 32}, "batch-generator":{"total": 40.48, "avg": 1.27, "max": 0.66, "min": 2.74, "cnt": 32}, "fwd-embedding":{"total": 0.64, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1899.69, "avg": 59.37, "max": 52.74, "min": 125.14, "cnt": 32}, "fwd-layernorm":{"total": 9.57, "avg": 0.07, "max": 0.05, "min": 0.18, "cnt": 128}, "fwd-attn":{"total": 112.45, "avg": 0.88, "max": 0.74, "min": 3.06, "cnt": 128}, "fwd-misc":{"total": 20.39, "avg": 0.16, "max": 0.11, "min": 0.38, "cnt": 128}, "fwd-MLP":{"total": 1736.68, "avg": 13.57, "max": 10.29, "min": 82.51, "cnt": 128}, "MoE_L0_fwd":{"total": 502.92, "avg": 15.72, "max": 13.18, "min": 19.59, "cnt": 32}, "MoEMLP":{"total": 1720.17, "avg": 13.44, "max": 10.19, "min": 82.39, "cnt": 128}, "MoE_L1_fwd":{"total": 384.96, "avg": 12.03, "max": 11.16, "min": 12.86, "cnt": 32}, "MoE_L2_fwd":{"total": 481.98, "avg": 15.06, "max": 12.34, "min": 82.43, "cnt": 32}, "MoE_L3_fwd":{"total": 356.36, "avg": 11.14, "max": 10.23, "min": 15.50, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.53, "avg": 0.77, "max": 0.74, "min": 0.80, "cnt": 2}, "forward-send-backward-recv":{"total": 433.46, "avg": 14.45, "max": 1.41, "min": 138.54, "cnt": 30}, "backward-compute":{"total": 1822.49, "avg": 56.95, "max": 55.50, "min": 58.99, "cnt": 32}, "MoE_L3_bwd":{"total": 381.33, "avg": 11.92, "max": 10.76, "min": 13.55, "cnt": 32}, "MoE_L2_bwd":{"total": 419.89, "avg": 13.12, "max": 12.67, "min": 13.74, "cnt": 32}, "MoE_L1_bwd":{"total": 355.45, "avg": 11.11, "max": 10.63, "min": 11.59, "cnt": 32}, "MoE_L0_bwd":{"total": 450.31, "avg": 14.07, "max": 13.58, "min": 14.61, "cnt": 32}, "backward-send-forward-recv":{"total": 2518.88, "avg": 86.86, "max": 2.01, "min": 1052.55, "cnt": 29}, "backward-send":{"total": 2.96, "avg": 0.99, "max": 0.76, "min": 1.11, "cnt": 3}, "backward-recv":{"total": 115.29, "avg": 57.64, "max": 52.35, "min": 62.93, "cnt": 2}, "backward-params-all-reduce":{"total": 492.47, "avg": 492.47, "max": 492.47, "min": 492.47, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 252.48, "avg": 252.48, "max": 252.48, "min": 252.48, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 208.79, "avg": 208.79, "max": 208.79, "min": 208.79, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.59, "avg": 3.59, "max": 3.59, "min": 3.59, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.40, "avg": 3.40, "max": 3.40, "min": 3.40, "cnt": 1}}}
{"type":"time", "iteration": 152, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 67.15, "avg": 22.38, "max": 1.01, "min": 64.94, "cnt": 3}, "forward-compute":{"total": 1905.99, "avg": 59.56, "max": 54.29, "min": 69.09, "cnt": 32}, "fwd-compute":{"total": 1902.70, "avg": 59.46, "max": 54.20, "min": 68.98, "cnt": 32}, "batch-generator":{"total": 39.62, "avg": 1.24, "max": 0.69, "min": 1.68, "cnt": 32}, "fwd-embedding":{"total": 0.72, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1850.18, "avg": 57.82, "max": 53.17, "min": 66.97, "cnt": 32}, "fwd-layernorm":{"total": 9.80, "avg": 0.08, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 110.30, "avg": 0.86, "max": 0.74, "min": 1.47, "cnt": 128}, "fwd-misc":{"total": 21.09, "avg": 0.16, "max": 0.11, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1687.84, "avg": 13.19, "max": 10.42, "min": 19.71, "cnt": 128}, "MoE_L0_fwd":{"total": 516.82, "avg": 16.15, "max": 13.52, "min": 19.63, "cnt": 32}, "MoEMLP":{"total": 1670.74, "avg": 13.05, "max": 10.30, "min": 19.59, "cnt": 128}, "MoE_L1_fwd":{"total": 395.15, "avg": 12.35, "max": 11.35, "min": 14.93, "cnt": 32}, "MoE_L2_fwd":{"total": 411.32, "avg": 12.85, "max": 12.16, "min": 15.77, "cnt": 32}, "MoE_L3_fwd":{"total": 353.72, "avg": 11.05, "max": 10.34, "min": 13.74, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.46, "avg": 0.73, "max": 0.72, "min": 0.74, "cnt": 2}, "forward-send-backward-recv":{"total": 255.02, "avg": 8.50, "max": 1.74, "min": 119.39, "cnt": 30}, "backward-compute":{"total": 1817.93, "avg": 56.81, "max": 55.63, "min": 59.25, "cnt": 32}, "MoE_L3_bwd":{"total": 377.22, "avg": 11.79, "max": 11.19, "min": 12.82, "cnt": 32}, "MoE_L2_bwd":{"total": 416.75, "avg": 13.02, "max": 12.43, "min": 15.95, "cnt": 32}, "MoE_L1_bwd":{"total": 356.27, "avg": 11.13, "max": 10.77, "min": 11.51, "cnt": 32}, "MoE_L0_bwd":{"total": 451.13, "avg": 14.10, "max": 13.67, "min": 14.61, "cnt": 32}, "backward-send-forward-recv":{"total": 1084.86, "avg": 37.41, "max": 1.55, "min": 149.97, "cnt": 29}, "backward-send":{"total": 1.61, "avg": 0.54, "max": 0.43, "min": 0.65, "cnt": 3}, "backward-recv":{"total": 123.62, "avg": 61.81, "max": 52.78, "min": 70.84, "cnt": 2}, "backward-params-all-reduce":{"total": 485.67, "avg": 485.67, "max": 485.67, "min": 485.67, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 243.85, "avg": 243.85, "max": 243.85, "min": 243.85, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 203.96, "avg": 203.96, "max": 203.96, "min": 203.96, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.28, "avg": 3.28, "max": 3.28, "min": 3.28, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 153, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 71.62, "avg": 23.87, "max": 0.88, "min": 69.78, "cnt": 3}, "forward-compute":{"total": 1916.55, "avg": 59.89, "max": 53.91, "min": 65.60, "cnt": 32}, "fwd-compute":{"total": 1913.03, "avg": 59.78, "max": 53.83, "min": 65.41, "cnt": 32}, "batch-generator":{"total": 43.09, "avg": 1.35, "max": 0.68, "min": 3.29, "cnt": 32}, "fwd-embedding":{"total": 0.68, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1855.98, "avg": 58.00, "max": 52.82, "min": 63.15, "cnt": 32}, "fwd-layernorm":{"total": 10.25, "avg": 0.08, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 112.52, "avg": 0.88, "max": 0.74, "min": 2.59, "cnt": 128}, "fwd-misc":{"total": 21.54, "avg": 0.17, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1689.25, "avg": 13.20, "max": 10.47, "min": 22.74, "cnt": 128}, "MoE_L0_fwd":{"total": 524.79, "avg": 16.40, "max": 13.49, "min": 22.57, "cnt": 32}, "MoEMLP":{"total": 1671.55, "avg": 13.06, "max": 10.35, "min": 22.52, "cnt": 128}, "MoE_L1_fwd":{"total": 389.71, "avg": 12.18, "max": 11.19, "min": 15.13, "cnt": 32}, "MoE_L2_fwd":{"total": 407.86, "avg": 12.75, "max": 12.00, "min": 13.98, "cnt": 32}, "MoE_L3_fwd":{"total": 355.62, "avg": 11.11, "max": 10.39, "min": 13.06, "cnt": 32}, "fwd-pooler":{"total": 0.36, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.64, "avg": 0.02, "max": 0.02, "min": 0.04, "cnt": 32}, "forward-send":{"total": 4.66, "avg": 2.33, "max": 0.50, "min": 4.16, "cnt": 2}, "forward-send-backward-recv":{"total": 643.10, "avg": 21.44, "max": 1.05, "min": 224.10, "cnt": 30}, "backward-compute":{"total": 1819.69, "avg": 56.87, "max": 54.86, "min": 60.26, "cnt": 32}, "MoE_L3_bwd":{"total": 384.82, "avg": 12.03, "max": 11.16, "min": 14.58, "cnt": 32}, "MoE_L2_bwd":{"total": 408.98, "avg": 12.78, "max": 11.94, "min": 14.66, "cnt": 32}, "MoE_L1_bwd":{"total": 351.11, "avg": 10.97, "max": 10.23, "min": 11.34, "cnt": 32}, "MoE_L0_bwd":{"total": 456.19, "avg": 14.26, "max": 13.86, "min": 14.72, "cnt": 32}, "backward-send-forward-recv":{"total": 1489.00, "avg": 51.34, "max": 1.46, "min": 303.78, "cnt": 29}, "backward-send":{"total": 1.84, "avg": 0.61, "max": 0.52, "min": 0.78, "cnt": 3}, "backward-recv":{"total": 149.64, "avg": 74.82, "max": 67.31, "min": 82.33, "cnt": 2}, "backward-params-all-reduce":{"total": 485.57, "avg": 485.57, "max": 485.57, "min": 485.57, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 241.84, "avg": 241.84, "max": 241.84, "min": 241.84, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 202.16, "avg": 202.16, "max": 202.16, "min": 202.16, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.25, "avg": 3.25, "max": 3.25, "min": 3.25, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}}}
{"type":"time", "iteration": 154, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.10, "avg": 0.10, "max": 0.10, "min": 0.10, "cnt": 1}, "forward-recv":{"total": 73.65, "avg": 24.55, "max": 1.25, "min": 70.98, "cnt": 3}, "forward-compute":{"total": 1896.47, "avg": 59.26, "max": 54.29, "min": 67.35, "cnt": 32}, "fwd-compute":{"total": 1892.95, "avg": 59.15, "max": 54.21, "min": 67.21, "cnt": 32}, "batch-generator":{"total": 42.39, "avg": 1.32, "max": 0.80, "min": 1.77, "cnt": 32}, "fwd-embedding":{"total": 0.75, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1836.67, "avg": 57.40, "max": 52.97, "min": 65.70, "cnt": 32}, "fwd-layernorm":{"total": 10.47, "avg": 0.08, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 113.44, "avg": 0.89, "max": 0.74, "min": 2.07, "cnt": 128}, "fwd-misc":{"total": 22.57, "avg": 0.18, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1668.14, "avg": 13.03, "max": 10.36, "min": 20.65, "cnt": 128}, "MoE_L0_fwd":{"total": 509.53, "avg": 15.92, "max": 13.21, "min": 20.56, "cnt": 32}, "MoEMLP":{"total": 1650.15, "avg": 12.89, "max": 10.24, "min": 20.50, "cnt": 128}, "MoE_L1_fwd":{"total": 384.22, "avg": 12.01, "max": 11.19, "min": 15.27, "cnt": 32}, "MoE_L2_fwd":{"total": 408.83, "avg": 12.78, "max": 12.04, "min": 14.14, "cnt": 32}, "MoE_L3_fwd":{"total": 354.09, "avg": 11.07, "max": 10.28, "min": 15.42, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.64, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.91, "avg": 0.95, "max": 0.91, "min": 0.99, "cnt": 2}, "forward-send-backward-recv":{"total": 447.30, "avg": 14.91, "max": 1.06, "min": 126.33, "cnt": 30}, "backward-compute":{"total": 1798.24, "avg": 56.19, "max": 53.96, "min": 58.29, "cnt": 32}, "MoE_L3_bwd":{"total": 381.09, "avg": 11.91, "max": 11.40, "min": 12.85, "cnt": 32}, "MoE_L2_bwd":{"total": 409.97, "avg": 12.81, "max": 12.14, "min": 13.40, "cnt": 32}, "MoE_L1_bwd":{"total": 340.27, "avg": 10.63, "max": 9.99, "min": 11.05, "cnt": 32}, "MoE_L0_bwd":{"total": 449.89, "avg": 14.06, "max": 13.52, "min": 14.41, "cnt": 32}, "backward-send-forward-recv":{"total": 1112.46, "avg": 38.36, "max": 1.98, "min": 217.62, "cnt": 29}, "backward-send":{"total": 3.22, "avg": 1.07, "max": 0.97, "min": 1.20, "cnt": 3}, "backward-recv":{"total": 216.56, "avg": 108.28, "max": 53.53, "min": 163.03, "cnt": 2}, "backward-params-all-reduce":{"total": 485.22, "avg": 485.22, "max": 485.22, "min": 485.22, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.04, "avg": 0.04, "max": 0.04, "min": 0.04, "cnt": 1}, "optimizer":{"total": 241.68, "avg": 241.68, "max": 241.68, "min": 241.68, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 201.75, "avg": 201.75, "max": 201.75, "min": 201.75, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.32, "avg": 3.32, "max": 3.32, "min": 3.32, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 155, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 2730.83, "avg": 910.28, "max": 0.77, "min": 2728.98, "cnt": 3}, "forward-compute":{"total": 1918.24, "avg": 59.94, "max": 52.92, "min": 65.87, "cnt": 32}, "fwd-compute":{"total": 1914.72, "avg": 59.83, "max": 52.85, "min": 65.78, "cnt": 32}, "batch-generator":{"total": 52.51, "avg": 1.64, "max": 0.75, "min": 3.97, "cnt": 32}, "fwd-embedding":{"total": 0.79, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1848.64, "avg": 57.77, "max": 51.79, "min": 63.13, "cnt": 32}, "fwd-layernorm":{"total": 10.86, "avg": 0.08, "max": 0.06, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 115.04, "avg": 0.90, "max": 0.74, "min": 2.85, "cnt": 128}, "fwd-misc":{"total": 22.48, "avg": 0.18, "max": 0.11, "min": 0.39, "cnt": 128}, "fwd-MLP":{"total": 1677.68, "avg": 13.11, "max": 10.29, "min": 18.21, "cnt": 128}, "MoE_L0_fwd":{"total": 512.45, "avg": 16.01, "max": 13.03, "min": 18.09, "cnt": 32}, "MoEMLP":{"total": 1659.67, "avg": 12.97, "max": 10.18, "min": 18.02, "cnt": 128}, "MoE_L1_fwd":{"total": 386.90, "avg": 12.09, "max": 11.24, "min": 16.59, "cnt": 32}, "MoE_L2_fwd":{"total": 413.86, "avg": 12.93, "max": 12.12, "min": 17.33, "cnt": 32}, "MoE_L3_fwd":{"total": 352.97, "avg": 11.03, "max": 10.22, "min": 13.81, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 17.67, "avg": 8.84, "max": 0.88, "min": 16.79, "cnt": 2}, "forward-send-backward-recv":{"total": 691.41, "avg": 23.05, "max": 1.30, "min": 184.82, "cnt": 30}, "backward-compute":{"total": 1796.09, "avg": 56.13, "max": 53.64, "min": 58.63, "cnt": 32}, "MoE_L3_bwd":{"total": 381.47, "avg": 11.92, "max": 11.29, "min": 14.73, "cnt": 32}, "MoE_L2_bwd":{"total": 408.54, "avg": 12.77, "max": 12.21, "min": 13.80, "cnt": 32}, "MoE_L1_bwd":{"total": 341.32, "avg": 10.67, "max": 9.92, "min": 11.26, "cnt": 32}, "MoE_L0_bwd":{"total": 449.62, "avg": 14.05, "max": 13.38, "min": 15.84, "cnt": 32}, "backward-send-forward-recv":{"total": 3547.77, "avg": 122.34, "max": 1.90, "min": 1072.01, "cnt": 29}, "backward-send":{"total": 2.23, "avg": 0.74, "max": 0.47, "min": 1.04, "cnt": 3}, "backward-recv":{"total": 174.57, "avg": 87.29, "max": 66.92, "min": 107.65, "cnt": 2}, "backward-params-all-reduce":{"total": 496.63, "avg": 496.63, "max": 496.63, "min": 496.63, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 237.46, "avg": 237.46, "max": 237.46, "min": 237.46, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.36, "avg": 3.36, "max": 3.36, "min": 3.36, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 192.88, "avg": 192.88, "max": 192.88, "min": 192.88, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.41, "avg": 3.41, "max": 3.41, "min": 3.41, "cnt": 1}}}
{"type":"time", "iteration": 156, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 74.33, "avg": 24.78, "max": 1.19, "min": 67.83, "cnt": 3}, "forward-compute":{"total": 1902.68, "avg": 59.46, "max": 52.43, "min": 64.37, "cnt": 32}, "fwd-compute":{"total": 1899.19, "avg": 59.35, "max": 52.37, "min": 64.23, "cnt": 32}, "batch-generator":{"total": 46.28, "avg": 1.45, "max": 0.68, "min": 2.81, "cnt": 32}, "fwd-embedding":{"total": 0.72, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1839.69, "avg": 57.49, "max": 51.39, "min": 62.43, "cnt": 32}, "fwd-layernorm":{"total": 9.94, "avg": 0.08, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 109.85, "avg": 0.86, "max": 0.74, "min": 1.53, "cnt": 128}, "fwd-misc":{"total": 21.27, "avg": 0.17, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1677.52, "avg": 13.11, "max": 10.09, "min": 20.48, "cnt": 128}, "MoE_L0_fwd":{"total": 511.79, "avg": 15.99, "max": 13.15, "min": 20.35, "cnt": 32}, "MoEMLP":{"total": 1660.42, "avg": 12.97, "max": 9.96, "min": 20.31, "cnt": 128}, "MoE_L1_fwd":{"total": 382.69, "avg": 11.96, "max": 10.76, "min": 15.14, "cnt": 32}, "MoE_L2_fwd":{"total": 420.66, "avg": 13.15, "max": 12.17, "min": 15.77, "cnt": 32}, "MoE_L3_fwd":{"total": 351.53, "avg": 10.99, "max": 10.01, "min": 12.26, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.61, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.81, "avg": 0.90, "max": 0.87, "min": 0.94, "cnt": 2}, "forward-send-backward-recv":{"total": 179.59, "avg": 5.99, "max": 1.40, "min": 115.73, "cnt": 30}, "backward-compute":{"total": 1782.15, "avg": 55.69, "max": 53.05, "min": 56.98, "cnt": 32}, "MoE_L3_bwd":{"total": 380.44, "avg": 11.89, "max": 11.09, "min": 12.75, "cnt": 32}, "MoE_L2_bwd":{"total": 408.16, "avg": 12.75, "max": 11.66, "min": 13.46, "cnt": 32}, "MoE_L1_bwd":{"total": 329.34, "avg": 10.29, "max": 9.96, "min": 10.68, "cnt": 32}, "MoE_L0_bwd":{"total": 450.20, "avg": 14.07, "max": 13.41, "min": 14.56, "cnt": 32}, "backward-send-forward-recv":{"total": 2050.41, "avg": 70.70, "max": 1.95, "min": 291.72, "cnt": 29}, "backward-send":{"total": 2.24, "avg": 0.75, "max": 0.45, "min": 1.12, "cnt": 3}, "backward-recv":{"total": 134.69, "avg": 67.34, "max": 63.64, "min": 71.05, "cnt": 2}, "backward-params-all-reduce":{"total": 486.00, "avg": 486.00, "max": 486.00, "min": 486.00, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 248.06, "avg": 248.06, "max": 248.06, "min": 248.06, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.36, "avg": 3.36, "max": 3.36, "min": 3.36, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 207.93, "avg": 207.93, "max": 207.93, "min": 207.93, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.53, "avg": 3.53, "max": 3.53, "min": 3.53, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 157, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 81.43, "avg": 27.14, "max": 1.17, "min": 72.65, "cnt": 3}, "forward-compute":{"total": 1862.00, "avg": 58.19, "max": 53.90, "min": 68.38, "cnt": 32}, "fwd-compute":{"total": 1858.70, "avg": 58.08, "max": 53.82, "min": 68.28, "cnt": 32}, "batch-generator":{"total": 40.72, "avg": 1.27, "max": 0.73, "min": 2.55, "cnt": 32}, "fwd-embedding":{"total": 0.70, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1804.91, "avg": 56.40, "max": 52.39, "min": 66.85, "cnt": 32}, "fwd-layernorm":{"total": 9.84, "avg": 0.08, "max": 0.05, "min": 0.18, "cnt": 128}, "fwd-attn":{"total": 109.89, "avg": 0.86, "max": 0.74, "min": 2.40, "cnt": 128}, "fwd-misc":{"total": 21.39, "avg": 0.17, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1642.75, "avg": 12.83, "max": 10.20, "min": 25.54, "cnt": 128}, "MoE_L0_fwd":{"total": 506.31, "avg": 15.82, "max": 13.12, "min": 25.44, "cnt": 32}, "MoEMLP":{"total": 1625.79, "avg": 12.70, "max": 10.09, "min": 25.39, "cnt": 128}, "MoE_L1_fwd":{"total": 386.21, "avg": 12.07, "max": 11.18, "min": 13.42, "cnt": 32}, "MoE_L2_fwd":{"total": 398.23, "avg": 12.44, "max": 11.75, "min": 13.27, "cnt": 32}, "MoE_L3_fwd":{"total": 341.26, "avg": 10.66, "max": 10.13, "min": 11.66, "cnt": 32}, "fwd-pooler":{"total": 0.36, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.34, "avg": 0.67, "max": 0.57, "min": 0.77, "cnt": 2}, "forward-send-backward-recv":{"total": 253.85, "avg": 8.46, "max": 1.25, "min": 107.63, "cnt": 30}, "backward-compute":{"total": 1795.48, "avg": 56.11, "max": 54.81, "min": 59.23, "cnt": 32}, "MoE_L3_bwd":{"total": 376.75, "avg": 11.77, "max": 11.15, "min": 13.05, "cnt": 32}, "MoE_L2_bwd":{"total": 401.27, "avg": 12.54, "max": 11.87, "min": 13.32, "cnt": 32}, "MoE_L1_bwd":{"total": 343.81, "avg": 10.74, "max": 10.07, "min": 12.63, "cnt": 32}, "MoE_L0_bwd":{"total": 455.74, "avg": 14.24, "max": 13.71, "min": 15.26, "cnt": 32}, "backward-send-forward-recv":{"total": 1870.09, "avg": 64.49, "max": 2.06, "min": 401.93, "cnt": 29}, "backward-send":{"total": 2.39, "avg": 0.80, "max": 0.69, "min": 0.92, "cnt": 3}, "backward-recv":{"total": 204.87, "avg": 102.44, "max": 67.42, "min": 137.45, "cnt": 2}, "backward-params-all-reduce":{"total": 491.26, "avg": 491.26, "max": 491.26, "min": 491.26, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 241.15, "avg": 241.15, "max": 241.15, "min": 241.15, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.36, "avg": 3.36, "max": 3.36, "min": 3.36, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 197.61, "avg": 197.61, "max": 197.61, "min": 197.61, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.29, "avg": 3.29, "max": 3.29, "min": 3.29, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}}}
{"type":"time", "iteration": 158, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 73.62, "avg": 24.54, "max": 0.87, "min": 70.41, "cnt": 3}, "forward-compute":{"total": 1915.10, "avg": 59.85, "max": 52.32, "min": 131.43, "cnt": 32}, "fwd-compute":{"total": 1911.90, "avg": 59.75, "max": 52.26, "min": 131.35, "cnt": 32}, "batch-generator":{"total": 44.35, "avg": 1.39, "max": 0.67, "min": 3.03, "cnt": 32}, "fwd-embedding":{"total": 0.64, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1854.18, "avg": 57.94, "max": 51.19, "min": 130.33, "cnt": 32}, "fwd-layernorm":{"total": 9.96, "avg": 0.08, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 111.02, "avg": 0.87, "max": 0.74, "min": 1.82, "cnt": 128}, "fwd-misc":{"total": 21.07, "avg": 0.16, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1690.10, "avg": 13.20, "max": 9.98, "min": 90.10, "cnt": 128}, "MoE_L0_fwd":{"total": 567.57, "avg": 17.74, "max": 13.13, "min": 90.02, "cnt": 32}, "MoEMLP":{"total": 1672.15, "avg": 13.06, "max": 9.88, "min": 89.97, "cnt": 128}, "MoE_L1_fwd":{"total": 372.99, "avg": 11.66, "max": 10.73, "min": 15.02, "cnt": 32}, "MoE_L2_fwd":{"total": 393.20, "avg": 12.29, "max": 11.69, "min": 15.01, "cnt": 32}, "MoE_L3_fwd":{"total": 344.76, "avg": 10.77, "max": 9.92, "min": 11.81, "cnt": 32}, "fwd-pooler":{"total": 0.36, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.61, "avg": 0.02, "max": 0.02, "min": 0.04, "cnt": 32}, "forward-send":{"total": 6.86, "avg": 3.43, "max": 0.82, "min": 6.03, "cnt": 2}, "forward-send-backward-recv":{"total": 113.18, "avg": 3.77, "max": 1.62, "min": 44.46, "cnt": 30}, "backward-compute":{"total": 1775.12, "avg": 55.47, "max": 53.54, "min": 58.46, "cnt": 32}, "MoE_L3_bwd":{"total": 377.92, "avg": 11.81, "max": 10.06, "min": 14.43, "cnt": 32}, "MoE_L2_bwd":{"total": 396.60, "avg": 12.39, "max": 11.34, "min": 12.98, "cnt": 32}, "MoE_L1_bwd":{"total": 331.33, "avg": 10.35, "max": 9.70, "min": 11.25, "cnt": 32}, "MoE_L0_bwd":{"total": 453.01, "avg": 14.16, "max": 13.55, "min": 16.44, "cnt": 32}, "backward-send-forward-recv":{"total": 2015.96, "avg": 69.52, "max": 2.35, "min": 548.31, "cnt": 29}, "backward-send":{"total": 2.68, "avg": 0.89, "max": 0.61, "min": 1.25, "cnt": 3}, "backward-recv":{"total": 134.71, "avg": 67.36, "max": 63.44, "min": 71.28, "cnt": 2}, "backward-params-all-reduce":{"total": 485.86, "avg": 485.86, "max": 485.86, "min": 485.86, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 244.58, "avg": 244.58, "max": 244.58, "min": 244.58, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 204.63, "avg": 204.63, "max": 204.63, "min": 204.63, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.33, "avg": 3.33, "max": 3.33, "min": 3.33, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.41, "avg": 3.41, "max": 3.41, "min": 3.41, "cnt": 1}}}
{"type":"time", "iteration": 159, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 84.96, "avg": 28.32, "max": 0.85, "min": 81.85, "cnt": 3}, "forward-compute":{"total": 1875.32, "avg": 58.60, "max": 53.80, "min": 62.25, "cnt": 32}, "fwd-compute":{"total": 1871.61, "avg": 58.49, "max": 53.72, "min": 62.16, "cnt": 32}, "batch-generator":{"total": 45.77, "avg": 1.43, "max": 0.70, "min": 4.43, "cnt": 32}, "fwd-embedding":{"total": 0.80, "avg": 0.03, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1812.23, "avg": 56.63, "max": 52.68, "min": 60.75, "cnt": 32}, "fwd-layernorm":{"total": 10.78, "avg": 0.08, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 115.42, "avg": 0.90, "max": 0.74, "min": 1.51, "cnt": 128}, "fwd-misc":{"total": 22.94, "avg": 0.18, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1640.66, "avg": 12.82, "max": 10.17, "min": 20.33, "cnt": 128}, "MoE_L0_fwd":{"total": 519.25, "avg": 16.23, "max": 13.92, "min": 20.24, "cnt": 32}, "MoEMLP":{"total": 1622.48, "avg": 12.68, "max": 10.05, "min": 20.19, "cnt": 128}, "MoE_L1_fwd":{"total": 380.70, "avg": 11.90, "max": 11.11, "min": 13.30, "cnt": 32}, "MoE_L2_fwd":{"total": 385.87, "avg": 12.06, "max": 11.62, "min": 13.31, "cnt": 32}, "MoE_L3_fwd":{"total": 343.34, "avg": 10.73, "max": 10.10, "min": 11.33, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 2.15, "avg": 1.08, "max": 0.83, "min": 1.33, "cnt": 2}, "forward-send-backward-recv":{"total": 1473.40, "avg": 49.11, "max": 2.04, "min": 295.77, "cnt": 30}, "backward-compute":{"total": 1756.72, "avg": 54.90, "max": 53.75, "min": 56.41, "cnt": 32}, "MoE_L3_bwd":{"total": 377.39, "avg": 11.79, "max": 10.95, "min": 13.40, "cnt": 32}, "MoE_L2_bwd":{"total": 378.78, "avg": 11.84, "max": 11.24, "min": 12.37, "cnt": 32}, "MoE_L1_bwd":{"total": 333.24, "avg": 10.41, "max": 10.04, "min": 11.17, "cnt": 32}, "MoE_L0_bwd":{"total": 450.45, "avg": 14.08, "max": 13.80, "min": 15.01, "cnt": 32}, "backward-send-forward-recv":{"total": 561.39, "avg": 19.36, "max": 1.18, "min": 163.05, "cnt": 29}, "backward-send":{"total": 3.05, "avg": 1.02, "max": 0.93, "min": 1.09, "cnt": 3}, "backward-recv":{"total": 357.92, "avg": 178.96, "max": 72.42, "min": 285.51, "cnt": 2}, "backward-params-all-reduce":{"total": 483.44, "avg": 483.44, "max": 483.44, "min": 483.44, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 246.06, "avg": 246.06, "max": 246.06, "min": 246.06, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.36, "avg": 3.36, "max": 3.36, "min": 3.36, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 206.14, "avg": 206.14, "max": 206.14, "min": 206.14, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.30, "avg": 3.30, "max": 3.30, "min": 3.30, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 160, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 85.75, "avg": 28.58, "max": 5.75, "min": 73.59, "cnt": 3}, "forward-compute":{"total": 1878.76, "avg": 58.71, "max": 54.03, "min": 66.04, "cnt": 32}, "fwd-compute":{"total": 1875.33, "avg": 58.60, "max": 53.96, "min": 65.90, "cnt": 32}, "batch-generator":{"total": 43.47, "avg": 1.36, "max": 0.72, "min": 2.54, "cnt": 32}, "fwd-embedding":{"total": 0.77, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1817.56, "avg": 56.80, "max": 52.73, "min": 63.68, "cnt": 32}, "fwd-layernorm":{"total": 10.51, "avg": 0.08, "max": 0.05, "min": 0.18, "cnt": 128}, "fwd-attn":{"total": 113.09, "avg": 0.88, "max": 0.74, "min": 2.56, "cnt": 128}, "fwd-misc":{"total": 21.96, "avg": 0.17, "max": 0.11, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1649.45, "avg": 12.89, "max": 10.15, "min": 19.83, "cnt": 128}, "MoE_L0_fwd":{"total": 505.50, "avg": 15.80, "max": 13.44, "min": 19.75, "cnt": 32}, "MoEMLP":{"total": 1631.44, "avg": 12.75, "max": 10.04, "min": 19.70, "cnt": 128}, "MoE_L1_fwd":{"total": 382.32, "avg": 11.95, "max": 11.00, "min": 16.36, "cnt": 32}, "MoE_L2_fwd":{"total": 394.81, "avg": 12.34, "max": 11.39, "min": 15.63, "cnt": 32}, "MoE_L3_fwd":{"total": 355.35, "avg": 11.10, "max": 10.08, "min": 16.46, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.61, "avg": 0.02, "max": 0.02, "min": 0.04, "cnt": 32}, "forward-send":{"total": 1.81, "avg": 0.90, "max": 0.90, "min": 0.91, "cnt": 2}, "forward-send-backward-recv":{"total": 1150.72, "avg": 38.36, "max": 1.00, "min": 237.56, "cnt": 30}, "backward-compute":{"total": 1776.96, "avg": 55.53, "max": 53.83, "min": 58.18, "cnt": 32}, "MoE_L3_bwd":{"total": 380.80, "avg": 11.90, "max": 10.64, "min": 15.34, "cnt": 32}, "MoE_L2_bwd":{"total": 388.99, "avg": 12.16, "max": 11.32, "min": 13.06, "cnt": 32}, "MoE_L1_bwd":{"total": 338.52, "avg": 10.58, "max": 9.71, "min": 12.13, "cnt": 32}, "MoE_L0_bwd":{"total": 451.99, "avg": 14.12, "max": 13.77, "min": 14.64, "cnt": 32}, "backward-send-forward-recv":{"total": 1311.68, "avg": 45.23, "max": 1.04, "min": 590.02, "cnt": 29}, "backward-send":{"total": 1.96, "avg": 0.65, "max": 0.59, "min": 0.75, "cnt": 3}, "backward-recv":{"total": 154.79, "avg": 77.40, "max": 75.14, "min": 79.66, "cnt": 2}, "backward-params-all-reduce":{"total": 490.93, "avg": 490.93, "max": 490.93, "min": 490.93, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 248.44, "avg": 248.44, "max": 248.44, "min": 248.44, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.36, "avg": 3.36, "max": 3.36, "min": 3.36, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 202.90, "avg": 202.90, "max": 202.90, "min": 202.90, "cnt": 1}, "optimizer-clip-main-grad":{"total": 5.80, "avg": 5.80, "max": 5.80, "min": 5.80, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 161, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 79.97, "avg": 26.66, "max": 1.09, "min": 70.83, "cnt": 3}, "forward-compute":{"total": 1899.16, "avg": 59.35, "max": 55.85, "min": 64.13, "cnt": 32}, "fwd-compute":{"total": 1895.64, "avg": 59.24, "max": 55.76, "min": 64.02, "cnt": 32}, "batch-generator":{"total": 42.40, "avg": 1.32, "max": 0.68, "min": 2.48, "cnt": 32}, "fwd-embedding":{"total": 0.72, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1839.81, "avg": 57.49, "max": 54.17, "min": 62.29, "cnt": 32}, "fwd-layernorm":{"total": 10.39, "avg": 0.08, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 112.81, "avg": 0.88, "max": 0.74, "min": 1.56, "cnt": 128}, "fwd-misc":{"total": 22.38, "avg": 0.17, "max": 0.11, "min": 0.86, "cnt": 128}, "fwd-MLP":{"total": 1672.08, "avg": 13.06, "max": 10.51, "min": 20.89, "cnt": 128}, "MoE_L0_fwd":{"total": 535.33, "avg": 16.73, "max": 14.40, "min": 20.74, "cnt": 32}, "MoEMLP":{"total": 1654.11, "avg": 12.92, "max": 10.39, "min": 20.66, "cnt": 128}, "MoE_L1_fwd":{"total": 386.23, "avg": 12.07, "max": 11.02, "min": 14.41, "cnt": 32}, "MoE_L2_fwd":{"total": 389.68, "avg": 12.18, "max": 11.76, "min": 12.95, "cnt": 32}, "MoE_L3_fwd":{"total": 349.32, "avg": 10.92, "max": 10.43, "min": 11.69, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.81, "avg": 0.90, "max": 0.89, "min": 0.91, "cnt": 2}, "forward-send-backward-recv":{"total": 563.53, "avg": 18.78, "max": 1.55, "min": 201.14, "cnt": 30}, "backward-compute":{"total": 1798.00, "avg": 56.19, "max": 53.05, "min": 59.80, "cnt": 32}, "MoE_L3_bwd":{"total": 388.06, "avg": 12.13, "max": 10.94, "min": 13.72, "cnt": 32}, "MoE_L2_bwd":{"total": 404.06, "avg": 12.63, "max": 11.68, "min": 13.57, "cnt": 32}, "MoE_L1_bwd":{"total": 338.66, "avg": 10.58, "max": 10.18, "min": 14.07, "cnt": 32}, "MoE_L0_bwd":{"total": 451.23, "avg": 14.10, "max": 13.33, "min": 14.94, "cnt": 32}, "backward-send-forward-recv":{"total": 973.45, "avg": 33.57, "max": 1.08, "min": 170.40, "cnt": 29}, "backward-send":{"total": 2.80, "avg": 0.93, "max": 0.79, "min": 1.05, "cnt": 3}, "backward-recv":{"total": 133.82, "avg": 66.91, "max": 65.78, "min": 68.04, "cnt": 2}, "backward-params-all-reduce":{"total": 494.59, "avg": 494.59, "max": 494.59, "min": 494.59, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 237.77, "avg": 237.77, "max": 237.77, "min": 237.77, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 195.24, "avg": 195.24, "max": 195.24, "min": 195.24, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.34, "avg": 3.34, "max": 3.34, "min": 3.34, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}}}
{"type":"time", "iteration": 162, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 76.23, "avg": 25.41, "max": 1.13, "min": 73.53, "cnt": 3}, "forward-compute":{"total": 1886.78, "avg": 58.96, "max": 53.17, "min": 66.37, "cnt": 32}, "fwd-compute":{"total": 1883.29, "avg": 58.85, "max": 53.08, "min": 66.24, "cnt": 32}, "batch-generator":{"total": 47.17, "avg": 1.47, "max": 0.69, "min": 3.10, "cnt": 32}, "fwd-embedding":{"total": 0.80, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1822.35, "avg": 56.95, "max": 51.94, "min": 64.30, "cnt": 32}, "fwd-layernorm":{"total": 10.80, "avg": 0.08, "max": 0.05, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 116.96, "avg": 0.91, "max": 0.74, "min": 2.51, "cnt": 128}, "fwd-misc":{"total": 22.78, "avg": 0.18, "max": 0.11, "min": 0.44, "cnt": 128}, "fwd-MLP":{"total": 1649.55, "avg": 12.89, "max": 10.29, "min": 20.03, "cnt": 128}, "MoE_L0_fwd":{"total": 502.64, "avg": 15.71, "max": 13.27, "min": 19.88, "cnt": 32}, "MoEMLP":{"total": 1631.57, "avg": 12.75, "max": 10.18, "min": 19.79, "cnt": 128}, "MoE_L1_fwd":{"total": 391.46, "avg": 12.23, "max": 11.00, "min": 17.22, "cnt": 32}, "MoE_L2_fwd":{"total": 389.59, "avg": 12.17, "max": 11.33, "min": 16.73, "cnt": 32}, "MoE_L3_fwd":{"total": 354.49, "avg": 11.08, "max": 10.22, "min": 14.55, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.83, "avg": 0.91, "max": 0.82, "min": 1.01, "cnt": 2}, "forward-send-backward-recv":{"total": 466.41, "avg": 15.55, "max": 0.86, "min": 131.25, "cnt": 30}, "backward-compute":{"total": 1784.64, "avg": 55.77, "max": 54.59, "min": 57.25, "cnt": 32}, "MoE_L3_bwd":{"total": 388.59, "avg": 12.14, "max": 11.36, "min": 13.07, "cnt": 32}, "MoE_L2_bwd":{"total": 389.90, "avg": 12.18, "max": 11.30, "min": 13.23, "cnt": 32}, "MoE_L1_bwd":{"total": 345.23, "avg": 10.79, "max": 10.28, "min": 11.27, "cnt": 32}, "MoE_L0_bwd":{"total": 445.44, "avg": 13.92, "max": 13.56, "min": 14.26, "cnt": 32}, "backward-send-forward-recv":{"total": 2041.98, "avg": 70.41, "max": 1.12, "min": 1041.79, "cnt": 29}, "backward-send":{"total": 2.56, "avg": 0.85, "max": 0.78, "min": 0.99, "cnt": 3}, "backward-recv":{"total": 266.77, "avg": 133.39, "max": 68.16, "min": 198.61, "cnt": 2}, "backward-params-all-reduce":{"total": 485.06, "avg": 485.06, "max": 485.06, "min": 485.06, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.04, "avg": 0.04, "max": 0.04, "min": 0.04, "cnt": 1}, "optimizer":{"total": 244.99, "avg": 244.99, "max": 244.99, "min": 244.99, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 205.28, "avg": 205.28, "max": 205.28, "min": 205.28, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.21, "avg": 3.21, "max": 3.21, "min": 3.21, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 163, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 80.07, "avg": 26.69, "max": 0.80, "min": 78.26, "cnt": 3}, "forward-compute":{"total": 1920.41, "avg": 60.01, "max": 53.90, "min": 65.84, "cnt": 32}, "fwd-compute":{"total": 1916.58, "avg": 59.89, "max": 53.83, "min": 65.71, "cnt": 32}, "batch-generator":{"total": 48.57, "avg": 1.52, "max": 0.67, "min": 3.49, "cnt": 32}, "fwd-embedding":{"total": 0.82, "avg": 0.03, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1854.34, "avg": 57.95, "max": 52.82, "min": 63.62, "cnt": 32}, "fwd-layernorm":{"total": 10.70, "avg": 0.08, "max": 0.05, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 114.62, "avg": 0.90, "max": 0.74, "min": 1.91, "cnt": 128}, "fwd-misc":{"total": 22.66, "avg": 0.18, "max": 0.11, "min": 0.44, "cnt": 128}, "fwd-MLP":{"total": 1683.99, "avg": 13.16, "max": 10.51, "min": 19.29, "cnt": 128}, "MoE_L0_fwd":{"total": 523.73, "avg": 16.37, "max": 13.94, "min": 19.17, "cnt": 32}, "MoEMLP":{"total": 1666.09, "avg": 13.02, "max": 10.41, "min": 19.10, "cnt": 128}, "MoE_L1_fwd":{"total": 390.15, "avg": 12.19, "max": 10.93, "min": 15.71, "cnt": 32}, "MoE_L2_fwd":{"total": 394.16, "avg": 12.32, "max": 11.37, "min": 17.58, "cnt": 32}, "MoE_L3_fwd":{"total": 364.68, "avg": 11.40, "max": 10.45, "min": 17.04, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 2.72, "avg": 1.36, "max": 0.91, "min": 1.82, "cnt": 2}, "forward-send-backward-recv":{"total": 355.37, "avg": 11.85, "max": 0.82, "min": 125.93, "cnt": 30}, "backward-compute":{"total": 1780.65, "avg": 55.65, "max": 53.63, "min": 57.44, "cnt": 32}, "MoE_L3_bwd":{"total": 388.80, "avg": 12.15, "max": 11.07, "min": 13.99, "cnt": 32}, "MoE_L2_bwd":{"total": 383.91, "avg": 12.00, "max": 11.15, "min": 13.62, "cnt": 32}, "MoE_L1_bwd":{"total": 339.47, "avg": 10.61, "max": 10.02, "min": 11.82, "cnt": 32}, "MoE_L0_bwd":{"total": 453.23, "avg": 14.16, "max": 13.46, "min": 16.29, "cnt": 32}, "backward-send-forward-recv":{"total": 553.36, "avg": 19.08, "max": 1.62, "min": 179.33, "cnt": 29}, "backward-send":{"total": 2.06, "avg": 0.69, "max": 0.54, "min": 0.80, "cnt": 3}, "backward-recv":{"total": 141.47, "avg": 70.74, "max": 68.92, "min": 72.55, "cnt": 2}, "backward-params-all-reduce":{"total": 487.74, "avg": 487.74, "max": 487.74, "min": 487.74, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 248.12, "avg": 248.12, "max": 248.12, "min": 248.12, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 203.76, "avg": 203.76, "max": 203.76, "min": 203.76, "cnt": 1}, "optimizer-clip-main-grad":{"total": 5.98, "avg": 5.98, "max": 5.98, "min": 5.98, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}}}
{"type":"time", "iteration": 164, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 179.64, "avg": 59.88, "max": 0.94, "min": 105.59, "cnt": 3}, "forward-compute":{"total": 1913.44, "avg": 59.79, "max": 53.04, "min": 64.82, "cnt": 32}, "fwd-compute":{"total": 1910.12, "avg": 59.69, "max": 52.96, "min": 64.67, "cnt": 32}, "batch-generator":{"total": 42.48, "avg": 1.33, "max": 0.71, "min": 2.58, "cnt": 32}, "fwd-embedding":{"total": 0.72, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1854.59, "avg": 57.96, "max": 51.61, "min": 62.98, "cnt": 32}, "fwd-layernorm":{"total": 10.06, "avg": 0.08, "max": 0.05, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 112.25, "avg": 0.88, "max": 0.74, "min": 1.53, "cnt": 128}, "fwd-misc":{"total": 22.60, "avg": 0.18, "max": 0.11, "min": 0.67, "cnt": 128}, "fwd-MLP":{"total": 1687.91, "avg": 13.19, "max": 10.44, "min": 21.20, "cnt": 128}, "MoE_L0_fwd":{"total": 544.13, "avg": 17.00, "max": 13.83, "min": 21.12, "cnt": 32}, "MoEMLP":{"total": 1670.54, "avg": 13.05, "max": 10.33, "min": 21.08, "cnt": 128}, "MoE_L1_fwd":{"total": 387.56, "avg": 12.11, "max": 11.19, "min": 13.10, "cnt": 32}, "MoE_L2_fwd":{"total": 381.22, "avg": 11.91, "max": 11.32, "min": 12.68, "cnt": 32}, "MoE_L3_fwd":{"total": 363.99, "avg": 11.37, "max": 10.37, "min": 14.65, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.73, "avg": 0.87, "max": 0.85, "min": 0.88, "cnt": 2}, "forward-send-backward-recv":{"total": 402.97, "avg": 13.43, "max": 1.27, "min": 96.61, "cnt": 30}, "backward-compute":{"total": 1769.89, "avg": 55.31, "max": 52.91, "min": 56.52, "cnt": 32}, "MoE_L3_bwd":{"total": 386.62, "avg": 12.08, "max": 10.99, "min": 13.44, "cnt": 32}, "MoE_L2_bwd":{"total": 375.97, "avg": 11.75, "max": 10.89, "min": 13.31, "cnt": 32}, "MoE_L1_bwd":{"total": 337.94, "avg": 10.56, "max": 10.05, "min": 11.49, "cnt": 32}, "MoE_L0_bwd":{"total": 451.35, "avg": 14.10, "max": 13.58, "min": 14.61, "cnt": 32}, "backward-send-forward-recv":{"total": 1218.61, "avg": 42.02, "max": 1.03, "min": 549.18, "cnt": 29}, "backward-send":{"total": 2.64, "avg": 0.88, "max": 0.56, "min": 1.08, "cnt": 3}, "backward-recv":{"total": 197.39, "avg": 98.69, "max": 69.80, "min": 127.58, "cnt": 2}, "backward-params-all-reduce":{"total": 486.16, "avg": 486.16, "max": 486.16, "min": 486.16, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 242.01, "avg": 242.01, "max": 242.01, "min": 242.01, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 202.21, "avg": 202.21, "max": 202.21, "min": 202.21, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.32, "avg": 3.32, "max": 3.32, "min": 3.32, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.41, "avg": 3.41, "max": 3.41, "min": 3.41, "cnt": 1}}}
{"type":"time", "iteration": 165, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 77.74, "avg": 25.91, "max": 0.79, "min": 75.66, "cnt": 3}, "forward-compute":{"total": 1843.94, "avg": 57.62, "max": 52.21, "min": 63.51, "cnt": 32}, "fwd-compute":{"total": 1840.76, "avg": 57.52, "max": 52.14, "min": 63.42, "cnt": 32}, "batch-generator":{"total": 47.75, "avg": 1.49, "max": 0.73, "min": 3.42, "cnt": 32}, "fwd-embedding":{"total": 0.57, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1780.03, "avg": 55.63, "max": 51.09, "min": 61.04, "cnt": 32}, "fwd-layernorm":{"total": 9.17, "avg": 0.07, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 105.70, "avg": 0.83, "max": 0.74, "min": 1.91, "cnt": 128}, "fwd-misc":{"total": 20.15, "avg": 0.16, "max": 0.11, "min": 0.58, "cnt": 128}, "fwd-MLP":{"total": 1625.07, "avg": 12.70, "max": 10.33, "min": 20.68, "cnt": 128}, "MoE_L0_fwd":{"total": 507.65, "avg": 15.86, "max": 13.19, "min": 20.51, "cnt": 32}, "MoEMLP":{"total": 1608.64, "avg": 12.57, "max": 10.23, "min": 20.46, "cnt": 128}, "MoE_L1_fwd":{"total": 381.01, "avg": 11.91, "max": 10.98, "min": 13.85, "cnt": 32}, "MoE_L2_fwd":{"total": 375.87, "avg": 11.75, "max": 11.32, "min": 12.78, "cnt": 32}, "MoE_L3_fwd":{"total": 350.10, "avg": 10.94, "max": 10.27, "min": 12.18, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.61, "avg": 0.02, "max": 0.02, "min": 0.06, "cnt": 32}, "forward-send":{"total": 12.19, "avg": 6.09, "max": 0.95, "min": 11.24, "cnt": 2}, "forward-send-backward-recv":{"total": 186.71, "avg": 6.22, "max": 1.40, "min": 117.11, "cnt": 30}, "backward-compute":{"total": 1766.81, "avg": 55.21, "max": 52.98, "min": 58.80, "cnt": 32}, "MoE_L3_bwd":{"total": 391.39, "avg": 12.23, "max": 11.32, "min": 15.50, "cnt": 32}, "MoE_L2_bwd":{"total": 375.35, "avg": 11.73, "max": 10.67, "min": 12.36, "cnt": 32}, "MoE_L1_bwd":{"total": 340.22, "avg": 10.63, "max": 10.20, "min": 11.10, "cnt": 32}, "MoE_L0_bwd":{"total": 445.16, "avg": 13.91, "max": 13.29, "min": 14.28, "cnt": 32}, "backward-send-forward-recv":{"total": 3343.60, "avg": 115.30, "max": 1.37, "min": 654.77, "cnt": 29}, "backward-send":{"total": 2.95, "avg": 0.98, "max": 0.91, "min": 1.08, "cnt": 3}, "backward-recv":{"total": 147.58, "avg": 73.79, "max": 70.78, "min": 76.80, "cnt": 2}, "backward-params-all-reduce":{"total": 490.06, "avg": 490.06, "max": 490.06, "min": 490.06, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 247.79, "avg": 247.79, "max": 247.79, "min": 247.79, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 203.67, "avg": 203.67, "max": 203.67, "min": 203.67, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.74, "avg": 6.74, "max": 6.74, "min": 6.74, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 166, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 72.98, "avg": 24.33, "max": 1.01, "min": 70.71, "cnt": 3}, "forward-compute":{"total": 1839.66, "avg": 57.49, "max": 52.94, "min": 61.80, "cnt": 32}, "fwd-compute":{"total": 1836.59, "avg": 57.39, "max": 52.88, "min": 61.66, "cnt": 32}, "batch-generator":{"total": 47.31, "avg": 1.48, "max": 0.67, "min": 2.97, "cnt": 32}, "fwd-embedding":{"total": 0.66, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1777.16, "avg": 55.54, "max": 51.59, "min": 59.53, "cnt": 32}, "fwd-layernorm":{"total": 9.72, "avg": 0.08, "max": 0.05, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 107.93, "avg": 0.84, "max": 0.74, "min": 1.50, "cnt": 128}, "fwd-misc":{"total": 20.18, "avg": 0.16, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1618.48, "avg": 12.64, "max": 10.31, "min": 19.76, "cnt": 128}, "MoE_L0_fwd":{"total": 508.26, "avg": 15.88, "max": 13.11, "min": 19.69, "cnt": 32}, "MoEMLP":{"total": 1602.06, "avg": 12.52, "max": 10.20, "min": 19.64, "cnt": 128}, "MoE_L1_fwd":{"total": 376.98, "avg": 11.78, "max": 10.92, "min": 12.62, "cnt": 32}, "MoE_L2_fwd":{"total": 367.25, "avg": 11.48, "max": 11.06, "min": 12.42, "cnt": 32}, "MoE_L3_fwd":{"total": 355.58, "avg": 11.11, "max": 10.24, "min": 14.89, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.65, "avg": 0.83, "max": 0.75, "min": 0.90, "cnt": 2}, "forward-send-backward-recv":{"total": 444.86, "avg": 14.83, "max": 1.09, "min": 205.16, "cnt": 30}, "backward-compute":{"total": 1776.12, "avg": 55.50, "max": 53.29, "min": 58.04, "cnt": 32}, "MoE_L3_bwd":{"total": 390.06, "avg": 12.19, "max": 11.00, "min": 15.10, "cnt": 32}, "MoE_L2_bwd":{"total": 382.24, "avg": 11.95, "max": 11.02, "min": 12.91, "cnt": 32}, "MoE_L1_bwd":{"total": 345.88, "avg": 10.81, "max": 10.15, "min": 11.91, "cnt": 32}, "MoE_L0_bwd":{"total": 445.26, "avg": 13.91, "max": 13.48, "min": 14.19, "cnt": 32}, "backward-send-forward-recv":{"total": 3456.18, "avg": 119.18, "max": 1.21, "min": 818.01, "cnt": 29}, "backward-send":{"total": 1.95, "avg": 0.65, "max": 0.50, "min": 0.93, "cnt": 3}, "backward-recv":{"total": 275.50, "avg": 137.75, "max": 66.78, "min": 208.72, "cnt": 2}, "backward-params-all-reduce":{"total": 483.90, "avg": 483.90, "max": 483.90, "min": 483.90, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 241.85, "avg": 241.85, "max": 241.85, "min": 241.85, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 202.11, "avg": 202.11, "max": 202.11, "min": 202.11, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.31, "avg": 3.31, "max": 3.31, "min": 3.31, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}}}
{"type":"time", "iteration": 167, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 82.67, "avg": 27.56, "max": 0.92, "min": 78.73, "cnt": 3}, "forward-compute":{"total": 1875.15, "avg": 58.60, "max": 51.45, "min": 69.02, "cnt": 32}, "fwd-compute":{"total": 1871.63, "avg": 58.49, "max": 51.39, "min": 68.90, "cnt": 32}, "batch-generator":{"total": 44.99, "avg": 1.41, "max": 0.69, "min": 2.79, "cnt": 32}, "fwd-embedding":{"total": 0.66, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1813.91, "avg": 56.68, "max": 50.41, "min": 66.89, "cnt": 32}, "fwd-layernorm":{"total": 9.90, "avg": 0.08, "max": 0.05, "min": 0.23, "cnt": 128}, "fwd-attn":{"total": 110.68, "avg": 0.86, "max": 0.74, "min": 1.93, "cnt": 128}, "fwd-misc":{"total": 21.13, "avg": 0.17, "max": 0.11, "min": 0.38, "cnt": 128}, "fwd-MLP":{"total": 1651.00, "avg": 12.90, "max": 10.25, "min": 22.33, "cnt": 128}, "MoE_L0_fwd":{"total": 517.34, "avg": 16.17, "max": 12.79, "min": 22.26, "cnt": 32}, "MoEMLP":{"total": 1633.77, "avg": 12.76, "max": 10.15, "min": 22.21, "cnt": 128}, "MoE_L1_fwd":{"total": 387.93, "avg": 12.12, "max": 11.05, "min": 15.49, "cnt": 32}, "MoE_L2_fwd":{"total": 376.85, "avg": 11.78, "max": 10.93, "min": 14.67, "cnt": 32}, "MoE_L3_fwd":{"total": 357.85, "avg": 11.18, "max": 10.19, "min": 15.77, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 2.63, "avg": 1.32, "max": 0.84, "min": 1.79, "cnt": 2}, "forward-send-backward-recv":{"total": 306.58, "avg": 10.22, "max": 1.66, "min": 123.13, "cnt": 30}, "backward-compute":{"total": 1777.75, "avg": 55.55, "max": 53.91, "min": 59.23, "cnt": 32}, "MoE_L3_bwd":{"total": 393.00, "avg": 12.28, "max": 11.59, "min": 15.18, "cnt": 32}, "MoE_L2_bwd":{"total": 378.46, "avg": 11.83, "max": 10.68, "min": 14.36, "cnt": 32}, "MoE_L1_bwd":{"total": 342.50, "avg": 10.70, "max": 10.08, "min": 11.58, "cnt": 32}, "MoE_L0_bwd":{"total": 447.09, "avg": 13.97, "max": 13.31, "min": 14.26, "cnt": 32}, "backward-send-forward-recv":{"total": 2013.46, "avg": 69.43, "max": 1.43, "min": 508.75, "cnt": 29}, "backward-send":{"total": 2.82, "avg": 0.94, "max": 0.80, "min": 1.08, "cnt": 3}, "backward-recv":{"total": 120.95, "avg": 60.48, "max": 55.38, "min": 65.57, "cnt": 2}, "backward-params-all-reduce":{"total": 487.93, "avg": 487.93, "max": 487.93, "min": 487.93, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 238.91, "avg": 238.91, "max": 238.91, "min": 238.91, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 199.10, "avg": 199.10, "max": 199.10, "min": 199.10, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.26, "avg": 3.26, "max": 3.26, "min": 3.26, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 168, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 82.25, "avg": 27.42, "max": 0.94, "min": 76.01, "cnt": 3}, "forward-compute":{"total": 1898.01, "avg": 59.31, "max": 52.32, "min": 112.32, "cnt": 32}, "fwd-compute":{"total": 1894.88, "avg": 59.22, "max": 52.25, "min": 112.23, "cnt": 32}, "batch-generator":{"total": 37.79, "avg": 1.18, "max": 0.71, "min": 1.73, "cnt": 32}, "fwd-embedding":{"total": 0.63, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1844.96, "avg": 57.65, "max": 51.22, "min": 110.86, "cnt": 32}, "fwd-layernorm":{"total": 9.40, "avg": 0.07, "max": 0.05, "min": 0.18, "cnt": 128}, "fwd-attn":{"total": 107.89, "avg": 0.84, "max": 0.74, "min": 1.46, "cnt": 128}, "fwd-misc":{"total": 20.62, "avg": 0.16, "max": 0.11, "min": 0.53, "cnt": 128}, "fwd-MLP":{"total": 1686.32, "avg": 13.17, "max": 10.15, "min": 72.40, "cnt": 128}, "MoE_L0_fwd":{"total": 567.95, "avg": 17.75, "max": 13.43, "min": 72.10, "cnt": 32}, "MoEMLP":{"total": 1669.45, "avg": 13.04, "max": 10.03, "min": 72.06, "cnt": 128}, "MoE_L1_fwd":{"total": 388.32, "avg": 12.14, "max": 11.28, "min": 14.02, "cnt": 32}, "MoE_L2_fwd":{"total": 372.17, "avg": 11.63, "max": 11.06, "min": 12.44, "cnt": 32}, "MoE_L3_fwd":{"total": 347.10, "avg": 10.85, "max": 10.08, "min": 13.29, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.91, "avg": 0.96, "max": 0.90, "min": 1.02, "cnt": 2}, "forward-send-backward-recv":{"total": 815.62, "avg": 27.19, "max": 1.32, "min": 261.45, "cnt": 30}, "backward-compute":{"total": 1827.56, "avg": 57.11, "max": 53.27, "min": 125.97, "cnt": 32}, "MoE_L3_bwd":{"total": 379.00, "avg": 11.84, "max": 10.60, "min": 14.06, "cnt": 32}, "MoE_L2_bwd":{"total": 433.07, "avg": 13.53, "max": 10.49, "min": 78.11, "cnt": 32}, "MoE_L1_bwd":{"total": 348.02, "avg": 10.88, "max": 9.99, "min": 14.89, "cnt": 32}, "MoE_L0_bwd":{"total": 449.57, "avg": 14.05, "max": 13.43, "min": 15.96, "cnt": 32}, "backward-send-forward-recv":{"total": 1359.95, "avg": 46.89, "max": 1.82, "min": 191.24, "cnt": 29}, "backward-send":{"total": 2.35, "avg": 0.78, "max": 0.58, "min": 1.02, "cnt": 3}, "backward-recv":{"total": 139.59, "avg": 69.80, "max": 66.80, "min": 72.79, "cnt": 2}, "backward-params-all-reduce":{"total": 484.84, "avg": 484.84, "max": 484.84, "min": 484.84, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 245.85, "avg": 245.85, "max": 245.85, "min": 245.85, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 205.48, "avg": 205.48, "max": 205.48, "min": 205.48, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.80, "avg": 3.80, "max": 3.80, "min": 3.80, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}}}
{"type":"time", "iteration": 169, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 76.13, "avg": 25.38, "max": 0.75, "min": 72.42, "cnt": 3}, "forward-compute":{"total": 1939.53, "avg": 60.61, "max": 52.68, "min": 120.23, "cnt": 32}, "fwd-compute":{"total": 1936.22, "avg": 60.51, "max": 52.60, "min": 120.15, "cnt": 32}, "batch-generator":{"total": 119.03, "avg": 3.72, "max": 0.68, "min": 64.59, "cnt": 32}, "fwd-embedding":{"total": 0.77, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1804.18, "avg": 56.38, "max": 51.31, "min": 61.78, "cnt": 32}, "fwd-layernorm":{"total": 10.45, "avg": 0.08, "max": 0.05, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 112.85, "avg": 0.88, "max": 0.74, "min": 2.06, "cnt": 128}, "fwd-misc":{"total": 21.45, "avg": 0.17, "max": 0.11, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1637.57, "avg": 12.79, "max": 10.16, "min": 19.56, "cnt": 128}, "MoE_L0_fwd":{"total": 521.52, "avg": 16.30, "max": 13.60, "min": 19.37, "cnt": 32}, "MoEMLP":{"total": 1619.90, "avg": 12.66, "max": 10.06, "min": 19.32, "cnt": 128}, "MoE_L1_fwd":{"total": 391.43, "avg": 12.23, "max": 11.21, "min": 14.64, "cnt": 32}, "MoE_L2_fwd":{"total": 371.47, "avg": 11.61, "max": 11.04, "min": 14.25, "cnt": 32}, "MoE_L3_fwd":{"total": 341.93, "avg": 10.69, "max": 10.10, "min": 11.48, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.59, "avg": 0.79, "max": 0.70, "min": 0.88, "cnt": 2}, "forward-send-backward-recv":{"total": 209.91, "avg": 7.00, "max": 1.07, "min": 115.18, "cnt": 30}, "backward-compute":{"total": 1771.23, "avg": 55.35, "max": 53.75, "min": 58.23, "cnt": 32}, "MoE_L3_bwd":{"total": 386.37, "avg": 12.07, "max": 11.39, "min": 14.05, "cnt": 32}, "MoE_L2_bwd":{"total": 372.85, "avg": 11.65, "max": 10.93, "min": 12.86, "cnt": 32}, "MoE_L1_bwd":{"total": 348.88, "avg": 10.90, "max": 10.33, "min": 12.05, "cnt": 32}, "MoE_L0_bwd":{"total": 448.73, "avg": 14.02, "max": 13.70, "min": 16.10, "cnt": 32}, "backward-send-forward-recv":{"total": 4384.05, "avg": 151.17, "max": 1.38, "min": 676.30, "cnt": 29}, "backward-send":{"total": 2.05, "avg": 0.68, "max": 0.57, "min": 0.87, "cnt": 3}, "backward-recv":{"total": 129.56, "avg": 64.78, "max": 60.10, "min": 69.46, "cnt": 2}, "backward-params-all-reduce":{"total": 490.65, "avg": 490.65, "max": 490.65, "min": 490.65, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 239.94, "avg": 239.94, "max": 239.94, "min": 239.94, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 200.09, "avg": 200.09, "max": 200.09, "min": 200.09, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.30, "avg": 3.30, "max": 3.30, "min": 3.30, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}}}
{"type":"time", "iteration": 170, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 94.80, "avg": 31.60, "max": 4.27, "min": 82.24, "cnt": 3}, "forward-compute":{"total": 1847.98, "avg": 57.75, "max": 52.54, "min": 65.15, "cnt": 32}, "fwd-compute":{"total": 1844.89, "avg": 57.65, "max": 52.48, "min": 65.07, "cnt": 32}, "batch-generator":{"total": 38.20, "avg": 1.19, "max": 0.68, "min": 1.96, "cnt": 32}, "fwd-embedding":{"total": 0.64, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1793.74, "avg": 56.05, "max": 51.44, "min": 63.54, "cnt": 32}, "fwd-layernorm":{"total": 9.64, "avg": 0.08, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 112.33, "avg": 0.88, "max": 0.74, "min": 2.83, "cnt": 128}, "fwd-misc":{"total": 21.43, "avg": 0.17, "max": 0.11, "min": 0.41, "cnt": 128}, "fwd-MLP":{"total": 1629.15, "avg": 12.73, "max": 10.02, "min": 20.41, "cnt": 128}, "MoE_L0_fwd":{"total": 508.96, "avg": 15.91, "max": 13.51, "min": 20.33, "cnt": 32}, "MoEMLP":{"total": 1611.92, "avg": 12.59, "max": 9.91, "min": 20.28, "cnt": 128}, "MoE_L1_fwd":{"total": 389.62, "avg": 12.18, "max": 11.23, "min": 16.96, "cnt": 32}, "MoE_L2_fwd":{"total": 375.56, "avg": 11.74, "max": 11.18, "min": 16.99, "cnt": 32}, "MoE_L3_fwd":{"total": 344.00, "avg": 10.75, "max": 9.95, "min": 11.86, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.74, "avg": 0.87, "max": 0.84, "min": 0.90, "cnt": 2}, "forward-send-backward-recv":{"total": 569.88, "avg": 19.00, "max": 1.85, "min": 122.46, "cnt": 30}, "backward-compute":{"total": 1760.96, "avg": 55.03, "max": 53.89, "min": 55.94, "cnt": 32}, "MoE_L3_bwd":{"total": 378.76, "avg": 11.84, "max": 10.71, "min": 12.46, "cnt": 32}, "MoE_L2_bwd":{"total": 369.96, "avg": 11.56, "max": 10.85, "min": 12.14, "cnt": 32}, "MoE_L1_bwd":{"total": 348.32, "avg": 10.88, "max": 10.33, "min": 11.57, "cnt": 32}, "MoE_L0_bwd":{"total": 446.68, "avg": 13.96, "max": 13.59, "min": 14.48, "cnt": 32}, "backward-send-forward-recv":{"total": 2095.17, "avg": 72.25, "max": 1.41, "min": 643.37, "cnt": 29}, "backward-send":{"total": 2.93, "avg": 0.98, "max": 0.71, "min": 1.16, "cnt": 3}, "backward-recv":{"total": 203.98, "avg": 101.99, "max": 69.72, "min": 134.25, "cnt": 2}, "backward-params-all-reduce":{"total": 484.83, "avg": 484.83, "max": 484.83, "min": 484.83, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 238.20, "avg": 238.20, "max": 238.20, "min": 238.20, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 198.39, "avg": 198.39, "max": 198.39, "min": 198.39, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.29, "avg": 3.29, "max": 3.29, "min": 3.29, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 171, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.12, "avg": 0.12, "max": 0.12, "min": 0.12, "cnt": 1}, "forward-recv":{"total": 84.51, "avg": 28.17, "max": 0.93, "min": 82.12, "cnt": 3}, "forward-compute":{"total": 1900.15, "avg": 59.38, "max": 53.33, "min": 81.23, "cnt": 32}, "fwd-compute":{"total": 1896.88, "avg": 59.28, "max": 53.25, "min": 81.13, "cnt": 32}, "batch-generator":{"total": 42.02, "avg": 1.31, "max": 0.65, "min": 2.72, "cnt": 32}, "fwd-embedding":{"total": 0.63, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1842.06, "avg": 57.56, "max": 52.19, "min": 79.46, "cnt": 32}, "fwd-layernorm":{"total": 9.85, "avg": 0.08, "max": 0.05, "min": 0.18, "cnt": 128}, "fwd-attn":{"total": 111.21, "avg": 0.87, "max": 0.74, "min": 1.70, "cnt": 128}, "fwd-misc":{"total": 21.38, "avg": 0.17, "max": 0.11, "min": 0.57, "cnt": 128}, "fwd-MLP":{"total": 1678.26, "avg": 13.11, "max": 10.39, "min": 37.64, "cnt": 128}, "MoE_L0_fwd":{"total": 540.38, "avg": 16.89, "max": 13.04, "min": 37.55, "cnt": 32}, "MoEMLP":{"total": 1661.36, "avg": 12.98, "max": 10.28, "min": 37.50, "cnt": 128}, "MoE_L1_fwd":{"total": 392.38, "avg": 12.26, "max": 11.37, "min": 14.52, "cnt": 32}, "MoE_L2_fwd":{"total": 383.11, "avg": 11.97, "max": 11.14, "min": 16.51, "cnt": 32}, "MoE_L3_fwd":{"total": 351.68, "avg": 10.99, "max": 10.32, "min": 13.96, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.63, "avg": 0.82, "max": 0.71, "min": 0.92, "cnt": 2}, "forward-send-backward-recv":{"total": 228.68, "avg": 7.62, "max": 1.69, "min": 119.60, "cnt": 30}, "backward-compute":{"total": 1751.41, "avg": 54.73, "max": 53.69, "min": 56.16, "cnt": 32}, "MoE_L3_bwd":{"total": 378.57, "avg": 11.83, "max": 11.10, "min": 14.67, "cnt": 32}, "MoE_L2_bwd":{"total": 364.24, "avg": 11.38, "max": 10.25, "min": 12.13, "cnt": 32}, "MoE_L1_bwd":{"total": 346.95, "avg": 10.84, "max": 10.41, "min": 12.09, "cnt": 32}, "MoE_L0_bwd":{"total": 447.33, "avg": 13.98, "max": 13.49, "min": 14.78, "cnt": 32}, "backward-send-forward-recv":{"total": 3152.68, "avg": 108.71, "max": 2.35, "min": 521.87, "cnt": 29}, "backward-send":{"total": 2.64, "avg": 0.88, "max": 0.73, "min": 0.96, "cnt": 3}, "backward-recv":{"total": 118.15, "avg": 59.08, "max": 52.68, "min": 65.47, "cnt": 2}, "backward-params-all-reduce":{"total": 489.61, "avg": 489.61, "max": 489.61, "min": 489.61, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 239.93, "avg": 239.93, "max": 239.93, "min": 239.93, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.36, "avg": 3.36, "max": 3.36, "min": 3.36, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 200.09, "avg": 200.09, "max": 200.09, "min": 200.09, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.18, "avg": 3.18, "max": 3.18, "min": 3.18, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 172, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 78.39, "avg": 26.13, "max": 0.97, "min": 76.31, "cnt": 3}, "forward-compute":{"total": 1920.91, "avg": 60.03, "max": 54.51, "min": 64.42, "cnt": 32}, "fwd-compute":{"total": 1917.04, "avg": 59.91, "max": 54.43, "min": 64.28, "cnt": 32}, "batch-generator":{"total": 47.00, "avg": 1.47, "max": 0.71, "min": 2.11, "cnt": 32}, "fwd-embedding":{"total": 0.84, "avg": 0.03, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1856.23, "avg": 58.01, "max": 53.38, "min": 62.22, "cnt": 32}, "fwd-layernorm":{"total": 11.11, "avg": 0.09, "max": 0.05, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 117.43, "avg": 0.92, "max": 0.74, "min": 1.63, "cnt": 128}, "fwd-misc":{"total": 23.14, "avg": 0.18, "max": 0.11, "min": 0.38, "cnt": 128}, "fwd-MLP":{"total": 1681.61, "avg": 13.14, "max": 10.48, "min": 21.35, "cnt": 128}, "MoE_L0_fwd":{"total": 530.66, "avg": 16.58, "max": 13.35, "min": 21.27, "cnt": 32}, "MoEMLP":{"total": 1663.32, "avg": 12.99, "max": 10.38, "min": 21.22, "cnt": 128}, "MoE_L1_fwd":{"total": 401.40, "avg": 12.54, "max": 11.61, "min": 14.37, "cnt": 32}, "MoE_L2_fwd":{"total": 385.47, "avg": 12.05, "max": 11.13, "min": 12.99, "cnt": 32}, "MoE_L3_fwd":{"total": 352.45, "avg": 11.01, "max": 10.42, "min": 12.14, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.04, "cnt": 32}, "forward-send":{"total": 1.94, "avg": 0.97, "max": 0.88, "min": 1.06, "cnt": 2}, "forward-send-backward-recv":{"total": 888.65, "avg": 29.62, "max": 0.95, "min": 161.05, "cnt": 30}, "backward-compute":{"total": 1763.48, "avg": 55.11, "max": 52.82, "min": 57.14, "cnt": 32}, "MoE_L3_bwd":{"total": 386.15, "avg": 12.07, "max": 11.46, "min": 13.53, "cnt": 32}, "MoE_L2_bwd":{"total": 360.18, "avg": 11.26, "max": 10.49, "min": 12.61, "cnt": 32}, "MoE_L1_bwd":{"total": 352.18, "avg": 11.01, "max": 10.46, "min": 12.12, "cnt": 32}, "MoE_L0_bwd":{"total": 448.65, "avg": 14.02, "max": 13.43, "min": 15.18, "cnt": 32}, "backward-send-forward-recv":{"total": 300.63, "avg": 10.37, "max": 1.01, "min": 83.17, "cnt": 29}, "backward-send":{"total": 1.75, "avg": 0.58, "max": 0.43, "min": 0.86, "cnt": 3}, "backward-recv":{"total": 156.60, "avg": 78.30, "max": 71.02, "min": 85.58, "cnt": 2}, "backward-params-all-reduce":{"total": 485.21, "avg": 485.21, "max": 485.21, "min": 485.21, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 241.73, "avg": 241.73, "max": 241.73, "min": 241.73, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 201.86, "avg": 201.86, "max": 201.86, "min": 201.86, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.41, "avg": 3.41, "max": 3.41, "min": 3.41, "cnt": 1}}}
{"type":"time", "iteration": 173, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 72.26, "avg": 24.09, "max": 1.27, "min": 69.60, "cnt": 3}, "forward-compute":{"total": 1876.89, "avg": 58.65, "max": 54.58, "min": 66.74, "cnt": 32}, "fwd-compute":{"total": 1873.60, "avg": 58.55, "max": 54.50, "min": 66.60, "cnt": 32}, "batch-generator":{"total": 38.36, "avg": 1.20, "max": 0.70, "min": 2.03, "cnt": 32}, "fwd-embedding":{"total": 0.67, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1822.30, "avg": 56.95, "max": 53.41, "min": 64.88, "cnt": 32}, "fwd-layernorm":{"total": 9.70, "avg": 0.08, "max": 0.05, "min": 0.22, "cnt": 128}, "fwd-attn":{"total": 111.21, "avg": 0.87, "max": 0.74, "min": 2.13, "cnt": 128}, "fwd-misc":{"total": 21.01, "avg": 0.16, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1658.81, "avg": 12.96, "max": 10.47, "min": 20.31, "cnt": 128}, "MoE_L0_fwd":{"total": 510.97, "avg": 15.97, "max": 13.18, "min": 20.18, "cnt": 32}, "MoEMLP":{"total": 1641.89, "avg": 12.83, "max": 10.36, "min": 20.07, "cnt": 128}, "MoE_L1_fwd":{"total": 406.76, "avg": 12.71, "max": 11.95, "min": 14.39, "cnt": 32}, "MoE_L2_fwd":{"total": 381.23, "avg": 11.91, "max": 11.33, "min": 13.42, "cnt": 32}, "MoE_L3_fwd":{"total": 349.06, "avg": 10.91, "max": 10.40, "min": 12.25, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.61, "avg": 0.02, "max": 0.02, "min": 0.04, "cnt": 32}, "forward-send":{"total": 1.87, "avg": 0.93, "max": 0.88, "min": 0.99, "cnt": 2}, "forward-send-backward-recv":{"total": 261.76, "avg": 8.73, "max": 1.05, "min": 118.60, "cnt": 30}, "backward-compute":{"total": 1767.19, "avg": 55.22, "max": 53.87, "min": 57.89, "cnt": 32}, "MoE_L3_bwd":{"total": 391.74, "avg": 12.24, "max": 10.89, "min": 15.09, "cnt": 32}, "MoE_L2_bwd":{"total": 360.13, "avg": 11.25, "max": 10.54, "min": 11.91, "cnt": 32}, "MoE_L1_bwd":{"total": 353.21, "avg": 11.04, "max": 10.52, "min": 11.51, "cnt": 32}, "MoE_L0_bwd":{"total": 448.40, "avg": 14.01, "max": 13.70, "min": 14.78, "cnt": 32}, "backward-send-forward-recv":{"total": 1658.79, "avg": 57.20, "max": 1.52, "min": 465.23, "cnt": 29}, "backward-send":{"total": 3.21, "avg": 1.07, "max": 1.02, "min": 1.11, "cnt": 3}, "backward-recv":{"total": 151.27, "avg": 75.64, "max": 70.85, "min": 80.42, "cnt": 2}, "backward-params-all-reduce":{"total": 489.42, "avg": 489.42, "max": 489.42, "min": 489.42, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 248.70, "avg": 248.70, "max": 248.70, "min": 248.70, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 208.77, "avg": 208.77, "max": 208.77, "min": 208.77, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.31, "avg": 3.31, "max": 3.31, "min": 3.31, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.47, "avg": 3.47, "max": 3.47, "min": 3.47, "cnt": 1}}}
{"type":"time", "iteration": 174, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 77.29, "avg": 25.76, "max": 0.94, "min": 75.15, "cnt": 3}, "forward-compute":{"total": 1918.27, "avg": 59.95, "max": 53.54, "min": 65.75, "cnt": 32}, "fwd-compute":{"total": 1914.91, "avg": 59.84, "max": 53.45, "min": 65.66, "cnt": 32}, "batch-generator":{"total": 43.27, "avg": 1.35, "max": 0.74, "min": 2.16, "cnt": 32}, "fwd-embedding":{"total": 0.74, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1858.03, "avg": 58.06, "max": 52.11, "min": 64.26, "cnt": 32}, "fwd-layernorm":{"total": 10.26, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 114.61, "avg": 0.90, "max": 0.74, "min": 1.65, "cnt": 128}, "fwd-misc":{"total": 22.24, "avg": 0.17, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1688.17, "avg": 13.19, "max": 10.41, "min": 21.26, "cnt": 128}, "MoE_L0_fwd":{"total": 535.94, "avg": 16.75, "max": 13.21, "min": 20.93, "cnt": 32}, "MoEMLP":{"total": 1670.04, "avg": 13.05, "max": 10.30, "min": 20.85, "cnt": 128}, "MoE_L1_fwd":{"total": 409.54, "avg": 12.80, "max": 11.55, "min": 14.02, "cnt": 32}, "MoE_L2_fwd":{"total": 377.58, "avg": 11.80, "max": 10.96, "min": 13.01, "cnt": 32}, "MoE_L3_fwd":{"total": 353.52, "avg": 11.05, "max": 10.34, "min": 14.35, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 2.66, "avg": 1.33, "max": 1.00, "min": 1.66, "cnt": 2}, "forward-send-backward-recv":{"total": 212.64, "avg": 7.09, "max": 1.43, "min": 114.79, "cnt": 30}, "backward-compute":{"total": 1774.46, "avg": 55.45, "max": 52.74, "min": 58.28, "cnt": 32}, "MoE_L3_bwd":{"total": 378.38, "avg": 11.82, "max": 11.07, "min": 14.06, "cnt": 32}, "MoE_L2_bwd":{"total": 370.66, "avg": 11.58, "max": 10.51, "min": 12.33, "cnt": 32}, "MoE_L1_bwd":{"total": 358.41, "avg": 11.20, "max": 10.54, "min": 11.58, "cnt": 32}, "MoE_L0_bwd":{"total": 454.17, "avg": 14.19, "max": 13.59, "min": 15.99, "cnt": 32}, "backward-send-forward-recv":{"total": 1256.23, "avg": 43.32, "max": 1.05, "min": 249.25, "cnt": 29}, "backward-send":{"total": 2.72, "avg": 0.91, "max": 0.81, "min": 0.96, "cnt": 3}, "backward-recv":{"total": 129.26, "avg": 64.63, "max": 58.03, "min": 71.23, "cnt": 2}, "backward-params-all-reduce":{"total": 497.51, "avg": 497.51, "max": 497.51, "min": 497.51, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 232.88, "avg": 232.88, "max": 232.88, "min": 232.88, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 193.01, "avg": 193.01, "max": 193.01, "min": 193.01, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.31, "avg": 3.31, "max": 3.31, "min": 3.31, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 175, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 74.08, "avg": 24.69, "max": 1.25, "min": 69.60, "cnt": 3}, "forward-compute":{"total": 1860.39, "avg": 58.14, "max": 51.66, "min": 62.37, "cnt": 32}, "fwd-compute":{"total": 1856.84, "avg": 58.03, "max": 51.59, "min": 62.24, "cnt": 32}, "batch-generator":{"total": 42.18, "avg": 1.32, "max": 0.69, "min": 1.85, "cnt": 32}, "fwd-embedding":{"total": 0.74, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1800.66, "avg": 56.27, "max": 50.52, "min": 60.23, "cnt": 32}, "fwd-layernorm":{"total": 10.23, "avg": 0.08, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 113.35, "avg": 0.89, "max": 0.74, "min": 1.54, "cnt": 128}, "fwd-misc":{"total": 22.48, "avg": 0.18, "max": 0.11, "min": 0.40, "cnt": 128}, "fwd-MLP":{"total": 1632.85, "avg": 12.76, "max": 10.29, "min": 18.87, "cnt": 128}, "MoE_L0_fwd":{"total": 518.27, "avg": 16.20, "max": 12.98, "min": 18.78, "cnt": 32}, "MoEMLP":{"total": 1615.41, "avg": 12.62, "max": 10.16, "min": 18.73, "cnt": 128}, "MoE_L1_fwd":{"total": 389.49, "avg": 12.17, "max": 11.20, "min": 13.71, "cnt": 32}, "MoE_L2_fwd":{"total": 366.09, "avg": 11.44, "max": 10.98, "min": 12.05, "cnt": 32}, "MoE_L3_fwd":{"total": 347.92, "avg": 10.87, "max": 10.21, "min": 11.57, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.61, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.78, "avg": 0.89, "max": 0.89, "min": 0.90, "cnt": 2}, "forward-send-backward-recv":{"total": 315.80, "avg": 10.53, "max": 1.55, "min": 113.09, "cnt": 30}, "backward-compute":{"total": 1793.17, "avg": 56.04, "max": 53.51, "min": 80.31, "cnt": 32}, "MoE_L3_bwd":{"total": 407.46, "avg": 12.73, "max": 11.21, "min": 40.32, "cnt": 32}, "MoE_L2_bwd":{"total": 369.78, "avg": 11.56, "max": 10.36, "min": 12.87, "cnt": 32}, "MoE_L1_bwd":{"total": 349.62, "avg": 10.93, "max": 10.24, "min": 12.86, "cnt": 32}, "MoE_L0_bwd":{"total": 448.09, "avg": 14.00, "max": 13.56, "min": 14.47, "cnt": 32}, "backward-send-forward-recv":{"total": 1309.62, "avg": 45.16, "max": 2.06, "min": 233.09, "cnt": 29}, "backward-send":{"total": 2.48, "avg": 0.83, "max": 0.72, "min": 1.02, "cnt": 3}, "backward-recv":{"total": 180.57, "avg": 90.28, "max": 63.89, "min": 116.68, "cnt": 2}, "backward-params-all-reduce":{"total": 489.24, "avg": 489.24, "max": 489.24, "min": 489.24, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 241.19, "avg": 241.19, "max": 241.19, "min": 241.19, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 197.04, "avg": 197.04, "max": 197.04, "min": 197.04, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.81, "avg": 6.81, "max": 6.81, "min": 6.81, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}}}
{"type":"time", "iteration": 176, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.12, "avg": 0.12, "max": 0.12, "min": 0.12, "cnt": 1}, "forward-recv":{"total": 73.21, "avg": 24.40, "max": 0.82, "min": 71.49, "cnt": 3}, "forward-compute":{"total": 1889.78, "avg": 59.06, "max": 53.33, "min": 65.38, "cnt": 32}, "fwd-compute":{"total": 1886.46, "avg": 58.95, "max": 53.24, "min": 65.30, "cnt": 32}, "batch-generator":{"total": 48.31, "avg": 1.51, "max": 0.62, "min": 3.28, "cnt": 32}, "fwd-embedding":{"total": 0.73, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1825.16, "avg": 57.04, "max": 51.72, "min": 63.26, "cnt": 32}, "fwd-layernorm":{"total": 10.39, "avg": 0.08, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 114.83, "avg": 0.90, "max": 0.74, "min": 3.57, "cnt": 128}, "fwd-misc":{"total": 22.37, "avg": 0.17, "max": 0.11, "min": 0.49, "cnt": 128}, "fwd-MLP":{"total": 1655.77, "avg": 12.94, "max": 10.41, "min": 20.91, "cnt": 128}, "MoE_L0_fwd":{"total": 519.25, "avg": 16.23, "max": 13.23, "min": 20.83, "cnt": 32}, "MoEMLP":{"total": 1637.55, "avg": 12.79, "max": 10.31, "min": 20.78, "cnt": 128}, "MoE_L1_fwd":{"total": 404.03, "avg": 12.63, "max": 11.18, "min": 17.35, "cnt": 32}, "MoE_L2_fwd":{"total": 372.09, "avg": 11.63, "max": 10.75, "min": 13.07, "cnt": 32}, "MoE_L3_fwd":{"total": 348.66, "avg": 10.90, "max": 10.35, "min": 11.69, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 7.09, "avg": 3.55, "max": 0.73, "min": 6.36, "cnt": 2}, "forward-send-backward-recv":{"total": 652.00, "avg": 21.73, "max": 1.81, "min": 217.69, "cnt": 30}, "backward-compute":{"total": 1762.26, "avg": 55.07, "max": 53.21, "min": 57.96, "cnt": 32}, "MoE_L3_bwd":{"total": 382.76, "avg": 11.96, "max": 10.57, "min": 14.06, "cnt": 32}, "MoE_L2_bwd":{"total": 362.12, "avg": 11.32, "max": 10.42, "min": 13.78, "cnt": 32}, "MoE_L1_bwd":{"total": 348.93, "avg": 10.90, "max": 10.53, "min": 11.37, "cnt": 32}, "MoE_L0_bwd":{"total": 454.94, "avg": 14.22, "max": 13.74, "min": 15.57, "cnt": 32}, "backward-send-forward-recv":{"total": 2515.37, "avg": 86.74, "max": 1.91, "min": 768.65, "cnt": 29}, "backward-send":{"total": 2.81, "avg": 0.94, "max": 0.85, "min": 1.07, "cnt": 3}, "backward-recv":{"total": 157.56, "avg": 78.78, "max": 77.23, "min": 80.33, "cnt": 2}, "backward-params-all-reduce":{"total": 485.19, "avg": 485.19, "max": 485.19, "min": 485.19, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 241.81, "avg": 241.81, "max": 241.81, "min": 241.81, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 201.92, "avg": 201.92, "max": 201.92, "min": 201.92, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.26, "avg": 3.26, "max": 3.26, "min": 3.26, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.47, "avg": 3.47, "max": 3.47, "min": 3.47, "cnt": 1}}}
{"type":"time", "iteration": 177, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 68.62, "avg": 22.87, "max": 0.75, "min": 66.84, "cnt": 3}, "forward-compute":{"total": 1868.53, "avg": 58.39, "max": 51.43, "min": 69.28, "cnt": 32}, "fwd-compute":{"total": 1865.17, "avg": 58.29, "max": 51.35, "min": 69.20, "cnt": 32}, "batch-generator":{"total": 48.06, "avg": 1.50, "max": 0.65, "min": 2.86, "cnt": 32}, "fwd-embedding":{"total": 0.72, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1803.95, "avg": 56.37, "max": 50.30, "min": 67.75, "cnt": 32}, "fwd-layernorm":{"total": 10.30, "avg": 0.08, "max": 0.05, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 112.78, "avg": 0.88, "max": 0.74, "min": 1.86, "cnt": 128}, "fwd-misc":{"total": 21.76, "avg": 0.17, "max": 0.11, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1637.04, "avg": 12.79, "max": 10.37, "min": 22.19, "cnt": 128}, "MoE_L0_fwd":{"total": 505.91, "avg": 15.81, "max": 12.93, "min": 22.09, "cnt": 32}, "MoEMLP":{"total": 1619.44, "avg": 12.65, "max": 10.25, "min": 22.04, "cnt": 128}, "MoE_L1_fwd":{"total": 388.78, "avg": 12.15, "max": 10.89, "min": 15.93, "cnt": 32}, "MoE_L2_fwd":{"total": 373.19, "avg": 11.66, "max": 10.82, "min": 16.49, "cnt": 32}, "MoE_L3_fwd":{"total": 357.85, "avg": 11.18, "max": 10.29, "min": 15.14, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.61, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 6.60, "avg": 3.30, "max": 0.98, "min": 5.62, "cnt": 2}, "forward-send-backward-recv":{"total": 186.80, "avg": 6.23, "max": 1.30, "min": 120.25, "cnt": 30}, "backward-compute":{"total": 1773.36, "avg": 55.42, "max": 52.18, "min": 58.50, "cnt": 32}, "MoE_L3_bwd":{"total": 386.02, "avg": 12.06, "max": 10.83, "min": 13.97, "cnt": 32}, "MoE_L2_bwd":{"total": 365.32, "avg": 11.42, "max": 10.11, "min": 12.27, "cnt": 32}, "MoE_L1_bwd":{"total": 354.91, "avg": 11.09, "max": 10.50, "min": 11.60, "cnt": 32}, "MoE_L0_bwd":{"total": 452.60, "avg": 14.14, "max": 13.39, "min": 14.86, "cnt": 32}, "backward-send-forward-recv":{"total": 2024.65, "avg": 69.82, "max": 2.31, "min": 276.98, "cnt": 29}, "backward-send":{"total": 3.18, "avg": 1.06, "max": 1.00, "min": 1.12, "cnt": 3}, "backward-recv":{"total": 142.73, "avg": 71.37, "max": 67.49, "min": 75.24, "cnt": 2}, "backward-params-all-reduce":{"total": 482.48, "avg": 482.48, "max": 482.48, "min": 482.48, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 247.50, "avg": 247.50, "max": 247.50, "min": 247.50, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 207.46, "avg": 207.46, "max": 207.46, "min": 207.46, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 178, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 73.85, "avg": 24.62, "max": 1.04, "min": 71.44, "cnt": 3}, "forward-compute":{"total": 1846.46, "avg": 57.70, "max": 51.31, "min": 68.23, "cnt": 32}, "fwd-compute":{"total": 1843.47, "avg": 57.61, "max": 51.24, "min": 68.15, "cnt": 32}, "batch-generator":{"total": 47.47, "avg": 1.48, "max": 0.64, "min": 3.51, "cnt": 32}, "fwd-embedding":{"total": 0.58, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1784.13, "avg": 55.75, "max": 50.31, "min": 65.82, "cnt": 32}, "fwd-layernorm":{"total": 9.13, "avg": 0.07, "max": 0.06, "min": 0.18, "cnt": 128}, "fwd-attn":{"total": 104.77, "avg": 0.82, "max": 0.74, "min": 1.48, "cnt": 128}, "fwd-misc":{"total": 19.54, "avg": 0.15, "max": 0.11, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1630.85, "avg": 12.74, "max": 10.45, "min": 19.58, "cnt": 128}, "MoE_L0_fwd":{"total": 499.61, "avg": 15.61, "max": 12.99, "min": 19.45, "cnt": 32}, "MoEMLP":{"total": 1614.97, "avg": 12.62, "max": 10.34, "min": 19.36, "cnt": 128}, "MoE_L1_fwd":{"total": 391.52, "avg": 12.24, "max": 11.03, "min": 15.90, "cnt": 32}, "MoE_L2_fwd":{"total": 372.71, "avg": 11.65, "max": 10.79, "min": 16.82, "cnt": 32}, "MoE_L3_fwd":{"total": 356.96, "avg": 11.15, "max": 10.38, "min": 14.07, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 7.90, "avg": 3.95, "max": 1.01, "min": 6.89, "cnt": 2}, "forward-send-backward-recv":{"total": 206.62, "avg": 6.89, "max": 1.07, "min": 116.56, "cnt": 30}, "backward-compute":{"total": 1777.11, "avg": 55.53, "max": 53.68, "min": 59.24, "cnt": 32}, "MoE_L3_bwd":{"total": 388.78, "avg": 12.15, "max": 10.86, "min": 15.70, "cnt": 32}, "MoE_L2_bwd":{"total": 373.53, "avg": 11.67, "max": 10.76, "min": 14.31, "cnt": 32}, "MoE_L1_bwd":{"total": 351.86, "avg": 11.00, "max": 10.22, "min": 11.68, "cnt": 32}, "MoE_L0_bwd":{"total": 446.69, "avg": 13.96, "max": 13.38, "min": 14.49, "cnt": 32}, "backward-send-forward-recv":{"total": 2278.19, "avg": 78.56, "max": 2.34, "min": 479.08, "cnt": 29}, "backward-send":{"total": 2.33, "avg": 0.78, "max": 0.48, "min": 0.96, "cnt": 3}, "backward-recv":{"total": 127.43, "avg": 63.71, "max": 55.68, "min": 71.74, "cnt": 2}, "backward-params-all-reduce":{"total": 485.56, "avg": 485.56, "max": 485.56, "min": 485.56, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 247.88, "avg": 247.88, "max": 247.88, "min": 247.88, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.36, "avg": 3.36, "max": 3.36, "min": 3.36, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 203.84, "avg": 203.84, "max": 203.84, "min": 203.84, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.85, "avg": 6.85, "max": 6.85, "min": 6.85, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}}}
{"type":"time", "iteration": 179, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 75.48, "avg": 25.16, "max": 1.02, "min": 72.34, "cnt": 3}, "forward-compute":{"total": 1875.02, "avg": 58.59, "max": 52.41, "min": 63.36, "cnt": 32}, "fwd-compute":{"total": 1871.48, "avg": 58.48, "max": 52.33, "min": 63.23, "cnt": 32}, "batch-generator":{"total": 50.25, "avg": 1.57, "max": 0.67, "min": 3.75, "cnt": 32}, "fwd-embedding":{"total": 0.70, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1808.52, "avg": 56.52, "max": 51.21, "min": 61.20, "cnt": 32}, "fwd-layernorm":{"total": 10.19, "avg": 0.08, "max": 0.05, "min": 0.22, "cnt": 128}, "fwd-attn":{"total": 112.02, "avg": 0.88, "max": 0.74, "min": 1.94, "cnt": 128}, "fwd-misc":{"total": 21.37, "avg": 0.17, "max": 0.11, "min": 0.49, "cnt": 128}, "fwd-MLP":{"total": 1643.03, "avg": 12.84, "max": 10.58, "min": 19.67, "cnt": 128}, "MoE_L0_fwd":{"total": 506.12, "avg": 15.82, "max": 13.10, "min": 19.37, "cnt": 32}, "MoEMLP":{"total": 1625.43, "avg": 12.70, "max": 10.46, "min": 19.31, "cnt": 128}, "MoE_L1_fwd":{"total": 389.27, "avg": 12.16, "max": 10.98, "min": 12.95, "cnt": 32}, "MoE_L2_fwd":{"total": 382.74, "avg": 11.96, "max": 10.92, "min": 17.01, "cnt": 32}, "MoE_L3_fwd":{"total": 353.63, "avg": 11.05, "max": 10.50, "min": 12.56, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.70, "avg": 0.85, "max": 0.84, "min": 0.85, "cnt": 2}, "forward-send-backward-recv":{"total": 1229.20, "avg": 40.97, "max": 1.37, "min": 254.88, "cnt": 30}, "backward-compute":{"total": 1775.69, "avg": 55.49, "max": 53.04, "min": 58.51, "cnt": 32}, "MoE_L3_bwd":{"total": 381.08, "avg": 11.91, "max": 10.84, "min": 14.27, "cnt": 32}, "MoE_L2_bwd":{"total": 369.03, "avg": 11.53, "max": 10.60, "min": 12.13, "cnt": 32}, "MoE_L1_bwd":{"total": 355.76, "avg": 11.12, "max": 10.23, "min": 11.63, "cnt": 32}, "MoE_L0_bwd":{"total": 450.43, "avg": 14.08, "max": 13.54, "min": 15.25, "cnt": 32}, "backward-send-forward-recv":{"total": 1870.19, "avg": 64.49, "max": 1.32, "min": 500.20, "cnt": 29}, "backward-send":{"total": 3.10, "avg": 1.03, "max": 0.97, "min": 1.14, "cnt": 3}, "backward-recv":{"total": 528.07, "avg": 264.04, "max": 74.03, "min": 454.05, "cnt": 2}, "backward-params-all-reduce":{"total": 488.84, "avg": 488.84, "max": 488.84, "min": 488.84, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.04, "avg": 0.04, "max": 0.04, "min": 0.04, "cnt": 1}, "optimizer":{"total": 242.25, "avg": 242.25, "max": 242.25, "min": 242.25, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 198.07, "avg": 198.07, "max": 198.07, "min": 198.07, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.33, "avg": 3.33, "max": 3.33, "min": 3.33, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 180, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 71.63, "avg": 23.88, "max": 1.29, "min": 63.78, "cnt": 3}, "forward-compute":{"total": 1874.86, "avg": 58.59, "max": 52.02, "min": 65.12, "cnt": 32}, "fwd-compute":{"total": 1871.56, "avg": 58.49, "max": 51.95, "min": 65.03, "cnt": 32}, "batch-generator":{"total": 38.66, "avg": 1.21, "max": 0.67, "min": 1.67, "cnt": 32}, "fwd-embedding":{"total": 0.62, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1819.48, "avg": 56.86, "max": 50.98, "min": 63.73, "cnt": 32}, "fwd-layernorm":{"total": 9.70, "avg": 0.08, "max": 0.05, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 107.39, "avg": 0.84, "max": 0.74, "min": 1.47, "cnt": 128}, "fwd-misc":{"total": 20.90, "avg": 0.16, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1660.30, "avg": 12.97, "max": 10.75, "min": 19.25, "cnt": 128}, "MoE_L0_fwd":{"total": 510.16, "avg": 15.94, "max": 12.96, "min": 19.17, "cnt": 32}, "MoEMLP":{"total": 1643.29, "avg": 12.84, "max": 10.65, "min": 19.13, "cnt": 128}, "MoE_L1_fwd":{"total": 391.46, "avg": 12.23, "max": 10.97, "min": 16.00, "cnt": 32}, "MoE_L2_fwd":{"total": 382.17, "avg": 11.94, "max": 11.03, "min": 13.13, "cnt": 32}, "MoE_L3_fwd":{"total": 365.70, "avg": 11.43, "max": 10.69, "min": 15.72, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.66, "avg": 0.02, "max": 0.02, "min": 0.06, "cnt": 32}, "forward-send":{"total": 1.79, "avg": 0.89, "max": 0.85, "min": 0.94, "cnt": 2}, "forward-send-backward-recv":{"total": 223.77, "avg": 7.46, "max": 1.04, "min": 131.53, "cnt": 30}, "backward-compute":{"total": 1795.34, "avg": 56.10, "max": 53.71, "min": 59.81, "cnt": 32}, "MoE_L3_bwd":{"total": 395.51, "avg": 12.36, "max": 10.90, "min": 15.33, "cnt": 32}, "MoE_L2_bwd":{"total": 376.80, "avg": 11.77, "max": 10.89, "min": 12.47, "cnt": 32}, "MoE_L1_bwd":{"total": 356.99, "avg": 11.16, "max": 10.79, "min": 11.63, "cnt": 32}, "MoE_L0_bwd":{"total": 451.77, "avg": 14.12, "max": 13.38, "min": 17.25, "cnt": 32}, "backward-send-forward-recv":{"total": 1177.18, "avg": 40.59, "max": 2.05, "min": 180.79, "cnt": 29}, "backward-send":{"total": 2.10, "avg": 0.70, "max": 0.53, "min": 0.86, "cnt": 3}, "backward-recv":{"total": 141.68, "avg": 70.84, "max": 65.18, "min": 76.50, "cnt": 2}, "backward-params-all-reduce":{"total": 486.16, "avg": 486.16, "max": 486.16, "min": 486.16, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 248.87, "avg": 248.87, "max": 248.87, "min": 248.87, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.36, "avg": 3.36, "max": 3.36, "min": 3.36, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 204.74, "avg": 204.74, "max": 204.74, "min": 204.74, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.94, "avg": 6.94, "max": 6.94, "min": 6.94, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.40, "avg": 3.40, "max": 3.40, "min": 3.40, "cnt": 1}}}
{"type":"time", "iteration": 181, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 67.91, "avg": 22.64, "max": 0.75, "min": 65.97, "cnt": 3}, "forward-compute":{"total": 1913.00, "avg": 59.78, "max": 52.73, "min": 66.96, "cnt": 32}, "fwd-compute":{"total": 1909.25, "avg": 59.66, "max": 52.66, "min": 66.83, "cnt": 32}, "batch-generator":{"total": 43.05, "avg": 1.35, "max": 0.63, "min": 2.80, "cnt": 32}, "fwd-embedding":{"total": 0.72, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1852.69, "avg": 57.90, "max": 51.60, "min": 64.80, "cnt": 32}, "fwd-layernorm":{"total": 10.14, "avg": 0.08, "max": 0.05, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 110.38, "avg": 0.86, "max": 0.74, "min": 1.79, "cnt": 128}, "fwd-misc":{"total": 21.84, "avg": 0.17, "max": 0.11, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1688.05, "avg": 13.19, "max": 10.63, "min": 20.34, "cnt": 128}, "MoE_L0_fwd":{"total": 532.06, "avg": 16.63, "max": 13.51, "min": 20.26, "cnt": 32}, "MoEMLP":{"total": 1670.32, "avg": 13.05, "max": 10.52, "min": 20.22, "cnt": 128}, "MoE_L1_fwd":{"total": 398.30, "avg": 12.45, "max": 11.37, "min": 14.53, "cnt": 32}, "MoE_L2_fwd":{"total": 377.36, "avg": 11.79, "max": 10.65, "min": 15.83, "cnt": 32}, "MoE_L3_fwd":{"total": 368.89, "avg": 11.53, "max": 10.56, "min": 15.36, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 9.30, "avg": 4.65, "max": 0.91, "min": 8.39, "cnt": 2}, "forward-send-backward-recv":{"total": 585.32, "avg": 19.51, "max": 1.22, "min": 174.98, "cnt": 30}, "backward-compute":{"total": 1777.14, "avg": 55.54, "max": 52.93, "min": 58.28, "cnt": 32}, "MoE_L3_bwd":{"total": 389.53, "avg": 12.17, "max": 11.59, "min": 13.29, "cnt": 32}, "MoE_L2_bwd":{"total": 367.46, "avg": 11.48, "max": 10.40, "min": 12.80, "cnt": 32}, "MoE_L1_bwd":{"total": 359.05, "avg": 11.22, "max": 10.57, "min": 11.98, "cnt": 32}, "MoE_L0_bwd":{"total": 441.08, "avg": 13.78, "max": 13.26, "min": 14.84, "cnt": 32}, "backward-send-forward-recv":{"total": 589.07, "avg": 20.31, "max": 1.38, "min": 168.17, "cnt": 29}, "backward-send":{"total": 2.97, "avg": 0.99, "max": 0.94, "min": 1.04, "cnt": 3}, "backward-recv":{"total": 131.53, "avg": 65.77, "max": 59.92, "min": 71.61, "cnt": 2}, "backward-params-all-reduce":{"total": 485.84, "avg": 485.84, "max": 485.84, "min": 485.84, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 242.24, "avg": 242.24, "max": 242.24, "min": 242.24, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 202.49, "avg": 202.49, "max": 202.49, "min": 202.49, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.35, "avg": 3.35, "max": 3.35, "min": 3.35, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}}}
{"type":"time", "iteration": 182, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 76.14, "avg": 25.38, "max": 0.96, "min": 73.14, "cnt": 3}, "forward-compute":{"total": 1877.59, "avg": 58.67, "max": 52.06, "min": 64.87, "cnt": 32}, "fwd-compute":{"total": 1873.92, "avg": 58.56, "max": 51.98, "min": 64.72, "cnt": 32}, "batch-generator":{"total": 46.70, "avg": 1.46, "max": 0.68, "min": 2.06, "cnt": 32}, "fwd-embedding":{"total": 0.85, "avg": 0.03, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1813.76, "avg": 56.68, "max": 50.71, "min": 62.47, "cnt": 32}, "fwd-layernorm":{"total": 10.80, "avg": 0.08, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 116.63, "avg": 0.91, "max": 0.74, "min": 1.48, "cnt": 128}, "fwd-misc":{"total": 22.91, "avg": 0.18, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1640.57, "avg": 12.82, "max": 10.46, "min": 19.66, "cnt": 128}, "MoE_L0_fwd":{"total": 511.51, "avg": 15.98, "max": 12.97, "min": 19.51, "cnt": 32}, "MoEMLP":{"total": 1622.27, "avg": 12.67, "max": 10.35, "min": 19.41, "cnt": 128}, "MoE_L1_fwd":{"total": 394.39, "avg": 12.32, "max": 11.36, "min": 17.14, "cnt": 32}, "MoE_L2_fwd":{"total": 367.03, "avg": 11.47, "max": 10.81, "min": 12.86, "cnt": 32}, "MoE_L3_fwd":{"total": 356.01, "avg": 11.13, "max": 10.39, "min": 15.79, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.61, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.68, "avg": 0.84, "max": 0.77, "min": 0.92, "cnt": 2}, "forward-send-backward-recv":{"total": 371.26, "avg": 12.38, "max": 0.96, "min": 126.26, "cnt": 30}, "backward-compute":{"total": 1772.96, "avg": 55.41, "max": 54.06, "min": 59.66, "cnt": 32}, "MoE_L3_bwd":{"total": 388.65, "avg": 12.15, "max": 11.42, "min": 14.17, "cnt": 32}, "MoE_L2_bwd":{"total": 370.48, "avg": 11.58, "max": 10.55, "min": 13.33, "cnt": 32}, "MoE_L1_bwd":{"total": 359.94, "avg": 11.25, "max": 10.72, "min": 11.77, "cnt": 32}, "MoE_L0_bwd":{"total": 438.30, "avg": 13.70, "max": 13.04, "min": 15.43, "cnt": 32}, "backward-send-forward-recv":{"total": 469.52, "avg": 16.19, "max": 2.01, "min": 95.02, "cnt": 29}, "backward-send":{"total": 2.51, "avg": 0.84, "max": 0.49, "min": 1.15, "cnt": 3}, "backward-recv":{"total": 136.96, "avg": 68.48, "max": 67.47, "min": 69.49, "cnt": 2}, "backward-params-all-reduce":{"total": 492.78, "avg": 492.78, "max": 492.78, "min": 492.78, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 232.20, "avg": 232.20, "max": 232.20, "min": 232.20, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 192.45, "avg": 192.45, "max": 192.45, "min": 192.45, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.29, "avg": 3.29, "max": 3.29, "min": 3.29, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 183, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 85.01, "avg": 28.34, "max": 1.12, "min": 75.14, "cnt": 3}, "forward-compute":{"total": 1890.19, "avg": 59.07, "max": 53.21, "min": 68.00, "cnt": 32}, "fwd-compute":{"total": 1886.62, "avg": 58.96, "max": 53.13, "min": 67.92, "cnt": 32}, "batch-generator":{"total": 46.91, "avg": 1.47, "max": 0.70, "min": 2.21, "cnt": 32}, "fwd-embedding":{"total": 0.80, "avg": 0.03, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1826.14, "avg": 57.07, "max": 51.57, "min": 65.34, "cnt": 32}, "fwd-layernorm":{"total": 10.93, "avg": 0.09, "max": 0.05, "min": 0.22, "cnt": 128}, "fwd-attn":{"total": 117.28, "avg": 0.92, "max": 0.74, "min": 1.72, "cnt": 128}, "fwd-misc":{"total": 23.08, "avg": 0.18, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1652.08, "avg": 12.91, "max": 10.50, "min": 19.88, "cnt": 128}, "MoE_L0_fwd":{"total": 508.16, "avg": 15.88, "max": 13.15, "min": 19.65, "cnt": 32}, "MoEMLP":{"total": 1633.46, "avg": 12.76, "max": 10.39, "min": 19.60, "cnt": 128}, "MoE_L1_fwd":{"total": 400.39, "avg": 12.51, "max": 11.28, "min": 15.44, "cnt": 32}, "MoE_L2_fwd":{"total": 367.18, "avg": 11.47, "max": 10.95, "min": 13.10, "cnt": 32}, "MoE_L3_fwd":{"total": 364.38, "avg": 11.39, "max": 10.43, "min": 16.12, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.89, "avg": 0.95, "max": 0.91, "min": 0.98, "cnt": 2}, "forward-send-backward-recv":{"total": 460.38, "avg": 15.35, "max": 1.29, "min": 153.04, "cnt": 30}, "backward-compute":{"total": 1771.57, "avg": 55.36, "max": 54.24, "min": 56.79, "cnt": 32}, "MoE_L3_bwd":{"total": 382.31, "avg": 11.95, "max": 11.37, "min": 13.92, "cnt": 32}, "MoE_L2_bwd":{"total": 369.49, "avg": 11.55, "max": 10.65, "min": 12.36, "cnt": 32}, "MoE_L1_bwd":{"total": 365.68, "avg": 11.43, "max": 11.02, "min": 12.47, "cnt": 32}, "MoE_L0_bwd":{"total": 436.37, "avg": 13.64, "max": 13.28, "min": 13.99, "cnt": 32}, "backward-send-forward-recv":{"total": 5520.45, "avg": 190.36, "max": 1.89, "min": 1874.52, "cnt": 29}, "backward-send":{"total": 2.46, "avg": 0.82, "max": 0.78, "min": 0.84, "cnt": 3}, "backward-recv":{"total": 137.39, "avg": 68.69, "max": 67.49, "min": 69.90, "cnt": 2}, "backward-params-all-reduce":{"total": 486.29, "avg": 486.29, "max": 486.29, "min": 486.29, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 243.54, "avg": 243.54, "max": 243.54, "min": 243.54, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 203.48, "avg": 203.48, "max": 203.48, "min": 203.48, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.29, "avg": 3.29, "max": 3.29, "min": 3.29, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 184, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 84.48, "avg": 28.16, "max": 2.16, "min": 77.81, "cnt": 3}, "forward-compute":{"total": 1882.50, "avg": 58.83, "max": 51.63, "min": 70.66, "cnt": 32}, "fwd-compute":{"total": 1879.43, "avg": 58.73, "max": 51.56, "min": 70.58, "cnt": 32}, "batch-generator":{"total": 38.33, "avg": 1.20, "max": 0.64, "min": 2.76, "cnt": 32}, "fwd-embedding":{"total": 0.62, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1828.72, "avg": 57.15, "max": 50.64, "min": 69.11, "cnt": 32}, "fwd-layernorm":{"total": 9.59, "avg": 0.07, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 110.88, "avg": 0.87, "max": 0.74, "min": 1.81, "cnt": 128}, "fwd-misc":{"total": 21.83, "avg": 0.17, "max": 0.11, "min": 0.38, "cnt": 128}, "fwd-MLP":{"total": 1665.19, "avg": 13.01, "max": 10.35, "min": 22.27, "cnt": 128}, "MoE_L0_fwd":{"total": 511.05, "avg": 15.97, "max": 12.75, "min": 22.15, "cnt": 32}, "MoEMLP":{"total": 1648.07, "avg": 12.88, "max": 10.23, "min": 22.11, "cnt": 128}, "MoE_L1_fwd":{"total": 399.82, "avg": 12.49, "max": 11.41, "min": 16.00, "cnt": 32}, "MoE_L2_fwd":{"total": 379.97, "avg": 11.87, "max": 10.87, "min": 16.21, "cnt": 32}, "MoE_L3_fwd":{"total": 363.48, "avg": 11.36, "max": 10.27, "min": 15.58, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.73, "avg": 0.87, "max": 0.83, "min": 0.90, "cnt": 2}, "forward-send-backward-recv":{"total": 189.97, "avg": 6.33, "max": 1.13, "min": 124.41, "cnt": 30}, "backward-compute":{"total": 1785.57, "avg": 55.80, "max": 53.00, "min": 59.66, "cnt": 32}, "MoE_L3_bwd":{"total": 395.88, "avg": 12.37, "max": 11.41, "min": 15.04, "cnt": 32}, "MoE_L2_bwd":{"total": 372.45, "avg": 11.64, "max": 10.57, "min": 14.54, "cnt": 32}, "MoE_L1_bwd":{"total": 368.67, "avg": 11.52, "max": 10.88, "min": 12.19, "cnt": 32}, "MoE_L0_bwd":{"total": 432.85, "avg": 13.53, "max": 12.79, "min": 14.86, "cnt": 32}, "backward-send-forward-recv":{"total": 1259.43, "avg": 43.43, "max": 1.43, "min": 153.11, "cnt": 29}, "backward-send":{"total": 2.25, "avg": 0.75, "max": 0.70, "min": 0.81, "cnt": 3}, "backward-recv":{"total": 137.90, "avg": 68.95, "max": 65.96, "min": 71.94, "cnt": 2}, "backward-params-all-reduce":{"total": 486.26, "avg": 486.26, "max": 486.26, "min": 486.26, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 243.34, "avg": 243.34, "max": 243.34, "min": 243.34, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.36, "avg": 3.36, "max": 3.36, "min": 3.36, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 203.47, "avg": 203.47, "max": 203.47, "min": 203.47, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.32, "avg": 3.32, "max": 3.32, "min": 3.32, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.41, "avg": 3.41, "max": 3.41, "min": 3.41, "cnt": 1}}}
{"type":"time", "iteration": 185, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 73.26, "avg": 24.42, "max": 0.68, "min": 71.86, "cnt": 3}, "forward-compute":{"total": 1906.34, "avg": 59.57, "max": 53.01, "min": 80.17, "cnt": 32}, "fwd-compute":{"total": 1902.92, "avg": 59.47, "max": 52.95, "min": 80.09, "cnt": 32}, "batch-generator":{"total": 42.19, "avg": 1.32, "max": 0.60, "min": 2.55, "cnt": 32}, "fwd-embedding":{"total": 0.77, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1847.74, "avg": 57.74, "max": 51.60, "min": 78.65, "cnt": 32}, "fwd-layernorm":{"total": 10.19, "avg": 0.08, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 112.00, "avg": 0.87, "max": 0.74, "min": 1.46, "cnt": 128}, "fwd-misc":{"total": 21.55, "avg": 0.17, "max": 0.11, "min": 0.40, "cnt": 128}, "fwd-MLP":{"total": 1682.37, "avg": 13.14, "max": 10.59, "min": 36.84, "cnt": 128}, "MoE_L0_fwd":{"total": 535.04, "avg": 16.72, "max": 13.27, "min": 36.76, "cnt": 32}, "MoEMLP":{"total": 1664.95, "avg": 13.01, "max": 10.49, "min": 36.72, "cnt": 128}, "MoE_L1_fwd":{"total": 400.96, "avg": 12.53, "max": 11.36, "min": 14.82, "cnt": 32}, "MoE_L2_fwd":{"total": 368.40, "avg": 11.51, "max": 10.64, "min": 13.72, "cnt": 32}, "MoE_L3_fwd":{"total": 366.85, "avg": 11.46, "max": 10.53, "min": 14.74, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 6.73, "avg": 3.37, "max": 0.56, "min": 6.17, "cnt": 2}, "forward-send-backward-recv":{"total": 803.11, "avg": 26.77, "max": 0.99, "min": 132.35, "cnt": 30}, "backward-compute":{"total": 1782.40, "avg": 55.70, "max": 52.72, "min": 59.28, "cnt": 32}, "MoE_L3_bwd":{"total": 403.80, "avg": 12.62, "max": 11.25, "min": 15.17, "cnt": 32}, "MoE_L2_bwd":{"total": 362.19, "avg": 11.32, "max": 10.40, "min": 14.11, "cnt": 32}, "MoE_L1_bwd":{"total": 367.34, "avg": 11.48, "max": 11.06, "min": 11.85, "cnt": 32}, "MoE_L0_bwd":{"total": 438.84, "avg": 13.71, "max": 13.11, "min": 14.96, "cnt": 32}, "backward-send-forward-recv":{"total": 1017.36, "avg": 35.08, "max": 1.79, "min": 305.16, "cnt": 29}, "backward-send":{"total": 2.08, "avg": 0.69, "max": 0.43, "min": 0.95, "cnt": 3}, "backward-recv":{"total": 367.42, "avg": 183.71, "max": 69.44, "min": 297.98, "cnt": 2}, "backward-params-all-reduce":{"total": 485.16, "avg": 485.16, "max": 485.16, "min": 485.16, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 241.72, "avg": 241.72, "max": 241.72, "min": 241.72, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.36, "avg": 3.36, "max": 3.36, "min": 3.36, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 201.87, "avg": 201.87, "max": 201.87, "min": 201.87, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.32, "avg": 3.32, "max": 3.32, "min": 3.32, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}}}
{"type":"time", "iteration": 186, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 76.45, "avg": 25.48, "max": 1.17, "min": 74.01, "cnt": 3}, "forward-compute":{"total": 1904.89, "avg": 59.53, "max": 52.13, "min": 68.71, "cnt": 32}, "fwd-compute":{"total": 1901.48, "avg": 59.42, "max": 52.06, "min": 68.63, "cnt": 32}, "batch-generator":{"total": 44.56, "avg": 1.39, "max": 0.68, "min": 3.06, "cnt": 32}, "fwd-embedding":{"total": 0.67, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1843.90, "avg": 57.62, "max": 51.04, "min": 66.72, "cnt": 32}, "fwd-layernorm":{"total": 9.91, "avg": 0.08, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 110.99, "avg": 0.87, "max": 0.74, "min": 1.48, "cnt": 128}, "fwd-misc":{"total": 21.09, "avg": 0.16, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1680.73, "avg": 13.13, "max": 10.71, "min": 25.61, "cnt": 128}, "MoE_L0_fwd":{"total": 521.30, "avg": 16.29, "max": 12.91, "min": 25.51, "cnt": 32}, "MoEMLP":{"total": 1663.74, "avg": 13.00, "max": 10.61, "min": 25.47, "cnt": 128}, "MoE_L1_fwd":{"total": 408.62, "avg": 12.77, "max": 11.36, "min": 18.68, "cnt": 32}, "MoE_L2_fwd":{"total": 373.50, "avg": 11.67, "max": 10.72, "min": 14.66, "cnt": 32}, "MoE_L3_fwd":{"total": 366.57, "avg": 11.46, "max": 10.64, "min": 16.07, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.63, "avg": 0.02, "max": 0.02, "min": 0.07, "cnt": 32}, "forward-send":{"total": 1.83, "avg": 0.92, "max": 0.90, "min": 0.94, "cnt": 2}, "forward-send-backward-recv":{"total": 201.99, "avg": 6.73, "max": 1.00, "min": 122.20, "cnt": 30}, "backward-compute":{"total": 1766.56, "avg": 55.21, "max": 53.39, "min": 56.63, "cnt": 32}, "MoE_L3_bwd":{"total": 392.60, "avg": 12.27, "max": 11.47, "min": 13.32, "cnt": 32}, "MoE_L2_bwd":{"total": 359.45, "avg": 11.23, "max": 9.81, "min": 12.36, "cnt": 32}, "MoE_L1_bwd":{"total": 361.39, "avg": 11.29, "max": 10.62, "min": 11.79, "cnt": 32}, "MoE_L0_bwd":{"total": 436.96, "avg": 13.65, "max": 13.22, "min": 14.20, "cnt": 32}, "backward-send-forward-recv":{"total": 2630.35, "avg": 90.70, "max": 1.27, "min": 1317.51, "cnt": 29}, "backward-send":{"total": 2.85, "avg": 0.95, "max": 0.92, "min": 0.98, "cnt": 3}, "backward-recv":{"total": 208.58, "avg": 104.29, "max": 67.95, "min": 140.62, "cnt": 2}, "backward-params-all-reduce":{"total": 488.38, "avg": 488.38, "max": 488.38, "min": 488.38, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.05, "avg": 0.05, "max": 0.05, "min": 0.05, "cnt": 1}, "optimizer":{"total": 235.10, "avg": 235.10, "max": 235.10, "min": 235.10, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 195.30, "avg": 195.30, "max": 195.30, "min": 195.30, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.25, "avg": 3.25, "max": 3.25, "min": 3.25, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.48, "avg": 3.48, "max": 3.48, "min": 3.48, "cnt": 1}}}
{"type":"time", "iteration": 187, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.11, "avg": 0.11, "max": 0.11, "min": 0.11, "cnt": 1}, "forward-recv":{"total": 68.99, "avg": 23.00, "max": 0.63, "min": 67.72, "cnt": 3}, "forward-compute":{"total": 1872.69, "avg": 58.52, "max": 52.84, "min": 62.68, "cnt": 32}, "fwd-compute":{"total": 1868.99, "avg": 58.41, "max": 52.77, "min": 62.54, "cnt": 32}, "batch-generator":{"total": 54.08, "avg": 1.69, "max": 0.70, "min": 4.33, "cnt": 32}, "fwd-embedding":{"total": 0.80, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1801.06, "avg": 56.28, "max": 51.08, "min": 60.54, "cnt": 32}, "fwd-layernorm":{"total": 10.59, "avg": 0.08, "max": 0.05, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 114.21, "avg": 0.89, "max": 0.74, "min": 1.62, "cnt": 128}, "fwd-misc":{"total": 22.58, "avg": 0.18, "max": 0.11, "min": 0.38, "cnt": 128}, "fwd-MLP":{"total": 1631.24, "avg": 12.74, "max": 10.59, "min": 18.69, "cnt": 128}, "MoE_L0_fwd":{"total": 507.52, "avg": 15.86, "max": 12.81, "min": 18.58, "cnt": 32}, "MoEMLP":{"total": 1613.09, "avg": 12.60, "max": 10.49, "min": 18.51, "cnt": 128}, "MoE_L1_fwd":{"total": 394.39, "avg": 12.32, "max": 11.28, "min": 13.96, "cnt": 32}, "MoE_L2_fwd":{"total": 362.90, "avg": 11.34, "max": 10.81, "min": 12.19, "cnt": 32}, "MoE_L3_fwd":{"total": 354.86, "avg": 11.09, "max": 10.53, "min": 12.76, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 10.91, "avg": 5.46, "max": 0.81, "min": 10.11, "cnt": 2}, "forward-send-backward-recv":{"total": 229.15, "avg": 7.64, "max": 1.64, "min": 123.33, "cnt": 30}, "backward-compute":{"total": 1765.74, "avg": 55.18, "max": 52.90, "min": 56.97, "cnt": 32}, "MoE_L3_bwd":{"total": 389.74, "avg": 12.18, "max": 11.44, "min": 14.02, "cnt": 32}, "MoE_L2_bwd":{"total": 363.21, "avg": 11.35, "max": 10.57, "min": 13.35, "cnt": 32}, "MoE_L1_bwd":{"total": 364.18, "avg": 11.38, "max": 11.00, "min": 12.00, "cnt": 32}, "MoE_L0_bwd":{"total": 432.15, "avg": 13.50, "max": 13.15, "min": 13.92, "cnt": 32}, "backward-send-forward-recv":{"total": 1704.88, "avg": 58.79, "max": 1.27, "min": 392.51, "cnt": 29}, "backward-send":{"total": 2.72, "avg": 0.91, "max": 0.56, "min": 1.11, "cnt": 3}, "backward-recv":{"total": 136.03, "avg": 68.02, "max": 67.58, "min": 68.46, "cnt": 2}, "backward-params-all-reduce":{"total": 485.58, "avg": 485.58, "max": 485.58, "min": 485.58, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 240.20, "avg": 240.20, "max": 240.20, "min": 240.20, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 200.32, "avg": 200.32, "max": 200.32, "min": 200.32, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.27, "avg": 3.27, "max": 3.27, "min": 3.27, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 188, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 68.34, "avg": 22.78, "max": 0.78, "min": 66.21, "cnt": 3}, "forward-compute":{"total": 1943.71, "avg": 60.74, "max": 55.30, "min": 73.01, "cnt": 32}, "fwd-compute":{"total": 1940.35, "avg": 60.64, "max": 55.22, "min": 72.93, "cnt": 32}, "batch-generator":{"total": 43.76, "avg": 1.37, "max": 0.70, "min": 2.76, "cnt": 32}, "fwd-embedding":{"total": 0.68, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1883.06, "avg": 58.85, "max": 54.12, "min": 71.30, "cnt": 32}, "fwd-layernorm":{"total": 9.96, "avg": 0.08, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 112.77, "avg": 0.88, "max": 0.74, "min": 1.91, "cnt": 128}, "fwd-misc":{"total": 21.67, "avg": 0.17, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1717.13, "avg": 13.42, "max": 10.58, "min": 21.33, "cnt": 128}, "MoE_L0_fwd":{"total": 537.98, "avg": 16.81, "max": 12.68, "min": 21.25, "cnt": 32}, "MoEMLP":{"total": 1699.97, "avg": 13.28, "max": 10.48, "min": 21.20, "cnt": 128}, "MoE_L1_fwd":{"total": 420.82, "avg": 13.15, "max": 11.80, "min": 18.80, "cnt": 32}, "MoE_L2_fwd":{"total": 387.80, "avg": 12.12, "max": 11.01, "min": 17.19, "cnt": 32}, "MoE_L3_fwd":{"total": 359.63, "avg": 11.24, "max": 10.52, "min": 15.09, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 3.74, "avg": 1.87, "max": 0.90, "min": 2.84, "cnt": 2}, "forward-send-backward-recv":{"total": 197.70, "avg": 6.59, "max": 1.05, "min": 121.92, "cnt": 30}, "backward-compute":{"total": 1786.82, "avg": 55.84, "max": 54.03, "min": 59.54, "cnt": 32}, "MoE_L3_bwd":{"total": 389.47, "avg": 12.17, "max": 11.38, "min": 15.06, "cnt": 32}, "MoE_L2_bwd":{"total": 371.38, "avg": 11.61, "max": 11.10, "min": 12.84, "cnt": 32}, "MoE_L1_bwd":{"total": 372.85, "avg": 11.65, "max": 10.85, "min": 13.04, "cnt": 32}, "MoE_L0_bwd":{"total": 437.97, "avg": 13.69, "max": 13.28, "min": 17.55, "cnt": 32}, "backward-send-forward-recv":{"total": 2384.02, "avg": 82.21, "max": 1.81, "min": 611.98, "cnt": 29}, "backward-send":{"total": 2.73, "avg": 0.91, "max": 0.64, "min": 1.09, "cnt": 3}, "backward-recv":{"total": 133.32, "avg": 66.66, "max": 64.27, "min": 69.05, "cnt": 2}, "backward-params-all-reduce":{"total": 484.96, "avg": 484.96, "max": 484.96, "min": 484.96, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 239.41, "avg": 239.41, "max": 239.41, "min": 239.41, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.36, "avg": 3.36, "max": 3.36, "min": 3.36, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 199.65, "avg": 199.65, "max": 199.65, "min": 199.65, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.29, "avg": 3.29, "max": 3.29, "min": 3.29, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.41, "avg": 3.41, "max": 3.41, "min": 3.41, "cnt": 1}}}
{"type":"time", "iteration": 189, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 77.04, "avg": 25.68, "max": 1.16, "min": 74.54, "cnt": 3}, "forward-compute":{"total": 1901.34, "avg": 59.42, "max": 52.38, "min": 70.03, "cnt": 32}, "fwd-compute":{"total": 1897.79, "avg": 59.31, "max": 52.30, "min": 69.90, "cnt": 32}, "batch-generator":{"total": 42.56, "avg": 1.33, "max": 0.67, "min": 1.92, "cnt": 32}, "fwd-embedding":{"total": 0.79, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1841.73, "avg": 57.55, "max": 51.17, "min": 67.90, "cnt": 32}, "fwd-layernorm":{"total": 10.57, "avg": 0.08, "max": 0.05, "min": 0.18, "cnt": 128}, "fwd-attn":{"total": 115.48, "avg": 0.90, "max": 0.74, "min": 2.13, "cnt": 128}, "fwd-misc":{"total": 22.95, "avg": 0.18, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1670.59, "avg": 13.05, "max": 10.55, "min": 25.58, "cnt": 128}, "MoE_L0_fwd":{"total": 513.73, "avg": 16.05, "max": 12.41, "min": 25.50, "cnt": 32}, "MoEMLP":{"total": 1652.74, "avg": 12.91, "max": 10.44, "min": 25.45, "cnt": 128}, "MoE_L1_fwd":{"total": 406.40, "avg": 12.70, "max": 11.43, "min": 15.72, "cnt": 32}, "MoE_L2_fwd":{"total": 374.10, "avg": 11.69, "max": 11.00, "min": 14.20, "cnt": 32}, "MoE_L3_fwd":{"total": 365.02, "avg": 11.41, "max": 10.48, "min": 14.86, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.90, "avg": 0.95, "max": 0.90, "min": 1.00, "cnt": 2}, "forward-send-backward-recv":{"total": 319.59, "avg": 10.65, "max": 0.95, "min": 126.22, "cnt": 30}, "backward-compute":{"total": 1770.99, "avg": 55.34, "max": 52.68, "min": 57.05, "cnt": 32}, "MoE_L3_bwd":{"total": 404.04, "avg": 12.63, "max": 11.59, "min": 13.89, "cnt": 32}, "MoE_L2_bwd":{"total": 361.67, "avg": 11.30, "max": 10.62, "min": 12.71, "cnt": 32}, "MoE_L1_bwd":{"total": 365.80, "avg": 11.43, "max": 10.60, "min": 12.38, "cnt": 32}, "MoE_L0_bwd":{"total": 424.77, "avg": 13.27, "max": 12.28, "min": 14.52, "cnt": 32}, "backward-send-forward-recv":{"total": 818.16, "avg": 28.21, "max": 1.48, "min": 393.92, "cnt": 29}, "backward-send":{"total": 2.45, "avg": 0.82, "max": 0.80, "min": 0.83, "cnt": 3}, "backward-recv":{"total": 126.95, "avg": 63.48, "max": 58.43, "min": 68.53, "cnt": 2}, "backward-params-all-reduce":{"total": 487.45, "avg": 487.45, "max": 487.45, "min": 487.45, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 239.92, "avg": 239.92, "max": 239.92, "min": 239.92, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.36, "avg": 3.36, "max": 3.36, "min": 3.36, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 199.91, "avg": 199.91, "max": 199.91, "min": 199.91, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.40, "avg": 3.40, "max": 3.40, "min": 3.40, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 190, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 77.63, "avg": 25.88, "max": 0.87, "min": 75.72, "cnt": 3}, "forward-compute":{"total": 1901.45, "avg": 59.42, "max": 53.21, "min": 66.40, "cnt": 32}, "fwd-compute":{"total": 1898.20, "avg": 59.32, "max": 53.12, "min": 66.29, "cnt": 32}, "batch-generator":{"total": 37.90, "avg": 1.18, "max": 0.67, "min": 2.50, "cnt": 32}, "fwd-embedding":{"total": 0.67, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1847.94, "avg": 57.75, "max": 51.94, "min": 64.50, "cnt": 32}, "fwd-layernorm":{"total": 9.63, "avg": 0.08, "max": 0.05, "min": 0.17, "cnt": 128}, "fwd-attn":{"total": 108.76, "avg": 0.85, "max": 0.74, "min": 1.48, "cnt": 128}, "fwd-misc":{"total": 20.63, "avg": 0.16, "max": 0.11, "min": 0.34, "cnt": 128}, "fwd-MLP":{"total": 1687.96, "avg": 13.19, "max": 10.63, "min": 19.77, "cnt": 128}, "MoE_L0_fwd":{"total": 515.68, "avg": 16.11, "max": 13.08, "min": 19.69, "cnt": 32}, "MoEMLP":{"total": 1671.24, "avg": 13.06, "max": 10.52, "min": 19.65, "cnt": 128}, "MoE_L1_fwd":{"total": 408.14, "avg": 12.75, "max": 11.46, "min": 16.94, "cnt": 32}, "MoE_L2_fwd":{"total": 386.16, "avg": 12.07, "max": 11.14, "min": 15.09, "cnt": 32}, "MoE_L3_fwd":{"total": 367.37, "avg": 11.48, "max": 10.57, "min": 17.10, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 9.27, "avg": 4.64, "max": 0.89, "min": 8.38, "cnt": 2}, "forward-send-backward-recv":{"total": 739.98, "avg": 24.67, "max": 0.83, "min": 187.55, "cnt": 30}, "backward-compute":{"total": 1787.33, "avg": 55.85, "max": 52.25, "min": 60.66, "cnt": 32}, "MoE_L3_bwd":{"total": 406.90, "avg": 12.72, "max": 10.90, "min": 14.41, "cnt": 32}, "MoE_L2_bwd":{"total": 367.00, "avg": 11.47, "max": 10.19, "min": 14.62, "cnt": 32}, "MoE_L1_bwd":{"total": 366.07, "avg": 11.44, "max": 10.80, "min": 13.69, "cnt": 32}, "MoE_L0_bwd":{"total": 433.49, "avg": 13.55, "max": 12.96, "min": 16.64, "cnt": 32}, "backward-send-forward-recv":{"total": 471.41, "avg": 16.26, "max": 1.01, "min": 126.46, "cnt": 29}, "backward-send":{"total": 2.57, "avg": 0.86, "max": 0.70, "min": 1.03, "cnt": 3}, "backward-recv":{"total": 141.80, "avg": 70.90, "max": 69.98, "min": 71.83, "cnt": 2}, "backward-params-all-reduce":{"total": 484.83, "avg": 484.83, "max": 484.83, "min": 484.83, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 238.69, "avg": 238.69, "max": 238.69, "min": 238.69, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 198.96, "avg": 198.96, "max": 198.96, "min": 198.96, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.29, "avg": 3.29, "max": 3.29, "min": 3.29, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 191, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 74.39, "avg": 24.80, "max": 1.08, "min": 71.92, "cnt": 3}, "forward-compute":{"total": 1901.39, "avg": 59.42, "max": 52.48, "min": 68.58, "cnt": 32}, "fwd-compute":{"total": 1897.49, "avg": 59.30, "max": 52.41, "min": 68.45, "cnt": 32}, "batch-generator":{"total": 45.10, "avg": 1.41, "max": 0.67, "min": 1.84, "cnt": 32}, "fwd-embedding":{"total": 0.88, "avg": 0.03, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1837.92, "avg": 57.43, "max": 51.39, "min": 66.35, "cnt": 32}, "fwd-layernorm":{"total": 11.27, "avg": 0.09, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 116.48, "avg": 0.91, "max": 0.74, "min": 1.49, "cnt": 128}, "fwd-misc":{"total": 23.09, "avg": 0.18, "max": 0.11, "min": 0.34, "cnt": 128}, "fwd-MLP":{"total": 1663.67, "avg": 13.00, "max": 10.41, "min": 23.60, "cnt": 128}, "MoE_L0_fwd":{"total": 511.69, "avg": 15.99, "max": 12.71, "min": 23.51, "cnt": 32}, "MoEMLP":{"total": 1644.79, "avg": 12.85, "max": 10.30, "min": 23.46, "cnt": 128}, "MoE_L1_fwd":{"total": 406.60, "avg": 12.71, "max": 11.50, "min": 15.51, "cnt": 32}, "MoE_L2_fwd":{"total": 380.18, "avg": 11.88, "max": 10.96, "min": 17.91, "cnt": 32}, "MoE_L3_fwd":{"total": 353.13, "avg": 11.04, "max": 10.34, "min": 14.89, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.65, "avg": 0.02, "max": 0.02, "min": 0.07, "cnt": 32}, "forward-send":{"total": 3.30, "avg": 1.65, "max": 0.93, "min": 2.37, "cnt": 2}, "forward-send-backward-recv":{"total": 870.77, "avg": 29.03, "max": 1.31, "min": 159.39, "cnt": 30}, "backward-compute":{"total": 1749.57, "avg": 54.67, "max": 52.08, "min": 59.34, "cnt": 32}, "MoE_L3_bwd":{"total": 387.57, "avg": 12.11, "max": 11.30, "min": 16.10, "cnt": 32}, "MoE_L2_bwd":{"total": 358.52, "avg": 11.20, "max": 10.06, "min": 11.87, "cnt": 32}, "MoE_L1_bwd":{"total": 367.62, "avg": 11.49, "max": 11.04, "min": 12.27, "cnt": 32}, "MoE_L0_bwd":{"total": 422.37, "avg": 13.20, "max": 12.44, "min": 13.98, "cnt": 32}, "backward-send-forward-recv":{"total": 158.17, "avg": 5.45, "max": 1.08, "min": 51.62, "cnt": 29}, "backward-send":{"total": 2.45, "avg": 0.82, "max": 0.68, "min": 1.00, "cnt": 3}, "backward-recv":{"total": 191.58, "avg": 95.79, "max": 67.57, "min": 124.01, "cnt": 2}, "backward-params-all-reduce":{"total": 487.11, "avg": 487.11, "max": 487.11, "min": 487.11, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 241.38, "avg": 241.38, "max": 241.38, "min": 241.38, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.36, "avg": 3.36, "max": 3.36, "min": 3.36, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 201.48, "avg": 201.48, "max": 201.48, "min": 201.48, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.25, "avg": 3.25, "max": 3.25, "min": 3.25, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 192, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 69.97, "avg": 23.32, "max": 0.97, "min": 67.92, "cnt": 3}, "forward-compute":{"total": 1956.24, "avg": 61.13, "max": 53.75, "min": 119.11, "cnt": 32}, "fwd-compute":{"total": 1952.64, "avg": 61.02, "max": 53.67, "min": 119.02, "cnt": 32}, "batch-generator":{"total": 44.09, "avg": 1.38, "max": 0.75, "min": 2.69, "cnt": 32}, "fwd-embedding":{"total": 0.81, "avg": 0.03, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1895.27, "avg": 59.23, "max": 52.56, "min": 117.82, "cnt": 32}, "fwd-layernorm":{"total": 10.79, "avg": 0.08, "max": 0.05, "min": 0.18, "cnt": 128}, "fwd-attn":{"total": 114.79, "avg": 0.90, "max": 0.74, "min": 1.51, "cnt": 128}, "fwd-misc":{"total": 22.71, "avg": 0.18, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1724.30, "avg": 13.47, "max": 10.17, "min": 79.96, "cnt": 128}, "MoE_L0_fwd":{"total": 587.90, "avg": 18.37, "max": 13.32, "min": 79.88, "cnt": 32}, "MoEMLP":{"total": 1706.08, "avg": 13.33, "max": 10.07, "min": 79.83, "cnt": 128}, "MoE_L1_fwd":{"total": 407.68, "avg": 12.74, "max": 11.71, "min": 14.08, "cnt": 32}, "MoE_L2_fwd":{"total": 367.00, "avg": 11.47, "max": 10.66, "min": 12.34, "cnt": 32}, "MoE_L3_fwd":{"total": 350.14, "avg": 10.94, "max": 10.11, "min": 14.88, "cnt": 32}, "fwd-pooler":{"total": 0.32, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 4.36, "avg": 2.18, "max": 0.68, "min": 3.68, "cnt": 2}, "forward-send-backward-recv":{"total": 965.67, "avg": 32.19, "max": 5.88, "min": 220.94, "cnt": 30}, "backward-compute":{"total": 1740.95, "avg": 54.40, "max": 51.15, "min": 56.33, "cnt": 32}, "MoE_L3_bwd":{"total": 379.49, "avg": 11.86, "max": 10.98, "min": 13.45, "cnt": 32}, "MoE_L2_bwd":{"total": 357.13, "avg": 11.16, "max": 10.30, "min": 11.85, "cnt": 32}, "MoE_L1_bwd":{"total": 370.67, "avg": 11.58, "max": 10.87, "min": 12.06, "cnt": 32}, "MoE_L0_bwd":{"total": 419.76, "avg": 13.12, "max": 12.25, "min": 15.88, "cnt": 32}, "backward-send-forward-recv":{"total": 63.48, "avg": 2.19, "max": 1.61, "min": 2.74, "cnt": 29}, "backward-send":{"total": 2.10, "avg": 0.70, "max": 0.44, "min": 0.98, "cnt": 3}, "backward-recv":{"total": 138.53, "avg": 69.27, "max": 69.25, "min": 69.28, "cnt": 2}, "backward-params-all-reduce":{"total": 490.33, "avg": 490.33, "max": 490.33, "min": 490.33, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 241.10, "avg": 241.10, "max": 241.10, "min": 241.10, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 200.93, "avg": 200.93, "max": 200.93, "min": 200.93, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.67, "avg": 3.67, "max": 3.67, "min": 3.67, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}}}
{"type":"time", "iteration": 193, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.10, "avg": 0.10, "max": 0.10, "min": 0.10, "cnt": 1}, "forward-recv":{"total": 73.06, "avg": 24.35, "max": 0.78, "min": 71.43, "cnt": 3}, "forward-compute":{"total": 1846.99, "avg": 57.72, "max": 52.21, "min": 64.16, "cnt": 32}, "fwd-compute":{"total": 1843.70, "avg": 57.62, "max": 52.15, "min": 64.07, "cnt": 32}, "batch-generator":{"total": 45.02, "avg": 1.41, "max": 0.65, "min": 3.05, "cnt": 32}, "fwd-embedding":{"total": 0.66, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1786.19, "avg": 55.82, "max": 51.19, "min": 62.18, "cnt": 32}, "fwd-layernorm":{"total": 10.19, "avg": 0.08, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 114.13, "avg": 0.89, "max": 0.74, "min": 2.47, "cnt": 128}, "fwd-misc":{"total": 21.86, "avg": 0.17, "max": 0.11, "min": 0.38, "cnt": 128}, "fwd-MLP":{"total": 1618.13, "avg": 12.64, "max": 10.25, "min": 20.26, "cnt": 128}, "MoE_L0_fwd":{"total": 489.23, "avg": 15.29, "max": 12.22, "min": 20.19, "cnt": 32}, "MoEMLP":{"total": 1600.45, "avg": 12.50, "max": 10.14, "min": 20.14, "cnt": 128}, "MoE_L1_fwd":{"total": 403.35, "avg": 12.60, "max": 11.88, "min": 13.79, "cnt": 32}, "MoE_L2_fwd":{"total": 367.32, "avg": 11.48, "max": 10.82, "min": 15.90, "cnt": 32}, "MoE_L3_fwd":{"total": 347.04, "avg": 10.84, "max": 10.18, "min": 12.70, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 2.40, "avg": 1.20, "max": 0.93, "min": 1.47, "cnt": 2}, "forward-send-backward-recv":{"total": 481.50, "avg": 16.05, "max": 1.57, "min": 159.44, "cnt": 30}, "backward-compute":{"total": 1754.21, "avg": 54.82, "max": 52.03, "min": 57.61, "cnt": 32}, "MoE_L3_bwd":{"total": 385.09, "avg": 12.03, "max": 9.99, "min": 14.43, "cnt": 32}, "MoE_L2_bwd":{"total": 362.38, "avg": 11.32, "max": 10.19, "min": 12.28, "cnt": 32}, "MoE_L1_bwd":{"total": 375.97, "avg": 11.75, "max": 11.17, "min": 12.17, "cnt": 32}, "MoE_L0_bwd":{"total": 417.25, "avg": 13.04, "max": 12.48, "min": 13.39, "cnt": 32}, "backward-send-forward-recv":{"total": 2976.98, "avg": 102.65, "max": 1.68, "min": 601.74, "cnt": 29}, "backward-send":{"total": 3.09, "avg": 1.03, "max": 0.94, "min": 1.10, "cnt": 3}, "backward-recv":{"total": 167.55, "avg": 83.78, "max": 53.72, "min": 113.84, "cnt": 2}, "backward-params-all-reduce":{"total": 483.62, "avg": 483.62, "max": 483.62, "min": 483.62, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 241.17, "avg": 241.17, "max": 241.17, "min": 241.17, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 201.26, "avg": 201.26, "max": 201.26, "min": 201.26, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.23, "avg": 3.23, "max": 3.23, "min": 3.23, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 194, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 74.85, "avg": 24.95, "max": 0.76, "min": 73.22, "cnt": 3}, "forward-compute":{"total": 1880.77, "avg": 58.77, "max": 53.77, "min": 66.37, "cnt": 32}, "fwd-compute":{"total": 1877.20, "avg": 58.66, "max": 53.70, "min": 66.24, "cnt": 32}, "batch-generator":{"total": 50.49, "avg": 1.58, "max": 0.75, "min": 4.41, "cnt": 32}, "fwd-embedding":{"total": 0.88, "avg": 0.03, "max": 0.01, "min": 0.06, "cnt": 32}, "fwd-encoder":{"total": 1812.73, "avg": 56.65, "max": 52.58, "min": 64.08, "cnt": 32}, "fwd-layernorm":{"total": 10.75, "avg": 0.08, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 114.26, "avg": 0.89, "max": 0.74, "min": 1.94, "cnt": 128}, "fwd-misc":{"total": 22.80, "avg": 0.18, "max": 0.11, "min": 0.39, "cnt": 128}, "fwd-MLP":{"total": 1642.13, "avg": 12.83, "max": 10.26, "min": 18.33, "cnt": 128}, "MoE_L0_fwd":{"total": 492.98, "avg": 15.41, "max": 12.60, "min": 18.20, "cnt": 32}, "MoEMLP":{"total": 1623.81, "avg": 12.69, "max": 10.15, "min": 18.15, "cnt": 128}, "MoE_L1_fwd":{"total": 409.13, "avg": 12.79, "max": 11.96, "min": 14.73, "cnt": 32}, "MoE_L2_fwd":{"total": 372.71, "avg": 11.65, "max": 10.95, "min": 17.28, "cnt": 32}, "MoE_L3_fwd":{"total": 355.58, "avg": 11.11, "max": 10.18, "min": 15.64, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 3.69, "avg": 1.85, "max": 0.72, "min": 2.97, "cnt": 2}, "forward-send-backward-recv":{"total": 321.60, "avg": 10.72, "max": 0.91, "min": 129.23, "cnt": 30}, "backward-compute":{"total": 1740.71, "avg": 54.40, "max": 53.07, "min": 56.61, "cnt": 32}, "MoE_L3_bwd":{"total": 390.68, "avg": 12.21, "max": 11.03, "min": 13.20, "cnt": 32}, "MoE_L2_bwd":{"total": 348.13, "avg": 10.88, "max": 10.04, "min": 12.07, "cnt": 32}, "MoE_L1_bwd":{"total": 374.76, "avg": 11.71, "max": 11.27, "min": 12.92, "cnt": 32}, "MoE_L0_bwd":{"total": 414.89, "avg": 12.97, "max": 12.27, "min": 13.54, "cnt": 32}, "backward-send-forward-recv":{"total": 1201.01, "avg": 41.41, "max": 0.91, "min": 400.53, "cnt": 29}, "backward-send":{"total": 2.48, "avg": 0.83, "max": 0.40, "min": 1.13, "cnt": 3}, "backward-recv":{"total": 140.25, "avg": 70.12, "max": 69.38, "min": 70.87, "cnt": 2}, "backward-params-all-reduce":{"total": 486.85, "avg": 486.85, "max": 486.85, "min": 486.85, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 239.31, "avg": 239.31, "max": 239.31, "min": 239.31, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 199.65, "avg": 199.65, "max": 199.65, "min": 199.65, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.26, "avg": 3.26, "max": 3.26, "min": 3.26, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}}}
{"type":"time", "iteration": 195, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 74.13, "avg": 24.71, "max": 1.14, "min": 71.30, "cnt": 3}, "forward-compute":{"total": 1884.02, "avg": 58.88, "max": 52.32, "min": 66.28, "cnt": 32}, "fwd-compute":{"total": 1880.45, "avg": 58.76, "max": 52.22, "min": 66.20, "cnt": 32}, "batch-generator":{"total": 45.94, "avg": 1.44, "max": 0.68, "min": 2.41, "cnt": 32}, "fwd-embedding":{"total": 0.81, "avg": 0.03, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1820.95, "avg": 56.90, "max": 51.02, "min": 64.92, "cnt": 32}, "fwd-layernorm":{"total": 10.79, "avg": 0.08, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 114.78, "avg": 0.90, "max": 0.74, "min": 1.50, "cnt": 128}, "fwd-misc":{"total": 22.72, "avg": 0.18, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1649.94, "avg": 12.89, "max": 10.33, "min": 21.10, "cnt": 128}, "MoE_L0_fwd":{"total": 499.16, "avg": 15.60, "max": 12.68, "min": 21.02, "cnt": 32}, "MoEMLP":{"total": 1631.92, "avg": 12.75, "max": 10.21, "min": 20.98, "cnt": 128}, "MoE_L1_fwd":{"total": 412.89, "avg": 12.90, "max": 11.94, "min": 15.76, "cnt": 32}, "MoE_L2_fwd":{"total": 372.58, "avg": 11.64, "max": 10.98, "min": 15.84, "cnt": 32}, "MoE_L3_fwd":{"total": 353.86, "avg": 11.06, "max": 10.25, "min": 16.04, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.66, "avg": 0.83, "max": 0.81, "min": 0.85, "cnt": 2}, "forward-send-backward-recv":{"total": 252.34, "avg": 8.41, "max": 1.86, "min": 113.88, "cnt": 30}, "backward-compute":{"total": 1761.51, "avg": 55.05, "max": 53.10, "min": 61.47, "cnt": 32}, "MoE_L3_bwd":{"total": 383.99, "avg": 12.00, "max": 10.83, "min": 13.47, "cnt": 32}, "MoE_L2_bwd":{"total": 359.95, "avg": 11.25, "max": 10.51, "min": 13.21, "cnt": 32}, "MoE_L1_bwd":{"total": 377.04, "avg": 11.78, "max": 11.36, "min": 16.86, "cnt": 32}, "MoE_L0_bwd":{"total": 426.21, "avg": 13.32, "max": 12.58, "min": 14.86, "cnt": 32}, "backward-send-forward-recv":{"total": 1643.81, "avg": 56.68, "max": 2.25, "min": 445.35, "cnt": 29}, "backward-send":{"total": 3.36, "avg": 1.12, "max": 1.05, "min": 1.16, "cnt": 3}, "backward-recv":{"total": 134.80, "avg": 67.40, "max": 67.34, "min": 67.46, "cnt": 2}, "backward-params-all-reduce":{"total": 489.14, "avg": 489.14, "max": 489.14, "min": 489.14, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 238.68, "avg": 238.68, "max": 238.68, "min": 238.68, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.36, "avg": 3.36, "max": 3.36, "min": 3.36, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 198.93, "avg": 198.93, "max": 198.93, "min": 198.93, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.28, "avg": 3.28, "max": 3.28, "min": 3.28, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}}}
{"type":"time", "iteration": 196, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 76.74, "avg": 25.58, "max": 0.70, "min": 75.17, "cnt": 3}, "forward-compute":{"total": 1893.10, "avg": 59.16, "max": 54.43, "min": 62.94, "cnt": 32}, "fwd-compute":{"total": 1889.74, "avg": 59.05, "max": 54.35, "min": 62.85, "cnt": 32}, "batch-generator":{"total": 42.99, "avg": 1.34, "max": 0.68, "min": 2.56, "cnt": 32}, "fwd-embedding":{"total": 0.74, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1833.57, "avg": 57.30, "max": 52.86, "min": 61.43, "cnt": 32}, "fwd-layernorm":{"total": 10.45, "avg": 0.08, "max": 0.05, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 114.86, "avg": 0.90, "max": 0.74, "min": 2.42, "cnt": 128}, "fwd-misc":{"total": 22.21, "avg": 0.17, "max": 0.11, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1663.93, "avg": 13.00, "max": 10.25, "min": 19.50, "cnt": 128}, "MoE_L0_fwd":{"total": 523.49, "avg": 16.36, "max": 13.21, "min": 19.42, "cnt": 32}, "MoEMLP":{"total": 1646.12, "avg": 12.86, "max": 10.15, "min": 19.38, "cnt": 128}, "MoE_L1_fwd":{"total": 406.69, "avg": 12.71, "max": 11.86, "min": 14.09, "cnt": 32}, "MoE_L2_fwd":{"total": 375.65, "avg": 11.74, "max": 10.92, "min": 12.97, "cnt": 32}, "MoE_L3_fwd":{"total": 346.82, "avg": 10.84, "max": 10.19, "min": 14.22, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 2.81, "avg": 1.41, "max": 0.87, "min": 1.95, "cnt": 2}, "forward-send-backward-recv":{"total": 450.66, "avg": 15.02, "max": 1.69, "min": 124.21, "cnt": 30}, "backward-compute":{"total": 1768.87, "avg": 55.28, "max": 54.01, "min": 57.48, "cnt": 32}, "MoE_L3_bwd":{"total": 387.93, "avg": 12.12, "max": 11.34, "min": 14.22, "cnt": 32}, "MoE_L2_bwd":{"total": 365.51, "avg": 11.42, "max": 10.63, "min": 13.48, "cnt": 32}, "MoE_L1_bwd":{"total": 368.92, "avg": 11.53, "max": 10.97, "min": 12.64, "cnt": 32}, "MoE_L0_bwd":{"total": 431.16, "avg": 13.47, "max": 12.81, "min": 14.90, "cnt": 32}, "backward-send-forward-recv":{"total": 466.61, "avg": 16.09, "max": 1.72, "min": 94.65, "cnt": 29}, "backward-send":{"total": 3.12, "avg": 1.04, "max": 0.94, "min": 1.14, "cnt": 3}, "backward-recv":{"total": 122.45, "avg": 61.22, "max": 59.19, "min": 63.26, "cnt": 2}, "backward-params-all-reduce":{"total": 486.72, "avg": 486.72, "max": 486.72, "min": 486.72, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 239.87, "avg": 239.87, "max": 239.87, "min": 239.87, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.36, "avg": 3.36, "max": 3.36, "min": 3.36, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 199.78, "avg": 199.78, "max": 199.78, "min": 199.78, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.67, "avg": 3.67, "max": 3.67, "min": 3.67, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}}}
{"type":"time", "iteration": 197, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 81.15, "avg": 27.05, "max": 0.82, "min": 77.00, "cnt": 3}, "forward-compute":{"total": 1867.95, "avg": 58.37, "max": 51.41, "min": 62.30, "cnt": 32}, "fwd-compute":{"total": 1864.12, "avg": 58.25, "max": 51.34, "min": 62.22, "cnt": 32}, "batch-generator":{"total": 46.87, "avg": 1.46, "max": 0.75, "min": 1.82, "cnt": 32}, "fwd-embedding":{"total": 0.91, "avg": 0.03, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1803.00, "avg": 56.34, "max": 50.13, "min": 61.12, "cnt": 32}, "fwd-layernorm":{"total": 11.32, "avg": 0.09, "max": 0.05, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 118.79, "avg": 0.93, "max": 0.74, "min": 1.54, "cnt": 128}, "fwd-misc":{"total": 24.23, "avg": 0.19, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1625.13, "avg": 12.70, "max": 10.24, "min": 19.35, "cnt": 128}, "MoE_L0_fwd":{"total": 493.00, "avg": 15.41, "max": 12.45, "min": 19.27, "cnt": 32}, "MoEMLP":{"total": 1606.14, "avg": 12.55, "max": 10.14, "min": 19.22, "cnt": 128}, "MoE_L1_fwd":{"total": 398.49, "avg": 12.45, "max": 11.34, "min": 14.03, "cnt": 32}, "MoE_L2_fwd":{"total": 372.90, "avg": 11.65, "max": 10.94, "min": 15.02, "cnt": 32}, "MoE_L3_fwd":{"total": 348.52, "avg": 10.89, "max": 10.18, "min": 11.85, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 8.62, "avg": 4.31, "max": 0.86, "min": 7.76, "cnt": 2}, "forward-send-backward-recv":{"total": 335.32, "avg": 11.18, "max": 1.01, "min": 132.68, "cnt": 30}, "backward-compute":{"total": 1768.93, "avg": 55.28, "max": 53.58, "min": 58.44, "cnt": 32}, "MoE_L3_bwd":{"total": 383.24, "avg": 11.98, "max": 10.79, "min": 13.49, "cnt": 32}, "MoE_L2_bwd":{"total": 373.75, "avg": 11.68, "max": 10.33, "min": 12.85, "cnt": 32}, "MoE_L1_bwd":{"total": 371.17, "avg": 11.60, "max": 11.04, "min": 14.00, "cnt": 32}, "MoE_L0_bwd":{"total": 426.51, "avg": 13.33, "max": 12.74, "min": 13.74, "cnt": 32}, "backward-send-forward-recv":{"total": 438.37, "avg": 15.12, "max": 2.00, "min": 143.61, "cnt": 29}, "backward-send":{"total": 2.77, "avg": 0.92, "max": 0.78, "min": 1.12, "cnt": 3}, "backward-recv":{"total": 137.50, "avg": 68.75, "max": 67.11, "min": 70.38, "cnt": 2}, "backward-params-all-reduce":{"total": 510.08, "avg": 510.08, "max": 510.08, "min": 510.08, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 237.92, "avg": 237.92, "max": 237.92, "min": 237.92, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 198.10, "avg": 198.10, "max": 198.10, "min": 198.10, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.30, "avg": 3.30, "max": 3.30, "min": 3.30, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 198, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 85.22, "avg": 28.41, "max": 1.02, "min": 77.30, "cnt": 3}, "forward-compute":{"total": 1865.81, "avg": 58.31, "max": 52.32, "min": 66.29, "cnt": 32}, "fwd-compute":{"total": 1862.52, "avg": 58.20, "max": 52.25, "min": 66.15, "cnt": 32}, "batch-generator":{"total": 42.18, "avg": 1.32, "max": 0.65, "min": 3.14, "cnt": 32}, "fwd-embedding":{"total": 0.66, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1807.51, "avg": 56.48, "max": 51.28, "min": 62.98, "cnt": 32}, "fwd-layernorm":{"total": 9.59, "avg": 0.07, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 108.71, "avg": 0.85, "max": 0.74, "min": 1.46, "cnt": 128}, "fwd-misc":{"total": 20.42, "avg": 0.16, "max": 0.11, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1648.09, "avg": 12.88, "max": 9.78, "min": 19.78, "cnt": 128}, "MoE_L0_fwd":{"total": 514.73, "avg": 16.09, "max": 12.88, "min": 19.71, "cnt": 32}, "MoEMLP":{"total": 1631.31, "avg": 12.74, "max": 9.67, "min": 19.67, "cnt": 128}, "MoE_L1_fwd":{"total": 406.19, "avg": 12.69, "max": 11.28, "min": 15.56, "cnt": 32}, "MoE_L2_fwd":{"total": 374.13, "avg": 11.69, "max": 10.99, "min": 13.29, "cnt": 32}, "MoE_L3_fwd":{"total": 342.32, "avg": 10.70, "max": 9.71, "min": 15.61, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.73, "avg": 0.87, "max": 0.86, "min": 0.87, "cnt": 2}, "forward-send-backward-recv":{"total": 177.03, "avg": 5.90, "max": 0.84, "min": 110.98, "cnt": 30}, "backward-compute":{"total": 1771.72, "avg": 55.37, "max": 51.93, "min": 58.07, "cnt": 32}, "MoE_L3_bwd":{"total": 389.86, "avg": 12.18, "max": 10.86, "min": 13.99, "cnt": 32}, "MoE_L2_bwd":{"total": 377.25, "avg": 11.79, "max": 10.74, "min": 12.61, "cnt": 32}, "MoE_L1_bwd":{"total": 364.76, "avg": 11.40, "max": 10.85, "min": 12.76, "cnt": 32}, "MoE_L0_bwd":{"total": 424.24, "avg": 13.26, "max": 12.58, "min": 14.92, "cnt": 32}, "backward-send-forward-recv":{"total": 1599.09, "avg": 55.14, "max": 2.34, "min": 250.14, "cnt": 29}, "backward-send":{"total": 2.70, "avg": 0.90, "max": 0.81, "min": 1.06, "cnt": 3}, "backward-recv":{"total": 135.48, "avg": 67.74, "max": 66.34, "min": 69.14, "cnt": 2}, "backward-params-all-reduce":{"total": 484.03, "avg": 484.03, "max": 484.03, "min": 484.03, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 243.23, "avg": 243.23, "max": 243.23, "min": 243.23, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 203.44, "avg": 203.44, "max": 203.44, "min": 203.44, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.27, "avg": 3.27, "max": 3.27, "min": 3.27, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.48, "avg": 3.48, "max": 3.48, "min": 3.48, "cnt": 1}}}
{"type":"time", "iteration": 199, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 75.40, "avg": 25.13, "max": 2.30, "min": 70.11, "cnt": 3}, "forward-compute":{"total": 1871.57, "avg": 58.49, "max": 51.79, "min": 65.61, "cnt": 32}, "fwd-compute":{"total": 1868.22, "avg": 58.38, "max": 51.68, "min": 65.49, "cnt": 32}, "batch-generator":{"total": 40.60, "avg": 1.27, "max": 0.76, "min": 1.78, "cnt": 32}, "fwd-embedding":{"total": 0.71, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1814.70, "avg": 56.71, "max": 50.40, "min": 63.66, "cnt": 32}, "fwd-layernorm":{"total": 10.18, "avg": 0.08, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 111.40, "avg": 0.87, "max": 0.74, "min": 1.93, "cnt": 128}, "fwd-misc":{"total": 21.91, "avg": 0.17, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1649.70, "avg": 12.89, "max": 9.96, "min": 20.65, "cnt": 128}, "MoE_L0_fwd":{"total": 516.97, "avg": 16.16, "max": 12.27, "min": 20.58, "cnt": 32}, "MoEMLP":{"total": 1632.18, "avg": 12.75, "max": 9.85, "min": 20.53, "cnt": 128}, "MoE_L1_fwd":{"total": 393.05, "avg": 12.28, "max": 11.38, "min": 14.21, "cnt": 32}, "MoE_L2_fwd":{"total": 377.99, "avg": 11.81, "max": 10.96, "min": 12.88, "cnt": 32}, "MoE_L3_fwd":{"total": 350.50, "avg": 10.95, "max": 9.89, "min": 17.45, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.86, "avg": 0.93, "max": 0.92, "min": 0.94, "cnt": 2}, "forward-send-backward-recv":{"total": 1023.26, "avg": 34.11, "max": 1.60, "min": 335.15, "cnt": 30}, "backward-compute":{"total": 1729.42, "avg": 54.04, "max": 52.37, "min": 55.71, "cnt": 32}, "MoE_L3_bwd":{"total": 380.79, "avg": 11.90, "max": 10.99, "min": 13.49, "cnt": 32}, "MoE_L2_bwd":{"total": 352.04, "avg": 11.00, "max": 10.33, "min": 11.41, "cnt": 32}, "MoE_L1_bwd":{"total": 356.03, "avg": 11.13, "max": 10.40, "min": 11.74, "cnt": 32}, "MoE_L0_bwd":{"total": 425.01, "avg": 13.28, "max": 12.67, "min": 13.93, "cnt": 32}, "backward-send-forward-recv":{"total": 1433.64, "avg": 49.44, "max": 1.12, "min": 464.44, "cnt": 29}, "backward-send":{"total": 3.08, "avg": 1.03, "max": 1.00, "min": 1.05, "cnt": 3}, "backward-recv":{"total": 136.20, "avg": 68.10, "max": 63.95, "min": 72.25, "cnt": 2}, "backward-params-all-reduce":{"total": 490.52, "avg": 490.52, "max": 490.52, "min": 490.52, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 239.08, "avg": 239.08, "max": 239.08, "min": 239.08, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 199.22, "avg": 199.22, "max": 199.22, "min": 199.22, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.27, "avg": 3.27, "max": 3.27, "min": 3.27, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 200, "rank": 19, "tp_rank": 0, "pp_rank": 1, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 78.41, "avg": 26.14, "max": 0.79, "min": 76.12, "cnt": 3}, "forward-compute":{"total": 1857.29, "avg": 58.04, "max": 50.75, "min": 67.51, "cnt": 32}, "fwd-compute":{"total": 1853.68, "avg": 57.93, "max": 50.68, "min": 67.37, "cnt": 32}, "batch-generator":{"total": 46.16, "avg": 1.44, "max": 0.66, "min": 2.48, "cnt": 32}, "fwd-embedding":{"total": 0.81, "avg": 0.03, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1793.35, "avg": 56.04, "max": 49.70, "min": 65.26, "cnt": 32}, "fwd-layernorm":{"total": 10.92, "avg": 0.09, "max": 0.05, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 115.29, "avg": 0.90, "max": 0.74, "min": 2.19, "cnt": 128}, "fwd-misc":{"total": 22.86, "avg": 0.18, "max": 0.11, "min": 0.51, "cnt": 128}, "fwd-MLP":{"total": 1621.83, "avg": 12.67, "max": 10.12, "min": 20.30, "cnt": 128}, "MoE_L0_fwd":{"total": 502.92, "avg": 15.72, "max": 12.35, "min": 20.21, "cnt": 32}, "MoEMLP":{"total": 1603.67, "avg": 12.53, "max": 9.99, "min": 20.16, "cnt": 128}, "MoE_L1_fwd":{"total": 389.48, "avg": 12.17, "max": 11.16, "min": 15.93, "cnt": 32}, "MoE_L2_fwd":{"total": 377.44, "avg": 11.79, "max": 10.78, "min": 14.20, "cnt": 32}, "MoE_L3_fwd":{"total": 340.47, "avg": 10.64, "max": 10.04, "min": 11.81, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 4.84, "avg": 2.42, "max": 0.92, "min": 3.92, "cnt": 2}, "forward-send-backward-recv":{"total": 1066.97, "avg": 35.57, "max": 1.46, "min": 300.42, "cnt": 30}, "backward-compute":{"total": 1734.39, "avg": 54.20, "max": 51.98, "min": 58.31, "cnt": 32}, "MoE_L3_bwd":{"total": 380.15, "avg": 11.88, "max": 10.53, "min": 14.16, "cnt": 32}, "MoE_L2_bwd":{"total": 353.25, "avg": 11.04, "max": 10.26, "min": 11.95, "cnt": 32}, "MoE_L1_bwd":{"total": 352.14, "avg": 11.00, "max": 10.26, "min": 11.46, "cnt": 32}, "MoE_L0_bwd":{"total": 430.50, "avg": 13.45, "max": 12.65, "min": 17.35, "cnt": 32}, "backward-send-forward-recv":{"total": 1981.21, "avg": 68.32, "max": 1.13, "min": 651.24, "cnt": 29}, "backward-send":{"total": 3.24, "avg": 1.08, "max": 1.02, "min": 1.12, "cnt": 3}, "backward-recv":{"total": 138.60, "avg": 69.30, "max": 68.93, "min": 69.67, "cnt": 2}, "backward-params-all-reduce":{"total": 489.65, "avg": 489.65, "max": 489.65, "min": 489.65, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 247.29, "avg": 247.29, "max": 247.29, "min": 247.29, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 207.56, "avg": 207.56, "max": 207.56, "min": 207.56, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.33, "avg": 3.33, "max": 3.33, "min": 3.33, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}}}
