{"type":"time", "iteration": -1, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 7193.79, "avg": 7193.79, "max": 7193.79, "min": 7193.79, "cnt": 1}, "train/valid/test-data-iterators-setup":{"total": 14767.46, "avg": 14767.46, "max": 14767.46, "min": 14767.46, "cnt": 1}}}
{"type":"time", "iteration": 1, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.84, "avg": 0.84, "max": 0.84, "min": 0.84, "cnt": 1}, "forward-recv":{"total": 4619.61, "avg": 1539.87, "max": 0.92, "min": 4617.46, "cnt": 3}, "forward-compute":{"total": 4316.49, "avg": 134.89, "max": 50.54, "min": 1393.66, "cnt": 32}, "fwd-compute":{"total": 4312.37, "avg": 134.76, "max": 50.45, "min": 1393.45, "cnt": 32}, "batch-generator":{"total": 76.92, "avg": 2.40, "max": 0.83, "min": 7.97, "cnt": 32}, "fwd-embedding":{"total": 0.66, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 4219.66, "avg": 131.86, "max": 49.22, "min": 1384.07, "cnt": 32}, "fwd-layernorm":{"total": 11.79, "avg": 0.09, "max": 0.06, "min": 0.33, "cnt": 128}, "fwd-attn":{"total": 675.51, "avg": 5.28, "max": 0.75, "min": 506.17, "cnt": 128}, "fwd-misc":{"total": 355.36, "avg": 2.78, "max": 0.11, "min": 332.14, "cnt": 128}, "fwd-MLP":{"total": 3147.67, "avg": 24.59, "max": 10.80, "min": 477.31, "cnt": 128}, "MoE_L0_fwd":{"total": 1926.95, "avg": 60.22, "max": 11.52, "min": 477.09, "cnt": 32}, "MoEMLP":{"total": 3128.20, "avg": 24.44, "max": 10.68, "min": 476.99, "cnt": 128}, "MoE_L1_fwd":{"total": 424.88, "avg": 13.28, "max": 10.73, "min": 18.64, "cnt": 32}, "MoE_L2_fwd":{"total": 392.58, "avg": 12.27, "max": 10.81, "min": 16.27, "cnt": 32}, "MoE_L3_fwd":{"total": 390.90, "avg": 12.22, "max": 10.78, "min": 18.17, "cnt": 32}, "fwd-pooler":{"total": 0.36, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.65, "avg": 0.02, "max": 0.02, "min": 0.05, "cnt": 32}, "forward-send":{"total": 1886.10, "avg": 943.05, "max": 90.00, "min": 1796.10, "cnt": 2}, "forward-send-backward-recv":{"total": 2270.15, "avg": 75.67, "max": 1.43, "min": 2112.77, "cnt": 30}, "backward-compute":{"total": 1905.32, "avg": 59.54, "max": 46.45, "min": 402.01, "cnt": 32}, "MoE_L3_bwd":{"total": 413.10, "avg": 12.91, "max": 11.17, "min": 30.59, "cnt": 32}, "MoE_L2_bwd":{"total": 354.50, "avg": 11.08, "max": 9.48, "min": 13.24, "cnt": 32}, "MoE_L1_bwd":{"total": 295.95, "avg": 9.25, "max": 8.89, "min": 10.04, "cnt": 32}, "MoE_L0_bwd":{"total": 288.06, "avg": 9.00, "max": 8.46, "min": 10.35, "cnt": 32}, "backward-send-forward-recv":{"total": 9562.10, "avg": 329.73, "max": 2.11, "min": 1321.23, "cnt": 29}, "backward-send":{"total": 3.20, "avg": 1.07, "max": 1.00, "min": 1.14, "cnt": 3}, "backward-recv":{"total": 159.80, "avg": 79.90, "max": 76.74, "min": 83.06, "cnt": 2}, "backward-params-all-reduce":{"total": 832.60, "avg": 832.60, "max": 832.60, "min": 832.60, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.05, "avg": 0.05, "max": 0.05, "min": 0.05, "cnt": 1}, "optimizer":{"total": 607.39, "avg": 607.39, "max": 607.39, "min": 607.39, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.40, "avg": 3.40, "max": 3.40, "min": 3.40, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 291.75, "avg": 291.75, "max": 291.75, "min": 291.75, "cnt": 1}, "optimizer-clip-main-grad":{"total": 78.15, "avg": 78.15, "max": 78.15, "min": 78.15, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.75, "avg": 3.75, "max": 3.75, "min": 3.75, "cnt": 1}}}
{"type":"time", "iteration": 2, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.13, "avg": 0.13, "max": 0.13, "min": 0.13, "cnt": 1}, "forward-recv":{"total": 61.77, "avg": 20.59, "max": 1.32, "min": 59.04, "cnt": 3}, "forward-compute":{"total": 2459.91, "avg": 76.87, "max": 53.39, "min": 261.44, "cnt": 32}, "fwd-compute":{"total": 2455.81, "avg": 76.74, "max": 53.31, "min": 261.34, "cnt": 32}, "batch-generator":{"total": 60.64, "avg": 1.90, "max": 0.72, "min": 4.45, "cnt": 32}, "fwd-embedding":{"total": 0.73, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 2379.25, "avg": 74.35, "max": 52.10, "min": 258.72, "cnt": 32}, "fwd-layernorm":{"total": 12.11, "avg": 0.09, "max": 0.06, "min": 0.35, "cnt": 128}, "fwd-attn":{"total": 118.86, "avg": 0.93, "max": 0.74, "min": 2.98, "cnt": 128}, "fwd-misc":{"total": 24.18, "avg": 0.19, "max": 0.12, "min": 0.52, "cnt": 128}, "fwd-MLP":{"total": 2198.43, "avg": 17.18, "max": 10.08, "min": 219.90, "cnt": 128}, "MoE_L0_fwd":{"total": 1074.15, "avg": 33.57, "max": 12.45, "min": 219.81, "cnt": 32}, "MoEMLP":{"total": 2179.05, "avg": 17.02, "max": 9.96, "min": 219.76, "cnt": 128}, "MoE_L1_fwd":{"total": 376.98, "avg": 11.78, "max": 10.87, "min": 14.01, "cnt": 32}, "MoE_L2_fwd":{"total": 341.20, "avg": 10.66, "max": 10.01, "min": 12.63, "cnt": 32}, "MoE_L3_fwd":{"total": 393.78, "avg": 12.31, "max": 11.40, "min": 15.07, "cnt": 32}, "fwd-pooler":{"total": 0.37, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.68, "avg": 0.02, "max": 0.02, "min": 0.04, "cnt": 32}, "forward-send":{"total": 6.65, "avg": 3.33, "max": 1.07, "min": 5.59, "cnt": 2}, "forward-send-backward-recv":{"total": 350.20, "avg": 11.67, "max": 1.30, "min": 135.02, "cnt": 30}, "backward-compute":{"total": 1764.72, "avg": 55.15, "max": 52.87, "min": 58.30, "cnt": 32}, "MoE_L3_bwd":{"total": 449.73, "avg": 14.05, "max": 12.83, "min": 17.68, "cnt": 32}, "MoE_L2_bwd":{"total": 367.35, "avg": 11.48, "max": 10.34, "min": 15.73, "cnt": 32}, "MoE_L1_bwd":{"total": 359.32, "avg": 11.23, "max": 10.64, "min": 13.79, "cnt": 32}, "MoE_L0_bwd":{"total": 372.70, "avg": 11.65, "max": 10.99, "min": 13.18, "cnt": 32}, "backward-send-forward-recv":{"total": 11301.43, "avg": 389.70, "max": 1.94, "min": 1216.29, "cnt": 29}, "backward-send":{"total": 3.17, "avg": 1.06, "max": 0.99, "min": 1.09, "cnt": 3}, "backward-recv":{"total": 140.64, "avg": 70.32, "max": 69.82, "min": 70.82, "cnt": 2}, "backward-params-all-reduce":{"total": 494.67, "avg": 494.67, "max": 494.67, "min": 494.67, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.04, "avg": 0.04, "max": 0.04, "min": 0.04, "cnt": 1}, "optimizer":{"total": 242.95, "avg": 242.95, "max": 242.95, "min": 242.95, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.40, "avg": 3.40, "max": 3.40, "min": 3.40, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 197.43, "avg": 197.43, "max": 197.43, "min": 197.43, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.96, "avg": 6.96, "max": 6.96, "min": 6.96, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.47, "avg": 3.47, "max": 3.47, "min": 3.47, "cnt": 1}}}
{"type":"time", "iteration": 3, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.20, "avg": 0.20, "max": 0.20, "min": 0.20, "cnt": 1}, "forward-recv":{"total": 80.84, "avg": 26.95, "max": 1.16, "min": 76.65, "cnt": 3}, "forward-compute":{"total": 2973.99, "avg": 92.94, "max": 54.61, "min": 624.51, "cnt": 32}, "fwd-compute":{"total": 2969.73, "avg": 92.80, "max": 54.53, "min": 624.31, "cnt": 32}, "batch-generator":{"total": 704.41, "avg": 22.01, "max": 0.78, "min": 558.83, "cnt": 32}, "fwd-embedding":{"total": 0.73, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 2250.17, "avg": 70.32, "max": 53.40, "min": 144.86, "cnt": 32}, "fwd-layernorm":{"total": 12.22, "avg": 0.10, "max": 0.06, "min": 0.38, "cnt": 128}, "fwd-attn":{"total": 124.56, "avg": 0.97, "max": 0.74, "min": 4.01, "cnt": 128}, "fwd-misc":{"total": 25.53, "avg": 0.20, "max": 0.12, "min": 0.73, "cnt": 128}, "fwd-MLP":{"total": 2062.58, "avg": 16.11, "max": 11.85, "min": 99.94, "cnt": 128}, "MoE_L0_fwd":{"total": 825.18, "avg": 25.79, "max": 12.21, "min": 99.82, "cnt": 32}, "MoEMLP":{"total": 2042.92, "avg": 15.96, "max": 11.73, "min": 99.77, "cnt": 128}, "MoE_L1_fwd":{"total": 418.46, "avg": 13.08, "max": 12.01, "min": 16.50, "cnt": 32}, "MoE_L2_fwd":{"total": 408.38, "avg": 12.76, "max": 12.11, "min": 14.70, "cnt": 32}, "MoE_L3_fwd":{"total": 398.07, "avg": 12.44, "max": 11.77, "min": 13.82, "cnt": 32}, "fwd-pooler":{"total": 0.38, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.64, "avg": 0.02, "max": 0.02, "min": 0.04, "cnt": 32}, "forward-send":{"total": 1.86, "avg": 0.93, "max": 0.92, "min": 0.94, "cnt": 2}, "forward-send-backward-recv":{"total": 177.17, "avg": 5.91, "max": 1.00, "min": 110.37, "cnt": 30}, "backward-compute":{"total": 1966.51, "avg": 61.45, "max": 58.91, "min": 64.38, "cnt": 32}, "MoE_L3_bwd":{"total": 439.34, "avg": 13.73, "max": 12.85, "min": 17.16, "cnt": 32}, "MoE_L2_bwd":{"total": 464.40, "avg": 14.51, "max": 13.96, "min": 15.21, "cnt": 32}, "MoE_L1_bwd":{"total": 454.74, "avg": 14.21, "max": 13.39, "min": 15.34, "cnt": 32}, "MoE_L0_bwd":{"total": 386.30, "avg": 12.07, "max": 11.21, "min": 14.02, "cnt": 32}, "backward-send-forward-recv":{"total": 8801.77, "avg": 303.51, "max": 2.03, "min": 1770.31, "cnt": 29}, "backward-send":{"total": 2.81, "avg": 0.94, "max": 0.87, "min": 0.98, "cnt": 3}, "backward-recv":{"total": 130.26, "avg": 65.13, "max": 61.56, "min": 68.70, "cnt": 2}, "backward-params-all-reduce":{"total": 492.60, "avg": 492.60, "max": 492.60, "min": 492.60, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.05, "avg": 0.05, "max": 0.05, "min": 0.05, "cnt": 1}, "optimizer":{"total": 247.82, "avg": 247.82, "max": 247.82, "min": 247.82, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 202.31, "avg": 202.31, "max": 202.31, "min": 202.31, "cnt": 1}, "optimizer-clip-main-grad":{"total": 7.41, "avg": 7.41, "max": 7.41, "min": 7.41, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.58, "avg": 3.58, "max": 3.58, "min": 3.58, "cnt": 1}}}
{"type":"time", "iteration": 4, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.12, "avg": 0.12, "max": 0.12, "min": 0.12, "cnt": 1}, "forward-recv":{"total": 351.40, "avg": 117.13, "max": 1.45, "min": 280.07, "cnt": 3}, "forward-compute":{"total": 2610.47, "avg": 81.58, "max": 58.29, "min": 300.27, "cnt": 32}, "fwd-compute":{"total": 2606.63, "avg": 81.46, "max": 58.20, "min": 300.19, "cnt": 32}, "batch-generator":{"total": 136.11, "avg": 4.25, "max": 0.76, "min": 75.31, "cnt": 32}, "fwd-embedding":{"total": 0.65, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 2456.42, "avg": 76.76, "max": 53.10, "min": 297.92, "cnt": 32}, "fwd-layernorm":{"total": 11.20, "avg": 0.09, "max": 0.06, "min": 0.40, "cnt": 128}, "fwd-attn":{"total": 116.25, "avg": 0.91, "max": 0.74, "min": 3.20, "cnt": 128}, "fwd-misc":{"total": 22.40, "avg": 0.17, "max": 0.11, "min": 0.54, "cnt": 128}, "fwd-MLP":{"total": 2283.18, "avg": 17.84, "max": 10.95, "min": 256.52, "cnt": 128}, "MoE_L0_fwd":{"total": 1096.12, "avg": 34.25, "max": 12.33, "min": 256.43, "cnt": 32}, "MoEMLP":{"total": 2265.53, "avg": 17.70, "max": 10.85, "min": 256.38, "cnt": 128}, "MoE_L1_fwd":{"total": 401.80, "avg": 12.56, "max": 11.28, "min": 16.55, "cnt": 32}, "MoE_L2_fwd":{"total": 413.46, "avg": 12.92, "max": 12.14, "min": 16.81, "cnt": 32}, "MoE_L3_fwd":{"total": 360.62, "avg": 11.27, "max": 10.88, "min": 11.82, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.97, "avg": 0.99, "max": 0.97, "min": 1.00, "cnt": 2}, "forward-send-backward-recv":{"total": 172.71, "avg": 5.76, "max": 1.03, "min": 46.28, "cnt": 30}, "backward-compute":{"total": 1772.39, "avg": 55.39, "max": 52.58, "min": 58.13, "cnt": 32}, "MoE_L3_bwd":{"total": 431.18, "avg": 13.47, "max": 12.35, "min": 15.41, "cnt": 32}, "MoE_L2_bwd":{"total": 398.61, "avg": 12.46, "max": 11.75, "min": 13.22, "cnt": 32}, "MoE_L1_bwd":{"total": 341.44, "avg": 10.67, "max": 10.23, "min": 13.26, "cnt": 32}, "MoE_L0_bwd":{"total": 375.51, "avg": 11.73, "max": 11.08, "min": 14.18, "cnt": 32}, "backward-send-forward-recv":{"total": 11093.59, "avg": 382.54, "max": 2.07, "min": 1366.45, "cnt": 29}, "backward-send":{"total": 3.30, "avg": 1.10, "max": 0.95, "min": 1.19, "cnt": 3}, "backward-recv":{"total": 849.09, "avg": 424.55, "max": 126.07, "min": 723.02, "cnt": 2}, "backward-params-all-reduce":{"total": 496.03, "avg": 496.03, "max": 496.03, "min": 496.03, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.04, "avg": 0.04, "max": 0.04, "min": 0.04, "cnt": 1}, "optimizer":{"total": 246.74, "avg": 246.74, "max": 246.74, "min": 246.74, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 202.22, "avg": 202.22, "max": 202.22, "min": 202.22, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.88, "avg": 6.88, "max": 6.88, "min": 6.88, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.54, "avg": 3.54, "max": 3.54, "min": 3.54, "cnt": 1}}}
{"type":"time", "iteration": 5, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 323.80, "avg": 107.93, "max": 5.10, "min": 247.20, "cnt": 3}, "forward-compute":{"total": 2242.82, "avg": 70.09, "max": 54.88, "min": 176.48, "cnt": 32}, "fwd-compute":{"total": 2239.34, "avg": 69.98, "max": 54.80, "min": 176.39, "cnt": 32}, "batch-generator":{"total": 93.53, "avg": 2.92, "max": 0.72, "min": 36.18, "cnt": 32}, "fwd-embedding":{"total": 0.70, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 2131.95, "avg": 66.62, "max": 53.58, "min": 173.34, "cnt": 32}, "fwd-layernorm":{"total": 10.99, "avg": 0.09, "max": 0.05, "min": 0.29, "cnt": 128}, "fwd-attn":{"total": 114.39, "avg": 0.89, "max": 0.73, "min": 2.38, "cnt": 128}, "fwd-misc":{"total": 23.25, "avg": 0.18, "max": 0.11, "min": 0.46, "cnt": 128}, "fwd-MLP":{"total": 1960.70, "avg": 15.32, "max": 10.67, "min": 130.85, "cnt": 128}, "MoE_L0_fwd":{"total": 768.11, "avg": 24.00, "max": 12.66, "min": 130.77, "cnt": 32}, "MoEMLP":{"total": 1942.47, "avg": 15.18, "max": 10.56, "min": 130.72, "cnt": 128}, "MoE_L1_fwd":{"total": 427.45, "avg": 13.36, "max": 12.17, "min": 16.68, "cnt": 32}, "MoE_L2_fwd":{"total": 400.52, "avg": 12.52, "max": 12.00, "min": 14.03, "cnt": 32}, "MoE_L3_fwd":{"total": 353.10, "avg": 11.03, "max": 10.60, "min": 12.89, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.61, "avg": 0.81, "max": 0.77, "min": 0.85, "cnt": 2}, "forward-send-backward-recv":{"total": 150.81, "avg": 5.03, "max": 1.37, "min": 14.33, "cnt": 30}, "backward-compute":{"total": 1817.68, "avg": 56.80, "max": 54.48, "min": 59.96, "cnt": 32}, "MoE_L3_bwd":{"total": 402.84, "avg": 12.59, "max": 10.42, "min": 13.63, "cnt": 32}, "MoE_L2_bwd":{"total": 414.36, "avg": 12.95, "max": 12.35, "min": 14.09, "cnt": 32}, "MoE_L1_bwd":{"total": 408.51, "avg": 12.77, "max": 12.16, "min": 14.57, "cnt": 32}, "MoE_L0_bwd":{"total": 372.32, "avg": 11.64, "max": 11.00, "min": 14.12, "cnt": 32}, "backward-send-forward-recv":{"total": 7333.34, "avg": 252.87, "max": 1.76, "min": 858.64, "cnt": 29}, "backward-send":{"total": 3.26, "avg": 1.09, "max": 1.06, "min": 1.10, "cnt": 3}, "backward-recv":{"total": 137.60, "avg": 68.80, "max": 67.72, "min": 69.88, "cnt": 2}, "backward-params-all-reduce":{"total": 489.35, "avg": 489.35, "max": 489.35, "min": 489.35, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 247.99, "avg": 247.99, "max": 247.99, "min": 247.99, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.47, "avg": 3.47, "max": 3.47, "min": 3.47, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 203.60, "avg": 203.60, "max": 203.60, "min": 203.60, "cnt": 1}, "optimizer-clip-main-grad":{"total": 7.04, "avg": 7.04, "max": 7.04, "min": 7.04, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.47, "avg": 3.47, "max": 3.47, "min": 3.47, "cnt": 1}}}
{"type":"time", "iteration": 6, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.11, "avg": 0.11, "max": 0.11, "min": 0.11, "cnt": 1}, "forward-recv":{"total": 77.27, "avg": 25.76, "max": 1.37, "min": 74.36, "cnt": 3}, "forward-compute":{"total": 2066.88, "avg": 64.59, "max": 55.17, "min": 131.65, "cnt": 32}, "fwd-compute":{"total": 2063.45, "avg": 64.48, "max": 55.09, "min": 131.57, "cnt": 32}, "batch-generator":{"total": 48.92, "avg": 1.53, "max": 0.65, "min": 3.71, "cnt": 32}, "fwd-embedding":{"total": 0.71, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 2001.58, "avg": 62.55, "max": 54.12, "min": 129.57, "cnt": 32}, "fwd-layernorm":{"total": 10.64, "avg": 0.08, "max": 0.06, "min": 0.29, "cnt": 128}, "fwd-attn":{"total": 113.11, "avg": 0.88, "max": 0.73, "min": 2.98, "cnt": 128}, "fwd-misc":{"total": 22.46, "avg": 0.18, "max": 0.11, "min": 0.48, "cnt": 128}, "fwd-MLP":{"total": 1833.23, "avg": 14.32, "max": 10.72, "min": 84.82, "cnt": 128}, "MoE_L0_fwd":{"total": 651.44, "avg": 20.36, "max": 12.78, "min": 84.69, "cnt": 32}, "MoEMLP":{"total": 1815.69, "avg": 14.19, "max": 10.62, "min": 84.62, "cnt": 128}, "MoE_L1_fwd":{"total": 436.33, "avg": 13.64, "max": 12.57, "min": 16.56, "cnt": 32}, "MoE_L2_fwd":{"total": 370.81, "avg": 11.59, "max": 11.05, "min": 12.85, "cnt": 32}, "MoE_L3_fwd":{"total": 363.44, "avg": 11.36, "max": 10.66, "min": 13.58, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.56, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.70, "avg": 0.85, "max": 0.82, "min": 0.88, "cnt": 2}, "forward-send-backward-recv":{"total": 1287.99, "avg": 42.93, "max": 1.80, "min": 358.88, "cnt": 30}, "backward-compute":{"total": 1906.20, "avg": 59.57, "max": 56.72, "min": 62.23, "cnt": 32}, "MoE_L3_bwd":{"total": 408.82, "avg": 12.78, "max": 11.15, "min": 14.19, "cnt": 32}, "MoE_L2_bwd":{"total": 371.99, "avg": 11.62, "max": 11.22, "min": 12.40, "cnt": 32}, "MoE_L1_bwd":{"total": 438.46, "avg": 13.70, "max": 13.03, "min": 14.53, "cnt": 32}, "MoE_L0_bwd":{"total": 459.63, "avg": 14.36, "max": 13.72, "min": 16.23, "cnt": 32}, "backward-send-forward-recv":{"total": 6698.04, "avg": 230.97, "max": 1.72, "min": 848.72, "cnt": 29}, "backward-send":{"total": 2.70, "avg": 0.90, "max": 0.70, "min": 1.05, "cnt": 3}, "backward-recv":{"total": 450.17, "avg": 225.09, "max": 148.29, "min": 301.88, "cnt": 2}, "backward-params-all-reduce":{"total": 483.84, "avg": 483.84, "max": 483.84, "min": 483.84, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 246.42, "avg": 246.42, "max": 246.42, "min": 246.42, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 201.43, "avg": 201.43, "max": 201.43, "min": 201.43, "cnt": 1}, "optimizer-clip-main-grad":{"total": 7.60, "avg": 7.60, "max": 7.60, "min": 7.60, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 7, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 82.14, "avg": 27.38, "max": 1.22, "min": 79.57, "cnt": 3}, "forward-compute":{"total": 2042.89, "avg": 63.84, "max": 58.87, "min": 66.84, "cnt": 32}, "fwd-compute":{"total": 2039.20, "avg": 63.73, "max": 58.77, "min": 66.71, "cnt": 32}, "batch-generator":{"total": 58.05, "avg": 1.81, "max": 0.68, "min": 4.01, "cnt": 32}, "fwd-embedding":{"total": 0.70, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1967.91, "avg": 61.50, "max": 56.97, "min": 64.77, "cnt": 32}, "fwd-layernorm":{"total": 10.63, "avg": 0.08, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 111.05, "avg": 0.87, "max": 0.74, "min": 1.60, "cnt": 128}, "fwd-misc":{"total": 22.41, "avg": 0.18, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1801.19, "avg": 14.07, "max": 11.22, "min": 21.99, "cnt": 128}, "MoE_L0_fwd":{"total": 555.67, "avg": 17.36, "max": 14.52, "min": 21.91, "cnt": 32}, "MoEMLP":{"total": 1782.98, "avg": 13.93, "max": 11.08, "min": 21.87, "cnt": 128}, "MoE_L1_fwd":{"total": 387.09, "avg": 12.10, "max": 11.13, "min": 13.79, "cnt": 32}, "MoE_L2_fwd":{"total": 444.13, "avg": 13.88, "max": 13.42, "min": 15.06, "cnt": 32}, "MoE_L3_fwd":{"total": 402.53, "avg": 12.58, "max": 12.05, "min": 14.35, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 5.63, "avg": 2.81, "max": 0.85, "min": 4.78, "cnt": 2}, "forward-send-backward-recv":{"total": 171.45, "avg": 5.72, "max": 1.06, "min": 116.27, "cnt": 30}, "backward-compute":{"total": 2099.51, "avg": 65.61, "max": 64.48, "min": 67.18, "cnt": 32}, "MoE_L3_bwd":{"total": 450.06, "avg": 14.06, "max": 13.39, "min": 15.36, "cnt": 32}, "MoE_L2_bwd":{"total": 530.37, "avg": 16.57, "max": 15.50, "min": 17.35, "cnt": 32}, "MoE_L1_bwd":{"total": 374.12, "avg": 11.69, "max": 11.04, "min": 12.16, "cnt": 32}, "MoE_L0_bwd":{"total": 518.23, "avg": 16.19, "max": 15.79, "min": 16.86, "cnt": 32}, "backward-send-forward-recv":{"total": 9913.58, "avg": 341.85, "max": 1.39, "min": 1357.44, "cnt": 29}, "backward-send":{"total": 2.60, "avg": 0.87, "max": 0.71, "min": 1.06, "cnt": 3}, "backward-recv":{"total": 102.51, "avg": 51.26, "max": 50.23, "min": 52.29, "cnt": 2}, "backward-params-all-reduce":{"total": 490.81, "avg": 490.81, "max": 490.81, "min": 490.81, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 248.37, "avg": 248.37, "max": 248.37, "min": 248.37, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 203.27, "avg": 203.27, "max": 203.27, "min": 203.27, "cnt": 1}, "optimizer-clip-main-grad":{"total": 7.84, "avg": 7.84, "max": 7.84, "min": 7.84, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 8, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 77.43, "avg": 25.81, "max": 0.90, "min": 75.52, "cnt": 3}, "forward-compute":{"total": 1980.75, "avg": 61.90, "max": 55.01, "min": 71.19, "cnt": 32}, "fwd-compute":{"total": 1977.31, "avg": 61.79, "max": 54.94, "min": 71.10, "cnt": 32}, "batch-generator":{"total": 46.04, "avg": 1.44, "max": 0.66, "min": 3.05, "cnt": 32}, "fwd-embedding":{"total": 0.63, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1918.32, "avg": 59.95, "max": 53.98, "min": 69.50, "cnt": 32}, "fwd-layernorm":{"total": 10.41, "avg": 0.08, "max": 0.05, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 112.82, "avg": 0.88, "max": 0.74, "min": 1.59, "cnt": 128}, "fwd-misc":{"total": 22.41, "avg": 0.18, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1750.14, "avg": 13.67, "max": 10.86, "min": 18.88, "cnt": 128}, "MoE_L0_fwd":{"total": 484.89, "avg": 15.15, "max": 11.30, "min": 18.77, "cnt": 32}, "MoEMLP":{"total": 1731.94, "avg": 13.53, "max": 10.74, "min": 18.72, "cnt": 128}, "MoE_L1_fwd":{"total": 395.15, "avg": 12.35, "max": 10.78, "min": 14.50, "cnt": 32}, "MoE_L2_fwd":{"total": 464.66, "avg": 14.52, "max": 13.95, "min": 18.33, "cnt": 32}, "MoE_L3_fwd":{"total": 393.73, "avg": 12.30, "max": 11.53, "min": 13.93, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 11.28, "avg": 5.64, "max": 0.94, "min": 10.34, "cnt": 2}, "forward-send-backward-recv":{"total": 212.89, "avg": 7.10, "max": 1.21, "min": 125.02, "cnt": 30}, "backward-compute":{"total": 1921.62, "avg": 60.05, "max": 57.16, "min": 63.39, "cnt": 32}, "MoE_L3_bwd":{"total": 448.14, "avg": 14.00, "max": 12.60, "min": 17.74, "cnt": 32}, "MoE_L2_bwd":{"total": 522.21, "avg": 16.32, "max": 15.77, "min": 17.57, "cnt": 32}, "MoE_L1_bwd":{"total": 371.05, "avg": 11.60, "max": 10.75, "min": 12.99, "cnt": 32}, "MoE_L0_bwd":{"total": 362.27, "avg": 11.32, "max": 10.27, "min": 12.12, "cnt": 32}, "backward-send-forward-recv":{"total": 8733.70, "avg": 301.16, "max": 1.37, "min": 1548.66, "cnt": 29}, "backward-send":{"total": 2.52, "avg": 0.84, "max": 0.50, "min": 1.34, "cnt": 3}, "backward-recv":{"total": 147.39, "avg": 73.69, "max": 68.28, "min": 79.11, "cnt": 2}, "backward-params-all-reduce":{"total": 494.11, "avg": 494.11, "max": 494.11, "min": 494.11, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 243.88, "avg": 243.88, "max": 243.88, "min": 243.88, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 199.69, "avg": 199.69, "max": 199.69, "min": 199.69, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.89, "avg": 6.89, "max": 6.89, "min": 6.89, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 9, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.11, "avg": 0.11, "max": 0.11, "min": 0.11, "cnt": 1}, "forward-recv":{"total": 249.92, "avg": 83.31, "max": 6.64, "min": 161.66, "cnt": 3}, "forward-compute":{"total": 1956.92, "avg": 61.15, "max": 53.71, "min": 70.31, "cnt": 32}, "fwd-compute":{"total": 1953.65, "avg": 61.05, "max": 53.62, "min": 70.21, "cnt": 32}, "batch-generator":{"total": 42.69, "avg": 1.33, "max": 0.67, "min": 3.38, "cnt": 32}, "fwd-embedding":{"total": 0.55, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1898.31, "avg": 59.32, "max": 52.59, "min": 66.62, "cnt": 32}, "fwd-layernorm":{"total": 9.64, "avg": 0.08, "max": 0.06, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 107.14, "avg": 0.84, "max": 0.74, "min": 1.65, "cnt": 128}, "fwd-misc":{"total": 20.82, "avg": 0.16, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1739.12, "avg": 13.59, "max": 10.83, "min": 22.61, "cnt": 128}, "MoE_L0_fwd":{"total": 545.18, "avg": 17.04, "max": 12.58, "min": 22.43, "cnt": 32}, "MoEMLP":{"total": 1721.64, "avg": 13.45, "max": 10.73, "min": 22.36, "cnt": 128}, "MoE_L1_fwd":{"total": 396.80, "avg": 12.40, "max": 11.22, "min": 13.73, "cnt": 32}, "MoE_L2_fwd":{"total": 383.27, "avg": 11.98, "max": 10.77, "min": 15.12, "cnt": 32}, "MoE_L3_fwd":{"total": 402.55, "avg": 12.58, "max": 11.67, "min": 14.74, "cnt": 32}, "fwd-pooler":{"total": 0.36, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.61, "avg": 0.02, "max": 0.02, "min": 0.05, "cnt": 32}, "forward-send":{"total": 1.81, "avg": 0.90, "max": 0.89, "min": 0.92, "cnt": 2}, "forward-send-backward-recv":{"total": 878.23, "avg": 29.27, "max": 1.17, "min": 428.94, "cnt": 30}, "backward-compute":{"total": 1958.98, "avg": 61.22, "max": 50.99, "min": 254.32, "cnt": 32}, "MoE_L3_bwd":{"total": 467.89, "avg": 14.62, "max": 12.90, "min": 18.68, "cnt": 32}, "MoE_L2_bwd":{"total": 370.34, "avg": 11.57, "max": 10.57, "min": 14.35, "cnt": 32}, "MoE_L1_bwd":{"total": 402.84, "avg": 12.59, "max": 10.53, "min": 56.43, "cnt": 32}, "MoE_L0_bwd":{"total": 501.27, "avg": 15.66, "max": 9.83, "min": 162.29, "cnt": 32}, "backward-send-forward-recv":{"total": 8299.09, "avg": 286.18, "max": 1.04, "min": 1151.40, "cnt": 29}, "backward-send":{"total": 2.87, "avg": 0.96, "max": 0.75, "min": 1.06, "cnt": 3}, "backward-recv":{"total": 420.72, "avg": 210.36, "max": 76.34, "min": 344.37, "cnt": 2}, "backward-params-all-reduce":{"total": 491.16, "avg": 491.16, "max": 491.16, "min": 491.16, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.04, "avg": 0.04, "max": 0.04, "min": 0.04, "cnt": 1}, "optimizer":{"total": 213.32, "avg": 213.32, "max": 213.32, "min": 213.32, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 206.36, "avg": 206.36, "max": 206.36, "min": 206.36, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.47, "avg": 3.47, "max": 3.47, "min": 3.47, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}}}
{"type":"time", "iteration": 10, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.10, "avg": 0.10, "max": 0.10, "min": 0.10, "cnt": 1}, "forward-recv":{"total": 82.35, "avg": 27.45, "max": 4.32, "min": 71.89, "cnt": 3}, "forward-compute":{"total": 1956.64, "avg": 61.14, "max": 53.93, "min": 69.25, "cnt": 32}, "fwd-compute":{"total": 1953.47, "avg": 61.05, "max": 53.85, "min": 69.09, "cnt": 32}, "batch-generator":{"total": 46.26, "avg": 1.45, "max": 0.64, "min": 3.42, "cnt": 32}, "fwd-embedding":{"total": 0.61, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1894.35, "avg": 59.20, "max": 52.74, "min": 65.26, "cnt": 32}, "fwd-layernorm":{"total": 10.13, "avg": 0.08, "max": 0.06, "min": 0.22, "cnt": 128}, "fwd-attn":{"total": 108.43, "avg": 0.85, "max": 0.74, "min": 1.69, "cnt": 128}, "fwd-misc":{"total": 21.38, "avg": 0.17, "max": 0.11, "min": 0.43, "cnt": 128}, "fwd-MLP":{"total": 1732.84, "avg": 13.54, "max": 10.93, "min": 19.59, "cnt": 128}, "MoE_L0_fwd":{"total": 526.38, "avg": 16.45, "max": 12.45, "min": 19.50, "cnt": 32}, "MoEMLP":{"total": 1715.82, "avg": 13.40, "max": 10.80, "min": 19.45, "cnt": 128}, "MoE_L1_fwd":{"total": 409.83, "avg": 12.81, "max": 11.51, "min": 15.74, "cnt": 32}, "MoE_L2_fwd":{"total": 386.67, "avg": 12.08, "max": 10.85, "min": 14.53, "cnt": 32}, "MoE_L3_fwd":{"total": 399.25, "avg": 12.48, "max": 11.78, "min": 13.46, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.84, "avg": 0.92, "max": 0.91, "min": 0.93, "cnt": 2}, "forward-send-backward-recv":{"total": 990.06, "avg": 33.00, "max": 1.47, "min": 267.37, "cnt": 30}, "backward-compute":{"total": 1749.35, "avg": 54.67, "max": 53.00, "min": 57.60, "cnt": 32}, "MoE_L3_bwd":{"total": 455.39, "avg": 14.23, "max": 13.27, "min": 17.54, "cnt": 32}, "MoE_L2_bwd":{"total": 369.15, "avg": 11.54, "max": 10.37, "min": 13.76, "cnt": 32}, "MoE_L1_bwd":{"total": 359.14, "avg": 11.22, "max": 10.58, "min": 13.56, "cnt": 32}, "MoE_L0_bwd":{"total": 352.87, "avg": 11.03, "max": 10.24, "min": 11.76, "cnt": 32}, "backward-send-forward-recv":{"total": 6146.69, "avg": 211.95, "max": 2.23, "min": 902.95, "cnt": 29}, "backward-send":{"total": 3.45, "avg": 1.15, "max": 1.10, "min": 1.18, "cnt": 3}, "backward-recv":{"total": 142.86, "avg": 71.43, "max": 69.54, "min": 73.32, "cnt": 2}, "backward-params-all-reduce":{"total": 489.74, "avg": 489.74, "max": 489.74, "min": 489.74, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 228.70, "avg": 228.70, "max": 228.70, "min": 228.70, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 205.52, "avg": 205.52, "max": 205.52, "min": 205.52, "cnt": 1}, "optimizer-clip-main-grad":{"total": 19.39, "avg": 19.39, "max": 19.39, "min": 19.39, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}}}
{"type":"time", "iteration": 11, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.10, "avg": 0.10, "max": 0.10, "min": 0.10, "cnt": 1}, "forward-recv":{"total": 71.14, "avg": 23.71, "max": 0.71, "min": 68.95, "cnt": 3}, "forward-compute":{"total": 1978.92, "avg": 61.84, "max": 53.53, "min": 71.43, "cnt": 32}, "fwd-compute":{"total": 1975.55, "avg": 61.74, "max": 53.42, "min": 71.34, "cnt": 32}, "batch-generator":{"total": 51.43, "avg": 1.61, "max": 0.67, "min": 4.15, "cnt": 32}, "fwd-embedding":{"total": 0.55, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1912.00, "avg": 59.75, "max": 52.26, "min": 69.42, "cnt": 32}, "fwd-layernorm":{"total": 9.74, "avg": 0.08, "max": 0.06, "min": 0.31, "cnt": 128}, "fwd-attn":{"total": 109.96, "avg": 0.86, "max": 0.74, "min": 2.50, "cnt": 128}, "fwd-misc":{"total": 20.94, "avg": 0.16, "max": 0.11, "min": 0.49, "cnt": 128}, "fwd-MLP":{"total": 1749.29, "avg": 13.67, "max": 10.86, "min": 25.29, "cnt": 128}, "MoE_L0_fwd":{"total": 538.54, "avg": 16.83, "max": 12.40, "min": 25.13, "cnt": 32}, "MoEMLP":{"total": 1732.40, "avg": 13.53, "max": 10.76, "min": 25.08, "cnt": 128}, "MoE_L1_fwd":{"total": 403.71, "avg": 12.62, "max": 11.28, "min": 18.55, "cnt": 32}, "MoE_L2_fwd":{"total": 388.24, "avg": 12.13, "max": 10.80, "min": 14.54, "cnt": 32}, "MoE_L3_fwd":{"total": 408.07, "avg": 12.75, "max": 11.73, "min": 16.81, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.04, "cnt": 32}, "forward-send":{"total": 8.23, "avg": 4.11, "max": 0.90, "min": 7.33, "cnt": 2}, "forward-send-backward-recv":{"total": 192.05, "avg": 6.40, "max": 1.62, "min": 125.43, "cnt": 30}, "backward-compute":{"total": 1736.21, "avg": 54.26, "max": 51.37, "min": 56.97, "cnt": 32}, "MoE_L3_bwd":{"total": 450.44, "avg": 14.08, "max": 13.18, "min": 17.06, "cnt": 32}, "MoE_L2_bwd":{"total": 367.25, "avg": 11.48, "max": 10.39, "min": 12.34, "cnt": 32}, "MoE_L1_bwd":{"total": 353.40, "avg": 11.04, "max": 10.76, "min": 11.62, "cnt": 32}, "MoE_L0_bwd":{"total": 349.96, "avg": 10.94, "max": 9.78, "min": 14.15, "cnt": 32}, "backward-send-forward-recv":{"total": 7298.31, "avg": 251.67, "max": 2.28, "min": 858.57, "cnt": 29}, "backward-send":{"total": 2.70, "avg": 0.90, "max": 0.79, "min": 1.10, "cnt": 3}, "backward-recv":{"total": 239.63, "avg": 119.81, "max": 63.92, "min": 175.70, "cnt": 2}, "backward-params-all-reduce":{"total": 490.52, "avg": 490.52, "max": 490.52, "min": 490.52, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 215.41, "avg": 215.41, "max": 215.41, "min": 215.41, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 205.17, "avg": 205.17, "max": 205.17, "min": 205.17, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.68, "avg": 6.68, "max": 6.68, "min": 6.68, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}}}
{"type":"time", "iteration": 12, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 76.98, "avg": 25.66, "max": 1.16, "min": 69.09, "cnt": 3}, "forward-compute":{"total": 1959.90, "avg": 61.25, "max": 53.46, "min": 74.77, "cnt": 32}, "fwd-compute":{"total": 1956.73, "avg": 61.15, "max": 53.40, "min": 74.68, "cnt": 32}, "batch-generator":{"total": 60.26, "avg": 1.88, "max": 0.67, "min": 5.28, "cnt": 32}, "fwd-embedding":{"total": 0.52, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1884.05, "avg": 58.88, "max": 51.85, "min": 71.90, "cnt": 32}, "fwd-layernorm":{"total": 9.44, "avg": 0.07, "max": 0.05, "min": 0.29, "cnt": 128}, "fwd-attn":{"total": 106.14, "avg": 0.83, "max": 0.74, "min": 2.33, "cnt": 128}, "fwd-misc":{"total": 20.50, "avg": 0.16, "max": 0.11, "min": 0.46, "cnt": 128}, "fwd-MLP":{"total": 1727.37, "avg": 13.50, "max": 11.12, "min": 25.72, "cnt": 128}, "MoE_L0_fwd":{"total": 507.63, "avg": 15.86, "max": 11.70, "min": 25.62, "cnt": 32}, "MoEMLP":{"total": 1710.30, "avg": 13.36, "max": 11.02, "min": 25.58, "cnt": 128}, "MoE_L1_fwd":{"total": 399.35, "avg": 12.48, "max": 11.35, "min": 13.95, "cnt": 32}, "MoE_L2_fwd":{"total": 395.53, "avg": 12.36, "max": 11.06, "min": 16.57, "cnt": 32}, "MoE_L3_fwd":{"total": 413.97, "avg": 12.94, "max": 11.79, "min": 19.45, "cnt": 32}, "fwd-pooler":{"total": 0.37, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.61, "avg": 0.02, "max": 0.02, "min": 0.05, "cnt": 32}, "forward-send":{"total": 1.93, "avg": 0.97, "max": 0.93, "min": 1.00, "cnt": 2}, "forward-send-backward-recv":{"total": 298.00, "avg": 9.93, "max": 1.28, "min": 132.77, "cnt": 30}, "backward-compute":{"total": 1729.92, "avg": 54.06, "max": 49.07, "min": 58.93, "cnt": 32}, "MoE_L3_bwd":{"total": 449.40, "avg": 14.04, "max": 12.06, "min": 16.52, "cnt": 32}, "MoE_L2_bwd":{"total": 365.91, "avg": 11.43, "max": 10.08, "min": 14.93, "cnt": 32}, "MoE_L1_bwd":{"total": 357.32, "avg": 11.17, "max": 10.51, "min": 12.05, "cnt": 32}, "MoE_L0_bwd":{"total": 344.46, "avg": 10.76, "max": 9.77, "min": 11.83, "cnt": 32}, "backward-send-forward-recv":{"total": 8011.94, "avg": 276.27, "max": 1.87, "min": 996.77, "cnt": 29}, "backward-send":{"total": 2.83, "avg": 0.94, "max": 0.82, "min": 1.06, "cnt": 3}, "backward-recv":{"total": 151.56, "avg": 75.78, "max": 71.02, "min": 80.54, "cnt": 2}, "backward-params-all-reduce":{"total": 486.94, "avg": 486.94, "max": 486.94, "min": 486.94, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 222.68, "avg": 222.68, "max": 222.68, "min": 222.68, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 212.11, "avg": 212.11, "max": 212.11, "min": 212.11, "cnt": 1}, "optimizer-clip-main-grad":{"total": 7.03, "avg": 7.03, "max": 7.03, "min": 7.03, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}}}
{"type":"time", "iteration": 13, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.10, "avg": 0.10, "max": 0.10, "min": 0.10, "cnt": 1}, "forward-recv":{"total": 86.07, "avg": 28.69, "max": 1.36, "min": 76.87, "cnt": 3}, "forward-compute":{"total": 1967.80, "avg": 61.49, "max": 53.13, "min": 70.40, "cnt": 32}, "fwd-compute":{"total": 1964.46, "avg": 61.39, "max": 53.05, "min": 70.32, "cnt": 32}, "batch-generator":{"total": 54.54, "avg": 1.70, "max": 0.71, "min": 4.31, "cnt": 32}, "fwd-embedding":{"total": 0.79, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1896.38, "avg": 59.26, "max": 51.36, "min": 69.04, "cnt": 32}, "fwd-layernorm":{"total": 11.07, "avg": 0.09, "max": 0.06, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 114.11, "avg": 0.89, "max": 0.74, "min": 1.88, "cnt": 128}, "fwd-misc":{"total": 22.55, "avg": 0.18, "max": 0.11, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1724.45, "avg": 13.47, "max": 10.68, "min": 21.65, "cnt": 128}, "MoE_L0_fwd":{"total": 521.56, "avg": 16.30, "max": 12.18, "min": 21.41, "cnt": 32}, "MoEMLP":{"total": 1706.12, "avg": 13.33, "max": 10.58, "min": 21.35, "cnt": 128}, "MoE_L1_fwd":{"total": 405.42, "avg": 12.67, "max": 11.15, "min": 15.91, "cnt": 32}, "MoE_L2_fwd":{"total": 386.09, "avg": 12.07, "max": 10.61, "min": 17.60, "cnt": 32}, "MoE_L3_fwd":{"total": 399.79, "avg": 12.49, "max": 11.77, "min": 18.31, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 4.14, "avg": 2.07, "max": 0.79, "min": 3.36, "cnt": 2}, "forward-send-backward-recv":{"total": 205.46, "avg": 6.85, "max": 1.10, "min": 118.12, "cnt": 30}, "backward-compute":{"total": 1745.50, "avg": 54.55, "max": 50.27, "min": 61.20, "cnt": 32}, "MoE_L3_bwd":{"total": 463.40, "avg": 14.48, "max": 12.94, "min": 17.90, "cnt": 32}, "MoE_L2_bwd":{"total": 359.89, "avg": 11.25, "max": 10.48, "min": 12.17, "cnt": 32}, "MoE_L1_bwd":{"total": 360.26, "avg": 11.26, "max": 10.31, "min": 14.78, "cnt": 32}, "MoE_L0_bwd":{"total": 350.73, "avg": 10.96, "max": 10.03, "min": 14.34, "cnt": 32}, "backward-send-forward-recv":{"total": 7591.86, "avg": 261.79, "max": 1.83, "min": 1089.96, "cnt": 29}, "backward-send":{"total": 3.27, "avg": 1.09, "max": 1.06, "min": 1.13, "cnt": 3}, "backward-recv":{"total": 122.04, "avg": 61.02, "max": 56.46, "min": 65.57, "cnt": 2}, "backward-params-all-reduce":{"total": 488.61, "avg": 488.61, "max": 488.61, "min": 488.61, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 246.31, "avg": 246.31, "max": 246.31, "min": 246.31, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 202.05, "avg": 202.05, "max": 202.05, "min": 202.05, "cnt": 1}, "optimizer-clip-main-grad":{"total": 7.07, "avg": 7.07, "max": 7.07, "min": 7.07, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}}}
{"type":"time", "iteration": 14, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 70.44, "avg": 23.48, "max": 1.20, "min": 67.73, "cnt": 3}, "forward-compute":{"total": 1904.17, "avg": 59.51, "max": 50.69, "min": 68.93, "cnt": 32}, "fwd-compute":{"total": 1900.88, "avg": 59.40, "max": 50.61, "min": 68.84, "cnt": 32}, "batch-generator":{"total": 46.84, "avg": 1.46, "max": 0.68, "min": 3.53, "cnt": 32}, "fwd-embedding":{"total": 0.71, "avg": 0.02, "max": 0.01, "min": 0.06, "cnt": 32}, "fwd-encoder":{"total": 1841.30, "avg": 57.54, "max": 49.52, "min": 67.53, "cnt": 32}, "fwd-layernorm":{"total": 10.19, "avg": 0.08, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 111.78, "avg": 0.87, "max": 0.74, "min": 1.54, "cnt": 128}, "fwd-misc":{"total": 22.01, "avg": 0.17, "max": 0.11, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1675.46, "avg": 13.09, "max": 11.01, "min": 27.24, "cnt": 128}, "MoE_L0_fwd":{"total": 526.50, "avg": 16.45, "max": 11.14, "min": 27.16, "cnt": 32}, "MoEMLP":{"total": 1658.16, "avg": 12.95, "max": 10.90, "min": 27.10, "cnt": 128}, "MoE_L1_fwd":{"total": 395.11, "avg": 12.35, "max": 10.98, "min": 15.41, "cnt": 32}, "MoE_L2_fwd":{"total": 375.82, "avg": 11.74, "max": 11.07, "min": 14.88, "cnt": 32}, "MoE_L3_fwd":{"total": 367.13, "avg": 11.47, "max": 10.94, "min": 16.31, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.56, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 10.81, "avg": 5.41, "max": 1.00, "min": 9.81, "cnt": 2}, "forward-send-backward-recv":{"total": 272.25, "avg": 9.08, "max": 1.65, "min": 132.34, "cnt": 30}, "backward-compute":{"total": 1756.45, "avg": 54.89, "max": 52.77, "min": 58.55, "cnt": 32}, "MoE_L3_bwd":{"total": 425.63, "avg": 13.30, "max": 12.29, "min": 15.53, "cnt": 32}, "MoE_L2_bwd":{"total": 381.07, "avg": 11.91, "max": 10.71, "min": 15.76, "cnt": 32}, "MoE_L1_bwd":{"total": 367.53, "avg": 11.49, "max": 10.85, "min": 12.98, "cnt": 32}, "MoE_L0_bwd":{"total": 370.14, "avg": 11.57, "max": 10.99, "min": 11.77, "cnt": 32}, "backward-send-forward-recv":{"total": 8337.53, "avg": 287.50, "max": 1.33, "min": 1532.34, "cnt": 29}, "backward-send":{"total": 3.24, "avg": 1.08, "max": 1.04, "min": 1.11, "cnt": 3}, "backward-recv":{"total": 138.46, "avg": 69.23, "max": 68.67, "min": 69.80, "cnt": 2}, "backward-params-all-reduce":{"total": 496.38, "avg": 496.38, "max": 496.38, "min": 496.38, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 244.91, "avg": 244.91, "max": 244.91, "min": 244.91, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 200.53, "avg": 200.53, "max": 200.53, "min": 200.53, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.94, "avg": 6.94, "max": 6.94, "min": 6.94, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 15, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 72.94, "avg": 24.31, "max": 0.67, "min": 71.14, "cnt": 3}, "forward-compute":{"total": 1871.09, "avg": 58.47, "max": 51.42, "min": 69.34, "cnt": 32}, "fwd-compute":{"total": 1867.72, "avg": 58.37, "max": 51.35, "min": 69.26, "cnt": 32}, "batch-generator":{"total": 63.74, "avg": 1.99, "max": 0.63, "min": 4.48, "cnt": 32}, "fwd-embedding":{"total": 0.72, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1791.25, "avg": 55.98, "max": 50.30, "min": 66.67, "cnt": 32}, "fwd-layernorm":{"total": 10.39, "avg": 0.08, "max": 0.05, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 110.69, "avg": 0.86, "max": 0.73, "min": 1.55, "cnt": 128}, "fwd-misc":{"total": 22.02, "avg": 0.17, "max": 0.11, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1626.34, "avg": 12.71, "max": 10.48, "min": 25.52, "cnt": 128}, "MoE_L0_fwd":{"total": 480.01, "avg": 15.00, "max": 11.23, "min": 25.40, "cnt": 32}, "MoEMLP":{"total": 1608.99, "avg": 12.57, "max": 10.38, "min": 25.35, "cnt": 128}, "MoE_L1_fwd":{"total": 391.55, "avg": 12.24, "max": 11.05, "min": 13.93, "cnt": 32}, "MoE_L2_fwd":{"total": 379.43, "avg": 11.86, "max": 11.09, "min": 13.50, "cnt": 32}, "MoE_L3_fwd":{"total": 364.46, "avg": 11.39, "max": 10.42, "min": 13.51, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 7.14, "avg": 3.57, "max": 0.86, "min": 6.28, "cnt": 2}, "forward-send-backward-recv":{"total": 264.69, "avg": 8.82, "max": 1.58, "min": 124.67, "cnt": 30}, "backward-compute":{"total": 1736.38, "avg": 54.26, "max": 52.22, "min": 56.11, "cnt": 32}, "MoE_L3_bwd":{"total": 412.68, "avg": 12.90, "max": 11.60, "min": 14.03, "cnt": 32}, "MoE_L2_bwd":{"total": 369.61, "avg": 11.55, "max": 10.80, "min": 12.68, "cnt": 32}, "MoE_L1_bwd":{"total": 366.95, "avg": 11.47, "max": 10.85, "min": 11.72, "cnt": 32}, "MoE_L0_bwd":{"total": 372.98, "avg": 11.66, "max": 11.09, "min": 12.68, "cnt": 32}, "backward-send-forward-recv":{"total": 6065.41, "avg": 209.15, "max": 2.31, "min": 746.36, "cnt": 29}, "backward-send":{"total": 2.77, "avg": 0.92, "max": 0.91, "min": 0.94, "cnt": 3}, "backward-recv":{"total": 144.56, "avg": 72.28, "max": 72.19, "min": 72.37, "cnt": 2}, "backward-params-all-reduce":{"total": 492.79, "avg": 492.79, "max": 492.79, "min": 492.79, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 243.76, "avg": 243.76, "max": 243.76, "min": 243.76, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 199.31, "avg": 199.31, "max": 199.31, "min": 199.31, "cnt": 1}, "optimizer-clip-main-grad":{"total": 7.08, "avg": 7.08, "max": 7.08, "min": 7.08, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 16, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 79.36, "avg": 26.45, "max": 2.14, "min": 71.57, "cnt": 3}, "forward-compute":{"total": 1832.45, "avg": 57.26, "max": 49.53, "min": 65.52, "cnt": 32}, "fwd-compute":{"total": 1829.54, "avg": 57.17, "max": 49.46, "min": 65.44, "cnt": 32}, "batch-generator":{"total": 46.59, "avg": 1.46, "max": 0.67, "min": 3.19, "cnt": 32}, "fwd-embedding":{"total": 0.59, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1770.55, "avg": 55.33, "max": 48.44, "min": 64.07, "cnt": 32}, "fwd-layernorm":{"total": 9.51, "avg": 0.07, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 107.78, "avg": 0.84, "max": 0.74, "min": 1.97, "cnt": 128}, "fwd-misc":{"total": 21.12, "avg": 0.16, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1610.84, "avg": 12.58, "max": 10.30, "min": 23.24, "cnt": 128}, "MoE_L0_fwd":{"total": 482.18, "avg": 15.07, "max": 11.21, "min": 23.15, "cnt": 32}, "MoEMLP":{"total": 1593.94, "avg": 12.45, "max": 10.19, "min": 23.11, "cnt": 128}, "MoE_L1_fwd":{"total": 388.50, "avg": 12.14, "max": 10.85, "min": 14.63, "cnt": 32}, "MoE_L2_fwd":{"total": 388.07, "avg": 12.13, "max": 10.97, "min": 17.74, "cnt": 32}, "MoE_L3_fwd":{"total": 341.42, "avg": 10.67, "max": 10.23, "min": 11.65, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 6.70, "avg": 3.35, "max": 0.89, "min": 5.81, "cnt": 2}, "forward-send-backward-recv":{"total": 212.62, "avg": 7.09, "max": 1.36, "min": 130.35, "cnt": 30}, "backward-compute":{"total": 1720.58, "avg": 53.77, "max": 50.66, "min": 56.30, "cnt": 32}, "MoE_L3_bwd":{"total": 394.70, "avg": 12.33, "max": 11.34, "min": 15.18, "cnt": 32}, "MoE_L2_bwd":{"total": 380.03, "avg": 11.88, "max": 11.05, "min": 12.77, "cnt": 32}, "MoE_L1_bwd":{"total": 366.14, "avg": 11.44, "max": 10.89, "min": 11.66, "cnt": 32}, "MoE_L0_bwd":{"total": 366.27, "avg": 11.45, "max": 10.89, "min": 11.91, "cnt": 32}, "backward-send-forward-recv":{"total": 5429.19, "avg": 187.21, "max": 2.33, "min": 448.41, "cnt": 29}, "backward-send":{"total": 2.77, "avg": 0.92, "max": 0.90, "min": 0.94, "cnt": 3}, "backward-recv":{"total": 144.33, "avg": 72.17, "max": 67.96, "min": 76.37, "cnt": 2}, "backward-params-all-reduce":{"total": 491.10, "avg": 491.10, "max": 491.10, "min": 491.10, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 242.54, "avg": 242.54, "max": 242.54, "min": 242.54, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.36, "avg": 3.36, "max": 3.36, "min": 3.36, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 198.50, "avg": 198.50, "max": 198.50, "min": 198.50, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.87, "avg": 6.87, "max": 6.87, "min": 6.87, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 17, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 75.76, "avg": 25.25, "max": 2.01, "min": 71.21, "cnt": 3}, "forward-compute":{"total": 1787.13, "avg": 55.85, "max": 50.06, "min": 65.33, "cnt": 32}, "fwd-compute":{"total": 1784.11, "avg": 55.75, "max": 49.99, "min": 65.19, "cnt": 32}, "batch-generator":{"total": 59.60, "avg": 1.86, "max": 0.63, "min": 4.44, "cnt": 32}, "fwd-embedding":{"total": 0.59, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1712.51, "avg": 53.52, "max": 48.80, "min": 63.18, "cnt": 32}, "fwd-layernorm":{"total": 9.59, "avg": 0.07, "max": 0.05, "min": 0.22, "cnt": 128}, "fwd-attn":{"total": 106.38, "avg": 0.83, "max": 0.74, "min": 1.59, "cnt": 128}, "fwd-misc":{"total": 21.20, "avg": 0.17, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1554.62, "avg": 12.15, "max": 10.29, "min": 23.83, "cnt": 128}, "MoE_L0_fwd":{"total": 436.45, "avg": 13.64, "max": 10.38, "min": 23.69, "cnt": 32}, "MoEMLP":{"total": 1537.86, "avg": 12.01, "max": 10.18, "min": 23.62, "cnt": 128}, "MoE_L1_fwd":{"total": 392.80, "avg": 12.27, "max": 10.96, "min": 16.69, "cnt": 32}, "MoE_L2_fwd":{"total": 375.94, "avg": 11.75, "max": 11.04, "min": 13.29, "cnt": 32}, "MoE_L3_fwd":{"total": 338.87, "avg": 10.59, "max": 10.23, "min": 13.49, "cnt": 32}, "fwd-pooler":{"total": 0.37, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 2.31, "avg": 1.15, "max": 0.92, "min": 1.39, "cnt": 2}, "forward-send-backward-recv":{"total": 214.92, "avg": 7.16, "max": 1.48, "min": 129.76, "cnt": 30}, "backward-compute":{"total": 1715.00, "avg": 53.59, "max": 50.79, "min": 55.24, "cnt": 32}, "MoE_L3_bwd":{"total": 389.43, "avg": 12.17, "max": 11.40, "min": 14.10, "cnt": 32}, "MoE_L2_bwd":{"total": 380.22, "avg": 11.88, "max": 11.07, "min": 12.67, "cnt": 32}, "MoE_L1_bwd":{"total": 368.95, "avg": 11.53, "max": 10.89, "min": 12.79, "cnt": 32}, "MoE_L0_bwd":{"total": 360.55, "avg": 11.27, "max": 10.73, "min": 11.62, "cnt": 32}, "backward-send-forward-recv":{"total": 7302.82, "avg": 251.82, "max": 1.41, "min": 1082.01, "cnt": 29}, "backward-send":{"total": 2.41, "avg": 0.80, "max": 0.44, "min": 1.01, "cnt": 3}, "backward-recv":{"total": 163.63, "avg": 81.82, "max": 79.12, "min": 84.51, "cnt": 2}, "backward-params-all-reduce":{"total": 490.56, "avg": 490.56, "max": 490.56, "min": 490.56, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 245.63, "avg": 245.63, "max": 245.63, "min": 245.63, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 201.19, "avg": 201.19, "max": 201.19, "min": 201.19, "cnt": 1}, "optimizer-clip-main-grad":{"total": 7.09, "avg": 7.09, "max": 7.09, "min": 7.09, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 18, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 78.06, "avg": 26.02, "max": 0.81, "min": 76.15, "cnt": 3}, "forward-compute":{"total": 1828.28, "avg": 57.13, "max": 49.98, "min": 69.04, "cnt": 32}, "fwd-compute":{"total": 1825.22, "avg": 57.04, "max": 49.91, "min": 68.93, "cnt": 32}, "batch-generator":{"total": 48.83, "avg": 1.53, "max": 0.70, "min": 3.28, "cnt": 32}, "fwd-embedding":{"total": 0.73, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1764.04, "avg": 55.13, "max": 48.90, "min": 65.78, "cnt": 32}, "fwd-layernorm":{"total": 10.28, "avg": 0.08, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 111.05, "avg": 0.87, "max": 0.74, "min": 1.52, "cnt": 128}, "fwd-misc":{"total": 22.20, "avg": 0.17, "max": 0.11, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1598.63, "avg": 12.49, "max": 10.45, "min": 17.73, "cnt": 128}, "MoE_L0_fwd":{"total": 478.95, "avg": 14.97, "max": 11.79, "min": 17.65, "cnt": 32}, "MoEMLP":{"total": 1581.16, "avg": 12.35, "max": 10.34, "min": 17.59, "cnt": 128}, "MoE_L1_fwd":{"total": 392.62, "avg": 12.27, "max": 10.85, "min": 16.87, "cnt": 32}, "MoE_L2_fwd":{"total": 373.34, "avg": 11.67, "max": 11.12, "min": 15.84, "cnt": 32}, "MoE_L3_fwd":{"total": 342.77, "avg": 10.71, "max": 10.38, "min": 11.59, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 7.67, "avg": 3.84, "max": 0.93, "min": 6.75, "cnt": 2}, "forward-send-backward-recv":{"total": 215.39, "avg": 7.18, "max": 1.63, "min": 122.69, "cnt": 30}, "backward-compute":{"total": 1734.71, "avg": 54.21, "max": 50.91, "min": 55.51, "cnt": 32}, "MoE_L3_bwd":{"total": 413.78, "avg": 12.93, "max": 11.72, "min": 14.41, "cnt": 32}, "MoE_L2_bwd":{"total": 378.86, "avg": 11.84, "max": 10.96, "min": 12.64, "cnt": 32}, "MoE_L1_bwd":{"total": 367.66, "avg": 11.49, "max": 11.04, "min": 12.77, "cnt": 32}, "MoE_L0_bwd":{"total": 360.60, "avg": 11.27, "max": 10.55, "min": 13.57, "cnt": 32}, "backward-send-forward-recv":{"total": 7226.88, "avg": 249.20, "max": 0.97, "min": 1141.44, "cnt": 29}, "backward-send":{"total": 2.61, "avg": 0.87, "max": 0.72, "min": 0.99, "cnt": 3}, "backward-recv":{"total": 124.00, "avg": 62.00, "max": 60.99, "min": 63.01, "cnt": 2}, "backward-params-all-reduce":{"total": 486.64, "avg": 486.64, "max": 486.64, "min": 486.64, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 249.05, "avg": 249.05, "max": 249.05, "min": 249.05, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.36, "avg": 3.36, "max": 3.36, "min": 3.36, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 204.76, "avg": 204.76, "max": 204.76, "min": 204.76, "cnt": 1}, "optimizer-clip-main-grad":{"total": 7.04, "avg": 7.04, "max": 7.04, "min": 7.04, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 19, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 68.49, "avg": 22.83, "max": 0.84, "min": 65.16, "cnt": 3}, "forward-compute":{"total": 1985.39, "avg": 62.04, "max": 50.04, "min": 228.56, "cnt": 32}, "fwd-compute":{"total": 1982.05, "avg": 61.94, "max": 49.95, "min": 228.43, "cnt": 32}, "batch-generator":{"total": 56.77, "avg": 1.77, "max": 0.69, "min": 3.77, "cnt": 32}, "fwd-embedding":{"total": 0.68, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1912.19, "avg": 59.76, "max": 48.91, "min": 226.45, "cnt": 32}, "fwd-layernorm":{"total": 10.40, "avg": 0.08, "max": 0.05, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 110.17, "avg": 0.86, "max": 0.74, "min": 1.54, "cnt": 128}, "fwd-misc":{"total": 22.14, "avg": 0.17, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1747.40, "avg": 13.65, "max": 10.48, "min": 186.34, "cnt": 128}, "MoE_L0_fwd":{"total": 625.28, "avg": 19.54, "max": 10.84, "min": 186.21, "cnt": 32}, "MoEMLP":{"total": 1729.82, "avg": 13.51, "max": 10.35, "min": 186.14, "cnt": 128}, "MoE_L1_fwd":{"total": 388.32, "avg": 12.14, "max": 10.88, "min": 14.27, "cnt": 32}, "MoE_L2_fwd":{"total": 373.86, "avg": 11.68, "max": 11.04, "min": 15.23, "cnt": 32}, "MoE_L3_fwd":{"total": 348.86, "avg": 10.90, "max": 10.40, "min": 12.66, "cnt": 32}, "fwd-pooler":{"total": 0.37, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 3.58, "avg": 1.79, "max": 0.96, "min": 2.61, "cnt": 2}, "forward-send-backward-recv":{"total": 205.34, "avg": 6.84, "max": 1.56, "min": 114.88, "cnt": 30}, "backward-compute":{"total": 1720.44, "avg": 53.76, "max": 51.08, "min": 54.74, "cnt": 32}, "MoE_L3_bwd":{"total": 405.52, "avg": 12.67, "max": 11.88, "min": 13.79, "cnt": 32}, "MoE_L2_bwd":{"total": 382.08, "avg": 11.94, "max": 11.17, "min": 13.06, "cnt": 32}, "MoE_L1_bwd":{"total": 366.58, "avg": 11.46, "max": 10.80, "min": 11.80, "cnt": 32}, "MoE_L0_bwd":{"total": 352.77, "avg": 11.02, "max": 10.42, "min": 11.47, "cnt": 32}, "backward-send-forward-recv":{"total": 7353.48, "avg": 253.57, "max": 2.37, "min": 900.07, "cnt": 29}, "backward-send":{"total": 2.27, "avg": 0.76, "max": 0.49, "min": 0.93, "cnt": 3}, "backward-recv":{"total": 148.88, "avg": 74.44, "max": 72.43, "min": 76.45, "cnt": 2}, "backward-params-all-reduce":{"total": 490.12, "avg": 490.12, "max": 490.12, "min": 490.12, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 249.39, "avg": 249.39, "max": 249.39, "min": 249.39, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 204.87, "avg": 204.87, "max": 204.87, "min": 204.87, "cnt": 1}, "optimizer-clip-main-grad":{"total": 7.00, "avg": 7.00, "max": 7.00, "min": 7.00, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.50, "avg": 3.50, "max": 3.50, "min": 3.50, "cnt": 1}}}
{"type":"time", "iteration": 20, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 73.53, "avg": 24.51, "max": 1.27, "min": 69.39, "cnt": 3}, "forward-compute":{"total": 1787.35, "avg": 55.85, "max": 49.46, "min": 61.64, "cnt": 32}, "fwd-compute":{"total": 1784.18, "avg": 55.76, "max": 49.39, "min": 61.56, "cnt": 32}, "batch-generator":{"total": 45.64, "avg": 1.43, "max": 0.67, "min": 2.63, "cnt": 32}, "fwd-embedding":{"total": 0.64, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1725.95, "avg": 53.94, "max": 48.37, "min": 59.07, "cnt": 32}, "fwd-layernorm":{"total": 10.02, "avg": 0.08, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 109.17, "avg": 0.85, "max": 0.73, "min": 2.04, "cnt": 128}, "fwd-misc":{"total": 21.75, "avg": 0.17, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1563.51, "avg": 12.21, "max": 10.50, "min": 18.90, "cnt": 128}, "MoE_L0_fwd":{"total": 453.49, "avg": 14.17, "max": 10.68, "min": 18.81, "cnt": 32}, "MoEMLP":{"total": 1546.03, "avg": 12.08, "max": 10.38, "min": 18.77, "cnt": 128}, "MoE_L1_fwd":{"total": 384.57, "avg": 12.02, "max": 11.08, "min": 14.67, "cnt": 32}, "MoE_L2_fwd":{"total": 369.45, "avg": 11.55, "max": 11.21, "min": 12.72, "cnt": 32}, "MoE_L3_fwd":{"total": 345.03, "avg": 10.78, "max": 10.43, "min": 11.98, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 10.96, "avg": 5.48, "max": 0.81, "min": 10.15, "cnt": 2}, "forward-send-backward-recv":{"total": 232.22, "avg": 7.74, "max": 1.67, "min": 122.76, "cnt": 30}, "backward-compute":{"total": 1735.26, "avg": 54.23, "max": 51.82, "min": 57.24, "cnt": 32}, "MoE_L3_bwd":{"total": 401.10, "avg": 12.53, "max": 11.77, "min": 16.05, "cnt": 32}, "MoE_L2_bwd":{"total": 399.34, "avg": 12.48, "max": 11.47, "min": 13.72, "cnt": 32}, "MoE_L1_bwd":{"total": 366.31, "avg": 11.45, "max": 10.58, "min": 11.98, "cnt": 32}, "MoE_L0_bwd":{"total": 355.41, "avg": 11.11, "max": 10.55, "min": 11.82, "cnt": 32}, "backward-send-forward-recv":{"total": 5871.21, "avg": 202.46, "max": 2.28, "min": 585.68, "cnt": 29}, "backward-send":{"total": 3.27, "avg": 1.09, "max": 0.88, "min": 1.21, "cnt": 3}, "backward-recv":{"total": 146.06, "avg": 73.03, "max": 70.23, "min": 75.84, "cnt": 2}, "backward-params-all-reduce":{"total": 489.02, "avg": 489.02, "max": 489.02, "min": 489.02, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 242.52, "avg": 242.52, "max": 242.52, "min": 242.52, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 198.25, "avg": 198.25, "max": 198.25, "min": 198.25, "cnt": 1}, "optimizer-clip-main-grad":{"total": 7.06, "avg": 7.06, "max": 7.06, "min": 7.06, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 21, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 76.30, "avg": 25.43, "max": 1.36, "min": 72.78, "cnt": 3}, "forward-compute":{"total": 1827.05, "avg": 57.10, "max": 50.41, "min": 64.14, "cnt": 32}, "fwd-compute":{"total": 1823.81, "avg": 56.99, "max": 50.34, "min": 64.06, "cnt": 32}, "batch-generator":{"total": 55.17, "avg": 1.72, "max": 0.66, "min": 4.70, "cnt": 32}, "fwd-embedding":{"total": 0.61, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1756.34, "avg": 54.89, "max": 49.27, "min": 62.12, "cnt": 32}, "fwd-layernorm":{"total": 9.86, "avg": 0.08, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 110.65, "avg": 0.86, "max": 0.74, "min": 2.28, "cnt": 128}, "fwd-misc":{"total": 21.52, "avg": 0.17, "max": 0.11, "min": 0.40, "cnt": 128}, "fwd-MLP":{"total": 1592.75, "avg": 12.44, "max": 10.85, "min": 17.77, "cnt": 128}, "MoE_L0_fwd":{"total": 440.07, "avg": 13.75, "max": 10.82, "min": 16.38, "cnt": 32}, "MoEMLP":{"total": 1575.73, "avg": 12.31, "max": 10.73, "min": 17.65, "cnt": 128}, "MoE_L1_fwd":{"total": 396.92, "avg": 12.40, "max": 11.16, "min": 17.69, "cnt": 32}, "MoE_L2_fwd":{"total": 377.18, "avg": 11.79, "max": 11.18, "min": 13.77, "cnt": 32}, "MoE_L3_fwd":{"total": 367.86, "avg": 11.50, "max": 10.77, "min": 14.33, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 8.55, "avg": 4.27, "max": 0.93, "min": 7.62, "cnt": 2}, "forward-send-backward-recv":{"total": 254.81, "avg": 8.49, "max": 1.02, "min": 138.41, "cnt": 30}, "backward-compute":{"total": 1736.25, "avg": 54.26, "max": 52.12, "min": 57.80, "cnt": 32}, "MoE_L3_bwd":{"total": 416.80, "avg": 13.03, "max": 11.91, "min": 16.86, "cnt": 32}, "MoE_L2_bwd":{"total": 379.81, "avg": 11.87, "max": 10.78, "min": 13.00, "cnt": 32}, "MoE_L1_bwd":{"total": 366.14, "avg": 11.44, "max": 11.21, "min": 11.90, "cnt": 32}, "MoE_L0_bwd":{"total": 360.43, "avg": 11.26, "max": 10.52, "min": 11.66, "cnt": 32}, "backward-send-forward-recv":{"total": 7664.29, "avg": 264.29, "max": 2.29, "min": 1006.73, "cnt": 29}, "backward-send":{"total": 1.66, "avg": 0.55, "max": 0.43, "min": 0.73, "cnt": 3}, "backward-recv":{"total": 142.01, "avg": 71.00, "max": 69.62, "min": 72.38, "cnt": 2}, "backward-params-all-reduce":{"total": 485.06, "avg": 485.06, "max": 485.06, "min": 485.06, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 256.73, "avg": 256.73, "max": 256.73, "min": 256.73, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 212.43, "avg": 212.43, "max": 212.43, "min": 212.43, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.95, "avg": 6.95, "max": 6.95, "min": 6.95, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 22, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 89.41, "avg": 29.80, "max": 1.53, "min": 79.59, "cnt": 3}, "forward-compute":{"total": 1872.08, "avg": 58.50, "max": 50.37, "min": 134.04, "cnt": 32}, "fwd-compute":{"total": 1869.30, "avg": 58.42, "max": 50.30, "min": 133.95, "cnt": 32}, "batch-generator":{"total": 38.79, "avg": 1.21, "max": 0.64, "min": 2.75, "cnt": 32}, "fwd-embedding":{"total": 0.47, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1819.06, "avg": 56.85, "max": 49.28, "min": 130.86, "cnt": 32}, "fwd-layernorm":{"total": 8.71, "avg": 0.07, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 103.86, "avg": 0.81, "max": 0.74, "min": 1.54, "cnt": 128}, "fwd-misc":{"total": 19.61, "avg": 0.15, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1667.00, "avg": 13.02, "max": 10.90, "min": 89.74, "cnt": 128}, "MoE_L0_fwd":{"total": 517.99, "avg": 16.19, "max": 10.83, "min": 89.66, "cnt": 32}, "MoEMLP":{"total": 1651.16, "avg": 12.90, "max": 10.79, "min": 89.61, "cnt": 128}, "MoE_L1_fwd":{"total": 383.01, "avg": 11.97, "max": 11.03, "min": 13.71, "cnt": 32}, "MoE_L2_fwd":{"total": 379.72, "avg": 11.87, "max": 11.28, "min": 13.30, "cnt": 32}, "MoE_L3_fwd":{"total": 376.27, "avg": 11.76, "max": 11.31, "min": 15.62, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.56, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 5.58, "avg": 2.79, "max": 0.69, "min": 4.89, "cnt": 2}, "forward-send-backward-recv":{"total": 303.66, "avg": 10.12, "max": 1.10, "min": 114.04, "cnt": 30}, "backward-compute":{"total": 1765.06, "avg": 55.16, "max": 51.79, "min": 56.63, "cnt": 32}, "MoE_L3_bwd":{"total": 431.43, "avg": 13.48, "max": 12.50, "min": 14.62, "cnt": 32}, "MoE_L2_bwd":{"total": 384.14, "avg": 12.00, "max": 10.75, "min": 12.83, "cnt": 32}, "MoE_L1_bwd":{"total": 367.14, "avg": 11.47, "max": 10.84, "min": 12.21, "cnt": 32}, "MoE_L0_bwd":{"total": 371.79, "avg": 11.62, "max": 10.74, "min": 12.08, "cnt": 32}, "backward-send-forward-recv":{"total": 6349.73, "avg": 218.96, "max": 2.16, "min": 1281.32, "cnt": 29}, "backward-send":{"total": 2.37, "avg": 0.79, "max": 0.76, "min": 0.84, "cnt": 3}, "backward-recv":{"total": 247.64, "avg": 123.82, "max": 66.01, "min": 181.63, "cnt": 2}, "backward-params-all-reduce":{"total": 491.71, "avg": 491.71, "max": 491.71, "min": 491.71, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 247.83, "avg": 247.83, "max": 247.83, "min": 247.83, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 203.76, "avg": 203.76, "max": 203.76, "min": 203.76, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.93, "avg": 6.93, "max": 6.93, "min": 6.93, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.41, "avg": 3.41, "max": 3.41, "min": 3.41, "cnt": 1}}}
{"type":"time", "iteration": 23, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.10, "avg": 0.10, "max": 0.10, "min": 0.10, "cnt": 1}, "forward-recv":{"total": 82.47, "avg": 27.49, "max": 0.99, "min": 76.37, "cnt": 3}, "forward-compute":{"total": 1929.26, "avg": 60.29, "max": 49.91, "min": 173.35, "cnt": 32}, "fwd-compute":{"total": 1926.01, "avg": 60.19, "max": 49.84, "min": 173.27, "cnt": 32}, "batch-generator":{"total": 54.38, "avg": 1.70, "max": 0.69, "min": 3.74, "cnt": 32}, "fwd-embedding":{"total": 0.67, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1858.57, "avg": 58.08, "max": 48.87, "min": 171.88, "cnt": 32}, "fwd-layernorm":{"total": 10.14, "avg": 0.08, "max": 0.05, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 107.93, "avg": 0.84, "max": 0.74, "min": 1.89, "cnt": 128}, "fwd-misc":{"total": 21.33, "avg": 0.17, "max": 0.11, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1697.43, "avg": 13.26, "max": 10.81, "min": 130.44, "cnt": 128}, "MoE_L0_fwd":{"total": 564.68, "avg": 17.65, "max": 10.74, "min": 130.25, "cnt": 32}, "MoEMLP":{"total": 1679.97, "avg": 13.12, "max": 10.71, "min": 130.15, "cnt": 128}, "MoE_L1_fwd":{"total": 390.08, "avg": 12.19, "max": 10.81, "min": 14.72, "cnt": 32}, "MoE_L2_fwd":{"total": 372.57, "avg": 11.64, "max": 11.10, "min": 12.78, "cnt": 32}, "MoE_L3_fwd":{"total": 359.04, "avg": 11.22, "max": 10.82, "min": 11.94, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.45, "avg": 0.73, "max": 0.67, "min": 0.78, "cnt": 2}, "forward-send-backward-recv":{"total": 199.67, "avg": 6.66, "max": 1.74, "min": 124.86, "cnt": 30}, "backward-compute":{"total": 1748.38, "avg": 54.64, "max": 51.27, "min": 57.66, "cnt": 32}, "MoE_L3_bwd":{"total": 410.92, "avg": 12.84, "max": 11.89, "min": 14.64, "cnt": 32}, "MoE_L2_bwd":{"total": 386.07, "avg": 12.06, "max": 11.14, "min": 15.12, "cnt": 32}, "MoE_L1_bwd":{"total": 364.18, "avg": 11.38, "max": 10.76, "min": 11.66, "cnt": 32}, "MoE_L0_bwd":{"total": 372.94, "avg": 11.65, "max": 10.83, "min": 12.74, "cnt": 32}, "backward-send-forward-recv":{"total": 5136.96, "avg": 177.14, "max": 2.34, "min": 629.33, "cnt": 29}, "backward-send":{"total": 2.99, "avg": 1.00, "max": 0.81, "min": 1.10, "cnt": 3}, "backward-recv":{"total": 135.20, "avg": 67.60, "max": 62.43, "min": 72.78, "cnt": 2}, "backward-params-all-reduce":{"total": 491.17, "avg": 491.17, "max": 491.17, "min": 491.17, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 265.15, "avg": 265.15, "max": 265.15, "min": 265.15, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.47, "avg": 3.47, "max": 3.47, "min": 3.47, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 207.33, "avg": 207.33, "max": 207.33, "min": 207.33, "cnt": 1}, "optimizer-clip-main-grad":{"total": 10.47, "avg": 10.47, "max": 10.47, "min": 10.47, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.50, "avg": 3.50, "max": 3.50, "min": 3.50, "cnt": 1}}}
{"type":"time", "iteration": 24, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 1042.34, "avg": 347.45, "max": 0.70, "min": 1040.18, "cnt": 3}, "forward-compute":{"total": 1856.86, "avg": 58.03, "max": 49.94, "min": 112.80, "cnt": 32}, "fwd-compute":{"total": 1853.78, "avg": 57.93, "max": 49.86, "min": 112.67, "cnt": 32}, "batch-generator":{"total": 43.44, "avg": 1.36, "max": 0.66, "min": 2.09, "cnt": 32}, "fwd-embedding":{"total": 0.60, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1798.28, "avg": 56.20, "max": 48.32, "min": 110.62, "cnt": 32}, "fwd-layernorm":{"total": 9.69, "avg": 0.08, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 109.49, "avg": 0.86, "max": 0.74, "min": 1.54, "cnt": 128}, "fwd-misc":{"total": 21.37, "avg": 0.17, "max": 0.12, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1636.38, "avg": 12.78, "max": 10.63, "min": 70.45, "cnt": 128}, "MoE_L0_fwd":{"total": 507.99, "avg": 15.87, "max": 10.82, "min": 70.31, "cnt": 32}, "MoEMLP":{"total": 1619.40, "avg": 12.65, "max": 10.51, "min": 70.24, "cnt": 128}, "MoE_L1_fwd":{"total": 384.10, "avg": 12.00, "max": 10.90, "min": 14.41, "cnt": 32}, "MoE_L2_fwd":{"total": 374.79, "avg": 11.71, "max": 11.21, "min": 12.94, "cnt": 32}, "MoE_L3_fwd":{"total": 358.79, "avg": 11.21, "max": 10.55, "min": 13.94, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 13.61, "avg": 6.80, "max": 0.77, "min": 12.84, "cnt": 2}, "forward-send-backward-recv":{"total": 200.87, "avg": 6.70, "max": 1.38, "min": 127.94, "cnt": 30}, "backward-compute":{"total": 1767.63, "avg": 55.24, "max": 51.03, "min": 84.19, "cnt": 32}, "MoE_L3_bwd":{"total": 408.46, "avg": 12.76, "max": 11.66, "min": 14.14, "cnt": 32}, "MoE_L2_bwd":{"total": 384.44, "avg": 12.01, "max": 11.36, "min": 13.24, "cnt": 32}, "MoE_L1_bwd":{"total": 365.06, "avg": 11.41, "max": 10.51, "min": 11.80, "cnt": 32}, "MoE_L0_bwd":{"total": 397.43, "avg": 12.42, "max": 10.80, "min": 41.07, "cnt": 32}, "backward-send-forward-recv":{"total": 4851.17, "avg": 167.28, "max": 2.40, "min": 412.91, "cnt": 29}, "backward-send":{"total": 3.12, "avg": 1.04, "max": 0.92, "min": 1.10, "cnt": 3}, "backward-recv":{"total": 170.37, "avg": 85.18, "max": 71.87, "min": 98.50, "cnt": 2}, "backward-params-all-reduce":{"total": 486.46, "avg": 486.46, "max": 486.46, "min": 486.46, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 250.32, "avg": 250.32, "max": 250.32, "min": 250.32, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 205.84, "avg": 205.84, "max": 205.84, "min": 205.84, "cnt": 1}, "optimizer-clip-main-grad":{"total": 7.09, "avg": 7.09, "max": 7.09, "min": 7.09, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 25, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 88.66, "avg": 29.55, "max": 3.59, "min": 79.88, "cnt": 3}, "forward-compute":{"total": 1770.98, "avg": 55.34, "max": 50.07, "min": 64.93, "cnt": 32}, "fwd-compute":{"total": 1767.81, "avg": 55.24, "max": 50.00, "min": 64.84, "cnt": 32}, "batch-generator":{"total": 43.77, "avg": 1.37, "max": 0.65, "min": 3.35, "cnt": 32}, "fwd-embedding":{"total": 0.64, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1711.61, "avg": 53.49, "max": 48.90, "min": 62.18, "cnt": 32}, "fwd-layernorm":{"total": 10.12, "avg": 0.08, "max": 0.05, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 112.76, "avg": 0.88, "max": 0.74, "min": 2.33, "cnt": 128}, "fwd-misc":{"total": 21.87, "avg": 0.17, "max": 0.11, "min": 0.39, "cnt": 128}, "fwd-MLP":{"total": 1545.06, "avg": 12.07, "max": 10.58, "min": 18.04, "cnt": 128}, "MoE_L0_fwd":{"total": 431.85, "avg": 13.50, "max": 10.68, "min": 17.84, "cnt": 32}, "MoEMLP":{"total": 1527.77, "avg": 11.94, "max": 10.45, "min": 17.75, "cnt": 128}, "MoE_L1_fwd":{"total": 379.53, "avg": 11.86, "max": 10.90, "min": 16.21, "cnt": 32}, "MoE_L2_fwd":{"total": 374.17, "avg": 11.69, "max": 11.23, "min": 13.25, "cnt": 32}, "MoE_L3_fwd":{"total": 348.70, "avg": 10.90, "max": 10.51, "min": 11.92, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 4.26, "avg": 2.13, "max": 0.89, "min": 3.37, "cnt": 2}, "forward-send-backward-recv":{"total": 211.59, "avg": 7.05, "max": 1.09, "min": 122.04, "cnt": 30}, "backward-compute":{"total": 1747.69, "avg": 54.62, "max": 51.40, "min": 58.80, "cnt": 32}, "MoE_L3_bwd":{"total": 408.80, "avg": 12.77, "max": 11.31, "min": 16.78, "cnt": 32}, "MoE_L2_bwd":{"total": 397.60, "avg": 12.43, "max": 11.73, "min": 13.48, "cnt": 32}, "MoE_L1_bwd":{"total": 365.70, "avg": 11.43, "max": 10.92, "min": 11.92, "cnt": 32}, "MoE_L0_bwd":{"total": 364.42, "avg": 11.39, "max": 10.52, "min": 11.76, "cnt": 32}, "backward-send-forward-recv":{"total": 6194.87, "avg": 213.62, "max": 2.39, "min": 932.28, "cnt": 29}, "backward-send":{"total": 2.08, "avg": 0.69, "max": 0.46, "min": 0.97, "cnt": 3}, "backward-recv":{"total": 802.23, "avg": 401.11, "max": 73.45, "min": 728.78, "cnt": 2}, "backward-params-all-reduce":{"total": 485.23, "avg": 485.23, "max": 485.23, "min": 485.23, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 257.63, "avg": 257.63, "max": 257.63, "min": 257.63, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 213.47, "avg": 213.47, "max": 213.47, "min": 213.47, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.99, "avg": 6.99, "max": 6.99, "min": 6.99, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}}}
{"type":"time", "iteration": 26, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.10, "avg": 0.10, "max": 0.10, "min": 0.10, "cnt": 1}, "forward-recv":{"total": 84.42, "avg": 28.14, "max": 1.18, "min": 73.55, "cnt": 3}, "forward-compute":{"total": 1782.94, "avg": 55.72, "max": 49.22, "min": 61.76, "cnt": 32}, "fwd-compute":{"total": 1779.84, "avg": 55.62, "max": 49.15, "min": 61.58, "cnt": 32}, "batch-generator":{"total": 40.89, "avg": 1.28, "max": 0.63, "min": 3.84, "cnt": 32}, "fwd-embedding":{"total": 0.54, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1727.18, "avg": 53.97, "max": 48.20, "min": 59.53, "cnt": 32}, "fwd-layernorm":{"total": 9.30, "avg": 0.07, "max": 0.05, "min": 0.29, "cnt": 128}, "fwd-attn":{"total": 107.65, "avg": 0.84, "max": 0.74, "min": 2.38, "cnt": 128}, "fwd-misc":{"total": 20.02, "avg": 0.16, "max": 0.11, "min": 0.48, "cnt": 128}, "fwd-MLP":{"total": 1570.04, "avg": 12.27, "max": 10.43, "min": 20.63, "cnt": 128}, "MoE_L0_fwd":{"total": 444.06, "avg": 13.88, "max": 10.69, "min": 20.54, "cnt": 32}, "MoEMLP":{"total": 1553.89, "avg": 12.14, "max": 10.33, "min": 20.49, "cnt": 128}, "MoE_L1_fwd":{"total": 385.37, "avg": 12.04, "max": 11.08, "min": 14.51, "cnt": 32}, "MoE_L2_fwd":{"total": 372.72, "avg": 11.65, "max": 10.86, "min": 13.66, "cnt": 32}, "MoE_L3_fwd":{"total": 357.64, "avg": 11.18, "max": 10.37, "min": 16.22, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.04, "cnt": 32}, "forward-send":{"total": 1.97, "avg": 0.98, "max": 0.95, "min": 1.02, "cnt": 2}, "forward-send-backward-recv":{"total": 213.84, "avg": 7.13, "max": 1.47, "min": 133.09, "cnt": 30}, "backward-compute":{"total": 1725.18, "avg": 53.91, "max": 50.95, "min": 56.45, "cnt": 32}, "MoE_L3_bwd":{"total": 397.26, "avg": 12.41, "max": 11.52, "min": 15.01, "cnt": 32}, "MoE_L2_bwd":{"total": 390.10, "avg": 12.19, "max": 11.06, "min": 14.14, "cnt": 32}, "MoE_L1_bwd":{"total": 365.48, "avg": 11.42, "max": 10.73, "min": 11.79, "cnt": 32}, "MoE_L0_bwd":{"total": 359.09, "avg": 11.22, "max": 10.71, "min": 12.55, "cnt": 32}, "backward-send-forward-recv":{"total": 8146.83, "avg": 280.93, "max": 2.04, "min": 1138.30, "cnt": 29}, "backward-send":{"total": 2.78, "avg": 0.93, "max": 0.79, "min": 1.12, "cnt": 3}, "backward-recv":{"total": 411.17, "avg": 205.58, "max": 77.00, "min": 334.16, "cnt": 2}, "backward-params-all-reduce":{"total": 532.69, "avg": 532.69, "max": 532.69, "min": 532.69, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.04, "avg": 0.04, "max": 0.04, "min": 0.04, "cnt": 1}, "optimizer":{"total": 249.54, "avg": 249.54, "max": 249.54, "min": 249.54, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.40, "avg": 3.40, "max": 3.40, "min": 3.40, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 205.20, "avg": 205.20, "max": 205.20, "min": 205.20, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.96, "avg": 6.96, "max": 6.96, "min": 6.96, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.51, "avg": 3.51, "max": 3.51, "min": 3.51, "cnt": 1}}}
{"type":"time", "iteration": 27, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 848.35, "avg": 282.78, "max": 3.55, "min": 776.49, "cnt": 3}, "forward-compute":{"total": 1794.99, "avg": 56.09, "max": 51.21, "min": 61.26, "cnt": 32}, "fwd-compute":{"total": 1792.17, "avg": 56.01, "max": 51.12, "min": 61.17, "cnt": 32}, "batch-generator":{"total": 44.34, "avg": 1.39, "max": 0.71, "min": 3.66, "cnt": 32}, "fwd-embedding":{"total": 0.53, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1736.29, "avg": 54.26, "max": 49.64, "min": 59.13, "cnt": 32}, "fwd-layernorm":{"total": 9.41, "avg": 0.07, "max": 0.05, "min": 0.22, "cnt": 128}, "fwd-attn":{"total": 106.81, "avg": 0.83, "max": 0.74, "min": 1.87, "cnt": 128}, "fwd-misc":{"total": 20.57, "avg": 0.16, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1578.74, "avg": 12.33, "max": 10.57, "min": 17.33, "cnt": 128}, "MoE_L0_fwd":{"total": 444.89, "avg": 13.90, "max": 11.15, "min": 17.25, "cnt": 32}, "MoEMLP":{"total": 1561.92, "avg": 12.20, "max": 10.46, "min": 17.20, "cnt": 128}, "MoE_L1_fwd":{"total": 389.38, "avg": 12.17, "max": 11.10, "min": 14.71, "cnt": 32}, "MoE_L2_fwd":{"total": 376.51, "avg": 11.77, "max": 11.07, "min": 14.07, "cnt": 32}, "MoE_L3_fwd":{"total": 357.32, "avg": 11.17, "max": 10.49, "min": 13.64, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 11.07, "avg": 5.54, "max": 0.78, "min": 10.29, "cnt": 2}, "forward-send-backward-recv":{"total": 72.16, "avg": 2.41, "max": 1.09, "min": 12.72, "cnt": 30}, "backward-compute":{"total": 1742.14, "avg": 54.44, "max": 51.18, "min": 56.95, "cnt": 32}, "MoE_L3_bwd":{"total": 411.66, "avg": 12.86, "max": 11.67, "min": 15.66, "cnt": 32}, "MoE_L2_bwd":{"total": 392.37, "avg": 12.26, "max": 11.52, "min": 13.75, "cnt": 32}, "MoE_L1_bwd":{"total": 364.11, "avg": 11.38, "max": 10.83, "min": 11.73, "cnt": 32}, "MoE_L0_bwd":{"total": 358.65, "avg": 11.21, "max": 10.54, "min": 13.31, "cnt": 32}, "backward-send-forward-recv":{"total": 6221.58, "avg": 214.54, "max": 2.09, "min": 944.88, "cnt": 29}, "backward-send":{"total": 2.70, "avg": 0.90, "max": 0.66, "min": 1.10, "cnt": 3}, "backward-recv":{"total": 133.60, "avg": 66.80, "max": 58.58, "min": 75.02, "cnt": 2}, "backward-params-all-reduce":{"total": 485.45, "avg": 485.45, "max": 485.45, "min": 485.45, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 252.77, "avg": 252.77, "max": 252.77, "min": 252.77, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 208.53, "avg": 208.53, "max": 208.53, "min": 208.53, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.93, "avg": 6.93, "max": 6.93, "min": 6.93, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}}}
{"type":"time", "iteration": 28, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 89.93, "avg": 29.98, "max": 0.65, "min": 84.02, "cnt": 3}, "forward-compute":{"total": 1778.39, "avg": 55.57, "max": 50.67, "min": 64.45, "cnt": 32}, "fwd-compute":{"total": 1775.50, "avg": 55.48, "max": 50.59, "min": 64.36, "cnt": 32}, "batch-generator":{"total": 37.77, "avg": 1.18, "max": 0.68, "min": 2.08, "cnt": 32}, "fwd-embedding":{"total": 0.54, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1725.46, "avg": 53.92, "max": 49.51, "min": 61.96, "cnt": 32}, "fwd-layernorm":{"total": 8.97, "avg": 0.07, "max": 0.05, "min": 0.18, "cnt": 128}, "fwd-attn":{"total": 105.54, "avg": 0.82, "max": 0.74, "min": 1.49, "cnt": 128}, "fwd-misc":{"total": 20.27, "avg": 0.16, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1570.67, "avg": 12.27, "max": 10.67, "min": 20.59, "cnt": 128}, "MoE_L0_fwd":{"total": 429.95, "avg": 13.44, "max": 10.86, "min": 20.51, "cnt": 32}, "MoEMLP":{"total": 1554.25, "avg": 12.14, "max": 10.56, "min": 20.46, "cnt": 128}, "MoE_L1_fwd":{"total": 389.53, "avg": 12.17, "max": 10.83, "min": 16.52, "cnt": 32}, "MoE_L2_fwd":{"total": 382.14, "avg": 11.94, "max": 11.26, "min": 13.73, "cnt": 32}, "MoE_L3_fwd":{"total": 358.62, "avg": 11.21, "max": 10.60, "min": 14.26, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.56, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 7.32, "avg": 3.66, "max": 0.92, "min": 6.40, "cnt": 2}, "forward-send-backward-recv":{"total": 204.13, "avg": 6.80, "max": 1.32, "min": 128.57, "cnt": 30}, "backward-compute":{"total": 1732.63, "avg": 54.14, "max": 50.91, "min": 57.90, "cnt": 32}, "MoE_L3_bwd":{"total": 406.22, "avg": 12.69, "max": 11.71, "min": 14.34, "cnt": 32}, "MoE_L2_bwd":{"total": 386.73, "avg": 12.09, "max": 10.81, "min": 13.78, "cnt": 32}, "MoE_L1_bwd":{"total": 366.87, "avg": 11.46, "max": 10.78, "min": 12.46, "cnt": 32}, "MoE_L0_bwd":{"total": 358.26, "avg": 11.20, "max": 10.42, "min": 14.60, "cnt": 32}, "backward-send-forward-recv":{"total": 6159.94, "avg": 212.41, "max": 1.81, "min": 752.79, "cnt": 29}, "backward-send":{"total": 2.31, "avg": 0.77, "max": 0.63, "min": 0.97, "cnt": 3}, "backward-recv":{"total": 237.87, "avg": 118.93, "max": 59.30, "min": 178.57, "cnt": 2}, "backward-params-all-reduce":{"total": 500.44, "avg": 500.44, "max": 500.44, "min": 500.44, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 240.54, "avg": 240.54, "max": 240.54, "min": 240.54, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 196.24, "avg": 196.24, "max": 196.24, "min": 196.24, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.92, "avg": 6.92, "max": 6.92, "min": 6.92, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 29, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 88.30, "avg": 29.43, "max": 4.37, "min": 76.38, "cnt": 3}, "forward-compute":{"total": 1793.59, "avg": 56.05, "max": 50.53, "min": 65.15, "cnt": 32}, "fwd-compute":{"total": 1790.33, "avg": 55.95, "max": 50.46, "min": 65.06, "cnt": 32}, "batch-generator":{"total": 37.44, "avg": 1.17, "max": 0.66, "min": 2.04, "cnt": 32}, "fwd-embedding":{"total": 0.63, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1740.86, "avg": 54.40, "max": 48.88, "min": 63.68, "cnt": 32}, "fwd-layernorm":{"total": 9.79, "avg": 0.08, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 106.13, "avg": 0.83, "max": 0.74, "min": 1.51, "cnt": 128}, "fwd-misc":{"total": 21.17, "avg": 0.17, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1582.82, "avg": 12.37, "max": 10.16, "min": 17.55, "cnt": 128}, "MoE_L0_fwd":{"total": 439.50, "avg": 13.73, "max": 10.09, "min": 17.45, "cnt": 32}, "MoEMLP":{"total": 1565.88, "avg": 12.23, "max": 10.04, "min": 17.38, "cnt": 128}, "MoE_L1_fwd":{"total": 389.20, "avg": 12.16, "max": 11.11, "min": 13.64, "cnt": 32}, "MoE_L2_fwd":{"total": 374.89, "avg": 11.72, "max": 11.01, "min": 14.50, "cnt": 32}, "MoE_L3_fwd":{"total": 368.54, "avg": 11.52, "max": 10.60, "min": 14.29, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.04, "cnt": 32}, "forward-send":{"total": 1.51, "avg": 0.76, "max": 0.68, "min": 0.83, "cnt": 2}, "forward-send-backward-recv":{"total": 3982.97, "avg": 132.77, "max": 1.82, "min": 433.51, "cnt": 30}, "backward-compute":{"total": 1743.45, "avg": 54.48, "max": 52.64, "min": 57.21, "cnt": 32}, "MoE_L3_bwd":{"total": 428.27, "avg": 13.38, "max": 12.06, "min": 15.84, "cnt": 32}, "MoE_L2_bwd":{"total": 382.25, "avg": 11.95, "max": 11.21, "min": 14.02, "cnt": 32}, "MoE_L1_bwd":{"total": 367.69, "avg": 11.49, "max": 10.83, "min": 13.71, "cnt": 32}, "MoE_L0_bwd":{"total": 350.27, "avg": 10.95, "max": 10.27, "min": 12.95, "cnt": 32}, "backward-send-forward-recv":{"total": 2374.16, "avg": 81.87, "max": 1.18, "min": 610.91, "cnt": 29}, "backward-send":{"total": 2.19, "avg": 0.73, "max": 0.64, "min": 0.85, "cnt": 3}, "backward-recv":{"total": 498.54, "avg": 249.27, "max": 73.20, "min": 425.35, "cnt": 2}, "backward-params-all-reduce":{"total": 488.76, "avg": 488.76, "max": 488.76, "min": 488.76, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 248.58, "avg": 248.58, "max": 248.58, "min": 248.58, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.36, "avg": 3.36, "max": 3.36, "min": 3.36, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 204.39, "avg": 204.39, "max": 204.39, "min": 204.39, "cnt": 1}, "optimizer-clip-main-grad":{"total": 7.03, "avg": 7.03, "max": 7.03, "min": 7.03, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 30, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 85.57, "avg": 28.52, "max": 1.42, "min": 79.42, "cnt": 3}, "forward-compute":{"total": 1874.98, "avg": 58.59, "max": 49.61, "min": 115.54, "cnt": 32}, "fwd-compute":{"total": 1871.75, "avg": 58.49, "max": 49.53, "min": 115.44, "cnt": 32}, "batch-generator":{"total": 41.72, "avg": 1.30, "max": 0.67, "min": 3.36, "cnt": 32}, "fwd-embedding":{"total": 0.60, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1817.23, "avg": 56.79, "max": 48.53, "min": 111.49, "cnt": 32}, "fwd-layernorm":{"total": 10.24, "avg": 0.08, "max": 0.05, "min": 0.38, "cnt": 128}, "fwd-attn":{"total": 110.90, "avg": 0.87, "max": 0.74, "min": 2.23, "cnt": 128}, "fwd-misc":{"total": 21.60, "avg": 0.17, "max": 0.11, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1652.55, "avg": 12.91, "max": 10.66, "min": 70.45, "cnt": 128}, "MoE_L0_fwd":{"total": 513.00, "avg": 16.03, "max": 10.59, "min": 70.35, "cnt": 32}, "MoEMLP":{"total": 1634.86, "avg": 12.77, "max": 10.55, "min": 70.30, "cnt": 128}, "MoE_L1_fwd":{"total": 384.51, "avg": 12.02, "max": 11.11, "min": 13.43, "cnt": 32}, "MoE_L2_fwd":{"total": 378.33, "avg": 11.82, "max": 10.88, "min": 13.49, "cnt": 32}, "MoE_L3_fwd":{"total": 365.37, "avg": 11.42, "max": 10.79, "min": 13.92, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 4.88, "avg": 2.44, "max": 0.91, "min": 3.96, "cnt": 2}, "forward-send-backward-recv":{"total": 1756.30, "avg": 58.54, "max": 1.38, "min": 417.10, "cnt": 30}, "backward-compute":{"total": 1725.29, "avg": 53.92, "max": 51.06, "min": 55.27, "cnt": 32}, "MoE_L3_bwd":{"total": 416.89, "avg": 13.03, "max": 12.17, "min": 14.44, "cnt": 32}, "MoE_L2_bwd":{"total": 375.71, "avg": 11.74, "max": 10.83, "min": 12.66, "cnt": 32}, "MoE_L1_bwd":{"total": 364.78, "avg": 11.40, "max": 10.48, "min": 11.81, "cnt": 32}, "MoE_L0_bwd":{"total": 352.40, "avg": 11.01, "max": 10.44, "min": 11.44, "cnt": 32}, "backward-send-forward-recv":{"total": 3636.48, "avg": 125.40, "max": 0.95, "min": 567.86, "cnt": 29}, "backward-send":{"total": 2.46, "avg": 0.82, "max": 0.65, "min": 0.97, "cnt": 3}, "backward-recv":{"total": 393.02, "avg": 196.51, "max": 76.35, "min": 316.67, "cnt": 2}, "backward-params-all-reduce":{"total": 483.37, "avg": 483.37, "max": 483.37, "min": 483.37, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 262.05, "avg": 262.05, "max": 262.05, "min": 262.05, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 217.70, "avg": 217.70, "max": 217.70, "min": 217.70, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.95, "avg": 6.95, "max": 6.95, "min": 6.95, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 31, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 88.20, "avg": 29.40, "max": 3.56, "min": 75.01, "cnt": 3}, "forward-compute":{"total": 1825.95, "avg": 57.06, "max": 51.15, "min": 69.55, "cnt": 32}, "fwd-compute":{"total": 1822.85, "avg": 56.96, "max": 51.04, "min": 69.45, "cnt": 32}, "batch-generator":{"total": 52.25, "avg": 1.63, "max": 0.63, "min": 4.35, "cnt": 32}, "fwd-embedding":{"total": 0.59, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1758.83, "avg": 54.96, "max": 49.75, "min": 65.21, "cnt": 32}, "fwd-layernorm":{"total": 9.39, "avg": 0.07, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 105.36, "avg": 0.82, "max": 0.74, "min": 1.53, "cnt": 128}, "fwd-misc":{"total": 20.28, "avg": 0.16, "max": 0.11, "min": 0.34, "cnt": 128}, "fwd-MLP":{"total": 1603.47, "avg": 12.53, "max": 10.83, "min": 18.69, "cnt": 128}, "MoE_L0_fwd":{"total": 452.05, "avg": 14.13, "max": 11.34, "min": 18.62, "cnt": 32}, "MoEMLP":{"total": 1587.42, "avg": 12.40, "max": 10.72, "min": 18.57, "cnt": 128}, "MoE_L1_fwd":{"total": 389.31, "avg": 12.17, "max": 11.19, "min": 16.72, "cnt": 32}, "MoE_L2_fwd":{"total": 382.04, "avg": 11.94, "max": 11.27, "min": 17.00, "cnt": 32}, "MoE_L3_fwd":{"total": 370.02, "avg": 11.56, "max": 10.76, "min": 12.58, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.62, "avg": 0.81, "max": 0.78, "min": 0.84, "cnt": 2}, "forward-send-backward-recv":{"total": 252.94, "avg": 8.43, "max": 1.68, "min": 126.65, "cnt": 30}, "backward-compute":{"total": 1756.24, "avg": 54.88, "max": 49.70, "min": 57.18, "cnt": 32}, "MoE_L3_bwd":{"total": 424.74, "avg": 13.27, "max": 11.12, "min": 14.79, "cnt": 32}, "MoE_L2_bwd":{"total": 381.19, "avg": 11.91, "max": 10.73, "min": 13.28, "cnt": 32}, "MoE_L1_bwd":{"total": 367.99, "avg": 11.50, "max": 10.77, "min": 12.42, "cnt": 32}, "MoE_L0_bwd":{"total": 367.47, "avg": 11.48, "max": 10.68, "min": 13.57, "cnt": 32}, "backward-send-forward-recv":{"total": 7293.34, "avg": 251.49, "max": 2.47, "min": 1242.63, "cnt": 29}, "backward-send":{"total": 2.62, "avg": 0.87, "max": 0.72, "min": 0.97, "cnt": 3}, "backward-recv":{"total": 255.99, "avg": 127.99, "max": 84.23, "min": 171.76, "cnt": 2}, "backward-params-all-reduce":{"total": 489.91, "avg": 489.91, "max": 489.91, "min": 489.91, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 252.34, "avg": 252.34, "max": 252.34, "min": 252.34, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 208.13, "avg": 208.13, "max": 208.13, "min": 208.13, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.97, "avg": 6.97, "max": 6.97, "min": 6.97, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.41, "avg": 3.41, "max": 3.41, "min": 3.41, "cnt": 1}}}
{"type":"time", "iteration": 32, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 75.79, "avg": 25.26, "max": 1.21, "min": 73.28, "cnt": 3}, "forward-compute":{"total": 1809.67, "avg": 56.55, "max": 50.38, "min": 67.12, "cnt": 32}, "fwd-compute":{"total": 1806.66, "avg": 56.46, "max": 50.32, "min": 67.03, "cnt": 32}, "batch-generator":{"total": 50.13, "avg": 1.57, "max": 0.61, "min": 3.74, "cnt": 32}, "fwd-embedding":{"total": 0.60, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1744.75, "avg": 54.52, "max": 49.22, "min": 64.48, "cnt": 32}, "fwd-layernorm":{"total": 9.58, "avg": 0.07, "max": 0.05, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 107.40, "avg": 0.84, "max": 0.74, "min": 1.69, "cnt": 128}, "fwd-misc":{"total": 20.69, "avg": 0.16, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1586.17, "avg": 12.39, "max": 10.76, "min": 23.52, "cnt": 128}, "MoE_L0_fwd":{"total": 454.89, "avg": 14.22, "max": 10.75, "min": 23.22, "cnt": 32}, "MoEMLP":{"total": 1569.33, "avg": 12.26, "max": 10.64, "min": 23.14, "cnt": 128}, "MoE_L1_fwd":{"total": 381.99, "avg": 11.94, "max": 10.98, "min": 13.52, "cnt": 32}, "MoE_L2_fwd":{"total": 371.75, "avg": 11.62, "max": 11.02, "min": 12.60, "cnt": 32}, "MoE_L3_fwd":{"total": 366.87, "avg": 11.46, "max": 10.69, "min": 13.44, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.55, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 9.30, "avg": 4.65, "max": 0.97, "min": 8.32, "cnt": 2}, "forward-send-backward-recv":{"total": 200.61, "avg": 6.69, "max": 1.52, "min": 128.40, "cnt": 30}, "backward-compute":{"total": 1766.04, "avg": 55.19, "max": 53.21, "min": 57.64, "cnt": 32}, "MoE_L3_bwd":{"total": 422.87, "avg": 13.21, "max": 12.01, "min": 15.73, "cnt": 32}, "MoE_L2_bwd":{"total": 389.92, "avg": 12.19, "max": 11.26, "min": 13.33, "cnt": 32}, "MoE_L1_bwd":{"total": 368.26, "avg": 11.51, "max": 10.71, "min": 12.65, "cnt": 32}, "MoE_L0_bwd":{"total": 373.02, "avg": 11.66, "max": 10.95, "min": 14.05, "cnt": 32}, "backward-send-forward-recv":{"total": 7932.06, "avg": 273.52, "max": 2.24, "min": 1062.51, "cnt": 29}, "backward-send":{"total": 2.31, "avg": 0.77, "max": 0.51, "min": 0.98, "cnt": 3}, "backward-recv":{"total": 154.77, "avg": 77.39, "max": 63.26, "min": 91.51, "cnt": 2}, "backward-params-all-reduce":{"total": 495.73, "avg": 495.73, "max": 495.73, "min": 495.73, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 257.11, "avg": 257.11, "max": 257.11, "min": 257.11, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 212.90, "avg": 212.90, "max": 212.90, "min": 212.90, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.98, "avg": 6.98, "max": 6.98, "min": 6.98, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.40, "avg": 3.40, "max": 3.40, "min": 3.40, "cnt": 1}}}
{"type":"time", "iteration": 33, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.10, "avg": 0.10, "max": 0.10, "min": 0.10, "cnt": 1}, "forward-recv":{"total": 75.44, "avg": 25.15, "max": 1.38, "min": 68.82, "cnt": 3}, "forward-compute":{"total": 1813.06, "avg": 56.66, "max": 50.20, "min": 66.25, "cnt": 32}, "fwd-compute":{"total": 1809.82, "avg": 56.56, "max": 50.13, "min": 66.07, "cnt": 32}, "batch-generator":{"total": 46.21, "avg": 1.44, "max": 0.65, "min": 3.50, "cnt": 32}, "fwd-embedding":{"total": 0.55, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1751.42, "avg": 54.73, "max": 49.16, "min": 63.33, "cnt": 32}, "fwd-layernorm":{"total": 9.39, "avg": 0.07, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 105.59, "avg": 0.82, "max": 0.74, "min": 1.52, "cnt": 128}, "fwd-misc":{"total": 20.40, "avg": 0.16, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1595.48, "avg": 12.46, "max": 10.93, "min": 23.77, "cnt": 128}, "MoE_L0_fwd":{"total": 463.00, "avg": 14.47, "max": 11.07, "min": 23.68, "cnt": 32}, "MoEMLP":{"total": 1579.19, "avg": 12.34, "max": 10.83, "min": 23.63, "cnt": 128}, "MoE_L1_fwd":{"total": 381.09, "avg": 11.91, "max": 11.06, "min": 14.18, "cnt": 32}, "MoE_L2_fwd":{"total": 374.52, "avg": 11.70, "max": 11.09, "min": 15.46, "cnt": 32}, "MoE_L3_fwd":{"total": 366.52, "avg": 11.45, "max": 10.87, "min": 13.35, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.54, "avg": 0.77, "max": 0.75, "min": 0.78, "cnt": 2}, "forward-send-backward-recv":{"total": 231.74, "avg": 7.72, "max": 1.12, "min": 130.65, "cnt": 30}, "backward-compute":{"total": 1753.68, "avg": 54.80, "max": 52.11, "min": 60.63, "cnt": 32}, "MoE_L3_bwd":{"total": 418.24, "avg": 13.07, "max": 11.94, "min": 17.82, "cnt": 32}, "MoE_L2_bwd":{"total": 381.35, "avg": 11.92, "max": 10.92, "min": 12.80, "cnt": 32}, "MoE_L1_bwd":{"total": 367.98, "avg": 11.50, "max": 11.18, "min": 12.27, "cnt": 32}, "MoE_L0_bwd":{"total": 373.90, "avg": 11.68, "max": 11.10, "min": 13.09, "cnt": 32}, "backward-send-forward-recv":{"total": 9803.86, "avg": 338.06, "max": 2.38, "min": 1195.31, "cnt": 29}, "backward-send":{"total": 3.17, "avg": 1.06, "max": 0.94, "min": 1.13, "cnt": 3}, "backward-recv":{"total": 126.59, "avg": 63.30, "max": 59.87, "min": 66.72, "cnt": 2}, "backward-params-all-reduce":{"total": 489.55, "avg": 489.55, "max": 489.55, "min": 489.55, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 252.39, "avg": 252.39, "max": 252.39, "min": 252.39, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 207.48, "avg": 207.48, "max": 207.48, "min": 207.48, "cnt": 1}, "optimizer-clip-main-grad":{"total": 7.71, "avg": 7.71, "max": 7.71, "min": 7.71, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.47, "avg": 3.47, "max": 3.47, "min": 3.47, "cnt": 1}}}
{"type":"time", "iteration": 34, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 81.76, "avg": 27.25, "max": 2.59, "min": 75.51, "cnt": 3}, "forward-compute":{"total": 1839.88, "avg": 57.50, "max": 50.47, "min": 71.53, "cnt": 32}, "fwd-compute":{"total": 1836.89, "avg": 57.40, "max": 50.38, "min": 71.44, "cnt": 32}, "batch-generator":{"total": 55.87, "avg": 1.75, "max": 0.66, "min": 3.08, "cnt": 32}, "fwd-embedding":{"total": 0.56, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1769.32, "avg": 55.29, "max": 49.07, "min": 68.14, "cnt": 32}, "fwd-layernorm":{"total": 9.49, "avg": 0.07, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 105.86, "avg": 0.83, "max": 0.74, "min": 1.53, "cnt": 128}, "fwd-misc":{"total": 20.03, "avg": 0.16, "max": 0.11, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1613.84, "avg": 12.61, "max": 10.85, "min": 23.27, "cnt": 128}, "MoE_L0_fwd":{"total": 463.38, "avg": 14.48, "max": 10.83, "min": 23.16, "cnt": 32}, "MoEMLP":{"total": 1597.97, "avg": 12.48, "max": 10.75, "min": 23.11, "cnt": 128}, "MoE_L1_fwd":{"total": 395.54, "avg": 12.36, "max": 10.88, "min": 15.41, "cnt": 32}, "MoE_L2_fwd":{"total": 372.88, "avg": 11.65, "max": 11.13, "min": 13.76, "cnt": 32}, "MoE_L3_fwd":{"total": 372.08, "avg": 11.63, "max": 10.79, "min": 17.01, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.04, "cnt": 32}, "forward-send":{"total": 1.67, "avg": 0.84, "max": 0.81, "min": 0.86, "cnt": 2}, "forward-send-backward-recv":{"total": 214.14, "avg": 7.14, "max": 1.61, "min": 125.35, "cnt": 30}, "backward-compute":{"total": 1744.38, "avg": 54.51, "max": 53.39, "min": 56.35, "cnt": 32}, "MoE_L3_bwd":{"total": 407.50, "avg": 12.73, "max": 12.20, "min": 13.76, "cnt": 32}, "MoE_L2_bwd":{"total": 377.80, "avg": 11.81, "max": 11.14, "min": 12.55, "cnt": 32}, "MoE_L1_bwd":{"total": 372.42, "avg": 11.64, "max": 11.03, "min": 13.10, "cnt": 32}, "MoE_L0_bwd":{"total": 373.77, "avg": 11.68, "max": 11.36, "min": 12.68, "cnt": 32}, "backward-send-forward-recv":{"total": 11238.62, "avg": 387.54, "max": 2.11, "min": 2279.29, "cnt": 29}, "backward-send":{"total": 2.57, "avg": 0.86, "max": 0.70, "min": 1.03, "cnt": 3}, "backward-recv":{"total": 132.45, "avg": 66.23, "max": 56.93, "min": 75.52, "cnt": 2}, "backward-params-all-reduce":{"total": 487.38, "avg": 487.38, "max": 487.38, "min": 487.38, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 250.44, "avg": 250.44, "max": 250.44, "min": 250.44, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.36, "avg": 3.36, "max": 3.36, "min": 3.36, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 206.22, "avg": 206.22, "max": 206.22, "min": 206.22, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.84, "avg": 6.84, "max": 6.84, "min": 6.84, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.49, "avg": 3.49, "max": 3.49, "min": 3.49, "cnt": 1}}}
{"type":"time", "iteration": 35, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 79.26, "avg": 26.42, "max": 0.78, "min": 77.23, "cnt": 3}, "forward-compute":{"total": 1827.99, "avg": 57.12, "max": 51.84, "min": 66.04, "cnt": 32}, "fwd-compute":{"total": 1825.11, "avg": 57.03, "max": 51.77, "min": 65.91, "cnt": 32}, "batch-generator":{"total": 34.33, "avg": 1.07, "max": 0.64, "min": 2.19, "cnt": 32}, "fwd-embedding":{"total": 0.57, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1779.02, "avg": 55.59, "max": 50.62, "min": 63.86, "cnt": 32}, "fwd-layernorm":{"total": 9.44, "avg": 0.07, "max": 0.06, "min": 0.23, "cnt": 128}, "fwd-attn":{"total": 105.40, "avg": 0.82, "max": 0.74, "min": 1.81, "cnt": 128}, "fwd-misc":{"total": 20.13, "avg": 0.16, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1623.05, "avg": 12.68, "max": 10.87, "min": 21.03, "cnt": 128}, "MoE_L0_fwd":{"total": 482.98, "avg": 15.09, "max": 11.79, "min": 20.90, "cnt": 32}, "MoEMLP":{"total": 1606.31, "avg": 12.55, "max": 10.74, "min": 20.85, "cnt": 128}, "MoE_L1_fwd":{"total": 382.48, "avg": 11.95, "max": 10.93, "min": 15.12, "cnt": 32}, "MoE_L2_fwd":{"total": 379.21, "avg": 11.85, "max": 11.27, "min": 17.64, "cnt": 32}, "MoE_L3_fwd":{"total": 367.79, "avg": 11.49, "max": 10.79, "min": 12.80, "cnt": 32}, "fwd-pooler":{"total": 0.37, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 5.22, "avg": 2.61, "max": 1.00, "min": 4.22, "cnt": 2}, "forward-send-backward-recv":{"total": 197.02, "avg": 6.57, "max": 1.21, "min": 122.60, "cnt": 30}, "backward-compute":{"total": 1732.45, "avg": 54.14, "max": 51.28, "min": 56.17, "cnt": 32}, "MoE_L3_bwd":{"total": 415.28, "avg": 12.98, "max": 12.15, "min": 14.17, "cnt": 32}, "MoE_L2_bwd":{"total": 378.17, "avg": 11.82, "max": 10.86, "min": 12.48, "cnt": 32}, "MoE_L1_bwd":{"total": 348.03, "avg": 10.88, "max": 10.34, "min": 11.80, "cnt": 32}, "MoE_L0_bwd":{"total": 375.64, "avg": 11.74, "max": 11.16, "min": 12.22, "cnt": 32}, "backward-send-forward-recv":{"total": 4588.30, "avg": 158.22, "max": 2.22, "min": 519.52, "cnt": 29}, "backward-send":{"total": 3.36, "avg": 1.12, "max": 1.09, "min": 1.16, "cnt": 3}, "backward-recv":{"total": 131.32, "avg": 65.66, "max": 60.55, "min": 70.77, "cnt": 2}, "backward-params-all-reduce":{"total": 485.89, "avg": 485.89, "max": 485.89, "min": 485.89, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 253.51, "avg": 253.51, "max": 253.51, "min": 253.51, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 209.19, "avg": 209.19, "max": 209.19, "min": 209.19, "cnt": 1}, "optimizer-clip-main-grad":{"total": 7.09, "avg": 7.09, "max": 7.09, "min": 7.09, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 36, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 741.73, "avg": 247.24, "max": 6.13, "min": 655.30, "cnt": 3}, "forward-compute":{"total": 1792.63, "avg": 56.02, "max": 50.45, "min": 61.16, "cnt": 32}, "fwd-compute":{"total": 1789.59, "avg": 55.92, "max": 50.37, "min": 61.09, "cnt": 32}, "batch-generator":{"total": 35.06, "avg": 1.10, "max": 0.69, "min": 1.77, "cnt": 32}, "fwd-embedding":{"total": 0.55, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1742.85, "avg": 54.46, "max": 49.39, "min": 59.95, "cnt": 32}, "fwd-layernorm":{"total": 9.30, "avg": 0.07, "max": 0.05, "min": 0.18, "cnt": 128}, "fwd-attn":{"total": 106.16, "avg": 0.83, "max": 0.74, "min": 1.71, "cnt": 128}, "fwd-misc":{"total": 20.70, "avg": 0.16, "max": 0.11, "min": 0.42, "cnt": 128}, "fwd-MLP":{"total": 1586.08, "avg": 12.39, "max": 10.55, "min": 20.08, "cnt": 128}, "MoE_L0_fwd":{"total": 485.82, "avg": 15.18, "max": 12.29, "min": 20.00, "cnt": 32}, "MoEMLP":{"total": 1569.64, "avg": 12.26, "max": 10.44, "min": 19.95, "cnt": 128}, "MoE_L1_fwd":{"total": 373.71, "avg": 11.68, "max": 10.55, "min": 14.53, "cnt": 32}, "MoE_L2_fwd":{"total": 354.39, "avg": 11.07, "max": 10.48, "min": 12.06, "cnt": 32}, "MoE_L3_fwd":{"total": 361.79, "avg": 11.31, "max": 10.76, "min": 12.46, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.85, "avg": 0.93, "max": 0.88, "min": 0.97, "cnt": 2}, "forward-send-backward-recv":{"total": 1474.30, "avg": 49.14, "max": 1.65, "min": 358.13, "cnt": 30}, "backward-compute":{"total": 1717.58, "avg": 53.67, "max": 50.12, "min": 57.12, "cnt": 32}, "MoE_L3_bwd":{"total": 415.53, "avg": 12.99, "max": 12.13, "min": 16.03, "cnt": 32}, "MoE_L2_bwd":{"total": 364.65, "avg": 11.40, "max": 10.14, "min": 12.26, "cnt": 32}, "MoE_L1_bwd":{"total": 348.05, "avg": 10.88, "max": 10.29, "min": 11.30, "cnt": 32}, "MoE_L0_bwd":{"total": 374.37, "avg": 11.70, "max": 10.66, "min": 12.58, "cnt": 32}, "backward-send-forward-recv":{"total": 5234.46, "avg": 180.50, "max": 1.65, "min": 810.23, "cnt": 29}, "backward-send":{"total": 2.22, "avg": 0.74, "max": 0.54, "min": 1.08, "cnt": 3}, "backward-recv":{"total": 431.70, "avg": 215.85, "max": 79.97, "min": 351.74, "cnt": 2}, "backward-params-all-reduce":{"total": 487.11, "avg": 487.11, "max": 487.11, "min": 487.11, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.04, "avg": 0.04, "max": 0.04, "min": 0.04, "cnt": 1}, "optimizer":{"total": 254.68, "avg": 254.68, "max": 254.68, "min": 254.68, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.36, "avg": 3.36, "max": 3.36, "min": 3.36, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 210.41, "avg": 210.41, "max": 210.41, "min": 210.41, "cnt": 1}, "optimizer-clip-main-grad":{"total": 7.01, "avg": 7.01, "max": 7.01, "min": 7.01, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}}}
{"type":"time", "iteration": 37, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 84.16, "avg": 28.05, "max": 1.71, "min": 79.99, "cnt": 3}, "forward-compute":{"total": 1828.53, "avg": 57.14, "max": 49.51, "min": 69.81, "cnt": 32}, "fwd-compute":{"total": 1825.33, "avg": 57.04, "max": 49.44, "min": 69.72, "cnt": 32}, "batch-generator":{"total": 50.10, "avg": 1.57, "max": 0.66, "min": 3.26, "cnt": 32}, "fwd-embedding":{"total": 0.54, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1763.51, "avg": 55.11, "max": 48.47, "min": 67.89, "cnt": 32}, "fwd-layernorm":{"total": 9.11, "avg": 0.07, "max": 0.05, "min": 0.27, "cnt": 128}, "fwd-attn":{"total": 103.63, "avg": 0.81, "max": 0.74, "min": 2.24, "cnt": 128}, "fwd-misc":{"total": 19.75, "avg": 0.15, "max": 0.11, "min": 0.44, "cnt": 128}, "fwd-MLP":{"total": 1611.14, "avg": 12.59, "max": 10.75, "min": 25.25, "cnt": 128}, "MoE_L0_fwd":{"total": 487.21, "avg": 15.23, "max": 11.07, "min": 25.17, "cnt": 32}, "MoEMLP":{"total": 1594.93, "avg": 12.46, "max": 10.64, "min": 25.13, "cnt": 128}, "MoE_L1_fwd":{"total": 378.38, "avg": 11.82, "max": 10.93, "min": 15.14, "cnt": 32}, "MoE_L2_fwd":{"total": 363.68, "avg": 11.36, "max": 10.68, "min": 12.99, "cnt": 32}, "MoE_L3_fwd":{"total": 371.50, "avg": 11.61, "max": 11.01, "min": 14.13, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.56, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 8.41, "avg": 4.21, "max": 1.00, "min": 7.42, "cnt": 2}, "forward-send-backward-recv":{"total": 212.62, "avg": 7.09, "max": 0.94, "min": 127.99, "cnt": 30}, "backward-compute":{"total": 1721.53, "avg": 53.80, "max": 51.36, "min": 56.73, "cnt": 32}, "MoE_L3_bwd":{"total": 417.45, "avg": 13.05, "max": 12.28, "min": 15.97, "cnt": 32}, "MoE_L2_bwd":{"total": 366.51, "avg": 11.45, "max": 11.15, "min": 12.07, "cnt": 32}, "MoE_L1_bwd":{"total": 351.50, "avg": 10.98, "max": 10.54, "min": 11.31, "cnt": 32}, "MoE_L0_bwd":{"total": 373.09, "avg": 11.66, "max": 11.07, "min": 13.24, "cnt": 32}, "backward-send-forward-recv":{"total": 6625.84, "avg": 228.48, "max": 2.51, "min": 746.37, "cnt": 29}, "backward-send":{"total": 2.27, "avg": 0.76, "max": 0.55, "min": 0.90, "cnt": 3}, "backward-recv":{"total": 682.66, "avg": 341.33, "max": 71.26, "min": 611.40, "cnt": 2}, "backward-params-all-reduce":{"total": 488.84, "avg": 488.84, "max": 488.84, "min": 488.84, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 255.44, "avg": 255.44, "max": 255.44, "min": 255.44, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 211.34, "avg": 211.34, "max": 211.34, "min": 211.34, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.90, "avg": 6.90, "max": 6.90, "min": 6.90, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 38, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 79.46, "avg": 26.49, "max": 1.02, "min": 70.85, "cnt": 3}, "forward-compute":{"total": 1790.16, "avg": 55.94, "max": 49.69, "min": 66.28, "cnt": 32}, "fwd-compute":{"total": 1787.25, "avg": 55.85, "max": 49.62, "min": 66.19, "cnt": 32}, "batch-generator":{"total": 49.19, "avg": 1.54, "max": 0.65, "min": 3.89, "cnt": 32}, "fwd-embedding":{"total": 0.52, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1726.49, "avg": 53.95, "max": 48.68, "min": 63.65, "cnt": 32}, "fwd-layernorm":{"total": 8.94, "avg": 0.07, "max": 0.06, "min": 0.18, "cnt": 128}, "fwd-attn":{"total": 102.10, "avg": 0.80, "max": 0.74, "min": 1.49, "cnt": 128}, "fwd-misc":{"total": 19.60, "avg": 0.15, "max": 0.12, "min": 0.34, "cnt": 128}, "fwd-MLP":{"total": 1576.09, "avg": 12.31, "max": 10.75, "min": 21.24, "cnt": 128}, "MoE_L0_fwd":{"total": 454.72, "avg": 14.21, "max": 11.19, "min": 21.16, "cnt": 32}, "MoEMLP":{"total": 1560.41, "avg": 12.19, "max": 10.64, "min": 21.12, "cnt": 128}, "MoE_L1_fwd":{"total": 375.05, "avg": 11.72, "max": 10.68, "min": 13.78, "cnt": 32}, "MoE_L2_fwd":{"total": 371.32, "avg": 11.60, "max": 11.08, "min": 13.90, "cnt": 32}, "MoE_L3_fwd":{"total": 365.17, "avg": 11.41, "max": 10.80, "min": 17.26, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.78, "avg": 0.89, "max": 0.89, "min": 0.90, "cnt": 2}, "forward-send-backward-recv":{"total": 197.47, "avg": 6.58, "max": 1.47, "min": 119.21, "cnt": 30}, "backward-compute":{"total": 1728.24, "avg": 54.01, "max": 51.01, "min": 56.77, "cnt": 32}, "MoE_L3_bwd":{"total": 413.48, "avg": 12.92, "max": 11.87, "min": 15.36, "cnt": 32}, "MoE_L2_bwd":{"total": 377.89, "avg": 11.81, "max": 10.72, "min": 12.54, "cnt": 32}, "MoE_L1_bwd":{"total": 351.06, "avg": 10.97, "max": 10.42, "min": 11.50, "cnt": 32}, "MoE_L0_bwd":{"total": 368.79, "avg": 11.52, "max": 10.94, "min": 13.97, "cnt": 32}, "backward-send-forward-recv":{"total": 6550.25, "avg": 225.87, "max": 2.46, "min": 602.30, "cnt": 29}, "backward-send":{"total": 2.14, "avg": 0.71, "max": 0.58, "min": 0.98, "cnt": 3}, "backward-recv":{"total": 314.88, "avg": 157.44, "max": 69.34, "min": 245.54, "cnt": 2}, "backward-params-all-reduce":{"total": 488.30, "avg": 488.30, "max": 488.30, "min": 488.30, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 259.87, "avg": 259.87, "max": 259.87, "min": 259.87, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.36, "avg": 3.36, "max": 3.36, "min": 3.36, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 214.71, "avg": 214.71, "max": 214.71, "min": 214.71, "cnt": 1}, "optimizer-clip-main-grad":{"total": 7.89, "avg": 7.89, "max": 7.89, "min": 7.89, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.41, "avg": 3.41, "max": 3.41, "min": 3.41, "cnt": 1}}}
{"type":"time", "iteration": 39, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 87.04, "avg": 29.01, "max": 1.64, "min": 79.76, "cnt": 3}, "forward-compute":{"total": 1776.65, "avg": 55.52, "max": 49.82, "min": 62.53, "cnt": 32}, "fwd-compute":{"total": 1773.74, "avg": 55.43, "max": 49.75, "min": 62.45, "cnt": 32}, "batch-generator":{"total": 42.26, "avg": 1.32, "max": 0.70, "min": 3.36, "cnt": 32}, "fwd-embedding":{"total": 0.50, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1720.06, "avg": 53.75, "max": 48.77, "min": 61.01, "cnt": 32}, "fwd-layernorm":{"total": 9.07, "avg": 0.07, "max": 0.05, "min": 0.18, "cnt": 128}, "fwd-attn":{"total": 104.00, "avg": 0.81, "max": 0.74, "min": 1.46, "cnt": 128}, "fwd-misc":{"total": 19.90, "avg": 0.16, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1566.84, "avg": 12.24, "max": 10.55, "min": 20.24, "cnt": 128}, "MoE_L0_fwd":{"total": 457.79, "avg": 14.31, "max": 11.28, "min": 20.10, "cnt": 32}, "MoEMLP":{"total": 1550.59, "avg": 12.11, "max": 10.44, "min": 20.05, "cnt": 128}, "MoE_L1_fwd":{"total": 368.75, "avg": 11.52, "max": 10.48, "min": 14.13, "cnt": 32}, "MoE_L2_fwd":{"total": 368.94, "avg": 11.53, "max": 11.04, "min": 15.23, "cnt": 32}, "MoE_L3_fwd":{"total": 361.08, "avg": 11.28, "max": 10.68, "min": 13.70, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.59, "avg": 0.79, "max": 0.71, "min": 0.88, "cnt": 2}, "forward-send-backward-recv":{"total": 202.38, "avg": 6.75, "max": 1.68, "min": 122.08, "cnt": 30}, "backward-compute":{"total": 1718.87, "avg": 53.71, "max": 51.43, "min": 55.52, "cnt": 32}, "MoE_L3_bwd":{"total": 402.28, "avg": 12.57, "max": 11.67, "min": 14.25, "cnt": 32}, "MoE_L2_bwd":{"total": 386.83, "avg": 12.09, "max": 11.07, "min": 12.82, "cnt": 32}, "MoE_L1_bwd":{"total": 352.95, "avg": 11.03, "max": 10.50, "min": 11.68, "cnt": 32}, "MoE_L0_bwd":{"total": 364.35, "avg": 11.39, "max": 10.71, "min": 12.21, "cnt": 32}, "backward-send-forward-recv":{"total": 6172.63, "avg": 212.85, "max": 2.36, "min": 1189.09, "cnt": 29}, "backward-send":{"total": 3.18, "avg": 1.06, "max": 0.98, "min": 1.13, "cnt": 3}, "backward-recv":{"total": 297.30, "avg": 148.65, "max": 66.14, "min": 231.16, "cnt": 2}, "backward-params-all-reduce":{"total": 484.74, "avg": 484.74, "max": 484.74, "min": 484.74, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 254.69, "avg": 254.69, "max": 254.69, "min": 254.69, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 210.56, "avg": 210.56, "max": 210.56, "min": 210.56, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.93, "avg": 6.93, "max": 6.93, "min": 6.93, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 40, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 156.13, "avg": 52.04, "max": 1.07, "min": 151.18, "cnt": 3}, "forward-compute":{"total": 1881.92, "avg": 58.81, "max": 50.46, "min": 127.08, "cnt": 32}, "fwd-compute":{"total": 1879.03, "avg": 58.72, "max": 50.36, "min": 126.97, "cnt": 32}, "batch-generator":{"total": 52.26, "avg": 1.63, "max": 0.70, "min": 4.32, "cnt": 32}, "fwd-embedding":{"total": 0.54, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1814.64, "avg": 56.71, "max": 49.13, "min": 123.11, "cnt": 32}, "fwd-layernorm":{"total": 9.47, "avg": 0.07, "max": 0.06, "min": 0.22, "cnt": 128}, "fwd-attn":{"total": 105.24, "avg": 0.82, "max": 0.74, "min": 1.56, "cnt": 128}, "fwd-misc":{"total": 21.22, "avg": 0.17, "max": 0.11, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1657.85, "avg": 12.95, "max": 10.72, "min": 83.99, "cnt": 128}, "MoE_L0_fwd":{"total": 524.35, "avg": 16.39, "max": 10.79, "min": 83.87, "cnt": 32}, "MoEMLP":{"total": 1640.82, "avg": 12.82, "max": 10.60, "min": 83.82, "cnt": 128}, "MoE_L1_fwd":{"total": 379.79, "avg": 11.87, "max": 10.74, "min": 15.53, "cnt": 32}, "MoE_L2_fwd":{"total": 376.81, "avg": 11.78, "max": 10.65, "min": 15.81, "cnt": 32}, "MoE_L3_fwd":{"total": 366.37, "avg": 11.45, "max": 10.78, "min": 12.76, "cnt": 32}, "fwd-pooler":{"total": 0.36, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.61, "avg": 0.02, "max": 0.02, "min": 0.05, "cnt": 32}, "forward-send":{"total": 1.73, "avg": 0.86, "max": 0.80, "min": 0.93, "cnt": 2}, "forward-send-backward-recv":{"total": 330.68, "avg": 11.02, "max": 1.30, "min": 138.31, "cnt": 30}, "backward-compute":{"total": 1744.37, "avg": 54.51, "max": 53.24, "min": 55.69, "cnt": 32}, "MoE_L3_bwd":{"total": 415.90, "avg": 13.00, "max": 12.21, "min": 14.33, "cnt": 32}, "MoE_L2_bwd":{"total": 385.32, "avg": 12.04, "max": 11.27, "min": 12.94, "cnt": 32}, "MoE_L1_bwd":{"total": 362.57, "avg": 11.33, "max": 10.50, "min": 12.27, "cnt": 32}, "MoE_L0_bwd":{"total": 365.22, "avg": 11.41, "max": 10.81, "min": 12.56, "cnt": 32}, "backward-send-forward-recv":{"total": 4940.87, "avg": 170.37, "max": 1.68, "min": 888.76, "cnt": 29}, "backward-send":{"total": 2.78, "avg": 0.93, "max": 0.86, "min": 1.01, "cnt": 3}, "backward-recv":{"total": 314.50, "avg": 157.25, "max": 72.07, "min": 242.42, "cnt": 2}, "backward-params-all-reduce":{"total": 491.02, "avg": 491.02, "max": 491.02, "min": 491.02, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 254.92, "avg": 254.92, "max": 254.92, "min": 254.92, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.36, "avg": 3.36, "max": 3.36, "min": 3.36, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 208.85, "avg": 208.85, "max": 208.85, "min": 208.85, "cnt": 1}, "optimizer-clip-main-grad":{"total": 8.83, "avg": 8.83, "max": 8.83, "min": 8.83, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.47, "avg": 3.47, "max": 3.47, "min": 3.47, "cnt": 1}}}
{"type":"time", "iteration": 41, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 86.41, "avg": 28.80, "max": 2.35, "min": 81.09, "cnt": 3}, "forward-compute":{"total": 1819.68, "avg": 56.87, "max": 51.15, "min": 64.27, "cnt": 32}, "fwd-compute":{"total": 1816.84, "avg": 56.78, "max": 51.07, "min": 64.19, "cnt": 32}, "batch-generator":{"total": 49.77, "avg": 1.56, "max": 0.67, "min": 4.18, "cnt": 32}, "fwd-embedding":{"total": 0.48, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1755.58, "avg": 54.86, "max": 49.87, "min": 61.48, "cnt": 32}, "fwd-layernorm":{"total": 8.77, "avg": 0.07, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 101.53, "avg": 0.79, "max": 0.74, "min": 1.61, "cnt": 128}, "fwd-misc":{"total": 19.36, "avg": 0.15, "max": 0.11, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1606.50, "avg": 12.55, "max": 10.70, "min": 18.39, "cnt": 128}, "MoE_L0_fwd":{"total": 458.29, "avg": 14.32, "max": 11.68, "min": 18.31, "cnt": 32}, "MoEMLP":{"total": 1591.09, "avg": 12.43, "max": 10.60, "min": 18.26, "cnt": 128}, "MoE_L1_fwd":{"total": 400.58, "avg": 12.52, "max": 10.94, "min": 13.94, "cnt": 32}, "MoE_L2_fwd":{"total": 369.74, "avg": 11.55, "max": 10.78, "min": 12.84, "cnt": 32}, "MoE_L3_fwd":{"total": 368.23, "avg": 11.51, "max": 10.64, "min": 16.66, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 2.30, "avg": 1.15, "max": 0.69, "min": 1.61, "cnt": 2}, "forward-send-backward-recv":{"total": 200.19, "avg": 6.67, "max": 1.18, "min": 127.85, "cnt": 30}, "backward-compute":{"total": 1772.68, "avg": 55.40, "max": 52.59, "min": 57.26, "cnt": 32}, "MoE_L3_bwd":{"total": 411.30, "avg": 12.85, "max": 11.91, "min": 14.66, "cnt": 32}, "MoE_L2_bwd":{"total": 383.82, "avg": 11.99, "max": 11.07, "min": 13.07, "cnt": 32}, "MoE_L1_bwd":{"total": 386.40, "avg": 12.07, "max": 11.22, "min": 13.43, "cnt": 32}, "MoE_L0_bwd":{"total": 377.17, "avg": 11.79, "max": 11.11, "min": 12.40, "cnt": 32}, "backward-send-forward-recv":{"total": 6572.86, "avg": 226.65, "max": 1.65, "min": 816.64, "cnt": 29}, "backward-send":{"total": 2.59, "avg": 0.86, "max": 0.83, "min": 0.89, "cnt": 3}, "backward-recv":{"total": 341.79, "avg": 170.89, "max": 74.40, "min": 267.39, "cnt": 2}, "backward-params-all-reduce":{"total": 484.74, "avg": 484.74, "max": 484.74, "min": 484.74, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 257.30, "avg": 257.30, "max": 257.30, "min": 257.30, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.36, "avg": 3.36, "max": 3.36, "min": 3.36, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 212.95, "avg": 212.95, "max": 212.95, "min": 212.95, "cnt": 1}, "optimizer-clip-main-grad":{"total": 7.05, "avg": 7.05, "max": 7.05, "min": 7.05, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}}}
{"type":"time", "iteration": 42, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 91.94, "avg": 30.65, "max": 3.39, "min": 77.08, "cnt": 3}, "forward-compute":{"total": 1884.47, "avg": 58.89, "max": 51.33, "min": 64.75, "cnt": 32}, "fwd-compute":{"total": 1881.29, "avg": 58.79, "max": 51.26, "min": 64.66, "cnt": 32}, "batch-generator":{"total": 48.32, "avg": 1.51, "max": 0.68, "min": 3.55, "cnt": 32}, "fwd-embedding":{"total": 0.64, "avg": 0.02, "max": 0.01, "min": 0.06, "cnt": 32}, "fwd-encoder":{"total": 1819.87, "avg": 56.87, "max": 50.30, "min": 63.10, "cnt": 32}, "fwd-layernorm":{"total": 10.11, "avg": 0.08, "max": 0.05, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 108.77, "avg": 0.85, "max": 0.74, "min": 1.60, "cnt": 128}, "fwd-misc":{"total": 21.28, "avg": 0.17, "max": 0.11, "min": 0.39, "cnt": 128}, "fwd-MLP":{"total": 1657.98, "avg": 12.95, "max": 10.45, "min": 21.09, "cnt": 128}, "MoE_L0_fwd":{"total": 509.93, "avg": 15.94, "max": 12.02, "min": 21.00, "cnt": 32}, "MoEMLP":{"total": 1641.07, "avg": 12.82, "max": 10.35, "min": 20.95, "cnt": 128}, "MoE_L1_fwd":{"total": 397.22, "avg": 12.41, "max": 11.41, "min": 14.18, "cnt": 32}, "MoE_L2_fwd":{"total": 368.86, "avg": 11.53, "max": 10.39, "min": 12.19, "cnt": 32}, "MoE_L3_fwd":{"total": 371.32, "avg": 11.60, "max": 10.82, "min": 13.99, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 2.00, "avg": 1.00, "max": 0.91, "min": 1.10, "cnt": 2}, "forward-send-backward-recv":{"total": 190.36, "avg": 6.35, "max": 1.53, "min": 117.75, "cnt": 30}, "backward-compute":{"total": 1800.82, "avg": 56.28, "max": 54.55, "min": 58.84, "cnt": 32}, "MoE_L3_bwd":{"total": 415.77, "avg": 12.99, "max": 12.24, "min": 14.67, "cnt": 32}, "MoE_L2_bwd":{"total": 385.01, "avg": 12.03, "max": 10.95, "min": 15.01, "cnt": 32}, "MoE_L1_bwd":{"total": 396.34, "avg": 12.39, "max": 11.53, "min": 13.71, "cnt": 32}, "MoE_L0_bwd":{"total": 389.09, "avg": 12.16, "max": 11.29, "min": 13.22, "cnt": 32}, "backward-send-forward-recv":{"total": 6772.13, "avg": 233.52, "max": 2.40, "min": 1143.71, "cnt": 29}, "backward-send":{"total": 2.51, "avg": 0.84, "max": 0.61, "min": 1.07, "cnt": 3}, "backward-recv":{"total": 148.35, "avg": 74.17, "max": 71.25, "min": 77.10, "cnt": 2}, "backward-params-all-reduce":{"total": 488.21, "avg": 488.21, "max": 488.21, "min": 488.21, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 254.24, "avg": 254.24, "max": 254.24, "min": 254.24, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 210.07, "avg": 210.07, "max": 210.07, "min": 210.07, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.96, "avg": 6.96, "max": 6.96, "min": 6.96, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}}}
{"type":"time", "iteration": 43, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 77.89, "avg": 25.96, "max": 0.96, "min": 73.26, "cnt": 3}, "forward-compute":{"total": 1854.80, "avg": 57.96, "max": 52.34, "min": 66.44, "cnt": 32}, "fwd-compute":{"total": 1851.84, "avg": 57.87, "max": 52.24, "min": 66.36, "cnt": 32}, "batch-generator":{"total": 36.58, "avg": 1.14, "max": 0.75, "min": 2.10, "cnt": 32}, "fwd-embedding":{"total": 0.48, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1803.77, "avg": 56.37, "max": 51.01, "min": 64.12, "cnt": 32}, "fwd-layernorm":{"total": 8.96, "avg": 0.07, "max": 0.06, "min": 0.18, "cnt": 128}, "fwd-attn":{"total": 105.01, "avg": 0.82, "max": 0.74, "min": 1.48, "cnt": 128}, "fwd-misc":{"total": 20.21, "avg": 0.16, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1649.34, "avg": 12.89, "max": 11.03, "min": 23.47, "cnt": 128}, "MoE_L0_fwd":{"total": 500.11, "avg": 15.63, "max": 12.14, "min": 23.39, "cnt": 32}, "MoEMLP":{"total": 1632.78, "avg": 12.76, "max": 10.92, "min": 23.35, "cnt": 128}, "MoE_L1_fwd":{"total": 393.28, "avg": 12.29, "max": 11.00, "min": 13.43, "cnt": 32}, "MoE_L2_fwd":{"total": 368.58, "avg": 11.52, "max": 10.96, "min": 12.53, "cnt": 32}, "MoE_L3_fwd":{"total": 376.78, "avg": 11.77, "max": 11.12, "min": 12.89, "cnt": 32}, "fwd-pooler":{"total": 0.36, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.62, "avg": 0.02, "max": 0.02, "min": 0.04, "cnt": 32}, "forward-send":{"total": 1.99, "avg": 1.00, "max": 0.75, "min": 1.24, "cnt": 2}, "forward-send-backward-recv":{"total": 254.51, "avg": 8.48, "max": 1.76, "min": 112.08, "cnt": 30}, "backward-compute":{"total": 1793.77, "avg": 56.06, "max": 51.98, "min": 60.14, "cnt": 32}, "MoE_L3_bwd":{"total": 424.18, "avg": 13.26, "max": 12.35, "min": 14.61, "cnt": 32}, "MoE_L2_bwd":{"total": 389.80, "avg": 12.18, "max": 11.30, "min": 14.07, "cnt": 32}, "MoE_L1_bwd":{"total": 373.40, "avg": 11.67, "max": 10.39, "min": 12.88, "cnt": 32}, "MoE_L0_bwd":{"total": 390.84, "avg": 12.21, "max": 11.17, "min": 16.54, "cnt": 32}, "backward-send-forward-recv":{"total": 4611.12, "avg": 159.00, "max": 2.17, "min": 409.53, "cnt": 29}, "backward-send":{"total": 2.44, "avg": 0.81, "max": 0.71, "min": 0.98, "cnt": 3}, "backward-recv":{"total": 282.66, "avg": 141.33, "max": 65.63, "min": 217.03, "cnt": 2}, "backward-params-all-reduce":{"total": 488.11, "avg": 488.11, "max": 488.11, "min": 488.11, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 329.03, "avg": 329.03, "max": 329.03, "min": 329.03, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 284.82, "avg": 284.82, "max": 284.82, "min": 284.82, "cnt": 1}, "optimizer-clip-main-grad":{"total": 7.01, "avg": 7.01, "max": 7.01, "min": 7.01, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 44, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 72.45, "avg": 24.15, "max": 1.36, "min": 69.71, "cnt": 3}, "forward-compute":{"total": 1858.41, "avg": 58.08, "max": 52.07, "min": 65.04, "cnt": 32}, "fwd-compute":{"total": 1855.36, "avg": 57.98, "max": 51.99, "min": 64.95, "cnt": 32}, "batch-generator":{"total": 50.34, "avg": 1.57, "max": 0.73, "min": 3.83, "cnt": 32}, "fwd-embedding":{"total": 0.62, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1792.76, "avg": 56.02, "max": 50.87, "min": 63.14, "cnt": 32}, "fwd-layernorm":{"total": 10.09, "avg": 0.08, "max": 0.05, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 108.60, "avg": 0.85, "max": 0.74, "min": 1.50, "cnt": 128}, "fwd-misc":{"total": 21.90, "avg": 0.17, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1630.19, "avg": 12.74, "max": 10.45, "min": 22.63, "cnt": 128}, "MoE_L0_fwd":{"total": 491.59, "avg": 15.36, "max": 11.60, "min": 22.52, "cnt": 32}, "MoEMLP":{"total": 1612.57, "avg": 12.60, "max": 10.33, "min": 22.45, "cnt": 128}, "MoE_L1_fwd":{"total": 378.49, "avg": 11.83, "max": 10.76, "min": 14.11, "cnt": 32}, "MoE_L2_fwd":{"total": 366.40, "avg": 11.45, "max": 10.37, "min": 14.96, "cnt": 32}, "MoE_L3_fwd":{"total": 382.63, "avg": 11.96, "max": 11.45, "min": 12.99, "cnt": 32}, "fwd-pooler":{"total": 0.36, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.87, "avg": 0.94, "max": 0.92, "min": 0.95, "cnt": 2}, "forward-send-backward-recv":{"total": 920.71, "avg": 30.69, "max": 1.04, "min": 245.70, "cnt": 30}, "backward-compute":{"total": 1793.16, "avg": 56.04, "max": 53.19, "min": 58.55, "cnt": 32}, "MoE_L3_bwd":{"total": 448.69, "avg": 14.02, "max": 12.99, "min": 15.81, "cnt": 32}, "MoE_L2_bwd":{"total": 381.18, "avg": 11.91, "max": 10.79, "min": 13.01, "cnt": 32}, "MoE_L1_bwd":{"total": 366.94, "avg": 11.47, "max": 10.85, "min": 12.56, "cnt": 32}, "MoE_L0_bwd":{"total": 382.95, "avg": 11.97, "max": 11.32, "min": 12.98, "cnt": 32}, "backward-send-forward-recv":{"total": 6240.50, "avg": 215.19, "max": 2.34, "min": 1319.89, "cnt": 29}, "backward-send":{"total": 3.06, "avg": 1.02, "max": 0.89, "min": 1.20, "cnt": 3}, "backward-recv":{"total": 134.13, "avg": 67.06, "max": 59.20, "min": 74.93, "cnt": 2}, "backward-params-all-reduce":{"total": 486.70, "avg": 486.70, "max": 486.70, "min": 486.70, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 251.93, "avg": 251.93, "max": 251.93, "min": 251.93, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 207.78, "avg": 207.78, "max": 207.78, "min": 207.78, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.89, "avg": 6.89, "max": 6.89, "min": 6.89, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 45, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 89.98, "avg": 29.99, "max": 7.38, "min": 72.11, "cnt": 3}, "forward-compute":{"total": 1852.08, "avg": 57.88, "max": 51.79, "min": 63.93, "cnt": 32}, "fwd-compute":{"total": 1848.92, "avg": 57.78, "max": 51.72, "min": 63.85, "cnt": 32}, "batch-generator":{"total": 54.04, "avg": 1.69, "max": 0.73, "min": 3.49, "cnt": 32}, "fwd-embedding":{"total": 0.52, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1782.32, "avg": 55.70, "max": 50.68, "min": 62.62, "cnt": 32}, "fwd-layernorm":{"total": 9.45, "avg": 0.07, "max": 0.05, "min": 0.18, "cnt": 128}, "fwd-attn":{"total": 104.60, "avg": 0.82, "max": 0.74, "min": 2.05, "cnt": 128}, "fwd-misc":{"total": 20.90, "avg": 0.16, "max": 0.12, "min": 0.41, "cnt": 128}, "fwd-MLP":{"total": 1625.83, "avg": 12.70, "max": 10.41, "min": 19.65, "cnt": 128}, "MoE_L0_fwd":{"total": 461.81, "avg": 14.43, "max": 11.80, "min": 19.57, "cnt": 32}, "MoEMLP":{"total": 1608.89, "avg": 12.57, "max": 10.29, "min": 19.52, "cnt": 128}, "MoE_L1_fwd":{"total": 376.00, "avg": 11.75, "max": 10.61, "min": 13.03, "cnt": 32}, "MoE_L2_fwd":{"total": 367.43, "avg": 11.48, "max": 10.33, "min": 13.33, "cnt": 32}, "MoE_L3_fwd":{"total": 409.94, "avg": 12.81, "max": 11.89, "min": 16.48, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.94, "avg": 0.97, "max": 0.93, "min": 1.01, "cnt": 2}, "forward-send-backward-recv":{"total": 181.51, "avg": 6.05, "max": 1.19, "min": 111.24, "cnt": 30}, "backward-compute":{"total": 1811.79, "avg": 56.62, "max": 54.22, "min": 59.33, "cnt": 32}, "MoE_L3_bwd":{"total": 459.89, "avg": 14.37, "max": 13.40, "min": 17.31, "cnt": 32}, "MoE_L2_bwd":{"total": 376.50, "avg": 11.77, "max": 10.80, "min": 12.42, "cnt": 32}, "MoE_L1_bwd":{"total": 374.19, "avg": 11.69, "max": 10.63, "min": 13.06, "cnt": 32}, "MoE_L0_bwd":{"total": 383.41, "avg": 11.98, "max": 11.76, "min": 12.70, "cnt": 32}, "backward-send-forward-recv":{"total": 4096.44, "avg": 141.26, "max": 2.33, "min": 421.87, "cnt": 29}, "backward-send":{"total": 2.94, "avg": 0.98, "max": 0.80, "min": 1.09, "cnt": 3}, "backward-recv":{"total": 323.78, "avg": 161.89, "max": 60.95, "min": 262.84, "cnt": 2}, "backward-params-all-reduce":{"total": 488.57, "avg": 488.57, "max": 488.57, "min": 488.57, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 253.96, "avg": 253.96, "max": 253.96, "min": 253.96, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.48, "avg": 3.48, "max": 3.48, "min": 3.48, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 209.42, "avg": 209.42, "max": 209.42, "min": 209.42, "cnt": 1}, "optimizer-clip-main-grad":{"total": 7.13, "avg": 7.13, "max": 7.13, "min": 7.13, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 46, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 83.11, "avg": 27.70, "max": 3.38, "min": 75.45, "cnt": 3}, "forward-compute":{"total": 1786.87, "avg": 55.84, "max": 51.09, "min": 63.08, "cnt": 32}, "fwd-compute":{"total": 1783.66, "avg": 55.74, "max": 51.00, "min": 62.98, "cnt": 32}, "batch-generator":{"total": 41.96, "avg": 1.31, "max": 0.68, "min": 2.92, "cnt": 32}, "fwd-embedding":{"total": 0.52, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1729.60, "avg": 54.05, "max": 49.99, "min": 61.35, "cnt": 32}, "fwd-layernorm":{"total": 9.31, "avg": 0.07, "max": 0.05, "min": 0.22, "cnt": 128}, "fwd-attn":{"total": 106.86, "avg": 0.83, "max": 0.74, "min": 1.95, "cnt": 128}, "fwd-misc":{"total": 20.29, "avg": 0.16, "max": 0.11, "min": 0.40, "cnt": 128}, "fwd-MLP":{"total": 1572.69, "avg": 12.29, "max": 9.69, "min": 20.97, "cnt": 128}, "MoE_L0_fwd":{"total": 469.88, "avg": 14.68, "max": 11.85, "min": 20.88, "cnt": 32}, "MoEMLP":{"total": 1556.42, "avg": 12.16, "max": 9.58, "min": 20.83, "cnt": 128}, "MoE_L1_fwd":{"total": 368.48, "avg": 11.51, "max": 10.51, "min": 14.95, "cnt": 32}, "MoE_L2_fwd":{"total": 332.98, "avg": 10.41, "max": 9.62, "min": 11.47, "cnt": 32}, "MoE_L3_fwd":{"total": 391.03, "avg": 12.22, "max": 11.34, "min": 14.69, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 2.57, "avg": 1.28, "max": 0.92, "min": 1.65, "cnt": 2}, "forward-send-backward-recv":{"total": 700.41, "avg": 23.35, "max": 1.67, "min": 192.60, "cnt": 30}, "backward-compute":{"total": 1767.15, "avg": 55.22, "max": 51.14, "min": 57.09, "cnt": 32}, "MoE_L3_bwd":{"total": 443.12, "avg": 13.85, "max": 12.60, "min": 15.97, "cnt": 32}, "MoE_L2_bwd":{"total": 354.08, "avg": 11.07, "max": 8.90, "min": 12.94, "cnt": 32}, "MoE_L1_bwd":{"total": 369.30, "avg": 11.54, "max": 10.72, "min": 12.53, "cnt": 32}, "MoE_L0_bwd":{"total": 384.89, "avg": 12.03, "max": 11.22, "min": 12.72, "cnt": 32}, "backward-send-forward-recv":{"total": 6158.44, "avg": 212.36, "max": 2.33, "min": 2250.06, "cnt": 29}, "backward-send":{"total": 2.42, "avg": 0.81, "max": 0.56, "min": 1.07, "cnt": 3}, "backward-recv":{"total": 648.19, "avg": 324.10, "max": 98.75, "min": 549.44, "cnt": 2}, "backward-params-all-reduce":{"total": 485.37, "avg": 485.37, "max": 485.37, "min": 485.37, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 256.33, "avg": 256.33, "max": 256.33, "min": 256.33, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 212.18, "avg": 212.18, "max": 212.18, "min": 212.18, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.90, "avg": 6.90, "max": 6.90, "min": 6.90, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 47, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 97.16, "avg": 32.39, "max": 7.47, "min": 77.43, "cnt": 3}, "forward-compute":{"total": 1771.81, "avg": 55.37, "max": 49.81, "min": 63.86, "cnt": 32}, "fwd-compute":{"total": 1768.91, "avg": 55.28, "max": 49.75, "min": 63.75, "cnt": 32}, "batch-generator":{"total": 53.69, "avg": 1.68, "max": 0.71, "min": 5.24, "cnt": 32}, "fwd-embedding":{"total": 0.51, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1703.29, "avg": 53.23, "max": 48.66, "min": 61.83, "cnt": 32}, "fwd-layernorm":{"total": 9.44, "avg": 0.07, "max": 0.05, "min": 0.30, "cnt": 128}, "fwd-attn":{"total": 105.98, "avg": 0.83, "max": 0.74, "min": 2.40, "cnt": 128}, "fwd-misc":{"total": 20.66, "avg": 0.16, "max": 0.11, "min": 0.46, "cnt": 128}, "fwd-MLP":{"total": 1546.64, "avg": 12.08, "max": 10.26, "min": 22.44, "cnt": 128}, "MoE_L0_fwd":{"total": 453.42, "avg": 14.17, "max": 11.58, "min": 22.37, "cnt": 32}, "MoEMLP":{"total": 1530.07, "avg": 11.95, "max": 10.15, "min": 22.33, "cnt": 128}, "MoE_L1_fwd":{"total": 386.29, "avg": 12.07, "max": 10.79, "min": 14.96, "cnt": 32}, "MoE_L2_fwd":{"total": 343.49, "avg": 10.73, "max": 10.19, "min": 12.05, "cnt": 32}, "MoE_L3_fwd":{"total": 353.00, "avg": 11.03, "max": 10.46, "min": 11.94, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.83, "avg": 0.91, "max": 0.90, "min": 0.92, "cnt": 2}, "forward-send-backward-recv":{"total": 253.99, "avg": 8.47, "max": 1.43, "min": 129.93, "cnt": 30}, "backward-compute":{"total": 1710.51, "avg": 53.45, "max": 51.17, "min": 56.01, "cnt": 32}, "MoE_L3_bwd":{"total": 408.27, "avg": 12.76, "max": 11.94, "min": 14.36, "cnt": 32}, "MoE_L2_bwd":{"total": 345.31, "avg": 10.79, "max": 9.98, "min": 11.92, "cnt": 32}, "MoE_L1_bwd":{"total": 361.93, "avg": 11.31, "max": 10.52, "min": 12.92, "cnt": 32}, "MoE_L0_bwd":{"total": 378.86, "avg": 11.84, "max": 11.35, "min": 12.10, "cnt": 32}, "backward-send-forward-recv":{"total": 5537.04, "avg": 190.93, "max": 2.44, "min": 519.45, "cnt": 29}, "backward-send":{"total": 2.91, "avg": 0.97, "max": 0.89, "min": 1.06, "cnt": 3}, "backward-recv":{"total": 460.15, "avg": 230.08, "max": 134.10, "min": 326.05, "cnt": 2}, "backward-params-all-reduce":{"total": 487.22, "avg": 487.22, "max": 487.22, "min": 487.22, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 248.00, "avg": 248.00, "max": 248.00, "min": 248.00, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 203.72, "avg": 203.72, "max": 203.72, "min": 203.72, "cnt": 1}, "optimizer-clip-main-grad":{"total": 7.00, "avg": 7.00, "max": 7.00, "min": 7.00, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 48, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 88.07, "avg": 29.36, "max": 1.28, "min": 80.65, "cnt": 3}, "forward-compute":{"total": 1865.77, "avg": 58.31, "max": 50.57, "min": 66.48, "cnt": 32}, "fwd-compute":{"total": 1861.17, "avg": 58.16, "max": 50.50, "min": 66.38, "cnt": 32}, "batch-generator":{"total": 53.38, "avg": 1.67, "max": 0.65, "min": 4.34, "cnt": 32}, "fwd-embedding":{"total": 0.67, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1794.39, "avg": 56.07, "max": 49.55, "min": 62.37, "cnt": 32}, "fwd-layernorm":{"total": 10.59, "avg": 0.08, "max": 0.05, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 113.82, "avg": 0.89, "max": 0.74, "min": 2.07, "cnt": 128}, "fwd-misc":{"total": 22.63, "avg": 0.18, "max": 0.11, "min": 0.44, "cnt": 128}, "fwd-MLP":{"total": 1624.63, "avg": 12.69, "max": 10.38, "min": 20.17, "cnt": 128}, "MoE_L0_fwd":{"total": 469.12, "avg": 14.66, "max": 11.50, "min": 20.03, "cnt": 32}, "MoEMLP":{"total": 1606.30, "avg": 12.55, "max": 10.25, "min": 19.96, "cnt": 128}, "MoE_L1_fwd":{"total": 389.28, "avg": 12.17, "max": 10.94, "min": 16.81, "cnt": 32}, "MoE_L2_fwd":{"total": 353.74, "avg": 11.05, "max": 10.29, "min": 15.98, "cnt": 32}, "MoE_L3_fwd":{"total": 400.80, "avg": 12.52, "max": 11.92, "min": 13.97, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.61, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 2.05, "avg": 1.03, "max": 0.96, "min": 1.09, "cnt": 2}, "forward-send-backward-recv":{"total": 208.90, "avg": 6.96, "max": 1.65, "min": 120.48, "cnt": 30}, "backward-compute":{"total": 1771.67, "avg": 55.36, "max": 51.78, "min": 57.19, "cnt": 32}, "MoE_L3_bwd":{"total": 457.48, "avg": 14.30, "max": 12.88, "min": 15.58, "cnt": 32}, "MoE_L2_bwd":{"total": 352.50, "avg": 11.02, "max": 10.42, "min": 11.61, "cnt": 32}, "MoE_L1_bwd":{"total": 371.27, "avg": 11.60, "max": 10.93, "min": 12.85, "cnt": 32}, "MoE_L0_bwd":{"total": 374.12, "avg": 11.69, "max": 11.18, "min": 12.68, "cnt": 32}, "backward-send-forward-recv":{"total": 3986.04, "avg": 137.45, "max": 1.41, "min": 560.24, "cnt": 29}, "backward-send":{"total": 2.32, "avg": 0.77, "max": 0.64, "min": 0.99, "cnt": 3}, "backward-recv":{"total": 146.73, "avg": 73.37, "max": 72.31, "min": 74.43, "cnt": 2}, "backward-params-all-reduce":{"total": 488.62, "avg": 488.62, "max": 488.62, "min": 488.62, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 254.99, "avg": 254.99, "max": 254.99, "min": 254.99, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 210.85, "avg": 210.85, "max": 210.85, "min": 210.85, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.89, "avg": 6.89, "max": 6.89, "min": 6.89, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 49, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 74.51, "avg": 24.84, "max": 1.66, "min": 69.58, "cnt": 3}, "forward-compute":{"total": 1860.65, "avg": 58.15, "max": 50.96, "min": 67.37, "cnt": 32}, "fwd-compute":{"total": 1857.21, "avg": 58.04, "max": 50.89, "min": 67.28, "cnt": 32}, "batch-generator":{"total": 51.03, "avg": 1.59, "max": 0.70, "min": 4.81, "cnt": 32}, "fwd-embedding":{"total": 0.66, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1793.22, "avg": 56.04, "max": 49.89, "min": 64.66, "cnt": 32}, "fwd-layernorm":{"total": 10.52, "avg": 0.08, "max": 0.06, "min": 0.31, "cnt": 128}, "fwd-attn":{"total": 112.50, "avg": 0.88, "max": 0.74, "min": 2.58, "cnt": 128}, "fwd-misc":{"total": 22.36, "avg": 0.17, "max": 0.12, "min": 0.51, "cnt": 128}, "fwd-MLP":{"total": 1625.63, "avg": 12.70, "max": 10.59, "min": 18.92, "cnt": 128}, "MoE_L0_fwd":{"total": 476.41, "avg": 14.89, "max": 11.20, "min": 18.58, "cnt": 32}, "MoEMLP":{"total": 1607.97, "avg": 12.56, "max": 10.46, "min": 18.49, "cnt": 128}, "MoE_L1_fwd":{"total": 383.54, "avg": 11.99, "max": 10.51, "min": 16.41, "cnt": 32}, "MoE_L2_fwd":{"total": 363.83, "avg": 11.37, "max": 10.65, "min": 14.74, "cnt": 32}, "MoE_L3_fwd":{"total": 390.67, "avg": 12.21, "max": 11.62, "min": 14.55, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.99, "avg": 0.99, "max": 0.99, "min": 1.00, "cnt": 2}, "forward-send-backward-recv":{"total": 238.29, "avg": 7.94, "max": 1.29, "min": 130.50, "cnt": 30}, "backward-compute":{"total": 1765.61, "avg": 55.18, "max": 53.71, "min": 59.21, "cnt": 32}, "MoE_L3_bwd":{"total": 443.01, "avg": 13.84, "max": 13.19, "min": 14.99, "cnt": 32}, "MoE_L2_bwd":{"total": 369.41, "avg": 11.54, "max": 10.95, "min": 13.26, "cnt": 32}, "MoE_L1_bwd":{"total": 355.66, "avg": 11.11, "max": 10.81, "min": 11.73, "cnt": 32}, "MoE_L0_bwd":{"total": 378.76, "avg": 11.84, "max": 11.42, "min": 14.69, "cnt": 32}, "backward-send-forward-recv":{"total": 5939.33, "avg": 204.80, "max": 1.94, "min": 998.78, "cnt": 29}, "backward-send":{"total": 2.92, "avg": 0.97, "max": 0.85, "min": 1.13, "cnt": 3}, "backward-recv":{"total": 145.63, "avg": 72.81, "max": 68.20, "min": 77.43, "cnt": 2}, "backward-params-all-reduce":{"total": 499.55, "avg": 499.55, "max": 499.55, "min": 499.55, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 232.37, "avg": 232.37, "max": 232.37, "min": 232.37, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 192.55, "avg": 192.55, "max": 192.55, "min": 192.55, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 50, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 82.78, "avg": 27.59, "max": 2.80, "min": 71.23, "cnt": 3}, "forward-compute":{"total": 1833.61, "avg": 57.30, "max": 52.02, "min": 62.92, "cnt": 32}, "fwd-compute":{"total": 1830.38, "avg": 57.20, "max": 51.95, "min": 62.83, "cnt": 32}, "batch-generator":{"total": 40.68, "avg": 1.27, "max": 0.69, "min": 3.62, "cnt": 32}, "fwd-embedding":{"total": 0.58, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1776.87, "avg": 55.53, "max": 50.87, "min": 61.62, "cnt": 32}, "fwd-layernorm":{"total": 9.64, "avg": 0.08, "max": 0.05, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 107.69, "avg": 0.84, "max": 0.74, "min": 1.61, "cnt": 128}, "fwd-misc":{"total": 20.75, "avg": 0.16, "max": 0.11, "min": 0.38, "cnt": 128}, "fwd-MLP":{"total": 1617.59, "avg": 12.64, "max": 10.64, "min": 21.50, "cnt": 128}, "MoE_L0_fwd":{"total": 491.97, "avg": 15.37, "max": 11.84, "min": 21.43, "cnt": 32}, "MoEMLP":{"total": 1600.70, "avg": 12.51, "max": 10.52, "min": 21.37, "cnt": 128}, "MoE_L1_fwd":{"total": 372.49, "avg": 11.64, "max": 10.65, "min": 13.45, "cnt": 32}, "MoE_L2_fwd":{"total": 357.11, "avg": 11.16, "max": 10.57, "min": 12.31, "cnt": 32}, "MoE_L3_fwd":{"total": 385.28, "avg": 12.04, "max": 11.43, "min": 12.82, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.91, "avg": 0.95, "max": 0.94, "min": 0.97, "cnt": 2}, "forward-send-backward-recv":{"total": 234.40, "avg": 7.81, "max": 1.64, "min": 134.97, "cnt": 30}, "backward-compute":{"total": 1775.94, "avg": 55.50, "max": 52.51, "min": 59.45, "cnt": 32}, "MoE_L3_bwd":{"total": 442.29, "avg": 13.82, "max": 12.80, "min": 17.89, "cnt": 32}, "MoE_L2_bwd":{"total": 374.50, "avg": 11.70, "max": 10.99, "min": 13.10, "cnt": 32}, "MoE_L1_bwd":{"total": 355.90, "avg": 11.12, "max": 10.42, "min": 11.43, "cnt": 32}, "MoE_L0_bwd":{"total": 389.58, "avg": 12.17, "max": 11.37, "min": 13.43, "cnt": 32}, "backward-send-forward-recv":{"total": 5496.78, "avg": 189.54, "max": 2.15, "min": 1140.13, "cnt": 29}, "backward-send":{"total": 2.78, "avg": 0.93, "max": 0.79, "min": 1.15, "cnt": 3}, "backward-recv":{"total": 667.85, "avg": 333.93, "max": 61.96, "min": 605.90, "cnt": 2}, "backward-params-all-reduce":{"total": 486.75, "avg": 486.75, "max": 486.75, "min": 486.75, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 246.06, "avg": 246.06, "max": 246.06, "min": 246.06, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 206.36, "avg": 206.36, "max": 206.36, "min": 206.36, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.31, "avg": 3.31, "max": 3.31, "min": 3.31, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 51, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 74.50, "avg": 24.83, "max": 1.49, "min": 71.53, "cnt": 3}, "forward-compute":{"total": 1932.54, "avg": 60.39, "max": 50.86, "min": 140.37, "cnt": 32}, "fwd-compute":{"total": 1929.18, "avg": 60.29, "max": 50.79, "min": 140.23, "cnt": 32}, "batch-generator":{"total": 44.05, "avg": 1.38, "max": 0.65, "min": 3.21, "cnt": 32}, "fwd-embedding":{"total": 0.73, "avg": 0.02, "max": 0.01, "min": 0.06, "cnt": 32}, "fwd-encoder":{"total": 1871.98, "avg": 58.50, "max": 49.81, "min": 138.32, "cnt": 32}, "fwd-layernorm":{"total": 10.48, "avg": 0.08, "max": 0.06, "min": 0.23, "cnt": 128}, "fwd-attn":{"total": 110.30, "avg": 0.86, "max": 0.74, "min": 1.70, "cnt": 128}, "fwd-misc":{"total": 22.55, "avg": 0.18, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1706.21, "avg": 13.33, "max": 10.43, "min": 95.26, "cnt": 128}, "MoE_L0_fwd":{"total": 562.28, "avg": 17.57, "max": 11.96, "min": 95.16, "cnt": 32}, "MoEMLP":{"total": 1688.43, "avg": 13.19, "max": 10.31, "min": 95.11, "cnt": 128}, "MoE_L1_fwd":{"total": 373.89, "avg": 11.68, "max": 10.75, "min": 13.76, "cnt": 32}, "MoE_L2_fwd":{"total": 368.55, "avg": 11.52, "max": 10.36, "min": 15.98, "cnt": 32}, "MoE_L3_fwd":{"total": 390.23, "avg": 12.19, "max": 11.32, "min": 13.78, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.77, "avg": 0.89, "max": 0.87, "min": 0.90, "cnt": 2}, "forward-send-backward-recv":{"total": 1590.90, "avg": 53.03, "max": 1.38, "min": 372.56, "cnt": 30}, "backward-compute":{"total": 1789.32, "avg": 55.92, "max": 53.95, "min": 57.85, "cnt": 32}, "MoE_L3_bwd":{"total": 444.30, "avg": 13.88, "max": 12.45, "min": 15.51, "cnt": 32}, "MoE_L2_bwd":{"total": 371.89, "avg": 11.62, "max": 10.95, "min": 13.10, "cnt": 32}, "MoE_L1_bwd":{"total": 365.45, "avg": 11.42, "max": 10.74, "min": 11.92, "cnt": 32}, "MoE_L0_bwd":{"total": 392.62, "avg": 12.27, "max": 11.56, "min": 13.27, "cnt": 32}, "backward-send-forward-recv":{"total": 3373.74, "avg": 116.34, "max": 1.88, "min": 521.21, "cnt": 29}, "backward-send":{"total": 3.14, "avg": 1.05, "max": 1.01, "min": 1.07, "cnt": 3}, "backward-recv":{"total": 213.88, "avg": 106.94, "max": 73.61, "min": 140.26, "cnt": 2}, "backward-params-all-reduce":{"total": 485.44, "avg": 485.44, "max": 485.44, "min": 485.44, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 246.91, "avg": 246.91, "max": 246.91, "min": 246.91, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 206.87, "avg": 206.87, "max": 206.87, "min": 206.87, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.54, "avg": 3.54, "max": 3.54, "min": 3.54, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.50, "avg": 3.50, "max": 3.50, "min": 3.50, "cnt": 1}}}
{"type":"time", "iteration": 52, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 79.64, "avg": 26.55, "max": 1.30, "min": 76.88, "cnt": 3}, "forward-compute":{"total": 1876.45, "avg": 58.64, "max": 51.45, "min": 68.61, "cnt": 32}, "fwd-compute":{"total": 1872.94, "avg": 58.53, "max": 51.37, "min": 68.52, "cnt": 32}, "batch-generator":{"total": 54.89, "avg": 1.72, "max": 0.66, "min": 3.82, "cnt": 32}, "fwd-embedding":{"total": 0.67, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1805.08, "avg": 56.41, "max": 50.41, "min": 64.67, "cnt": 32}, "fwd-layernorm":{"total": 10.43, "avg": 0.08, "max": 0.06, "min": 0.23, "cnt": 128}, "fwd-attn":{"total": 113.87, "avg": 0.89, "max": 0.74, "min": 2.50, "cnt": 128}, "fwd-misc":{"total": 22.20, "avg": 0.17, "max": 0.11, "min": 0.44, "cnt": 128}, "fwd-MLP":{"total": 1636.30, "avg": 12.78, "max": 10.49, "min": 19.47, "cnt": 128}, "MoE_L0_fwd":{"total": 495.90, "avg": 15.50, "max": 11.76, "min": 19.38, "cnt": 32}, "MoEMLP":{"total": 1618.19, "avg": 12.64, "max": 10.38, "min": 19.34, "cnt": 128}, "MoE_L1_fwd":{"total": 387.02, "avg": 12.09, "max": 11.03, "min": 15.38, "cnt": 32}, "MoE_L2_fwd":{"total": 355.80, "avg": 11.12, "max": 10.42, "min": 15.33, "cnt": 32}, "MoE_L3_fwd":{"total": 386.03, "avg": 12.06, "max": 11.41, "min": 13.17, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 4.56, "avg": 2.28, "max": 0.92, "min": 3.63, "cnt": 2}, "forward-send-backward-recv":{"total": 550.89, "avg": 18.36, "max": 1.75, "min": 163.05, "cnt": 30}, "backward-compute":{"total": 1759.50, "avg": 54.98, "max": 51.85, "min": 58.07, "cnt": 32}, "MoE_L3_bwd":{"total": 448.47, "avg": 14.01, "max": 13.03, "min": 15.50, "cnt": 32}, "MoE_L2_bwd":{"total": 344.15, "avg": 10.75, "max": 9.83, "min": 14.88, "cnt": 32}, "MoE_L1_bwd":{"total": 360.60, "avg": 11.27, "max": 10.52, "min": 12.23, "cnt": 32}, "MoE_L0_bwd":{"total": 388.03, "avg": 12.13, "max": 11.66, "min": 13.28, "cnt": 32}, "backward-send-forward-recv":{"total": 4834.11, "avg": 166.69, "max": 1.83, "min": 783.37, "cnt": 29}, "backward-send":{"total": 2.96, "avg": 0.99, "max": 0.90, "min": 1.06, "cnt": 3}, "backward-recv":{"total": 133.76, "avg": 66.88, "max": 60.90, "min": 72.86, "cnt": 2}, "backward-params-all-reduce":{"total": 487.59, "avg": 487.59, "max": 487.59, "min": 487.59, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 242.95, "avg": 242.95, "max": 242.95, "min": 242.95, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 202.94, "avg": 202.94, "max": 202.94, "min": 202.94, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.57, "avg": 3.57, "max": 3.57, "min": 3.57, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.47, "avg": 3.47, "max": 3.47, "min": 3.47, "cnt": 1}}}
{"type":"time", "iteration": 53, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 79.07, "avg": 26.36, "max": 1.29, "min": 75.74, "cnt": 3}, "forward-compute":{"total": 1877.30, "avg": 58.67, "max": 50.24, "min": 64.76, "cnt": 32}, "fwd-compute":{"total": 1874.08, "avg": 58.57, "max": 50.17, "min": 64.62, "cnt": 32}, "batch-generator":{"total": 45.96, "avg": 1.44, "max": 0.68, "min": 3.71, "cnt": 32}, "fwd-embedding":{"total": 0.65, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1815.30, "avg": 56.73, "max": 49.18, "min": 62.54, "cnt": 32}, "fwd-layernorm":{"total": 10.40, "avg": 0.08, "max": 0.06, "min": 0.30, "cnt": 128}, "fwd-attn":{"total": 113.30, "avg": 0.89, "max": 0.74, "min": 2.34, "cnt": 128}, "fwd-misc":{"total": 22.73, "avg": 0.18, "max": 0.11, "min": 0.46, "cnt": 128}, "fwd-MLP":{"total": 1646.36, "avg": 12.86, "max": 10.29, "min": 22.27, "cnt": 128}, "MoE_L0_fwd":{"total": 516.91, "avg": 16.15, "max": 11.88, "min": 22.14, "cnt": 32}, "MoEMLP":{"total": 1628.72, "avg": 12.72, "max": 10.16, "min": 22.07, "cnt": 128}, "MoE_L1_fwd":{"total": 371.81, "avg": 11.62, "max": 10.71, "min": 13.95, "cnt": 32}, "MoE_L2_fwd":{"total": 356.75, "avg": 11.15, "max": 10.21, "min": 16.85, "cnt": 32}, "MoE_L3_fwd":{"total": 389.68, "avg": 12.18, "max": 11.32, "min": 14.64, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 8.58, "avg": 4.29, "max": 0.94, "min": 7.64, "cnt": 2}, "forward-send-backward-recv":{"total": 499.15, "avg": 16.64, "max": 1.22, "min": 130.52, "cnt": 30}, "backward-compute":{"total": 1736.83, "avg": 54.28, "max": 52.82, "min": 57.62, "cnt": 32}, "MoE_L3_bwd":{"total": 449.33, "avg": 14.04, "max": 13.00, "min": 17.07, "cnt": 32}, "MoE_L2_bwd":{"total": 356.34, "avg": 11.14, "max": 10.27, "min": 11.70, "cnt": 32}, "MoE_L1_bwd":{"total": 328.09, "avg": 10.25, "max": 9.52, "min": 12.78, "cnt": 32}, "MoE_L0_bwd":{"total": 387.50, "avg": 12.11, "max": 11.56, "min": 12.86, "cnt": 32}, "backward-send-forward-recv":{"total": 4956.98, "avg": 170.93, "max": 1.28, "min": 1056.30, "cnt": 29}, "backward-send":{"total": 2.92, "avg": 0.97, "max": 0.91, "min": 1.07, "cnt": 3}, "backward-recv":{"total": 185.10, "avg": 92.55, "max": 76.06, "min": 109.04, "cnt": 2}, "backward-params-all-reduce":{"total": 487.23, "avg": 487.23, "max": 487.23, "min": 487.23, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 240.69, "avg": 240.69, "max": 240.69, "min": 240.69, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 200.62, "avg": 200.62, "max": 200.62, "min": 200.62, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.61, "avg": 3.61, "max": 3.61, "min": 3.61, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.47, "avg": 3.47, "max": 3.47, "min": 3.47, "cnt": 1}}}
{"type":"time", "iteration": 54, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 84.86, "avg": 28.29, "max": 1.32, "min": 78.41, "cnt": 3}, "forward-compute":{"total": 1854.78, "avg": 57.96, "max": 51.00, "min": 68.65, "cnt": 32}, "fwd-compute":{"total": 1851.52, "avg": 57.86, "max": 50.93, "min": 68.57, "cnt": 32}, "batch-generator":{"total": 47.35, "avg": 1.48, "max": 0.72, "min": 4.45, "cnt": 32}, "fwd-embedding":{"total": 0.69, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1791.19, "avg": 55.97, "max": 49.89, "min": 66.24, "cnt": 32}, "fwd-layernorm":{"total": 10.18, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 110.18, "avg": 0.86, "max": 0.74, "min": 1.83, "cnt": 128}, "fwd-misc":{"total": 22.00, "avg": 0.17, "max": 0.12, "min": 0.39, "cnt": 128}, "fwd-MLP":{"total": 1627.13, "avg": 12.71, "max": 10.67, "min": 23.38, "cnt": 128}, "MoE_L0_fwd":{"total": 506.78, "avg": 15.84, "max": 11.92, "min": 23.23, "cnt": 32}, "MoEMLP":{"total": 1609.78, "avg": 12.58, "max": 10.56, "min": 23.15, "cnt": 128}, "MoE_L1_fwd":{"total": 370.04, "avg": 11.56, "max": 10.93, "min": 13.89, "cnt": 32}, "MoE_L2_fwd":{"total": 357.25, "avg": 11.16, "max": 10.60, "min": 13.03, "cnt": 32}, "MoE_L3_fwd":{"total": 382.03, "avg": 11.94, "max": 11.40, "min": 12.94, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.96, "avg": 0.98, "max": 0.98, "min": 0.98, "cnt": 2}, "forward-send-backward-recv":{"total": 245.06, "avg": 8.17, "max": 1.73, "min": 123.86, "cnt": 30}, "backward-compute":{"total": 1739.41, "avg": 54.36, "max": 50.97, "min": 56.00, "cnt": 32}, "MoE_L3_bwd":{"total": 440.68, "avg": 13.77, "max": 11.81, "min": 15.47, "cnt": 32}, "MoE_L2_bwd":{"total": 363.65, "avg": 11.36, "max": 10.68, "min": 13.15, "cnt": 32}, "MoE_L1_bwd":{"total": 322.56, "avg": 10.08, "max": 9.67, "min": 10.89, "cnt": 32}, "MoE_L0_bwd":{"total": 397.50, "avg": 12.42, "max": 11.64, "min": 13.32, "cnt": 32}, "backward-send-forward-recv":{"total": 4871.87, "avg": 168.00, "max": 2.49, "min": 822.71, "cnt": 29}, "backward-send":{"total": 3.02, "avg": 1.01, "max": 0.94, "min": 1.06, "cnt": 3}, "backward-recv":{"total": 142.55, "avg": 71.28, "max": 71.05, "min": 71.50, "cnt": 2}, "backward-params-all-reduce":{"total": 490.41, "avg": 490.41, "max": 490.41, "min": 490.41, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 243.12, "avg": 243.12, "max": 243.12, "min": 243.12, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.41, "avg": 3.41, "max": 3.41, "min": 3.41, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 203.13, "avg": 203.13, "max": 203.13, "min": 203.13, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 55, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 81.22, "avg": 27.07, "max": 1.37, "min": 75.77, "cnt": 3}, "forward-compute":{"total": 1845.77, "avg": 57.68, "max": 53.43, "min": 65.38, "cnt": 32}, "fwd-compute":{"total": 1842.82, "avg": 57.59, "max": 53.35, "min": 65.30, "cnt": 32}, "batch-generator":{"total": 39.18, "avg": 1.22, "max": 0.66, "min": 3.08, "cnt": 32}, "fwd-embedding":{"total": 0.50, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1791.75, "avg": 55.99, "max": 51.69, "min": 63.45, "cnt": 32}, "fwd-layernorm":{"total": 9.33, "avg": 0.07, "max": 0.06, "min": 0.18, "cnt": 128}, "fwd-attn":{"total": 106.74, "avg": 0.83, "max": 0.74, "min": 1.47, "cnt": 128}, "fwd-misc":{"total": 20.72, "avg": 0.16, "max": 0.11, "min": 0.39, "cnt": 128}, "fwd-MLP":{"total": 1633.96, "avg": 12.77, "max": 10.76, "min": 19.43, "cnt": 128}, "MoE_L0_fwd":{"total": 482.05, "avg": 15.06, "max": 12.43, "min": 19.35, "cnt": 32}, "MoEMLP":{"total": 1617.28, "avg": 12.63, "max": 10.64, "min": 19.30, "cnt": 128}, "MoE_L1_fwd":{"total": 382.53, "avg": 11.95, "max": 11.00, "min": 17.11, "cnt": 32}, "MoE_L2_fwd":{"total": 371.30, "avg": 11.60, "max": 10.68, "min": 14.15, "cnt": 32}, "MoE_L3_fwd":{"total": 387.52, "avg": 12.11, "max": 11.55, "min": 13.61, "cnt": 32}, "fwd-pooler":{"total": 0.36, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.77, "avg": 0.88, "max": 0.83, "min": 0.94, "cnt": 2}, "forward-send-backward-recv":{"total": 265.29, "avg": 8.84, "max": 1.40, "min": 115.61, "cnt": 30}, "backward-compute":{"total": 1758.83, "avg": 54.96, "max": 52.16, "min": 57.43, "cnt": 32}, "MoE_L3_bwd":{"total": 442.38, "avg": 13.82, "max": 12.69, "min": 15.51, "cnt": 32}, "MoE_L2_bwd":{"total": 364.45, "avg": 11.39, "max": 10.41, "min": 12.30, "cnt": 32}, "MoE_L1_bwd":{"total": 341.04, "avg": 10.66, "max": 9.98, "min": 11.69, "cnt": 32}, "MoE_L0_bwd":{"total": 395.80, "avg": 12.37, "max": 11.83, "min": 12.84, "cnt": 32}, "backward-send-forward-recv":{"total": 4049.02, "avg": 139.62, "max": 2.44, "min": 447.44, "cnt": 29}, "backward-send":{"total": 3.25, "avg": 1.08, "max": 1.00, "min": 1.19, "cnt": 3}, "backward-recv":{"total": 392.84, "avg": 196.42, "max": 72.81, "min": 320.03, "cnt": 2}, "backward-params-all-reduce":{"total": 485.36, "avg": 485.36, "max": 485.36, "min": 485.36, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 248.27, "avg": 248.27, "max": 248.27, "min": 248.27, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.36, "avg": 3.36, "max": 3.36, "min": 3.36, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 208.44, "avg": 208.44, "max": 208.44, "min": 208.44, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}}}
{"type":"time", "iteration": 56, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 79.62, "avg": 26.54, "max": 0.74, "min": 77.73, "cnt": 3}, "forward-compute":{"total": 1869.12, "avg": 58.41, "max": 53.31, "min": 63.31, "cnt": 32}, "fwd-compute":{"total": 1865.76, "avg": 58.30, "max": 53.22, "min": 63.21, "cnt": 32}, "batch-generator":{"total": 54.76, "avg": 1.71, "max": 0.66, "min": 4.56, "cnt": 32}, "fwd-embedding":{"total": 0.63, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1798.58, "avg": 56.21, "max": 50.75, "min": 60.28, "cnt": 32}, "fwd-layernorm":{"total": 9.78, "avg": 0.08, "max": 0.06, "min": 0.18, "cnt": 128}, "fwd-attn":{"total": 105.74, "avg": 0.83, "max": 0.74, "min": 1.53, "cnt": 128}, "fwd-misc":{"total": 20.75, "avg": 0.16, "max": 0.11, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1641.53, "avg": 12.82, "max": 10.98, "min": 20.14, "cnt": 128}, "MoE_L0_fwd":{"total": 484.76, "avg": 15.15, "max": 11.60, "min": 20.05, "cnt": 32}, "MoEMLP":{"total": 1625.15, "avg": 12.70, "max": 10.87, "min": 20.00, "cnt": 128}, "MoE_L1_fwd":{"total": 401.87, "avg": 12.56, "max": 10.98, "min": 15.40, "cnt": 32}, "MoE_L2_fwd":{"total": 359.98, "avg": 11.25, "max": 10.91, "min": 12.11, "cnt": 32}, "MoE_L3_fwd":{"total": 384.68, "avg": 12.02, "max": 11.57, "min": 12.87, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 6.26, "avg": 3.13, "max": 0.94, "min": 5.32, "cnt": 2}, "forward-send-backward-recv":{"total": 1468.68, "avg": 48.96, "max": 1.37, "min": 344.00, "cnt": 30}, "backward-compute":{"total": 1723.13, "avg": 53.85, "max": 52.23, "min": 57.64, "cnt": 32}, "MoE_L3_bwd":{"total": 446.89, "avg": 13.97, "max": 12.72, "min": 17.23, "cnt": 32}, "MoE_L2_bwd":{"total": 370.85, "avg": 11.59, "max": 10.67, "min": 12.44, "cnt": 32}, "MoE_L1_bwd":{"total": 335.43, "avg": 10.48, "max": 10.00, "min": 12.22, "cnt": 32}, "MoE_L0_bwd":{"total": 357.00, "avg": 11.16, "max": 10.64, "min": 12.44, "cnt": 32}, "backward-send-forward-recv":{"total": 3237.31, "avg": 111.63, "max": 1.39, "min": 375.29, "cnt": 29}, "backward-send":{"total": 2.64, "avg": 0.88, "max": 0.52, "min": 1.13, "cnt": 3}, "backward-recv":{"total": 378.63, "avg": 189.32, "max": 64.85, "min": 313.78, "cnt": 2}, "backward-params-all-reduce":{"total": 489.37, "avg": 489.37, "max": 489.37, "min": 489.37, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 240.80, "avg": 240.80, "max": 240.80, "min": 240.80, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 200.99, "avg": 200.99, "max": 200.99, "min": 200.99, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.34, "avg": 3.34, "max": 3.34, "min": 3.34, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 57, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 92.66, "avg": 30.89, "max": 2.43, "min": 85.73, "cnt": 3}, "forward-compute":{"total": 1853.82, "avg": 57.93, "max": 51.51, "min": 64.19, "cnt": 32}, "fwd-compute":{"total": 1850.64, "avg": 57.83, "max": 51.44, "min": 64.10, "cnt": 32}, "batch-generator":{"total": 56.97, "avg": 1.78, "max": 0.70, "min": 3.89, "cnt": 32}, "fwd-embedding":{"total": 0.72, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1780.28, "avg": 55.63, "max": 50.44, "min": 60.99, "cnt": 32}, "fwd-layernorm":{"total": 10.97, "avg": 0.09, "max": 0.05, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 113.63, "avg": 0.89, "max": 0.74, "min": 1.89, "cnt": 128}, "fwd-misc":{"total": 23.27, "avg": 0.18, "max": 0.12, "min": 0.38, "cnt": 128}, "fwd-MLP":{"total": 1609.32, "avg": 12.57, "max": 10.75, "min": 19.04, "cnt": 128}, "MoE_L0_fwd":{"total": 458.33, "avg": 14.32, "max": 11.03, "min": 18.95, "cnt": 32}, "MoEMLP":{"total": 1590.98, "avg": 12.43, "max": 10.64, "min": 18.90, "cnt": 128}, "MoE_L1_fwd":{"total": 381.91, "avg": 11.93, "max": 11.11, "min": 15.04, "cnt": 32}, "MoE_L2_fwd":{"total": 364.30, "avg": 11.38, "max": 10.68, "min": 13.31, "cnt": 32}, "MoE_L3_fwd":{"total": 393.26, "avg": 12.29, "max": 11.69, "min": 15.08, "cnt": 32}, "fwd-pooler":{"total": 0.36, "avg": 0.01, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-loss-func":{"total": 0.62, "avg": 0.02, "max": 0.02, "min": 0.05, "cnt": 32}, "forward-send":{"total": 1.62, "avg": 0.81, "max": 0.62, "min": 1.00, "cnt": 2}, "forward-send-backward-recv":{"total": 442.28, "avg": 14.74, "max": 1.39, "min": 122.25, "cnt": 30}, "backward-compute":{"total": 1694.12, "avg": 52.94, "max": 50.87, "min": 54.41, "cnt": 32}, "MoE_L3_bwd":{"total": 438.72, "avg": 13.71, "max": 12.36, "min": 14.91, "cnt": 32}, "MoE_L2_bwd":{"total": 372.84, "avg": 11.65, "max": 11.23, "min": 12.58, "cnt": 32}, "MoE_L1_bwd":{"total": 348.63, "avg": 10.89, "max": 10.14, "min": 12.11, "cnt": 32}, "MoE_L0_bwd":{"total": 319.00, "avg": 9.97, "max": 9.49, "min": 10.38, "cnt": 32}, "backward-send-forward-recv":{"total": 5401.32, "avg": 186.25, "max": 2.54, "min": 926.04, "cnt": 29}, "backward-send":{"total": 2.70, "avg": 0.90, "max": 0.76, "min": 0.98, "cnt": 3}, "backward-recv":{"total": 145.63, "avg": 72.81, "max": 59.53, "min": 86.10, "cnt": 2}, "backward-params-all-reduce":{"total": 490.44, "avg": 490.44, "max": 490.44, "min": 490.44, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 242.38, "avg": 242.38, "max": 242.38, "min": 242.38, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.36, "avg": 3.36, "max": 3.36, "min": 3.36, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 202.39, "avg": 202.39, "max": 202.39, "min": 202.39, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.51, "avg": 3.51, "max": 3.51, "min": 3.51, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 58, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 73.04, "avg": 24.35, "max": 1.42, "min": 70.20, "cnt": 3}, "forward-compute":{"total": 1896.50, "avg": 59.27, "max": 54.42, "min": 65.61, "cnt": 32}, "fwd-compute":{"total": 1893.42, "avg": 59.17, "max": 54.34, "min": 65.53, "cnt": 32}, "batch-generator":{"total": 62.28, "avg": 1.95, "max": 0.69, "min": 4.43, "cnt": 32}, "fwd-embedding":{"total": 0.64, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1818.91, "avg": 56.84, "max": 51.81, "min": 62.87, "cnt": 32}, "fwd-layernorm":{"total": 9.94, "avg": 0.08, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 108.71, "avg": 0.85, "max": 0.74, "min": 1.56, "cnt": 128}, "fwd-misc":{"total": 21.31, "avg": 0.17, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1657.63, "avg": 12.95, "max": 10.68, "min": 21.79, "cnt": 128}, "MoE_L0_fwd":{"total": 486.64, "avg": 15.21, "max": 11.39, "min": 21.72, "cnt": 32}, "MoEMLP":{"total": 1640.81, "avg": 12.82, "max": 10.57, "min": 21.67, "cnt": 128}, "MoE_L1_fwd":{"total": 403.46, "avg": 12.61, "max": 11.66, "min": 14.62, "cnt": 32}, "MoE_L2_fwd":{"total": 366.13, "avg": 11.44, "max": 10.61, "min": 14.46, "cnt": 32}, "MoE_L3_fwd":{"total": 390.83, "avg": 12.21, "max": 11.65, "min": 12.96, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.56, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.50, "avg": 0.75, "max": 0.73, "min": 0.76, "cnt": 2}, "forward-send-backward-recv":{"total": 220.49, "avg": 7.35, "max": 1.00, "min": 133.59, "cnt": 30}, "backward-compute":{"total": 1740.27, "avg": 54.38, "max": 51.74, "min": 55.67, "cnt": 32}, "MoE_L3_bwd":{"total": 436.65, "avg": 13.65, "max": 13.03, "min": 14.50, "cnt": 32}, "MoE_L2_bwd":{"total": 369.73, "avg": 11.55, "max": 10.91, "min": 12.29, "cnt": 32}, "MoE_L1_bwd":{"total": 364.11, "avg": 11.38, "max": 10.59, "min": 12.24, "cnt": 32}, "MoE_L0_bwd":{"total": 356.40, "avg": 11.14, "max": 10.58, "min": 11.63, "cnt": 32}, "backward-send-forward-recv":{"total": 4127.24, "avg": 142.32, "max": 2.40, "min": 596.14, "cnt": 29}, "backward-send":{"total": 3.07, "avg": 1.02, "max": 0.84, "min": 1.14, "cnt": 3}, "backward-recv":{"total": 161.13, "avg": 80.56, "max": 77.71, "min": 83.42, "cnt": 2}, "backward-params-all-reduce":{"total": 488.72, "avg": 488.72, "max": 488.72, "min": 488.72, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 246.26, "avg": 246.26, "max": 246.26, "min": 246.26, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.48, "avg": 3.48, "max": 3.48, "min": 3.48, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 206.36, "avg": 206.36, "max": 206.36, "min": 206.36, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.35, "avg": 3.35, "max": 3.35, "min": 3.35, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 59, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 69.74, "avg": 23.25, "max": 0.78, "min": 68.02, "cnt": 3}, "forward-compute":{"total": 1869.25, "avg": 58.41, "max": 53.39, "min": 67.26, "cnt": 32}, "fwd-compute":{"total": 1866.11, "avg": 58.32, "max": 53.31, "min": 67.17, "cnt": 32}, "batch-generator":{"total": 38.68, "avg": 1.21, "max": 0.63, "min": 1.81, "cnt": 32}, "fwd-embedding":{"total": 0.55, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1815.29, "avg": 56.73, "max": 52.15, "min": 65.84, "cnt": 32}, "fwd-layernorm":{"total": 9.22, "avg": 0.07, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 105.54, "avg": 0.82, "max": 0.74, "min": 1.46, "cnt": 128}, "fwd-misc":{"total": 20.08, "avg": 0.16, "max": 0.11, "min": 0.33, "cnt": 128}, "fwd-MLP":{"total": 1659.99, "avg": 12.97, "max": 10.67, "min": 25.87, "cnt": 128}, "MoE_L0_fwd":{"total": 502.94, "avg": 15.72, "max": 12.00, "min": 25.75, "cnt": 32}, "MoEMLP":{"total": 1643.77, "avg": 12.84, "max": 10.56, "min": 25.70, "cnt": 128}, "MoE_L1_fwd":{"total": 397.32, "avg": 12.42, "max": 11.46, "min": 13.76, "cnt": 32}, "MoE_L2_fwd":{"total": 361.41, "avg": 11.29, "max": 10.60, "min": 13.07, "cnt": 32}, "MoE_L3_fwd":{"total": 387.98, "avg": 12.12, "max": 11.71, "min": 12.68, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 7.16, "avg": 3.58, "max": 0.56, "min": 6.60, "cnt": 2}, "forward-send-backward-recv":{"total": 1245.44, "avg": 41.51, "max": 1.06, "min": 424.43, "cnt": 30}, "backward-compute":{"total": 1761.70, "avg": 55.05, "max": 53.36, "min": 57.72, "cnt": 32}, "MoE_L3_bwd":{"total": 444.91, "avg": 13.90, "max": 12.55, "min": 17.20, "cnt": 32}, "MoE_L2_bwd":{"total": 367.52, "avg": 11.48, "max": 10.89, "min": 12.22, "cnt": 32}, "MoE_L1_bwd":{"total": 368.03, "avg": 11.50, "max": 10.99, "min": 12.14, "cnt": 32}, "MoE_L0_bwd":{"total": 364.82, "avg": 11.40, "max": 10.87, "min": 12.55, "cnt": 32}, "backward-send-forward-recv":{"total": 3757.90, "avg": 129.58, "max": 1.60, "min": 434.47, "cnt": 29}, "backward-send":{"total": 2.77, "avg": 0.92, "max": 0.81, "min": 1.14, "cnt": 3}, "backward-recv":{"total": 434.91, "avg": 217.45, "max": 75.75, "min": 359.15, "cnt": 2}, "backward-params-all-reduce":{"total": 488.00, "avg": 488.00, "max": 488.00, "min": 488.00, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 243.36, "avg": 243.36, "max": 243.36, "min": 243.36, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 203.43, "avg": 203.43, "max": 203.43, "min": 203.43, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.50, "avg": 3.50, "max": 3.50, "min": 3.50, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 60, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 79.36, "avg": 26.45, "max": 0.98, "min": 76.13, "cnt": 3}, "forward-compute":{"total": 1877.48, "avg": 58.67, "max": 51.94, "min": 70.87, "cnt": 32}, "fwd-compute":{"total": 1874.18, "avg": 58.57, "max": 51.85, "min": 70.79, "cnt": 32}, "batch-generator":{"total": 52.19, "avg": 1.63, "max": 0.65, "min": 3.48, "cnt": 32}, "fwd-embedding":{"total": 0.68, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1808.45, "avg": 56.51, "max": 50.69, "min": 69.34, "cnt": 32}, "fwd-layernorm":{"total": 10.64, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 113.00, "avg": 0.88, "max": 0.74, "min": 2.05, "cnt": 128}, "fwd-misc":{"total": 23.02, "avg": 0.18, "max": 0.12, "min": 0.58, "cnt": 128}, "fwd-MLP":{"total": 1638.80, "avg": 12.80, "max": 10.87, "min": 23.19, "cnt": 128}, "MoE_L0_fwd":{"total": 480.26, "avg": 15.01, "max": 11.46, "min": 23.08, "cnt": 32}, "MoEMLP":{"total": 1620.37, "avg": 12.66, "max": 10.73, "min": 23.02, "cnt": 128}, "MoE_L1_fwd":{"total": 383.69, "avg": 11.99, "max": 11.28, "min": 13.29, "cnt": 32}, "MoE_L2_fwd":{"total": 364.67, "avg": 11.40, "max": 10.79, "min": 14.30, "cnt": 32}, "MoE_L3_fwd":{"total": 398.39, "avg": 12.45, "max": 11.90, "min": 17.69, "cnt": 32}, "fwd-pooler":{"total": 0.38, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.62, "avg": 0.02, "max": 0.02, "min": 0.05, "cnt": 32}, "forward-send":{"total": 3.20, "avg": 1.60, "max": 1.01, "min": 2.19, "cnt": 2}, "forward-send-backward-recv":{"total": 213.74, "avg": 7.12, "max": 1.34, "min": 127.39, "cnt": 30}, "backward-compute":{"total": 1750.40, "avg": 54.70, "max": 51.31, "min": 57.62, "cnt": 32}, "MoE_L3_bwd":{"total": 434.07, "avg": 13.56, "max": 11.90, "min": 16.07, "cnt": 32}, "MoE_L2_bwd":{"total": 376.31, "avg": 11.76, "max": 10.47, "min": 13.48, "cnt": 32}, "MoE_L1_bwd":{"total": 362.85, "avg": 11.34, "max": 10.58, "min": 11.72, "cnt": 32}, "MoE_L0_bwd":{"total": 360.48, "avg": 11.27, "max": 10.85, "min": 11.57, "cnt": 32}, "backward-send-forward-recv":{"total": 4889.67, "avg": 168.61, "max": 2.33, "min": 861.70, "cnt": 29}, "backward-send":{"total": 3.39, "avg": 1.13, "max": 1.08, "min": 1.16, "cnt": 3}, "backward-recv":{"total": 137.17, "avg": 68.59, "max": 66.21, "min": 70.96, "cnt": 2}, "backward-params-all-reduce":{"total": 487.34, "avg": 487.34, "max": 487.34, "min": 487.34, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 243.93, "avg": 243.93, "max": 243.93, "min": 243.93, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 204.16, "avg": 204.16, "max": 204.16, "min": 204.16, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.33, "avg": 3.33, "max": 3.33, "min": 3.33, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 61, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 74.13, "avg": 24.71, "max": 1.37, "min": 71.28, "cnt": 3}, "forward-compute":{"total": 1803.66, "avg": 56.36, "max": 51.40, "min": 63.01, "cnt": 32}, "fwd-compute":{"total": 1800.82, "avg": 56.28, "max": 51.31, "min": 62.92, "cnt": 32}, "batch-generator":{"total": 41.51, "avg": 1.30, "max": 0.72, "min": 4.23, "cnt": 32}, "fwd-embedding":{"total": 0.53, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1747.71, "avg": 54.62, "max": 50.10, "min": 61.03, "cnt": 32}, "fwd-layernorm":{"total": 9.32, "avg": 0.07, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 105.74, "avg": 0.83, "max": 0.74, "min": 1.49, "cnt": 128}, "fwd-misc":{"total": 20.36, "avg": 0.16, "max": 0.12, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1591.73, "avg": 12.44, "max": 10.68, "min": 18.97, "cnt": 128}, "MoE_L0_fwd":{"total": 446.41, "avg": 13.95, "max": 11.07, "min": 18.82, "cnt": 32}, "MoEMLP":{"total": 1575.37, "avg": 12.31, "max": 10.57, "min": 18.77, "cnt": 128}, "MoE_L1_fwd":{"total": 384.87, "avg": 12.03, "max": 11.07, "min": 15.53, "cnt": 32}, "MoE_L2_fwd":{"total": 359.56, "avg": 11.24, "max": 10.61, "min": 12.01, "cnt": 32}, "MoE_L3_fwd":{"total": 390.56, "avg": 12.20, "max": 11.78, "min": 12.87, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 10.67, "avg": 5.34, "max": 0.92, "min": 9.75, "cnt": 2}, "forward-send-backward-recv":{"total": 1164.55, "avg": 38.82, "max": 1.96, "min": 210.51, "cnt": 30}, "backward-compute":{"total": 1711.17, "avg": 53.47, "max": 50.88, "min": 56.09, "cnt": 32}, "MoE_L3_bwd":{"total": 428.91, "avg": 13.40, "max": 12.14, "min": 16.30, "cnt": 32}, "MoE_L2_bwd":{"total": 364.88, "avg": 11.40, "max": 10.77, "min": 12.05, "cnt": 32}, "MoE_L1_bwd":{"total": 347.21, "avg": 10.85, "max": 10.24, "min": 11.51, "cnt": 32}, "MoE_L0_bwd":{"total": 350.72, "avg": 10.96, "max": 10.07, "min": 11.80, "cnt": 32}, "backward-send-forward-recv":{"total": 4187.62, "avg": 144.40, "max": 2.32, "min": 990.86, "cnt": 29}, "backward-send":{"total": 3.35, "avg": 1.12, "max": 0.99, "min": 1.19, "cnt": 3}, "backward-recv":{"total": 668.69, "avg": 334.35, "max": 72.84, "min": 595.86, "cnt": 2}, "backward-params-all-reduce":{"total": 482.43, "avg": 482.43, "max": 482.43, "min": 482.43, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 251.04, "avg": 251.04, "max": 251.04, "min": 251.04, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 211.07, "avg": 211.07, "max": 211.07, "min": 211.07, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.51, "avg": 3.51, "max": 3.51, "min": 3.51, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 62, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.06, "avg": 0.06, "max": 0.06, "min": 0.06, "cnt": 1}, "forward-recv":{"total": 68.06, "avg": 22.69, "max": 0.96, "min": 65.64, "cnt": 3}, "forward-compute":{"total": 1851.10, "avg": 57.85, "max": 51.30, "min": 66.90, "cnt": 32}, "fwd-compute":{"total": 1847.98, "avg": 57.75, "max": 51.23, "min": 66.81, "cnt": 32}, "batch-generator":{"total": 60.39, "avg": 1.89, "max": 0.66, "min": 4.25, "cnt": 32}, "fwd-embedding":{"total": 0.66, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1775.38, "avg": 55.48, "max": 50.28, "min": 63.88, "cnt": 32}, "fwd-layernorm":{"total": 9.90, "avg": 0.08, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 108.72, "avg": 0.85, "max": 0.74, "min": 1.96, "cnt": 128}, "fwd-misc":{"total": 21.14, "avg": 0.17, "max": 0.11, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1614.56, "avg": 12.61, "max": 10.50, "min": 18.21, "cnt": 128}, "MoE_L0_fwd":{"total": 467.10, "avg": 14.60, "max": 11.83, "min": 18.13, "cnt": 32}, "MoEMLP":{"total": 1597.91, "avg": 12.48, "max": 10.40, "min": 18.08, "cnt": 128}, "MoE_L1_fwd":{"total": 394.06, "avg": 12.31, "max": 10.95, "min": 16.41, "cnt": 32}, "MoE_L2_fwd":{"total": 349.26, "avg": 10.91, "max": 10.44, "min": 12.60, "cnt": 32}, "MoE_L3_fwd":{"total": 393.66, "avg": 12.30, "max": 11.81, "min": 14.66, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.56, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 4.10, "avg": 2.05, "max": 0.93, "min": 3.17, "cnt": 2}, "forward-send-backward-recv":{"total": 232.70, "avg": 7.76, "max": 1.60, "min": 126.45, "cnt": 30}, "backward-compute":{"total": 1639.09, "avg": 51.22, "max": 49.90, "min": 52.07, "cnt": 32}, "MoE_L3_bwd":{"total": 431.72, "avg": 13.49, "max": 12.91, "min": 14.14, "cnt": 32}, "MoE_L2_bwd":{"total": 352.12, "avg": 11.00, "max": 10.36, "min": 11.57, "cnt": 32}, "MoE_L1_bwd":{"total": 322.36, "avg": 10.07, "max": 9.65, "min": 10.51, "cnt": 32}, "MoE_L0_bwd":{"total": 319.80, "avg": 9.99, "max": 9.69, "min": 10.31, "cnt": 32}, "backward-send-forward-recv":{"total": 6932.96, "avg": 239.07, "max": 2.30, "min": 1327.50, "cnt": 29}, "backward-send":{"total": 3.14, "avg": 1.05, "max": 1.01, "min": 1.12, "cnt": 3}, "backward-recv":{"total": 160.08, "avg": 80.04, "max": 77.24, "min": 82.84, "cnt": 2}, "backward-params-all-reduce":{"total": 489.31, "avg": 489.31, "max": 489.31, "min": 489.31, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 243.88, "avg": 243.88, "max": 243.88, "min": 243.88, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 203.96, "avg": 203.96, "max": 203.96, "min": 203.96, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.60, "avg": 3.60, "max": 3.60, "min": 3.60, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 63, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 83.93, "avg": 27.98, "max": 6.98, "min": 67.63, "cnt": 3}, "forward-compute":{"total": 1825.43, "avg": 57.04, "max": 52.03, "min": 63.41, "cnt": 32}, "fwd-compute":{"total": 1822.37, "avg": 56.95, "max": 51.92, "min": 63.32, "cnt": 32}, "batch-generator":{"total": 41.50, "avg": 1.30, "max": 0.68, "min": 3.10, "cnt": 32}, "fwd-embedding":{"total": 0.60, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1768.42, "avg": 55.26, "max": 50.30, "min": 61.87, "cnt": 32}, "fwd-layernorm":{"total": 9.87, "avg": 0.08, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 109.06, "avg": 0.85, "max": 0.74, "min": 1.89, "cnt": 128}, "fwd-misc":{"total": 21.77, "avg": 0.17, "max": 0.11, "min": 0.54, "cnt": 128}, "fwd-MLP":{"total": 1606.12, "avg": 12.55, "max": 10.61, "min": 21.71, "cnt": 128}, "MoE_L0_fwd":{"total": 477.45, "avg": 14.92, "max": 11.28, "min": 21.61, "cnt": 32}, "MoEMLP":{"total": 1589.05, "avg": 12.41, "max": 10.49, "min": 21.56, "cnt": 128}, "MoE_L1_fwd":{"total": 376.55, "avg": 11.77, "max": 10.78, "min": 13.94, "cnt": 32}, "MoE_L2_fwd":{"total": 352.75, "avg": 11.02, "max": 10.54, "min": 11.67, "cnt": 32}, "MoE_L3_fwd":{"total": 388.55, "avg": 12.14, "max": 11.46, "min": 14.63, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.38, "avg": 0.69, "max": 0.66, "min": 0.72, "cnt": 2}, "forward-send-backward-recv":{"total": 220.41, "avg": 7.35, "max": 1.39, "min": 124.92, "cnt": 30}, "backward-compute":{"total": 1635.29, "avg": 51.10, "max": 50.15, "min": 53.81, "cnt": 32}, "MoE_L3_bwd":{"total": 433.62, "avg": 13.55, "max": 12.67, "min": 17.18, "cnt": 32}, "MoE_L2_bwd":{"total": 352.40, "avg": 11.01, "max": 10.56, "min": 11.71, "cnt": 32}, "MoE_L1_bwd":{"total": 309.65, "avg": 9.68, "max": 9.10, "min": 10.14, "cnt": 32}, "MoE_L0_bwd":{"total": 322.25, "avg": 10.07, "max": 9.73, "min": 10.45, "cnt": 32}, "backward-send-forward-recv":{"total": 3560.58, "avg": 122.78, "max": 2.29, "min": 406.74, "cnt": 29}, "backward-send":{"total": 3.22, "avg": 1.07, "max": 1.05, "min": 1.11, "cnt": 3}, "backward-recv":{"total": 145.03, "avg": 72.52, "max": 70.60, "min": 74.44, "cnt": 2}, "backward-params-all-reduce":{"total": 490.98, "avg": 490.98, "max": 490.98, "min": 490.98, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 242.06, "avg": 242.06, "max": 242.06, "min": 242.06, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 202.58, "avg": 202.58, "max": 202.58, "min": 202.58, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.35, "avg": 3.35, "max": 3.35, "min": 3.35, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.47, "avg": 3.47, "max": 3.47, "min": 3.47, "cnt": 1}}}
{"type":"time", "iteration": 64, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 80.34, "avg": 26.78, "max": 1.06, "min": 75.81, "cnt": 3}, "forward-compute":{"total": 1800.15, "avg": 56.25, "max": 50.10, "min": 62.94, "cnt": 32}, "fwd-compute":{"total": 1797.01, "avg": 56.16, "max": 50.03, "min": 62.86, "cnt": 32}, "batch-generator":{"total": 42.52, "avg": 1.33, "max": 0.67, "min": 2.72, "cnt": 32}, "fwd-embedding":{"total": 0.52, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1742.49, "avg": 54.45, "max": 48.99, "min": 61.14, "cnt": 32}, "fwd-layernorm":{"total": 9.29, "avg": 0.07, "max": 0.06, "min": 0.22, "cnt": 128}, "fwd-attn":{"total": 106.71, "avg": 0.83, "max": 0.74, "min": 1.92, "cnt": 128}, "fwd-misc":{"total": 20.23, "avg": 0.16, "max": 0.11, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1585.70, "avg": 12.39, "max": 10.55, "min": 19.42, "cnt": 128}, "MoE_L0_fwd":{"total": 463.13, "avg": 14.47, "max": 10.85, "min": 19.33, "cnt": 32}, "MoEMLP":{"total": 1569.05, "avg": 12.26, "max": 10.43, "min": 19.28, "cnt": 128}, "MoE_L1_fwd":{"total": 367.04, "avg": 11.47, "max": 10.60, "min": 13.94, "cnt": 32}, "MoE_L2_fwd":{"total": 352.25, "avg": 11.01, "max": 10.48, "min": 12.15, "cnt": 32}, "MoE_L3_fwd":{"total": 392.58, "avg": 12.27, "max": 11.35, "min": 18.76, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 5.53, "avg": 2.77, "max": 0.95, "min": 4.59, "cnt": 2}, "forward-send-backward-recv":{"total": 212.45, "avg": 7.08, "max": 1.28, "min": 120.67, "cnt": 30}, "backward-compute":{"total": 1606.22, "avg": 50.19, "max": 48.03, "min": 52.98, "cnt": 32}, "MoE_L3_bwd":{"total": 429.83, "avg": 13.43, "max": 12.75, "min": 16.29, "cnt": 32}, "MoE_L2_bwd":{"total": 344.94, "avg": 10.78, "max": 10.21, "min": 12.08, "cnt": 32}, "MoE_L1_bwd":{"total": 310.14, "avg": 9.69, "max": 8.88, "min": 11.13, "cnt": 32}, "MoE_L0_bwd":{"total": 306.63, "avg": 9.58, "max": 9.06, "min": 11.16, "cnt": 32}, "backward-send-forward-recv":{"total": 4351.15, "avg": 150.04, "max": 2.42, "min": 479.66, "cnt": 29}, "backward-send":{"total": 2.40, "avg": 0.80, "max": 0.60, "min": 0.92, "cnt": 3}, "backward-recv":{"total": 135.97, "avg": 67.98, "max": 64.01, "min": 71.95, "cnt": 2}, "backward-params-all-reduce":{"total": 490.08, "avg": 490.08, "max": 490.08, "min": 490.08, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.04, "avg": 0.04, "max": 0.04, "min": 0.04, "cnt": 1}, "optimizer":{"total": 243.68, "avg": 243.68, "max": 243.68, "min": 243.68, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 203.75, "avg": 203.75, "max": 203.75, "min": 203.75, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.36, "avg": 3.36, "max": 3.36, "min": 3.36, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.48, "avg": 3.48, "max": 3.48, "min": 3.48, "cnt": 1}}}
{"type":"time", "iteration": 65, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 526.25, "avg": 175.42, "max": 1.47, "min": 444.91, "cnt": 3}, "forward-compute":{"total": 1826.53, "avg": 57.08, "max": 50.61, "min": 63.30, "cnt": 32}, "fwd-compute":{"total": 1823.46, "avg": 56.98, "max": 50.54, "min": 63.23, "cnt": 32}, "batch-generator":{"total": 38.72, "avg": 1.21, "max": 0.71, "min": 2.34, "cnt": 32}, "fwd-embedding":{"total": 0.63, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1771.47, "avg": 55.36, "max": 48.80, "min": 61.04, "cnt": 32}, "fwd-layernorm":{"total": 10.00, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 110.10, "avg": 0.86, "max": 0.74, "min": 1.94, "cnt": 128}, "fwd-misc":{"total": 21.69, "avg": 0.17, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1607.81, "avg": 12.56, "max": 10.53, "min": 20.63, "cnt": 128}, "MoE_L0_fwd":{"total": 487.98, "avg": 15.25, "max": 10.88, "min": 20.46, "cnt": 32}, "MoEMLP":{"total": 1590.66, "avg": 12.43, "max": 10.41, "min": 20.37, "cnt": 128}, "MoE_L1_fwd":{"total": 362.70, "avg": 11.33, "max": 10.74, "min": 12.35, "cnt": 32}, "MoE_L2_fwd":{"total": 351.56, "avg": 10.99, "max": 10.46, "min": 12.80, "cnt": 32}, "MoE_L3_fwd":{"total": 394.76, "avg": 12.34, "max": 11.36, "min": 16.87, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.56, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 10.68, "avg": 5.34, "max": 0.87, "min": 9.81, "cnt": 2}, "forward-send-backward-recv":{"total": 136.33, "avg": 4.54, "max": 1.54, "min": 50.05, "cnt": 30}, "backward-compute":{"total": 1609.07, "avg": 50.28, "max": 47.54, "min": 51.33, "cnt": 32}, "MoE_L3_bwd":{"total": 422.13, "avg": 13.19, "max": 11.91, "min": 14.11, "cnt": 32}, "MoE_L2_bwd":{"total": 346.15, "avg": 10.82, "max": 10.32, "min": 11.43, "cnt": 32}, "MoE_L1_bwd":{"total": 309.82, "avg": 9.68, "max": 9.24, "min": 10.02, "cnt": 32}, "MoE_L0_bwd":{"total": 316.50, "avg": 9.89, "max": 9.37, "min": 10.57, "cnt": 32}, "backward-send-forward-recv":{"total": 4202.04, "avg": 144.90, "max": 2.32, "min": 588.14, "cnt": 29}, "backward-send":{"total": 2.54, "avg": 0.85, "max": 0.56, "min": 1.15, "cnt": 3}, "backward-recv":{"total": 169.83, "avg": 84.92, "max": 61.83, "min": 108.00, "cnt": 2}, "backward-params-all-reduce":{"total": 492.99, "avg": 492.99, "max": 492.99, "min": 492.99, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 238.45, "avg": 238.45, "max": 238.45, "min": 238.45, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.36, "avg": 3.36, "max": 3.36, "min": 3.36, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 198.58, "avg": 198.58, "max": 198.58, "min": 198.58, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.47, "avg": 3.47, "max": 3.47, "min": 3.47, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 66, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 81.25, "avg": 27.08, "max": 1.22, "min": 77.66, "cnt": 3}, "forward-compute":{"total": 1839.89, "avg": 57.50, "max": 51.56, "min": 64.03, "cnt": 32}, "fwd-compute":{"total": 1836.81, "avg": 57.40, "max": 51.48, "min": 63.95, "cnt": 32}, "batch-generator":{"total": 47.07, "avg": 1.47, "max": 0.73, "min": 3.96, "cnt": 32}, "fwd-embedding":{"total": 0.63, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1777.11, "avg": 55.53, "max": 50.10, "min": 62.22, "cnt": 32}, "fwd-layernorm":{"total": 10.16, "avg": 0.08, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 110.52, "avg": 0.86, "max": 0.74, "min": 1.53, "cnt": 128}, "fwd-misc":{"total": 21.74, "avg": 0.17, "max": 0.12, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1612.56, "avg": 12.60, "max": 10.46, "min": 20.50, "cnt": 128}, "MoE_L0_fwd":{"total": 487.14, "avg": 15.22, "max": 11.17, "min": 20.42, "cnt": 32}, "MoEMLP":{"total": 1595.03, "avg": 12.46, "max": 10.36, "min": 20.36, "cnt": 128}, "MoE_L1_fwd":{"total": 365.53, "avg": 11.42, "max": 10.60, "min": 12.91, "cnt": 32}, "MoE_L2_fwd":{"total": 351.80, "avg": 10.99, "max": 10.40, "min": 13.45, "cnt": 32}, "MoE_L3_fwd":{"total": 396.91, "avg": 12.40, "max": 11.61, "min": 15.06, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 2.21, "avg": 1.10, "max": 0.95, "min": 1.26, "cnt": 2}, "forward-send-backward-recv":{"total": 221.18, "avg": 7.37, "max": 1.73, "min": 107.43, "cnt": 30}, "backward-compute":{"total": 1619.98, "avg": 50.62, "max": 47.56, "min": 53.31, "cnt": 32}, "MoE_L3_bwd":{"total": 434.23, "avg": 13.57, "max": 12.31, "min": 16.74, "cnt": 32}, "MoE_L2_bwd":{"total": 349.15, "avg": 10.91, "max": 10.37, "min": 11.68, "cnt": 32}, "MoE_L1_bwd":{"total": 310.93, "avg": 9.72, "max": 9.27, "min": 10.28, "cnt": 32}, "MoE_L0_bwd":{"total": 311.53, "avg": 9.74, "max": 9.19, "min": 10.85, "cnt": 32}, "backward-send-forward-recv":{"total": 5818.03, "avg": 200.62, "max": 1.80, "min": 832.44, "cnt": 29}, "backward-send":{"total": 3.24, "avg": 1.08, "max": 0.98, "min": 1.14, "cnt": 3}, "backward-recv":{"total": 151.36, "avg": 75.68, "max": 74.66, "min": 76.70, "cnt": 2}, "backward-params-all-reduce":{"total": 487.36, "avg": 487.36, "max": 487.36, "min": 487.36, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 245.11, "avg": 245.11, "max": 245.11, "min": 245.11, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 205.25, "avg": 205.25, "max": 205.25, "min": 205.25, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.48, "avg": 3.48, "max": 3.48, "min": 3.48, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.49, "avg": 3.49, "max": 3.49, "min": 3.49, "cnt": 1}}}
{"type":"time", "iteration": 67, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 68.45, "avg": 22.82, "max": 1.46, "min": 63.26, "cnt": 3}, "forward-compute":{"total": 1811.82, "avg": 56.62, "max": 49.18, "min": 62.47, "cnt": 32}, "fwd-compute":{"total": 1808.86, "avg": 56.53, "max": 49.11, "min": 62.39, "cnt": 32}, "batch-generator":{"total": 43.28, "avg": 1.35, "max": 0.67, "min": 2.70, "cnt": 32}, "fwd-embedding":{"total": 0.65, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1752.99, "avg": 54.78, "max": 48.16, "min": 60.97, "cnt": 32}, "fwd-layernorm":{"total": 10.22, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 110.40, "avg": 0.86, "max": 0.74, "min": 1.54, "cnt": 128}, "fwd-misc":{"total": 21.77, "avg": 0.17, "max": 0.12, "min": 0.39, "cnt": 128}, "fwd-MLP":{"total": 1588.74, "avg": 12.41, "max": 10.02, "min": 20.76, "cnt": 128}, "MoE_L0_fwd":{"total": 480.85, "avg": 15.03, "max": 11.12, "min": 20.66, "cnt": 32}, "MoEMLP":{"total": 1571.32, "avg": 12.28, "max": 9.91, "min": 20.61, "cnt": 128}, "MoE_L1_fwd":{"total": 370.06, "avg": 11.56, "max": 10.29, "min": 14.75, "cnt": 32}, "MoE_L2_fwd":{"total": 337.99, "avg": 10.56, "max": 9.95, "min": 11.29, "cnt": 32}, "MoE_L3_fwd":{"total": 388.82, "avg": 12.15, "max": 11.54, "min": 13.09, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 5.26, "avg": 2.63, "max": 0.94, "min": 4.32, "cnt": 2}, "forward-send-backward-recv":{"total": 216.90, "avg": 7.23, "max": 1.21, "min": 121.93, "cnt": 30}, "backward-compute":{"total": 1617.81, "avg": 50.56, "max": 48.83, "min": 52.18, "cnt": 32}, "MoE_L3_bwd":{"total": 429.02, "avg": 13.41, "max": 12.38, "min": 14.50, "cnt": 32}, "MoE_L2_bwd":{"total": 325.52, "avg": 10.17, "max": 9.58, "min": 10.93, "cnt": 32}, "MoE_L1_bwd":{"total": 318.39, "avg": 9.95, "max": 9.17, "min": 10.36, "cnt": 32}, "MoE_L0_bwd":{"total": 326.83, "avg": 10.21, "max": 9.55, "min": 10.98, "cnt": 32}, "backward-send-forward-recv":{"total": 6259.04, "avg": 215.83, "max": 2.37, "min": 956.41, "cnt": 29}, "backward-send":{"total": 3.18, "avg": 1.06, "max": 0.95, "min": 1.15, "cnt": 3}, "backward-recv":{"total": 136.22, "avg": 68.11, "max": 60.01, "min": 76.21, "cnt": 2}, "backward-params-all-reduce":{"total": 482.77, "avg": 482.77, "max": 482.77, "min": 482.77, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 247.59, "avg": 247.59, "max": 247.59, "min": 247.59, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 207.76, "avg": 207.76, "max": 207.76, "min": 207.76, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}}}
{"type":"time", "iteration": 68, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 72.89, "avg": 24.30, "max": 1.41, "min": 70.05, "cnt": 3}, "forward-compute":{"total": 1830.41, "avg": 57.20, "max": 52.41, "min": 65.81, "cnt": 32}, "fwd-compute":{"total": 1827.38, "avg": 57.11, "max": 52.34, "min": 65.74, "cnt": 32}, "batch-generator":{"total": 41.39, "avg": 1.29, "max": 0.67, "min": 2.90, "cnt": 32}, "fwd-embedding":{"total": 0.62, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1773.71, "avg": 55.43, "max": 51.33, "min": 64.64, "cnt": 32}, "fwd-layernorm":{"total": 10.10, "avg": 0.08, "max": 0.05, "min": 0.22, "cnt": 128}, "fwd-attn":{"total": 108.78, "avg": 0.85, "max": 0.74, "min": 1.60, "cnt": 128}, "fwd-misc":{"total": 22.45, "avg": 0.18, "max": 0.12, "min": 0.66, "cnt": 128}, "fwd-MLP":{"total": 1610.40, "avg": 12.58, "max": 10.43, "min": 23.23, "cnt": 128}, "MoE_L0_fwd":{"total": 477.21, "avg": 14.91, "max": 12.28, "min": 23.15, "cnt": 32}, "MoEMLP":{"total": 1592.30, "avg": 12.44, "max": 10.29, "min": 23.11, "cnt": 128}, "MoE_L1_fwd":{"total": 364.12, "avg": 11.38, "max": 10.33, "min": 12.51, "cnt": 32}, "MoE_L2_fwd":{"total": 360.91, "avg": 11.28, "max": 10.73, "min": 12.30, "cnt": 32}, "MoE_L3_fwd":{"total": 396.57, "avg": 12.39, "max": 11.65, "min": 14.00, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 5.04, "avg": 2.52, "max": 0.94, "min": 4.11, "cnt": 2}, "forward-send-backward-recv":{"total": 214.29, "avg": 7.14, "max": 1.34, "min": 122.94, "cnt": 30}, "backward-compute":{"total": 1677.44, "avg": 52.42, "max": 50.74, "min": 55.91, "cnt": 32}, "MoE_L3_bwd":{"total": 436.00, "avg": 13.62, "max": 12.72, "min": 17.48, "cnt": 32}, "MoE_L2_bwd":{"total": 351.55, "avg": 10.99, "max": 10.12, "min": 11.62, "cnt": 32}, "MoE_L1_bwd":{"total": 307.27, "avg": 9.60, "max": 9.28, "min": 9.98, "cnt": 32}, "MoE_L0_bwd":{"total": 366.20, "avg": 11.44, "max": 11.09, "min": 13.55, "cnt": 32}, "backward-send-forward-recv":{"total": 3478.71, "avg": 119.96, "max": 2.07, "min": 308.59, "cnt": 29}, "backward-send":{"total": 1.94, "avg": 0.65, "max": 0.53, "min": 0.80, "cnt": 3}, "backward-recv":{"total": 129.34, "avg": 64.67, "max": 62.67, "min": 66.66, "cnt": 2}, "backward-params-all-reduce":{"total": 484.59, "avg": 484.59, "max": 484.59, "min": 484.59, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 247.62, "avg": 247.62, "max": 247.62, "min": 247.62, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 207.37, "avg": 207.37, "max": 207.37, "min": 207.37, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.76, "avg": 3.76, "max": 3.76, "min": 3.76, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}}}
{"type":"time", "iteration": 69, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.12, "avg": 0.12, "max": 0.12, "min": 0.12, "cnt": 1}, "forward-recv":{"total": 86.31, "avg": 28.77, "max": 4.20, "min": 73.71, "cnt": 3}, "forward-compute":{"total": 1890.41, "avg": 59.08, "max": 51.78, "min": 102.37, "cnt": 32}, "fwd-compute":{"total": 1887.55, "avg": 58.99, "max": 51.71, "min": 102.28, "cnt": 32}, "batch-generator":{"total": 42.59, "avg": 1.33, "max": 0.67, "min": 3.86, "cnt": 32}, "fwd-embedding":{"total": 0.52, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1832.46, "avg": 57.26, "max": 50.64, "min": 101.04, "cnt": 32}, "fwd-layernorm":{"total": 9.60, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 104.55, "avg": 0.82, "max": 0.74, "min": 1.51, "cnt": 128}, "fwd-misc":{"total": 21.05, "avg": 0.16, "max": 0.12, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1675.74, "avg": 13.09, "max": 10.14, "min": 61.21, "cnt": 128}, "MoE_L0_fwd":{"total": 551.59, "avg": 17.24, "max": 11.71, "min": 61.11, "cnt": 32}, "MoEMLP":{"total": 1658.39, "avg": 12.96, "max": 10.02, "min": 61.06, "cnt": 128}, "MoE_L1_fwd":{"total": 360.08, "avg": 11.25, "max": 10.06, "min": 13.18, "cnt": 32}, "MoE_L2_fwd":{"total": 367.14, "avg": 11.47, "max": 10.86, "min": 13.41, "cnt": 32}, "MoE_L3_fwd":{"total": 385.79, "avg": 12.06, "max": 11.64, "min": 12.53, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.61, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.96, "avg": 0.98, "max": 0.95, "min": 1.01, "cnt": 2}, "forward-send-backward-recv":{"total": 201.01, "avg": 6.70, "max": 1.60, "min": 111.31, "cnt": 30}, "backward-compute":{"total": 1679.88, "avg": 52.50, "max": 50.40, "min": 54.58, "cnt": 32}, "MoE_L3_bwd":{"total": 424.86, "avg": 13.28, "max": 12.26, "min": 14.31, "cnt": 32}, "MoE_L2_bwd":{"total": 369.58, "avg": 11.55, "max": 10.74, "min": 12.98, "cnt": 32}, "MoE_L1_bwd":{"total": 303.72, "avg": 9.49, "max": 8.87, "min": 10.39, "cnt": 32}, "MoE_L0_bwd":{"total": 366.76, "avg": 11.46, "max": 11.05, "min": 12.24, "cnt": 32}, "backward-send-forward-recv":{"total": 7582.24, "avg": 261.46, "max": 1.90, "min": 1457.30, "cnt": 29}, "backward-send":{"total": 2.44, "avg": 0.81, "max": 0.47, "min": 1.03, "cnt": 3}, "backward-recv":{"total": 143.23, "avg": 71.61, "max": 68.40, "min": 74.83, "cnt": 2}, "backward-params-all-reduce":{"total": 489.16, "avg": 489.16, "max": 489.16, "min": 489.16, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 242.65, "avg": 242.65, "max": 242.65, "min": 242.65, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.36, "avg": 3.36, "max": 3.36, "min": 3.36, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 202.80, "avg": 202.80, "max": 202.80, "min": 202.80, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.22, "avg": 3.22, "max": 3.22, "min": 3.22, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 70, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 97.77, "avg": 32.59, "max": 6.27, "min": 79.86, "cnt": 3}, "forward-compute":{"total": 1784.68, "avg": 55.77, "max": 50.39, "min": 68.22, "cnt": 32}, "fwd-compute":{"total": 1781.59, "avg": 55.67, "max": 50.32, "min": 68.14, "cnt": 32}, "batch-generator":{"total": 42.04, "avg": 1.31, "max": 0.70, "min": 4.22, "cnt": 32}, "fwd-embedding":{"total": 0.59, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1727.41, "avg": 53.98, "max": 49.23, "min": 66.73, "cnt": 32}, "fwd-layernorm":{"total": 10.09, "avg": 0.08, "max": 0.05, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 109.82, "avg": 0.86, "max": 0.74, "min": 1.71, "cnt": 128}, "fwd-misc":{"total": 22.37, "avg": 0.17, "max": 0.11, "min": 0.68, "cnt": 128}, "fwd-MLP":{"total": 1563.18, "avg": 12.21, "max": 9.89, "min": 25.02, "cnt": 128}, "MoE_L0_fwd":{"total": 455.18, "avg": 14.22, "max": 11.07, "min": 24.87, "cnt": 32}, "MoEMLP":{"total": 1545.77, "avg": 12.08, "max": 9.76, "min": 24.78, "cnt": 128}, "MoE_L1_fwd":{"total": 350.52, "avg": 10.95, "max": 9.81, "min": 15.85, "cnt": 32}, "MoE_L2_fwd":{"total": 360.27, "avg": 11.26, "max": 10.61, "min": 11.99, "cnt": 32}, "MoE_L3_fwd":{"total": 386.21, "avg": 12.07, "max": 11.56, "min": 14.50, "cnt": 32}, "fwd-pooler":{"total": 0.36, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.89, "avg": 0.95, "max": 0.92, "min": 0.97, "cnt": 2}, "forward-send-backward-recv":{"total": 283.83, "avg": 9.46, "max": 1.61, "min": 106.84, "cnt": 30}, "backward-compute":{"total": 1655.47, "avg": 51.73, "max": 48.95, "min": 53.36, "cnt": 32}, "MoE_L3_bwd":{"total": 424.19, "avg": 13.26, "max": 12.46, "min": 14.48, "cnt": 32}, "MoE_L2_bwd":{"total": 367.61, "avg": 11.49, "max": 10.55, "min": 12.43, "cnt": 32}, "MoE_L1_bwd":{"total": 295.44, "avg": 9.23, "max": 8.05, "min": 9.73, "cnt": 32}, "MoE_L0_bwd":{"total": 352.19, "avg": 11.01, "max": 10.37, "min": 12.01, "cnt": 32}, "backward-send-forward-recv":{"total": 4090.20, "avg": 141.04, "max": 2.33, "min": 329.25, "cnt": 29}, "backward-send":{"total": 2.91, "avg": 0.97, "max": 0.72, "min": 1.10, "cnt": 3}, "backward-recv":{"total": 139.76, "avg": 69.88, "max": 69.52, "min": 70.24, "cnt": 2}, "backward-params-all-reduce":{"total": 488.52, "avg": 488.52, "max": 488.52, "min": 488.52, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 242.07, "avg": 242.07, "max": 242.07, "min": 242.07, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 202.38, "avg": 202.38, "max": 202.38, "min": 202.38, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.30, "avg": 3.30, "max": 3.30, "min": 3.30, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 71, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 82.82, "avg": 27.61, "max": 1.32, "min": 78.52, "cnt": 3}, "forward-compute":{"total": 1816.61, "avg": 56.77, "max": 50.03, "min": 64.14, "cnt": 32}, "fwd-compute":{"total": 1813.40, "avg": 56.67, "max": 49.96, "min": 64.06, "cnt": 32}, "batch-generator":{"total": 47.27, "avg": 1.48, "max": 0.69, "min": 4.08, "cnt": 32}, "fwd-embedding":{"total": 0.63, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1753.47, "avg": 54.80, "max": 48.93, "min": 62.44, "cnt": 32}, "fwd-layernorm":{"total": 10.06, "avg": 0.08, "max": 0.05, "min": 0.27, "cnt": 128}, "fwd-attn":{"total": 107.95, "avg": 0.84, "max": 0.74, "min": 2.28, "cnt": 128}, "fwd-misc":{"total": 20.96, "avg": 0.16, "max": 0.12, "min": 0.38, "cnt": 128}, "fwd-MLP":{"total": 1592.76, "avg": 12.44, "max": 9.79, "min": 20.66, "cnt": 128}, "MoE_L0_fwd":{"total": 479.55, "avg": 14.99, "max": 11.36, "min": 20.59, "cnt": 32}, "MoEMLP":{"total": 1576.08, "avg": 12.31, "max": 9.67, "min": 20.54, "cnt": 128}, "MoE_L1_fwd":{"total": 356.91, "avg": 11.15, "max": 9.71, "min": 14.57, "cnt": 32}, "MoE_L2_fwd":{"total": 362.28, "avg": 11.32, "max": 10.65, "min": 13.24, "cnt": 32}, "MoE_L3_fwd":{"total": 383.51, "avg": 11.98, "max": 11.54, "min": 14.56, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.61, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.73, "avg": 0.87, "max": 0.81, "min": 0.92, "cnt": 2}, "forward-send-backward-recv":{"total": 196.69, "avg": 6.56, "max": 1.49, "min": 116.79, "cnt": 30}, "backward-compute":{"total": 1656.41, "avg": 51.76, "max": 48.94, "min": 53.92, "cnt": 32}, "MoE_L3_bwd":{"total": 422.88, "avg": 13.21, "max": 12.28, "min": 15.25, "cnt": 32}, "MoE_L2_bwd":{"total": 368.57, "avg": 11.52, "max": 10.85, "min": 12.51, "cnt": 32}, "MoE_L1_bwd":{"total": 296.75, "avg": 9.27, "max": 7.80, "min": 9.96, "cnt": 32}, "MoE_L0_bwd":{"total": 349.59, "avg": 10.92, "max": 10.53, "min": 11.54, "cnt": 32}, "backward-send-forward-recv":{"total": 5598.31, "avg": 193.05, "max": 2.44, "min": 923.95, "cnt": 29}, "backward-send":{"total": 3.26, "avg": 1.09, "max": 1.00, "min": 1.22, "cnt": 3}, "backward-recv":{"total": 209.99, "avg": 104.99, "max": 75.89, "min": 134.10, "cnt": 2}, "backward-params-all-reduce":{"total": 486.13, "avg": 486.13, "max": 486.13, "min": 486.13, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 244.92, "avg": 244.92, "max": 244.92, "min": 244.92, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 205.49, "avg": 205.49, "max": 205.49, "min": 205.49, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.05, "avg": 3.05, "max": 3.05, "min": 3.05, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.48, "avg": 3.48, "max": 3.48, "min": 3.48, "cnt": 1}}}
{"type":"time", "iteration": 72, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 71.80, "avg": 23.93, "max": 1.34, "min": 67.06, "cnt": 3}, "forward-compute":{"total": 1805.89, "avg": 56.43, "max": 50.26, "min": 62.08, "cnt": 32}, "fwd-compute":{"total": 1802.77, "avg": 56.34, "max": 50.19, "min": 61.98, "cnt": 32}, "batch-generator":{"total": 49.20, "avg": 1.54, "max": 0.69, "min": 3.93, "cnt": 32}, "fwd-embedding":{"total": 0.60, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1741.11, "avg": 54.41, "max": 49.21, "min": 60.40, "cnt": 32}, "fwd-layernorm":{"total": 10.09, "avg": 0.08, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 110.61, "avg": 0.86, "max": 0.74, "min": 2.21, "cnt": 128}, "fwd-misc":{"total": 21.78, "avg": 0.17, "max": 0.12, "min": 0.43, "cnt": 128}, "fwd-MLP":{"total": 1576.92, "avg": 12.32, "max": 9.93, "min": 21.35, "cnt": 128}, "MoE_L0_fwd":{"total": 475.96, "avg": 14.87, "max": 11.20, "min": 21.23, "cnt": 32}, "MoEMLP":{"total": 1559.75, "avg": 12.19, "max": 9.81, "min": 21.15, "cnt": 128}, "MoE_L1_fwd":{"total": 347.04, "avg": 10.84, "max": 9.86, "min": 12.22, "cnt": 32}, "MoE_L2_fwd":{"total": 354.76, "avg": 11.09, "max": 10.34, "min": 11.75, "cnt": 32}, "MoE_L3_fwd":{"total": 388.39, "avg": 12.14, "max": 11.68, "min": 13.10, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.60, "avg": 0.80, "max": 0.64, "min": 0.96, "cnt": 2}, "forward-send-backward-recv":{"total": 218.06, "avg": 7.27, "max": 1.42, "min": 118.81, "cnt": 30}, "backward-compute":{"total": 1656.27, "avg": 51.76, "max": 49.70, "min": 53.14, "cnt": 32}, "MoE_L3_bwd":{"total": 434.03, "avg": 13.56, "max": 12.76, "min": 15.00, "cnt": 32}, "MoE_L2_bwd":{"total": 355.82, "avg": 11.12, "max": 10.52, "min": 11.90, "cnt": 32}, "MoE_L1_bwd":{"total": 296.92, "avg": 9.28, "max": 8.49, "min": 10.09, "cnt": 32}, "MoE_L0_bwd":{"total": 351.98, "avg": 11.00, "max": 10.55, "min": 12.25, "cnt": 32}, "backward-send-forward-recv":{"total": 5232.83, "avg": 180.44, "max": 2.47, "min": 711.22, "cnt": 29}, "backward-send":{"total": 2.43, "avg": 0.81, "max": 0.70, "min": 0.94, "cnt": 3}, "backward-recv":{"total": 516.20, "avg": 258.10, "max": 69.14, "min": 447.06, "cnt": 2}, "backward-params-all-reduce":{"total": 491.15, "avg": 491.15, "max": 491.15, "min": 491.15, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 239.40, "avg": 239.40, "max": 239.40, "min": 239.40, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 199.36, "avg": 199.36, "max": 199.36, "min": 199.36, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.54, "avg": 3.54, "max": 3.54, "min": 3.54, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 73, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 419.68, "avg": 139.89, "max": 10.86, "min": 332.50, "cnt": 3}, "forward-compute":{"total": 1863.81, "avg": 58.24, "max": 51.36, "min": 66.02, "cnt": 32}, "fwd-compute":{"total": 1859.84, "avg": 58.12, "max": 51.29, "min": 65.84, "cnt": 32}, "batch-generator":{"total": 43.42, "avg": 1.36, "max": 0.72, "min": 2.13, "cnt": 32}, "fwd-embedding":{"total": 0.82, "avg": 0.03, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1802.55, "avg": 56.33, "max": 50.23, "min": 63.46, "cnt": 32}, "fwd-layernorm":{"total": 11.17, "avg": 0.09, "max": 0.05, "min": 0.25, "cnt": 128}, "fwd-attn":{"total": 115.64, "avg": 0.90, "max": 0.74, "min": 2.05, "cnt": 128}, "fwd-misc":{"total": 22.63, "avg": 0.18, "max": 0.11, "min": 0.40, "cnt": 128}, "fwd-MLP":{"total": 1629.82, "avg": 12.73, "max": 10.22, "min": 17.96, "cnt": 128}, "MoE_L0_fwd":{"total": 494.01, "avg": 15.44, "max": 12.05, "min": 17.88, "cnt": 32}, "MoEMLP":{"total": 1611.81, "avg": 12.59, "max": 10.11, "min": 17.83, "cnt": 128}, "MoE_L1_fwd":{"total": 367.38, "avg": 11.48, "max": 10.15, "min": 13.20, "cnt": 32}, "MoE_L2_fwd":{"total": 358.39, "avg": 11.20, "max": 10.45, "min": 16.26, "cnt": 32}, "MoE_L3_fwd":{"total": 398.63, "avg": 12.46, "max": 11.72, "min": 13.55, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.56, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.63, "avg": 0.81, "max": 0.76, "min": 0.87, "cnt": 2}, "forward-send-backward-recv":{"total": 4560.73, "avg": 152.02, "max": 6.91, "min": 529.32, "cnt": 30}, "backward-compute":{"total": 1681.65, "avg": 52.55, "max": 49.75, "min": 55.81, "cnt": 32}, "MoE_L3_bwd":{"total": 462.92, "avg": 14.47, "max": 13.14, "min": 17.52, "cnt": 32}, "MoE_L2_bwd":{"total": 346.58, "avg": 10.83, "max": 9.87, "min": 11.35, "cnt": 32}, "MoE_L1_bwd":{"total": 308.13, "avg": 9.63, "max": 8.48, "min": 10.53, "cnt": 32}, "MoE_L0_bwd":{"total": 349.47, "avg": 10.92, "max": 10.34, "min": 12.47, "cnt": 32}, "backward-send-forward-recv":{"total": 706.30, "avg": 24.36, "max": 1.82, "min": 438.26, "cnt": 29}, "backward-send":{"total": 2.72, "avg": 0.91, "max": 0.83, "min": 0.98, "cnt": 3}, "backward-recv":{"total": 298.78, "avg": 149.39, "max": 75.71, "min": 223.06, "cnt": 2}, "backward-params-all-reduce":{"total": 486.03, "avg": 486.03, "max": 486.03, "min": 486.03, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 243.04, "avg": 243.04, "max": 243.04, "min": 243.04, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 203.13, "avg": 203.13, "max": 203.13, "min": 203.13, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.33, "avg": 3.33, "max": 3.33, "min": 3.33, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 74, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 72.83, "avg": 24.28, "max": 1.25, "min": 70.17, "cnt": 3}, "forward-compute":{"total": 1816.67, "avg": 56.77, "max": 50.74, "min": 71.30, "cnt": 32}, "fwd-compute":{"total": 1813.30, "avg": 56.67, "max": 50.67, "min": 71.22, "cnt": 32}, "batch-generator":{"total": 50.19, "avg": 1.57, "max": 0.70, "min": 3.65, "cnt": 32}, "fwd-embedding":{"total": 0.68, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1750.36, "avg": 54.70, "max": 49.61, "min": 67.69, "cnt": 32}, "fwd-layernorm":{"total": 9.98, "avg": 0.08, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 108.76, "avg": 0.85, "max": 0.74, "min": 2.30, "cnt": 128}, "fwd-misc":{"total": 21.36, "avg": 0.17, "max": 0.12, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1588.49, "avg": 12.41, "max": 9.84, "min": 24.65, "cnt": 128}, "MoE_L0_fwd":{"total": 475.91, "avg": 14.87, "max": 11.42, "min": 24.57, "cnt": 32}, "MoEMLP":{"total": 1570.95, "avg": 12.27, "max": 9.71, "min": 24.53, "cnt": 128}, "MoE_L1_fwd":{"total": 364.37, "avg": 11.39, "max": 10.41, "min": 14.20, "cnt": 32}, "MoE_L2_fwd":{"total": 330.67, "avg": 10.33, "max": 9.76, "min": 14.57, "cnt": 32}, "MoE_L3_fwd":{"total": 406.93, "avg": 12.72, "max": 12.00, "min": 15.17, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 4.76, "avg": 2.38, "max": 0.93, "min": 3.84, "cnt": 2}, "forward-send-backward-recv":{"total": 212.61, "avg": 7.09, "max": 1.42, "min": 127.16, "cnt": 30}, "backward-compute":{"total": 1642.91, "avg": 51.34, "max": 49.40, "min": 53.64, "cnt": 32}, "MoE_L3_bwd":{"total": 448.83, "avg": 14.03, "max": 13.54, "min": 16.64, "cnt": 32}, "MoE_L2_bwd":{"total": 315.31, "avg": 9.85, "max": 9.17, "min": 10.48, "cnt": 32}, "MoE_L1_bwd":{"total": 312.43, "avg": 9.76, "max": 9.11, "min": 10.33, "cnt": 32}, "MoE_L0_bwd":{"total": 352.51, "avg": 11.02, "max": 10.31, "min": 11.80, "cnt": 32}, "backward-send-forward-recv":{"total": 5002.24, "avg": 172.49, "max": 2.34, "min": 609.42, "cnt": 29}, "backward-send":{"total": 2.86, "avg": 0.95, "max": 0.80, "min": 1.05, "cnt": 3}, "backward-recv":{"total": 158.33, "avg": 79.17, "max": 77.18, "min": 81.16, "cnt": 2}, "backward-params-all-reduce":{"total": 489.01, "avg": 489.01, "max": 489.01, "min": 489.01, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 236.46, "avg": 236.46, "max": 236.46, "min": 236.46, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 196.72, "avg": 196.72, "max": 196.72, "min": 196.72, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.36, "avg": 3.36, "max": 3.36, "min": 3.36, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 75, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 80.02, "avg": 26.67, "max": 1.36, "min": 77.20, "cnt": 3}, "forward-compute":{"total": 1779.97, "avg": 55.62, "max": 49.84, "min": 62.60, "cnt": 32}, "fwd-compute":{"total": 1776.88, "avg": 55.53, "max": 49.77, "min": 62.45, "cnt": 32}, "batch-generator":{"total": 52.08, "avg": 1.63, "max": 0.65, "min": 4.18, "cnt": 32}, "fwd-embedding":{"total": 0.63, "avg": 0.02, "max": 0.01, "min": 0.06, "cnt": 32}, "fwd-encoder":{"total": 1712.14, "avg": 53.50, "max": 48.54, "min": 60.37, "cnt": 32}, "fwd-layernorm":{"total": 9.78, "avg": 0.08, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 107.38, "avg": 0.84, "max": 0.74, "min": 1.55, "cnt": 128}, "fwd-misc":{"total": 21.42, "avg": 0.17, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1552.13, "avg": 12.13, "max": 9.46, "min": 16.74, "cnt": 128}, "MoE_L0_fwd":{"total": 440.91, "avg": 13.78, "max": 11.14, "min": 16.56, "cnt": 32}, "MoEMLP":{"total": 1535.14, "avg": 11.99, "max": 9.35, "min": 16.47, "cnt": 128}, "MoE_L1_fwd":{"total": 364.11, "avg": 11.38, "max": 10.45, "min": 14.13, "cnt": 32}, "MoE_L2_fwd":{"total": 326.75, "avg": 10.21, "max": 9.39, "min": 13.76, "cnt": 32}, "MoE_L3_fwd":{"total": 409.63, "avg": 12.80, "max": 12.12, "min": 15.48, "cnt": 32}, "fwd-pooler":{"total": 0.36, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 10.97, "avg": 5.48, "max": 1.00, "min": 9.97, "cnt": 2}, "forward-send-backward-recv":{"total": 639.00, "avg": 21.30, "max": 1.07, "min": 198.93, "cnt": 30}, "backward-compute":{"total": 1651.59, "avg": 51.61, "max": 49.83, "min": 53.34, "cnt": 32}, "MoE_L3_bwd":{"total": 468.85, "avg": 14.65, "max": 14.11, "min": 15.99, "cnt": 32}, "MoE_L2_bwd":{"total": 298.15, "avg": 9.32, "max": 8.75, "min": 10.57, "cnt": 32}, "MoE_L1_bwd":{"total": 310.82, "avg": 9.71, "max": 9.02, "min": 10.43, "cnt": 32}, "MoE_L0_bwd":{"total": 362.01, "avg": 11.31, "max": 10.51, "min": 12.47, "cnt": 32}, "backward-send-forward-recv":{"total": 4795.87, "avg": 165.37, "max": 2.39, "min": 808.78, "cnt": 29}, "backward-send":{"total": 3.21, "avg": 1.07, "max": 0.91, "min": 1.22, "cnt": 3}, "backward-recv":{"total": 253.83, "avg": 126.91, "max": 74.93, "min": 178.89, "cnt": 2}, "backward-params-all-reduce":{"total": 488.19, "avg": 488.19, "max": 488.19, "min": 488.19, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 239.97, "avg": 239.97, "max": 239.97, "min": 239.97, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.47, "avg": 3.47, "max": 3.47, "min": 3.47, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 200.04, "avg": 200.04, "max": 200.04, "min": 200.04, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.54, "avg": 3.54, "max": 3.54, "min": 3.54, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 76, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 87.40, "avg": 29.13, "max": 1.22, "min": 77.32, "cnt": 3}, "forward-compute":{"total": 1804.38, "avg": 56.39, "max": 49.96, "min": 63.28, "cnt": 32}, "fwd-compute":{"total": 1801.39, "avg": 56.29, "max": 49.88, "min": 63.20, "cnt": 32}, "batch-generator":{"total": 40.37, "avg": 1.26, "max": 0.67, "min": 2.08, "cnt": 32}, "fwd-embedding":{"total": 0.60, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1748.98, "avg": 54.66, "max": 48.16, "min": 61.40, "cnt": 32}, "fwd-layernorm":{"total": 9.36, "avg": 0.07, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 106.54, "avg": 0.83, "max": 0.74, "min": 1.81, "cnt": 128}, "fwd-misc":{"total": 20.92, "avg": 0.16, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1591.58, "avg": 12.43, "max": 9.13, "min": 21.44, "cnt": 128}, "MoE_L0_fwd":{"total": 476.79, "avg": 14.90, "max": 11.16, "min": 21.30, "cnt": 32}, "MoEMLP":{"total": 1575.00, "avg": 12.30, "max": 9.02, "min": 21.22, "cnt": 128}, "MoE_L1_fwd":{"total": 375.96, "avg": 11.75, "max": 10.45, "min": 16.52, "cnt": 32}, "MoE_L2_fwd":{"total": 311.91, "avg": 9.75, "max": 9.06, "min": 11.53, "cnt": 32}, "MoE_L3_fwd":{"total": 416.39, "avg": 13.01, "max": 12.24, "min": 15.89, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.98, "avg": 0.99, "max": 0.95, "min": 1.03, "cnt": 2}, "forward-send-backward-recv":{"total": 283.21, "avg": 9.44, "max": 1.66, "min": 113.97, "cnt": 30}, "backward-compute":{"total": 1681.25, "avg": 52.54, "max": 48.74, "min": 57.89, "cnt": 32}, "MoE_L3_bwd":{"total": 476.49, "avg": 14.89, "max": 14.06, "min": 17.47, "cnt": 32}, "MoE_L2_bwd":{"total": 290.90, "avg": 9.09, "max": 7.69, "min": 9.92, "cnt": 32}, "MoE_L1_bwd":{"total": 324.82, "avg": 10.15, "max": 9.09, "min": 15.73, "cnt": 32}, "MoE_L0_bwd":{"total": 375.80, "avg": 11.74, "max": 10.99, "min": 12.80, "cnt": 32}, "backward-send-forward-recv":{"total": 4641.95, "avg": 160.07, "max": 2.30, "min": 1274.58, "cnt": 29}, "backward-send":{"total": 2.31, "avg": 0.77, "max": 0.49, "min": 1.04, "cnt": 3}, "backward-recv":{"total": 391.19, "avg": 195.59, "max": 66.07, "min": 325.12, "cnt": 2}, "backward-params-all-reduce":{"total": 487.29, "avg": 487.29, "max": 487.29, "min": 487.29, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 242.99, "avg": 242.99, "max": 242.99, "min": 242.99, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.36, "avg": 3.36, "max": 3.36, "min": 3.36, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 203.22, "avg": 203.22, "max": 203.22, "min": 203.22, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.35, "avg": 3.35, "max": 3.35, "min": 3.35, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 77, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 77.24, "avg": 25.75, "max": 0.81, "min": 74.71, "cnt": 3}, "forward-compute":{"total": 1915.36, "avg": 59.86, "max": 50.55, "min": 165.13, "cnt": 32}, "fwd-compute":{"total": 1912.03, "avg": 59.75, "max": 50.48, "min": 165.04, "cnt": 32}, "batch-generator":{"total": 45.18, "avg": 1.41, "max": 0.71, "min": 5.65, "cnt": 32}, "fwd-embedding":{"total": 0.66, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1853.99, "avg": 57.94, "max": 49.46, "min": 163.87, "cnt": 32}, "fwd-layernorm":{"total": 10.23, "avg": 0.08, "max": 0.06, "min": 0.29, "cnt": 128}, "fwd-attn":{"total": 110.53, "avg": 0.86, "max": 0.74, "min": 2.63, "cnt": 128}, "fwd-misc":{"total": 22.13, "avg": 0.17, "max": 0.12, "min": 0.55, "cnt": 128}, "fwd-MLP":{"total": 1688.90, "avg": 13.19, "max": 9.37, "min": 125.90, "cnt": 128}, "MoE_L0_fwd":{"total": 582.67, "avg": 18.21, "max": 11.86, "min": 125.83, "cnt": 32}, "MoEMLP":{"total": 1671.10, "avg": 13.06, "max": 9.25, "min": 125.78, "cnt": 128}, "MoE_L1_fwd":{"total": 373.08, "avg": 11.66, "max": 10.81, "min": 14.92, "cnt": 32}, "MoE_L2_fwd":{"total": 313.44, "avg": 9.79, "max": 9.30, "min": 10.41, "cnt": 32}, "MoE_L3_fwd":{"total": 408.34, "avg": 12.76, "max": 12.27, "min": 15.60, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 4.16, "avg": 2.08, "max": 0.94, "min": 3.23, "cnt": 2}, "forward-send-backward-recv":{"total": 320.62, "avg": 10.69, "max": 1.35, "min": 122.44, "cnt": 30}, "backward-compute":{"total": 1647.81, "avg": 51.49, "max": 49.78, "min": 52.75, "cnt": 32}, "MoE_L3_bwd":{"total": 442.28, "avg": 13.82, "max": 13.06, "min": 14.65, "cnt": 32}, "MoE_L2_bwd":{"total": 300.57, "avg": 9.39, "max": 8.68, "min": 10.35, "cnt": 32}, "MoE_L1_bwd":{"total": 316.65, "avg": 9.90, "max": 9.41, "min": 10.28, "cnt": 32}, "MoE_L0_bwd":{"total": 375.44, "avg": 11.73, "max": 11.25, "min": 12.07, "cnt": 32}, "backward-send-forward-recv":{"total": 6013.43, "avg": 207.36, "max": 1.96, "min": 1613.47, "cnt": 29}, "backward-send":{"total": 3.25, "avg": 1.08, "max": 1.04, "min": 1.13, "cnt": 3}, "backward-recv":{"total": 148.15, "avg": 74.08, "max": 68.15, "min": 80.00, "cnt": 2}, "backward-params-all-reduce":{"total": 484.64, "avg": 484.64, "max": 484.64, "min": 484.64, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.04, "avg": 0.04, "max": 0.04, "min": 0.04, "cnt": 1}, "optimizer":{"total": 246.66, "avg": 246.66, "max": 246.66, "min": 246.66, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 206.44, "avg": 206.44, "max": 206.44, "min": 206.44, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.63, "avg": 3.63, "max": 3.63, "min": 3.63, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 78, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 78.40, "avg": 26.13, "max": 1.36, "min": 73.47, "cnt": 3}, "forward-compute":{"total": 1853.19, "avg": 57.91, "max": 50.70, "min": 64.48, "cnt": 32}, "fwd-compute":{"total": 1849.93, "avg": 57.81, "max": 50.63, "min": 64.31, "cnt": 32}, "batch-generator":{"total": 42.73, "avg": 1.34, "max": 0.68, "min": 2.71, "cnt": 32}, "fwd-embedding":{"total": 0.69, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1793.63, "avg": 56.05, "max": 49.61, "min": 61.90, "cnt": 32}, "fwd-layernorm":{"total": 10.14, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 110.47, "avg": 0.86, "max": 0.74, "min": 2.47, "cnt": 128}, "fwd-misc":{"total": 21.97, "avg": 0.17, "max": 0.11, "min": 0.44, "cnt": 128}, "fwd-MLP":{"total": 1629.18, "avg": 12.73, "max": 9.76, "min": 22.18, "cnt": 128}, "MoE_L0_fwd":{"total": 508.59, "avg": 15.89, "max": 11.25, "min": 22.09, "cnt": 32}, "MoEMLP":{"total": 1611.91, "avg": 12.59, "max": 9.63, "min": 22.04, "cnt": 128}, "MoE_L1_fwd":{"total": 374.44, "avg": 11.70, "max": 10.81, "min": 12.66, "cnt": 32}, "MoE_L2_fwd":{"total": 325.46, "avg": 10.17, "max": 9.68, "min": 11.02, "cnt": 32}, "MoE_L3_fwd":{"total": 409.78, "avg": 12.81, "max": 12.20, "min": 17.25, "cnt": 32}, "fwd-pooler":{"total": 0.36, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.04, "cnt": 32}, "forward-send":{"total": 6.95, "avg": 3.48, "max": 0.92, "min": 6.03, "cnt": 2}, "forward-send-backward-recv":{"total": 190.74, "avg": 6.36, "max": 1.50, "min": 118.91, "cnt": 30}, "backward-compute":{"total": 1665.31, "avg": 52.04, "max": 50.27, "min": 54.08, "cnt": 32}, "MoE_L3_bwd":{"total": 446.32, "avg": 13.95, "max": 13.18, "min": 15.61, "cnt": 32}, "MoE_L2_bwd":{"total": 313.65, "avg": 9.80, "max": 9.06, "min": 11.27, "cnt": 32}, "MoE_L1_bwd":{"total": 316.15, "avg": 9.88, "max": 9.24, "min": 10.92, "cnt": 32}, "MoE_L0_bwd":{"total": 372.44, "avg": 11.64, "max": 10.86, "min": 12.17, "cnt": 32}, "backward-send-forward-recv":{"total": 4115.78, "avg": 141.92, "max": 1.36, "min": 786.66, "cnt": 29}, "backward-send":{"total": 1.89, "avg": 0.63, "max": 0.55, "min": 0.75, "cnt": 3}, "backward-recv":{"total": 147.36, "avg": 73.68, "max": 68.93, "min": 78.43, "cnt": 2}, "backward-params-all-reduce":{"total": 487.52, "avg": 487.52, "max": 487.52, "min": 487.52, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 240.19, "avg": 240.19, "max": 240.19, "min": 240.19, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 200.30, "avg": 200.30, "max": 200.30, "min": 200.30, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.47, "avg": 3.47, "max": 3.47, "min": 3.47, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 79, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 82.99, "avg": 27.66, "max": 1.30, "min": 71.39, "cnt": 3}, "forward-compute":{"total": 1855.55, "avg": 57.99, "max": 50.85, "min": 64.13, "cnt": 32}, "fwd-compute":{"total": 1852.45, "avg": 57.89, "max": 50.77, "min": 64.04, "cnt": 32}, "batch-generator":{"total": 44.52, "avg": 1.39, "max": 0.69, "min": 3.77, "cnt": 32}, "fwd-embedding":{"total": 0.64, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1795.29, "avg": 56.10, "max": 49.78, "min": 62.51, "cnt": 32}, "fwd-layernorm":{"total": 9.65, "avg": 0.08, "max": 0.05, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 107.22, "avg": 0.84, "max": 0.74, "min": 1.49, "cnt": 128}, "fwd-misc":{"total": 20.69, "avg": 0.16, "max": 0.11, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1636.88, "avg": 12.79, "max": 9.83, "min": 20.24, "cnt": 128}, "MoE_L0_fwd":{"total": 488.29, "avg": 15.26, "max": 11.45, "min": 20.15, "cnt": 32}, "MoEMLP":{"total": 1620.23, "avg": 12.66, "max": 9.71, "min": 20.11, "cnt": 128}, "MoE_L1_fwd":{"total": 382.88, "avg": 11.96, "max": 10.71, "min": 13.67, "cnt": 32}, "MoE_L2_fwd":{"total": 339.24, "avg": 10.60, "max": 9.76, "min": 14.22, "cnt": 32}, "MoE_L3_fwd":{"total": 415.90, "avg": 13.00, "max": 12.23, "min": 15.55, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.64, "avg": 0.82, "max": 0.72, "min": 0.92, "cnt": 2}, "forward-send-backward-recv":{"total": 216.22, "avg": 7.21, "max": 1.71, "min": 127.73, "cnt": 30}, "backward-compute":{"total": 1685.65, "avg": 52.68, "max": 50.96, "min": 55.18, "cnt": 32}, "MoE_L3_bwd":{"total": 455.43, "avg": 14.23, "max": 13.46, "min": 15.87, "cnt": 32}, "MoE_L2_bwd":{"total": 319.43, "avg": 9.98, "max": 9.19, "min": 12.23, "cnt": 32}, "MoE_L1_bwd":{"total": 324.36, "avg": 10.14, "max": 9.62, "min": 11.89, "cnt": 32}, "MoE_L0_bwd":{"total": 371.90, "avg": 11.62, "max": 10.99, "min": 12.48, "cnt": 32}, "backward-send-forward-recv":{"total": 4854.47, "avg": 167.40, "max": 2.44, "min": 740.70, "cnt": 29}, "backward-send":{"total": 3.32, "avg": 1.11, "max": 1.09, "min": 1.14, "cnt": 3}, "backward-recv":{"total": 136.83, "avg": 68.41, "max": 64.32, "min": 72.51, "cnt": 2}, "backward-params-all-reduce":{"total": 487.92, "avg": 487.92, "max": 487.92, "min": 487.92, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 245.04, "avg": 245.04, "max": 245.04, "min": 245.04, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 205.16, "avg": 205.16, "max": 205.16, "min": 205.16, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.47, "avg": 3.47, "max": 3.47, "min": 3.47, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 80, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 80.03, "avg": 26.68, "max": 0.70, "min": 78.01, "cnt": 3}, "forward-compute":{"total": 1817.15, "avg": 56.79, "max": 51.00, "min": 62.14, "cnt": 32}, "fwd-compute":{"total": 1813.94, "avg": 56.69, "max": 50.93, "min": 62.05, "cnt": 32}, "batch-generator":{"total": 49.12, "avg": 1.54, "max": 0.63, "min": 3.32, "cnt": 32}, "fwd-embedding":{"total": 0.58, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1752.24, "avg": 54.76, "max": 49.93, "min": 60.38, "cnt": 32}, "fwd-layernorm":{"total": 9.58, "avg": 0.07, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 105.97, "avg": 0.83, "max": 0.74, "min": 1.53, "cnt": 128}, "fwd-misc":{"total": 20.24, "avg": 0.16, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1596.01, "avg": 12.47, "max": 9.88, "min": 18.76, "cnt": 128}, "MoE_L0_fwd":{"total": 465.99, "avg": 14.56, "max": 11.59, "min": 18.65, "cnt": 32}, "MoEMLP":{"total": 1579.31, "avg": 12.34, "max": 9.76, "min": 18.59, "cnt": 128}, "MoE_L1_fwd":{"total": 382.61, "avg": 11.96, "max": 10.85, "min": 16.29, "cnt": 32}, "MoE_L2_fwd":{"total": 334.28, "avg": 10.45, "max": 9.80, "min": 11.23, "cnt": 32}, "MoE_L3_fwd":{"total": 402.40, "avg": 12.57, "max": 12.05, "min": 13.49, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.56, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 10.58, "avg": 5.29, "max": 0.98, "min": 9.60, "cnt": 2}, "forward-send-backward-recv":{"total": 354.62, "avg": 11.82, "max": 1.64, "min": 118.27, "cnt": 30}, "backward-compute":{"total": 1712.02, "avg": 53.50, "max": 51.88, "min": 55.50, "cnt": 32}, "MoE_L3_bwd":{"total": 459.77, "avg": 14.37, "max": 13.54, "min": 15.93, "cnt": 32}, "MoE_L2_bwd":{"total": 326.34, "avg": 10.20, "max": 9.69, "min": 11.23, "cnt": 32}, "MoE_L1_bwd":{"total": 331.82, "avg": 10.37, "max": 9.83, "min": 11.93, "cnt": 32}, "MoE_L0_bwd":{"total": 379.17, "avg": 11.85, "max": 11.34, "min": 12.49, "cnt": 32}, "backward-send-forward-recv":{"total": 3112.08, "avg": 107.31, "max": 2.10, "min": 477.14, "cnt": 29}, "backward-send":{"total": 2.68, "avg": 0.89, "max": 0.81, "min": 0.96, "cnt": 3}, "backward-recv":{"total": 476.90, "avg": 238.45, "max": 67.90, "min": 409.00, "cnt": 2}, "backward-params-all-reduce":{"total": 487.51, "avg": 487.51, "max": 487.51, "min": 487.51, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 235.43, "avg": 235.43, "max": 235.43, "min": 235.43, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 195.66, "avg": 195.66, "max": 195.66, "min": 195.66, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.35, "avg": 3.35, "max": 3.35, "min": 3.35, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 81, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 93.11, "avg": 31.04, "max": 5.32, "min": 81.19, "cnt": 3}, "forward-compute":{"total": 1872.62, "avg": 58.52, "max": 51.13, "min": 65.99, "cnt": 32}, "fwd-compute":{"total": 1869.36, "avg": 58.42, "max": 51.06, "min": 65.88, "cnt": 32}, "batch-generator":{"total": 41.79, "avg": 1.31, "max": 0.68, "min": 2.25, "cnt": 32}, "fwd-embedding":{"total": 0.69, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1814.81, "avg": 56.71, "max": 50.10, "min": 64.22, "cnt": 32}, "fwd-layernorm":{"total": 10.36, "avg": 0.08, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 111.61, "avg": 0.87, "max": 0.74, "min": 1.70, "cnt": 128}, "fwd-misc":{"total": 21.95, "avg": 0.17, "max": 0.11, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1648.74, "avg": 12.88, "max": 10.26, "min": 20.50, "cnt": 128}, "MoE_L0_fwd":{"total": 490.60, "avg": 15.33, "max": 11.73, "min": 20.41, "cnt": 32}, "MoEMLP":{"total": 1631.02, "avg": 12.74, "max": 10.14, "min": 20.36, "cnt": 128}, "MoE_L1_fwd":{"total": 381.71, "avg": 11.93, "max": 11.17, "min": 13.82, "cnt": 32}, "MoE_L2_fwd":{"total": 352.57, "avg": 11.02, "max": 10.19, "min": 15.27, "cnt": 32}, "MoE_L3_fwd":{"total": 412.63, "avg": 12.89, "max": 11.90, "min": 18.05, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 2.53, "avg": 1.27, "max": 1.02, "min": 1.51, "cnt": 2}, "forward-send-backward-recv":{"total": 245.08, "avg": 8.17, "max": 1.35, "min": 113.76, "cnt": 30}, "backward-compute":{"total": 1741.65, "avg": 54.43, "max": 52.19, "min": 57.03, "cnt": 32}, "MoE_L3_bwd":{"total": 457.96, "avg": 14.31, "max": 13.09, "min": 15.40, "cnt": 32}, "MoE_L2_bwd":{"total": 349.75, "avg": 10.93, "max": 9.48, "min": 13.71, "cnt": 32}, "MoE_L1_bwd":{"total": 343.89, "avg": 10.75, "max": 10.27, "min": 11.33, "cnt": 32}, "MoE_L0_bwd":{"total": 378.93, "avg": 11.84, "max": 11.28, "min": 12.34, "cnt": 32}, "backward-send-forward-recv":{"total": 4776.96, "avg": 164.72, "max": 2.14, "min": 853.16, "cnt": 29}, "backward-send":{"total": 3.27, "avg": 1.09, "max": 0.98, "min": 1.16, "cnt": 3}, "backward-recv":{"total": 132.81, "avg": 66.41, "max": 64.70, "min": 68.11, "cnt": 2}, "backward-params-all-reduce":{"total": 488.76, "avg": 488.76, "max": 488.76, "min": 488.76, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 239.35, "avg": 239.35, "max": 239.35, "min": 239.35, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 199.46, "avg": 199.46, "max": 199.46, "min": 199.46, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 82, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 91.68, "avg": 30.56, "max": 1.77, "min": 81.09, "cnt": 3}, "forward-compute":{"total": 1863.57, "avg": 58.24, "max": 51.45, "min": 65.92, "cnt": 32}, "fwd-compute":{"total": 1860.20, "avg": 58.13, "max": 51.38, "min": 65.75, "cnt": 32}, "batch-generator":{"total": 48.27, "avg": 1.51, "max": 0.65, "min": 4.30, "cnt": 32}, "fwd-embedding":{"total": 0.75, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1798.80, "avg": 56.21, "max": 50.41, "min": 63.40, "cnt": 32}, "fwd-layernorm":{"total": 10.81, "avg": 0.08, "max": 0.06, "min": 0.22, "cnt": 128}, "fwd-attn":{"total": 114.62, "avg": 0.90, "max": 0.74, "min": 2.16, "cnt": 128}, "fwd-misc":{"total": 22.81, "avg": 0.18, "max": 0.12, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1627.29, "avg": 12.71, "max": 10.51, "min": 19.32, "cnt": 128}, "MoE_L0_fwd":{"total": 477.90, "avg": 14.93, "max": 11.61, "min": 19.24, "cnt": 32}, "MoEMLP":{"total": 1608.87, "avg": 12.57, "max": 10.40, "min": 19.19, "cnt": 128}, "MoE_L1_fwd":{"total": 372.55, "avg": 11.64, "max": 10.84, "min": 13.56, "cnt": 32}, "MoE_L2_fwd":{"total": 355.10, "avg": 11.10, "max": 10.44, "min": 15.96, "cnt": 32}, "MoE_L3_fwd":{"total": 410.07, "avg": 12.81, "max": 12.13, "min": 15.71, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 3.37, "avg": 1.68, "max": 0.94, "min": 2.43, "cnt": 2}, "forward-send-backward-recv":{"total": 544.27, "avg": 18.14, "max": 1.52, "min": 125.39, "cnt": 30}, "backward-compute":{"total": 1723.07, "avg": 53.85, "max": 52.63, "min": 55.85, "cnt": 32}, "MoE_L3_bwd":{"total": 453.37, "avg": 14.17, "max": 12.98, "min": 15.64, "cnt": 32}, "MoE_L2_bwd":{"total": 345.53, "avg": 10.80, "max": 10.03, "min": 11.99, "cnt": 32}, "MoE_L1_bwd":{"total": 331.90, "avg": 10.37, "max": 9.80, "min": 12.67, "cnt": 32}, "MoE_L0_bwd":{"total": 379.45, "avg": 11.86, "max": 11.03, "min": 13.91, "cnt": 32}, "backward-send-forward-recv":{"total": 2486.64, "avg": 85.75, "max": 2.41, "min": 479.14, "cnt": 29}, "backward-send":{"total": 2.57, "avg": 0.86, "max": 0.47, "min": 1.08, "cnt": 3}, "backward-recv":{"total": 142.02, "avg": 71.01, "max": 69.89, "min": 72.14, "cnt": 2}, "backward-params-all-reduce":{"total": 490.95, "avg": 490.95, "max": 490.95, "min": 490.95, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 241.43, "avg": 241.43, "max": 241.43, "min": 241.43, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.36, "avg": 3.36, "max": 3.36, "min": 3.36, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 201.57, "avg": 201.57, "max": 201.57, "min": 201.57, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.48, "avg": 3.48, "max": 3.48, "min": 3.48, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}}}
{"type":"time", "iteration": 83, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 69.86, "avg": 23.29, "max": 1.42, "min": 66.99, "cnt": 3}, "forward-compute":{"total": 1872.11, "avg": 58.50, "max": 51.68, "min": 66.44, "cnt": 32}, "fwd-compute":{"total": 1868.80, "avg": 58.40, "max": 51.61, "min": 66.30, "cnt": 32}, "batch-generator":{"total": 40.74, "avg": 1.27, "max": 0.71, "min": 2.11, "cnt": 32}, "fwd-embedding":{"total": 0.67, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1814.95, "avg": 56.72, "max": 50.59, "min": 64.27, "cnt": 32}, "fwd-layernorm":{"total": 10.08, "avg": 0.08, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 109.05, "avg": 0.85, "max": 0.74, "min": 1.55, "cnt": 128}, "fwd-misc":{"total": 21.33, "avg": 0.17, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1652.87, "avg": 12.91, "max": 10.57, "min": 24.21, "cnt": 128}, "MoE_L0_fwd":{"total": 495.08, "avg": 15.47, "max": 11.47, "min": 24.12, "cnt": 32}, "MoEMLP":{"total": 1635.85, "avg": 12.78, "max": 10.45, "min": 24.06, "cnt": 128}, "MoE_L1_fwd":{"total": 381.83, "avg": 11.93, "max": 10.92, "min": 16.25, "cnt": 32}, "MoE_L2_fwd":{"total": 361.90, "avg": 11.31, "max": 10.49, "min": 14.53, "cnt": 32}, "MoE_L3_fwd":{"total": 403.37, "avg": 12.61, "max": 12.14, "min": 13.79, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.83, "avg": 0.92, "max": 0.92, "min": 0.92, "cnt": 2}, "forward-send-backward-recv":{"total": 224.89, "avg": 7.50, "max": 1.10, "min": 115.11, "cnt": 30}, "backward-compute":{"total": 1742.13, "avg": 54.44, "max": 53.35, "min": 57.81, "cnt": 32}, "MoE_L3_bwd":{"total": 458.90, "avg": 14.34, "max": 13.58, "min": 16.64, "cnt": 32}, "MoE_L2_bwd":{"total": 355.20, "avg": 11.10, "max": 10.37, "min": 12.89, "cnt": 32}, "MoE_L1_bwd":{"total": 334.81, "avg": 10.46, "max": 9.98, "min": 12.31, "cnt": 32}, "MoE_L0_bwd":{"total": 380.95, "avg": 11.90, "max": 11.21, "min": 13.25, "cnt": 32}, "backward-send-forward-recv":{"total": 2869.12, "avg": 98.94, "max": 2.35, "min": 332.02, "cnt": 29}, "backward-send":{"total": 2.73, "avg": 0.91, "max": 0.54, "min": 1.17, "cnt": 3}, "backward-recv":{"total": 162.97, "avg": 81.48, "max": 72.96, "min": 90.00, "cnt": 2}, "backward-params-all-reduce":{"total": 486.15, "avg": 486.15, "max": 486.15, "min": 486.15, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 239.06, "avg": 239.06, "max": 239.06, "min": 239.06, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 199.31, "avg": 199.31, "max": 199.31, "min": 199.31, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.30, "avg": 3.30, "max": 3.30, "min": 3.30, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 84, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 85.11, "avg": 28.37, "max": 0.89, "min": 78.27, "cnt": 3}, "forward-compute":{"total": 1878.25, "avg": 58.70, "max": 52.26, "min": 63.76, "cnt": 32}, "fwd-compute":{"total": 1874.92, "avg": 58.59, "max": 52.17, "min": 63.68, "cnt": 32}, "batch-generator":{"total": 42.33, "avg": 1.32, "max": 0.67, "min": 2.70, "cnt": 32}, "fwd-embedding":{"total": 0.64, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1819.78, "avg": 56.87, "max": 50.91, "min": 62.54, "cnt": 32}, "fwd-layernorm":{"total": 10.11, "avg": 0.08, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 110.64, "avg": 0.86, "max": 0.74, "min": 2.44, "cnt": 128}, "fwd-misc":{"total": 22.03, "avg": 0.17, "max": 0.12, "min": 0.38, "cnt": 128}, "fwd-MLP":{"total": 1654.86, "avg": 12.93, "max": 10.89, "min": 19.10, "cnt": 128}, "MoE_L0_fwd":{"total": 484.39, "avg": 15.14, "max": 11.66, "min": 18.95, "cnt": 32}, "MoEMLP":{"total": 1637.31, "avg": 12.79, "max": 10.78, "min": 18.90, "cnt": 128}, "MoE_L1_fwd":{"total": 400.09, "avg": 12.50, "max": 11.14, "min": 16.38, "cnt": 32}, "MoE_L2_fwd":{"total": 371.72, "avg": 11.62, "max": 10.82, "min": 12.31, "cnt": 32}, "MoE_L3_fwd":{"total": 387.47, "avg": 12.11, "max": 11.59, "min": 12.78, "cnt": 32}, "fwd-pooler":{"total": 0.36, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.77, "avg": 0.89, "max": 0.79, "min": 0.98, "cnt": 2}, "forward-send-backward-recv":{"total": 231.53, "avg": 7.72, "max": 1.82, "min": 122.71, "cnt": 30}, "backward-compute":{"total": 1751.32, "avg": 54.73, "max": 53.00, "min": 57.72, "cnt": 32}, "MoE_L3_bwd":{"total": 443.55, "avg": 13.86, "max": 12.54, "min": 15.18, "cnt": 32}, "MoE_L2_bwd":{"total": 380.54, "avg": 11.89, "max": 10.81, "min": 14.75, "cnt": 32}, "MoE_L1_bwd":{"total": 337.72, "avg": 10.55, "max": 10.19, "min": 10.99, "cnt": 32}, "MoE_L0_bwd":{"total": 374.48, "avg": 11.70, "max": 10.78, "min": 12.67, "cnt": 32}, "backward-send-forward-recv":{"total": 3721.33, "avg": 128.32, "max": 2.26, "min": 382.87, "cnt": 29}, "backward-send":{"total": 3.14, "avg": 1.05, "max": 1.01, "min": 1.10, "cnt": 3}, "backward-recv":{"total": 381.67, "avg": 190.83, "max": 67.51, "min": 314.16, "cnt": 2}, "backward-params-all-reduce":{"total": 487.45, "avg": 487.45, "max": 487.45, "min": 487.45, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 244.67, "avg": 244.67, "max": 244.67, "min": 244.67, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.36, "avg": 3.36, "max": 3.36, "min": 3.36, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 204.66, "avg": 204.66, "max": 204.66, "min": 204.66, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.59, "avg": 3.59, "max": 3.59, "min": 3.59, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 85, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 76.37, "avg": 25.46, "max": 1.30, "min": 73.75, "cnt": 3}, "forward-compute":{"total": 1847.06, "avg": 57.72, "max": 51.60, "min": 66.01, "cnt": 32}, "fwd-compute":{"total": 1844.01, "avg": 57.63, "max": 51.53, "min": 65.93, "cnt": 32}, "batch-generator":{"total": 41.08, "avg": 1.28, "max": 0.65, "min": 2.86, "cnt": 32}, "fwd-embedding":{"total": 0.58, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1790.61, "avg": 55.96, "max": 50.60, "min": 63.94, "cnt": 32}, "fwd-layernorm":{"total": 9.57, "avg": 0.07, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 109.42, "avg": 0.85, "max": 0.74, "min": 2.40, "cnt": 128}, "fwd-misc":{"total": 20.65, "avg": 0.16, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1629.87, "avg": 12.73, "max": 10.94, "min": 18.68, "cnt": 128}, "MoE_L0_fwd":{"total": 482.19, "avg": 15.07, "max": 11.35, "min": 18.60, "cnt": 32}, "MoEMLP":{"total": 1613.24, "avg": 12.60, "max": 10.82, "min": 18.55, "cnt": 128}, "MoE_L1_fwd":{"total": 384.88, "avg": 12.03, "max": 11.10, "min": 16.41, "cnt": 32}, "MoE_L2_fwd":{"total": 368.82, "avg": 11.53, "max": 10.87, "min": 13.10, "cnt": 32}, "MoE_L3_fwd":{"total": 383.48, "avg": 11.98, "max": 11.32, "min": 14.17, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 9.70, "avg": 4.85, "max": 0.91, "min": 8.79, "cnt": 2}, "forward-send-backward-recv":{"total": 192.31, "avg": 6.41, "max": 1.34, "min": 116.85, "cnt": 30}, "backward-compute":{"total": 1755.61, "avg": 54.86, "max": 51.98, "min": 57.38, "cnt": 32}, "MoE_L3_bwd":{"total": 438.20, "avg": 13.69, "max": 13.13, "min": 14.45, "cnt": 32}, "MoE_L2_bwd":{"total": 377.11, "avg": 11.78, "max": 11.18, "min": 12.37, "cnt": 32}, "MoE_L1_bwd":{"total": 349.14, "avg": 10.91, "max": 10.03, "min": 13.45, "cnt": 32}, "MoE_L0_bwd":{"total": 377.94, "avg": 11.81, "max": 10.84, "min": 14.63, "cnt": 32}, "backward-send-forward-recv":{"total": 3621.47, "avg": 124.88, "max": 2.29, "min": 387.06, "cnt": 29}, "backward-send":{"total": 2.06, "avg": 0.69, "max": 0.55, "min": 0.86, "cnt": 3}, "backward-recv":{"total": 215.60, "avg": 107.80, "max": 71.39, "min": 144.20, "cnt": 2}, "backward-params-all-reduce":{"total": 486.23, "avg": 486.23, "max": 486.23, "min": 486.23, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 241.28, "avg": 241.28, "max": 241.28, "min": 241.28, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 201.59, "avg": 201.59, "max": 201.59, "min": 201.59, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.33, "avg": 3.33, "max": 3.33, "min": 3.33, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 86, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 93.24, "avg": 31.08, "max": 3.05, "min": 79.77, "cnt": 3}, "forward-compute":{"total": 1862.17, "avg": 58.19, "max": 51.06, "min": 63.38, "cnt": 32}, "fwd-compute":{"total": 1858.97, "avg": 58.09, "max": 50.99, "min": 63.24, "cnt": 32}, "batch-generator":{"total": 43.86, "avg": 1.37, "max": 0.68, "min": 3.63, "cnt": 32}, "fwd-embedding":{"total": 0.66, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1802.53, "avg": 56.33, "max": 49.88, "min": 62.01, "cnt": 32}, "fwd-layernorm":{"total": 10.00, "avg": 0.08, "max": 0.05, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 109.44, "avg": 0.85, "max": 0.74, "min": 1.62, "cnt": 128}, "fwd-misc":{"total": 21.61, "avg": 0.17, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1639.70, "avg": 12.81, "max": 11.04, "min": 21.91, "cnt": 128}, "MoE_L0_fwd":{"total": 487.66, "avg": 15.24, "max": 11.36, "min": 21.84, "cnt": 32}, "MoEMLP":{"total": 1622.51, "avg": 12.68, "max": 10.94, "min": 21.79, "cnt": 128}, "MoE_L1_fwd":{"total": 383.59, "avg": 11.99, "max": 11.16, "min": 14.61, "cnt": 32}, "MoE_L2_fwd":{"total": 374.38, "avg": 11.70, "max": 10.98, "min": 12.59, "cnt": 32}, "MoE_L3_fwd":{"total": 383.11, "avg": 11.97, "max": 11.50, "min": 12.79, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 2.45, "avg": 1.23, "max": 0.97, "min": 1.48, "cnt": 2}, "forward-send-backward-recv":{"total": 455.94, "avg": 15.20, "max": 1.72, "min": 111.85, "cnt": 30}, "backward-compute":{"total": 1771.48, "avg": 55.36, "max": 52.36, "min": 59.09, "cnt": 32}, "MoE_L3_bwd":{"total": 444.90, "avg": 13.90, "max": 12.57, "min": 15.69, "cnt": 32}, "MoE_L2_bwd":{"total": 390.19, "avg": 12.19, "max": 11.28, "min": 13.85, "cnt": 32}, "MoE_L1_bwd":{"total": 336.52, "avg": 10.52, "max": 9.87, "min": 11.64, "cnt": 32}, "MoE_L0_bwd":{"total": 385.20, "avg": 12.04, "max": 11.32, "min": 16.02, "cnt": 32}, "backward-send-forward-recv":{"total": 5030.78, "avg": 173.48, "max": 2.20, "min": 770.92, "cnt": 29}, "backward-send":{"total": 2.85, "avg": 0.95, "max": 0.81, "min": 1.05, "cnt": 3}, "backward-recv":{"total": 285.85, "avg": 142.93, "max": 60.72, "min": 225.13, "cnt": 2}, "backward-params-all-reduce":{"total": 486.71, "avg": 486.71, "max": 486.71, "min": 486.71, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 245.99, "avg": 245.99, "max": 245.99, "min": 245.99, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 205.85, "avg": 205.85, "max": 205.85, "min": 205.85, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.67, "avg": 3.67, "max": 3.67, "min": 3.67, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}}}
{"type":"time", "iteration": 87, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 81.57, "avg": 27.19, "max": 1.47, "min": 72.87, "cnt": 3}, "forward-compute":{"total": 1938.85, "avg": 60.59, "max": 52.59, "min": 109.22, "cnt": 32}, "fwd-compute":{"total": 1935.70, "avg": 60.49, "max": 52.50, "min": 109.11, "cnt": 32}, "batch-generator":{"total": 76.14, "avg": 2.38, "max": 0.67, "min": 38.17, "cnt": 32}, "fwd-embedding":{"total": 0.64, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1847.22, "avg": 57.73, "max": 51.41, "min": 70.50, "cnt": 32}, "fwd-layernorm":{"total": 10.14, "avg": 0.08, "max": 0.06, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 111.55, "avg": 0.87, "max": 0.74, "min": 2.17, "cnt": 128}, "fwd-misc":{"total": 21.71, "avg": 0.17, "max": 0.11, "min": 0.38, "cnt": 128}, "fwd-MLP":{"total": 1682.06, "avg": 13.14, "max": 10.78, "min": 28.95, "cnt": 128}, "MoE_L0_fwd":{"total": 511.62, "avg": 15.99, "max": 11.80, "min": 28.86, "cnt": 32}, "MoEMLP":{"total": 1664.52, "avg": 13.00, "max": 10.67, "min": 28.80, "cnt": 128}, "MoE_L1_fwd":{"total": 380.09, "avg": 11.88, "max": 10.71, "min": 13.78, "cnt": 32}, "MoE_L2_fwd":{"total": 385.08, "avg": 12.03, "max": 11.30, "min": 13.25, "cnt": 32}, "MoE_L3_fwd":{"total": 394.14, "avg": 12.32, "max": 11.49, "min": 13.94, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.90, "avg": 0.95, "max": 0.89, "min": 1.00, "cnt": 2}, "forward-send-backward-recv":{"total": 623.99, "avg": 20.80, "max": 1.68, "min": 180.57, "cnt": 30}, "backward-compute":{"total": 1822.76, "avg": 56.96, "max": 55.68, "min": 60.12, "cnt": 32}, "MoE_L3_bwd":{"total": 444.55, "avg": 13.89, "max": 12.68, "min": 17.03, "cnt": 32}, "MoE_L2_bwd":{"total": 410.24, "avg": 12.82, "max": 12.11, "min": 13.54, "cnt": 32}, "MoE_L1_bwd":{"total": 345.16, "avg": 10.79, "max": 10.35, "min": 11.49, "cnt": 32}, "MoE_L0_bwd":{"total": 408.83, "avg": 12.78, "max": 12.19, "min": 13.10, "cnt": 32}, "backward-send-forward-recv":{"total": 4057.97, "avg": 139.93, "max": 2.11, "min": 561.23, "cnt": 29}, "backward-send":{"total": 2.96, "avg": 0.99, "max": 0.91, "min": 1.05, "cnt": 3}, "backward-recv":{"total": 750.15, "avg": 375.08, "max": 75.27, "min": 674.88, "cnt": 2}, "backward-params-all-reduce":{"total": 484.63, "avg": 484.63, "max": 484.63, "min": 484.63, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 247.23, "avg": 247.23, "max": 247.23, "min": 247.23, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 202.86, "avg": 202.86, "max": 202.86, "min": 202.86, "cnt": 1}, "optimizer-clip-main-grad":{"total": 7.05, "avg": 7.05, "max": 7.05, "min": 7.05, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 88, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 73.37, "avg": 24.46, "max": 1.13, "min": 71.06, "cnt": 3}, "forward-compute":{"total": 1917.26, "avg": 59.91, "max": 53.08, "min": 68.27, "cnt": 32}, "fwd-compute":{"total": 1914.04, "avg": 59.81, "max": 53.01, "min": 68.13, "cnt": 32}, "batch-generator":{"total": 44.88, "avg": 1.40, "max": 0.65, "min": 2.35, "cnt": 32}, "fwd-embedding":{"total": 0.65, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1856.81, "avg": 58.03, "max": 52.05, "min": 66.08, "cnt": 32}, "fwd-layernorm":{"total": 9.89, "avg": 0.08, "max": 0.05, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 108.58, "avg": 0.85, "max": 0.74, "min": 1.55, "cnt": 128}, "fwd-misc":{"total": 21.75, "avg": 0.17, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1695.17, "avg": 13.24, "max": 10.98, "min": 20.18, "cnt": 128}, "MoE_L0_fwd":{"total": 500.27, "avg": 15.63, "max": 12.65, "min": 20.10, "cnt": 32}, "MoEMLP":{"total": 1677.75, "avg": 13.11, "max": 10.86, "min": 20.05, "cnt": 128}, "MoE_L1_fwd":{"total": 377.88, "avg": 11.81, "max": 10.91, "min": 13.12, "cnt": 32}, "MoE_L2_fwd":{"total": 389.09, "avg": 12.16, "max": 11.06, "min": 14.94, "cnt": 32}, "MoE_L3_fwd":{"total": 416.87, "avg": 13.03, "max": 11.75, "min": 19.51, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 4.83, "avg": 2.42, "max": 1.02, "min": 3.82, "cnt": 2}, "forward-send-backward-recv":{"total": 863.11, "avg": 28.77, "max": 1.70, "min": 179.84, "cnt": 30}, "backward-compute":{"total": 1830.46, "avg": 57.20, "max": 55.20, "min": 59.65, "cnt": 32}, "MoE_L3_bwd":{"total": 441.62, "avg": 13.80, "max": 12.52, "min": 14.99, "cnt": 32}, "MoE_L2_bwd":{"total": 402.78, "avg": 12.59, "max": 11.92, "min": 13.36, "cnt": 32}, "MoE_L1_bwd":{"total": 325.36, "avg": 10.17, "max": 9.77, "min": 11.33, "cnt": 32}, "MoE_L0_bwd":{"total": 446.57, "avg": 13.96, "max": 13.11, "min": 15.98, "cnt": 32}, "backward-send-forward-recv":{"total": 2605.75, "avg": 89.85, "max": 1.16, "min": 575.64, "cnt": 29}, "backward-send":{"total": 2.71, "avg": 0.90, "max": 0.87, "min": 0.95, "cnt": 3}, "backward-recv":{"total": 198.73, "avg": 99.36, "max": 64.09, "min": 134.64, "cnt": 2}, "backward-params-all-reduce":{"total": 492.67, "avg": 492.67, "max": 492.67, "min": 492.67, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 253.54, "avg": 253.54, "max": 253.54, "min": 253.54, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 213.66, "avg": 213.66, "max": 213.66, "min": 213.66, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.30, "avg": 3.30, "max": 3.30, "min": 3.30, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.50, "avg": 3.50, "max": 3.50, "min": 3.50, "cnt": 1}}}
{"type":"time", "iteration": 89, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 209.28, "avg": 69.76, "max": 1.04, "min": 137.86, "cnt": 3}, "forward-compute":{"total": 1923.55, "avg": 60.11, "max": 53.79, "min": 65.77, "cnt": 32}, "fwd-compute":{"total": 1920.10, "avg": 60.00, "max": 53.71, "min": 65.69, "cnt": 32}, "batch-generator":{"total": 60.61, "avg": 1.89, "max": 0.78, "min": 3.55, "cnt": 32}, "fwd-embedding":{"total": 0.71, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1846.11, "avg": 57.69, "max": 52.55, "min": 63.23, "cnt": 32}, "fwd-layernorm":{"total": 10.34, "avg": 0.08, "max": 0.06, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 109.93, "avg": 0.86, "max": 0.74, "min": 1.54, "cnt": 128}, "fwd-misc":{"total": 21.81, "avg": 0.17, "max": 0.11, "min": 0.38, "cnt": 128}, "fwd-MLP":{"total": 1682.24, "avg": 13.14, "max": 10.57, "min": 22.72, "cnt": 128}, "MoE_L0_fwd":{"total": 522.53, "avg": 16.33, "max": 12.65, "min": 22.64, "cnt": 32}, "MoEMLP":{"total": 1664.82, "avg": 13.01, "max": 10.46, "min": 22.60, "cnt": 128}, "MoE_L1_fwd":{"total": 371.56, "avg": 11.61, "max": 10.50, "min": 13.16, "cnt": 32}, "MoE_L2_fwd":{"total": 377.43, "avg": 11.79, "max": 10.99, "min": 15.38, "cnt": 32}, "MoE_L3_fwd":{"total": 399.67, "avg": 12.49, "max": 11.94, "min": 13.92, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 5.89, "avg": 2.94, "max": 1.02, "min": 4.86, "cnt": 2}, "forward-send-backward-recv":{"total": 251.17, "avg": 8.37, "max": 1.29, "min": 151.24, "cnt": 30}, "backward-compute":{"total": 1818.79, "avg": 56.84, "max": 54.06, "min": 59.15, "cnt": 32}, "MoE_L3_bwd":{"total": 445.08, "avg": 13.91, "max": 12.84, "min": 15.09, "cnt": 32}, "MoE_L2_bwd":{"total": 393.20, "avg": 12.29, "max": 11.67, "min": 13.07, "cnt": 32}, "MoE_L1_bwd":{"total": 314.95, "avg": 9.84, "max": 9.00, "min": 10.92, "cnt": 32}, "MoE_L0_bwd":{"total": 451.64, "avg": 14.11, "max": 13.49, "min": 14.81, "cnt": 32}, "backward-send-forward-recv":{"total": 4363.46, "avg": 150.46, "max": 1.71, "min": 699.85, "cnt": 29}, "backward-send":{"total": 3.43, "avg": 1.14, "max": 1.10, "min": 1.20, "cnt": 3}, "backward-recv":{"total": 125.03, "avg": 62.51, "max": 57.11, "min": 67.92, "cnt": 2}, "backward-params-all-reduce":{"total": 488.53, "avg": 488.53, "max": 488.53, "min": 488.53, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 244.35, "avg": 244.35, "max": 244.35, "min": 244.35, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.53, "avg": 3.53, "max": 3.53, "min": 3.53, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 204.41, "avg": 204.41, "max": 204.41, "min": 204.41, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.48, "avg": 3.48, "max": 3.48, "min": 3.48, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 90, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 65.99, "avg": 22.00, "max": 1.17, "min": 63.49, "cnt": 3}, "forward-compute":{"total": 2015.74, "avg": 62.99, "max": 54.50, "min": 156.85, "cnt": 32}, "fwd-compute":{"total": 2012.47, "avg": 62.89, "max": 54.43, "min": 156.77, "cnt": 32}, "batch-generator":{"total": 47.71, "avg": 1.49, "max": 0.70, "min": 3.50, "cnt": 32}, "fwd-embedding":{"total": 0.62, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1952.45, "avg": 61.01, "max": 52.37, "min": 153.58, "cnt": 32}, "fwd-layernorm":{"total": 9.89, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 109.91, "avg": 0.86, "max": 0.74, "min": 3.25, "cnt": 128}, "fwd-misc":{"total": 21.80, "avg": 0.17, "max": 0.12, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1789.87, "avg": 13.98, "max": 10.34, "min": 108.27, "cnt": 128}, "MoE_L0_fwd":{"total": 517.62, "avg": 16.18, "max": 12.70, "min": 24.67, "cnt": 32}, "MoEMLP":{"total": 1773.07, "avg": 13.85, "max": 10.22, "min": 108.16, "cnt": 128}, "MoE_L1_fwd":{"total": 371.37, "avg": 11.61, "max": 10.27, "min": 13.65, "cnt": 32}, "MoE_L2_fwd":{"total": 384.60, "avg": 12.02, "max": 11.45, "min": 14.93, "cnt": 32}, "MoE_L3_fwd":{"total": 505.62, "avg": 15.80, "max": 12.04, "min": 108.20, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.73, "avg": 0.86, "max": 0.85, "min": 0.88, "cnt": 2}, "forward-send-backward-recv":{"total": 246.14, "avg": 8.20, "max": 1.27, "min": 185.12, "cnt": 30}, "backward-compute":{"total": 1807.90, "avg": 56.50, "max": 54.24, "min": 58.68, "cnt": 32}, "MoE_L3_bwd":{"total": 444.45, "avg": 13.89, "max": 12.65, "min": 15.55, "cnt": 32}, "MoE_L2_bwd":{"total": 395.45, "avg": 12.36, "max": 11.30, "min": 13.24, "cnt": 32}, "MoE_L1_bwd":{"total": 313.43, "avg": 9.79, "max": 8.95, "min": 12.53, "cnt": 32}, "MoE_L0_bwd":{"total": 440.60, "avg": 13.77, "max": 12.70, "min": 14.17, "cnt": 32}, "backward-send-forward-recv":{"total": 4329.96, "avg": 149.31, "max": 1.90, "min": 575.65, "cnt": 29}, "backward-send":{"total": 2.76, "avg": 0.92, "max": 0.66, "min": 1.13, "cnt": 3}, "backward-recv":{"total": 304.62, "avg": 152.31, "max": 51.27, "min": 253.36, "cnt": 2}, "backward-params-all-reduce":{"total": 486.31, "avg": 486.31, "max": 486.31, "min": 486.31, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 249.25, "avg": 249.25, "max": 249.25, "min": 249.25, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 208.59, "avg": 208.59, "max": 208.59, "min": 208.59, "cnt": 1}, "optimizer-clip-main-grad":{"total": 4.13, "avg": 4.13, "max": 4.13, "min": 4.13, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 91, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 87.35, "avg": 29.12, "max": 0.92, "min": 78.44, "cnt": 3}, "forward-compute":{"total": 1904.90, "avg": 59.53, "max": 52.85, "min": 63.17, "cnt": 32}, "fwd-compute":{"total": 1900.97, "avg": 59.41, "max": 52.78, "min": 63.07, "cnt": 32}, "batch-generator":{"total": 47.21, "avg": 1.48, "max": 0.65, "min": 2.03, "cnt": 32}, "fwd-embedding":{"total": 0.86, "avg": 0.03, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1839.87, "avg": 57.50, "max": 51.76, "min": 61.56, "cnt": 32}, "fwd-layernorm":{"total": 11.50, "avg": 0.09, "max": 0.05, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 117.26, "avg": 0.92, "max": 0.74, "min": 1.57, "cnt": 128}, "fwd-misc":{"total": 23.84, "avg": 0.19, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1663.48, "avg": 13.00, "max": 10.56, "min": 19.42, "cnt": 128}, "MoE_L0_fwd":{"total": 498.42, "avg": 15.58, "max": 12.43, "min": 19.32, "cnt": 32}, "MoEMLP":{"total": 1644.58, "avg": 12.85, "max": 10.43, "min": 19.26, "cnt": 128}, "MoE_L1_fwd":{"total": 369.56, "avg": 11.55, "max": 10.48, "min": 12.99, "cnt": 32}, "MoE_L2_fwd":{"total": 383.25, "avg": 11.98, "max": 11.02, "min": 13.79, "cnt": 32}, "MoE_L3_fwd":{"total": 400.25, "avg": 12.51, "max": 11.97, "min": 13.54, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.84, "avg": 0.92, "max": 0.84, "min": 1.00, "cnt": 2}, "forward-send-backward-recv":{"total": 2355.69, "avg": 78.52, "max": 1.78, "min": 381.26, "cnt": 30}, "backward-compute":{"total": 1812.27, "avg": 56.63, "max": 55.01, "min": 60.53, "cnt": 32}, "MoE_L3_bwd":{"total": 476.94, "avg": 14.90, "max": 13.52, "min": 18.47, "cnt": 32}, "MoE_L2_bwd":{"total": 388.55, "avg": 12.14, "max": 11.38, "min": 12.87, "cnt": 32}, "MoE_L1_bwd":{"total": 303.86, "avg": 9.50, "max": 8.97, "min": 10.59, "cnt": 32}, "MoE_L0_bwd":{"total": 428.37, "avg": 13.39, "max": 12.79, "min": 13.87, "cnt": 32}, "backward-send-forward-recv":{"total": 526.54, "avg": 18.16, "max": 1.42, "min": 253.29, "cnt": 29}, "backward-send":{"total": 2.79, "avg": 0.93, "max": 0.70, "min": 1.06, "cnt": 3}, "backward-recv":{"total": 1053.51, "avg": 526.76, "max": 68.30, "min": 985.21, "cnt": 2}, "backward-params-all-reduce":{"total": 484.29, "avg": 484.29, "max": 484.29, "min": 484.29, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 250.35, "avg": 250.35, "max": 250.35, "min": 250.35, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 204.57, "avg": 204.57, "max": 204.57, "min": 204.57, "cnt": 1}, "optimizer-clip-main-grad":{"total": 4.08, "avg": 4.08, "max": 4.08, "min": 4.08, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 92, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 74.47, "avg": 24.82, "max": 1.15, "min": 72.04, "cnt": 3}, "forward-compute":{"total": 1879.19, "avg": 58.72, "max": 53.56, "min": 63.87, "cnt": 32}, "fwd-compute":{"total": 1876.04, "avg": 58.63, "max": 53.49, "min": 63.73, "cnt": 32}, "batch-generator":{"total": 54.85, "avg": 1.71, "max": 0.76, "min": 3.78, "cnt": 32}, "fwd-embedding":{"total": 0.63, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1808.78, "avg": 56.52, "max": 52.08, "min": 61.63, "cnt": 32}, "fwd-layernorm":{"total": 10.09, "avg": 0.08, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 108.26, "avg": 0.85, "max": 0.74, "min": 1.55, "cnt": 128}, "fwd-misc":{"total": 21.79, "avg": 0.17, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1647.32, "avg": 12.87, "max": 10.34, "min": 17.73, "cnt": 128}, "MoE_L0_fwd":{"total": 488.96, "avg": 15.28, "max": 12.69, "min": 17.65, "cnt": 32}, "MoEMLP":{"total": 1630.21, "avg": 12.74, "max": 10.22, "min": 17.61, "cnt": 128}, "MoE_L1_fwd":{"total": 361.42, "avg": 11.29, "max": 10.26, "min": 15.10, "cnt": 32}, "MoE_L2_fwd":{"total": 385.75, "avg": 12.05, "max": 11.43, "min": 14.53, "cnt": 32}, "MoE_L3_fwd":{"total": 400.45, "avg": 12.51, "max": 11.79, "min": 14.31, "cnt": 32}, "fwd-pooler":{"total": 0.36, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 2.04, "avg": 1.02, "max": 0.97, "min": 1.07, "cnt": 2}, "forward-send-backward-recv":{"total": 170.43, "avg": 5.68, "max": 1.60, "min": 106.55, "cnt": 30}, "backward-compute":{"total": 1796.16, "avg": 56.13, "max": 53.32, "min": 58.69, "cnt": 32}, "MoE_L3_bwd":{"total": 446.57, "avg": 13.96, "max": 13.15, "min": 15.71, "cnt": 32}, "MoE_L2_bwd":{"total": 394.05, "avg": 12.31, "max": 11.75, "min": 14.04, "cnt": 32}, "MoE_L1_bwd":{"total": 300.80, "avg": 9.40, "max": 8.48, "min": 10.38, "cnt": 32}, "MoE_L0_bwd":{"total": 436.81, "avg": 13.65, "max": 12.86, "min": 15.13, "cnt": 32}, "backward-send-forward-recv":{"total": 3354.67, "avg": 115.68, "max": 2.24, "min": 494.59, "cnt": 29}, "backward-send":{"total": 2.92, "avg": 0.97, "max": 0.70, "min": 1.13, "cnt": 3}, "backward-recv":{"total": 127.16, "avg": 63.58, "max": 57.73, "min": 69.43, "cnt": 2}, "backward-params-all-reduce":{"total": 488.09, "avg": 488.09, "max": 488.09, "min": 488.09, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 239.73, "avg": 239.73, "max": 239.73, "min": 239.73, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.36, "avg": 3.36, "max": 3.36, "min": 3.36, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 199.33, "avg": 199.33, "max": 199.33, "min": 199.33, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.95, "avg": 3.95, "max": 3.95, "min": 3.95, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 93, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 1900.48, "avg": 633.49, "max": 1.26, "min": 1897.89, "cnt": 3}, "forward-compute":{"total": 1874.37, "avg": 58.57, "max": 52.12, "min": 63.82, "cnt": 32}, "fwd-compute":{"total": 1871.17, "avg": 58.47, "max": 52.05, "min": 63.74, "cnt": 32}, "batch-generator":{"total": 49.07, "avg": 1.53, "max": 0.65, "min": 2.94, "cnt": 32}, "fwd-embedding":{"total": 0.65, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1809.40, "avg": 56.54, "max": 50.69, "min": 62.58, "cnt": 32}, "fwd-layernorm":{"total": 10.12, "avg": 0.08, "max": 0.06, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 111.53, "avg": 0.87, "max": 0.74, "min": 2.17, "cnt": 128}, "fwd-misc":{"total": 21.81, "avg": 0.17, "max": 0.11, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1643.95, "avg": 12.84, "max": 9.91, "min": 20.93, "cnt": 128}, "MoE_L0_fwd":{"total": 504.53, "avg": 15.77, "max": 12.64, "min": 20.85, "cnt": 32}, "MoEMLP":{"total": 1626.70, "avg": 12.71, "max": 9.80, "min": 20.80, "cnt": 128}, "MoE_L1_fwd":{"total": 358.04, "avg": 11.19, "max": 9.84, "min": 13.88, "cnt": 32}, "MoE_L2_fwd":{"total": 374.12, "avg": 11.69, "max": 10.74, "min": 13.84, "cnt": 32}, "MoE_L3_fwd":{"total": 396.30, "avg": 12.38, "max": 11.72, "min": 14.36, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 7.07, "avg": 3.54, "max": 0.91, "min": 6.16, "cnt": 2}, "forward-send-backward-recv":{"total": 190.25, "avg": 6.34, "max": 1.03, "min": 122.97, "cnt": 30}, "backward-compute":{"total": 1776.28, "avg": 55.51, "max": 53.78, "min": 58.10, "cnt": 32}, "MoE_L3_bwd":{"total": 442.74, "avg": 13.84, "max": 12.51, "min": 15.46, "cnt": 32}, "MoE_L2_bwd":{"total": 384.84, "avg": 12.03, "max": 11.17, "min": 13.16, "cnt": 32}, "MoE_L1_bwd":{"total": 295.19, "avg": 9.22, "max": 8.68, "min": 10.13, "cnt": 32}, "MoE_L0_bwd":{"total": 441.43, "avg": 13.79, "max": 13.21, "min": 16.59, "cnt": 32}, "backward-send-forward-recv":{"total": 4718.27, "avg": 162.70, "max": 2.43, "min": 653.05, "cnt": 29}, "backward-send":{"total": 2.84, "avg": 0.95, "max": 0.80, "min": 1.16, "cnt": 3}, "backward-recv":{"total": 144.24, "avg": 72.12, "max": 69.60, "min": 74.64, "cnt": 2}, "backward-params-all-reduce":{"total": 489.86, "avg": 489.86, "max": 489.86, "min": 489.86, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 231.92, "avg": 231.92, "max": 231.92, "min": 231.92, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 192.25, "avg": 192.25, "max": 192.25, "min": 192.25, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.36, "avg": 3.36, "max": 3.36, "min": 3.36, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 94, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 84.45, "avg": 28.15, "max": 1.06, "min": 82.03, "cnt": 3}, "forward-compute":{"total": 1814.50, "avg": 56.70, "max": 52.74, "min": 62.07, "cnt": 32}, "fwd-compute":{"total": 1811.29, "avg": 56.60, "max": 52.66, "min": 61.98, "cnt": 32}, "batch-generator":{"total": 37.35, "avg": 1.17, "max": 0.64, "min": 1.79, "cnt": 32}, "fwd-embedding":{"total": 0.57, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1762.07, "avg": 55.06, "max": 51.27, "min": 60.87, "cnt": 32}, "fwd-layernorm":{"total": 9.58, "avg": 0.07, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 106.18, "avg": 0.83, "max": 0.74, "min": 1.50, "cnt": 128}, "fwd-misc":{"total": 20.37, "avg": 0.16, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1605.33, "avg": 12.54, "max": 9.82, "min": 19.37, "cnt": 128}, "MoE_L0_fwd":{"total": 493.60, "avg": 15.43, "max": 12.66, "min": 19.30, "cnt": 32}, "MoEMLP":{"total": 1588.75, "avg": 12.41, "max": 9.71, "min": 19.25, "cnt": 128}, "MoE_L1_fwd":{"total": 342.55, "avg": 10.70, "max": 9.75, "min": 11.57, "cnt": 32}, "MoE_L2_fwd":{"total": 362.12, "avg": 11.32, "max": 10.37, "min": 13.38, "cnt": 32}, "MoE_L3_fwd":{"total": 396.61, "avg": 12.39, "max": 11.73, "min": 13.79, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 2.95, "avg": 1.48, "max": 1.06, "min": 1.89, "cnt": 2}, "forward-send-backward-recv":{"total": 1885.51, "avg": 62.85, "max": 1.25, "min": 441.61, "cnt": 30}, "backward-compute":{"total": 1760.45, "avg": 55.01, "max": 52.63, "min": 57.18, "cnt": 32}, "MoE_L3_bwd":{"total": 453.16, "avg": 14.16, "max": 12.85, "min": 16.15, "cnt": 32}, "MoE_L2_bwd":{"total": 372.09, "avg": 11.63, "max": 10.85, "min": 12.63, "cnt": 32}, "MoE_L1_bwd":{"total": 292.25, "avg": 9.13, "max": 8.48, "min": 9.79, "cnt": 32}, "MoE_L0_bwd":{"total": 430.43, "avg": 13.45, "max": 12.84, "min": 14.18, "cnt": 32}, "backward-send-forward-recv":{"total": 2170.39, "avg": 74.84, "max": 2.09, "min": 312.26, "cnt": 29}, "backward-send":{"total": 3.00, "avg": 1.00, "max": 0.94, "min": 1.11, "cnt": 3}, "backward-recv":{"total": 158.51, "avg": 79.26, "max": 60.86, "min": 97.66, "cnt": 2}, "backward-params-all-reduce":{"total": 484.63, "avg": 484.63, "max": 484.63, "min": 484.63, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 249.36, "avg": 249.36, "max": 249.36, "min": 249.36, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 209.54, "avg": 209.54, "max": 209.54, "min": 209.54, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}}}
{"type":"time", "iteration": 95, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 79.45, "avg": 26.48, "max": 0.92, "min": 77.45, "cnt": 3}, "forward-compute":{"total": 1822.75, "avg": 56.96, "max": 51.44, "min": 63.92, "cnt": 32}, "fwd-compute":{"total": 1819.58, "avg": 56.86, "max": 51.33, "min": 63.79, "cnt": 32}, "batch-generator":{"total": 39.63, "avg": 1.24, "max": 0.68, "min": 1.76, "cnt": 32}, "fwd-embedding":{"total": 0.58, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1767.89, "avg": 55.25, "max": 50.17, "min": 61.73, "cnt": 32}, "fwd-layernorm":{"total": 9.50, "avg": 0.07, "max": 0.06, "min": 0.18, "cnt": 128}, "fwd-attn":{"total": 106.36, "avg": 0.83, "max": 0.74, "min": 1.48, "cnt": 128}, "fwd-misc":{"total": 20.58, "avg": 0.16, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1610.93, "avg": 12.59, "max": 9.77, "min": 21.05, "cnt": 128}, "MoE_L0_fwd":{"total": 494.20, "avg": 15.44, "max": 12.11, "min": 20.94, "cnt": 32}, "MoEMLP":{"total": 1594.16, "avg": 12.45, "max": 9.66, "min": 20.87, "cnt": 128}, "MoE_L1_fwd":{"total": 342.33, "avg": 10.70, "max": 9.70, "min": 12.26, "cnt": 32}, "MoE_L2_fwd":{"total": 371.95, "avg": 11.62, "max": 10.84, "min": 15.50, "cnt": 32}, "MoE_L3_fwd":{"total": 391.75, "avg": 12.24, "max": 11.38, "min": 15.02, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.61, "avg": 0.02, "max": 0.02, "min": 0.04, "cnt": 32}, "forward-send":{"total": 3.27, "avg": 1.64, "max": 1.01, "min": 2.26, "cnt": 2}, "forward-send-backward-recv":{"total": 361.22, "avg": 12.04, "max": 1.26, "min": 139.34, "cnt": 30}, "backward-compute":{"total": 1753.69, "avg": 54.80, "max": 52.82, "min": 59.50, "cnt": 32}, "MoE_L3_bwd":{"total": 428.97, "avg": 13.41, "max": 12.15, "min": 14.83, "cnt": 32}, "MoE_L2_bwd":{"total": 383.59, "avg": 11.99, "max": 11.03, "min": 16.20, "cnt": 32}, "MoE_L1_bwd":{"total": 298.40, "avg": 9.32, "max": 8.51, "min": 9.96, "cnt": 32}, "MoE_L0_bwd":{"total": 429.48, "avg": 13.42, "max": 12.86, "min": 14.17, "cnt": 32}, "backward-send-forward-recv":{"total": 3916.39, "avg": 135.05, "max": 2.42, "min": 1030.31, "cnt": 29}, "backward-send":{"total": 2.80, "avg": 0.93, "max": 0.81, "min": 1.00, "cnt": 3}, "backward-recv":{"total": 221.38, "avg": 110.69, "max": 59.39, "min": 162.00, "cnt": 2}, "backward-params-all-reduce":{"total": 485.18, "avg": 485.18, "max": 485.18, "min": 485.18, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 246.74, "avg": 246.74, "max": 246.74, "min": 246.74, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.36, "avg": 3.36, "max": 3.36, "min": 3.36, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 206.77, "avg": 206.77, "max": 206.77, "min": 206.77, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.64, "avg": 3.64, "max": 3.64, "min": 3.64, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 96, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 77.97, "avg": 25.99, "max": 0.81, "min": 74.36, "cnt": 3}, "forward-compute":{"total": 1981.97, "avg": 61.94, "max": 51.25, "min": 142.15, "cnt": 32}, "fwd-compute":{"total": 1978.28, "avg": 61.82, "max": 51.15, "min": 142.05, "cnt": 32}, "batch-generator":{"total": 61.77, "avg": 1.93, "max": 0.67, "min": 4.07, "cnt": 32}, "fwd-embedding":{"total": 0.64, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1901.90, "avg": 59.43, "max": 50.03, "min": 140.62, "cnt": 32}, "fwd-layernorm":{"total": 10.37, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 111.90, "avg": 0.87, "max": 0.74, "min": 2.24, "cnt": 128}, "fwd-misc":{"total": 22.07, "avg": 0.17, "max": 0.11, "min": 0.44, "cnt": 128}, "fwd-MLP":{"total": 1734.22, "avg": 13.55, "max": 9.87, "min": 101.39, "cnt": 128}, "MoE_L0_fwd":{"total": 611.48, "avg": 19.11, "max": 12.79, "min": 101.29, "cnt": 32}, "MoEMLP":{"total": 1716.66, "avg": 13.41, "max": 9.75, "min": 101.24, "cnt": 128}, "MoE_L1_fwd":{"total": 358.69, "avg": 11.21, "max": 9.80, "min": 15.59, "cnt": 32}, "MoE_L2_fwd":{"total": 368.86, "avg": 11.53, "max": 10.82, "min": 14.77, "cnt": 32}, "MoE_L3_fwd":{"total": 384.07, "avg": 12.00, "max": 11.16, "min": 16.09, "cnt": 32}, "fwd-pooler":{"total": 0.37, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.67, "avg": 0.02, "max": 0.02, "min": 0.06, "cnt": 32}, "forward-send":{"total": 8.38, "avg": 4.19, "max": 0.87, "min": 7.51, "cnt": 2}, "forward-send-backward-recv":{"total": 192.26, "avg": 6.41, "max": 0.97, "min": 124.54, "cnt": 30}, "backward-compute":{"total": 1742.47, "avg": 54.45, "max": 52.96, "min": 56.14, "cnt": 32}, "MoE_L3_bwd":{"total": 427.50, "avg": 13.36, "max": 12.16, "min": 15.80, "cnt": 32}, "MoE_L2_bwd":{"total": 376.66, "avg": 11.77, "max": 10.99, "min": 12.63, "cnt": 32}, "MoE_L1_bwd":{"total": 300.23, "avg": 9.38, "max": 8.72, "min": 10.20, "cnt": 32}, "MoE_L0_bwd":{"total": 421.88, "avg": 13.18, "max": 12.63, "min": 13.69, "cnt": 32}, "backward-send-forward-recv":{"total": 6952.23, "avg": 239.73, "max": 2.30, "min": 1101.62, "cnt": 29}, "backward-send":{"total": 3.10, "avg": 1.03, "max": 1.00, "min": 1.07, "cnt": 3}, "backward-recv":{"total": 127.22, "avg": 63.61, "max": 55.06, "min": 72.16, "cnt": 2}, "backward-params-all-reduce":{"total": 486.80, "avg": 486.80, "max": 486.80, "min": 486.80, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 242.91, "avg": 242.91, "max": 242.91, "min": 242.91, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 202.95, "avg": 202.95, "max": 202.95, "min": 202.95, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.57, "avg": 3.57, "max": 3.57, "min": 3.57, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 97, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 80.82, "avg": 26.94, "max": 0.84, "min": 78.69, "cnt": 3}, "forward-compute":{"total": 1826.77, "avg": 57.09, "max": 50.45, "min": 61.80, "cnt": 32}, "fwd-compute":{"total": 1823.52, "avg": 56.99, "max": 50.37, "min": 61.71, "cnt": 32}, "batch-generator":{"total": 53.34, "avg": 1.67, "max": 0.67, "min": 4.41, "cnt": 32}, "fwd-embedding":{"total": 0.63, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1757.40, "avg": 54.92, "max": 49.30, "min": 58.53, "cnt": 32}, "fwd-layernorm":{"total": 10.05, "avg": 0.08, "max": 0.05, "min": 0.23, "cnt": 128}, "fwd-attn":{"total": 109.70, "avg": 0.86, "max": 0.74, "min": 2.13, "cnt": 128}, "fwd-misc":{"total": 21.19, "avg": 0.17, "max": 0.11, "min": 0.39, "cnt": 128}, "fwd-MLP":{"total": 1595.12, "avg": 12.46, "max": 9.71, "min": 19.55, "cnt": 128}, "MoE_L0_fwd":{"total": 493.47, "avg": 15.42, "max": 11.96, "min": 19.46, "cnt": 32}, "MoEMLP":{"total": 1578.42, "avg": 12.33, "max": 9.60, "min": 19.41, "cnt": 128}, "MoE_L1_fwd":{"total": 345.16, "avg": 10.79, "max": 9.64, "min": 11.95, "cnt": 32}, "MoE_L2_fwd":{"total": 366.42, "avg": 11.45, "max": 10.90, "min": 12.36, "cnt": 32}, "MoE_L3_fwd":{"total": 379.58, "avg": 11.86, "max": 11.26, "min": 12.48, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.56, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 10.28, "avg": 5.14, "max": 0.87, "min": 9.40, "cnt": 2}, "forward-send-backward-recv":{"total": 288.22, "avg": 9.61, "max": 1.13, "min": 121.73, "cnt": 30}, "backward-compute":{"total": 1751.04, "avg": 54.72, "max": 53.16, "min": 55.95, "cnt": 32}, "MoE_L3_bwd":{"total": 429.07, "avg": 13.41, "max": 12.57, "min": 14.27, "cnt": 32}, "MoE_L2_bwd":{"total": 385.40, "avg": 12.04, "max": 11.23, "min": 12.91, "cnt": 32}, "MoE_L1_bwd":{"total": 294.56, "avg": 9.21, "max": 8.52, "min": 9.86, "cnt": 32}, "MoE_L0_bwd":{"total": 427.28, "avg": 13.35, "max": 12.93, "min": 14.42, "cnt": 32}, "backward-send-forward-recv":{"total": 5249.10, "avg": 181.00, "max": 1.81, "min": 837.35, "cnt": 29}, "backward-send":{"total": 2.50, "avg": 0.83, "max": 0.58, "min": 1.05, "cnt": 3}, "backward-recv":{"total": 120.18, "avg": 60.09, "max": 56.64, "min": 63.54, "cnt": 2}, "backward-params-all-reduce":{"total": 489.14, "avg": 489.14, "max": 489.14, "min": 489.14, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 243.41, "avg": 243.41, "max": 243.41, "min": 243.41, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.48, "avg": 3.48, "max": 3.48, "min": 3.48, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 203.09, "avg": 203.09, "max": 203.09, "min": 203.09, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.73, "avg": 3.73, "max": 3.73, "min": 3.73, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 98, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 86.25, "avg": 28.75, "max": 2.56, "min": 74.64, "cnt": 3}, "forward-compute":{"total": 1856.70, "avg": 58.02, "max": 51.66, "min": 63.44, "cnt": 32}, "fwd-compute":{"total": 1853.52, "avg": 57.92, "max": 51.59, "min": 63.31, "cnt": 32}, "batch-generator":{"total": 42.51, "avg": 1.33, "max": 0.66, "min": 2.45, "cnt": 32}, "fwd-embedding":{"total": 0.57, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1798.62, "avg": 56.21, "max": 50.51, "min": 60.97, "cnt": 32}, "fwd-layernorm":{"total": 9.26, "avg": 0.07, "max": 0.05, "min": 0.17, "cnt": 128}, "fwd-attn":{"total": 106.91, "avg": 0.84, "max": 0.74, "min": 1.81, "cnt": 128}, "fwd-misc":{"total": 20.45, "avg": 0.16, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1641.38, "avg": 12.82, "max": 9.99, "min": 18.36, "cnt": 128}, "MoE_L0_fwd":{"total": 510.24, "avg": 15.95, "max": 12.60, "min": 18.27, "cnt": 32}, "MoEMLP":{"total": 1624.89, "avg": 12.69, "max": 9.88, "min": 18.23, "cnt": 128}, "MoE_L1_fwd":{"total": 352.32, "avg": 11.01, "max": 9.92, "min": 12.65, "cnt": 32}, "MoE_L2_fwd":{"total": 383.05, "avg": 11.97, "max": 11.26, "min": 12.74, "cnt": 32}, "MoE_L3_fwd":{"total": 385.33, "avg": 12.04, "max": 11.03, "min": 14.35, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.56, "avg": 0.78, "max": 0.75, "min": 0.81, "cnt": 2}, "forward-send-backward-recv":{"total": 184.22, "avg": 6.14, "max": 0.91, "min": 120.11, "cnt": 30}, "backward-compute":{"total": 1779.96, "avg": 55.62, "max": 53.22, "min": 57.80, "cnt": 32}, "MoE_L3_bwd":{"total": 439.75, "avg": 13.74, "max": 12.48, "min": 15.74, "cnt": 32}, "MoE_L2_bwd":{"total": 392.85, "avg": 12.28, "max": 11.60, "min": 12.80, "cnt": 32}, "MoE_L1_bwd":{"total": 293.70, "avg": 9.18, "max": 8.59, "min": 10.22, "cnt": 32}, "MoE_L0_bwd":{"total": 436.66, "avg": 13.65, "max": 13.28, "min": 14.08, "cnt": 32}, "backward-send-forward-recv":{"total": 3265.52, "avg": 112.60, "max": 2.49, "min": 304.65, "cnt": 29}, "backward-send":{"total": 2.91, "avg": 0.97, "max": 0.81, "min": 1.13, "cnt": 3}, "backward-recv":{"total": 129.19, "avg": 64.59, "max": 59.96, "min": 69.23, "cnt": 2}, "backward-params-all-reduce":{"total": 488.11, "avg": 488.11, "max": 488.11, "min": 488.11, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 242.09, "avg": 242.09, "max": 242.09, "min": 242.09, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 201.66, "avg": 201.66, "max": 201.66, "min": 201.66, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.98, "avg": 3.98, "max": 3.98, "min": 3.98, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 99, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.10, "avg": 0.10, "max": 0.10, "min": 0.10, "cnt": 1}, "forward-recv":{"total": 74.20, "avg": 24.73, "max": 1.17, "min": 66.92, "cnt": 3}, "forward-compute":{"total": 1858.89, "avg": 58.09, "max": 51.18, "min": 63.79, "cnt": 32}, "fwd-compute":{"total": 1855.65, "avg": 57.99, "max": 51.11, "min": 63.71, "cnt": 32}, "batch-generator":{"total": 40.94, "avg": 1.28, "max": 0.66, "min": 2.83, "cnt": 32}, "fwd-embedding":{"total": 0.63, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1802.23, "avg": 56.32, "max": 50.15, "min": 62.40, "cnt": 32}, "fwd-layernorm":{"total": 9.87, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 108.84, "avg": 0.85, "max": 0.74, "min": 1.48, "cnt": 128}, "fwd-misc":{"total": 21.07, "avg": 0.16, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1641.21, "avg": 12.82, "max": 9.94, "min": 21.74, "cnt": 128}, "MoE_L0_fwd":{"total": 504.83, "avg": 15.78, "max": 12.46, "min": 21.62, "cnt": 32}, "MoEMLP":{"total": 1624.54, "avg": 12.69, "max": 9.83, "min": 21.55, "cnt": 128}, "MoE_L1_fwd":{"total": 358.89, "avg": 11.22, "max": 9.87, "min": 14.53, "cnt": 32}, "MoE_L2_fwd":{"total": 390.19, "avg": 12.19, "max": 11.44, "min": 16.96, "cnt": 32}, "MoE_L3_fwd":{"total": 376.79, "avg": 11.77, "max": 11.03, "min": 12.82, "cnt": 32}, "fwd-pooler":{"total": 0.36, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.75, "avg": 0.87, "max": 0.81, "min": 0.94, "cnt": 2}, "forward-send-backward-recv":{"total": 539.87, "avg": 18.00, "max": 1.51, "min": 141.27, "cnt": 30}, "backward-compute":{"total": 1778.69, "avg": 55.58, "max": 53.74, "min": 58.18, "cnt": 32}, "MoE_L3_bwd":{"total": 433.90, "avg": 13.56, "max": 12.31, "min": 16.24, "cnt": 32}, "MoE_L2_bwd":{"total": 389.85, "avg": 12.18, "max": 11.59, "min": 13.02, "cnt": 32}, "MoE_L1_bwd":{"total": 304.07, "avg": 9.50, "max": 8.90, "min": 10.45, "cnt": 32}, "MoE_L0_bwd":{"total": 435.45, "avg": 13.61, "max": 12.78, "min": 14.31, "cnt": 32}, "backward-send-forward-recv":{"total": 4808.51, "avg": 165.81, "max": 2.27, "min": 1452.51, "cnt": 29}, "backward-send":{"total": 2.87, "avg": 0.96, "max": 0.72, "min": 1.09, "cnt": 3}, "backward-recv":{"total": 208.76, "avg": 104.38, "max": 71.06, "min": 137.70, "cnt": 2}, "backward-params-all-reduce":{"total": 488.83, "avg": 488.83, "max": 488.83, "min": 488.83, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.06, "avg": 0.06, "max": 0.06, "min": 0.06, "cnt": 1}, "optimizer":{"total": 242.78, "avg": 242.78, "max": 242.78, "min": 242.78, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 202.85, "avg": 202.85, "max": 202.85, "min": 202.85, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.36, "avg": 3.36, "max": 3.36, "min": 3.36, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 100, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 76.82, "avg": 25.61, "max": 0.71, "min": 74.88, "cnt": 3}, "forward-compute":{"total": 1834.34, "avg": 57.32, "max": 52.23, "min": 62.34, "cnt": 32}, "fwd-compute":{"total": 1831.29, "avg": 57.23, "max": 52.15, "min": 62.25, "cnt": 32}, "batch-generator":{"total": 49.42, "avg": 1.54, "max": 0.70, "min": 4.33, "cnt": 32}, "fwd-embedding":{"total": 0.62, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1769.23, "avg": 55.29, "max": 50.91, "min": 60.33, "cnt": 32}, "fwd-layernorm":{"total": 9.48, "avg": 0.07, "max": 0.06, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 106.33, "avg": 0.83, "max": 0.74, "min": 1.77, "cnt": 128}, "fwd-misc":{"total": 20.22, "avg": 0.16, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1612.83, "avg": 12.60, "max": 10.43, "min": 18.53, "cnt": 128}, "MoE_L0_fwd":{"total": 481.85, "avg": 15.06, "max": 12.29, "min": 18.45, "cnt": 32}, "MoEMLP":{"total": 1596.73, "avg": 12.47, "max": 10.30, "min": 18.41, "cnt": 128}, "MoE_L1_fwd":{"total": 365.66, "avg": 11.43, "max": 10.35, "min": 15.09, "cnt": 32}, "MoE_L2_fwd":{"total": 378.20, "avg": 11.82, "max": 11.02, "min": 12.81, "cnt": 32}, "MoE_L3_fwd":{"total": 376.93, "avg": 11.78, "max": 11.15, "min": 12.82, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 8.08, "avg": 4.04, "max": 0.86, "min": 7.21, "cnt": 2}, "forward-send-backward-recv":{"total": 174.01, "avg": 5.80, "max": 1.10, "min": 113.61, "cnt": 30}, "backward-compute":{"total": 1787.81, "avg": 55.87, "max": 53.80, "min": 58.45, "cnt": 32}, "MoE_L3_bwd":{"total": 435.69, "avg": 13.62, "max": 12.23, "min": 16.22, "cnt": 32}, "MoE_L2_bwd":{"total": 392.01, "avg": 12.25, "max": 11.45, "min": 12.86, "cnt": 32}, "MoE_L1_bwd":{"total": 312.99, "avg": 9.78, "max": 8.91, "min": 10.46, "cnt": 32}, "MoE_L0_bwd":{"total": 432.85, "avg": 13.53, "max": 13.09, "min": 14.52, "cnt": 32}, "backward-send-forward-recv":{"total": 6416.09, "avg": 221.24, "max": 2.47, "min": 778.57, "cnt": 29}, "backward-send":{"total": 2.99, "avg": 1.00, "max": 0.81, "min": 1.34, "cnt": 3}, "backward-recv":{"total": 159.80, "avg": 79.90, "max": 65.35, "min": 94.45, "cnt": 2}, "backward-params-all-reduce":{"total": 483.23, "avg": 483.23, "max": 483.23, "min": 483.23, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 250.72, "avg": 250.72, "max": 250.72, "min": 250.72, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 210.73, "avg": 210.73, "max": 210.73, "min": 210.73, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.55, "avg": 3.55, "max": 3.55, "min": 3.55, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 101, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 75.74, "avg": 25.25, "max": 1.46, "min": 72.80, "cnt": 3}, "forward-compute":{"total": 1915.80, "avg": 59.87, "max": 52.35, "min": 67.59, "cnt": 32}, "fwd-compute":{"total": 1912.45, "avg": 59.76, "max": 52.28, "min": 67.50, "cnt": 32}, "batch-generator":{"total": 58.42, "avg": 1.83, "max": 0.66, "min": 4.45, "cnt": 32}, "fwd-embedding":{"total": 0.67, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1840.87, "avg": 57.53, "max": 51.31, "min": 64.79, "cnt": 32}, "fwd-layernorm":{"total": 10.05, "avg": 0.08, "max": 0.05, "min": 0.23, "cnt": 128}, "fwd-attn":{"total": 107.71, "avg": 0.84, "max": 0.74, "min": 1.63, "cnt": 128}, "fwd-misc":{"total": 21.54, "avg": 0.17, "max": 0.11, "min": 0.41, "cnt": 128}, "fwd-MLP":{"total": 1680.13, "avg": 13.13, "max": 10.62, "min": 23.97, "cnt": 128}, "MoE_L0_fwd":{"total": 503.25, "avg": 15.73, "max": 12.71, "min": 23.89, "cnt": 32}, "MoEMLP":{"total": 1662.89, "avg": 12.99, "max": 10.47, "min": 23.84, "cnt": 128}, "MoE_L1_fwd":{"total": 379.31, "avg": 11.85, "max": 10.51, "min": 14.71, "cnt": 32}, "MoE_L2_fwd":{"total": 391.11, "avg": 12.22, "max": 11.66, "min": 16.42, "cnt": 32}, "MoE_L3_fwd":{"total": 395.56, "avg": 12.36, "max": 11.42, "min": 15.33, "cnt": 32}, "fwd-pooler":{"total": 0.36, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.87, "avg": 0.94, "max": 0.93, "min": 0.95, "cnt": 2}, "forward-send-backward-recv":{"total": 220.65, "avg": 7.36, "max": 1.31, "min": 121.77, "cnt": 30}, "backward-compute":{"total": 1805.39, "avg": 56.42, "max": 53.35, "min": 58.09, "cnt": 32}, "MoE_L3_bwd":{"total": 444.61, "avg": 13.89, "max": 12.14, "min": 15.46, "cnt": 32}, "MoE_L2_bwd":{"total": 407.38, "avg": 12.73, "max": 12.07, "min": 13.55, "cnt": 32}, "MoE_L1_bwd":{"total": 308.41, "avg": 9.64, "max": 8.87, "min": 10.56, "cnt": 32}, "MoE_L0_bwd":{"total": 432.94, "avg": 13.53, "max": 13.07, "min": 13.87, "cnt": 32}, "backward-send-forward-recv":{"total": 4032.71, "avg": 139.06, "max": 1.67, "min": 695.63, "cnt": 29}, "backward-send":{"total": 3.35, "avg": 1.12, "max": 1.07, "min": 1.15, "cnt": 3}, "backward-recv":{"total": 136.53, "avg": 68.26, "max": 65.67, "min": 70.86, "cnt": 2}, "backward-params-all-reduce":{"total": 488.52, "avg": 488.52, "max": 488.52, "min": 488.52, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 245.15, "avg": 245.15, "max": 245.15, "min": 245.15, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 205.13, "avg": 205.13, "max": 205.13, "min": 205.13, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.56, "avg": 3.56, "max": 3.56, "min": 3.56, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 102, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 75.03, "avg": 25.01, "max": 1.27, "min": 70.06, "cnt": 3}, "forward-compute":{"total": 1859.45, "avg": 58.11, "max": 52.40, "min": 62.82, "cnt": 32}, "fwd-compute":{"total": 1856.08, "avg": 58.00, "max": 52.33, "min": 62.73, "cnt": 32}, "batch-generator":{"total": 43.35, "avg": 1.35, "max": 0.68, "min": 3.40, "cnt": 32}, "fwd-embedding":{"total": 0.65, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1799.93, "avg": 56.25, "max": 51.35, "min": 59.31, "cnt": 32}, "fwd-layernorm":{"total": 10.01, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 107.62, "avg": 0.84, "max": 0.74, "min": 1.56, "cnt": 128}, "fwd-misc":{"total": 21.33, "avg": 0.17, "max": 0.12, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1639.72, "avg": 12.81, "max": 10.58, "min": 18.60, "cnt": 128}, "MoE_L0_fwd":{"total": 485.20, "avg": 15.16, "max": 12.35, "min": 18.51, "cnt": 32}, "MoEMLP":{"total": 1622.74, "avg": 12.68, "max": 10.46, "min": 18.45, "cnt": 128}, "MoE_L1_fwd":{"total": 362.35, "avg": 11.32, "max": 10.50, "min": 12.36, "cnt": 32}, "MoE_L2_fwd":{"total": 389.80, "avg": 12.18, "max": 11.71, "min": 13.89, "cnt": 32}, "MoE_L3_fwd":{"total": 391.67, "avg": 12.24, "max": 11.60, "min": 13.04, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.87, "avg": 0.94, "max": 0.87, "min": 1.00, "cnt": 2}, "forward-send-backward-recv":{"total": 1168.37, "avg": 38.95, "max": 1.26, "min": 147.82, "cnt": 30}, "backward-compute":{"total": 1821.52, "avg": 56.92, "max": 55.32, "min": 58.97, "cnt": 32}, "MoE_L3_bwd":{"total": 463.78, "avg": 14.49, "max": 12.93, "min": 16.51, "cnt": 32}, "MoE_L2_bwd":{"total": 408.52, "avg": 12.77, "max": 12.24, "min": 15.23, "cnt": 32}, "MoE_L1_bwd":{"total": 310.57, "avg": 9.71, "max": 9.10, "min": 10.22, "cnt": 32}, "MoE_L0_bwd":{"total": 425.08, "avg": 13.28, "max": 12.69, "min": 13.98, "cnt": 32}, "backward-send-forward-recv":{"total": 1711.19, "avg": 59.01, "max": 2.28, "min": 221.80, "cnt": 29}, "backward-send":{"total": 3.10, "avg": 1.03, "max": 1.01, "min": 1.05, "cnt": 3}, "backward-recv":{"total": 446.77, "avg": 223.38, "max": 71.23, "min": 375.54, "cnt": 2}, "backward-params-all-reduce":{"total": 486.83, "avg": 486.83, "max": 486.83, "min": 486.83, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 241.83, "avg": 241.83, "max": 241.83, "min": 241.83, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 202.14, "avg": 202.14, "max": 202.14, "min": 202.14, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.34, "avg": 3.34, "max": 3.34, "min": 3.34, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 103, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 74.30, "avg": 24.77, "max": 1.25, "min": 71.78, "cnt": 3}, "forward-compute":{"total": 1890.85, "avg": 59.09, "max": 51.81, "min": 64.19, "cnt": 32}, "fwd-compute":{"total": 1887.60, "avg": 58.99, "max": 51.74, "min": 64.11, "cnt": 32}, "batch-generator":{"total": 50.85, "avg": 1.59, "max": 0.66, "min": 3.15, "cnt": 32}, "fwd-embedding":{"total": 0.69, "avg": 0.02, "max": 0.01, "min": 0.06, "cnt": 32}, "fwd-encoder":{"total": 1824.36, "avg": 57.01, "max": 50.77, "min": 61.56, "cnt": 32}, "fwd-layernorm":{"total": 10.06, "avg": 0.08, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 110.93, "avg": 0.87, "max": 0.74, "min": 2.29, "cnt": 128}, "fwd-misc":{"total": 21.17, "avg": 0.17, "max": 0.11, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1660.82, "avg": 12.98, "max": 10.47, "min": 19.94, "cnt": 128}, "MoE_L0_fwd":{"total": 486.62, "avg": 15.21, "max": 12.13, "min": 19.85, "cnt": 32}, "MoEMLP":{"total": 1643.93, "avg": 12.84, "max": 10.37, "min": 19.81, "cnt": 128}, "MoE_L1_fwd":{"total": 375.97, "avg": 11.75, "max": 10.41, "min": 14.21, "cnt": 32}, "MoE_L2_fwd":{"total": 393.82, "avg": 12.31, "max": 11.56, "min": 13.13, "cnt": 32}, "MoE_L3_fwd":{"total": 393.76, "avg": 12.31, "max": 11.74, "min": 13.23, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 4.68, "avg": 2.34, "max": 0.90, "min": 3.78, "cnt": 2}, "forward-send-backward-recv":{"total": 245.21, "avg": 8.17, "max": 1.53, "min": 126.99, "cnt": 30}, "backward-compute":{"total": 1778.36, "avg": 55.57, "max": 53.91, "min": 58.69, "cnt": 32}, "MoE_L3_bwd":{"total": 449.40, "avg": 14.04, "max": 12.91, "min": 15.58, "cnt": 32}, "MoE_L2_bwd":{"total": 396.70, "avg": 12.40, "max": 12.10, "min": 13.47, "cnt": 32}, "MoE_L1_bwd":{"total": 315.73, "avg": 9.87, "max": 9.38, "min": 11.66, "cnt": 32}, "MoE_L0_bwd":{"total": 404.01, "avg": 12.63, "max": 12.19, "min": 13.97, "cnt": 32}, "backward-send-forward-recv":{"total": 3081.22, "avg": 106.25, "max": 2.32, "min": 621.93, "cnt": 29}, "backward-send":{"total": 3.32, "avg": 1.11, "max": 1.10, "min": 1.12, "cnt": 3}, "backward-recv":{"total": 136.01, "avg": 68.00, "max": 65.11, "min": 70.90, "cnt": 2}, "backward-params-all-reduce":{"total": 487.35, "avg": 487.35, "max": 487.35, "min": 487.35, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 242.26, "avg": 242.26, "max": 242.26, "min": 242.26, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.36, "avg": 3.36, "max": 3.36, "min": 3.36, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 202.35, "avg": 202.35, "max": 202.35, "min": 202.35, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.54, "avg": 3.54, "max": 3.54, "min": 3.54, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 104, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 1682.62, "avg": 560.87, "max": 2.01, "min": 1668.16, "cnt": 3}, "forward-compute":{"total": 1882.43, "avg": 58.83, "max": 54.47, "min": 64.05, "cnt": 32}, "fwd-compute":{"total": 1879.27, "avg": 58.73, "max": 54.39, "min": 63.97, "cnt": 32}, "batch-generator":{"total": 47.80, "avg": 1.49, "max": 0.68, "min": 3.26, "cnt": 32}, "fwd-embedding":{"total": 0.58, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1818.90, "avg": 56.84, "max": 52.70, "min": 61.09, "cnt": 32}, "fwd-layernorm":{"total": 9.42, "avg": 0.07, "max": 0.06, "min": 0.17, "cnt": 128}, "fwd-attn":{"total": 105.58, "avg": 0.82, "max": 0.74, "min": 1.49, "cnt": 128}, "fwd-misc":{"total": 20.66, "avg": 0.16, "max": 0.12, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1662.64, "avg": 12.99, "max": 10.69, "min": 18.54, "cnt": 128}, "MoE_L0_fwd":{"total": 485.47, "avg": 15.17, "max": 12.13, "min": 18.36, "cnt": 32}, "MoEMLP":{"total": 1646.16, "avg": 12.86, "max": 10.57, "min": 18.32, "cnt": 128}, "MoE_L1_fwd":{"total": 374.68, "avg": 11.71, "max": 10.62, "min": 13.29, "cnt": 32}, "MoE_L2_fwd":{"total": 392.98, "avg": 12.28, "max": 11.95, "min": 12.77, "cnt": 32}, "MoE_L3_fwd":{"total": 399.08, "avg": 12.47, "max": 12.01, "min": 13.03, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.61, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.74, "avg": 0.87, "max": 0.80, "min": 0.95, "cnt": 2}, "forward-send-backward-recv":{"total": 267.25, "avg": 8.91, "max": 1.51, "min": 109.90, "cnt": 30}, "backward-compute":{"total": 1799.68, "avg": 56.24, "max": 54.34, "min": 57.73, "cnt": 32}, "MoE_L3_bwd":{"total": 452.21, "avg": 14.13, "max": 13.19, "min": 15.93, "cnt": 32}, "MoE_L2_bwd":{"total": 399.07, "avg": 12.47, "max": 11.99, "min": 13.34, "cnt": 32}, "MoE_L1_bwd":{"total": 317.13, "avg": 9.91, "max": 9.31, "min": 11.30, "cnt": 32}, "MoE_L0_bwd":{"total": 417.05, "avg": 13.03, "max": 12.55, "min": 13.45, "cnt": 32}, "backward-send-forward-recv":{"total": 2240.82, "avg": 77.27, "max": 2.38, "min": 318.93, "cnt": 29}, "backward-send":{"total": 3.38, "avg": 1.13, "max": 1.11, "min": 1.16, "cnt": 3}, "backward-recv":{"total": 204.50, "avg": 102.25, "max": 58.87, "min": 145.63, "cnt": 2}, "backward-params-all-reduce":{"total": 485.38, "avg": 485.38, "max": 485.38, "min": 485.38, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 250.25, "avg": 250.25, "max": 250.25, "min": 250.25, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 205.79, "avg": 205.79, "max": 205.79, "min": 205.79, "cnt": 1}, "optimizer-clip-main-grad":{"total": 7.19, "avg": 7.19, "max": 7.19, "min": 7.19, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 105, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 86.06, "avg": 28.69, "max": 4.27, "min": 77.23, "cnt": 3}, "forward-compute":{"total": 1928.92, "avg": 60.28, "max": 54.33, "min": 66.46, "cnt": 32}, "fwd-compute":{"total": 1925.55, "avg": 60.17, "max": 54.25, "min": 66.38, "cnt": 32}, "batch-generator":{"total": 46.72, "avg": 1.46, "max": 0.73, "min": 3.64, "cnt": 32}, "fwd-embedding":{"total": 0.74, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1865.58, "avg": 58.30, "max": 53.20, "min": 64.06, "cnt": 32}, "fwd-layernorm":{"total": 10.49, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 110.93, "avg": 0.87, "max": 0.74, "min": 1.50, "cnt": 128}, "fwd-misc":{"total": 22.15, "avg": 0.17, "max": 0.11, "min": 0.39, "cnt": 128}, "fwd-MLP":{"total": 1699.65, "avg": 13.28, "max": 10.75, "min": 20.52, "cnt": 128}, "MoE_L0_fwd":{"total": 515.36, "avg": 16.11, "max": 13.25, "min": 20.42, "cnt": 32}, "MoEMLP":{"total": 1682.03, "avg": 13.14, "max": 10.62, "min": 20.37, "cnt": 128}, "MoE_L1_fwd":{"total": 370.96, "avg": 11.59, "max": 10.67, "min": 14.53, "cnt": 32}, "MoE_L2_fwd":{"total": 392.01, "avg": 12.25, "max": 11.52, "min": 13.63, "cnt": 32}, "MoE_L3_fwd":{"total": 410.18, "avg": 12.82, "max": 12.14, "min": 18.81, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.68, "avg": 0.84, "max": 0.83, "min": 0.85, "cnt": 2}, "forward-send-backward-recv":{"total": 169.66, "avg": 5.66, "max": 1.23, "min": 109.62, "cnt": 30}, "backward-compute":{"total": 1807.85, "avg": 56.50, "max": 54.62, "min": 60.52, "cnt": 32}, "MoE_L3_bwd":{"total": 456.77, "avg": 14.27, "max": 13.11, "min": 15.81, "cnt": 32}, "MoE_L2_bwd":{"total": 395.15, "avg": 12.35, "max": 11.87, "min": 13.07, "cnt": 32}, "MoE_L1_bwd":{"total": 316.81, "avg": 9.90, "max": 9.49, "min": 12.06, "cnt": 32}, "MoE_L0_bwd":{"total": 429.32, "avg": 13.42, "max": 12.37, "min": 17.69, "cnt": 32}, "backward-send-forward-recv":{"total": 2951.55, "avg": 101.78, "max": 2.35, "min": 399.07, "cnt": 29}, "backward-send":{"total": 2.97, "avg": 0.99, "max": 0.81, "min": 1.16, "cnt": 3}, "backward-recv":{"total": 127.59, "avg": 63.79, "max": 59.47, "min": 68.12, "cnt": 2}, "backward-params-all-reduce":{"total": 486.54, "avg": 486.54, "max": 486.54, "min": 486.54, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 246.23, "avg": 246.23, "max": 246.23, "min": 246.23, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 206.16, "avg": 206.16, "max": 206.16, "min": 206.16, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.59, "avg": 3.59, "max": 3.59, "min": 3.59, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 106, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 85.63, "avg": 28.54, "max": 1.21, "min": 80.53, "cnt": 3}, "forward-compute":{"total": 1945.34, "avg": 60.79, "max": 53.01, "min": 65.54, "cnt": 32}, "fwd-compute":{"total": 1942.00, "avg": 60.69, "max": 52.94, "min": 65.41, "cnt": 32}, "batch-generator":{"total": 57.96, "avg": 1.81, "max": 0.67, "min": 4.50, "cnt": 32}, "fwd-embedding":{"total": 0.76, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1870.21, "avg": 58.44, "max": 51.98, "min": 63.34, "cnt": 32}, "fwd-layernorm":{"total": 10.78, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 114.52, "avg": 0.89, "max": 0.74, "min": 2.57, "cnt": 128}, "fwd-misc":{"total": 23.28, "avg": 0.18, "max": 0.11, "min": 0.52, "cnt": 128}, "fwd-MLP":{"total": 1699.03, "avg": 13.27, "max": 10.93, "min": 19.24, "cnt": 128}, "MoE_L0_fwd":{"total": 518.05, "avg": 16.19, "max": 13.15, "min": 18.92, "cnt": 32}, "MoEMLP":{"total": 1680.98, "avg": 13.13, "max": 10.83, "min": 18.84, "cnt": 128}, "MoE_L1_fwd":{"total": 379.39, "avg": 11.86, "max": 10.87, "min": 13.53, "cnt": 32}, "MoE_L2_fwd":{"total": 390.44, "avg": 12.20, "max": 11.35, "min": 12.94, "cnt": 32}, "MoE_L3_fwd":{"total": 399.67, "avg": 12.49, "max": 11.88, "min": 14.43, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.41, "avg": 0.70, "max": 0.63, "min": 0.77, "cnt": 2}, "forward-send-backward-recv":{"total": 173.35, "avg": 5.78, "max": 1.21, "min": 114.00, "cnt": 30}, "backward-compute":{"total": 1807.84, "avg": 56.49, "max": 54.40, "min": 58.60, "cnt": 32}, "MoE_L3_bwd":{"total": 445.16, "avg": 13.91, "max": 12.34, "min": 15.92, "cnt": 32}, "MoE_L2_bwd":{"total": 394.47, "avg": 12.33, "max": 11.93, "min": 12.79, "cnt": 32}, "MoE_L1_bwd":{"total": 323.45, "avg": 10.11, "max": 9.42, "min": 11.52, "cnt": 32}, "MoE_L0_bwd":{"total": 432.89, "avg": 13.53, "max": 13.15, "min": 14.61, "cnt": 32}, "backward-send-forward-recv":{"total": 3889.82, "avg": 134.13, "max": 2.27, "min": 646.25, "cnt": 29}, "backward-send":{"total": 2.95, "avg": 0.98, "max": 0.87, "min": 1.08, "cnt": 3}, "backward-recv":{"total": 126.78, "avg": 63.39, "max": 57.41, "min": 69.37, "cnt": 2}, "backward-params-all-reduce":{"total": 483.29, "avg": 483.29, "max": 483.29, "min": 483.29, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 242.48, "avg": 242.48, "max": 242.48, "min": 242.48, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 202.52, "avg": 202.52, "max": 202.52, "min": 202.52, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.60, "avg": 3.60, "max": 3.60, "min": 3.60, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 107, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 89.83, "avg": 29.94, "max": 1.24, "min": 84.62, "cnt": 3}, "forward-compute":{"total": 1924.59, "avg": 60.14, "max": 53.86, "min": 65.46, "cnt": 32}, "fwd-compute":{"total": 1921.22, "avg": 60.04, "max": 53.79, "min": 65.36, "cnt": 32}, "batch-generator":{"total": 42.43, "avg": 1.33, "max": 0.67, "min": 2.53, "cnt": 32}, "fwd-embedding":{"total": 0.70, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1865.56, "avg": 58.30, "max": 52.77, "min": 63.78, "cnt": 32}, "fwd-layernorm":{"total": 10.32, "avg": 0.08, "max": 0.06, "min": 0.22, "cnt": 128}, "fwd-attn":{"total": 112.52, "avg": 0.88, "max": 0.74, "min": 1.57, "cnt": 128}, "fwd-misc":{"total": 22.38, "avg": 0.17, "max": 0.11, "min": 0.38, "cnt": 128}, "fwd-MLP":{"total": 1698.22, "avg": 13.27, "max": 10.73, "min": 18.92, "cnt": 128}, "MoE_L0_fwd":{"total": 507.47, "avg": 15.86, "max": 12.66, "min": 18.83, "cnt": 32}, "MoEMLP":{"total": 1680.64, "avg": 13.13, "max": 10.62, "min": 18.78, "cnt": 128}, "MoE_L1_fwd":{"total": 384.53, "avg": 12.02, "max": 10.66, "min": 16.30, "cnt": 32}, "MoE_L2_fwd":{"total": 396.92, "avg": 12.40, "max": 11.83, "min": 15.24, "cnt": 32}, "MoE_L3_fwd":{"total": 398.18, "avg": 12.44, "max": 11.87, "min": 15.31, "cnt": 32}, "fwd-pooler":{"total": 0.36, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.80, "avg": 0.90, "max": 0.89, "min": 0.90, "cnt": 2}, "forward-send-backward-recv":{"total": 229.98, "avg": 7.67, "max": 1.58, "min": 108.33, "cnt": 30}, "backward-compute":{"total": 1816.56, "avg": 56.77, "max": 55.26, "min": 59.18, "cnt": 32}, "MoE_L3_bwd":{"total": 449.78, "avg": 14.06, "max": 13.34, "min": 15.74, "cnt": 32}, "MoE_L2_bwd":{"total": 401.36, "avg": 12.54, "max": 12.08, "min": 13.23, "cnt": 32}, "MoE_L1_bwd":{"total": 325.05, "avg": 10.16, "max": 9.65, "min": 11.45, "cnt": 32}, "MoE_L0_bwd":{"total": 430.06, "avg": 13.44, "max": 12.94, "min": 14.06, "cnt": 32}, "backward-send-forward-recv":{"total": 3295.93, "avg": 113.65, "max": 2.29, "min": 771.10, "cnt": 29}, "backward-send":{"total": 3.00, "avg": 1.00, "max": 0.82, "min": 1.09, "cnt": 3}, "backward-recv":{"total": 133.78, "avg": 66.89, "max": 61.75, "min": 72.04, "cnt": 2}, "backward-params-all-reduce":{"total": 486.35, "avg": 486.35, "max": 486.35, "min": 486.35, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 240.58, "avg": 240.58, "max": 240.58, "min": 240.58, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 200.79, "avg": 200.79, "max": 200.79, "min": 200.79, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 108, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 81.66, "avg": 27.22, "max": 1.48, "min": 74.55, "cnt": 3}, "forward-compute":{"total": 1944.70, "avg": 60.77, "max": 55.09, "min": 65.77, "cnt": 32}, "fwd-compute":{"total": 1941.32, "avg": 60.67, "max": 55.02, "min": 65.68, "cnt": 32}, "batch-generator":{"total": 43.99, "avg": 1.37, "max": 0.66, "min": 2.66, "cnt": 32}, "fwd-embedding":{"total": 0.73, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1884.36, "avg": 58.89, "max": 54.06, "min": 63.67, "cnt": 32}, "fwd-layernorm":{"total": 10.62, "avg": 0.08, "max": 0.05, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 113.58, "avg": 0.89, "max": 0.74, "min": 2.05, "cnt": 128}, "fwd-misc":{"total": 22.43, "avg": 0.18, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1715.55, "avg": 13.40, "max": 10.41, "min": 22.04, "cnt": 128}, "MoE_L0_fwd":{"total": 528.62, "avg": 16.52, "max": 13.09, "min": 21.88, "cnt": 32}, "MoEMLP":{"total": 1698.21, "avg": 13.27, "max": 10.30, "min": 21.83, "cnt": 128}, "MoE_L1_fwd":{"total": 368.32, "avg": 11.51, "max": 10.34, "min": 14.10, "cnt": 32}, "MoE_L2_fwd":{"total": 400.10, "avg": 12.50, "max": 11.92, "min": 13.81, "cnt": 32}, "MoE_L3_fwd":{"total": 407.56, "avg": 12.74, "max": 12.10, "min": 15.08, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.61, "avg": 0.80, "max": 0.69, "min": 0.92, "cnt": 2}, "forward-send-backward-recv":{"total": 227.63, "avg": 7.59, "max": 1.36, "min": 117.53, "cnt": 30}, "backward-compute":{"total": 1809.65, "avg": 56.55, "max": 54.70, "min": 58.50, "cnt": 32}, "MoE_L3_bwd":{"total": 452.94, "avg": 14.15, "max": 13.20, "min": 15.86, "cnt": 32}, "MoE_L2_bwd":{"total": 416.18, "avg": 13.01, "max": 12.19, "min": 13.72, "cnt": 32}, "MoE_L1_bwd":{"total": 312.93, "avg": 9.78, "max": 9.25, "min": 10.11, "cnt": 32}, "MoE_L0_bwd":{"total": 420.62, "avg": 13.14, "max": 12.32, "min": 13.72, "cnt": 32}, "backward-send-forward-recv":{"total": 3527.78, "avg": 121.65, "max": 2.32, "min": 554.52, "cnt": 29}, "backward-send":{"total": 3.23, "avg": 1.08, "max": 1.03, "min": 1.11, "cnt": 3}, "backward-recv":{"total": 138.73, "avg": 69.37, "max": 69.06, "min": 69.67, "cnt": 2}, "backward-params-all-reduce":{"total": 488.13, "avg": 488.13, "max": 488.13, "min": 488.13, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 251.06, "avg": 251.06, "max": 251.06, "min": 251.06, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 211.09, "avg": 211.09, "max": 211.09, "min": 211.09, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.52, "avg": 3.52, "max": 3.52, "min": 3.52, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 109, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 78.70, "avg": 26.23, "max": 1.40, "min": 75.88, "cnt": 3}, "forward-compute":{"total": 1913.65, "avg": 59.80, "max": 53.04, "min": 65.08, "cnt": 32}, "fwd-compute":{"total": 1910.40, "avg": 59.70, "max": 52.98, "min": 64.95, "cnt": 32}, "batch-generator":{"total": 41.65, "avg": 1.30, "max": 0.67, "min": 2.36, "cnt": 32}, "fwd-embedding":{"total": 0.65, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1856.38, "avg": 58.01, "max": 52.01, "min": 62.97, "cnt": 32}, "fwd-layernorm":{"total": 9.86, "avg": 0.08, "max": 0.06, "min": 0.18, "cnt": 128}, "fwd-attn":{"total": 109.07, "avg": 0.85, "max": 0.74, "min": 1.78, "cnt": 128}, "fwd-misc":{"total": 20.95, "avg": 0.16, "max": 0.11, "min": 0.54, "cnt": 128}, "fwd-MLP":{"total": 1695.44, "avg": 13.25, "max": 10.44, "min": 18.12, "cnt": 128}, "MoE_L0_fwd":{"total": 501.62, "avg": 15.68, "max": 12.48, "min": 18.03, "cnt": 32}, "MoEMLP":{"total": 1678.90, "avg": 13.12, "max": 10.32, "min": 17.99, "cnt": 128}, "MoE_L1_fwd":{"total": 375.52, "avg": 11.74, "max": 10.37, "min": 15.52, "cnt": 32}, "MoE_L2_fwd":{"total": 407.43, "avg": 12.73, "max": 12.22, "min": 13.44, "cnt": 32}, "MoE_L3_fwd":{"total": 400.47, "avg": 12.51, "max": 11.94, "min": 13.76, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.79, "avg": 0.90, "max": 0.88, "min": 0.91, "cnt": 2}, "forward-send-backward-recv":{"total": 370.80, "avg": 12.36, "max": 1.74, "min": 131.21, "cnt": 30}, "backward-compute":{"total": 1805.06, "avg": 56.41, "max": 54.13, "min": 58.91, "cnt": 32}, "MoE_L3_bwd":{"total": 450.88, "avg": 14.09, "max": 13.41, "min": 15.59, "cnt": 32}, "MoE_L2_bwd":{"total": 426.47, "avg": 13.33, "max": 12.68, "min": 14.82, "cnt": 32}, "MoE_L1_bwd":{"total": 308.59, "avg": 9.64, "max": 9.26, "min": 10.81, "cnt": 32}, "MoE_L0_bwd":{"total": 407.25, "avg": 12.73, "max": 12.04, "min": 13.32, "cnt": 32}, "backward-send-forward-recv":{"total": 2464.06, "avg": 84.97, "max": 2.41, "min": 380.24, "cnt": 29}, "backward-send":{"total": 3.05, "avg": 1.02, "max": 0.61, "min": 1.25, "cnt": 3}, "backward-recv":{"total": 151.48, "avg": 75.74, "max": 69.63, "min": 81.84, "cnt": 2}, "backward-params-all-reduce":{"total": 487.96, "avg": 487.96, "max": 487.96, "min": 487.96, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 250.12, "avg": 250.12, "max": 250.12, "min": 250.12, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 210.26, "avg": 210.26, "max": 210.26, "min": 210.26, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 110, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 75.00, "avg": 25.00, "max": 2.13, "min": 69.72, "cnt": 3}, "forward-compute":{"total": 2150.33, "avg": 67.20, "max": 52.58, "min": 241.14, "cnt": 32}, "fwd-compute":{"total": 2146.93, "avg": 67.09, "max": 52.51, "min": 241.00, "cnt": 32}, "batch-generator":{"total": 42.68, "avg": 1.33, "max": 0.70, "min": 2.91, "cnt": 32}, "fwd-embedding":{"total": 0.65, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 2091.32, "avg": 65.35, "max": 51.51, "min": 238.91, "cnt": 32}, "fwd-layernorm":{"total": 10.29, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 113.03, "avg": 0.88, "max": 0.74, "min": 1.87, "cnt": 128}, "fwd-misc":{"total": 22.24, "avg": 0.17, "max": 0.11, "min": 0.40, "cnt": 128}, "fwd-MLP":{"total": 1923.62, "avg": 15.03, "max": 10.46, "min": 105.39, "cnt": 128}, "MoE_L0_fwd":{"total": 641.72, "avg": 20.05, "max": 11.98, "min": 101.83, "cnt": 32}, "MoEMLP":{"total": 1905.90, "avg": 14.89, "max": 10.34, "min": 105.25, "cnt": 128}, "MoE_L1_fwd":{"total": 466.49, "avg": 14.58, "max": 10.38, "min": 105.31, "cnt": 32}, "MoE_L2_fwd":{"total": 414.62, "avg": 12.96, "max": 12.47, "min": 13.79, "cnt": 32}, "MoE_L3_fwd":{"total": 389.55, "avg": 12.17, "max": 11.49, "min": 14.03, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 2.07, "avg": 1.03, "max": 0.90, "min": 1.17, "cnt": 2}, "forward-send-backward-recv":{"total": 289.51, "avg": 9.65, "max": 1.70, "min": 120.34, "cnt": 30}, "backward-compute":{"total": 1811.46, "avg": 56.61, "max": 54.58, "min": 59.15, "cnt": 32}, "MoE_L3_bwd":{"total": 442.45, "avg": 13.83, "max": 12.30, "min": 14.81, "cnt": 32}, "MoE_L2_bwd":{"total": 446.56, "avg": 13.95, "max": 12.87, "min": 16.26, "cnt": 32}, "MoE_L1_bwd":{"total": 310.94, "avg": 9.72, "max": 9.35, "min": 10.56, "cnt": 32}, "MoE_L0_bwd":{"total": 400.37, "avg": 12.51, "max": 11.67, "min": 13.05, "cnt": 32}, "backward-send-forward-recv":{"total": 3485.87, "avg": 120.20, "max": 2.23, "min": 804.77, "cnt": 29}, "backward-send":{"total": 3.27, "avg": 1.09, "max": 0.97, "min": 1.25, "cnt": 3}, "backward-recv":{"total": 126.14, "avg": 63.07, "max": 53.52, "min": 72.62, "cnt": 2}, "backward-params-all-reduce":{"total": 483.77, "avg": 483.77, "max": 483.77, "min": 483.77, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 248.67, "avg": 248.67, "max": 248.67, "min": 248.67, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 208.59, "avg": 208.59, "max": 208.59, "min": 208.59, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.65, "avg": 3.65, "max": 3.65, "min": 3.65, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 111, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 92.86, "avg": 30.95, "max": 5.43, "min": 79.05, "cnt": 3}, "forward-compute":{"total": 1877.70, "avg": 58.68, "max": 53.66, "min": 65.99, "cnt": 32}, "fwd-compute":{"total": 1874.42, "avg": 58.58, "max": 53.56, "min": 65.84, "cnt": 32}, "batch-generator":{"total": 38.70, "avg": 1.21, "max": 0.68, "min": 2.49, "cnt": 32}, "fwd-embedding":{"total": 0.64, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1823.16, "avg": 56.97, "max": 52.18, "min": 63.71, "cnt": 32}, "fwd-layernorm":{"total": 9.88, "avg": 0.08, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 107.71, "avg": 0.84, "max": 0.74, "min": 1.62, "cnt": 128}, "fwd-misc":{"total": 20.90, "avg": 0.16, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1663.63, "avg": 13.00, "max": 10.33, "min": 21.98, "cnt": 128}, "MoE_L0_fwd":{"total": 491.20, "avg": 15.35, "max": 12.66, "min": 21.83, "cnt": 32}, "MoEMLP":{"total": 1647.02, "avg": 12.87, "max": 10.22, "min": 21.75, "cnt": 128}, "MoE_L1_fwd":{"total": 364.00, "avg": 11.38, "max": 10.26, "min": 16.54, "cnt": 32}, "MoE_L2_fwd":{"total": 411.77, "avg": 12.87, "max": 12.12, "min": 14.45, "cnt": 32}, "MoE_L3_fwd":{"total": 386.24, "avg": 12.07, "max": 11.18, "min": 13.39, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.84, "avg": 0.92, "max": 0.88, "min": 0.95, "cnt": 2}, "forward-send-backward-recv":{"total": 1333.09, "avg": 44.44, "max": 1.92, "min": 166.01, "cnt": 30}, "backward-compute":{"total": 1818.42, "avg": 56.83, "max": 54.43, "min": 59.38, "cnt": 32}, "MoE_L3_bwd":{"total": 457.02, "avg": 14.28, "max": 12.67, "min": 17.21, "cnt": 32}, "MoE_L2_bwd":{"total": 441.64, "avg": 13.80, "max": 13.16, "min": 16.45, "cnt": 32}, "MoE_L1_bwd":{"total": 315.98, "avg": 9.87, "max": 9.36, "min": 11.81, "cnt": 32}, "MoE_L0_bwd":{"total": 389.69, "avg": 12.18, "max": 11.70, "min": 12.93, "cnt": 32}, "backward-send-forward-recv":{"total": 1076.12, "avg": 37.11, "max": 1.77, "min": 161.37, "cnt": 29}, "backward-send":{"total": 2.94, "avg": 0.98, "max": 0.75, "min": 1.15, "cnt": 3}, "backward-recv":{"total": 294.23, "avg": 147.11, "max": 80.33, "min": 213.90, "cnt": 2}, "backward-params-all-reduce":{"total": 484.75, "avg": 484.75, "max": 484.75, "min": 484.75, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 246.75, "avg": 246.75, "max": 246.75, "min": 246.75, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.36, "avg": 3.36, "max": 3.36, "min": 3.36, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 206.87, "avg": 206.87, "max": 206.87, "min": 206.87, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 112, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 86.47, "avg": 28.82, "max": 1.38, "min": 80.43, "cnt": 3}, "forward-compute":{"total": 1919.66, "avg": 59.99, "max": 52.75, "min": 72.79, "cnt": 32}, "fwd-compute":{"total": 1916.60, "avg": 59.89, "max": 52.68, "min": 72.70, "cnt": 32}, "batch-generator":{"total": 38.78, "avg": 1.21, "max": 0.67, "min": 2.51, "cnt": 32}, "fwd-embedding":{"total": 0.60, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1865.23, "avg": 58.29, "max": 51.69, "min": 71.27, "cnt": 32}, "fwd-layernorm":{"total": 9.88, "avg": 0.08, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 109.93, "avg": 0.86, "max": 0.74, "min": 2.78, "cnt": 128}, "fwd-misc":{"total": 21.43, "avg": 0.17, "max": 0.12, "min": 0.49, "cnt": 128}, "fwd-MLP":{"total": 1702.60, "avg": 13.30, "max": 10.46, "min": 21.39, "cnt": 128}, "MoE_L0_fwd":{"total": 512.18, "avg": 16.01, "max": 12.11, "min": 21.30, "cnt": 32}, "MoEMLP":{"total": 1685.48, "avg": 13.17, "max": 10.35, "min": 21.24, "cnt": 128}, "MoE_L1_fwd":{"total": 373.18, "avg": 11.66, "max": 10.39, "min": 14.57, "cnt": 32}, "MoE_L2_fwd":{"total": 426.39, "avg": 13.32, "max": 12.54, "min": 17.68, "cnt": 32}, "MoE_L3_fwd":{"total": 380.03, "avg": 11.88, "max": 11.04, "min": 13.86, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.82, "avg": 0.91, "max": 0.88, "min": 0.94, "cnt": 2}, "forward-send-backward-recv":{"total": 215.26, "avg": 7.18, "max": 1.68, "min": 112.10, "cnt": 30}, "backward-compute":{"total": 1792.81, "avg": 56.03, "max": 53.57, "min": 57.77, "cnt": 32}, "MoE_L3_bwd":{"total": 427.09, "avg": 13.35, "max": 12.01, "min": 15.22, "cnt": 32}, "MoE_L2_bwd":{"total": 443.82, "avg": 13.87, "max": 13.27, "min": 15.56, "cnt": 32}, "MoE_L1_bwd":{"total": 314.86, "avg": 9.84, "max": 9.37, "min": 10.55, "cnt": 32}, "MoE_L0_bwd":{"total": 392.60, "avg": 12.27, "max": 11.65, "min": 14.05, "cnt": 32}, "backward-send-forward-recv":{"total": 3221.19, "avg": 111.08, "max": 1.60, "min": 842.81, "cnt": 29}, "backward-send":{"total": 2.49, "avg": 0.83, "max": 0.64, "min": 1.07, "cnt": 3}, "backward-recv":{"total": 142.68, "avg": 71.34, "max": 70.37, "min": 72.31, "cnt": 2}, "backward-params-all-reduce":{"total": 483.45, "avg": 483.45, "max": 483.45, "min": 483.45, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 249.32, "avg": 249.32, "max": 249.32, "min": 249.32, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.36, "avg": 3.36, "max": 3.36, "min": 3.36, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 209.61, "avg": 209.61, "max": 209.61, "min": 209.61, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.34, "avg": 3.34, "max": 3.34, "min": 3.34, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 113, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 2787.95, "avg": 929.32, "max": 0.72, "min": 2784.98, "cnt": 3}, "forward-compute":{"total": 1927.80, "avg": 60.24, "max": 53.56, "min": 87.47, "cnt": 32}, "fwd-compute":{"total": 1924.70, "avg": 60.15, "max": 53.47, "min": 87.37, "cnt": 32}, "batch-generator":{"total": 53.65, "avg": 1.68, "max": 0.69, "min": 5.64, "cnt": 32}, "fwd-embedding":{"total": 0.68, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1858.55, "avg": 58.08, "max": 52.20, "min": 81.26, "cnt": 32}, "fwd-layernorm":{"total": 10.28, "avg": 0.08, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 111.54, "avg": 0.87, "max": 0.74, "min": 2.57, "cnt": 128}, "fwd-misc":{"total": 21.60, "avg": 0.17, "max": 0.11, "min": 0.41, "cnt": 128}, "fwd-MLP":{"total": 1693.50, "avg": 13.23, "max": 10.78, "min": 38.90, "cnt": 128}, "MoE_L0_fwd":{"total": 511.56, "avg": 15.99, "max": 11.83, "min": 38.76, "cnt": 32}, "MoEMLP":{"total": 1676.50, "avg": 13.10, "max": 10.67, "min": 38.69, "cnt": 128}, "MoE_L1_fwd":{"total": 373.45, "avg": 11.67, "max": 10.71, "min": 14.20, "cnt": 32}, "MoE_L2_fwd":{"total": 413.46, "avg": 12.92, "max": 12.40, "min": 14.86, "cnt": 32}, "MoE_L3_fwd":{"total": 384.33, "avg": 12.01, "max": 10.96, "min": 14.66, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 9.16, "avg": 4.58, "max": 0.91, "min": 8.26, "cnt": 2}, "forward-send-backward-recv":{"total": 197.26, "avg": 6.58, "max": 1.82, "min": 124.12, "cnt": 30}, "backward-compute":{"total": 1783.33, "avg": 55.73, "max": 52.27, "min": 60.07, "cnt": 32}, "MoE_L3_bwd":{"total": 422.64, "avg": 13.21, "max": 11.78, "min": 15.51, "cnt": 32}, "MoE_L2_bwd":{"total": 440.55, "avg": 13.77, "max": 13.13, "min": 17.78, "cnt": 32}, "MoE_L1_bwd":{"total": 313.68, "avg": 9.80, "max": 9.25, "min": 10.01, "cnt": 32}, "MoE_L0_bwd":{"total": 391.58, "avg": 12.24, "max": 11.48, "min": 13.84, "cnt": 32}, "backward-send-forward-recv":{"total": 4879.62, "avg": 168.26, "max": 2.17, "min": 966.70, "cnt": 29}, "backward-send":{"total": 2.96, "avg": 0.99, "max": 0.93, "min": 1.06, "cnt": 3}, "backward-recv":{"total": 133.82, "avg": 66.91, "max": 63.42, "min": 70.40, "cnt": 2}, "backward-params-all-reduce":{"total": 491.06, "avg": 491.06, "max": 491.06, "min": 491.06, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 247.65, "avg": 247.65, "max": 247.65, "min": 247.65, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.36, "avg": 3.36, "max": 3.36, "min": 3.36, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 207.62, "avg": 207.62, "max": 207.62, "min": 207.62, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.66, "avg": 3.66, "max": 3.66, "min": 3.66, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 114, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 959.35, "avg": 319.78, "max": 0.84, "min": 957.33, "cnt": 3}, "forward-compute":{"total": 1944.32, "avg": 60.76, "max": 55.11, "min": 71.81, "cnt": 32}, "fwd-compute":{"total": 1940.88, "avg": 60.65, "max": 55.03, "min": 71.73, "cnt": 32}, "batch-generator":{"total": 42.82, "avg": 1.34, "max": 0.76, "min": 2.03, "cnt": 32}, "fwd-embedding":{"total": 0.71, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1885.08, "avg": 58.91, "max": 53.60, "min": 69.38, "cnt": 32}, "fwd-layernorm":{"total": 10.61, "avg": 0.08, "max": 0.06, "min": 0.18, "cnt": 128}, "fwd-attn":{"total": 114.38, "avg": 0.89, "max": 0.74, "min": 2.49, "cnt": 128}, "fwd-misc":{"total": 22.95, "avg": 0.18, "max": 0.12, "min": 0.52, "cnt": 128}, "fwd-MLP":{"total": 1714.78, "avg": 13.40, "max": 11.05, "min": 23.48, "cnt": 128}, "MoE_L0_fwd":{"total": 525.01, "avg": 16.41, "max": 12.80, "min": 23.34, "cnt": 32}, "MoEMLP":{"total": 1696.96, "avg": 13.26, "max": 10.93, "min": 23.26, "cnt": 128}, "MoE_L1_fwd":{"total": 384.73, "avg": 12.02, "max": 10.98, "min": 14.14, "cnt": 32}, "MoE_L2_fwd":{"total": 413.67, "avg": 12.93, "max": 12.43, "min": 14.22, "cnt": 32}, "MoE_L3_fwd":{"total": 380.19, "avg": 11.88, "max": 11.02, "min": 14.57, "cnt": 32}, "fwd-pooler":{"total": 0.36, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.85, "avg": 0.93, "max": 0.84, "min": 1.01, "cnt": 2}, "forward-send-backward-recv":{"total": 876.54, "avg": 29.22, "max": 1.90, "min": 166.78, "cnt": 30}, "backward-compute":{"total": 1792.93, "avg": 56.03, "max": 53.03, "min": 59.31, "cnt": 32}, "MoE_L3_bwd":{"total": 424.05, "avg": 13.25, "max": 12.31, "min": 15.89, "cnt": 32}, "MoE_L2_bwd":{"total": 429.09, "avg": 13.41, "max": 12.86, "min": 14.26, "cnt": 32}, "MoE_L1_bwd":{"total": 320.88, "avg": 10.03, "max": 9.50, "min": 11.85, "cnt": 32}, "MoE_L0_bwd":{"total": 405.17, "avg": 12.66, "max": 12.15, "min": 12.98, "cnt": 32}, "backward-send-forward-recv":{"total": 2535.95, "avg": 87.45, "max": 1.22, "min": 356.72, "cnt": 29}, "backward-send":{"total": 3.06, "avg": 1.02, "max": 0.96, "min": 1.06, "cnt": 3}, "backward-recv":{"total": 279.58, "avg": 139.79, "max": 123.73, "min": 155.85, "cnt": 2}, "backward-params-all-reduce":{"total": 482.89, "avg": 482.89, "max": 482.89, "min": 482.89, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 247.73, "avg": 247.73, "max": 247.73, "min": 247.73, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.36, "avg": 3.36, "max": 3.36, "min": 3.36, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 208.13, "avg": 208.13, "max": 208.13, "min": 208.13, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.32, "avg": 3.32, "max": 3.32, "min": 3.32, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}}}
{"type":"time", "iteration": 115, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 80.51, "avg": 26.84, "max": 1.28, "min": 76.64, "cnt": 3}, "forward-compute":{"total": 1848.64, "avg": 57.77, "max": 52.21, "min": 63.71, "cnt": 32}, "fwd-compute":{"total": 1845.36, "avg": 57.67, "max": 52.14, "min": 63.56, "cnt": 32}, "batch-generator":{"total": 48.70, "avg": 1.52, "max": 0.65, "min": 3.28, "cnt": 32}, "fwd-embedding":{"total": 0.61, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1783.79, "avg": 55.74, "max": 51.10, "min": 61.67, "cnt": 32}, "fwd-layernorm":{"total": 10.21, "avg": 0.08, "max": 0.06, "min": 0.32, "cnt": 128}, "fwd-attn":{"total": 109.70, "avg": 0.86, "max": 0.74, "min": 2.37, "cnt": 128}, "fwd-misc":{"total": 21.43, "avg": 0.17, "max": 0.11, "min": 0.51, "cnt": 128}, "fwd-MLP":{"total": 1620.73, "avg": 12.66, "max": 10.60, "min": 18.40, "cnt": 128}, "MoE_L0_fwd":{"total": 465.55, "avg": 14.55, "max": 12.13, "min": 18.31, "cnt": 32}, "MoEMLP":{"total": 1603.45, "avg": 12.53, "max": 10.49, "min": 18.26, "cnt": 128}, "MoE_L1_fwd":{"total": 364.03, "avg": 11.38, "max": 10.53, "min": 15.18, "cnt": 32}, "MoE_L2_fwd":{"total": 414.34, "avg": 12.95, "max": 12.31, "min": 16.22, "cnt": 32}, "MoE_L3_fwd":{"total": 365.85, "avg": 11.43, "max": 10.56, "min": 12.39, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 8.71, "avg": 4.36, "max": 0.93, "min": 7.78, "cnt": 2}, "forward-send-backward-recv":{"total": 290.78, "avg": 9.69, "max": 1.57, "min": 127.86, "cnt": 30}, "backward-compute":{"total": 1775.16, "avg": 55.47, "max": 52.76, "min": 59.17, "cnt": 32}, "MoE_L3_bwd":{"total": 412.22, "avg": 12.88, "max": 11.48, "min": 15.27, "cnt": 32}, "MoE_L2_bwd":{"total": 431.40, "avg": 13.48, "max": 12.63, "min": 15.01, "cnt": 32}, "MoE_L1_bwd":{"total": 314.85, "avg": 9.84, "max": 9.37, "min": 10.29, "cnt": 32}, "MoE_L0_bwd":{"total": 400.66, "avg": 12.52, "max": 12.06, "min": 14.67, "cnt": 32}, "backward-send-forward-recv":{"total": 4737.14, "avg": 163.35, "max": 1.81, "min": 1212.54, "cnt": 29}, "backward-send":{"total": 3.43, "avg": 1.14, "max": 1.11, "min": 1.17, "cnt": 3}, "backward-recv":{"total": 247.82, "avg": 123.91, "max": 73.86, "min": 173.96, "cnt": 2}, "backward-params-all-reduce":{"total": 486.53, "avg": 486.53, "max": 486.53, "min": 486.53, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 243.28, "avg": 243.28, "max": 243.28, "min": 243.28, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 203.51, "avg": 203.51, "max": 203.51, "min": 203.51, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.35, "avg": 3.35, "max": 3.35, "min": 3.35, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 116, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.10, "avg": 0.10, "max": 0.10, "min": 0.10, "cnt": 1}, "forward-recv":{"total": 77.99, "avg": 26.00, "max": 1.41, "min": 74.66, "cnt": 3}, "forward-compute":{"total": 1968.91, "avg": 61.53, "max": 52.25, "min": 153.90, "cnt": 32}, "fwd-compute":{"total": 1965.64, "avg": 61.43, "max": 52.18, "min": 153.83, "cnt": 32}, "batch-generator":{"total": 54.80, "avg": 1.71, "max": 0.67, "min": 4.59, "cnt": 32}, "fwd-embedding":{"total": 0.70, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1897.30, "avg": 59.29, "max": 51.14, "min": 150.17, "cnt": 32}, "fwd-layernorm":{"total": 10.06, "avg": 0.08, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 109.77, "avg": 0.86, "max": 0.74, "min": 1.62, "cnt": 128}, "fwd-misc":{"total": 21.09, "avg": 0.16, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1735.07, "avg": 13.56, "max": 10.49, "min": 104.42, "cnt": 128}, "MoE_L0_fwd":{"total": 463.14, "avg": 14.47, "max": 11.97, "min": 16.99, "cnt": 32}, "MoEMLP":{"total": 1718.11, "avg": 13.42, "max": 10.38, "min": 104.30, "cnt": 128}, "MoE_L1_fwd":{"total": 466.09, "avg": 14.57, "max": 10.43, "min": 104.34, "cnt": 32}, "MoE_L2_fwd":{"total": 417.66, "avg": 13.05, "max": 12.55, "min": 14.83, "cnt": 32}, "MoE_L3_fwd":{"total": 377.45, "avg": 11.80, "max": 11.06, "min": 14.65, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 11.62, "avg": 5.81, "max": 0.87, "min": 10.76, "cnt": 2}, "forward-send-backward-recv":{"total": 319.37, "avg": 10.65, "max": 1.40, "min": 124.89, "cnt": 30}, "backward-compute":{"total": 1772.33, "avg": 55.39, "max": 52.80, "min": 58.62, "cnt": 32}, "MoE_L3_bwd":{"total": 413.05, "avg": 12.91, "max": 10.17, "min": 16.27, "cnt": 32}, "MoE_L2_bwd":{"total": 438.90, "avg": 13.72, "max": 12.89, "min": 16.24, "cnt": 32}, "MoE_L1_bwd":{"total": 314.93, "avg": 9.84, "max": 9.19, "min": 12.42, "cnt": 32}, "MoE_L0_bwd":{"total": 389.05, "avg": 12.16, "max": 11.59, "min": 12.86, "cnt": 32}, "backward-send-forward-recv":{"total": 2122.57, "avg": 73.19, "max": 1.77, "min": 369.84, "cnt": 29}, "backward-send":{"total": 2.97, "avg": 0.99, "max": 0.81, "min": 1.24, "cnt": 3}, "backward-recv":{"total": 147.94, "avg": 73.97, "max": 71.22, "min": 76.73, "cnt": 2}, "backward-params-all-reduce":{"total": 485.74, "avg": 485.74, "max": 485.74, "min": 485.74, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 244.85, "avg": 244.85, "max": 244.85, "min": 244.85, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 204.77, "avg": 204.77, "max": 204.77, "min": 204.77, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.58, "avg": 3.58, "max": 3.58, "min": 3.58, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 117, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 98.51, "avg": 32.84, "max": 3.67, "min": 82.53, "cnt": 3}, "forward-compute":{"total": 1852.66, "avg": 57.90, "max": 52.42, "min": 67.19, "cnt": 32}, "fwd-compute":{"total": 1849.48, "avg": 57.80, "max": 52.32, "min": 67.11, "cnt": 32}, "batch-generator":{"total": 38.68, "avg": 1.21, "max": 0.67, "min": 2.41, "cnt": 32}, "fwd-embedding":{"total": 0.57, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1798.36, "avg": 56.20, "max": 50.98, "min": 65.66, "cnt": 32}, "fwd-layernorm":{"total": 9.39, "avg": 0.07, "max": 0.06, "min": 0.18, "cnt": 128}, "fwd-attn":{"total": 106.46, "avg": 0.83, "max": 0.74, "min": 1.54, "cnt": 128}, "fwd-misc":{"total": 20.76, "avg": 0.16, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1640.95, "avg": 12.82, "max": 10.28, "min": 23.69, "cnt": 128}, "MoE_L0_fwd":{"total": 473.17, "avg": 14.79, "max": 11.79, "min": 23.61, "cnt": 32}, "MoEMLP":{"total": 1624.43, "avg": 12.69, "max": 10.16, "min": 23.56, "cnt": 128}, "MoE_L1_fwd":{"total": 366.05, "avg": 11.44, "max": 10.20, "min": 14.46, "cnt": 32}, "MoE_L2_fwd":{"total": 410.19, "avg": 12.82, "max": 12.08, "min": 15.92, "cnt": 32}, "MoE_L3_fwd":{"total": 380.98, "avg": 11.91, "max": 10.99, "min": 14.97, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.94, "avg": 0.97, "max": 0.96, "min": 0.98, "cnt": 2}, "forward-send-backward-recv":{"total": 201.15, "avg": 6.71, "max": 1.41, "min": 116.34, "cnt": 30}, "backward-compute":{"total": 1749.78, "avg": 54.68, "max": 52.44, "min": 57.97, "cnt": 32}, "MoE_L3_bwd":{"total": 400.37, "avg": 12.51, "max": 11.84, "min": 13.54, "cnt": 32}, "MoE_L2_bwd":{"total": 426.15, "avg": 13.32, "max": 12.21, "min": 15.83, "cnt": 32}, "MoE_L1_bwd":{"total": 311.72, "avg": 9.74, "max": 9.02, "min": 10.11, "cnt": 32}, "MoE_L0_bwd":{"total": 395.07, "avg": 12.35, "max": 11.53, "min": 13.02, "cnt": 32}, "backward-send-forward-recv":{"total": 2737.81, "avg": 94.41, "max": 2.48, "min": 355.12, "cnt": 29}, "backward-send":{"total": 3.38, "avg": 1.13, "max": 1.12, "min": 1.15, "cnt": 3}, "backward-recv":{"total": 128.08, "avg": 64.04, "max": 60.55, "min": 67.53, "cnt": 2}, "backward-params-all-reduce":{"total": 485.43, "avg": 485.43, "max": 485.43, "min": 485.43, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 246.04, "avg": 246.04, "max": 246.04, "min": 246.04, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.48, "avg": 3.48, "max": 3.48, "min": 3.48, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 206.11, "avg": 206.11, "max": 206.11, "min": 206.11, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.30, "avg": 3.30, "max": 3.30, "min": 3.30, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.47, "avg": 3.47, "max": 3.47, "min": 3.47, "cnt": 1}}}
{"type":"time", "iteration": 118, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 86.15, "avg": 28.72, "max": 0.89, "min": 78.05, "cnt": 3}, "forward-compute":{"total": 1886.15, "avg": 58.94, "max": 53.96, "min": 65.23, "cnt": 32}, "fwd-compute":{"total": 1883.04, "avg": 58.84, "max": 53.88, "min": 65.10, "cnt": 32}, "batch-generator":{"total": 38.88, "avg": 1.21, "max": 0.71, "min": 2.70, "cnt": 32}, "fwd-embedding":{"total": 0.59, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1831.84, "avg": 57.24, "max": 52.22, "min": 62.05, "cnt": 32}, "fwd-layernorm":{"total": 9.61, "avg": 0.08, "max": 0.06, "min": 0.18, "cnt": 128}, "fwd-attn":{"total": 108.46, "avg": 0.85, "max": 0.74, "min": 1.74, "cnt": 128}, "fwd-misc":{"total": 20.86, "avg": 0.16, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1671.89, "avg": 13.06, "max": 10.76, "min": 18.90, "cnt": 128}, "MoE_L0_fwd":{"total": 495.73, "avg": 15.49, "max": 12.55, "min": 18.80, "cnt": 32}, "MoEMLP":{"total": 1655.06, "avg": 12.93, "max": 10.65, "min": 18.75, "cnt": 128}, "MoE_L1_fwd":{"total": 382.55, "avg": 11.95, "max": 10.75, "min": 15.01, "cnt": 32}, "MoE_L2_fwd":{"total": 411.47, "avg": 12.86, "max": 12.08, "min": 14.32, "cnt": 32}, "MoE_L3_fwd":{"total": 371.47, "avg": 11.61, "max": 10.69, "min": 16.17, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 2.77, "avg": 1.38, "max": 0.90, "min": 1.86, "cnt": 2}, "forward-send-backward-recv":{"total": 531.48, "avg": 17.72, "max": 1.21, "min": 119.17, "cnt": 30}, "backward-compute":{"total": 1756.38, "avg": 54.89, "max": 52.77, "min": 57.48, "cnt": 32}, "MoE_L3_bwd":{"total": 395.09, "avg": 12.35, "max": 11.28, "min": 14.85, "cnt": 32}, "MoE_L2_bwd":{"total": 427.38, "avg": 13.36, "max": 12.80, "min": 14.26, "cnt": 32}, "MoE_L1_bwd":{"total": 318.57, "avg": 9.96, "max": 9.46, "min": 11.72, "cnt": 32}, "MoE_L0_bwd":{"total": 402.14, "avg": 12.57, "max": 12.05, "min": 13.68, "cnt": 32}, "backward-send-forward-recv":{"total": 2617.88, "avg": 90.27, "max": 2.25, "min": 716.28, "cnt": 29}, "backward-send":{"total": 3.06, "avg": 1.02, "max": 0.72, "min": 1.17, "cnt": 3}, "backward-recv":{"total": 132.18, "avg": 66.09, "max": 66.01, "min": 66.17, "cnt": 2}, "backward-params-all-reduce":{"total": 487.68, "avg": 487.68, "max": 487.68, "min": 487.68, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 247.78, "avg": 247.78, "max": 247.78, "min": 247.78, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 207.96, "avg": 207.96, "max": 207.96, "min": 207.96, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.33, "avg": 3.33, "max": 3.33, "min": 3.33, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.49, "avg": 3.49, "max": 3.49, "min": 3.49, "cnt": 1}}}
{"type":"time", "iteration": 119, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 83.79, "avg": 27.93, "max": 1.33, "min": 78.02, "cnt": 3}, "forward-compute":{"total": 1926.31, "avg": 60.20, "max": 55.59, "min": 66.61, "cnt": 32}, "fwd-compute":{"total": 1923.20, "avg": 60.10, "max": 55.52, "min": 66.53, "cnt": 32}, "batch-generator":{"total": 45.44, "avg": 1.42, "max": 0.65, "min": 2.80, "cnt": 32}, "fwd-embedding":{"total": 0.67, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1864.96, "avg": 58.28, "max": 54.42, "min": 63.65, "cnt": 32}, "fwd-layernorm":{"total": 10.16, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 109.10, "avg": 0.85, "max": 0.74, "min": 2.09, "cnt": 128}, "fwd-misc":{"total": 21.49, "avg": 0.17, "max": 0.11, "min": 0.55, "cnt": 128}, "fwd-MLP":{"total": 1702.88, "avg": 13.30, "max": 10.99, "min": 18.96, "cnt": 128}, "MoE_L0_fwd":{"total": 501.17, "avg": 15.66, "max": 12.95, "min": 18.88, "cnt": 32}, "MoEMLP":{"total": 1686.04, "avg": 13.17, "max": 10.81, "min": 18.83, "cnt": 128}, "MoE_L1_fwd":{"total": 383.71, "avg": 11.99, "max": 10.88, "min": 15.20, "cnt": 32}, "MoE_L2_fwd":{"total": 426.81, "avg": 13.34, "max": 12.59, "min": 15.70, "cnt": 32}, "MoE_L3_fwd":{"total": 380.63, "avg": 11.89, "max": 10.93, "min": 17.13, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.56, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.55, "avg": 0.77, "max": 0.76, "min": 0.79, "cnt": 2}, "forward-send-backward-recv":{"total": 214.34, "avg": 7.14, "max": 1.46, "min": 115.71, "cnt": 30}, "backward-compute":{"total": 1789.11, "avg": 55.91, "max": 52.81, "min": 58.24, "cnt": 32}, "MoE_L3_bwd":{"total": 406.59, "avg": 12.71, "max": 12.02, "min": 14.87, "cnt": 32}, "MoE_L2_bwd":{"total": 437.04, "avg": 13.66, "max": 13.04, "min": 14.64, "cnt": 32}, "MoE_L1_bwd":{"total": 318.38, "avg": 9.95, "max": 9.46, "min": 10.71, "cnt": 32}, "MoE_L0_bwd":{"total": 410.35, "avg": 12.82, "max": 12.15, "min": 13.99, "cnt": 32}, "backward-send-forward-recv":{"total": 3544.08, "avg": 122.21, "max": 1.99, "min": 541.12, "cnt": 29}, "backward-send":{"total": 3.02, "avg": 1.01, "max": 0.89, "min": 1.16, "cnt": 3}, "backward-recv":{"total": 148.11, "avg": 74.06, "max": 68.94, "min": 79.17, "cnt": 2}, "backward-params-all-reduce":{"total": 485.95, "avg": 485.95, "max": 485.95, "min": 485.95, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 247.00, "avg": 247.00, "max": 247.00, "min": 247.00, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 206.68, "avg": 206.68, "max": 206.68, "min": 206.68, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.85, "avg": 3.85, "max": 3.85, "min": 3.85, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 120, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 85.32, "avg": 28.44, "max": 2.16, "min": 78.20, "cnt": 3}, "forward-compute":{"total": 1928.68, "avg": 60.27, "max": 53.75, "min": 66.59, "cnt": 32}, "fwd-compute":{"total": 1925.26, "avg": 60.16, "max": 53.68, "min": 66.51, "cnt": 32}, "batch-generator":{"total": 41.15, "avg": 1.29, "max": 0.69, "min": 2.25, "cnt": 32}, "fwd-embedding":{"total": 0.70, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1870.69, "avg": 58.46, "max": 52.61, "min": 64.16, "cnt": 32}, "fwd-layernorm":{"total": 10.42, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 111.62, "avg": 0.87, "max": 0.74, "min": 2.48, "cnt": 128}, "fwd-misc":{"total": 22.04, "avg": 0.17, "max": 0.11, "min": 0.39, "cnt": 128}, "fwd-MLP":{"total": 1704.68, "avg": 13.32, "max": 11.15, "min": 19.49, "cnt": 128}, "MoE_L0_fwd":{"total": 495.27, "avg": 15.48, "max": 12.24, "min": 19.40, "cnt": 32}, "MoEMLP":{"total": 1687.05, "avg": 13.18, "max": 11.03, "min": 19.34, "cnt": 128}, "MoE_L1_fwd":{"total": 381.48, "avg": 11.92, "max": 11.07, "min": 14.48, "cnt": 32}, "MoE_L2_fwd":{"total": 427.49, "avg": 13.36, "max": 12.75, "min": 14.08, "cnt": 32}, "MoE_L3_fwd":{"total": 389.25, "avg": 12.16, "max": 11.14, "min": 15.22, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 3.23, "avg": 1.62, "max": 0.96, "min": 2.27, "cnt": 2}, "forward-send-backward-recv":{"total": 958.83, "avg": 31.96, "max": 1.69, "min": 246.70, "cnt": 30}, "backward-compute":{"total": 1815.05, "avg": 56.72, "max": 54.70, "min": 58.52, "cnt": 32}, "MoE_L3_bwd":{"total": 411.13, "avg": 12.85, "max": 11.92, "min": 14.65, "cnt": 32}, "MoE_L2_bwd":{"total": 448.12, "avg": 14.00, "max": 13.30, "min": 16.15, "cnt": 32}, "MoE_L1_bwd":{"total": 327.70, "avg": 10.24, "max": 9.84, "min": 11.12, "cnt": 32}, "MoE_L0_bwd":{"total": 415.25, "avg": 12.98, "max": 12.44, "min": 13.68, "cnt": 32}, "backward-send-forward-recv":{"total": 1333.42, "avg": 45.98, "max": 1.59, "min": 185.49, "cnt": 29}, "backward-send":{"total": 3.21, "avg": 1.07, "max": 0.97, "min": 1.13, "cnt": 3}, "backward-recv":{"total": 245.94, "avg": 122.97, "max": 67.91, "min": 178.03, "cnt": 2}, "backward-params-all-reduce":{"total": 487.19, "avg": 487.19, "max": 487.19, "min": 487.19, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 245.61, "avg": 245.61, "max": 245.61, "min": 245.61, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 205.67, "avg": 205.67, "max": 205.67, "min": 205.67, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.29, "avg": 3.29, "max": 3.29, "min": 3.29, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.50, "avg": 3.50, "max": 3.50, "min": 3.50, "cnt": 1}}}
{"type":"time", "iteration": 121, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 91.49, "avg": 30.50, "max": 1.36, "min": 78.14, "cnt": 3}, "forward-compute":{"total": 1983.98, "avg": 62.00, "max": 55.05, "min": 68.59, "cnt": 32}, "fwd-compute":{"total": 1980.52, "avg": 61.89, "max": 54.98, "min": 68.46, "cnt": 32}, "batch-generator":{"total": 44.69, "avg": 1.40, "max": 0.70, "min": 3.65, "cnt": 32}, "fwd-embedding":{"total": 0.72, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1922.23, "avg": 60.07, "max": 53.96, "min": 66.37, "cnt": 32}, "fwd-layernorm":{"total": 10.49, "avg": 0.08, "max": 0.06, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 112.48, "avg": 0.88, "max": 0.74, "min": 2.01, "cnt": 128}, "fwd-misc":{"total": 22.30, "avg": 0.17, "max": 0.12, "min": 0.55, "cnt": 128}, "fwd-MLP":{"total": 1754.79, "avg": 13.71, "max": 11.28, "min": 18.62, "cnt": 128}, "MoE_L0_fwd":{"total": 507.23, "avg": 15.85, "max": 12.21, "min": 17.91, "cnt": 32}, "MoEMLP":{"total": 1737.08, "avg": 13.57, "max": 11.17, "min": 18.51, "cnt": 128}, "MoE_L1_fwd":{"total": 405.50, "avg": 12.67, "max": 11.32, "min": 17.16, "cnt": 32}, "MoE_L2_fwd":{"total": 433.62, "avg": 13.55, "max": 12.54, "min": 18.55, "cnt": 32}, "MoE_L3_fwd":{"total": 397.23, "avg": 12.41, "max": 11.21, "min": 16.77, "cnt": 32}, "fwd-pooler":{"total": 0.36, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.78, "avg": 0.89, "max": 0.84, "min": 0.94, "cnt": 2}, "forward-send-backward-recv":{"total": 730.06, "avg": 24.34, "max": 1.29, "min": 124.23, "cnt": 30}, "backward-compute":{"total": 1832.93, "avg": 57.28, "max": 54.25, "min": 59.33, "cnt": 32}, "MoE_L3_bwd":{"total": 420.80, "avg": 13.15, "max": 11.97, "min": 14.74, "cnt": 32}, "MoE_L2_bwd":{"total": 436.19, "avg": 13.63, "max": 12.88, "min": 14.62, "cnt": 32}, "MoE_L1_bwd":{"total": 332.74, "avg": 10.40, "max": 9.94, "min": 11.90, "cnt": 32}, "MoE_L0_bwd":{"total": 426.91, "avg": 13.34, "max": 12.64, "min": 14.37, "cnt": 32}, "backward-send-forward-recv":{"total": 1615.04, "avg": 55.69, "max": 1.31, "min": 255.61, "cnt": 29}, "backward-send":{"total": 3.26, "avg": 1.09, "max": 1.03, "min": 1.14, "cnt": 3}, "backward-recv":{"total": 280.99, "avg": 140.49, "max": 67.57, "min": 213.42, "cnt": 2}, "backward-params-all-reduce":{"total": 483.13, "avg": 483.13, "max": 483.13, "min": 483.13, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 248.64, "avg": 248.64, "max": 248.64, "min": 248.64, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 208.82, "avg": 208.82, "max": 208.82, "min": 208.82, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.31, "avg": 3.31, "max": 3.31, "min": 3.31, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 122, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 85.14, "avg": 28.38, "max": 1.45, "min": 75.19, "cnt": 3}, "forward-compute":{"total": 1934.36, "avg": 60.45, "max": 55.34, "min": 67.35, "cnt": 32}, "fwd-compute":{"total": 1930.90, "avg": 60.34, "max": 55.27, "min": 67.25, "cnt": 32}, "batch-generator":{"total": 44.03, "avg": 1.38, "max": 0.68, "min": 2.31, "cnt": 32}, "fwd-embedding":{"total": 0.70, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1873.53, "avg": 58.55, "max": 54.15, "min": 66.00, "cnt": 32}, "fwd-layernorm":{"total": 10.47, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 112.25, "avg": 0.88, "max": 0.74, "min": 2.55, "cnt": 128}, "fwd-misc":{"total": 22.12, "avg": 0.17, "max": 0.11, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1706.38, "avg": 13.33, "max": 11.19, "min": 18.75, "cnt": 128}, "MoE_L0_fwd":{"total": 493.82, "avg": 15.43, "max": 12.48, "min": 18.67, "cnt": 32}, "MoEMLP":{"total": 1688.50, "avg": 13.19, "max": 11.05, "min": 18.62, "cnt": 128}, "MoE_L1_fwd":{"total": 391.32, "avg": 12.23, "max": 11.10, "min": 15.18, "cnt": 32}, "MoE_L2_fwd":{"total": 420.08, "avg": 13.13, "max": 12.20, "min": 14.31, "cnt": 32}, "MoE_L3_fwd":{"total": 389.81, "avg": 12.18, "max": 11.45, "min": 12.89, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.87, "avg": 0.94, "max": 0.92, "min": 0.95, "cnt": 2}, "forward-send-backward-recv":{"total": 293.32, "avg": 9.78, "max": 1.63, "min": 112.03, "cnt": 30}, "backward-compute":{"total": 1825.13, "avg": 57.04, "max": 55.90, "min": 58.03, "cnt": 32}, "MoE_L3_bwd":{"total": 420.93, "avg": 13.15, "max": 12.00, "min": 14.58, "cnt": 32}, "MoE_L2_bwd":{"total": 432.28, "avg": 13.51, "max": 12.31, "min": 14.52, "cnt": 32}, "MoE_L1_bwd":{"total": 334.57, "avg": 10.46, "max": 9.71, "min": 10.95, "cnt": 32}, "MoE_L0_bwd":{"total": 423.78, "avg": 13.24, "max": 12.79, "min": 13.57, "cnt": 32}, "backward-send-forward-recv":{"total": 2168.61, "avg": 74.78, "max": 2.36, "min": 265.57, "cnt": 29}, "backward-send":{"total": 3.16, "avg": 1.05, "max": 0.99, "min": 1.09, "cnt": 3}, "backward-recv":{"total": 436.82, "avg": 218.41, "max": 64.71, "min": 372.12, "cnt": 2}, "backward-params-all-reduce":{"total": 484.33, "avg": 484.33, "max": 484.33, "min": 484.33, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 251.32, "avg": 251.32, "max": 251.32, "min": 251.32, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 211.45, "avg": 211.45, "max": 211.45, "min": 211.45, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 123, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 80.71, "avg": 26.90, "max": 0.72, "min": 76.14, "cnt": 3}, "forward-compute":{"total": 1925.81, "avg": 60.18, "max": 56.38, "min": 66.70, "cnt": 32}, "fwd-compute":{"total": 1922.72, "avg": 60.09, "max": 56.31, "min": 66.61, "cnt": 32}, "batch-generator":{"total": 37.06, "avg": 1.16, "max": 0.69, "min": 2.10, "cnt": 32}, "fwd-embedding":{"total": 0.58, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1873.30, "avg": 58.54, "max": 55.20, "min": 64.75, "cnt": 32}, "fwd-layernorm":{"total": 9.40, "avg": 0.07, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 108.81, "avg": 0.85, "max": 0.74, "min": 2.50, "cnt": 128}, "fwd-misc":{"total": 21.05, "avg": 0.16, "max": 0.12, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1713.28, "avg": 13.38, "max": 11.07, "min": 19.47, "cnt": 128}, "MoE_L0_fwd":{"total": 493.66, "avg": 15.43, "max": 13.05, "min": 19.31, "cnt": 32}, "MoEMLP":{"total": 1696.58, "avg": 13.25, "max": 10.96, "min": 19.18, "cnt": 128}, "MoE_L1_fwd":{"total": 391.76, "avg": 12.24, "max": 11.00, "min": 15.20, "cnt": 32}, "MoE_L2_fwd":{"total": 423.14, "avg": 13.22, "max": 12.60, "min": 14.72, "cnt": 32}, "MoE_L3_fwd":{"total": 394.21, "avg": 12.32, "max": 11.72, "min": 13.12, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 4.58, "avg": 2.29, "max": 0.95, "min": 3.64, "cnt": 2}, "forward-send-backward-recv":{"total": 373.64, "avg": 12.45, "max": 1.77, "min": 129.23, "cnt": 30}, "backward-compute":{"total": 1847.23, "avg": 57.73, "max": 55.75, "min": 59.54, "cnt": 32}, "MoE_L3_bwd":{"total": 430.66, "avg": 13.46, "max": 12.29, "min": 14.54, "cnt": 32}, "MoE_L2_bwd":{"total": 437.37, "avg": 13.67, "max": 12.60, "min": 14.90, "cnt": 32}, "MoE_L1_bwd":{"total": 341.92, "avg": 10.68, "max": 10.31, "min": 11.97, "cnt": 32}, "MoE_L0_bwd":{"total": 422.30, "avg": 13.20, "max": 12.56, "min": 13.95, "cnt": 32}, "backward-send-forward-recv":{"total": 2409.59, "avg": 83.09, "max": 1.04, "min": 550.31, "cnt": 29}, "backward-send":{"total": 3.36, "avg": 1.12, "max": 1.10, "min": 1.16, "cnt": 3}, "backward-recv":{"total": 167.71, "avg": 83.85, "max": 77.74, "min": 89.97, "cnt": 2}, "backward-params-all-reduce":{"total": 486.79, "avg": 486.79, "max": 486.79, "min": 486.79, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 249.19, "avg": 249.19, "max": 249.19, "min": 249.19, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 209.34, "avg": 209.34, "max": 209.34, "min": 209.34, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 124, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 77.86, "avg": 25.95, "max": 2.14, "min": 73.44, "cnt": 3}, "forward-compute":{"total": 1976.63, "avg": 61.77, "max": 55.35, "min": 70.88, "cnt": 32}, "fwd-compute":{"total": 1973.12, "avg": 61.66, "max": 55.27, "min": 70.80, "cnt": 32}, "batch-generator":{"total": 42.44, "avg": 1.33, "max": 0.67, "min": 1.78, "cnt": 32}, "fwd-embedding":{"total": 0.73, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1917.32, "avg": 59.92, "max": 54.22, "min": 69.56, "cnt": 32}, "fwd-layernorm":{"total": 10.65, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 111.28, "avg": 0.87, "max": 0.74, "min": 1.52, "cnt": 128}, "fwd-misc":{"total": 22.52, "avg": 0.18, "max": 0.11, "min": 0.57, "cnt": 128}, "fwd-MLP":{"total": 1750.50, "avg": 13.68, "max": 11.27, "min": 27.37, "cnt": 128}, "MoE_L0_fwd":{"total": 517.85, "avg": 16.18, "max": 12.61, "min": 27.27, "cnt": 32}, "MoEMLP":{"total": 1732.81, "avg": 13.54, "max": 11.15, "min": 27.21, "cnt": 128}, "MoE_L1_fwd":{"total": 392.75, "avg": 12.27, "max": 11.19, "min": 13.58, "cnt": 32}, "MoE_L2_fwd":{"total": 423.20, "avg": 13.23, "max": 12.70, "min": 14.48, "cnt": 32}, "MoE_L3_fwd":{"total": 405.54, "avg": 12.67, "max": 11.66, "min": 17.79, "cnt": 32}, "fwd-pooler":{"total": 0.37, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.83, "avg": 0.91, "max": 0.89, "min": 0.94, "cnt": 2}, "forward-send-backward-recv":{"total": 766.02, "avg": 25.53, "max": 1.13, "min": 182.83, "cnt": 30}, "backward-compute":{"total": 1867.18, "avg": 58.35, "max": 55.74, "min": 61.74, "cnt": 32}, "MoE_L3_bwd":{"total": 439.16, "avg": 13.72, "max": 12.37, "min": 16.56, "cnt": 32}, "MoE_L2_bwd":{"total": 443.72, "avg": 13.87, "max": 13.03, "min": 14.87, "cnt": 32}, "MoE_L1_bwd":{"total": 345.05, "avg": 10.78, "max": 10.05, "min": 11.92, "cnt": 32}, "MoE_L0_bwd":{"total": 426.96, "avg": 13.34, "max": 12.88, "min": 13.83, "cnt": 32}, "backward-send-forward-recv":{"total": 2290.14, "avg": 78.97, "max": 1.11, "min": 400.10, "cnt": 29}, "backward-send":{"total": 2.87, "avg": 0.96, "max": 0.94, "min": 0.97, "cnt": 3}, "backward-recv":{"total": 413.08, "avg": 206.54, "max": 145.02, "min": 268.07, "cnt": 2}, "backward-params-all-reduce":{"total": 484.87, "avg": 484.87, "max": 484.87, "min": 484.87, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 246.80, "avg": 246.80, "max": 246.80, "min": 246.80, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 206.78, "avg": 206.78, "max": 206.78, "min": 206.78, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.56, "avg": 3.56, "max": 3.56, "min": 3.56, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 125, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 82.55, "avg": 27.52, "max": 1.19, "min": 78.74, "cnt": 3}, "forward-compute":{"total": 2172.84, "avg": 67.90, "max": 54.91, "min": 242.03, "cnt": 32}, "fwd-compute":{"total": 2169.89, "avg": 67.81, "max": 54.84, "min": 241.92, "cnt": 32}, "batch-generator":{"total": 33.95, "avg": 1.06, "max": 0.73, "min": 1.68, "cnt": 32}, "fwd-embedding":{"total": 0.48, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 2123.33, "avg": 66.35, "max": 53.59, "min": 240.30, "cnt": 32}, "fwd-layernorm":{"total": 9.26, "avg": 0.07, "max": 0.06, "min": 0.18, "cnt": 128}, "fwd-attn":{"total": 107.63, "avg": 0.84, "max": 0.74, "min": 2.86, "cnt": 128}, "fwd-misc":{"total": 20.40, "avg": 0.16, "max": 0.11, "min": 0.39, "cnt": 128}, "fwd-MLP":{"total": 1964.59, "avg": 15.35, "max": 11.45, "min": 193.69, "cnt": 128}, "MoE_L0_fwd":{"total": 558.39, "avg": 17.45, "max": 12.17, "min": 91.30, "cnt": 32}, "MoEMLP":{"total": 1947.63, "avg": 15.22, "max": 11.34, "min": 193.54, "cnt": 128}, "MoE_L1_fwd":{"total": 391.72, "avg": 12.24, "max": 11.38, "min": 15.17, "cnt": 32}, "MoE_L2_fwd":{"total": 611.46, "avg": 19.11, "max": 12.75, "min": 193.61, "cnt": 32}, "MoE_L3_fwd":{"total": 392.17, "avg": 12.26, "max": 11.73, "min": 12.98, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 3.43, "avg": 1.71, "max": 0.97, "min": 2.45, "cnt": 2}, "forward-send-backward-recv":{"total": 198.38, "avg": 6.61, "max": 1.42, "min": 125.65, "cnt": 30}, "backward-compute":{"total": 1857.83, "avg": 58.06, "max": 56.32, "min": 61.91, "cnt": 32}, "MoE_L3_bwd":{"total": 430.08, "avg": 13.44, "max": 11.69, "min": 14.59, "cnt": 32}, "MoE_L2_bwd":{"total": 444.33, "avg": 13.89, "max": 13.27, "min": 17.12, "cnt": 32}, "MoE_L1_bwd":{"total": 339.33, "avg": 10.60, "max": 10.27, "min": 11.24, "cnt": 32}, "MoE_L0_bwd":{"total": 427.79, "avg": 13.37, "max": 12.90, "min": 13.81, "cnt": 32}, "backward-send-forward-recv":{"total": 3728.72, "avg": 128.58, "max": 1.40, "min": 1015.37, "cnt": 29}, "backward-send":{"total": 2.63, "avg": 0.88, "max": 0.74, "min": 1.06, "cnt": 3}, "backward-recv":{"total": 359.80, "avg": 179.90, "max": 55.52, "min": 304.28, "cnt": 2}, "backward-params-all-reduce":{"total": 488.86, "avg": 488.86, "max": 488.86, "min": 488.86, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 243.76, "avg": 243.76, "max": 243.76, "min": 243.76, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 203.85, "avg": 203.85, "max": 203.85, "min": 203.85, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.48, "avg": 3.48, "max": 3.48, "min": 3.48, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}}}
{"type":"time", "iteration": 126, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 90.12, "avg": 30.04, "max": 2.35, "min": 80.46, "cnt": 3}, "forward-compute":{"total": 1957.64, "avg": 61.18, "max": 54.51, "min": 73.89, "cnt": 32}, "fwd-compute":{"total": 1954.74, "avg": 61.09, "max": 54.44, "min": 73.81, "cnt": 32}, "batch-generator":{"total": 39.50, "avg": 1.23, "max": 0.67, "min": 2.39, "cnt": 32}, "fwd-embedding":{"total": 0.56, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1903.35, "avg": 59.48, "max": 53.46, "min": 71.92, "cnt": 32}, "fwd-layernorm":{"total": 9.22, "avg": 0.07, "max": 0.06, "min": 0.26, "cnt": 128}, "fwd-attn":{"total": 107.86, "avg": 0.84, "max": 0.74, "min": 2.95, "cnt": 128}, "fwd-misc":{"total": 20.48, "avg": 0.16, "max": 0.11, "min": 0.59, "cnt": 128}, "fwd-MLP":{"total": 1745.52, "avg": 13.64, "max": 11.22, "min": 24.08, "cnt": 128}, "MoE_L0_fwd":{"total": 502.76, "avg": 15.71, "max": 12.99, "min": 21.33, "cnt": 32}, "MoEMLP":{"total": 1728.91, "avg": 13.51, "max": 11.11, "min": 23.98, "cnt": 128}, "MoE_L1_fwd":{"total": 401.09, "avg": 12.53, "max": 11.15, "min": 14.47, "cnt": 32}, "MoE_L2_fwd":{"total": 423.51, "avg": 13.23, "max": 12.57, "min": 16.05, "cnt": 32}, "MoE_L3_fwd":{"total": 407.62, "avg": 12.74, "max": 11.47, "min": 24.02, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.86, "avg": 0.93, "max": 0.92, "min": 0.94, "cnt": 2}, "forward-send-backward-recv":{"total": 192.85, "avg": 6.43, "max": 1.43, "min": 118.69, "cnt": 30}, "backward-compute":{"total": 1859.64, "avg": 58.11, "max": 55.41, "min": 60.11, "cnt": 32}, "MoE_L3_bwd":{"total": 428.21, "avg": 13.38, "max": 12.01, "min": 15.46, "cnt": 32}, "MoE_L2_bwd":{"total": 427.98, "avg": 13.37, "max": 12.63, "min": 15.22, "cnt": 32}, "MoE_L1_bwd":{"total": 347.15, "avg": 10.85, "max": 10.40, "min": 11.66, "cnt": 32}, "MoE_L0_bwd":{"total": 440.66, "avg": 13.77, "max": 13.14, "min": 16.24, "cnt": 32}, "backward-send-forward-recv":{"total": 3119.73, "avg": 107.58, "max": 1.37, "min": 827.52, "cnt": 29}, "backward-send":{"total": 3.44, "avg": 1.15, "max": 1.11, "min": 1.19, "cnt": 3}, "backward-recv":{"total": 139.84, "avg": 69.92, "max": 67.09, "min": 72.75, "cnt": 2}, "backward-params-all-reduce":{"total": 490.62, "avg": 490.62, "max": 490.62, "min": 490.62, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 247.57, "avg": 247.57, "max": 247.57, "min": 247.57, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.36, "avg": 3.36, "max": 3.36, "min": 3.36, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 207.70, "avg": 207.70, "max": 207.70, "min": 207.70, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 127, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 89.34, "avg": 29.78, "max": 2.43, "min": 79.07, "cnt": 3}, "forward-compute":{"total": 1944.56, "avg": 60.77, "max": 55.13, "min": 66.86, "cnt": 32}, "fwd-compute":{"total": 1941.35, "avg": 60.67, "max": 55.06, "min": 66.78, "cnt": 32}, "batch-generator":{"total": 38.88, "avg": 1.21, "max": 0.69, "min": 2.42, "cnt": 32}, "fwd-embedding":{"total": 0.63, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1889.64, "avg": 59.05, "max": 54.05, "min": 64.77, "cnt": 32}, "fwd-layernorm":{"total": 9.76, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 108.74, "avg": 0.85, "max": 0.74, "min": 2.48, "cnt": 128}, "fwd-misc":{"total": 21.58, "avg": 0.17, "max": 0.11, "min": 0.38, "cnt": 128}, "fwd-MLP":{"total": 1728.37, "avg": 13.50, "max": 11.47, "min": 20.71, "cnt": 128}, "MoE_L0_fwd":{"total": 494.71, "avg": 15.46, "max": 12.66, "min": 20.59, "cnt": 32}, "MoEMLP":{"total": 1711.51, "avg": 13.37, "max": 11.35, "min": 20.52, "cnt": 128}, "MoE_L1_fwd":{"total": 399.42, "avg": 12.48, "max": 11.39, "min": 13.45, "cnt": 32}, "MoE_L2_fwd":{"total": 429.84, "avg": 13.43, "max": 12.99, "min": 14.51, "cnt": 32}, "MoE_L3_fwd":{"total": 393.76, "avg": 12.31, "max": 11.71, "min": 13.40, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.91, "avg": 0.96, "max": 0.95, "min": 0.96, "cnt": 2}, "forward-send-backward-recv":{"total": 214.95, "avg": 7.16, "max": 1.33, "min": 116.36, "cnt": 30}, "backward-compute":{"total": 1872.12, "avg": 58.50, "max": 56.61, "min": 61.26, "cnt": 32}, "MoE_L3_bwd":{"total": 431.87, "avg": 13.50, "max": 12.86, "min": 14.81, "cnt": 32}, "MoE_L2_bwd":{"total": 444.35, "avg": 13.89, "max": 12.98, "min": 14.53, "cnt": 32}, "MoE_L1_bwd":{"total": 341.69, "avg": 10.68, "max": 10.32, "min": 11.72, "cnt": 32}, "MoE_L0_bwd":{"total": 439.18, "avg": 13.72, "max": 13.06, "min": 14.18, "cnt": 32}, "backward-send-forward-recv":{"total": 2005.62, "avg": 69.16, "max": 2.31, "min": 340.03, "cnt": 29}, "backward-send":{"total": 3.44, "avg": 1.15, "max": 1.10, "min": 1.18, "cnt": 3}, "backward-recv":{"total": 132.23, "avg": 66.11, "max": 62.13, "min": 70.09, "cnt": 2}, "backward-params-all-reduce":{"total": 486.71, "avg": 486.71, "max": 486.71, "min": 486.71, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 247.19, "avg": 247.19, "max": 247.19, "min": 247.19, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 207.43, "avg": 207.43, "max": 207.43, "min": 207.43, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 128, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 81.79, "avg": 27.26, "max": 1.96, "min": 77.75, "cnt": 3}, "forward-compute":{"total": 1995.21, "avg": 62.35, "max": 54.83, "min": 68.11, "cnt": 32}, "fwd-compute":{"total": 1991.85, "avg": 62.25, "max": 54.76, "min": 67.97, "cnt": 32}, "batch-generator":{"total": 48.18, "avg": 1.51, "max": 0.68, "min": 2.73, "cnt": 32}, "fwd-embedding":{"total": 0.74, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1930.64, "avg": 60.33, "max": 53.80, "min": 65.95, "cnt": 32}, "fwd-layernorm":{"total": 10.96, "avg": 0.09, "max": 0.06, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 114.53, "avg": 0.89, "max": 0.74, "min": 2.23, "cnt": 128}, "fwd-misc":{"total": 23.57, "avg": 0.18, "max": 0.11, "min": 0.62, "cnt": 128}, "fwd-MLP":{"total": 1758.89, "avg": 13.74, "max": 11.36, "min": 18.74, "cnt": 128}, "MoE_L0_fwd":{"total": 519.70, "avg": 16.24, "max": 13.03, "min": 18.62, "cnt": 32}, "MoEMLP":{"total": 1740.65, "avg": 13.60, "max": 11.26, "min": 18.58, "cnt": 128}, "MoE_L1_fwd":{"total": 410.12, "avg": 12.82, "max": 11.41, "min": 16.93, "cnt": 32}, "MoE_L2_fwd":{"total": 431.92, "avg": 13.50, "max": 12.87, "min": 15.98, "cnt": 32}, "MoE_L3_fwd":{"total": 385.71, "avg": 12.05, "max": 11.30, "min": 12.95, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.84, "avg": 0.92, "max": 0.90, "min": 0.94, "cnt": 2}, "forward-send-backward-recv":{"total": 460.40, "avg": 15.35, "max": 1.33, "min": 123.62, "cnt": 30}, "backward-compute":{"total": 1871.96, "avg": 58.50, "max": 56.92, "min": 61.37, "cnt": 32}, "MoE_L3_bwd":{"total": 427.97, "avg": 13.37, "max": 12.12, "min": 16.73, "cnt": 32}, "MoE_L2_bwd":{"total": 446.89, "avg": 13.97, "max": 13.33, "min": 15.96, "cnt": 32}, "MoE_L1_bwd":{"total": 344.03, "avg": 10.75, "max": 10.34, "min": 11.25, "cnt": 32}, "MoE_L0_bwd":{"total": 441.91, "avg": 13.81, "max": 13.26, "min": 15.37, "cnt": 32}, "backward-send-forward-recv":{"total": 3140.42, "avg": 108.29, "max": 1.29, "min": 499.56, "cnt": 29}, "backward-send":{"total": 2.86, "avg": 0.95, "max": 0.70, "min": 1.14, "cnt": 3}, "backward-recv":{"total": 405.76, "avg": 202.88, "max": 66.94, "min": 338.82, "cnt": 2}, "backward-params-all-reduce":{"total": 491.28, "avg": 491.28, "max": 491.28, "min": 491.28, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 241.76, "avg": 241.76, "max": 241.76, "min": 241.76, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 201.83, "avg": 201.83, "max": 201.83, "min": 201.83, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.56, "avg": 3.56, "max": 3.56, "min": 3.56, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 129, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 78.36, "avg": 26.12, "max": 1.16, "min": 75.84, "cnt": 3}, "forward-compute":{"total": 1924.25, "avg": 60.13, "max": 54.75, "min": 66.70, "cnt": 32}, "fwd-compute":{"total": 1921.01, "avg": 60.03, "max": 54.68, "min": 66.62, "cnt": 32}, "batch-generator":{"total": 39.02, "avg": 1.22, "max": 0.71, "min": 2.65, "cnt": 32}, "fwd-embedding":{"total": 0.58, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1869.25, "avg": 58.41, "max": 53.64, "min": 65.34, "cnt": 32}, "fwd-layernorm":{"total": 9.69, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 105.98, "avg": 0.83, "max": 0.74, "min": 1.48, "cnt": 128}, "fwd-misc":{"total": 21.05, "avg": 0.16, "max": 0.12, "min": 0.39, "cnt": 128}, "fwd-MLP":{"total": 1711.64, "avg": 13.37, "max": 11.43, "min": 19.08, "cnt": 128}, "MoE_L0_fwd":{"total": 498.40, "avg": 15.58, "max": 12.90, "min": 19.00, "cnt": 32}, "MoEMLP":{"total": 1694.69, "avg": 13.24, "max": 11.33, "min": 18.96, "cnt": 128}, "MoE_L1_fwd":{"total": 397.74, "avg": 12.43, "max": 11.45, "min": 16.32, "cnt": 32}, "MoE_L2_fwd":{"total": 422.16, "avg": 13.19, "max": 12.74, "min": 14.12, "cnt": 32}, "MoE_L3_fwd":{"total": 382.45, "avg": 11.95, "max": 11.37, "min": 12.87, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.84, "avg": 0.92, "max": 0.89, "min": 0.95, "cnt": 2}, "forward-send-backward-recv":{"total": 343.20, "avg": 11.44, "max": 1.64, "min": 125.44, "cnt": 30}, "backward-compute":{"total": 1868.18, "avg": 58.38, "max": 56.04, "min": 59.90, "cnt": 32}, "MoE_L3_bwd":{"total": 425.83, "avg": 13.31, "max": 12.60, "min": 14.68, "cnt": 32}, "MoE_L2_bwd":{"total": 438.58, "avg": 13.71, "max": 12.98, "min": 15.45, "cnt": 32}, "MoE_L1_bwd":{"total": 344.85, "avg": 10.78, "max": 10.32, "min": 11.30, "cnt": 32}, "MoE_L0_bwd":{"total": 442.95, "avg": 13.84, "max": 13.32, "min": 14.19, "cnt": 32}, "backward-send-forward-recv":{"total": 2747.11, "avg": 94.73, "max": 1.68, "min": 391.72, "cnt": 29}, "backward-send":{"total": 2.91, "avg": 0.97, "max": 0.83, "min": 1.04, "cnt": 3}, "backward-recv":{"total": 125.61, "avg": 62.81, "max": 58.20, "min": 67.41, "cnt": 2}, "backward-params-all-reduce":{"total": 486.68, "avg": 486.68, "max": 486.68, "min": 486.68, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 246.29, "avg": 246.29, "max": 246.29, "min": 246.29, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 206.23, "avg": 206.23, "max": 206.23, "min": 206.23, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.57, "avg": 3.57, "max": 3.57, "min": 3.57, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.47, "avg": 3.47, "max": 3.47, "min": 3.47, "cnt": 1}}}
{"type":"time", "iteration": 130, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 84.56, "avg": 28.19, "max": 1.47, "min": 75.28, "cnt": 3}, "forward-compute":{"total": 1953.61, "avg": 61.05, "max": 54.94, "min": 69.45, "cnt": 32}, "fwd-compute":{"total": 1950.36, "avg": 60.95, "max": 54.87, "min": 69.29, "cnt": 32}, "batch-generator":{"total": 38.29, "avg": 1.20, "max": 0.63, "min": 2.11, "cnt": 32}, "fwd-embedding":{"total": 0.61, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1898.90, "avg": 59.34, "max": 53.92, "min": 66.98, "cnt": 32}, "fwd-layernorm":{"total": 9.84, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 107.92, "avg": 0.84, "max": 0.74, "min": 1.88, "cnt": 128}, "fwd-misc":{"total": 21.44, "avg": 0.17, "max": 0.11, "min": 0.38, "cnt": 128}, "fwd-MLP":{"total": 1737.97, "avg": 13.58, "max": 11.43, "min": 20.30, "cnt": 128}, "MoE_L0_fwd":{"total": 499.43, "avg": 15.61, "max": 12.79, "min": 20.22, "cnt": 32}, "MoEMLP":{"total": 1720.87, "avg": 13.44, "max": 11.32, "min": 20.16, "cnt": 128}, "MoE_L1_fwd":{"total": 409.54, "avg": 12.80, "max": 11.37, "min": 16.65, "cnt": 32}, "MoE_L2_fwd":{"total": 423.14, "avg": 13.22, "max": 12.57, "min": 14.62, "cnt": 32}, "MoE_L3_fwd":{"total": 395.02, "avg": 12.34, "max": 11.48, "min": 16.28, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.61, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 2.24, "avg": 1.12, "max": 0.94, "min": 1.30, "cnt": 2}, "forward-send-backward-recv":{"total": 583.67, "avg": 19.46, "max": 1.09, "min": 196.64, "cnt": 30}, "backward-compute":{"total": 1863.55, "avg": 58.24, "max": 56.91, "min": 62.73, "cnt": 32}, "MoE_L3_bwd":{"total": 425.39, "avg": 13.29, "max": 12.28, "min": 14.20, "cnt": 32}, "MoE_L2_bwd":{"total": 437.54, "avg": 13.67, "max": 12.97, "min": 17.04, "cnt": 32}, "MoE_L1_bwd":{"total": 340.75, "avg": 10.65, "max": 10.16, "min": 11.12, "cnt": 32}, "MoE_L0_bwd":{"total": 443.45, "avg": 13.86, "max": 13.52, "min": 14.79, "cnt": 32}, "backward-send-forward-recv":{"total": 2329.53, "avg": 80.33, "max": 1.26, "min": 854.64, "cnt": 29}, "backward-send":{"total": 3.00, "avg": 1.00, "max": 0.94, "min": 1.12, "cnt": 3}, "backward-recv":{"total": 126.63, "avg": 63.32, "max": 55.95, "min": 70.68, "cnt": 2}, "backward-params-all-reduce":{"total": 487.40, "avg": 487.40, "max": 487.40, "min": 487.40, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 250.26, "avg": 250.26, "max": 250.26, "min": 250.26, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 210.28, "avg": 210.28, "max": 210.28, "min": 210.28, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.63, "avg": 3.63, "max": 3.63, "min": 3.63, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 131, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 74.56, "avg": 24.85, "max": 0.64, "min": 72.52, "cnt": 3}, "forward-compute":{"total": 1998.02, "avg": 62.44, "max": 55.29, "min": 74.29, "cnt": 32}, "fwd-compute":{"total": 1994.71, "avg": 62.33, "max": 55.22, "min": 74.16, "cnt": 32}, "batch-generator":{"total": 41.85, "avg": 1.31, "max": 0.70, "min": 3.45, "cnt": 32}, "fwd-embedding":{"total": 0.62, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1939.85, "avg": 60.62, "max": 54.19, "min": 72.11, "cnt": 32}, "fwd-layernorm":{"total": 9.91, "avg": 0.08, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 107.17, "avg": 0.84, "max": 0.74, "min": 1.49, "cnt": 128}, "fwd-misc":{"total": 21.46, "avg": 0.17, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1780.16, "avg": 13.91, "max": 11.68, "min": 23.46, "cnt": 128}, "MoE_L0_fwd":{"total": 512.79, "avg": 16.02, "max": 13.00, "min": 23.38, "cnt": 32}, "MoEMLP":{"total": 1763.15, "avg": 13.77, "max": 11.57, "min": 23.34, "cnt": 128}, "MoE_L1_fwd":{"total": 416.08, "avg": 13.00, "max": 11.61, "min": 18.01, "cnt": 32}, "MoE_L2_fwd":{"total": 433.96, "avg": 13.56, "max": 12.93, "min": 15.01, "cnt": 32}, "MoE_L3_fwd":{"total": 406.54, "avg": 12.70, "max": 11.63, "min": 18.21, "cnt": 32}, "fwd-pooler":{"total": 0.36, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 3.80, "avg": 1.90, "max": 0.91, "min": 2.88, "cnt": 2}, "forward-send-backward-recv":{"total": 306.38, "avg": 10.21, "max": 1.38, "min": 121.45, "cnt": 30}, "backward-compute":{"total": 1887.94, "avg": 59.00, "max": 56.77, "min": 62.43, "cnt": 32}, "MoE_L3_bwd":{"total": 439.05, "avg": 13.72, "max": 11.73, "min": 18.09, "cnt": 32}, "MoE_L2_bwd":{"total": 442.87, "avg": 13.84, "max": 13.09, "min": 14.92, "cnt": 32}, "MoE_L1_bwd":{"total": 346.70, "avg": 10.83, "max": 10.50, "min": 11.52, "cnt": 32}, "MoE_L0_bwd":{"total": 445.42, "avg": 13.92, "max": 13.36, "min": 15.35, "cnt": 32}, "backward-send-forward-recv":{"total": 2562.87, "avg": 88.37, "max": 1.83, "min": 343.57, "cnt": 29}, "backward-send":{"total": 2.54, "avg": 0.85, "max": 0.52, "min": 1.11, "cnt": 3}, "backward-recv":{"total": 256.01, "avg": 128.01, "max": 68.81, "min": 187.20, "cnt": 2}, "backward-params-all-reduce":{"total": 484.96, "avg": 484.96, "max": 484.96, "min": 484.96, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 244.60, "avg": 244.60, "max": 244.60, "min": 244.60, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.36, "avg": 3.36, "max": 3.36, "min": 3.36, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 204.72, "avg": 204.72, "max": 204.72, "min": 204.72, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.50, "avg": 3.50, "max": 3.50, "min": 3.50, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}}}
{"type":"time", "iteration": 132, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 86.99, "avg": 29.00, "max": 1.45, "min": 77.29, "cnt": 3}, "forward-compute":{"total": 1985.87, "avg": 62.06, "max": 56.11, "min": 67.13, "cnt": 32}, "fwd-compute":{"total": 1982.34, "avg": 61.95, "max": 56.04, "min": 67.05, "cnt": 32}, "batch-generator":{"total": 46.49, "avg": 1.45, "max": 0.72, "min": 3.42, "cnt": 32}, "fwd-embedding":{"total": 0.76, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1922.47, "avg": 60.08, "max": 54.99, "min": 65.90, "cnt": 32}, "fwd-layernorm":{"total": 10.62, "avg": 0.08, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 113.27, "avg": 0.88, "max": 0.74, "min": 2.20, "cnt": 128}, "fwd-misc":{"total": 22.74, "avg": 0.18, "max": 0.11, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1753.45, "avg": 13.70, "max": 11.74, "min": 18.60, "cnt": 128}, "MoE_L0_fwd":{"total": 508.74, "avg": 15.90, "max": 13.09, "min": 18.51, "cnt": 32}, "MoEMLP":{"total": 1735.67, "avg": 13.56, "max": 11.63, "min": 18.46, "cnt": 128}, "MoE_L1_fwd":{"total": 406.55, "avg": 12.70, "max": 11.73, "min": 17.24, "cnt": 32}, "MoE_L2_fwd":{"total": 431.70, "avg": 13.49, "max": 12.77, "min": 17.59, "cnt": 32}, "MoE_L3_fwd":{"total": 395.22, "avg": 12.35, "max": 11.68, "min": 14.63, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.87, "avg": 0.93, "max": 0.90, "min": 0.97, "cnt": 2}, "forward-send-backward-recv":{"total": 181.20, "avg": 6.04, "max": 1.40, "min": 107.07, "cnt": 30}, "backward-compute":{"total": 1966.15, "avg": 61.44, "max": 57.80, "min": 142.15, "cnt": 32}, "MoE_L3_bwd":{"total": 427.04, "avg": 13.34, "max": 12.57, "min": 14.49, "cnt": 32}, "MoE_L2_bwd":{"total": 434.81, "avg": 13.59, "max": 12.78, "min": 14.56, "cnt": 32}, "MoE_L1_bwd":{"total": 350.16, "avg": 10.94, "max": 10.38, "min": 11.64, "cnt": 32}, "MoE_L0_bwd":{"total": 538.55, "avg": 16.83, "max": 13.72, "min": 97.65, "cnt": 32}, "backward-send-forward-recv":{"total": 2270.05, "avg": 78.28, "max": 2.14, "min": 761.24, "cnt": 29}, "backward-send":{"total": 3.10, "avg": 1.03, "max": 0.86, "min": 1.16, "cnt": 3}, "backward-recv":{"total": 185.32, "avg": 92.66, "max": 73.15, "min": 112.18, "cnt": 2}, "backward-params-all-reduce":{"total": 490.39, "avg": 490.39, "max": 490.39, "min": 490.39, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 241.93, "avg": 241.93, "max": 241.93, "min": 241.93, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 202.09, "avg": 202.09, "max": 202.09, "min": 202.09, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.47, "avg": 3.47, "max": 3.47, "min": 3.47, "cnt": 1}}}
{"type":"time", "iteration": 133, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 89.23, "avg": 29.74, "max": 1.31, "min": 84.97, "cnt": 3}, "forward-compute":{"total": 1978.21, "avg": 61.82, "max": 55.80, "min": 65.53, "cnt": 32}, "fwd-compute":{"total": 1974.68, "avg": 61.71, "max": 55.74, "min": 65.40, "cnt": 32}, "batch-generator":{"total": 46.43, "avg": 1.45, "max": 0.66, "min": 2.91, "cnt": 32}, "fwd-embedding":{"total": 0.75, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1914.75, "avg": 59.84, "max": 54.65, "min": 63.30, "cnt": 32}, "fwd-layernorm":{"total": 10.73, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 112.21, "avg": 0.88, "max": 0.74, "min": 2.12, "cnt": 128}, "fwd-misc":{"total": 22.38, "avg": 0.17, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1747.27, "avg": 13.65, "max": 11.52, "min": 19.43, "cnt": 128}, "MoE_L0_fwd":{"total": 522.77, "avg": 16.34, "max": 12.86, "min": 19.35, "cnt": 32}, "MoEMLP":{"total": 1729.48, "avg": 13.51, "max": 11.41, "min": 19.29, "cnt": 128}, "MoE_L1_fwd":{"total": 408.02, "avg": 12.75, "max": 11.71, "min": 14.31, "cnt": 32}, "MoE_L2_fwd":{"total": 418.75, "avg": 13.09, "max": 12.47, "min": 13.78, "cnt": 32}, "MoE_L3_fwd":{"total": 386.45, "avg": 12.08, "max": 11.45, "min": 13.27, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.93, "avg": 0.96, "max": 0.90, "min": 1.02, "cnt": 2}, "forward-send-backward-recv":{"total": 801.24, "avg": 26.71, "max": 1.07, "min": 262.80, "cnt": 30}, "backward-compute":{"total": 1876.26, "avg": 58.63, "max": 55.41, "min": 60.92, "cnt": 32}, "MoE_L3_bwd":{"total": 435.79, "avg": 13.62, "max": 12.73, "min": 15.07, "cnt": 32}, "MoE_L2_bwd":{"total": 429.69, "avg": 13.43, "max": 12.70, "min": 14.46, "cnt": 32}, "MoE_L1_bwd":{"total": 349.92, "avg": 10.94, "max": 10.39, "min": 12.15, "cnt": 32}, "MoE_L0_bwd":{"total": 445.47, "avg": 13.92, "max": 13.22, "min": 15.72, "cnt": 32}, "backward-send-forward-recv":{"total": 1301.79, "avg": 44.89, "max": 1.44, "min": 319.80, "cnt": 29}, "backward-send":{"total": 3.11, "avg": 1.04, "max": 0.88, "min": 1.16, "cnt": 3}, "backward-recv":{"total": 175.87, "avg": 87.94, "max": 72.17, "min": 103.70, "cnt": 2}, "backward-params-all-reduce":{"total": 486.65, "avg": 486.65, "max": 486.65, "min": 486.65, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 242.12, "avg": 242.12, "max": 242.12, "min": 242.12, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.36, "avg": 3.36, "max": 3.36, "min": 3.36, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 202.37, "avg": 202.37, "max": 202.37, "min": 202.37, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.35, "avg": 3.35, "max": 3.35, "min": 3.35, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 134, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 73.80, "avg": 24.60, "max": 1.39, "min": 70.92, "cnt": 3}, "forward-compute":{"total": 1976.13, "avg": 61.75, "max": 55.63, "min": 68.28, "cnt": 32}, "fwd-compute":{"total": 1972.65, "avg": 61.65, "max": 55.55, "min": 68.19, "cnt": 32}, "batch-generator":{"total": 41.16, "avg": 1.29, "max": 0.68, "min": 2.64, "cnt": 32}, "fwd-embedding":{"total": 0.66, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1917.90, "avg": 59.93, "max": 54.48, "min": 66.41, "cnt": 32}, "fwd-layernorm":{"total": 10.24, "avg": 0.08, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 108.14, "avg": 0.84, "max": 0.74, "min": 1.50, "cnt": 128}, "fwd-misc":{"total": 22.11, "avg": 0.17, "max": 0.11, "min": 0.41, "cnt": 128}, "fwd-MLP":{"total": 1755.74, "avg": 13.72, "max": 11.54, "min": 19.47, "cnt": 128}, "MoE_L0_fwd":{"total": 508.36, "avg": 15.89, "max": 12.73, "min": 18.41, "cnt": 32}, "MoEMLP":{"total": 1738.48, "avg": 13.58, "max": 11.42, "min": 19.36, "cnt": 128}, "MoE_L1_fwd":{"total": 409.13, "avg": 12.79, "max": 11.86, "min": 13.99, "cnt": 32}, "MoE_L2_fwd":{"total": 426.18, "avg": 13.32, "max": 12.51, "min": 19.40, "cnt": 32}, "MoE_L3_fwd":{"total": 401.12, "avg": 12.54, "max": 11.46, "min": 17.68, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 5.83, "avg": 2.92, "max": 0.94, "min": 4.89, "cnt": 2}, "forward-send-backward-recv":{"total": 1133.90, "avg": 37.80, "max": 1.84, "min": 125.31, "cnt": 30}, "backward-compute":{"total": 1860.20, "avg": 58.13, "max": 56.63, "min": 59.42, "cnt": 32}, "MoE_L3_bwd":{"total": 431.64, "avg": 13.49, "max": 12.30, "min": 14.91, "cnt": 32}, "MoE_L2_bwd":{"total": 424.47, "avg": 13.26, "max": 12.79, "min": 13.93, "cnt": 32}, "MoE_L1_bwd":{"total": 345.70, "avg": 10.80, "max": 10.46, "min": 11.21, "cnt": 32}, "MoE_L0_bwd":{"total": 441.21, "avg": 13.79, "max": 13.36, "min": 14.37, "cnt": 32}, "backward-send-forward-recv":{"total": 1242.70, "avg": 42.85, "max": 1.23, "min": 717.75, "cnt": 29}, "backward-send":{"total": 2.92, "avg": 0.97, "max": 0.86, "min": 1.06, "cnt": 3}, "backward-recv":{"total": 234.63, "avg": 117.32, "max": 76.64, "min": 158.00, "cnt": 2}, "backward-params-all-reduce":{"total": 491.26, "avg": 491.26, "max": 491.26, "min": 491.26, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 238.99, "avg": 238.99, "max": 238.99, "min": 238.99, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 199.18, "avg": 199.18, "max": 199.18, "min": 199.18, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.50, "avg": 3.50, "max": 3.50, "min": 3.50, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 135, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 88.76, "avg": 29.59, "max": 1.35, "min": 86.03, "cnt": 3}, "forward-compute":{"total": 1955.85, "avg": 61.12, "max": 55.75, "min": 67.17, "cnt": 32}, "fwd-compute":{"total": 1952.49, "avg": 61.02, "max": 55.69, "min": 67.04, "cnt": 32}, "batch-generator":{"total": 41.33, "avg": 1.29, "max": 0.65, "min": 2.21, "cnt": 32}, "fwd-embedding":{"total": 0.69, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1898.30, "avg": 59.32, "max": 54.62, "min": 64.93, "cnt": 32}, "fwd-layernorm":{"total": 9.97, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 109.73, "avg": 0.86, "max": 0.74, "min": 1.46, "cnt": 128}, "fwd-misc":{"total": 22.06, "avg": 0.17, "max": 0.11, "min": 0.40, "cnt": 128}, "fwd-MLP":{"total": 1734.86, "avg": 13.55, "max": 11.87, "min": 18.78, "cnt": 128}, "MoE_L0_fwd":{"total": 497.20, "avg": 15.54, "max": 13.09, "min": 18.61, "cnt": 32}, "MoEMLP":{"total": 1717.89, "avg": 13.42, "max": 11.76, "min": 18.51, "cnt": 128}, "MoE_L1_fwd":{"total": 405.61, "avg": 12.68, "max": 11.85, "min": 16.34, "cnt": 32}, "MoE_L2_fwd":{"total": 420.61, "avg": 13.14, "max": 12.26, "min": 14.60, "cnt": 32}, "MoE_L3_fwd":{"total": 400.70, "avg": 12.52, "max": 11.80, "min": 16.67, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.83, "avg": 0.91, "max": 0.91, "min": 0.92, "cnt": 2}, "forward-send-backward-recv":{"total": 275.03, "avg": 9.17, "max": 1.31, "min": 117.16, "cnt": 30}, "backward-compute":{"total": 1867.95, "avg": 58.37, "max": 56.78, "min": 62.59, "cnt": 32}, "MoE_L3_bwd":{"total": 433.63, "avg": 13.55, "max": 12.79, "min": 18.11, "cnt": 32}, "MoE_L2_bwd":{"total": 423.07, "avg": 13.22, "max": 12.69, "min": 13.68, "cnt": 32}, "MoE_L1_bwd":{"total": 350.45, "avg": 10.95, "max": 10.52, "min": 11.85, "cnt": 32}, "MoE_L0_bwd":{"total": 445.25, "avg": 13.91, "max": 13.41, "min": 14.37, "cnt": 32}, "backward-send-forward-recv":{"total": 1229.43, "avg": 42.39, "max": 2.21, "min": 178.73, "cnt": 29}, "backward-send":{"total": 3.45, "avg": 1.15, "max": 1.08, "min": 1.19, "cnt": 3}, "backward-recv":{"total": 125.43, "avg": 62.71, "max": 60.70, "min": 64.73, "cnt": 2}, "backward-params-all-reduce":{"total": 488.59, "avg": 488.59, "max": 488.59, "min": 488.59, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 243.39, "avg": 243.39, "max": 243.39, "min": 243.39, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 203.20, "avg": 203.20, "max": 203.20, "min": 203.20, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.66, "avg": 3.66, "max": 3.66, "min": 3.66, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.47, "avg": 3.47, "max": 3.47, "min": 3.47, "cnt": 1}}}
{"type":"time", "iteration": 136, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 87.01, "avg": 29.00, "max": 0.78, "min": 80.27, "cnt": 3}, "forward-compute":{"total": 2084.16, "avg": 65.13, "max": 55.25, "min": 191.59, "cnt": 32}, "fwd-compute":{"total": 2080.73, "avg": 65.02, "max": 55.18, "min": 191.51, "cnt": 32}, "batch-generator":{"total": 44.72, "avg": 1.40, "max": 0.72, "min": 3.56, "cnt": 32}, "fwd-embedding":{"total": 0.74, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 2023.23, "avg": 63.23, "max": 54.13, "min": 190.29, "cnt": 32}, "fwd-layernorm":{"total": 10.62, "avg": 0.08, "max": 0.06, "min": 0.22, "cnt": 128}, "fwd-attn":{"total": 112.26, "avg": 0.88, "max": 0.74, "min": 1.56, "cnt": 128}, "fwd-misc":{"total": 22.10, "avg": 0.17, "max": 0.12, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1856.08, "avg": 14.50, "max": 11.73, "min": 149.47, "cnt": 128}, "MoE_L0_fwd":{"total": 643.17, "avg": 20.10, "max": 12.92, "min": 149.40, "cnt": 32}, "MoEMLP":{"total": 1838.60, "avg": 14.36, "max": 11.59, "min": 149.35, "cnt": 128}, "MoE_L1_fwd":{"total": 398.93, "avg": 12.47, "max": 11.65, "min": 13.24, "cnt": 32}, "MoE_L2_fwd":{"total": 410.76, "avg": 12.84, "max": 12.25, "min": 14.01, "cnt": 32}, "MoE_L3_fwd":{"total": 392.23, "avg": 12.26, "max": 11.75, "min": 13.01, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 5.23, "avg": 2.62, "max": 0.94, "min": 4.30, "cnt": 2}, "forward-send-backward-recv":{"total": 1669.75, "avg": 55.66, "max": 1.98, "min": 350.89, "cnt": 30}, "backward-compute":{"total": 1869.81, "avg": 58.43, "max": 57.43, "min": 60.38, "cnt": 32}, "MoE_L3_bwd":{"total": 440.04, "avg": 13.75, "max": 12.65, "min": 16.14, "cnt": 32}, "MoE_L2_bwd":{"total": 421.05, "avg": 13.16, "max": 12.56, "min": 13.73, "cnt": 32}, "MoE_L1_bwd":{"total": 347.85, "avg": 10.87, "max": 10.21, "min": 11.18, "cnt": 32}, "MoE_L0_bwd":{"total": 445.24, "avg": 13.91, "max": 13.32, "min": 14.40, "cnt": 32}, "backward-send-forward-recv":{"total": 1791.81, "avg": 61.79, "max": 1.62, "min": 806.41, "cnt": 29}, "backward-send":{"total": 2.02, "avg": 0.67, "max": 0.51, "min": 0.85, "cnt": 3}, "backward-recv":{"total": 226.24, "avg": 113.12, "max": 66.39, "min": 159.85, "cnt": 2}, "backward-params-all-reduce":{"total": 484.85, "avg": 484.85, "max": 484.85, "min": 484.85, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 242.21, "avg": 242.21, "max": 242.21, "min": 242.21, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.36, "avg": 3.36, "max": 3.36, "min": 3.36, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 202.38, "avg": 202.38, "max": 202.38, "min": 202.38, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}}}
{"type":"time", "iteration": 137, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 76.49, "avg": 25.50, "max": 1.31, "min": 73.79, "cnt": 3}, "forward-compute":{"total": 1950.31, "avg": 60.95, "max": 55.49, "min": 69.79, "cnt": 32}, "fwd-compute":{"total": 1947.00, "avg": 60.84, "max": 55.41, "min": 69.65, "cnt": 32}, "batch-generator":{"total": 40.58, "avg": 1.27, "max": 0.71, "min": 3.02, "cnt": 32}, "fwd-embedding":{"total": 0.62, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1894.10, "avg": 59.19, "max": 54.25, "min": 67.56, "cnt": 32}, "fwd-layernorm":{"total": 9.87, "avg": 0.08, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 109.10, "avg": 0.85, "max": 0.74, "min": 1.58, "cnt": 128}, "fwd-misc":{"total": 21.18, "avg": 0.17, "max": 0.12, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1732.63, "avg": 13.54, "max": 11.57, "min": 18.22, "cnt": 128}, "MoE_L0_fwd":{"total": 500.67, "avg": 15.65, "max": 12.80, "min": 18.15, "cnt": 32}, "MoEMLP":{"total": 1715.61, "avg": 13.40, "max": 11.46, "min": 18.10, "cnt": 128}, "MoE_L1_fwd":{"total": 406.27, "avg": 12.70, "max": 11.54, "min": 16.38, "cnt": 32}, "MoE_L2_fwd":{"total": 420.80, "avg": 13.15, "max": 12.52, "min": 16.15, "cnt": 32}, "MoE_L3_fwd":{"total": 394.18, "avg": 12.32, "max": 11.50, "min": 14.86, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.61, "avg": 0.02, "max": 0.02, "min": 0.04, "cnt": 32}, "forward-send":{"total": 1.87, "avg": 0.94, "max": 0.93, "min": 0.94, "cnt": 2}, "forward-send-backward-recv":{"total": 818.90, "avg": 27.30, "max": 1.11, "min": 245.01, "cnt": 30}, "backward-compute":{"total": 1855.35, "avg": 57.98, "max": 55.65, "min": 61.22, "cnt": 32}, "MoE_L3_bwd":{"total": 434.57, "avg": 13.58, "max": 12.70, "min": 17.22, "cnt": 32}, "MoE_L2_bwd":{"total": 419.24, "avg": 13.10, "max": 12.61, "min": 14.27, "cnt": 32}, "MoE_L1_bwd":{"total": 342.98, "avg": 10.72, "max": 10.35, "min": 11.35, "cnt": 32}, "MoE_L0_bwd":{"total": 442.22, "avg": 13.82, "max": 13.40, "min": 14.18, "cnt": 32}, "backward-send-forward-recv":{"total": 2485.25, "avg": 85.70, "max": 2.23, "min": 601.10, "cnt": 29}, "backward-send":{"total": 2.80, "avg": 0.93, "max": 0.77, "min": 1.19, "cnt": 3}, "backward-recv":{"total": 282.82, "avg": 141.41, "max": 66.60, "min": 216.22, "cnt": 2}, "backward-params-all-reduce":{"total": 484.12, "avg": 484.12, "max": 484.12, "min": 484.12, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 245.49, "avg": 245.49, "max": 245.49, "min": 245.49, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 205.56, "avg": 205.56, "max": 205.56, "min": 205.56, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.53, "avg": 3.53, "max": 3.53, "min": 3.53, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 138, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 89.94, "avg": 29.98, "max": 4.80, "min": 78.93, "cnt": 3}, "forward-compute":{"total": 1962.42, "avg": 61.33, "max": 56.69, "min": 65.98, "cnt": 32}, "fwd-compute":{"total": 1959.15, "avg": 61.22, "max": 56.61, "min": 65.90, "cnt": 32}, "batch-generator":{"total": 39.95, "avg": 1.25, "max": 0.64, "min": 2.78, "cnt": 32}, "fwd-embedding":{"total": 0.60, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1906.49, "avg": 59.58, "max": 54.97, "min": 64.75, "cnt": 32}, "fwd-layernorm":{"total": 9.90, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 108.09, "avg": 0.84, "max": 0.74, "min": 1.89, "cnt": 128}, "fwd-misc":{"total": 21.24, "avg": 0.17, "max": 0.12, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1745.91, "avg": 13.64, "max": 11.66, "min": 20.94, "cnt": 128}, "MoE_L0_fwd":{"total": 512.14, "avg": 16.00, "max": 12.99, "min": 20.86, "cnt": 32}, "MoEMLP":{"total": 1729.05, "avg": 13.51, "max": 11.54, "min": 20.82, "cnt": 128}, "MoE_L1_fwd":{"total": 420.97, "avg": 13.16, "max": 12.09, "min": 15.67, "cnt": 32}, "MoE_L2_fwd":{"total": 413.74, "avg": 12.93, "max": 12.38, "min": 13.70, "cnt": 32}, "MoE_L3_fwd":{"total": 388.44, "avg": 12.14, "max": 11.58, "min": 13.45, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.79, "avg": 0.89, "max": 0.86, "min": 0.93, "cnt": 2}, "forward-send-backward-recv":{"total": 278.97, "avg": 9.30, "max": 1.30, "min": 107.78, "cnt": 30}, "backward-compute":{"total": 1872.95, "avg": 58.53, "max": 56.14, "min": 61.78, "cnt": 32}, "MoE_L3_bwd":{"total": 438.82, "avg": 13.71, "max": 12.72, "min": 14.87, "cnt": 32}, "MoE_L2_bwd":{"total": 422.11, "avg": 13.19, "max": 12.44, "min": 14.22, "cnt": 32}, "MoE_L1_bwd":{"total": 350.09, "avg": 10.94, "max": 10.37, "min": 13.89, "cnt": 32}, "MoE_L0_bwd":{"total": 447.14, "avg": 13.97, "max": 13.50, "min": 14.31, "cnt": 32}, "backward-send-forward-recv":{"total": 2463.05, "avg": 84.93, "max": 1.82, "min": 508.03, "cnt": 29}, "backward-send":{"total": 3.13, "avg": 1.04, "max": 0.87, "min": 1.15, "cnt": 3}, "backward-recv":{"total": 123.64, "avg": 61.82, "max": 60.03, "min": 63.61, "cnt": 2}, "backward-params-all-reduce":{"total": 493.08, "avg": 493.08, "max": 493.08, "min": 493.08, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 243.95, "avg": 243.95, "max": 243.95, "min": 243.95, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 202.87, "avg": 202.87, "max": 202.87, "min": 202.87, "cnt": 1}, "optimizer-clip-main-grad":{"total": 4.60, "avg": 4.60, "max": 4.60, "min": 4.60, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 139, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 82.58, "avg": 27.53, "max": 1.37, "min": 79.79, "cnt": 3}, "forward-compute":{"total": 1949.46, "avg": 60.92, "max": 57.56, "min": 66.39, "cnt": 32}, "fwd-compute":{"total": 1946.24, "avg": 60.82, "max": 57.47, "min": 66.24, "cnt": 32}, "batch-generator":{"total": 40.21, "avg": 1.26, "max": 0.69, "min": 2.10, "cnt": 32}, "fwd-embedding":{"total": 0.64, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1893.51, "avg": 59.17, "max": 56.18, "min": 64.01, "cnt": 32}, "fwd-layernorm":{"total": 9.76, "avg": 0.08, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 108.98, "avg": 0.85, "max": 0.74, "min": 2.06, "cnt": 128}, "fwd-misc":{"total": 21.03, "avg": 0.16, "max": 0.12, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1732.74, "avg": 13.54, "max": 11.45, "min": 19.54, "cnt": 128}, "MoE_L0_fwd":{"total": 517.89, "avg": 16.18, "max": 13.41, "min": 19.38, "cnt": 32}, "MoEMLP":{"total": 1716.11, "avg": 13.41, "max": 11.34, "min": 19.29, "cnt": 128}, "MoE_L1_fwd":{"total": 403.16, "avg": 12.60, "max": 11.63, "min": 13.87, "cnt": 32}, "MoE_L2_fwd":{"total": 412.71, "avg": 12.90, "max": 12.37, "min": 13.82, "cnt": 32}, "MoE_L3_fwd":{"total": 388.52, "avg": 12.14, "max": 11.39, "min": 14.56, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.49, "avg": 0.75, "max": 0.74, "min": 0.75, "cnt": 2}, "forward-send-backward-recv":{"total": 175.72, "avg": 5.86, "max": 1.38, "min": 109.16, "cnt": 30}, "backward-compute":{"total": 1858.88, "avg": 58.09, "max": 56.50, "min": 63.94, "cnt": 32}, "MoE_L3_bwd":{"total": 429.16, "avg": 13.41, "max": 12.69, "min": 18.15, "cnt": 32}, "MoE_L2_bwd":{"total": 425.88, "avg": 13.31, "max": 12.71, "min": 14.10, "cnt": 32}, "MoE_L1_bwd":{"total": 342.20, "avg": 10.69, "max": 10.21, "min": 11.52, "cnt": 32}, "MoE_L0_bwd":{"total": 447.13, "avg": 13.97, "max": 13.57, "min": 14.45, "cnt": 32}, "backward-send-forward-recv":{"total": 2003.67, "avg": 69.09, "max": 2.35, "min": 246.46, "cnt": 29}, "backward-send":{"total": 2.40, "avg": 0.80, "max": 0.59, "min": 1.09, "cnt": 3}, "backward-recv":{"total": 132.79, "avg": 66.39, "max": 62.35, "min": 70.44, "cnt": 2}, "backward-params-all-reduce":{"total": 486.37, "avg": 486.37, "max": 486.37, "min": 486.37, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 247.70, "avg": 247.70, "max": 247.70, "min": 247.70, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.36, "avg": 3.36, "max": 3.36, "min": 3.36, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 207.37, "avg": 207.37, "max": 207.37, "min": 207.37, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.90, "avg": 3.90, "max": 3.90, "min": 3.90, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 140, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 71.94, "avg": 23.98, "max": 1.34, "min": 69.16, "cnt": 3}, "forward-compute":{"total": 1969.71, "avg": 61.55, "max": 57.17, "min": 66.34, "cnt": 32}, "fwd-compute":{"total": 1966.41, "avg": 61.45, "max": 57.08, "min": 66.26, "cnt": 32}, "batch-generator":{"total": 42.31, "avg": 1.32, "max": 0.69, "min": 2.10, "cnt": 32}, "fwd-embedding":{"total": 0.72, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1911.05, "avg": 59.72, "max": 55.91, "min": 64.89, "cnt": 32}, "fwd-layernorm":{"total": 9.93, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 108.88, "avg": 0.85, "max": 0.74, "min": 1.57, "cnt": 128}, "fwd-misc":{"total": 21.50, "avg": 0.17, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1749.51, "avg": 13.67, "max": 11.75, "min": 20.39, "cnt": 128}, "MoE_L0_fwd":{"total": 507.50, "avg": 15.86, "max": 12.79, "min": 20.31, "cnt": 32}, "MoEMLP":{"total": 1732.82, "avg": 13.54, "max": 11.63, "min": 20.26, "cnt": 128}, "MoE_L1_fwd":{"total": 417.51, "avg": 13.05, "max": 11.79, "min": 17.12, "cnt": 32}, "MoE_L2_fwd":{"total": 420.66, "avg": 13.15, "max": 12.43, "min": 14.97, "cnt": 32}, "MoE_L3_fwd":{"total": 393.31, "avg": 12.29, "max": 11.68, "min": 13.66, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.72, "avg": 0.86, "max": 0.84, "min": 0.88, "cnt": 2}, "forward-send-backward-recv":{"total": 367.77, "avg": 12.26, "max": 1.16, "min": 175.14, "cnt": 30}, "backward-compute":{"total": 2057.76, "avg": 64.30, "max": 56.14, "min": 249.87, "cnt": 32}, "MoE_L3_bwd":{"total": 630.01, "avg": 19.69, "max": 13.01, "min": 205.00, "cnt": 32}, "MoE_L2_bwd":{"total": 428.17, "avg": 13.38, "max": 12.53, "min": 15.38, "cnt": 32}, "MoE_L1_bwd":{"total": 340.87, "avg": 10.65, "max": 10.31, "min": 12.73, "cnt": 32}, "MoE_L0_bwd":{"total": 443.43, "avg": 13.86, "max": 13.19, "min": 14.66, "cnt": 32}, "backward-send-forward-recv":{"total": 1717.16, "avg": 59.21, "max": 2.33, "min": 206.59, "cnt": 29}, "backward-send":{"total": 3.47, "avg": 1.16, "max": 1.12, "min": 1.23, "cnt": 3}, "backward-recv":{"total": 125.24, "avg": 62.62, "max": 59.03, "min": 66.21, "cnt": 2}, "backward-params-all-reduce":{"total": 485.02, "avg": 485.02, "max": 485.02, "min": 485.02, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 243.08, "avg": 243.08, "max": 243.08, "min": 243.08, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.36, "avg": 3.36, "max": 3.36, "min": 3.36, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 203.25, "avg": 203.25, "max": 203.25, "min": 203.25, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.49, "avg": 3.49, "max": 3.49, "min": 3.49, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 141, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.06, "avg": 0.06, "max": 0.06, "min": 0.06, "cnt": 1}, "forward-recv":{"total": 83.48, "avg": 27.83, "max": 1.34, "min": 78.18, "cnt": 3}, "forward-compute":{"total": 1932.12, "avg": 60.38, "max": 53.71, "min": 67.39, "cnt": 32}, "fwd-compute":{"total": 1928.84, "avg": 60.28, "max": 53.64, "min": 67.25, "cnt": 32}, "batch-generator":{"total": 38.13, "avg": 1.19, "max": 0.70, "min": 2.02, "cnt": 32}, "fwd-embedding":{"total": 0.63, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1877.93, "avg": 58.69, "max": 52.62, "min": 65.25, "cnt": 32}, "fwd-layernorm":{"total": 9.75, "avg": 0.08, "max": 0.06, "min": 0.18, "cnt": 128}, "fwd-attn":{"total": 107.86, "avg": 0.84, "max": 0.74, "min": 1.67, "cnt": 128}, "fwd-misc":{"total": 21.42, "avg": 0.17, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1717.48, "avg": 13.42, "max": 11.19, "min": 18.55, "cnt": 128}, "MoE_L0_fwd":{"total": 500.66, "avg": 15.65, "max": 12.94, "min": 18.45, "cnt": 32}, "MoEMLP":{"total": 1700.61, "avg": 13.29, "max": 11.08, "min": 18.40, "cnt": 128}, "MoE_L1_fwd":{"total": 403.22, "avg": 12.60, "max": 11.50, "min": 17.01, "cnt": 32}, "MoE_L2_fwd":{"total": 419.35, "avg": 13.10, "max": 12.41, "min": 16.75, "cnt": 32}, "MoE_L3_fwd":{"total": 383.56, "avg": 11.99, "max": 11.12, "min": 13.41, "cnt": 32}, "fwd-pooler":{"total": 0.36, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.94, "avg": 0.97, "max": 0.92, "min": 1.02, "cnt": 2}, "forward-send-backward-recv":{"total": 185.68, "avg": 6.19, "max": 1.11, "min": 111.08, "cnt": 30}, "backward-compute":{"total": 1846.04, "avg": 57.69, "max": 55.91, "min": 60.48, "cnt": 32}, "MoE_L3_bwd":{"total": 415.85, "avg": 13.00, "max": 11.78, "min": 15.18, "cnt": 32}, "MoE_L2_bwd":{"total": 428.11, "avg": 13.38, "max": 12.33, "min": 14.31, "cnt": 32}, "MoE_L1_bwd":{"total": 341.66, "avg": 10.68, "max": 10.18, "min": 12.16, "cnt": 32}, "MoE_L0_bwd":{"total": 446.62, "avg": 13.96, "max": 13.25, "min": 14.71, "cnt": 32}, "backward-send-forward-recv":{"total": 1621.55, "avg": 55.92, "max": 2.36, "min": 177.09, "cnt": 29}, "backward-send":{"total": 2.78, "avg": 0.93, "max": 0.88, "min": 0.96, "cnt": 3}, "backward-recv":{"total": 117.67, "avg": 58.84, "max": 56.58, "min": 61.09, "cnt": 2}, "backward-params-all-reduce":{"total": 488.28, "avg": 488.28, "max": 488.28, "min": 488.28, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 250.17, "avg": 250.17, "max": 250.17, "min": 250.17, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 210.26, "avg": 210.26, "max": 210.26, "min": 210.26, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}}}
{"type":"time", "iteration": 142, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 75.58, "avg": 25.19, "max": 1.42, "min": 72.62, "cnt": 3}, "forward-compute":{"total": 1970.88, "avg": 61.59, "max": 56.31, "min": 70.95, "cnt": 32}, "fwd-compute":{"total": 1967.09, "avg": 61.47, "max": 56.24, "min": 70.59, "cnt": 32}, "batch-generator":{"total": 46.06, "avg": 1.44, "max": 0.71, "min": 2.89, "cnt": 32}, "fwd-embedding":{"total": 0.70, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1907.12, "avg": 59.60, "max": 55.16, "min": 66.90, "cnt": 32}, "fwd-layernorm":{"total": 10.61, "avg": 0.08, "max": 0.06, "min": 0.24, "cnt": 128}, "fwd-attn":{"total": 115.46, "avg": 0.90, "max": 0.74, "min": 2.83, "cnt": 128}, "fwd-misc":{"total": 22.32, "avg": 0.17, "max": 0.12, "min": 0.38, "cnt": 128}, "fwd-MLP":{"total": 1736.04, "avg": 13.56, "max": 11.53, "min": 17.78, "cnt": 128}, "MoE_L0_fwd":{"total": 507.39, "avg": 15.86, "max": 13.05, "min": 17.67, "cnt": 32}, "MoEMLP":{"total": 1718.26, "avg": 13.42, "max": 11.41, "min": 17.63, "cnt": 128}, "MoE_L1_fwd":{"total": 394.36, "avg": 12.32, "max": 11.62, "min": 15.08, "cnt": 32}, "MoE_L2_fwd":{"total": 422.42, "avg": 13.20, "max": 12.51, "min": 15.59, "cnt": 32}, "MoE_L3_fwd":{"total": 400.52, "avg": 12.52, "max": 11.45, "min": 13.82, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 8.26, "avg": 4.13, "max": 1.01, "min": 7.25, "cnt": 2}, "forward-send-backward-recv":{"total": 171.74, "avg": 5.72, "max": 1.60, "min": 111.60, "cnt": 30}, "backward-compute":{"total": 1839.33, "avg": 57.48, "max": 55.71, "min": 59.80, "cnt": 32}, "MoE_L3_bwd":{"total": 411.27, "avg": 12.85, "max": 12.06, "min": 13.89, "cnt": 32}, "MoE_L2_bwd":{"total": 422.08, "avg": 13.19, "max": 12.38, "min": 13.98, "cnt": 32}, "MoE_L1_bwd":{"total": 336.97, "avg": 10.53, "max": 9.82, "min": 12.38, "cnt": 32}, "MoE_L0_bwd":{"total": 452.95, "avg": 14.15, "max": 13.53, "min": 16.80, "cnt": 32}, "backward-send-forward-recv":{"total": 2667.29, "avg": 91.98, "max": 2.54, "min": 500.64, "cnt": 29}, "backward-send":{"total": 2.97, "avg": 0.99, "max": 0.95, "min": 1.02, "cnt": 3}, "backward-recv":{"total": 124.95, "avg": 62.47, "max": 57.19, "min": 67.76, "cnt": 2}, "backward-params-all-reduce":{"total": 486.63, "avg": 486.63, "max": 486.63, "min": 486.63, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 249.78, "avg": 249.78, "max": 249.78, "min": 249.78, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 209.94, "avg": 209.94, "max": 209.94, "min": 209.94, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.33, "avg": 3.33, "max": 3.33, "min": 3.33, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 143, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 84.29, "avg": 28.10, "max": 1.26, "min": 77.74, "cnt": 3}, "forward-compute":{"total": 1908.74, "avg": 59.65, "max": 54.36, "min": 64.72, "cnt": 32}, "fwd-compute":{"total": 1905.54, "avg": 59.55, "max": 54.29, "min": 64.59, "cnt": 32}, "batch-generator":{"total": 40.32, "avg": 1.26, "max": 0.67, "min": 2.73, "cnt": 32}, "fwd-embedding":{"total": 0.62, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1852.80, "avg": 57.90, "max": 53.19, "min": 63.01, "cnt": 32}, "fwd-layernorm":{"total": 9.79, "avg": 0.08, "max": 0.05, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 107.48, "avg": 0.84, "max": 0.74, "min": 1.51, "cnt": 128}, "fwd-misc":{"total": 20.73, "avg": 0.16, "max": 0.11, "min": 0.38, "cnt": 128}, "fwd-MLP":{"total": 1694.20, "avg": 13.24, "max": 11.39, "min": 20.64, "cnt": 128}, "MoE_L0_fwd":{"total": 496.23, "avg": 15.51, "max": 12.92, "min": 20.56, "cnt": 32}, "MoEMLP":{"total": 1677.73, "avg": 13.11, "max": 11.28, "min": 20.52, "cnt": 128}, "MoE_L1_fwd":{"total": 388.82, "avg": 12.15, "max": 11.32, "min": 14.75, "cnt": 32}, "MoE_L2_fwd":{"total": 408.73, "avg": 12.77, "max": 11.80, "min": 15.13, "cnt": 32}, "MoE_L3_fwd":{"total": 390.05, "avg": 12.19, "max": 11.38, "min": 15.66, "cnt": 32}, "fwd-pooler":{"total": 0.37, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.81, "avg": 0.90, "max": 0.89, "min": 0.92, "cnt": 2}, "forward-send-backward-recv":{"total": 310.90, "avg": 10.36, "max": 1.37, "min": 114.62, "cnt": 30}, "backward-compute":{"total": 1863.66, "avg": 58.24, "max": 54.47, "min": 59.69, "cnt": 32}, "MoE_L3_bwd":{"total": 430.91, "avg": 13.47, "max": 12.08, "min": 14.79, "cnt": 32}, "MoE_L2_bwd":{"total": 423.70, "avg": 13.24, "max": 12.52, "min": 14.25, "cnt": 32}, "MoE_L1_bwd":{"total": 343.32, "avg": 10.73, "max": 10.47, "min": 11.06, "cnt": 32}, "MoE_L0_bwd":{"total": 450.98, "avg": 14.09, "max": 13.23, "min": 14.41, "cnt": 32}, "backward-send-forward-recv":{"total": 1568.02, "avg": 54.07, "max": 2.38, "min": 223.03, "cnt": 29}, "backward-send":{"total": 3.14, "avg": 1.05, "max": 1.03, "min": 1.05, "cnt": 3}, "backward-recv":{"total": 116.51, "avg": 58.26, "max": 55.54, "min": 60.97, "cnt": 2}, "backward-params-all-reduce":{"total": 483.88, "avg": 483.88, "max": 483.88, "min": 483.88, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 252.98, "avg": 252.98, "max": 252.98, "min": 252.98, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.36, "avg": 3.36, "max": 3.36, "min": 3.36, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 213.15, "avg": 213.15, "max": 213.15, "min": 213.15, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.50, "avg": 3.50, "max": 3.50, "min": 3.50, "cnt": 1}}}
{"type":"time", "iteration": 144, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 91.26, "avg": 30.42, "max": 1.22, "min": 82.85, "cnt": 3}, "forward-compute":{"total": 1952.72, "avg": 61.02, "max": 55.99, "min": 66.32, "cnt": 32}, "fwd-compute":{"total": 1949.46, "avg": 60.92, "max": 55.91, "min": 66.21, "cnt": 32}, "batch-generator":{"total": 45.39, "avg": 1.42, "max": 0.77, "min": 3.32, "cnt": 32}, "fwd-embedding":{"total": 0.65, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1891.02, "avg": 59.09, "max": 54.14, "min": 64.60, "cnt": 32}, "fwd-layernorm":{"total": 10.04, "avg": 0.08, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 110.02, "avg": 0.86, "max": 0.74, "min": 1.71, "cnt": 128}, "fwd-misc":{"total": 21.75, "avg": 0.17, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1727.41, "avg": 13.50, "max": 11.36, "min": 19.75, "cnt": 128}, "MoE_L0_fwd":{"total": 509.29, "avg": 15.92, "max": 13.08, "min": 19.62, "cnt": 32}, "MoEMLP":{"total": 1710.18, "avg": 13.36, "max": 11.24, "min": 19.55, "cnt": 128}, "MoE_L1_fwd":{"total": 402.28, "avg": 12.57, "max": 11.39, "min": 14.58, "cnt": 32}, "MoE_L2_fwd":{"total": 423.41, "avg": 13.23, "max": 12.04, "min": 16.94, "cnt": 32}, "MoE_L3_fwd":{"total": 381.49, "avg": 11.92, "max": 11.29, "min": 14.12, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.95, "avg": 0.97, "max": 0.96, "min": 0.99, "cnt": 2}, "forward-send-backward-recv":{"total": 248.21, "avg": 8.27, "max": 1.38, "min": 102.98, "cnt": 30}, "backward-compute":{"total": 1887.01, "avg": 58.97, "max": 57.18, "min": 62.16, "cnt": 32}, "MoE_L3_bwd":{"total": 431.71, "avg": 13.49, "max": 12.09, "min": 14.81, "cnt": 32}, "MoE_L2_bwd":{"total": 432.91, "avg": 13.53, "max": 12.83, "min": 16.35, "cnt": 32}, "MoE_L1_bwd":{"total": 356.99, "avg": 11.16, "max": 10.62, "min": 12.66, "cnt": 32}, "MoE_L0_bwd":{"total": 453.09, "avg": 14.16, "max": 13.79, "min": 14.53, "cnt": 32}, "backward-send-forward-recv":{"total": 1845.49, "avg": 63.64, "max": 2.27, "min": 244.83, "cnt": 29}, "backward-send":{"total": 3.04, "avg": 1.01, "max": 0.88, "min": 1.09, "cnt": 3}, "backward-recv":{"total": 121.24, "avg": 60.62, "max": 56.83, "min": 64.41, "cnt": 2}, "backward-params-all-reduce":{"total": 482.40, "avg": 482.40, "max": 482.40, "min": 482.40, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 252.45, "avg": 252.45, "max": 252.45, "min": 252.45, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 212.74, "avg": 212.74, "max": 212.74, "min": 212.74, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.31, "avg": 3.31, "max": 3.31, "min": 3.31, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}}}
{"type":"time", "iteration": 145, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 79.38, "avg": 26.46, "max": 1.44, "min": 73.87, "cnt": 3}, "forward-compute":{"total": 1921.29, "avg": 60.04, "max": 54.44, "min": 63.92, "cnt": 32}, "fwd-compute":{"total": 1918.16, "avg": 59.94, "max": 54.37, "min": 63.82, "cnt": 32}, "batch-generator":{"total": 40.73, "avg": 1.27, "max": 0.66, "min": 2.78, "cnt": 32}, "fwd-embedding":{"total": 0.63, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1865.27, "avg": 58.29, "max": 53.40, "min": 62.04, "cnt": 32}, "fwd-layernorm":{"total": 9.76, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 107.57, "avg": 0.84, "max": 0.74, "min": 1.48, "cnt": 128}, "fwd-misc":{"total": 21.12, "avg": 0.16, "max": 0.12, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1706.01, "avg": 13.33, "max": 10.92, "min": 18.83, "cnt": 128}, "MoE_L0_fwd":{"total": 521.70, "avg": 16.30, "max": 13.37, "min": 18.73, "cnt": 32}, "MoEMLP":{"total": 1689.37, "avg": 13.20, "max": 10.82, "min": 18.68, "cnt": 128}, "MoE_L1_fwd":{"total": 396.94, "avg": 12.40, "max": 11.49, "min": 13.58, "cnt": 32}, "MoE_L2_fwd":{"total": 406.98, "avg": 12.72, "max": 12.34, "min": 13.37, "cnt": 32}, "MoE_L3_fwd":{"total": 369.88, "avg": 11.56, "max": 10.85, "min": 12.75, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.05, "cnt": 32}, "forward-send":{"total": 1.82, "avg": 0.91, "max": 0.89, "min": 0.94, "cnt": 2}, "forward-send-backward-recv":{"total": 543.50, "avg": 18.12, "max": 1.84, "min": 115.99, "cnt": 30}, "backward-compute":{"total": 1867.08, "avg": 58.35, "max": 56.39, "min": 60.70, "cnt": 32}, "MoE_L3_bwd":{"total": 419.83, "avg": 13.12, "max": 12.14, "min": 14.82, "cnt": 32}, "MoE_L2_bwd":{"total": 430.68, "avg": 13.46, "max": 12.70, "min": 15.87, "cnt": 32}, "MoE_L1_bwd":{"total": 353.01, "avg": 11.03, "max": 10.60, "min": 11.79, "cnt": 32}, "MoE_L0_bwd":{"total": 450.91, "avg": 14.09, "max": 13.62, "min": 14.61, "cnt": 32}, "backward-send-forward-recv":{"total": 3154.24, "avg": 108.77, "max": 1.71, "min": 558.39, "cnt": 29}, "backward-send":{"total": 3.35, "avg": 1.12, "max": 1.11, "min": 1.12, "cnt": 3}, "backward-recv":{"total": 153.96, "avg": 76.98, "max": 71.24, "min": 82.72, "cnt": 2}, "backward-params-all-reduce":{"total": 488.88, "avg": 488.88, "max": 488.88, "min": 488.88, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 243.63, "avg": 243.63, "max": 243.63, "min": 243.63, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 203.82, "avg": 203.82, "max": 203.82, "min": 203.82, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.36, "avg": 3.36, "max": 3.36, "min": 3.36, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 146, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 82.78, "avg": 27.59, "max": 1.27, "min": 77.90, "cnt": 3}, "forward-compute":{"total": 1932.56, "avg": 60.39, "max": 54.78, "min": 63.89, "cnt": 32}, "fwd-compute":{"total": 1929.09, "avg": 60.28, "max": 54.71, "min": 63.81, "cnt": 32}, "batch-generator":{"total": 42.37, "avg": 1.32, "max": 0.73, "min": 2.03, "cnt": 32}, "fwd-embedding":{"total": 0.69, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1873.47, "avg": 58.55, "max": 53.66, "min": 62.37, "cnt": 32}, "fwd-layernorm":{"total": 10.21, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 111.07, "avg": 0.87, "max": 0.74, "min": 2.34, "cnt": 128}, "fwd-misc":{"total": 21.59, "avg": 0.17, "max": 0.12, "min": 0.41, "cnt": 128}, "fwd-MLP":{"total": 1708.35, "avg": 13.35, "max": 11.12, "min": 18.87, "cnt": 128}, "MoE_L0_fwd":{"total": 502.58, "avg": 15.71, "max": 12.94, "min": 18.79, "cnt": 32}, "MoEMLP":{"total": 1690.89, "avg": 13.21, "max": 11.01, "min": 18.72, "cnt": 128}, "MoE_L1_fwd":{"total": 400.51, "avg": 12.52, "max": 11.53, "min": 15.62, "cnt": 32}, "MoE_L2_fwd":{"total": 416.35, "avg": 13.01, "max": 12.42, "min": 17.13, "cnt": 32}, "MoE_L3_fwd":{"total": 377.81, "avg": 11.81, "max": 11.05, "min": 13.98, "cnt": 32}, "fwd-pooler":{"total": 0.36, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.61, "avg": 0.02, "max": 0.02, "min": 0.05, "cnt": 32}, "forward-send":{"total": 1.89, "avg": 0.94, "max": 0.93, "min": 0.95, "cnt": 2}, "forward-send-backward-recv":{"total": 187.15, "avg": 6.24, "max": 1.33, "min": 107.07, "cnt": 30}, "backward-compute":{"total": 1852.57, "avg": 57.89, "max": 55.97, "min": 60.68, "cnt": 32}, "MoE_L3_bwd":{"total": 402.17, "avg": 12.57, "max": 11.26, "min": 14.02, "cnt": 32}, "MoE_L2_bwd":{"total": 429.90, "avg": 13.43, "max": 12.79, "min": 14.43, "cnt": 32}, "MoE_L1_bwd":{"total": 361.17, "avg": 11.29, "max": 10.82, "min": 11.92, "cnt": 32}, "MoE_L0_bwd":{"total": 445.85, "avg": 13.93, "max": 13.29, "min": 15.12, "cnt": 32}, "backward-send-forward-recv":{"total": 1825.97, "avg": 62.96, "max": 2.37, "min": 397.10, "cnt": 29}, "backward-send":{"total": 2.75, "avg": 0.92, "max": 0.78, "min": 1.17, "cnt": 3}, "backward-recv":{"total": 130.03, "avg": 65.01, "max": 58.04, "min": 71.99, "cnt": 2}, "backward-params-all-reduce":{"total": 490.22, "avg": 490.22, "max": 490.22, "min": 490.22, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 239.63, "avg": 239.63, "max": 239.63, "min": 239.63, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 199.72, "avg": 199.72, "max": 199.72, "min": 199.72, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.57, "avg": 3.57, "max": 3.57, "min": 3.57, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 147, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 75.38, "avg": 25.13, "max": 1.37, "min": 69.75, "cnt": 3}, "forward-compute":{"total": 1947.60, "avg": 60.86, "max": 56.19, "min": 69.64, "cnt": 32}, "fwd-compute":{"total": 1944.30, "avg": 60.76, "max": 56.10, "min": 69.55, "cnt": 32}, "batch-generator":{"total": 45.18, "avg": 1.41, "max": 0.66, "min": 3.05, "cnt": 32}, "fwd-embedding":{"total": 0.58, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1885.84, "avg": 58.93, "max": 54.36, "min": 68.20, "cnt": 32}, "fwd-layernorm":{"total": 10.17, "avg": 0.08, "max": 0.06, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 108.17, "avg": 0.85, "max": 0.74, "min": 1.57, "cnt": 128}, "fwd-misc":{"total": 21.39, "avg": 0.17, "max": 0.11, "min": 0.40, "cnt": 128}, "fwd-MLP":{"total": 1723.17, "avg": 13.46, "max": 11.05, "min": 18.70, "cnt": 128}, "MoE_L0_fwd":{"total": 508.17, "avg": 15.88, "max": 13.43, "min": 18.54, "cnt": 32}, "MoEMLP":{"total": 1705.62, "avg": 13.33, "max": 10.95, "min": 18.46, "cnt": 128}, "MoE_L1_fwd":{"total": 399.11, "avg": 12.47, "max": 11.46, "min": 14.87, "cnt": 32}, "MoE_L2_fwd":{"total": 421.24, "avg": 13.16, "max": 12.20, "min": 18.40, "cnt": 32}, "MoE_L3_fwd":{"total": 383.50, "avg": 11.98, "max": 10.99, "min": 15.02, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.83, "avg": 0.91, "max": 0.91, "min": 0.92, "cnt": 2}, "forward-send-backward-recv":{"total": 184.60, "avg": 6.15, "max": 1.22, "min": 114.30, "cnt": 30}, "backward-compute":{"total": 1921.37, "avg": 60.04, "max": 55.62, "min": 122.66, "cnt": 32}, "MoE_L3_bwd":{"total": 464.62, "avg": 14.52, "max": 11.20, "min": 77.11, "cnt": 32}, "MoE_L2_bwd":{"total": 430.48, "avg": 13.45, "max": 12.58, "min": 15.73, "cnt": 32}, "MoE_L1_bwd":{"total": 365.84, "avg": 11.43, "max": 11.02, "min": 11.80, "cnt": 32}, "MoE_L0_bwd":{"total": 447.00, "avg": 13.97, "max": 13.39, "min": 14.41, "cnt": 32}, "backward-send-forward-recv":{"total": 2334.87, "avg": 80.51, "max": 1.10, "min": 524.49, "cnt": 29}, "backward-send":{"total": 3.09, "avg": 1.03, "max": 0.84, "min": 1.21, "cnt": 3}, "backward-recv":{"total": 181.91, "avg": 90.95, "max": 55.93, "min": 125.98, "cnt": 2}, "backward-params-all-reduce":{"total": 485.45, "avg": 485.45, "max": 485.45, "min": 485.45, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.04, "avg": 0.04, "max": 0.04, "min": 0.04, "cnt": 1}, "optimizer":{"total": 252.05, "avg": 252.05, "max": 252.05, "min": 252.05, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 211.57, "avg": 211.57, "max": 211.57, "min": 211.57, "cnt": 1}, "optimizer-clip-main-grad":{"total": 4.19, "avg": 4.19, "max": 4.19, "min": 4.19, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 148, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 93.70, "avg": 31.23, "max": 1.32, "min": 80.95, "cnt": 3}, "forward-compute":{"total": 1957.86, "avg": 61.18, "max": 55.14, "min": 74.97, "cnt": 32}, "fwd-compute":{"total": 1954.44, "avg": 61.08, "max": 55.07, "min": 74.90, "cnt": 32}, "batch-generator":{"total": 45.55, "avg": 1.42, "max": 0.61, "min": 2.38, "cnt": 32}, "fwd-embedding":{"total": 0.68, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1895.43, "avg": 59.23, "max": 54.16, "min": 73.59, "cnt": 32}, "fwd-layernorm":{"total": 10.54, "avg": 0.08, "max": 0.06, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 114.47, "avg": 0.89, "max": 0.74, "min": 2.35, "cnt": 128}, "fwd-misc":{"total": 22.03, "avg": 0.17, "max": 0.12, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1725.25, "avg": 13.48, "max": 10.68, "min": 32.22, "cnt": 128}, "MoE_L0_fwd":{"total": 548.26, "avg": 17.13, "max": 13.05, "min": 32.14, "cnt": 32}, "MoEMLP":{"total": 1707.50, "avg": 13.34, "max": 10.58, "min": 32.09, "cnt": 128}, "MoE_L1_fwd":{"total": 394.32, "avg": 12.32, "max": 11.58, "min": 14.66, "cnt": 32}, "MoE_L2_fwd":{"total": 405.89, "avg": 12.68, "max": 12.28, "min": 13.74, "cnt": 32}, "MoE_L3_fwd":{"total": 365.47, "avg": 11.42, "max": 10.62, "min": 12.63, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.79, "avg": 0.90, "max": 0.85, "min": 0.94, "cnt": 2}, "forward-send-backward-recv":{"total": 159.44, "avg": 5.31, "max": 1.07, "min": 97.85, "cnt": 30}, "backward-compute":{"total": 1837.72, "avg": 57.43, "max": 55.29, "min": 59.12, "cnt": 32}, "MoE_L3_bwd":{"total": 389.98, "avg": 12.19, "max": 11.66, "min": 14.08, "cnt": 32}, "MoE_L2_bwd":{"total": 416.56, "avg": 13.02, "max": 12.23, "min": 13.70, "cnt": 32}, "MoE_L1_bwd":{"total": 363.34, "avg": 11.35, "max": 10.64, "min": 11.82, "cnt": 32}, "MoE_L0_bwd":{"total": 450.66, "avg": 14.08, "max": 13.54, "min": 15.62, "cnt": 32}, "backward-send-forward-recv":{"total": 3621.81, "avg": 124.89, "max": 2.24, "min": 1005.93, "cnt": 29}, "backward-send":{"total": 2.61, "avg": 0.87, "max": 0.66, "min": 1.06, "cnt": 3}, "backward-recv":{"total": 133.18, "avg": 66.59, "max": 51.70, "min": 81.48, "cnt": 2}, "backward-params-all-reduce":{"total": 482.10, "avg": 482.10, "max": 482.10, "min": 482.10, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 249.13, "avg": 249.13, "max": 249.13, "min": 249.13, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 209.31, "avg": 209.31, "max": 209.31, "min": 209.31, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.41, "avg": 3.41, "max": 3.41, "min": 3.41, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 149, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 77.65, "avg": 25.88, "max": 1.38, "min": 74.80, "cnt": 3}, "forward-compute":{"total": 1903.52, "avg": 59.49, "max": 54.23, "min": 64.99, "cnt": 32}, "fwd-compute":{"total": 1900.39, "avg": 59.39, "max": 54.15, "min": 64.92, "cnt": 32}, "batch-generator":{"total": 36.60, "avg": 1.14, "max": 0.68, "min": 2.19, "cnt": 32}, "fwd-embedding":{"total": 0.60, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1851.05, "avg": 57.85, "max": 53.14, "min": 62.45, "cnt": 32}, "fwd-layernorm":{"total": 9.62, "avg": 0.08, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 108.53, "avg": 0.85, "max": 0.74, "min": 2.03, "cnt": 128}, "fwd-misc":{"total": 21.37, "avg": 0.17, "max": 0.11, "min": 0.49, "cnt": 128}, "fwd-MLP":{"total": 1690.52, "avg": 13.21, "max": 10.70, "min": 19.62, "cnt": 128}, "MoE_L0_fwd":{"total": 503.98, "avg": 15.75, "max": 12.89, "min": 19.51, "cnt": 32}, "MoEMLP":{"total": 1673.88, "avg": 13.08, "max": 10.60, "min": 19.45, "cnt": 128}, "MoE_L1_fwd":{"total": 396.87, "avg": 12.40, "max": 11.66, "min": 13.58, "cnt": 32}, "MoE_L2_fwd":{"total": 412.26, "avg": 12.88, "max": 12.26, "min": 13.97, "cnt": 32}, "MoE_L3_fwd":{"total": 366.87, "avg": 11.46, "max": 10.64, "min": 13.98, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.68, "avg": 0.84, "max": 0.83, "min": 0.84, "cnt": 2}, "forward-send-backward-recv":{"total": 501.10, "avg": 16.70, "max": 1.30, "min": 173.92, "cnt": 30}, "backward-compute":{"total": 1877.85, "avg": 58.68, "max": 55.83, "min": 60.98, "cnt": 32}, "MoE_L3_bwd":{"total": 413.77, "avg": 12.93, "max": 11.52, "min": 15.45, "cnt": 32}, "MoE_L2_bwd":{"total": 426.58, "avg": 13.33, "max": 12.68, "min": 14.15, "cnt": 32}, "MoE_L1_bwd":{"total": 371.62, "avg": 11.61, "max": 11.06, "min": 12.74, "cnt": 32}, "MoE_L0_bwd":{"total": 451.32, "avg": 14.10, "max": 13.48, "min": 14.54, "cnt": 32}, "backward-send-forward-recv":{"total": 2287.36, "avg": 78.87, "max": 2.39, "min": 419.96, "cnt": 29}, "backward-send":{"total": 2.53, "avg": 0.84, "max": 0.75, "min": 0.91, "cnt": 3}, "backward-recv":{"total": 362.91, "avg": 181.46, "max": 68.07, "min": 294.84, "cnt": 2}, "backward-params-all-reduce":{"total": 485.88, "avg": 485.88, "max": 485.88, "min": 485.88, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 240.70, "avg": 240.70, "max": 240.70, "min": 240.70, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 200.67, "avg": 200.67, "max": 200.67, "min": 200.67, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.73, "avg": 3.73, "max": 3.73, "min": 3.73, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 150, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 73.72, "avg": 24.57, "max": 1.37, "min": 70.96, "cnt": 3}, "forward-compute":{"total": 1952.47, "avg": 61.01, "max": 54.47, "min": 69.79, "cnt": 32}, "fwd-compute":{"total": 1948.97, "avg": 60.91, "max": 54.39, "min": 69.69, "cnt": 32}, "batch-generator":{"total": 50.60, "avg": 1.58, "max": 0.76, "min": 4.13, "cnt": 32}, "fwd-embedding":{"total": 0.71, "avg": 0.02, "max": 0.01, "min": 0.06, "cnt": 32}, "fwd-encoder":{"total": 1884.08, "avg": 58.88, "max": 53.16, "min": 66.05, "cnt": 32}, "fwd-layernorm":{"total": 10.92, "avg": 0.09, "max": 0.06, "min": 0.22, "cnt": 128}, "fwd-attn":{"total": 112.17, "avg": 0.88, "max": 0.74, "min": 1.87, "cnt": 128}, "fwd-misc":{"total": 22.56, "avg": 0.18, "max": 0.12, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1714.46, "avg": 13.39, "max": 10.95, "min": 21.35, "cnt": 128}, "MoE_L0_fwd":{"total": 511.90, "avg": 16.00, "max": 12.83, "min": 21.19, "cnt": 32}, "MoEMLP":{"total": 1696.22, "avg": 13.25, "max": 10.85, "min": 21.10, "cnt": 128}, "MoE_L1_fwd":{"total": 409.12, "avg": 12.79, "max": 11.46, "min": 16.79, "cnt": 32}, "MoE_L2_fwd":{"total": 413.18, "avg": 12.91, "max": 12.22, "min": 14.38, "cnt": 32}, "MoE_L3_fwd":{"total": 368.71, "avg": 11.52, "max": 10.89, "min": 13.05, "cnt": 32}, "fwd-pooler":{"total": 0.37, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.61, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.76, "avg": 0.88, "max": 0.84, "min": 0.91, "cnt": 2}, "forward-send-backward-recv":{"total": 558.62, "avg": 18.62, "max": 1.33, "min": 138.03, "cnt": 30}, "backward-compute":{"total": 1857.07, "avg": 58.03, "max": 56.67, "min": 60.40, "cnt": 32}, "MoE_L3_bwd":{"total": 406.00, "avg": 12.69, "max": 11.68, "min": 16.25, "cnt": 32}, "MoE_L2_bwd":{"total": 418.36, "avg": 13.07, "max": 12.50, "min": 14.65, "cnt": 32}, "MoE_L1_bwd":{"total": 363.27, "avg": 11.35, "max": 11.00, "min": 11.99, "cnt": 32}, "MoE_L0_bwd":{"total": 447.62, "avg": 13.99, "max": 13.44, "min": 14.30, "cnt": 32}, "backward-send-forward-recv":{"total": 2158.54, "avg": 74.43, "max": 2.20, "min": 308.18, "cnt": 29}, "backward-send":{"total": 3.17, "avg": 1.06, "max": 1.03, "min": 1.11, "cnt": 3}, "backward-recv":{"total": 127.78, "avg": 63.89, "max": 63.83, "min": 63.95, "cnt": 2}, "backward-params-all-reduce":{"total": 488.96, "avg": 488.96, "max": 488.96, "min": 488.96, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 239.82, "avg": 239.82, "max": 239.82, "min": 239.82, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.36, "avg": 3.36, "max": 3.36, "min": 3.36, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 199.64, "avg": 199.64, "max": 199.64, "min": 199.64, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.63, "avg": 3.63, "max": 3.63, "min": 3.63, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 151, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 81.23, "avg": 27.08, "max": 1.31, "min": 78.34, "cnt": 3}, "forward-compute":{"total": 1891.67, "avg": 59.11, "max": 54.01, "min": 65.22, "cnt": 32}, "fwd-compute":{"total": 1888.47, "avg": 59.01, "max": 53.94, "min": 65.11, "cnt": 32}, "batch-generator":{"total": 54.09, "avg": 1.69, "max": 0.62, "min": 4.28, "cnt": 32}, "fwd-embedding":{"total": 0.62, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1821.79, "avg": 56.93, "max": 52.85, "min": 62.78, "cnt": 32}, "fwd-layernorm":{"total": 9.94, "avg": 0.08, "max": 0.06, "min": 0.22, "cnt": 128}, "fwd-attn":{"total": 107.62, "avg": 0.84, "max": 0.74, "min": 1.77, "cnt": 128}, "fwd-misc":{"total": 21.43, "avg": 0.17, "max": 0.12, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1661.50, "avg": 12.98, "max": 10.75, "min": 19.86, "cnt": 128}, "MoE_L0_fwd":{"total": 489.51, "avg": 15.30, "max": 12.96, "min": 19.78, "cnt": 32}, "MoEMLP":{"total": 1644.44, "avg": 12.85, "max": 10.64, "min": 19.73, "cnt": 128}, "MoE_L1_fwd":{"total": 391.41, "avg": 12.23, "max": 11.36, "min": 14.72, "cnt": 32}, "MoE_L2_fwd":{"total": 404.75, "avg": 12.65, "max": 12.10, "min": 13.51, "cnt": 32}, "MoE_L3_fwd":{"total": 365.11, "avg": 11.41, "max": 10.68, "min": 14.41, "cnt": 32}, "fwd-pooler":{"total": 0.38, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 12.59, "avg": 6.30, "max": 0.94, "min": 11.65, "cnt": 2}, "forward-send-backward-recv":{"total": 209.86, "avg": 7.00, "max": 1.18, "min": 111.60, "cnt": 30}, "backward-compute":{"total": 1859.05, "avg": 58.10, "max": 56.46, "min": 61.19, "cnt": 32}, "MoE_L3_bwd":{"total": 387.61, "avg": 12.11, "max": 11.32, "min": 13.42, "cnt": 32}, "MoE_L2_bwd":{"total": 427.32, "avg": 13.35, "max": 12.34, "min": 16.06, "cnt": 32}, "MoE_L1_bwd":{"total": 367.97, "avg": 11.50, "max": 10.81, "min": 12.69, "cnt": 32}, "MoE_L0_bwd":{"total": 456.25, "avg": 14.26, "max": 13.76, "min": 15.18, "cnt": 32}, "backward-send-forward-recv":{"total": 2635.67, "avg": 90.89, "max": 2.09, "min": 763.47, "cnt": 29}, "backward-send":{"total": 2.70, "avg": 0.90, "max": 0.81, "min": 0.95, "cnt": 3}, "backward-recv":{"total": 237.94, "avg": 118.97, "max": 73.88, "min": 164.06, "cnt": 2}, "backward-params-all-reduce":{"total": 483.55, "avg": 483.55, "max": 483.55, "min": 483.55, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 248.39, "avg": 248.39, "max": 248.39, "min": 248.39, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.36, "avg": 3.36, "max": 3.36, "min": 3.36, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 208.53, "avg": 208.53, "max": 208.53, "min": 208.53, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}}}
{"type":"time", "iteration": 152, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 75.25, "avg": 25.08, "max": 0.83, "min": 73.09, "cnt": 3}, "forward-compute":{"total": 1920.57, "avg": 60.02, "max": 54.70, "min": 65.56, "cnt": 32}, "fwd-compute":{"total": 1917.12, "avg": 59.91, "max": 54.63, "min": 65.48, "cnt": 32}, "batch-generator":{"total": 43.51, "avg": 1.36, "max": 0.71, "min": 2.78, "cnt": 32}, "fwd-embedding":{"total": 0.77, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1860.27, "avg": 58.13, "max": 53.58, "min": 62.24, "cnt": 32}, "fwd-layernorm":{"total": 10.58, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 114.13, "avg": 0.89, "max": 0.74, "min": 1.80, "cnt": 128}, "fwd-misc":{"total": 22.15, "avg": 0.17, "max": 0.12, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1690.80, "avg": 13.21, "max": 10.85, "min": 17.86, "cnt": 128}, "MoE_L0_fwd":{"total": 512.67, "avg": 16.02, "max": 13.26, "min": 17.74, "cnt": 32}, "MoEMLP":{"total": 1672.98, "avg": 13.07, "max": 10.74, "min": 17.67, "cnt": 128}, "MoE_L1_fwd":{"total": 400.00, "avg": 12.50, "max": 11.31, "min": 15.75, "cnt": 32}, "MoE_L2_fwd":{"total": 405.21, "avg": 12.66, "max": 12.16, "min": 14.62, "cnt": 32}, "MoE_L3_fwd":{"total": 361.55, "avg": 11.30, "max": 10.78, "min": 13.07, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 5.05, "avg": 2.52, "max": 0.95, "min": 4.10, "cnt": 2}, "forward-send-backward-recv":{"total": 294.47, "avg": 9.82, "max": 1.67, "min": 114.27, "cnt": 30}, "backward-compute":{"total": 1845.02, "avg": 57.66, "max": 55.98, "min": 63.04, "cnt": 32}, "MoE_L3_bwd":{"total": 393.65, "avg": 12.30, "max": 11.39, "min": 19.10, "cnt": 32}, "MoE_L2_bwd":{"total": 417.92, "avg": 13.06, "max": 12.27, "min": 17.17, "cnt": 32}, "MoE_L1_bwd":{"total": 365.26, "avg": 11.41, "max": 10.67, "min": 13.14, "cnt": 32}, "MoE_L0_bwd":{"total": 449.32, "avg": 14.04, "max": 13.70, "min": 14.58, "cnt": 32}, "backward-send-forward-recv":{"total": 922.60, "avg": 31.81, "max": 2.20, "min": 182.37, "cnt": 29}, "backward-send":{"total": 2.58, "avg": 0.86, "max": 0.53, "min": 1.14, "cnt": 3}, "backward-recv":{"total": 194.67, "avg": 97.33, "max": 95.89, "min": 98.78, "cnt": 2}, "backward-params-all-reduce":{"total": 486.14, "avg": 486.14, "max": 486.14, "min": 486.14, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 245.31, "avg": 245.31, "max": 245.31, "min": 245.31, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.40, "avg": 3.40, "max": 3.40, "min": 3.40, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 204.86, "avg": 204.86, "max": 204.86, "min": 204.86, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.89, "avg": 3.89, "max": 3.89, "min": 3.89, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 153, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 80.38, "avg": 26.79, "max": 1.33, "min": 77.69, "cnt": 3}, "forward-compute":{"total": 1896.93, "avg": 59.28, "max": 54.45, "min": 65.28, "cnt": 32}, "fwd-compute":{"total": 1893.46, "avg": 59.17, "max": 54.37, "min": 65.14, "cnt": 32}, "batch-generator":{"total": 49.99, "avg": 1.56, "max": 0.68, "min": 4.30, "cnt": 32}, "fwd-embedding":{"total": 0.72, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1830.70, "avg": 57.21, "max": 52.10, "min": 63.14, "cnt": 32}, "fwd-layernorm":{"total": 10.16, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 109.15, "avg": 0.85, "max": 0.74, "min": 1.49, "cnt": 128}, "fwd-misc":{"total": 21.23, "avg": 0.17, "max": 0.11, "min": 0.38, "cnt": 128}, "fwd-MLP":{"total": 1668.66, "avg": 13.04, "max": 10.49, "min": 19.52, "cnt": 128}, "MoE_L0_fwd":{"total": 505.13, "avg": 15.79, "max": 12.86, "min": 19.36, "cnt": 32}, "MoEMLP":{"total": 1651.69, "avg": 12.90, "max": 10.38, "min": 19.27, "cnt": 128}, "MoE_L1_fwd":{"total": 395.76, "avg": 12.37, "max": 11.56, "min": 15.78, "cnt": 32}, "MoE_L2_fwd":{"total": 404.37, "avg": 12.64, "max": 11.93, "min": 15.18, "cnt": 32}, "MoE_L3_fwd":{"total": 352.69, "avg": 11.02, "max": 10.42, "min": 12.08, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.93, "avg": 0.96, "max": 0.95, "min": 0.98, "cnt": 2}, "forward-send-backward-recv":{"total": 177.51, "avg": 5.92, "max": 1.82, "min": 112.78, "cnt": 30}, "backward-compute":{"total": 1812.77, "avg": 56.65, "max": 55.04, "min": 58.27, "cnt": 32}, "MoE_L3_bwd":{"total": 376.82, "avg": 11.78, "max": 11.22, "min": 13.07, "cnt": 32}, "MoE_L2_bwd":{"total": 408.61, "avg": 12.77, "max": 11.67, "min": 14.55, "cnt": 32}, "MoE_L1_bwd":{"total": 354.91, "avg": 11.09, "max": 10.60, "min": 11.68, "cnt": 32}, "MoE_L0_bwd":{"total": 455.49, "avg": 14.23, "max": 13.61, "min": 15.79, "cnt": 32}, "backward-send-forward-recv":{"total": 2002.40, "avg": 69.05, "max": 2.36, "min": 525.93, "cnt": 29}, "backward-send":{"total": 2.65, "avg": 0.88, "max": 0.79, "min": 0.96, "cnt": 3}, "backward-recv":{"total": 120.71, "avg": 60.35, "max": 56.03, "min": 64.68, "cnt": 2}, "backward-params-all-reduce":{"total": 486.52, "avg": 486.52, "max": 486.52, "min": 486.52, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 244.42, "avg": 244.42, "max": 244.42, "min": 244.42, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.36, "avg": 3.36, "max": 3.36, "min": 3.36, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 204.50, "avg": 204.50, "max": 204.50, "min": 204.50, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.54, "avg": 3.54, "max": 3.54, "min": 3.54, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 154, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 87.45, "avg": 29.15, "max": 1.25, "min": 83.53, "cnt": 3}, "forward-compute":{"total": 1869.03, "avg": 58.41, "max": 54.22, "min": 66.81, "cnt": 32}, "fwd-compute":{"total": 1865.80, "avg": 58.31, "max": 54.14, "min": 66.67, "cnt": 32}, "batch-generator":{"total": 37.60, "avg": 1.17, "max": 0.66, "min": 1.94, "cnt": 32}, "fwd-embedding":{"total": 0.58, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1815.10, "avg": 56.72, "max": 53.07, "min": 64.51, "cnt": 32}, "fwd-layernorm":{"total": 9.35, "avg": 0.07, "max": 0.06, "min": 0.17, "cnt": 128}, "fwd-attn":{"total": 104.38, "avg": 0.82, "max": 0.74, "min": 1.47, "cnt": 128}, "fwd-misc":{"total": 20.27, "avg": 0.16, "max": 0.11, "min": 0.34, "cnt": 128}, "fwd-MLP":{"total": 1660.55, "avg": 12.97, "max": 10.75, "min": 19.60, "cnt": 128}, "MoE_L0_fwd":{"total": 493.23, "avg": 15.41, "max": 13.13, "min": 19.45, "cnt": 32}, "MoEMLP":{"total": 1644.33, "avg": 12.85, "max": 10.64, "min": 19.36, "cnt": 128}, "MoE_L1_fwd":{"total": 391.77, "avg": 12.24, "max": 11.21, "min": 16.26, "cnt": 32}, "MoE_L2_fwd":{"total": 403.39, "avg": 12.61, "max": 12.13, "min": 13.68, "cnt": 32}, "MoE_L3_fwd":{"total": 361.89, "avg": 11.31, "max": 10.68, "min": 13.94, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.61, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.50, "avg": 0.75, "max": 0.75, "min": 0.75, "cnt": 2}, "forward-send-backward-recv":{"total": 169.46, "avg": 5.65, "max": 1.44, "min": 106.36, "cnt": 30}, "backward-compute":{"total": 1805.66, "avg": 56.43, "max": 54.67, "min": 57.99, "cnt": 32}, "MoE_L3_bwd":{"total": 379.71, "avg": 11.87, "max": 11.13, "min": 12.80, "cnt": 32}, "MoE_L2_bwd":{"total": 409.51, "avg": 12.80, "max": 11.91, "min": 13.96, "cnt": 32}, "MoE_L1_bwd":{"total": 346.54, "avg": 10.83, "max": 10.18, "min": 11.24, "cnt": 32}, "MoE_L0_bwd":{"total": 451.05, "avg": 14.10, "max": 13.59, "min": 14.50, "cnt": 32}, "backward-send-forward-recv":{"total": 1486.65, "avg": 51.26, "max": 1.57, "min": 182.14, "cnt": 29}, "backward-send":{"total": 2.48, "avg": 0.83, "max": 0.59, "min": 0.97, "cnt": 3}, "backward-recv":{"total": 123.35, "avg": 61.68, "max": 54.30, "min": 69.05, "cnt": 2}, "backward-params-all-reduce":{"total": 487.77, "avg": 487.77, "max": 487.77, "min": 487.77, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 243.68, "avg": 243.68, "max": 243.68, "min": 243.68, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.36, "avg": 3.36, "max": 3.36, "min": 3.36, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 203.38, "avg": 203.38, "max": 203.38, "min": 203.38, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.95, "avg": 3.95, "max": 3.95, "min": 3.95, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}}}
{"type":"time", "iteration": 155, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 71.67, "avg": 23.89, "max": 0.72, "min": 69.23, "cnt": 3}, "forward-compute":{"total": 1887.78, "avg": 58.99, "max": 53.54, "min": 67.75, "cnt": 32}, "fwd-compute":{"total": 1884.57, "avg": 58.89, "max": 53.47, "min": 67.64, "cnt": 32}, "batch-generator":{"total": 40.02, "avg": 1.25, "max": 0.70, "min": 2.43, "cnt": 32}, "fwd-embedding":{"total": 0.54, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1832.03, "avg": 57.25, "max": 52.43, "min": 65.95, "cnt": 32}, "fwd-layernorm":{"total": 9.30, "avg": 0.07, "max": 0.06, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 106.15, "avg": 0.83, "max": 0.74, "min": 1.82, "cnt": 128}, "fwd-misc":{"total": 20.42, "avg": 0.16, "max": 0.12, "min": 0.42, "cnt": 128}, "fwd-MLP":{"total": 1675.53, "avg": 13.09, "max": 10.47, "min": 19.59, "cnt": 128}, "MoE_L0_fwd":{"total": 509.65, "avg": 15.93, "max": 13.21, "min": 19.45, "cnt": 32}, "MoEMLP":{"total": 1659.25, "avg": 12.96, "max": 10.36, "min": 19.37, "cnt": 128}, "MoE_L1_fwd":{"total": 390.93, "avg": 12.22, "max": 11.29, "min": 16.78, "cnt": 32}, "MoE_L2_fwd":{"total": 405.40, "avg": 12.67, "max": 11.91, "min": 14.85, "cnt": 32}, "MoE_L3_fwd":{"total": 359.28, "avg": 11.23, "max": 10.40, "min": 12.65, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 8.90, "avg": 4.45, "max": 0.92, "min": 7.99, "cnt": 2}, "forward-send-backward-recv":{"total": 184.80, "avg": 6.16, "max": 1.45, "min": 118.90, "cnt": 30}, "backward-compute":{"total": 1798.47, "avg": 56.20, "max": 54.09, "min": 61.24, "cnt": 32}, "MoE_L3_bwd":{"total": 377.66, "avg": 11.80, "max": 11.01, "min": 12.70, "cnt": 32}, "MoE_L2_bwd":{"total": 407.64, "avg": 12.74, "max": 11.68, "min": 14.78, "cnt": 32}, "MoE_L1_bwd":{"total": 344.28, "avg": 10.76, "max": 10.14, "min": 11.17, "cnt": 32}, "MoE_L0_bwd":{"total": 450.90, "avg": 14.09, "max": 13.66, "min": 15.96, "cnt": 32}, "backward-send-forward-recv":{"total": 4139.37, "avg": 142.74, "max": 2.32, "min": 720.25, "cnt": 29}, "backward-send":{"total": 3.03, "avg": 1.01, "max": 0.87, "min": 1.09, "cnt": 3}, "backward-recv":{"total": 121.17, "avg": 60.58, "max": 53.88, "min": 67.29, "cnt": 2}, "backward-params-all-reduce":{"total": 496.89, "avg": 496.89, "max": 496.89, "min": 496.89, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 231.57, "avg": 231.57, "max": 231.57, "min": 231.57, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 191.74, "avg": 191.74, "max": 191.74, "min": 191.74, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.30, "avg": 3.30, "max": 3.30, "min": 3.30, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 156, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 76.25, "avg": 25.42, "max": 1.26, "min": 73.73, "cnt": 3}, "forward-compute":{"total": 1954.81, "avg": 61.09, "max": 52.08, "min": 104.54, "cnt": 32}, "fwd-compute":{"total": 1951.47, "avg": 60.98, "max": 52.02, "min": 104.44, "cnt": 32}, "batch-generator":{"total": 44.93, "avg": 1.40, "max": 0.62, "min": 2.90, "cnt": 32}, "fwd-embedding":{"total": 0.67, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1893.57, "avg": 59.17, "max": 51.03, "min": 101.75, "cnt": 32}, "fwd-layernorm":{"total": 10.08, "avg": 0.08, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 109.45, "avg": 0.86, "max": 0.74, "min": 1.83, "cnt": 128}, "fwd-misc":{"total": 21.82, "avg": 0.17, "max": 0.11, "min": 0.39, "cnt": 128}, "fwd-MLP":{"total": 1730.62, "avg": 13.52, "max": 10.52, "min": 61.54, "cnt": 128}, "MoE_L0_fwd":{"total": 575.87, "avg": 18.00, "max": 12.60, "min": 60.98, "cnt": 32}, "MoEMLP":{"total": 1713.05, "avg": 13.38, "max": 10.41, "min": 60.93, "cnt": 128}, "MoE_L1_fwd":{"total": 382.41, "avg": 11.95, "max": 11.01, "min": 13.49, "cnt": 32}, "MoE_L2_fwd":{"total": 399.81, "avg": 12.49, "max": 11.59, "min": 14.88, "cnt": 32}, "MoE_L3_fwd":{"total": 361.20, "avg": 11.29, "max": 10.45, "min": 13.43, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.71, "avg": 0.86, "max": 0.82, "min": 0.90, "cnt": 2}, "forward-send-backward-recv":{"total": 620.55, "avg": 20.69, "max": 1.27, "min": 182.31, "cnt": 30}, "backward-compute":{"total": 1801.42, "avg": 56.29, "max": 54.10, "min": 64.05, "cnt": 32}, "MoE_L3_bwd":{"total": 391.12, "avg": 12.22, "max": 11.01, "min": 14.13, "cnt": 32}, "MoE_L2_bwd":{"total": 404.66, "avg": 12.65, "max": 11.74, "min": 19.76, "cnt": 32}, "MoE_L1_bwd":{"total": 337.42, "avg": 10.54, "max": 9.98, "min": 11.82, "cnt": 32}, "MoE_L0_bwd":{"total": 451.54, "avg": 14.11, "max": 13.62, "min": 14.58, "cnt": 32}, "backward-send-forward-recv":{"total": 1504.71, "avg": 51.89, "max": 1.65, "min": 267.47, "cnt": 29}, "backward-send":{"total": 3.28, "avg": 1.09, "max": 1.04, "min": 1.14, "cnt": 3}, "backward-recv":{"total": 170.19, "avg": 85.10, "max": 64.01, "min": 106.18, "cnt": 2}, "backward-params-all-reduce":{"total": 486.63, "avg": 486.63, "max": 486.63, "min": 486.63, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 242.14, "avg": 242.14, "max": 242.14, "min": 242.14, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 202.30, "avg": 202.30, "max": 202.30, "min": 202.30, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.47, "avg": 3.47, "max": 3.47, "min": 3.47, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}}}
{"type":"time", "iteration": 157, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 90.43, "avg": 30.14, "max": 5.52, "min": 75.74, "cnt": 3}, "forward-compute":{"total": 1904.11, "avg": 59.50, "max": 53.83, "min": 66.23, "cnt": 32}, "fwd-compute":{"total": 1900.82, "avg": 59.40, "max": 53.75, "min": 66.10, "cnt": 32}, "batch-generator":{"total": 38.16, "avg": 1.19, "max": 0.62, "min": 2.36, "cnt": 32}, "fwd-embedding":{"total": 0.67, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1849.46, "avg": 57.80, "max": 52.46, "min": 64.43, "cnt": 32}, "fwd-layernorm":{"total": 9.91, "avg": 0.08, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 107.33, "avg": 0.84, "max": 0.74, "min": 1.50, "cnt": 128}, "fwd-misc":{"total": 21.03, "avg": 0.16, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1689.77, "avg": 13.20, "max": 10.42, "min": 19.90, "cnt": 128}, "MoE_L0_fwd":{"total": 524.58, "avg": 16.39, "max": 13.23, "min": 19.78, "cnt": 32}, "MoEMLP":{"total": 1672.95, "avg": 13.07, "max": 10.32, "min": 19.71, "cnt": 128}, "MoE_L1_fwd":{"total": 392.04, "avg": 12.25, "max": 11.31, "min": 15.05, "cnt": 32}, "MoE_L2_fwd":{"total": 397.63, "avg": 12.43, "max": 11.60, "min": 15.81, "cnt": 32}, "MoE_L3_fwd":{"total": 364.91, "avg": 11.40, "max": 10.36, "min": 16.91, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.88, "avg": 0.94, "max": 0.93, "min": 0.96, "cnt": 2}, "forward-send-backward-recv":{"total": 848.01, "avg": 28.27, "max": 1.51, "min": 286.96, "cnt": 30}, "backward-compute":{"total": 1797.85, "avg": 56.18, "max": 54.88, "min": 57.76, "cnt": 32}, "MoE_L3_bwd":{"total": 380.35, "avg": 11.89, "max": 11.18, "min": 13.15, "cnt": 32}, "MoE_L2_bwd":{"total": 397.58, "avg": 12.42, "max": 11.69, "min": 13.85, "cnt": 32}, "MoE_L1_bwd":{"total": 346.60, "avg": 10.83, "max": 9.97, "min": 11.51, "cnt": 32}, "MoE_L0_bwd":{"total": 457.43, "avg": 14.29, "max": 13.88, "min": 14.86, "cnt": 32}, "backward-send-forward-recv":{"total": 1294.43, "avg": 44.64, "max": 1.24, "min": 273.59, "cnt": 29}, "backward-send":{"total": 2.68, "avg": 0.89, "max": 0.79, "min": 1.01, "cnt": 3}, "backward-recv":{"total": 140.11, "avg": 70.05, "max": 65.15, "min": 74.96, "cnt": 2}, "backward-params-all-reduce":{"total": 488.86, "avg": 488.86, "max": 488.86, "min": 488.86, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 238.86, "avg": 238.86, "max": 238.86, "min": 238.86, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.36, "avg": 3.36, "max": 3.36, "min": 3.36, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 198.97, "avg": 198.97, "max": 198.97, "min": 198.97, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}}}
{"type":"time", "iteration": 158, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 81.94, "avg": 27.31, "max": 1.38, "min": 76.18, "cnt": 3}, "forward-compute":{"total": 1879.76, "avg": 58.74, "max": 53.39, "min": 64.69, "cnt": 32}, "fwd-compute":{"total": 1876.42, "avg": 58.64, "max": 53.31, "min": 64.53, "cnt": 32}, "batch-generator":{"total": 37.57, "avg": 1.17, "max": 0.71, "min": 1.72, "cnt": 32}, "fwd-embedding":{"total": 0.64, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1826.25, "avg": 57.07, "max": 52.28, "min": 62.33, "cnt": 32}, "fwd-layernorm":{"total": 9.88, "avg": 0.08, "max": 0.06, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 109.57, "avg": 0.86, "max": 0.74, "min": 1.69, "cnt": 128}, "fwd-misc":{"total": 21.36, "avg": 0.17, "max": 0.12, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1664.30, "avg": 13.00, "max": 10.62, "min": 19.05, "cnt": 128}, "MoE_L0_fwd":{"total": 513.61, "avg": 16.05, "max": 13.33, "min": 18.94, "cnt": 32}, "MoEMLP":{"total": 1647.52, "avg": 12.87, "max": 10.51, "min": 18.89, "cnt": 128}, "MoE_L1_fwd":{"total": 385.19, "avg": 12.04, "max": 11.21, "min": 14.32, "cnt": 32}, "MoE_L2_fwd":{"total": 387.41, "avg": 12.11, "max": 11.48, "min": 17.14, "cnt": 32}, "MoE_L3_fwd":{"total": 367.46, "avg": 11.48, "max": 10.55, "min": 15.40, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.85, "avg": 0.93, "max": 0.92, "min": 0.93, "cnt": 2}, "forward-send-backward-recv":{"total": 921.30, "avg": 30.71, "max": 1.35, "min": 265.22, "cnt": 30}, "backward-compute":{"total": 1786.38, "avg": 55.82, "max": 52.78, "min": 58.83, "cnt": 32}, "MoE_L3_bwd":{"total": 390.12, "avg": 12.19, "max": 11.34, "min": 14.99, "cnt": 32}, "MoE_L2_bwd":{"total": 383.45, "avg": 11.98, "max": 11.29, "min": 12.57, "cnt": 32}, "MoE_L1_bwd":{"total": 345.76, "avg": 10.81, "max": 10.08, "min": 13.08, "cnt": 32}, "MoE_L0_bwd":{"total": 451.67, "avg": 14.11, "max": 13.74, "min": 14.78, "cnt": 32}, "backward-send-forward-recv":{"total": 997.98, "avg": 34.41, "max": 1.54, "min": 265.57, "cnt": 29}, "backward-send":{"total": 3.04, "avg": 1.01, "max": 0.81, "min": 1.16, "cnt": 3}, "backward-recv":{"total": 371.99, "avg": 186.00, "max": 67.57, "min": 304.43, "cnt": 2}, "backward-params-all-reduce":{"total": 484.88, "avg": 484.88, "max": 484.88, "min": 484.88, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 245.30, "avg": 245.30, "max": 245.30, "min": 245.30, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.36, "avg": 3.36, "max": 3.36, "min": 3.36, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 205.59, "avg": 205.59, "max": 205.59, "min": 205.59, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.48, "avg": 3.48, "max": 3.48, "min": 3.48, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 159, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 82.92, "avg": 27.64, "max": 1.08, "min": 80.76, "cnt": 3}, "forward-compute":{"total": 1911.33, "avg": 59.73, "max": 54.06, "min": 66.73, "cnt": 32}, "fwd-compute":{"total": 1907.68, "avg": 59.62, "max": 53.98, "min": 66.63, "cnt": 32}, "batch-generator":{"total": 43.93, "avg": 1.37, "max": 0.65, "min": 3.32, "cnt": 32}, "fwd-embedding":{"total": 0.71, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1850.02, "avg": 57.81, "max": 53.04, "min": 65.31, "cnt": 32}, "fwd-layernorm":{"total": 10.61, "avg": 0.08, "max": 0.06, "min": 0.22, "cnt": 128}, "fwd-attn":{"total": 113.88, "avg": 0.89, "max": 0.74, "min": 1.90, "cnt": 128}, "fwd-misc":{"total": 22.19, "avg": 0.17, "max": 0.11, "min": 0.38, "cnt": 128}, "fwd-MLP":{"total": 1680.01, "avg": 13.13, "max": 10.71, "min": 20.15, "cnt": 128}, "MoE_L0_fwd":{"total": 522.67, "avg": 16.33, "max": 13.49, "min": 20.00, "cnt": 32}, "MoEMLP":{"total": 1661.87, "avg": 12.98, "max": 10.61, "min": 19.92, "cnt": 128}, "MoE_L1_fwd":{"total": 390.85, "avg": 12.21, "max": 11.13, "min": 16.08, "cnt": 32}, "MoE_L2_fwd":{"total": 384.37, "avg": 12.01, "max": 11.36, "min": 14.17, "cnt": 32}, "MoE_L3_fwd":{"total": 370.55, "avg": 11.58, "max": 10.64, "min": 14.90, "cnt": 32}, "fwd-pooler":{"total": 0.39, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.61, "avg": 0.02, "max": 0.02, "min": 0.04, "cnt": 32}, "forward-send":{"total": 8.94, "avg": 4.47, "max": 0.78, "min": 8.17, "cnt": 2}, "forward-send-backward-recv":{"total": 197.27, "avg": 6.58, "max": 1.33, "min": 120.07, "cnt": 30}, "backward-compute":{"total": 1798.37, "avg": 56.20, "max": 55.14, "min": 58.68, "cnt": 32}, "MoE_L3_bwd":{"total": 390.23, "avg": 12.19, "max": 11.41, "min": 14.70, "cnt": 32}, "MoE_L2_bwd":{"total": 390.14, "avg": 12.19, "max": 11.33, "min": 15.49, "cnt": 32}, "MoE_L1_bwd":{"total": 349.92, "avg": 10.93, "max": 10.49, "min": 11.41, "cnt": 32}, "MoE_L0_bwd":{"total": 448.52, "avg": 14.02, "max": 13.48, "min": 14.31, "cnt": 32}, "backward-send-forward-recv":{"total": 1980.74, "avg": 68.30, "max": 2.49, "min": 326.03, "cnt": 29}, "backward-send":{"total": 2.64, "avg": 0.88, "max": 0.75, "min": 1.09, "cnt": 3}, "backward-recv":{"total": 130.74, "avg": 65.37, "max": 60.32, "min": 70.42, "cnt": 2}, "backward-params-all-reduce":{"total": 483.57, "avg": 483.57, "max": 483.57, "min": 483.57, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 246.12, "avg": 246.12, "max": 246.12, "min": 246.12, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 206.11, "avg": 206.11, "max": 206.11, "min": 206.11, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.53, "avg": 3.53, "max": 3.53, "min": 3.53, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 160, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 93.28, "avg": 31.09, "max": 1.86, "min": 83.26, "cnt": 3}, "forward-compute":{"total": 1885.19, "avg": 58.91, "max": 54.45, "min": 66.97, "cnt": 32}, "fwd-compute":{"total": 1882.06, "avg": 58.81, "max": 54.36, "min": 66.83, "cnt": 32}, "batch-generator":{"total": 38.93, "avg": 1.22, "max": 0.70, "min": 2.51, "cnt": 32}, "fwd-embedding":{"total": 0.60, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1830.98, "avg": 57.22, "max": 53.16, "min": 63.86, "cnt": 32}, "fwd-layernorm":{"total": 9.83, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 111.60, "avg": 0.87, "max": 0.74, "min": 2.49, "cnt": 128}, "fwd-misc":{"total": 20.64, "avg": 0.16, "max": 0.12, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1667.76, "avg": 13.03, "max": 10.78, "min": 20.31, "cnt": 128}, "MoE_L0_fwd":{"total": 516.37, "avg": 16.14, "max": 13.09, "min": 20.24, "cnt": 32}, "MoEMLP":{"total": 1651.09, "avg": 12.90, "max": 10.66, "min": 20.19, "cnt": 128}, "MoE_L1_fwd":{"total": 382.62, "avg": 11.96, "max": 11.22, "min": 13.79, "cnt": 32}, "MoE_L2_fwd":{"total": 384.00, "avg": 12.00, "max": 11.29, "min": 12.99, "cnt": 32}, "MoE_L3_fwd":{"total": 374.26, "avg": 11.70, "max": 10.71, "min": 18.39, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.85, "avg": 0.92, "max": 0.91, "min": 0.94, "cnt": 2}, "forward-send-backward-recv":{"total": 204.49, "avg": 6.82, "max": 1.36, "min": 110.58, "cnt": 30}, "backward-compute":{"total": 1792.06, "avg": 56.00, "max": 53.60, "min": 59.48, "cnt": 32}, "MoE_L3_bwd":{"total": 386.16, "avg": 12.07, "max": 11.04, "min": 13.26, "cnt": 32}, "MoE_L2_bwd":{"total": 386.67, "avg": 12.08, "max": 11.22, "min": 13.01, "cnt": 32}, "MoE_L1_bwd":{"total": 351.26, "avg": 10.98, "max": 10.20, "min": 13.44, "cnt": 32}, "MoE_L0_bwd":{"total": 452.83, "avg": 14.15, "max": 13.49, "min": 15.02, "cnt": 32}, "backward-send-forward-recv":{"total": 2269.04, "avg": 78.24, "max": 1.09, "min": 389.40, "cnt": 29}, "backward-send":{"total": 3.05, "avg": 1.02, "max": 0.99, "min": 1.04, "cnt": 3}, "backward-recv":{"total": 116.39, "avg": 58.19, "max": 52.16, "min": 64.23, "cnt": 2}, "backward-params-all-reduce":{"total": 486.50, "avg": 486.50, "max": 486.50, "min": 486.50, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 239.78, "avg": 239.78, "max": 239.78, "min": 239.78, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 199.86, "avg": 199.86, "max": 199.86, "min": 199.86, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.55, "avg": 3.55, "max": 3.55, "min": 3.55, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 161, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 79.24, "avg": 26.41, "max": 1.18, "min": 76.84, "cnt": 3}, "forward-compute":{"total": 1875.47, "avg": 58.61, "max": 53.45, "min": 64.42, "cnt": 32}, "fwd-compute":{"total": 1872.09, "avg": 58.50, "max": 53.38, "min": 64.25, "cnt": 32}, "batch-generator":{"total": 43.65, "avg": 1.36, "max": 0.72, "min": 2.25, "cnt": 32}, "fwd-embedding":{"total": 0.65, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1815.90, "avg": 56.75, "max": 52.23, "min": 62.07, "cnt": 32}, "fwd-layernorm":{"total": 10.05, "avg": 0.08, "max": 0.06, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 109.48, "avg": 0.86, "max": 0.74, "min": 1.57, "cnt": 128}, "fwd-misc":{"total": 21.54, "avg": 0.17, "max": 0.12, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1653.54, "avg": 12.92, "max": 11.00, "min": 19.30, "cnt": 128}, "MoE_L0_fwd":{"total": 507.14, "avg": 15.85, "max": 13.06, "min": 19.08, "cnt": 32}, "MoEMLP":{"total": 1636.55, "avg": 12.79, "max": 10.89, "min": 18.99, "cnt": 128}, "MoE_L1_fwd":{"total": 386.19, "avg": 12.07, "max": 11.10, "min": 13.75, "cnt": 32}, "MoE_L2_fwd":{"total": 385.19, "avg": 12.04, "max": 11.39, "min": 14.08, "cnt": 32}, "MoE_L3_fwd":{"total": 364.25, "avg": 11.38, "max": 10.93, "min": 13.08, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.85, "avg": 0.92, "max": 0.90, "min": 0.95, "cnt": 2}, "forward-send-backward-recv":{"total": 178.63, "avg": 5.95, "max": 1.21, "min": 122.47, "cnt": 30}, "backward-compute":{"total": 1791.68, "avg": 55.99, "max": 54.49, "min": 58.39, "cnt": 32}, "MoE_L3_bwd":{"total": 390.44, "avg": 12.20, "max": 10.99, "min": 14.11, "cnt": 32}, "MoE_L2_bwd":{"total": 383.15, "avg": 11.97, "max": 11.33, "min": 12.87, "cnt": 32}, "MoE_L1_bwd":{"total": 343.54, "avg": 10.74, "max": 10.11, "min": 11.27, "cnt": 32}, "MoE_L0_bwd":{"total": 452.42, "avg": 14.14, "max": 13.49, "min": 15.96, "cnt": 32}, "backward-send-forward-recv":{"total": 1401.13, "avg": 48.31, "max": 2.38, "min": 251.44, "cnt": 29}, "backward-send":{"total": 3.20, "avg": 1.07, "max": 1.02, "min": 1.12, "cnt": 3}, "backward-recv":{"total": 129.35, "avg": 64.67, "max": 57.86, "min": 71.48, "cnt": 2}, "backward-params-all-reduce":{"total": 492.45, "avg": 492.45, "max": 492.45, "min": 492.45, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 236.63, "avg": 236.63, "max": 236.63, "min": 236.63, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 196.82, "avg": 196.82, "max": 196.82, "min": 196.82, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.40, "avg": 3.40, "max": 3.40, "min": 3.40, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}}}
{"type":"time", "iteration": 162, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 88.09, "avg": 29.36, "max": 6.75, "min": 73.38, "cnt": 3}, "forward-compute":{"total": 1900.19, "avg": 59.38, "max": 53.48, "min": 65.01, "cnt": 32}, "fwd-compute":{"total": 1896.77, "avg": 59.27, "max": 53.40, "min": 64.88, "cnt": 32}, "batch-generator":{"total": 40.32, "avg": 1.26, "max": 0.65, "min": 1.80, "cnt": 32}, "fwd-embedding":{"total": 0.69, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1843.69, "avg": 57.62, "max": 52.32, "min": 62.62, "cnt": 32}, "fwd-layernorm":{"total": 10.38, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 112.64, "avg": 0.88, "max": 0.74, "min": 1.50, "cnt": 128}, "fwd-misc":{"total": 22.70, "avg": 0.18, "max": 0.12, "min": 0.43, "cnt": 128}, "fwd-MLP":{"total": 1675.73, "avg": 13.09, "max": 10.71, "min": 19.45, "cnt": 128}, "MoE_L0_fwd":{"total": 518.71, "avg": 16.21, "max": 13.16, "min": 19.30, "cnt": 32}, "MoEMLP":{"total": 1658.16, "avg": 12.95, "max": 10.56, "min": 19.20, "cnt": 128}, "MoE_L1_fwd":{"total": 395.18, "avg": 12.35, "max": 11.34, "min": 14.27, "cnt": 32}, "MoE_L2_fwd":{"total": 384.85, "avg": 12.03, "max": 11.11, "min": 15.78, "cnt": 32}, "MoE_L3_fwd":{"total": 365.78, "avg": 11.43, "max": 10.61, "min": 14.89, "cnt": 32}, "fwd-pooler":{"total": 0.38, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.82, "avg": 0.91, "max": 0.91, "min": 0.91, "cnt": 2}, "forward-send-backward-recv":{"total": 437.53, "avg": 14.58, "max": 1.45, "min": 189.52, "cnt": 30}, "backward-compute":{"total": 1786.92, "avg": 55.84, "max": 53.34, "min": 59.25, "cnt": 32}, "MoE_L3_bwd":{"total": 390.05, "avg": 12.19, "max": 10.43, "min": 13.73, "cnt": 32}, "MoE_L2_bwd":{"total": 373.46, "avg": 11.67, "max": 10.82, "min": 12.40, "cnt": 32}, "MoE_L1_bwd":{"total": 358.78, "avg": 11.21, "max": 10.56, "min": 13.18, "cnt": 32}, "MoE_L0_bwd":{"total": 446.29, "avg": 13.95, "max": 13.38, "min": 14.38, "cnt": 32}, "backward-send-forward-recv":{"total": 2178.77, "avg": 75.13, "max": 2.19, "min": 950.35, "cnt": 29}, "backward-send":{"total": 2.59, "avg": 0.86, "max": 0.76, "min": 0.93, "cnt": 3}, "backward-recv":{"total": 132.35, "avg": 66.18, "max": 57.48, "min": 74.88, "cnt": 2}, "backward-params-all-reduce":{"total": 484.65, "avg": 484.65, "max": 484.65, "min": 484.65, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 252.10, "avg": 252.10, "max": 252.10, "min": 252.10, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 204.72, "avg": 204.72, "max": 204.72, "min": 204.72, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.85, "avg": 3.85, "max": 3.85, "min": 3.85, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 163, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 91.03, "avg": 30.34, "max": 2.83, "min": 84.33, "cnt": 3}, "forward-compute":{"total": 1887.10, "avg": 58.97, "max": 53.13, "min": 62.16, "cnt": 32}, "fwd-compute":{"total": 1883.33, "avg": 58.85, "max": 53.05, "min": 62.03, "cnt": 32}, "batch-generator":{"total": 43.69, "avg": 1.37, "max": 0.66, "min": 1.93, "cnt": 32}, "fwd-embedding":{"total": 0.80, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1825.91, "avg": 57.06, "max": 51.89, "min": 59.87, "cnt": 32}, "fwd-layernorm":{"total": 11.15, "avg": 0.09, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 116.42, "avg": 0.91, "max": 0.74, "min": 1.52, "cnt": 128}, "fwd-misc":{"total": 23.52, "avg": 0.18, "max": 0.12, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1651.26, "avg": 12.90, "max": 10.67, "min": 18.37, "cnt": 128}, "MoE_L0_fwd":{"total": 507.22, "avg": 15.85, "max": 13.22, "min": 18.14, "cnt": 32}, "MoEMLP":{"total": 1632.59, "avg": 12.75, "max": 10.56, "min": 18.05, "cnt": 128}, "MoE_L1_fwd":{"total": 387.69, "avg": 12.12, "max": 11.21, "min": 14.55, "cnt": 32}, "MoE_L2_fwd":{"total": 381.03, "avg": 11.91, "max": 10.95, "min": 13.19, "cnt": 32}, "MoE_L3_fwd":{"total": 363.30, "avg": 11.35, "max": 10.60, "min": 13.67, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.72, "avg": 0.86, "max": 0.78, "min": 0.93, "cnt": 2}, "forward-send-backward-recv":{"total": 475.35, "avg": 15.84, "max": 1.02, "min": 108.82, "cnt": 30}, "backward-compute":{"total": 1858.67, "avg": 58.08, "max": 52.66, "min": 126.15, "cnt": 32}, "MoE_L3_bwd":{"total": 472.95, "avg": 14.78, "max": 11.73, "min": 83.43, "cnt": 32}, "MoE_L2_bwd":{"total": 376.63, "avg": 11.77, "max": 10.55, "min": 12.78, "cnt": 32}, "MoE_L1_bwd":{"total": 346.81, "avg": 10.84, "max": 10.13, "min": 15.72, "cnt": 32}, "MoE_L0_bwd":{"total": 446.63, "avg": 13.96, "max": 13.60, "min": 14.57, "cnt": 32}, "backward-send-forward-recv":{"total": 389.07, "avg": 13.42, "max": 1.97, "min": 122.05, "cnt": 29}, "backward-send":{"total": 2.18, "avg": 0.73, "max": 0.64, "min": 0.91, "cnt": 3}, "backward-recv":{"total": 122.75, "avg": 61.37, "max": 54.42, "min": 68.33, "cnt": 2}, "backward-params-all-reduce":{"total": 488.67, "avg": 488.67, "max": 488.67, "min": 488.67, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 242.72, "avg": 242.72, "max": 242.72, "min": 242.72, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 202.81, "avg": 202.81, "max": 202.81, "min": 202.81, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.48, "avg": 3.48, "max": 3.48, "min": 3.48, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 164, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 78.04, "avg": 26.01, "max": 1.88, "min": 73.49, "cnt": 3}, "forward-compute":{"total": 1889.88, "avg": 59.06, "max": 53.74, "min": 67.87, "cnt": 32}, "fwd-compute":{"total": 1886.29, "avg": 58.95, "max": 53.68, "min": 67.73, "cnt": 32}, "batch-generator":{"total": 39.66, "avg": 1.24, "max": 0.71, "min": 1.80, "cnt": 32}, "fwd-embedding":{"total": 0.72, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1832.30, "avg": 57.26, "max": 52.53, "min": 65.61, "cnt": 32}, "fwd-layernorm":{"total": 10.46, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 111.46, "avg": 0.87, "max": 0.74, "min": 2.30, "cnt": 128}, "fwd-misc":{"total": 21.87, "avg": 0.17, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1666.27, "avg": 13.02, "max": 10.77, "min": 20.34, "cnt": 128}, "MoE_L0_fwd":{"total": 517.59, "avg": 16.17, "max": 13.20, "min": 20.18, "cnt": 32}, "MoEMLP":{"total": 1648.69, "avg": 12.88, "max": 10.65, "min": 20.09, "cnt": 128}, "MoE_L1_fwd":{"total": 386.12, "avg": 12.07, "max": 11.17, "min": 15.13, "cnt": 32}, "MoE_L2_fwd":{"total": 382.37, "avg": 11.95, "max": 10.80, "min": 13.84, "cnt": 32}, "MoE_L3_fwd":{"total": 369.04, "avg": 11.53, "max": 10.69, "min": 15.99, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.04, "cnt": 32}, "forward-send":{"total": 1.53, "avg": 0.77, "max": 0.65, "min": 0.88, "cnt": 2}, "forward-send-backward-recv":{"total": 252.68, "avg": 8.42, "max": 1.06, "min": 163.58, "cnt": 30}, "backward-compute":{"total": 1885.19, "avg": 58.91, "max": 54.17, "min": 146.25, "cnt": 32}, "MoE_L3_bwd":{"total": 400.78, "avg": 12.52, "max": 11.23, "min": 15.13, "cnt": 32}, "MoE_L2_bwd":{"total": 380.87, "avg": 11.90, "max": 10.77, "min": 12.66, "cnt": 32}, "MoE_L1_bwd":{"total": 437.49, "avg": 13.67, "max": 10.42, "min": 101.41, "cnt": 32}, "MoE_L0_bwd":{"total": 452.28, "avg": 14.13, "max": 13.44, "min": 17.21, "cnt": 32}, "backward-send-forward-recv":{"total": 1460.60, "avg": 50.37, "max": 1.82, "min": 560.94, "cnt": 29}, "backward-send":{"total": 3.19, "avg": 1.06, "max": 0.97, "min": 1.18, "cnt": 3}, "backward-recv":{"total": 120.34, "avg": 60.17, "max": 54.75, "min": 65.59, "cnt": 2}, "backward-params-all-reduce":{"total": 485.70, "avg": 485.70, "max": 485.70, "min": 485.70, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 240.94, "avg": 240.94, "max": 240.94, "min": 240.94, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.36, "avg": 3.36, "max": 3.36, "min": 3.36, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 201.04, "avg": 201.04, "max": 201.04, "min": 201.04, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.40, "avg": 3.40, "max": 3.40, "min": 3.40, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}}}
{"type":"time", "iteration": 165, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 82.01, "avg": 27.34, "max": 2.31, "min": 77.01, "cnt": 3}, "forward-compute":{"total": 1878.98, "avg": 58.72, "max": 53.09, "min": 66.24, "cnt": 32}, "fwd-compute":{"total": 1875.68, "avg": 58.61, "max": 53.01, "min": 66.11, "cnt": 32}, "batch-generator":{"total": 38.67, "avg": 1.21, "max": 0.70, "min": 1.91, "cnt": 32}, "fwd-embedding":{"total": 0.62, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1824.37, "avg": 57.01, "max": 51.94, "min": 63.97, "cnt": 32}, "fwd-layernorm":{"total": 9.83, "avg": 0.08, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 108.15, "avg": 0.84, "max": 0.74, "min": 1.48, "cnt": 128}, "fwd-misc":{"total": 20.86, "avg": 0.16, "max": 0.12, "min": 0.34, "cnt": 128}, "fwd-MLP":{"total": 1664.49, "avg": 13.00, "max": 10.66, "min": 22.83, "cnt": 128}, "MoE_L0_fwd":{"total": 523.55, "avg": 16.36, "max": 13.31, "min": 22.71, "cnt": 32}, "MoEMLP":{"total": 1647.88, "avg": 12.87, "max": 10.55, "min": 22.64, "cnt": 128}, "MoE_L1_fwd":{"total": 395.19, "avg": 12.35, "max": 11.37, "min": 13.94, "cnt": 32}, "MoE_L2_fwd":{"total": 373.24, "avg": 11.66, "max": 11.01, "min": 13.32, "cnt": 32}, "MoE_L3_fwd":{"total": 362.04, "avg": 11.31, "max": 10.60, "min": 14.42, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.73, "avg": 0.87, "max": 0.84, "min": 0.89, "cnt": 2}, "forward-send-backward-recv":{"total": 662.30, "avg": 22.08, "max": 1.69, "min": 125.28, "cnt": 30}, "backward-compute":{"total": 1771.46, "avg": 55.36, "max": 53.46, "min": 56.66, "cnt": 32}, "MoE_L3_bwd":{"total": 388.86, "avg": 12.15, "max": 10.51, "min": 13.76, "cnt": 32}, "MoE_L2_bwd":{"total": 367.08, "avg": 11.47, "max": 10.69, "min": 12.61, "cnt": 32}, "MoE_L1_bwd":{"total": 349.90, "avg": 10.93, "max": 10.48, "min": 12.37, "cnt": 32}, "MoE_L0_bwd":{"total": 447.53, "avg": 13.99, "max": 13.46, "min": 15.02, "cnt": 32}, "backward-send-forward-recv":{"total": 2168.40, "avg": 74.77, "max": 1.50, "min": 469.11, "cnt": 29}, "backward-send":{"total": 2.18, "avg": 0.73, "max": 0.61, "min": 0.90, "cnt": 3}, "backward-recv":{"total": 818.28, "avg": 409.14, "max": 72.34, "min": 745.94, "cnt": 2}, "backward-params-all-reduce":{"total": 486.08, "avg": 486.08, "max": 486.08, "min": 486.08, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 250.03, "avg": 250.03, "max": 250.03, "min": 250.03, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.36, "avg": 3.36, "max": 3.36, "min": 3.36, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 205.72, "avg": 205.72, "max": 205.72, "min": 205.72, "cnt": 1}, "optimizer-clip-main-grad":{"total": 7.15, "avg": 7.15, "max": 7.15, "min": 7.15, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}}}
{"type":"time", "iteration": 166, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 89.02, "avg": 29.67, "max": 1.33, "min": 79.30, "cnt": 3}, "forward-compute":{"total": 1873.39, "avg": 58.54, "max": 53.05, "min": 65.86, "cnt": 32}, "fwd-compute":{"total": 1870.01, "avg": 58.44, "max": 52.98, "min": 65.67, "cnt": 32}, "batch-generator":{"total": 42.66, "avg": 1.33, "max": 0.72, "min": 2.88, "cnt": 32}, "fwd-embedding":{"total": 0.64, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1813.86, "avg": 56.68, "max": 51.97, "min": 63.43, "cnt": 32}, "fwd-layernorm":{"total": 9.96, "avg": 0.08, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 110.97, "avg": 0.87, "max": 0.74, "min": 2.73, "cnt": 128}, "fwd-misc":{"total": 21.45, "avg": 0.17, "max": 0.11, "min": 0.40, "cnt": 128}, "fwd-MLP":{"total": 1650.30, "avg": 12.89, "max": 10.78, "min": 19.41, "cnt": 128}, "MoE_L0_fwd":{"total": 515.72, "avg": 16.12, "max": 13.33, "min": 19.24, "cnt": 32}, "MoEMLP":{"total": 1633.25, "avg": 12.76, "max": 10.67, "min": 19.15, "cnt": 128}, "MoE_L1_fwd":{"total": 387.63, "avg": 12.11, "max": 11.27, "min": 14.78, "cnt": 32}, "MoE_L2_fwd":{"total": 370.17, "avg": 11.57, "max": 10.98, "min": 13.62, "cnt": 32}, "MoE_L3_fwd":{"total": 366.04, "avg": 11.44, "max": 10.71, "min": 15.58, "cnt": 32}, "fwd-pooler":{"total": 0.38, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.64, "avg": 0.02, "max": 0.02, "min": 0.06, "cnt": 32}, "forward-send":{"total": 1.80, "avg": 0.90, "max": 0.87, "min": 0.93, "cnt": 2}, "forward-send-backward-recv":{"total": 195.08, "avg": 6.50, "max": 1.37, "min": 104.40, "cnt": 30}, "backward-compute":{"total": 1762.26, "avg": 55.07, "max": 53.24, "min": 58.58, "cnt": 32}, "MoE_L3_bwd":{"total": 388.21, "avg": 12.13, "max": 10.68, "min": 14.13, "cnt": 32}, "MoE_L2_bwd":{"total": 363.24, "avg": 11.35, "max": 10.56, "min": 11.95, "cnt": 32}, "MoE_L1_bwd":{"total": 350.54, "avg": 10.95, "max": 10.33, "min": 14.19, "cnt": 32}, "MoE_L0_bwd":{"total": 446.19, "avg": 13.94, "max": 13.66, "min": 14.18, "cnt": 32}, "backward-send-forward-recv":{"total": 3806.53, "avg": 131.26, "max": 1.39, "min": 1011.23, "cnt": 29}, "backward-send":{"total": 2.77, "avg": 0.92, "max": 0.87, "min": 1.02, "cnt": 3}, "backward-recv":{"total": 133.23, "avg": 66.61, "max": 64.10, "min": 69.13, "cnt": 2}, "backward-params-all-reduce":{"total": 485.72, "avg": 485.72, "max": 485.72, "min": 485.72, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 244.53, "avg": 244.53, "max": 244.53, "min": 244.53, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 204.71, "avg": 204.71, "max": 204.71, "min": 204.71, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 167, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 75.73, "avg": 25.24, "max": 1.26, "min": 73.19, "cnt": 3}, "forward-compute":{"total": 1877.42, "avg": 58.67, "max": 52.27, "min": 64.21, "cnt": 32}, "fwd-compute":{"total": 1874.18, "avg": 58.57, "max": 52.20, "min": 64.07, "cnt": 32}, "batch-generator":{"total": 38.97, "avg": 1.22, "max": 0.66, "min": 2.28, "cnt": 32}, "fwd-embedding":{"total": 0.64, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1822.74, "avg": 56.96, "max": 51.25, "min": 61.76, "cnt": 32}, "fwd-layernorm":{"total": 9.86, "avg": 0.08, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 107.29, "avg": 0.84, "max": 0.74, "min": 1.55, "cnt": 128}, "fwd-misc":{"total": 20.75, "avg": 0.16, "max": 0.11, "min": 0.34, "cnt": 128}, "fwd-MLP":{"total": 1663.97, "avg": 13.00, "max": 10.82, "min": 19.15, "cnt": 128}, "MoE_L0_fwd":{"total": 525.21, "avg": 16.41, "max": 12.98, "min": 19.00, "cnt": 32}, "MoEMLP":{"total": 1647.25, "avg": 12.87, "max": 10.71, "min": 18.92, "cnt": 128}, "MoE_L1_fwd":{"total": 395.15, "avg": 12.35, "max": 11.33, "min": 15.40, "cnt": 32}, "MoE_L2_fwd":{"total": 369.66, "avg": 11.55, "max": 10.75, "min": 14.84, "cnt": 32}, "MoE_L3_fwd":{"total": 363.43, "avg": 11.36, "max": 10.76, "min": 13.75, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.56, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.75, "avg": 0.87, "max": 0.79, "min": 0.96, "cnt": 2}, "forward-send-backward-recv":{"total": 1327.00, "avg": 44.23, "max": 1.48, "min": 208.45, "cnt": 30}, "backward-compute":{"total": 1787.48, "avg": 55.86, "max": 53.68, "min": 59.61, "cnt": 32}, "MoE_L3_bwd":{"total": 396.46, "avg": 12.39, "max": 11.56, "min": 14.56, "cnt": 32}, "MoE_L2_bwd":{"total": 370.67, "avg": 11.58, "max": 10.71, "min": 12.91, "cnt": 32}, "MoE_L1_bwd":{"total": 353.16, "avg": 11.04, "max": 10.51, "min": 12.85, "cnt": 32}, "MoE_L0_bwd":{"total": 447.69, "avg": 13.99, "max": 13.51, "min": 15.28, "cnt": 32}, "backward-send-forward-recv":{"total": 967.61, "avg": 33.37, "max": 1.09, "min": 182.77, "cnt": 29}, "backward-send":{"total": 2.85, "avg": 0.95, "max": 0.90, "min": 1.03, "cnt": 3}, "backward-recv":{"total": 140.52, "avg": 70.26, "max": 69.51, "min": 71.01, "cnt": 2}, "backward-params-all-reduce":{"total": 486.00, "avg": 486.00, "max": 486.00, "min": 486.00, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 242.87, "avg": 242.87, "max": 242.87, "min": 242.87, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 203.08, "avg": 203.08, "max": 203.08, "min": 203.08, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.30, "avg": 3.30, "max": 3.30, "min": 3.30, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 168, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 73.87, "avg": 24.62, "max": 1.13, "min": 71.13, "cnt": 3}, "forward-compute":{"total": 1885.50, "avg": 58.92, "max": 52.08, "min": 67.00, "cnt": 32}, "fwd-compute":{"total": 1881.80, "avg": 58.81, "max": 52.01, "min": 66.85, "cnt": 32}, "batch-generator":{"total": 47.37, "avg": 1.48, "max": 0.67, "min": 4.20, "cnt": 32}, "fwd-embedding":{"total": 0.70, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1820.61, "avg": 56.89, "max": 50.98, "min": 64.52, "cnt": 32}, "fwd-layernorm":{"total": 10.48, "avg": 0.08, "max": 0.06, "min": 0.25, "cnt": 128}, "fwd-attn":{"total": 112.56, "avg": 0.88, "max": 0.74, "min": 2.99, "cnt": 128}, "fwd-misc":{"total": 21.76, "avg": 0.17, "max": 0.11, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1653.24, "avg": 12.92, "max": 10.87, "min": 22.54, "cnt": 128}, "MoE_L0_fwd":{"total": 513.41, "avg": 16.04, "max": 13.00, "min": 22.45, "cnt": 32}, "MoEMLP":{"total": 1635.87, "avg": 12.78, "max": 10.77, "min": 22.41, "cnt": 128}, "MoE_L1_fwd":{"total": 393.45, "avg": 12.30, "max": 11.29, "min": 15.21, "cnt": 32}, "MoE_L2_fwd":{"total": 367.82, "avg": 11.49, "max": 10.85, "min": 13.33, "cnt": 32}, "MoE_L3_fwd":{"total": 367.59, "avg": 11.49, "max": 10.81, "min": 13.27, "cnt": 32}, "fwd-pooler":{"total": 0.38, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.61, "avg": 0.02, "max": 0.02, "min": 0.06, "cnt": 32}, "forward-send":{"total": 8.90, "avg": 4.45, "max": 0.99, "min": 7.91, "cnt": 2}, "forward-send-backward-recv":{"total": 179.24, "avg": 5.97, "max": 1.21, "min": 115.18, "cnt": 30}, "backward-compute":{"total": 1774.48, "avg": 55.45, "max": 53.65, "min": 58.86, "cnt": 32}, "MoE_L3_bwd":{"total": 401.07, "avg": 12.53, "max": 10.83, "min": 16.07, "cnt": 32}, "MoE_L2_bwd":{"total": 355.01, "avg": 11.09, "max": 10.40, "min": 12.14, "cnt": 32}, "MoE_L1_bwd":{"total": 352.21, "avg": 11.01, "max": 10.60, "min": 11.70, "cnt": 32}, "MoE_L0_bwd":{"total": 445.48, "avg": 13.92, "max": 13.35, "min": 15.78, "cnt": 32}, "backward-send-forward-recv":{"total": 2059.97, "avg": 71.03, "max": 2.43, "min": 367.16, "cnt": 29}, "backward-send":{"total": 2.72, "avg": 0.91, "max": 0.82, "min": 0.98, "cnt": 3}, "backward-recv":{"total": 133.73, "avg": 66.87, "max": 64.30, "min": 69.43, "cnt": 2}, "backward-params-all-reduce":{"total": 487.15, "avg": 487.15, "max": 487.15, "min": 487.15, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 246.89, "avg": 246.89, "max": 246.89, "min": 246.89, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.40, "avg": 3.40, "max": 3.40, "min": 3.40, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 206.91, "avg": 206.91, "max": 206.91, "min": 206.91, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.30, "avg": 3.30, "max": 3.30, "min": 3.30, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.50, "avg": 3.50, "max": 3.50, "min": 3.50, "cnt": 1}}}
{"type":"time", "iteration": 169, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 73.96, "avg": 24.65, "max": 1.37, "min": 71.22, "cnt": 3}, "forward-compute":{"total": 1847.31, "avg": 57.73, "max": 53.04, "min": 69.63, "cnt": 32}, "fwd-compute":{"total": 1844.24, "avg": 57.63, "max": 52.96, "min": 69.40, "cnt": 32}, "batch-generator":{"total": 42.71, "avg": 1.33, "max": 0.66, "min": 3.66, "cnt": 32}, "fwd-embedding":{"total": 0.53, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1789.14, "avg": 55.91, "max": 51.98, "min": 66.76, "cnt": 32}, "fwd-layernorm":{"total": 9.28, "avg": 0.07, "max": 0.06, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 103.28, "avg": 0.81, "max": 0.74, "min": 1.52, "cnt": 128}, "fwd-misc":{"total": 19.41, "avg": 0.15, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1636.75, "avg": 12.79, "max": 10.54, "min": 18.33, "cnt": 128}, "MoE_L0_fwd":{"total": 505.17, "avg": 15.79, "max": 13.52, "min": 18.16, "cnt": 32}, "MoEMLP":{"total": 1620.59, "avg": 12.66, "max": 10.44, "min": 18.07, "cnt": 128}, "MoE_L1_fwd":{"total": 392.74, "avg": 12.27, "max": 11.42, "min": 13.42, "cnt": 32}, "MoE_L2_fwd":{"total": 365.16, "avg": 11.41, "max": 10.80, "min": 12.68, "cnt": 32}, "MoE_L3_fwd":{"total": 363.48, "avg": 11.36, "max": 10.48, "min": 16.65, "cnt": 32}, "fwd-pooler":{"total": 0.37, "avg": 0.01, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-loss-func":{"total": 0.61, "avg": 0.02, "max": 0.02, "min": 0.05, "cnt": 32}, "forward-send":{"total": 1.73, "avg": 0.86, "max": 0.85, "min": 0.88, "cnt": 2}, "forward-send-backward-recv":{"total": 833.66, "avg": 27.79, "max": 1.30, "min": 271.29, "cnt": 30}, "backward-compute":{"total": 1773.24, "avg": 55.41, "max": 54.14, "min": 57.67, "cnt": 32}, "MoE_L3_bwd":{"total": 392.71, "avg": 12.27, "max": 11.46, "min": 13.84, "cnt": 32}, "MoE_L2_bwd":{"total": 357.66, "avg": 11.18, "max": 10.56, "min": 13.01, "cnt": 32}, "MoE_L1_bwd":{"total": 357.26, "avg": 11.16, "max": 10.66, "min": 11.87, "cnt": 32}, "MoE_L0_bwd":{"total": 448.86, "avg": 14.03, "max": 13.49, "min": 16.17, "cnt": 32}, "backward-send-forward-recv":{"total": 3603.01, "avg": 124.24, "max": 1.13, "min": 639.50, "cnt": 29}, "backward-send":{"total": 3.17, "avg": 1.06, "max": 0.95, "min": 1.12, "cnt": 3}, "backward-recv":{"total": 381.98, "avg": 190.99, "max": 53.72, "min": 328.26, "cnt": 2}, "backward-params-all-reduce":{"total": 485.23, "avg": 485.23, "max": 485.23, "min": 485.23, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 241.58, "avg": 241.58, "max": 241.58, "min": 241.58, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 201.78, "avg": 201.78, "max": 201.78, "min": 201.78, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.29, "avg": 3.29, "max": 3.29, "min": 3.29, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 170, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 82.10, "avg": 27.37, "max": 1.35, "min": 79.05, "cnt": 3}, "forward-compute":{"total": 1912.69, "avg": 59.77, "max": 54.66, "min": 70.28, "cnt": 32}, "fwd-compute":{"total": 1909.40, "avg": 59.67, "max": 54.59, "min": 70.20, "cnt": 32}, "batch-generator":{"total": 47.75, "avg": 1.49, "max": 0.66, "min": 4.49, "cnt": 32}, "fwd-embedding":{"total": 0.63, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1847.83, "avg": 57.74, "max": 53.30, "min": 68.84, "cnt": 32}, "fwd-layernorm":{"total": 10.08, "avg": 0.08, "max": 0.06, "min": 0.22, "cnt": 128}, "fwd-attn":{"total": 107.88, "avg": 0.84, "max": 0.74, "min": 1.60, "cnt": 128}, "fwd-misc":{"total": 21.02, "avg": 0.16, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1687.18, "avg": 13.18, "max": 10.62, "min": 20.62, "cnt": 128}, "MoE_L0_fwd":{"total": 528.05, "avg": 16.50, "max": 13.23, "min": 20.53, "cnt": 32}, "MoEMLP":{"total": 1670.06, "avg": 13.05, "max": 10.52, "min": 20.49, "cnt": 128}, "MoE_L1_fwd":{"total": 401.30, "avg": 12.54, "max": 11.32, "min": 15.68, "cnt": 32}, "MoE_L2_fwd":{"total": 379.19, "avg": 11.85, "max": 11.03, "min": 15.75, "cnt": 32}, "MoE_L3_fwd":{"total": 367.80, "avg": 11.49, "max": 10.56, "min": 13.46, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.63, "avg": 0.82, "max": 0.68, "min": 0.96, "cnt": 2}, "forward-send-backward-recv":{"total": 185.55, "avg": 6.19, "max": 1.35, "min": 114.89, "cnt": 30}, "backward-compute":{"total": 1788.63, "avg": 55.89, "max": 54.00, "min": 59.44, "cnt": 32}, "MoE_L3_bwd":{"total": 386.00, "avg": 12.06, "max": 11.37, "min": 13.14, "cnt": 32}, "MoE_L2_bwd":{"total": 366.65, "avg": 11.46, "max": 10.58, "min": 12.14, "cnt": 32}, "MoE_L1_bwd":{"total": 361.92, "avg": 11.31, "max": 10.61, "min": 13.79, "cnt": 32}, "MoE_L0_bwd":{"total": 454.43, "avg": 14.20, "max": 13.42, "min": 16.18, "cnt": 32}, "backward-send-forward-recv":{"total": 2483.47, "avg": 85.64, "max": 2.39, "min": 502.76, "cnt": 29}, "backward-send":{"total": 3.28, "avg": 1.09, "max": 1.07, "min": 1.11, "cnt": 3}, "backward-recv":{"total": 116.85, "avg": 58.43, "max": 53.53, "min": 63.32, "cnt": 2}, "backward-params-all-reduce":{"total": 485.12, "avg": 485.12, "max": 485.12, "min": 485.12, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 241.20, "avg": 241.20, "max": 241.20, "min": 241.20, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 201.31, "avg": 201.31, "max": 201.31, "min": 201.31, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.36, "avg": 3.36, "max": 3.36, "min": 3.36, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 171, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 81.60, "avg": 27.20, "max": 1.75, "min": 73.12, "cnt": 3}, "forward-compute":{"total": 1838.61, "avg": 57.46, "max": 52.38, "min": 62.52, "cnt": 32}, "fwd-compute":{"total": 1835.45, "avg": 57.36, "max": 52.31, "min": 62.42, "cnt": 32}, "batch-generator":{"total": 47.43, "avg": 1.48, "max": 0.68, "min": 4.07, "cnt": 32}, "fwd-embedding":{"total": 0.61, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1775.99, "avg": 55.50, "max": 51.13, "min": 61.03, "cnt": 32}, "fwd-layernorm":{"total": 9.56, "avg": 0.07, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 105.53, "avg": 0.82, "max": 0.74, "min": 1.45, "cnt": 128}, "fwd-misc":{"total": 20.26, "avg": 0.16, "max": 0.11, "min": 0.33, "cnt": 128}, "fwd-MLP":{"total": 1620.26, "avg": 12.66, "max": 10.56, "min": 18.92, "cnt": 128}, "MoE_L0_fwd":{"total": 494.07, "avg": 15.44, "max": 12.95, "min": 18.84, "cnt": 32}, "MoEMLP":{"total": 1604.03, "avg": 12.53, "max": 10.46, "min": 18.79, "cnt": 128}, "MoE_L1_fwd":{"total": 393.18, "avg": 12.29, "max": 11.24, "min": 15.93, "cnt": 32}, "MoE_L2_fwd":{"total": 366.63, "avg": 11.46, "max": 10.63, "min": 14.66, "cnt": 32}, "MoE_L3_fwd":{"total": 356.12, "avg": 11.13, "max": 10.50, "min": 11.97, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 8.32, "avg": 4.16, "max": 0.97, "min": 7.36, "cnt": 2}, "forward-send-backward-recv":{"total": 935.54, "avg": 31.18, "max": 1.39, "min": 238.44, "cnt": 30}, "backward-compute":{"total": 1772.45, "avg": 55.39, "max": 53.01, "min": 58.58, "cnt": 32}, "MoE_L3_bwd":{"total": 398.39, "avg": 12.45, "max": 11.72, "min": 14.31, "cnt": 32}, "MoE_L2_bwd":{"total": 362.46, "avg": 11.33, "max": 10.56, "min": 14.26, "cnt": 32}, "MoE_L1_bwd":{"total": 350.48, "avg": 10.95, "max": 10.42, "min": 11.50, "cnt": 32}, "MoE_L0_bwd":{"total": 445.04, "avg": 13.91, "max": 13.13, "min": 14.16, "cnt": 32}, "backward-send-forward-recv":{"total": 2448.72, "avg": 84.44, "max": 1.25, "min": 880.47, "cnt": 29}, "backward-send":{"total": 1.85, "avg": 0.62, "max": 0.44, "min": 0.87, "cnt": 3}, "backward-recv":{"total": 150.70, "avg": 75.35, "max": 64.30, "min": 86.39, "cnt": 2}, "backward-params-all-reduce":{"total": 489.46, "avg": 489.46, "max": 489.46, "min": 489.46, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 237.58, "avg": 237.58, "max": 237.58, "min": 237.58, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 197.76, "avg": 197.76, "max": 197.76, "min": 197.76, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.50, "avg": 3.50, "max": 3.50, "min": 3.50, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.47, "avg": 3.47, "max": 3.47, "min": 3.47, "cnt": 1}}}
{"type":"time", "iteration": 172, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 81.65, "avg": 27.22, "max": 1.12, "min": 76.48, "cnt": 3}, "forward-compute":{"total": 1872.37, "avg": 58.51, "max": 52.41, "min": 69.55, "cnt": 32}, "fwd-compute":{"total": 1869.28, "avg": 58.42, "max": 52.33, "min": 69.42, "cnt": 32}, "batch-generator":{"total": 37.67, "avg": 1.18, "max": 0.65, "min": 1.78, "cnt": 32}, "fwd-embedding":{"total": 0.59, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1819.17, "avg": 56.85, "max": 51.17, "min": 67.32, "cnt": 32}, "fwd-layernorm":{"total": 9.36, "avg": 0.07, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 106.62, "avg": 0.83, "max": 0.74, "min": 1.45, "cnt": 128}, "fwd-misc":{"total": 20.41, "avg": 0.16, "max": 0.11, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1662.59, "avg": 12.99, "max": 10.82, "min": 24.83, "cnt": 128}, "MoE_L0_fwd":{"total": 517.51, "avg": 16.17, "max": 12.92, "min": 24.72, "cnt": 32}, "MoEMLP":{"total": 1646.54, "avg": 12.86, "max": 10.70, "min": 24.66, "cnt": 128}, "MoE_L1_fwd":{"total": 400.55, "avg": 12.52, "max": 11.40, "min": 15.47, "cnt": 32}, "MoE_L2_fwd":{"total": 368.32, "avg": 11.51, "max": 10.79, "min": 12.68, "cnt": 32}, "MoE_L3_fwd":{"total": 366.14, "avg": 11.44, "max": 10.75, "min": 12.77, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.73, "avg": 0.87, "max": 0.86, "min": 0.87, "cnt": 2}, "forward-send-backward-recv":{"total": 188.15, "avg": 6.27, "max": 0.95, "min": 117.87, "cnt": 30}, "backward-compute":{"total": 1782.96, "avg": 55.72, "max": 53.52, "min": 58.43, "cnt": 32}, "MoE_L3_bwd":{"total": 393.98, "avg": 12.31, "max": 10.85, "min": 14.89, "cnt": 32}, "MoE_L2_bwd":{"total": 358.84, "avg": 11.21, "max": 10.51, "min": 12.81, "cnt": 32}, "MoE_L1_bwd":{"total": 365.54, "avg": 11.42, "max": 10.57, "min": 13.52, "cnt": 32}, "MoE_L0_bwd":{"total": 449.15, "avg": 14.04, "max": 13.37, "min": 15.53, "cnt": 32}, "backward-send-forward-recv":{"total": 1061.15, "avg": 36.59, "max": 1.49, "min": 154.70, "cnt": 29}, "backward-send":{"total": 2.87, "avg": 0.96, "max": 0.84, "min": 1.06, "cnt": 3}, "backward-recv":{"total": 119.96, "avg": 59.98, "max": 56.42, "min": 63.53, "cnt": 2}, "backward-params-all-reduce":{"total": 489.38, "avg": 489.38, "max": 489.38, "min": 489.38, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 242.17, "avg": 242.17, "max": 242.17, "min": 242.17, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 202.25, "avg": 202.25, "max": 202.25, "min": 202.25, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.33, "avg": 3.33, "max": 3.33, "min": 3.33, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 173, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 76.73, "avg": 25.58, "max": 1.21, "min": 72.21, "cnt": 3}, "forward-compute":{"total": 1878.33, "avg": 58.70, "max": 52.03, "min": 64.97, "cnt": 32}, "fwd-compute":{"total": 1875.04, "avg": 58.60, "max": 51.96, "min": 64.89, "cnt": 32}, "batch-generator":{"total": 39.36, "avg": 1.23, "max": 0.65, "min": 1.74, "cnt": 32}, "fwd-embedding":{"total": 0.66, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1822.87, "avg": 56.96, "max": 50.96, "min": 63.02, "cnt": 32}, "fwd-layernorm":{"total": 9.89, "avg": 0.08, "max": 0.06, "min": 0.18, "cnt": 128}, "fwd-attn":{"total": 108.31, "avg": 0.85, "max": 0.74, "min": 1.51, "cnt": 128}, "fwd-misc":{"total": 21.42, "avg": 0.17, "max": 0.11, "min": 0.41, "cnt": 128}, "fwd-MLP":{"total": 1661.79, "avg": 12.98, "max": 10.73, "min": 21.28, "cnt": 128}, "MoE_L0_fwd":{"total": 519.79, "avg": 16.24, "max": 12.95, "min": 21.16, "cnt": 32}, "MoEMLP":{"total": 1644.67, "avg": 12.85, "max": 10.61, "min": 21.09, "cnt": 128}, "MoE_L1_fwd":{"total": 395.13, "avg": 12.35, "max": 11.40, "min": 14.31, "cnt": 32}, "MoE_L2_fwd":{"total": 367.80, "avg": 11.49, "max": 10.89, "min": 16.46, "cnt": 32}, "MoE_L3_fwd":{"total": 368.30, "avg": 11.51, "max": 10.66, "min": 14.76, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.74, "avg": 0.87, "max": 0.77, "min": 0.96, "cnt": 2}, "forward-send-backward-recv":{"total": 300.66, "avg": 10.02, "max": 1.05, "min": 118.79, "cnt": 30}, "backward-compute":{"total": 1981.19, "avg": 61.91, "max": 54.08, "min": 253.68, "cnt": 32}, "MoE_L3_bwd":{"total": 393.33, "avg": 12.29, "max": 11.00, "min": 14.25, "cnt": 32}, "MoE_L2_bwd":{"total": 353.55, "avg": 11.05, "max": 10.39, "min": 11.63, "cnt": 32}, "MoE_L1_bwd":{"total": 365.96, "avg": 11.44, "max": 10.61, "min": 14.15, "cnt": 32}, "MoE_L0_bwd":{"total": 650.19, "avg": 20.32, "max": 13.45, "min": 212.19, "cnt": 32}, "backward-send-forward-recv":{"total": 1428.65, "avg": 49.26, "max": 1.92, "min": 321.35, "cnt": 29}, "backward-send":{"total": 3.54, "avg": 1.18, "max": 1.10, "min": 1.33, "cnt": 3}, "backward-recv":{"total": 124.69, "avg": 62.35, "max": 54.75, "min": 69.94, "cnt": 2}, "backward-params-all-reduce":{"total": 486.28, "avg": 486.28, "max": 486.28, "min": 486.28, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 252.72, "avg": 252.72, "max": 252.72, "min": 252.72, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 212.14, "avg": 212.14, "max": 212.14, "min": 212.14, "cnt": 1}, "optimizer-clip-main-grad":{"total": 4.09, "avg": 4.09, "max": 4.09, "min": 4.09, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 174, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.10, "avg": 0.10, "max": 0.10, "min": 0.10, "cnt": 1}, "forward-recv":{"total": 73.41, "avg": 24.47, "max": 1.21, "min": 70.80, "cnt": 3}, "forward-compute":{"total": 1905.27, "avg": 59.54, "max": 53.70, "min": 63.82, "cnt": 32}, "fwd-compute":{"total": 1901.88, "avg": 59.43, "max": 53.63, "min": 63.74, "cnt": 32}, "batch-generator":{"total": 44.89, "avg": 1.40, "max": 0.68, "min": 2.39, "cnt": 32}, "fwd-embedding":{"total": 0.78, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1843.54, "avg": 57.61, "max": 52.65, "min": 61.49, "cnt": 32}, "fwd-layernorm":{"total": 10.65, "avg": 0.08, "max": 0.06, "min": 0.18, "cnt": 128}, "fwd-attn":{"total": 115.48, "avg": 0.90, "max": 0.74, "min": 2.67, "cnt": 128}, "fwd-misc":{"total": 22.79, "avg": 0.18, "max": 0.11, "min": 0.48, "cnt": 128}, "fwd-MLP":{"total": 1671.58, "avg": 13.06, "max": 10.65, "min": 18.70, "cnt": 128}, "MoE_L0_fwd":{"total": 528.91, "avg": 16.53, "max": 13.78, "min": 18.60, "cnt": 32}, "MoEMLP":{"total": 1653.71, "avg": 12.92, "max": 10.55, "min": 18.55, "cnt": 128}, "MoE_L1_fwd":{"total": 400.77, "avg": 12.52, "max": 11.40, "min": 13.86, "cnt": 32}, "MoE_L2_fwd":{"total": 367.26, "avg": 11.48, "max": 10.82, "min": 12.70, "cnt": 32}, "MoE_L3_fwd":{"total": 363.38, "avg": 11.36, "max": 10.59, "min": 12.55, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.68, "avg": 0.84, "max": 0.77, "min": 0.92, "cnt": 2}, "forward-send-backward-recv":{"total": 413.99, "avg": 13.80, "max": 1.46, "min": 112.70, "cnt": 30}, "backward-compute":{"total": 1795.03, "avg": 56.09, "max": 54.38, "min": 58.78, "cnt": 32}, "MoE_L3_bwd":{"total": 389.27, "avg": 12.16, "max": 11.64, "min": 13.01, "cnt": 32}, "MoE_L2_bwd":{"total": 367.43, "avg": 11.48, "max": 10.76, "min": 12.84, "cnt": 32}, "MoE_L1_bwd":{"total": 362.17, "avg": 11.32, "max": 10.81, "min": 12.39, "cnt": 32}, "MoE_L0_bwd":{"total": 455.36, "avg": 14.23, "max": 13.74, "min": 14.95, "cnt": 32}, "backward-send-forward-recv":{"total": 923.52, "avg": 31.85, "max": 0.99, "min": 262.53, "cnt": 29}, "backward-send":{"total": 2.94, "avg": 0.98, "max": 0.85, "min": 1.06, "cnt": 3}, "backward-recv":{"total": 252.47, "avg": 126.23, "max": 69.68, "min": 182.79, "cnt": 2}, "backward-params-all-reduce":{"total": 496.99, "avg": 496.99, "max": 496.99, "min": 496.99, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 233.81, "avg": 233.81, "max": 233.81, "min": 233.81, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 193.91, "avg": 193.91, "max": 193.91, "min": 193.91, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.55, "avg": 3.55, "max": 3.55, "min": 3.55, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.47, "avg": 3.47, "max": 3.47, "min": 3.47, "cnt": 1}}}
{"type":"time", "iteration": 175, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 75.15, "avg": 25.05, "max": 1.16, "min": 72.35, "cnt": 3}, "forward-compute":{"total": 1905.20, "avg": 59.54, "max": 52.42, "min": 65.96, "cnt": 32}, "fwd-compute":{"total": 1901.64, "avg": 59.43, "max": 52.33, "min": 65.83, "cnt": 32}, "batch-generator":{"total": 44.41, "avg": 1.39, "max": 0.71, "min": 2.44, "cnt": 32}, "fwd-embedding":{"total": 0.86, "avg": 0.03, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1843.18, "avg": 57.60, "max": 51.06, "min": 63.98, "cnt": 32}, "fwd-layernorm":{"total": 10.83, "avg": 0.08, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 116.37, "avg": 0.91, "max": 0.74, "min": 1.98, "cnt": 128}, "fwd-misc":{"total": 22.86, "avg": 0.18, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1670.34, "avg": 13.05, "max": 10.60, "min": 19.04, "cnt": 128}, "MoE_L0_fwd":{"total": 531.62, "avg": 16.61, "max": 14.06, "min": 18.89, "cnt": 32}, "MoEMLP":{"total": 1652.39, "avg": 12.91, "max": 10.48, "min": 18.80, "cnt": 128}, "MoE_L1_fwd":{"total": 397.08, "avg": 12.41, "max": 10.92, "min": 16.53, "cnt": 32}, "MoE_L2_fwd":{"total": 367.33, "avg": 11.48, "max": 10.77, "min": 13.13, "cnt": 32}, "MoE_L3_fwd":{"total": 362.83, "avg": 11.34, "max": 10.52, "min": 12.47, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.90, "avg": 0.95, "max": 0.90, "min": 1.00, "cnt": 2}, "forward-send-backward-recv":{"total": 481.40, "avg": 16.05, "max": 1.86, "min": 110.89, "cnt": 30}, "backward-compute":{"total": 1765.63, "avg": 55.18, "max": 53.41, "min": 56.33, "cnt": 32}, "MoE_L3_bwd":{"total": 384.64, "avg": 12.02, "max": 10.67, "min": 12.58, "cnt": 32}, "MoE_L2_bwd":{"total": 355.14, "avg": 11.10, "max": 10.39, "min": 11.95, "cnt": 32}, "MoE_L1_bwd":{"total": 354.25, "avg": 11.07, "max": 10.42, "min": 11.80, "cnt": 32}, "MoE_L0_bwd":{"total": 454.20, "avg": 14.19, "max": 13.73, "min": 14.50, "cnt": 32}, "backward-send-forward-recv":{"total": 937.95, "avg": 32.34, "max": 1.15, "min": 335.35, "cnt": 29}, "backward-send":{"total": 2.91, "avg": 0.97, "max": 0.71, "min": 1.12, "cnt": 3}, "backward-recv":{"total": 320.50, "avg": 160.25, "max": 58.41, "min": 262.09, "cnt": 2}, "backward-params-all-reduce":{"total": 536.57, "avg": 536.57, "max": 536.57, "min": 536.57, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 241.19, "avg": 241.19, "max": 241.19, "min": 241.19, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 196.99, "avg": 196.99, "max": 196.99, "min": 196.99, "cnt": 1}, "optimizer-clip-main-grad":{"total": 7.00, "avg": 7.00, "max": 7.00, "min": 7.00, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 176, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 78.23, "avg": 26.08, "max": 0.71, "min": 76.24, "cnt": 3}, "forward-compute":{"total": 1857.30, "avg": 58.04, "max": 52.72, "min": 64.53, "cnt": 32}, "fwd-compute":{"total": 1853.77, "avg": 57.93, "max": 52.64, "min": 64.43, "cnt": 32}, "batch-generator":{"total": 51.25, "avg": 1.60, "max": 0.67, "min": 3.46, "cnt": 32}, "fwd-embedding":{"total": 0.66, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1789.42, "avg": 55.92, "max": 51.60, "min": 60.77, "cnt": 32}, "fwd-layernorm":{"total": 10.04, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 110.70, "avg": 0.86, "max": 0.74, "min": 2.57, "cnt": 128}, "fwd-misc":{"total": 21.66, "avg": 0.17, "max": 0.12, "min": 0.66, "cnt": 128}, "fwd-MLP":{"total": 1625.79, "avg": 12.70, "max": 10.73, "min": 19.79, "cnt": 128}, "MoE_L0_fwd":{"total": 510.19, "avg": 15.94, "max": 13.36, "min": 19.71, "cnt": 32}, "MoEMLP":{"total": 1609.07, "avg": 12.57, "max": 10.63, "min": 19.67, "cnt": 128}, "MoE_L1_fwd":{"total": 380.34, "avg": 11.89, "max": 11.11, "min": 13.51, "cnt": 32}, "MoE_L2_fwd":{"total": 360.52, "avg": 11.27, "max": 10.78, "min": 11.97, "cnt": 32}, "MoE_L3_fwd":{"total": 364.18, "avg": 11.38, "max": 10.67, "min": 12.78, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 7.33, "avg": 3.67, "max": 0.96, "min": 6.37, "cnt": 2}, "forward-send-backward-recv":{"total": 187.95, "avg": 6.26, "max": 1.10, "min": 113.54, "cnt": 30}, "backward-compute":{"total": 1775.18, "avg": 55.47, "max": 52.89, "min": 58.93, "cnt": 32}, "MoE_L3_bwd":{"total": 387.86, "avg": 12.12, "max": 10.44, "min": 14.34, "cnt": 32}, "MoE_L2_bwd":{"total": 355.34, "avg": 11.10, "max": 10.35, "min": 11.85, "cnt": 32}, "MoE_L1_bwd":{"total": 358.46, "avg": 11.20, "max": 10.27, "min": 13.49, "cnt": 32}, "MoE_L0_bwd":{"total": 457.20, "avg": 14.29, "max": 13.33, "min": 16.70, "cnt": 32}, "backward-send-forward-recv":{"total": 2769.96, "avg": 95.52, "max": 2.41, "min": 487.88, "cnt": 29}, "backward-send":{"total": 3.13, "avg": 1.04, "max": 0.88, "min": 1.13, "cnt": 3}, "backward-recv":{"total": 380.20, "avg": 190.10, "max": 70.40, "min": 309.80, "cnt": 2}, "backward-params-all-reduce":{"total": 485.94, "avg": 485.94, "max": 485.94, "min": 485.94, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 245.30, "avg": 245.30, "max": 245.30, "min": 245.30, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 204.92, "avg": 204.92, "max": 204.92, "min": 204.92, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.83, "avg": 3.83, "max": 3.83, "min": 3.83, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 177, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 67.86, "avg": 22.62, "max": 1.49, "min": 64.79, "cnt": 3}, "forward-compute":{"total": 1899.22, "avg": 59.35, "max": 52.58, "min": 82.55, "cnt": 32}, "fwd-compute":{"total": 1896.05, "avg": 59.25, "max": 52.52, "min": 82.46, "cnt": 32}, "batch-generator":{"total": 39.56, "avg": 1.24, "max": 0.63, "min": 3.09, "cnt": 32}, "fwd-embedding":{"total": 0.66, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1844.17, "avg": 57.63, "max": 51.54, "min": 79.40, "cnt": 32}, "fwd-layernorm":{"total": 9.80, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 110.07, "avg": 0.86, "max": 0.74, "min": 1.83, "cnt": 128}, "fwd-misc":{"total": 21.44, "avg": 0.17, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1681.65, "avg": 13.14, "max": 10.81, "min": 37.65, "cnt": 128}, "MoE_L0_fwd":{"total": 547.61, "avg": 17.11, "max": 13.18, "min": 37.51, "cnt": 32}, "MoEMLP":{"total": 1664.96, "avg": 13.01, "max": 10.70, "min": 37.44, "cnt": 128}, "MoE_L1_fwd":{"total": 392.35, "avg": 12.26, "max": 11.21, "min": 15.65, "cnt": 32}, "MoE_L2_fwd":{"total": 366.02, "avg": 11.44, "max": 10.74, "min": 14.80, "cnt": 32}, "MoE_L3_fwd":{"total": 365.12, "avg": 11.41, "max": 10.84, "min": 12.38, "cnt": 32}, "fwd-pooler":{"total": 0.36, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.56, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.73, "avg": 0.86, "max": 0.79, "min": 0.94, "cnt": 2}, "forward-send-backward-recv":{"total": 589.86, "avg": 19.66, "max": 1.86, "min": 159.26, "cnt": 30}, "backward-compute":{"total": 1786.01, "avg": 55.81, "max": 53.41, "min": 59.28, "cnt": 32}, "MoE_L3_bwd":{"total": 395.78, "avg": 12.37, "max": 11.06, "min": 13.84, "cnt": 32}, "MoE_L2_bwd":{"total": 354.56, "avg": 11.08, "max": 10.67, "min": 12.19, "cnt": 32}, "MoE_L1_bwd":{"total": 365.71, "avg": 11.43, "max": 10.55, "min": 14.54, "cnt": 32}, "MoE_L0_bwd":{"total": 453.57, "avg": 14.17, "max": 13.84, "min": 14.56, "cnt": 32}, "backward-send-forward-recv":{"total": 1587.48, "avg": 54.74, "max": 1.54, "min": 263.39, "cnt": 29}, "backward-send":{"total": 2.75, "avg": 0.92, "max": 0.78, "min": 1.04, "cnt": 3}, "backward-recv":{"total": 136.45, "avg": 68.23, "max": 65.76, "min": 70.69, "cnt": 2}, "backward-params-all-reduce":{"total": 488.67, "avg": 488.67, "max": 488.67, "min": 488.67, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 247.69, "avg": 247.69, "max": 247.69, "min": 247.69, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 207.83, "avg": 207.83, "max": 207.83, "min": 207.83, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.41, "avg": 3.41, "max": 3.41, "min": 3.41, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.48, "avg": 3.48, "max": 3.48, "min": 3.48, "cnt": 1}}}
{"type":"time", "iteration": 178, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 75.57, "avg": 25.19, "max": 1.15, "min": 72.82, "cnt": 3}, "forward-compute":{"total": 1838.62, "avg": 57.46, "max": 51.80, "min": 63.22, "cnt": 32}, "fwd-compute":{"total": 1835.25, "avg": 57.35, "max": 51.72, "min": 63.14, "cnt": 32}, "batch-generator":{"total": 44.70, "avg": 1.40, "max": 0.60, "min": 2.50, "cnt": 32}, "fwd-embedding":{"total": 0.61, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1777.56, "avg": 55.55, "max": 50.82, "min": 60.66, "cnt": 32}, "fwd-layernorm":{"total": 9.84, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 107.08, "avg": 0.84, "max": 0.74, "min": 1.54, "cnt": 128}, "fwd-misc":{"total": 21.41, "avg": 0.17, "max": 0.11, "min": 0.41, "cnt": 128}, "fwd-MLP":{"total": 1618.08, "avg": 12.64, "max": 10.67, "min": 18.03, "cnt": 128}, "MoE_L0_fwd":{"total": 495.28, "avg": 15.48, "max": 12.99, "min": 17.94, "cnt": 32}, "MoEMLP":{"total": 1601.32, "avg": 12.51, "max": 10.56, "min": 17.89, "cnt": 128}, "MoE_L1_fwd":{"total": 387.62, "avg": 12.11, "max": 11.28, "min": 15.08, "cnt": 32}, "MoE_L2_fwd":{"total": 362.17, "avg": 11.32, "max": 10.61, "min": 12.59, "cnt": 32}, "MoE_L3_fwd":{"total": 362.47, "avg": 11.33, "max": 10.61, "min": 13.44, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.87, "avg": 0.94, "max": 0.93, "min": 0.94, "cnt": 2}, "forward-send-backward-recv":{"total": 593.26, "avg": 19.78, "max": 1.43, "min": 113.18, "cnt": 30}, "backward-compute":{"total": 1765.84, "avg": 55.18, "max": 52.78, "min": 61.08, "cnt": 32}, "MoE_L3_bwd":{"total": 388.02, "avg": 12.13, "max": 10.77, "min": 13.31, "cnt": 32}, "MoE_L2_bwd":{"total": 351.09, "avg": 10.97, "max": 10.46, "min": 11.86, "cnt": 32}, "MoE_L1_bwd":{"total": 360.65, "avg": 11.27, "max": 10.81, "min": 11.88, "cnt": 32}, "MoE_L0_bwd":{"total": 451.18, "avg": 14.10, "max": 13.39, "min": 19.13, "cnt": 32}, "backward-send-forward-recv":{"total": 1848.09, "avg": 63.73, "max": 1.23, "min": 615.33, "cnt": 29}, "backward-send":{"total": 2.84, "avg": 0.95, "max": 0.80, "min": 1.02, "cnt": 3}, "backward-recv":{"total": 192.57, "avg": 96.29, "max": 71.24, "min": 121.33, "cnt": 2}, "backward-params-all-reduce":{"total": 483.39, "avg": 483.39, "max": 483.39, "min": 483.39, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 249.07, "avg": 249.07, "max": 249.07, "min": 249.07, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 203.62, "avg": 203.62, "max": 203.62, "min": 203.62, "cnt": 1}, "optimizer-clip-main-grad":{"total": 8.10, "avg": 8.10, "max": 8.10, "min": 8.10, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 179, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 80.93, "avg": 26.98, "max": 1.12, "min": 73.31, "cnt": 3}, "forward-compute":{"total": 1898.79, "avg": 59.34, "max": 52.73, "min": 68.74, "cnt": 32}, "fwd-compute":{"total": 1895.28, "avg": 59.23, "max": 52.65, "min": 68.66, "cnt": 32}, "batch-generator":{"total": 47.82, "avg": 1.49, "max": 0.74, "min": 3.93, "cnt": 32}, "fwd-embedding":{"total": 0.69, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1834.66, "avg": 57.33, "max": 51.50, "min": 66.27, "cnt": 32}, "fwd-layernorm":{"total": 10.41, "avg": 0.08, "max": 0.06, "min": 0.29, "cnt": 128}, "fwd-attn":{"total": 114.08, "avg": 0.89, "max": 0.74, "min": 2.96, "cnt": 128}, "fwd-misc":{"total": 22.15, "avg": 0.17, "max": 0.11, "min": 0.53, "cnt": 128}, "fwd-MLP":{"total": 1666.09, "avg": 13.02, "max": 10.75, "min": 24.02, "cnt": 128}, "MoE_L0_fwd":{"total": 525.09, "avg": 16.41, "max": 13.02, "min": 23.86, "cnt": 32}, "MoEMLP":{"total": 1648.76, "avg": 12.88, "max": 10.64, "min": 23.76, "cnt": 128}, "MoE_L1_fwd":{"total": 398.41, "avg": 12.45, "max": 11.48, "min": 14.24, "cnt": 32}, "MoE_L2_fwd":{"total": 370.03, "avg": 11.56, "max": 10.77, "min": 16.19, "cnt": 32}, "MoE_L3_fwd":{"total": 361.66, "avg": 11.30, "max": 10.68, "min": 12.84, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.62, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.95, "avg": 0.97, "max": 0.89, "min": 1.06, "cnt": 2}, "forward-send-backward-recv":{"total": 222.10, "avg": 7.40, "max": 1.16, "min": 117.47, "cnt": 30}, "backward-compute":{"total": 1802.61, "avg": 56.33, "max": 54.86, "min": 58.29, "cnt": 32}, "MoE_L3_bwd":{"total": 396.68, "avg": 12.40, "max": 11.41, "min": 14.92, "cnt": 32}, "MoE_L2_bwd":{"total": 373.87, "avg": 11.68, "max": 10.67, "min": 12.92, "cnt": 32}, "MoE_L1_bwd":{"total": 369.23, "avg": 11.54, "max": 10.97, "min": 13.04, "cnt": 32}, "MoE_L0_bwd":{"total": 446.05, "avg": 13.94, "max": 13.50, "min": 14.38, "cnt": 32}, "backward-send-forward-recv":{"total": 3206.44, "avg": 110.57, "max": 1.53, "min": 596.60, "cnt": 29}, "backward-send":{"total": 1.96, "avg": 0.65, "max": 0.59, "min": 0.77, "cnt": 3}, "backward-recv":{"total": 141.43, "avg": 70.72, "max": 68.36, "min": 73.07, "cnt": 2}, "backward-params-all-reduce":{"total": 489.88, "avg": 489.88, "max": 489.88, "min": 489.88, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 242.39, "avg": 242.39, "max": 242.39, "min": 242.39, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 198.13, "avg": 198.13, "max": 198.13, "min": 198.13, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.93, "avg": 6.93, "max": 6.93, "min": 6.93, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 180, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 82.63, "avg": 27.54, "max": 1.10, "min": 77.72, "cnt": 3}, "forward-compute":{"total": 1913.90, "avg": 59.81, "max": 54.09, "min": 65.62, "cnt": 32}, "fwd-compute":{"total": 1910.43, "avg": 59.70, "max": 54.01, "min": 65.47, "cnt": 32}, "batch-generator":{"total": 48.00, "avg": 1.50, "max": 0.73, "min": 3.55, "cnt": 32}, "fwd-embedding":{"total": 0.72, "avg": 0.02, "max": 0.01, "min": 0.06, "cnt": 32}, "fwd-encoder":{"total": 1849.41, "avg": 57.79, "max": 52.96, "min": 63.16, "cnt": 32}, "fwd-layernorm":{"total": 10.33, "avg": 0.08, "max": 0.06, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 111.76, "avg": 0.87, "max": 0.74, "min": 2.38, "cnt": 128}, "fwd-misc":{"total": 22.05, "avg": 0.17, "max": 0.12, "min": 0.54, "cnt": 128}, "fwd-MLP":{"total": 1683.18, "avg": 13.15, "max": 11.09, "min": 19.38, "cnt": 128}, "MoE_L0_fwd":{"total": 511.02, "avg": 15.97, "max": 13.15, "min": 19.28, "cnt": 32}, "MoEMLP":{"total": 1665.71, "avg": 13.01, "max": 10.98, "min": 19.22, "cnt": 128}, "MoE_L1_fwd":{"total": 399.59, "avg": 12.49, "max": 11.52, "min": 15.35, "cnt": 32}, "MoE_L2_fwd":{"total": 385.73, "avg": 12.05, "max": 11.02, "min": 16.48, "cnt": 32}, "MoE_L3_fwd":{"total": 375.82, "avg": 11.74, "max": 11.11, "min": 12.73, "cnt": 32}, "fwd-pooler":{"total": 0.36, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.61, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 3.67, "avg": 1.83, "max": 0.93, "min": 2.74, "cnt": 2}, "forward-send-backward-recv":{"total": 325.34, "avg": 10.84, "max": 1.58, "min": 125.22, "cnt": 30}, "backward-compute":{"total": 1806.87, "avg": 56.46, "max": 54.49, "min": 58.96, "cnt": 32}, "MoE_L3_bwd":{"total": 402.91, "avg": 12.59, "max": 12.10, "min": 13.38, "cnt": 32}, "MoE_L2_bwd":{"total": 375.76, "avg": 11.74, "max": 11.16, "min": 14.46, "cnt": 32}, "MoE_L1_bwd":{"total": 358.84, "avg": 11.21, "max": 10.55, "min": 12.14, "cnt": 32}, "MoE_L0_bwd":{"total": 451.45, "avg": 14.11, "max": 13.55, "min": 15.72, "cnt": 32}, "backward-send-forward-recv":{"total": 1012.81, "avg": 34.92, "max": 1.97, "min": 185.14, "cnt": 29}, "backward-send":{"total": 2.91, "avg": 0.97, "max": 0.59, "min": 1.17, "cnt": 3}, "backward-recv":{"total": 144.05, "avg": 72.03, "max": 64.20, "min": 79.85, "cnt": 2}, "backward-params-all-reduce":{"total": 488.43, "avg": 488.43, "max": 488.43, "min": 488.43, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 248.18, "avg": 248.18, "max": 248.18, "min": 248.18, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 203.01, "avg": 203.01, "max": 203.01, "min": 203.01, "cnt": 1}, "optimizer-clip-main-grad":{"total": 7.83, "avg": 7.83, "max": 7.83, "min": 7.83, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}}}
{"type":"time", "iteration": 181, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 90.78, "avg": 30.26, "max": 4.29, "min": 70.86, "cnt": 3}, "forward-compute":{"total": 1880.93, "avg": 58.78, "max": 52.44, "min": 62.52, "cnt": 32}, "fwd-compute":{"total": 1877.18, "avg": 58.66, "max": 52.37, "min": 62.37, "cnt": 32}, "batch-generator":{"total": 44.13, "avg": 1.38, "max": 0.68, "min": 2.12, "cnt": 32}, "fwd-embedding":{"total": 0.79, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1819.22, "avg": 56.85, "max": 51.28, "min": 60.00, "cnt": 32}, "fwd-layernorm":{"total": 10.79, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 115.74, "avg": 0.90, "max": 0.74, "min": 2.40, "cnt": 128}, "fwd-misc":{"total": 22.22, "avg": 0.17, "max": 0.11, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1647.44, "avg": 12.87, "max": 10.98, "min": 19.39, "cnt": 128}, "MoE_L0_fwd":{"total": 510.13, "avg": 15.94, "max": 12.77, "min": 19.24, "cnt": 32}, "MoEMLP":{"total": 1629.61, "avg": 12.73, "max": 10.88, "min": 19.16, "cnt": 128}, "MoE_L1_fwd":{"total": 392.70, "avg": 12.27, "max": 11.37, "min": 13.48, "cnt": 32}, "MoE_L2_fwd":{"total": 366.44, "avg": 11.45, "max": 10.92, "min": 12.08, "cnt": 32}, "MoE_L3_fwd":{"total": 366.88, "avg": 11.47, "max": 10.94, "min": 12.54, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.83, "avg": 0.91, "max": 0.91, "min": 0.92, "cnt": 2}, "forward-send-backward-recv":{"total": 295.67, "avg": 9.86, "max": 1.45, "min": 109.01, "cnt": 30}, "backward-compute":{"total": 1879.91, "avg": 58.75, "max": 53.49, "min": 146.82, "cnt": 32}, "MoE_L3_bwd":{"total": 489.25, "avg": 15.29, "max": 11.29, "min": 103.67, "cnt": 32}, "MoE_L2_bwd":{"total": 365.32, "avg": 11.42, "max": 10.82, "min": 12.42, "cnt": 32}, "MoE_L1_bwd":{"total": 362.88, "avg": 11.34, "max": 10.86, "min": 12.24, "cnt": 32}, "MoE_L0_bwd":{"total": 444.54, "avg": 13.89, "max": 13.36, "min": 14.69, "cnt": 32}, "backward-send-forward-recv":{"total": 667.34, "avg": 23.01, "max": 1.46, "min": 174.64, "cnt": 29}, "backward-send":{"total": 3.03, "avg": 1.01, "max": 0.89, "min": 1.09, "cnt": 3}, "backward-recv":{"total": 260.25, "avg": 130.13, "max": 72.23, "min": 188.03, "cnt": 2}, "backward-params-all-reduce":{"total": 483.21, "avg": 483.21, "max": 483.21, "min": 483.21, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 247.07, "avg": 247.07, "max": 247.07, "min": 247.07, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 202.74, "avg": 202.74, "max": 202.74, "min": 202.74, "cnt": 1}, "optimizer-clip-main-grad":{"total": 7.05, "avg": 7.05, "max": 7.05, "min": 7.05, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 182, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 75.19, "avg": 25.06, "max": 1.06, "min": 72.81, "cnt": 3}, "forward-compute":{"total": 1910.21, "avg": 59.69, "max": 52.47, "min": 66.43, "cnt": 32}, "fwd-compute":{"total": 1906.33, "avg": 59.57, "max": 52.39, "min": 66.36, "cnt": 32}, "batch-generator":{"total": 43.30, "avg": 1.35, "max": 0.63, "min": 2.26, "cnt": 32}, "fwd-embedding":{"total": 0.72, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1848.68, "avg": 57.77, "max": 51.37, "min": 65.42, "cnt": 32}, "fwd-layernorm":{"total": 10.61, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 114.05, "avg": 0.89, "max": 0.74, "min": 3.47, "cnt": 128}, "fwd-misc":{"total": 22.20, "avg": 0.17, "max": 0.11, "min": 0.55, "cnt": 128}, "fwd-MLP":{"total": 1679.66, "avg": 13.12, "max": 10.92, "min": 20.35, "cnt": 128}, "MoE_L0_fwd":{"total": 518.27, "avg": 16.20, "max": 12.88, "min": 20.28, "cnt": 32}, "MoEMLP":{"total": 1662.08, "avg": 12.99, "max": 10.83, "min": 20.24, "cnt": 128}, "MoE_L1_fwd":{"total": 399.26, "avg": 12.48, "max": 11.35, "min": 16.52, "cnt": 32}, "MoE_L2_fwd":{"total": 374.73, "avg": 11.71, "max": 10.95, "min": 14.90, "cnt": 32}, "MoE_L3_fwd":{"total": 376.24, "avg": 11.76, "max": 10.86, "min": 17.40, "cnt": 32}, "fwd-pooler":{"total": 0.36, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 9.00, "avg": 4.50, "max": 0.73, "min": 8.27, "cnt": 2}, "forward-send-backward-recv":{"total": 330.00, "avg": 11.00, "max": 1.38, "min": 102.82, "cnt": 30}, "backward-compute":{"total": 1779.08, "avg": 55.60, "max": 53.07, "min": 59.55, "cnt": 32}, "MoE_L3_bwd":{"total": 397.21, "avg": 12.41, "max": 11.56, "min": 14.87, "cnt": 32}, "MoE_L2_bwd":{"total": 362.57, "avg": 11.33, "max": 10.64, "min": 15.05, "cnt": 32}, "MoE_L1_bwd":{"total": 362.02, "avg": 11.31, "max": 10.67, "min": 11.99, "cnt": 32}, "MoE_L0_bwd":{"total": 438.47, "avg": 13.70, "max": 13.22, "min": 15.09, "cnt": 32}, "backward-send-forward-recv":{"total": 461.99, "avg": 15.93, "max": 1.17, "min": 119.25, "cnt": 29}, "backward-send":{"total": 1.80, "avg": 0.60, "max": 0.45, "min": 0.86, "cnt": 3}, "backward-recv":{"total": 138.29, "avg": 69.15, "max": 68.85, "min": 69.45, "cnt": 2}, "backward-params-all-reduce":{"total": 491.79, "avg": 491.79, "max": 491.79, "min": 491.79, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 238.35, "avg": 238.35, "max": 238.35, "min": 238.35, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 193.82, "avg": 193.82, "max": 193.82, "min": 193.82, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.95, "avg": 6.95, "max": 6.95, "min": 6.95, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.63, "avg": 3.63, "max": 3.63, "min": 3.63, "cnt": 1}}}
{"type":"time", "iteration": 183, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 74.12, "avg": 24.71, "max": 1.12, "min": 71.57, "cnt": 3}, "forward-compute":{"total": 1887.61, "avg": 58.99, "max": 53.98, "min": 66.75, "cnt": 32}, "fwd-compute":{"total": 1884.25, "avg": 58.88, "max": 53.91, "min": 66.66, "cnt": 32}, "batch-generator":{"total": 44.86, "avg": 1.40, "max": 0.72, "min": 4.00, "cnt": 32}, "fwd-embedding":{"total": 0.69, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1826.08, "avg": 57.07, "max": 52.43, "min": 65.07, "cnt": 32}, "fwd-layernorm":{"total": 10.56, "avg": 0.08, "max": 0.06, "min": 0.24, "cnt": 128}, "fwd-attn":{"total": 112.05, "avg": 0.88, "max": 0.74, "min": 1.79, "cnt": 128}, "fwd-misc":{"total": 21.78, "avg": 0.17, "max": 0.12, "min": 0.41, "cnt": 128}, "fwd-MLP":{"total": 1659.62, "avg": 12.97, "max": 10.89, "min": 25.55, "cnt": 128}, "MoE_L0_fwd":{"total": 516.69, "avg": 16.15, "max": 12.71, "min": 25.45, "cnt": 32}, "MoEMLP":{"total": 1642.02, "avg": 12.83, "max": 10.77, "min": 25.39, "cnt": 128}, "MoE_L1_fwd":{"total": 392.48, "avg": 12.27, "max": 11.45, "min": 14.99, "cnt": 32}, "MoE_L2_fwd":{"total": 374.52, "avg": 11.70, "max": 10.83, "min": 15.96, "cnt": 32}, "MoE_L3_fwd":{"total": 364.80, "avg": 11.40, "max": 10.81, "min": 12.52, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 8.28, "avg": 4.14, "max": 0.95, "min": 7.34, "cnt": 2}, "forward-send-backward-recv":{"total": 508.20, "avg": 16.94, "max": 1.55, "min": 212.34, "cnt": 30}, "backward-compute":{"total": 1780.45, "avg": 55.64, "max": 53.39, "min": 58.89, "cnt": 32}, "MoE_L3_bwd":{"total": 391.14, "avg": 12.22, "max": 10.42, "min": 15.70, "cnt": 32}, "MoE_L2_bwd":{"total": 362.61, "avg": 11.33, "max": 10.38, "min": 12.27, "cnt": 32}, "MoE_L1_bwd":{"total": 369.60, "avg": 11.55, "max": 10.67, "min": 12.35, "cnt": 32}, "MoE_L0_bwd":{"total": 441.77, "avg": 13.81, "max": 13.34, "min": 14.77, "cnt": 32}, "backward-send-forward-recv":{"total": 5475.43, "avg": 188.81, "max": 2.32, "min": 1193.53, "cnt": 29}, "backward-send":{"total": 2.59, "avg": 0.86, "max": 0.51, "min": 1.12, "cnt": 3}, "backward-recv":{"total": 129.04, "avg": 64.52, "max": 59.50, "min": 69.54, "cnt": 2}, "backward-params-all-reduce":{"total": 484.08, "avg": 484.08, "max": 484.08, "min": 484.08, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 248.99, "avg": 248.99, "max": 248.99, "min": 248.99, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 204.89, "avg": 204.89, "max": 204.89, "min": 204.89, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.82, "avg": 6.82, "max": 6.82, "min": 6.82, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 184, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 81.98, "avg": 27.33, "max": 1.10, "min": 74.14, "cnt": 3}, "forward-compute":{"total": 1915.77, "avg": 59.87, "max": 53.64, "min": 65.70, "cnt": 32}, "fwd-compute":{"total": 1912.07, "avg": 59.75, "max": 53.56, "min": 65.62, "cnt": 32}, "batch-generator":{"total": 45.23, "avg": 1.41, "max": 0.75, "min": 2.43, "cnt": 32}, "fwd-embedding":{"total": 0.79, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1853.06, "avg": 57.91, "max": 52.22, "min": 64.34, "cnt": 32}, "fwd-layernorm":{"total": 10.76, "avg": 0.08, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 113.43, "avg": 0.89, "max": 0.74, "min": 1.50, "cnt": 128}, "fwd-misc":{"total": 22.84, "avg": 0.18, "max": 0.12, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1683.63, "avg": 13.15, "max": 10.91, "min": 19.72, "cnt": 128}, "MoE_L0_fwd":{"total": 511.76, "avg": 15.99, "max": 12.58, "min": 19.58, "cnt": 32}, "MoEMLP":{"total": 1665.67, "avg": 13.01, "max": 10.80, "min": 19.47, "cnt": 128}, "MoE_L1_fwd":{"total": 409.63, "avg": 12.80, "max": 11.35, "min": 16.22, "cnt": 32}, "MoE_L2_fwd":{"total": 377.68, "avg": 11.80, "max": 10.84, "min": 15.68, "cnt": 32}, "MoE_L3_fwd":{"total": 373.29, "avg": 11.67, "max": 10.92, "min": 13.52, "cnt": 32}, "fwd-pooler":{"total": 0.38, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.65, "avg": 0.82, "max": 0.79, "min": 0.86, "cnt": 2}, "forward-send-backward-recv":{"total": 687.78, "avg": 22.93, "max": 1.87, "min": 162.08, "cnt": 30}, "backward-compute":{"total": 1788.49, "avg": 55.89, "max": 54.47, "min": 58.40, "cnt": 32}, "MoE_L3_bwd":{"total": 397.82, "avg": 12.43, "max": 11.10, "min": 14.03, "cnt": 32}, "MoE_L2_bwd":{"total": 363.98, "avg": 11.37, "max": 10.31, "min": 12.19, "cnt": 32}, "MoE_L1_bwd":{"total": 376.94, "avg": 11.78, "max": 11.19, "min": 13.24, "cnt": 32}, "MoE_L0_bwd":{"total": 435.13, "avg": 13.60, "max": 13.24, "min": 14.01, "cnt": 32}, "backward-send-forward-recv":{"total": 614.56, "avg": 21.19, "max": 1.84, "min": 226.73, "cnt": 29}, "backward-send":{"total": 2.40, "avg": 0.80, "max": 0.67, "min": 0.91, "cnt": 3}, "backward-recv":{"total": 247.10, "avg": 123.55, "max": 71.92, "min": 175.18, "cnt": 2}, "backward-params-all-reduce":{"total": 485.19, "avg": 485.19, "max": 485.19, "min": 485.19, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 241.66, "avg": 241.66, "max": 241.66, "min": 241.66, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 201.43, "avg": 201.43, "max": 201.43, "min": 201.43, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.70, "avg": 3.70, "max": 3.70, "min": 3.70, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 185, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 91.32, "avg": 30.44, "max": 4.57, "min": 76.31, "cnt": 3}, "forward-compute":{"total": 1891.63, "avg": 59.11, "max": 54.00, "min": 67.05, "cnt": 32}, "fwd-compute":{"total": 1888.25, "avg": 59.01, "max": 53.93, "min": 66.97, "cnt": 32}, "batch-generator":{"total": 42.75, "avg": 1.34, "max": 0.66, "min": 2.72, "cnt": 32}, "fwd-embedding":{"total": 0.69, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 1831.99, "avg": 57.25, "max": 52.82, "min": 65.34, "cnt": 32}, "fwd-layernorm":{"total": 10.24, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 112.57, "avg": 0.88, "max": 0.74, "min": 2.10, "cnt": 128}, "fwd-misc":{"total": 21.37, "avg": 0.17, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1666.17, "avg": 13.02, "max": 10.76, "min": 19.32, "cnt": 128}, "MoE_L0_fwd":{"total": 509.80, "avg": 15.93, "max": 13.36, "min": 19.21, "cnt": 32}, "MoEMLP":{"total": 1649.18, "avg": 12.88, "max": 10.65, "min": 19.15, "cnt": 128}, "MoE_L1_fwd":{"total": 410.50, "avg": 12.83, "max": 11.70, "min": 17.23, "cnt": 32}, "MoE_L2_fwd":{"total": 366.96, "avg": 11.47, "max": 10.69, "min": 13.32, "cnt": 32}, "MoE_L3_fwd":{"total": 368.15, "avg": 11.50, "max": 10.83, "min": 12.42, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.29, "avg": 0.64, "max": 0.55, "min": 0.74, "cnt": 2}, "forward-send-backward-recv":{"total": 189.75, "avg": 6.33, "max": 1.41, "min": 103.13, "cnt": 30}, "backward-compute":{"total": 1786.29, "avg": 55.82, "max": 54.39, "min": 58.06, "cnt": 32}, "MoE_L3_bwd":{"total": 390.97, "avg": 12.22, "max": 11.15, "min": 14.28, "cnt": 32}, "MoE_L2_bwd":{"total": 362.74, "avg": 11.34, "max": 10.25, "min": 12.64, "cnt": 32}, "MoE_L1_bwd":{"total": 379.00, "avg": 11.84, "max": 11.43, "min": 12.38, "cnt": 32}, "MoE_L0_bwd":{"total": 440.06, "avg": 13.75, "max": 13.26, "min": 16.26, "cnt": 32}, "backward-send-forward-recv":{"total": 1862.34, "avg": 64.22, "max": 1.78, "min": 354.02, "cnt": 29}, "backward-send":{"total": 2.71, "avg": 0.90, "max": 0.86, "min": 0.93, "cnt": 3}, "backward-recv":{"total": 124.15, "avg": 62.07, "max": 57.85, "min": 66.30, "cnt": 2}, "backward-params-all-reduce":{"total": 496.22, "avg": 496.22, "max": 496.22, "min": 496.22, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 242.22, "avg": 242.22, "max": 242.22, "min": 242.22, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 202.21, "avg": 202.21, "max": 202.21, "min": 202.21, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.61, "avg": 3.61, "max": 3.61, "min": 3.61, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 186, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "forward-recv":{"total": 75.29, "avg": 25.10, "max": 0.86, "min": 73.23, "cnt": 3}, "forward-compute":{"total": 1912.72, "avg": 59.77, "max": 53.53, "min": 63.84, "cnt": 32}, "fwd-compute":{"total": 1909.18, "avg": 59.66, "max": 53.46, "min": 63.76, "cnt": 32}, "batch-generator":{"total": 44.61, "avg": 1.39, "max": 0.65, "min": 3.26, "cnt": 32}, "fwd-embedding":{"total": 0.75, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1851.07, "avg": 57.85, "max": 52.24, "min": 62.24, "cnt": 32}, "fwd-layernorm":{"total": 10.48, "avg": 0.08, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 111.61, "avg": 0.87, "max": 0.74, "min": 1.90, "cnt": 128}, "fwd-misc":{"total": 22.17, "avg": 0.17, "max": 0.11, "min": 0.40, "cnt": 128}, "fwd-MLP":{"total": 1684.50, "avg": 13.16, "max": 10.86, "min": 22.60, "cnt": 128}, "MoE_L0_fwd":{"total": 533.17, "avg": 16.66, "max": 13.19, "min": 22.49, "cnt": 32}, "MoEMLP":{"total": 1666.91, "avg": 13.02, "max": 10.74, "min": 22.44, "cnt": 128}, "MoE_L1_fwd":{"total": 398.92, "avg": 12.47, "max": 11.25, "min": 13.81, "cnt": 32}, "MoE_L2_fwd":{"total": 366.54, "avg": 11.45, "max": 10.80, "min": 12.39, "cnt": 32}, "MoE_L3_fwd":{"total": 374.75, "avg": 11.71, "max": 11.01, "min": 13.24, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 8.55, "avg": 4.28, "max": 0.81, "min": 7.74, "cnt": 2}, "forward-send-backward-recv":{"total": 512.02, "avg": 17.07, "max": 1.52, "min": 118.68, "cnt": 30}, "backward-compute":{"total": 1792.64, "avg": 56.02, "max": 54.17, "min": 57.78, "cnt": 32}, "MoE_L3_bwd":{"total": 399.80, "avg": 12.49, "max": 11.46, "min": 14.88, "cnt": 32}, "MoE_L2_bwd":{"total": 366.20, "avg": 11.44, "max": 10.31, "min": 13.18, "cnt": 32}, "MoE_L1_bwd":{"total": 374.75, "avg": 11.71, "max": 11.15, "min": 12.56, "cnt": 32}, "MoE_L0_bwd":{"total": 439.22, "avg": 13.73, "max": 13.14, "min": 14.44, "cnt": 32}, "backward-send-forward-recv":{"total": 2349.92, "avg": 81.03, "max": 1.50, "min": 1378.12, "cnt": 29}, "backward-send":{"total": 2.72, "avg": 0.91, "max": 0.79, "min": 1.05, "cnt": 3}, "backward-recv":{"total": 133.78, "avg": 66.89, "max": 66.39, "min": 67.39, "cnt": 2}, "backward-params-all-reduce":{"total": 494.18, "avg": 494.18, "max": 494.18, "min": 494.18, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 238.26, "avg": 238.26, "max": 238.26, "min": 238.26, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.36, "avg": 3.36, "max": 3.36, "min": 3.36, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 198.15, "avg": 198.15, "max": 198.15, "min": 198.15, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.68, "avg": 3.68, "max": 3.68, "min": 3.68, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 187, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 91.91, "avg": 30.64, "max": 2.32, "min": 86.28, "cnt": 3}, "forward-compute":{"total": 1930.75, "avg": 60.34, "max": 53.29, "min": 67.51, "cnt": 32}, "fwd-compute":{"total": 1927.18, "avg": 60.22, "max": 53.21, "min": 67.38, "cnt": 32}, "batch-generator":{"total": 43.71, "avg": 1.37, "max": 0.71, "min": 2.28, "cnt": 32}, "fwd-embedding":{"total": 0.80, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1870.13, "avg": 58.44, "max": 52.04, "min": 65.30, "cnt": 32}, "fwd-layernorm":{"total": 10.86, "avg": 0.08, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 114.43, "avg": 0.89, "max": 0.74, "min": 1.52, "cnt": 128}, "fwd-misc":{"total": 22.73, "avg": 0.18, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1699.32, "avg": 13.28, "max": 10.86, "min": 22.35, "cnt": 128}, "MoE_L0_fwd":{"total": 536.83, "avg": 16.78, "max": 12.79, "min": 22.20, "cnt": 32}, "MoEMLP":{"total": 1681.24, "avg": 13.13, "max": 10.75, "min": 22.11, "cnt": 128}, "MoE_L1_fwd":{"total": 410.21, "avg": 12.82, "max": 11.26, "min": 16.85, "cnt": 32}, "MoE_L2_fwd":{"total": 371.98, "avg": 11.62, "max": 10.79, "min": 13.51, "cnt": 32}, "MoE_L3_fwd":{"total": 368.82, "avg": 11.53, "max": 11.06, "min": 12.23, "cnt": 32}, "fwd-pooler":{"total": 0.33, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.67, "avg": 0.84, "max": 0.83, "min": 0.84, "cnt": 2}, "forward-send-backward-recv":{"total": 769.21, "avg": 25.64, "max": 1.50, "min": 143.12, "cnt": 30}, "backward-compute":{"total": 1782.63, "avg": 55.71, "max": 52.55, "min": 59.23, "cnt": 32}, "MoE_L3_bwd":{"total": 406.94, "avg": 12.72, "max": 10.46, "min": 15.44, "cnt": 32}, "MoE_L2_bwd":{"total": 356.35, "avg": 11.14, "max": 10.44, "min": 12.02, "cnt": 32}, "MoE_L1_bwd":{"total": 368.53, "avg": 11.52, "max": 11.04, "min": 11.98, "cnt": 32}, "MoE_L0_bwd":{"total": 435.40, "avg": 13.61, "max": 13.03, "min": 14.28, "cnt": 32}, "backward-send-forward-recv":{"total": 1068.63, "avg": 36.85, "max": 1.14, "min": 233.67, "cnt": 29}, "backward-send":{"total": 1.97, "avg": 0.66, "max": 0.58, "min": 0.75, "cnt": 3}, "backward-recv":{"total": 134.77, "avg": 67.39, "max": 66.09, "min": 68.69, "cnt": 2}, "backward-params-all-reduce":{"total": 493.13, "avg": 493.13, "max": 493.13, "min": 493.13, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 241.27, "avg": 241.27, "max": 241.27, "min": 241.27, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.39, "avg": 3.39, "max": 3.39, "min": 3.39, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 201.25, "avg": 201.25, "max": 201.25, "min": 201.25, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.34, "avg": 3.34, "max": 3.34, "min": 3.34, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.49, "avg": 3.49, "max": 3.49, "min": 3.49, "cnt": 1}}}
{"type":"time", "iteration": 188, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 71.82, "avg": 23.94, "max": 1.37, "min": 67.33, "cnt": 3}, "forward-compute":{"total": 1911.18, "avg": 59.72, "max": 54.23, "min": 66.27, "cnt": 32}, "fwd-compute":{"total": 1907.77, "avg": 59.62, "max": 54.16, "min": 66.13, "cnt": 32}, "batch-generator":{"total": 40.22, "avg": 1.26, "max": 0.71, "min": 1.92, "cnt": 32}, "fwd-embedding":{"total": 0.68, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1854.87, "avg": 57.96, "max": 53.12, "min": 64.09, "cnt": 32}, "fwd-layernorm":{"total": 10.40, "avg": 0.08, "max": 0.06, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 114.76, "avg": 0.90, "max": 0.74, "min": 2.66, "cnt": 128}, "fwd-misc":{"total": 22.60, "avg": 0.18, "max": 0.11, "min": 0.46, "cnt": 128}, "fwd-MLP":{"total": 1685.05, "avg": 13.16, "max": 10.63, "min": 18.97, "cnt": 128}, "MoE_L0_fwd":{"total": 517.86, "avg": 16.18, "max": 13.18, "min": 18.83, "cnt": 32}, "MoEMLP":{"total": 1667.42, "avg": 13.03, "max": 10.53, "min": 18.75, "cnt": 128}, "MoE_L1_fwd":{"total": 411.95, "avg": 12.87, "max": 11.58, "min": 14.82, "cnt": 32}, "MoE_L2_fwd":{"total": 378.93, "avg": 11.84, "max": 10.92, "min": 15.78, "cnt": 32}, "MoE_L3_fwd":{"total": 365.04, "avg": 11.41, "max": 10.56, "min": 13.02, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.54, "avg": 0.77, "max": 0.76, "min": 0.78, "cnt": 2}, "forward-send-backward-recv":{"total": 1303.79, "avg": 43.46, "max": 1.30, "min": 386.50, "cnt": 30}, "backward-compute":{"total": 1802.86, "avg": 56.34, "max": 54.81, "min": 60.16, "cnt": 32}, "MoE_L3_bwd":{"total": 403.34, "avg": 12.60, "max": 11.60, "min": 14.12, "cnt": 32}, "MoE_L2_bwd":{"total": 361.58, "avg": 11.30, "max": 10.59, "min": 12.85, "cnt": 32}, "MoE_L1_bwd":{"total": 376.60, "avg": 11.77, "max": 11.13, "min": 12.17, "cnt": 32}, "MoE_L0_bwd":{"total": 445.33, "avg": 13.92, "max": 12.88, "min": 17.02, "cnt": 32}, "backward-send-forward-recv":{"total": 1209.25, "avg": 41.70, "max": 1.82, "min": 221.93, "cnt": 29}, "backward-send":{"total": 3.37, "avg": 1.12, "max": 1.08, "min": 1.15, "cnt": 3}, "backward-recv":{"total": 217.24, "avg": 108.62, "max": 73.08, "min": 144.16, "cnt": 2}, "backward-params-all-reduce":{"total": 484.28, "avg": 484.28, "max": 484.28, "min": 484.28, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 244.94, "avg": 244.94, "max": 244.94, "min": 244.94, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 204.92, "avg": 204.92, "max": 204.92, "min": 204.92, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.68, "avg": 3.68, "max": 3.68, "min": 3.68, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 189, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 72.74, "avg": 24.25, "max": 1.16, "min": 70.05, "cnt": 3}, "forward-compute":{"total": 1911.49, "avg": 59.73, "max": 52.66, "min": 69.11, "cnt": 32}, "fwd-compute":{"total": 1907.81, "avg": 59.62, "max": 52.59, "min": 68.97, "cnt": 32}, "batch-generator":{"total": 44.06, "avg": 1.38, "max": 0.66, "min": 2.28, "cnt": 32}, "fwd-embedding":{"total": 0.81, "avg": 0.03, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1850.60, "avg": 57.83, "max": 51.58, "min": 66.87, "cnt": 32}, "fwd-layernorm":{"total": 10.91, "avg": 0.09, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 113.69, "avg": 0.89, "max": 0.74, "min": 1.86, "cnt": 128}, "fwd-misc":{"total": 22.86, "avg": 0.18, "max": 0.11, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1680.73, "avg": 13.13, "max": 10.87, "min": 18.14, "cnt": 128}, "MoE_L0_fwd":{"total": 506.96, "avg": 15.84, "max": 12.35, "min": 18.03, "cnt": 32}, "MoEMLP":{"total": 1662.86, "avg": 12.99, "max": 10.77, "min": 18.02, "cnt": 128}, "MoE_L1_fwd":{"total": 418.98, "avg": 13.09, "max": 11.73, "min": 18.06, "cnt": 32}, "MoE_L2_fwd":{"total": 375.57, "avg": 11.74, "max": 10.81, "min": 13.83, "cnt": 32}, "MoE_L3_fwd":{"total": 367.93, "avg": 11.50, "max": 10.86, "min": 12.62, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.56, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 32}, "forward-send":{"total": 1.74, "avg": 0.87, "max": 0.81, "min": 0.93, "cnt": 2}, "forward-send-backward-recv":{"total": 728.22, "avg": 24.27, "max": 1.47, "min": 313.59, "cnt": 30}, "backward-compute":{"total": 1772.07, "avg": 55.38, "max": 52.34, "min": 58.62, "cnt": 32}, "MoE_L3_bwd":{"total": 406.69, "avg": 12.71, "max": 11.51, "min": 14.84, "cnt": 32}, "MoE_L2_bwd":{"total": 350.87, "avg": 10.96, "max": 10.05, "min": 12.39, "cnt": 32}, "MoE_L1_bwd":{"total": 370.33, "avg": 11.57, "max": 10.79, "min": 12.66, "cnt": 32}, "MoE_L0_bwd":{"total": 427.25, "avg": 13.35, "max": 12.50, "min": 15.01, "cnt": 32}, "backward-send-forward-recv":{"total": 346.19, "avg": 11.94, "max": 1.58, "min": 94.31, "cnt": 29}, "backward-send":{"total": 2.89, "avg": 0.96, "max": 0.87, "min": 1.08, "cnt": 3}, "backward-recv":{"total": 177.93, "avg": 88.97, "max": 68.87, "min": 109.06, "cnt": 2}, "backward-params-all-reduce":{"total": 486.77, "avg": 486.77, "max": 486.77, "min": 486.77, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 238.76, "avg": 238.76, "max": 238.76, "min": 238.76, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.36, "avg": 3.36, "max": 3.36, "min": 3.36, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 199.04, "avg": 199.04, "max": 199.04, "min": 199.04, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 190, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.13, "avg": 0.13, "max": 0.13, "min": 0.13, "cnt": 1}, "forward-recv":{"total": 76.84, "avg": 25.61, "max": 0.80, "min": 74.88, "cnt": 3}, "forward-compute":{"total": 1928.99, "avg": 60.28, "max": 54.82, "min": 64.96, "cnt": 32}, "fwd-compute":{"total": 1925.30, "avg": 60.17, "max": 54.74, "min": 64.82, "cnt": 32}, "batch-generator":{"total": 44.19, "avg": 1.38, "max": 0.70, "min": 1.91, "cnt": 32}, "fwd-embedding":{"total": 0.81, "avg": 0.03, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1867.14, "avg": 58.35, "max": 53.55, "min": 62.70, "cnt": 32}, "fwd-layernorm":{"total": 10.99, "avg": 0.09, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 114.14, "avg": 0.89, "max": 0.74, "min": 2.00, "cnt": 128}, "fwd-misc":{"total": 22.94, "avg": 0.18, "max": 0.12, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1696.48, "avg": 13.25, "max": 10.88, "min": 20.83, "cnt": 128}, "MoE_L0_fwd":{"total": 521.62, "avg": 16.30, "max": 13.25, "min": 20.71, "cnt": 32}, "MoEMLP":{"total": 1678.11, "avg": 13.11, "max": 10.78, "min": 20.64, "cnt": 128}, "MoE_L1_fwd":{"total": 408.11, "avg": 12.75, "max": 11.62, "min": 17.81, "cnt": 32}, "MoE_L2_fwd":{"total": 380.20, "avg": 11.88, "max": 10.97, "min": 16.80, "cnt": 32}, "MoE_L3_fwd":{"total": 374.81, "avg": 11.71, "max": 10.82, "min": 14.92, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 7.28, "avg": 3.64, "max": 0.79, "min": 6.49, "cnt": 2}, "forward-send-backward-recv":{"total": 370.99, "avg": 12.37, "max": 1.68, "min": 154.78, "cnt": 30}, "backward-compute":{"total": 1844.41, "avg": 57.64, "max": 53.36, "min": 135.43, "cnt": 32}, "MoE_L3_bwd":{"total": 457.39, "avg": 14.29, "max": 11.15, "min": 75.09, "cnt": 32}, "MoE_L2_bwd":{"total": 375.26, "avg": 11.73, "max": 10.52, "min": 30.45, "cnt": 32}, "MoE_L1_bwd":{"total": 367.81, "avg": 11.49, "max": 11.11, "min": 12.75, "cnt": 32}, "MoE_L0_bwd":{"total": 428.70, "avg": 13.40, "max": 12.64, "min": 13.79, "cnt": 32}, "backward-send-forward-recv":{"total": 751.04, "avg": 25.90, "max": 1.15, "min": 278.73, "cnt": 29}, "backward-send":{"total": 3.27, "avg": 1.09, "max": 1.08, "min": 1.10, "cnt": 3}, "backward-recv":{"total": 147.43, "avg": 73.71, "max": 72.49, "min": 74.93, "cnt": 2}, "backward-params-all-reduce":{"total": 486.33, "avg": 486.33, "max": 486.33, "min": 486.33, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.09, "avg": 0.09, "max": 0.09, "min": 0.09, "cnt": 1}, "optimizer":{"total": 236.86, "avg": 236.86, "max": 236.86, "min": 236.86, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 196.89, "avg": 196.89, "max": 196.89, "min": 196.89, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.45, "avg": 3.45, "max": 3.45, "min": 3.45, "cnt": 1}}}
{"type":"time", "iteration": 191, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 71.93, "avg": 23.98, "max": 1.33, "min": 69.02, "cnt": 3}, "forward-compute":{"total": 1856.88, "avg": 58.03, "max": 52.24, "min": 64.59, "cnt": 32}, "fwd-compute":{"total": 1853.35, "avg": 57.92, "max": 52.17, "min": 64.46, "cnt": 32}, "batch-generator":{"total": 43.68, "avg": 1.36, "max": 0.70, "min": 1.91, "cnt": 32}, "fwd-embedding":{"total": 0.73, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1796.73, "avg": 56.15, "max": 51.07, "min": 62.43, "cnt": 32}, "fwd-layernorm":{"total": 10.64, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 114.67, "avg": 0.90, "max": 0.74, "min": 2.99, "cnt": 128}, "fwd-misc":{"total": 22.63, "avg": 0.18, "max": 0.12, "min": 0.37, "cnt": 128}, "fwd-MLP":{"total": 1626.73, "avg": 12.71, "max": 10.67, "min": 18.51, "cnt": 128}, "MoE_L0_fwd":{"total": 483.60, "avg": 15.11, "max": 12.44, "min": 18.39, "cnt": 32}, "MoEMLP":{"total": 1608.97, "avg": 12.57, "max": 10.56, "min": 18.32, "cnt": 128}, "MoE_L1_fwd":{"total": 398.66, "avg": 12.46, "max": 11.38, "min": 17.21, "cnt": 32}, "MoE_L2_fwd":{"total": 375.75, "avg": 11.74, "max": 10.82, "min": 16.35, "cnt": 32}, "MoE_L3_fwd":{"total": 357.51, "avg": 11.17, "max": 10.60, "min": 11.97, "cnt": 32}, "fwd-pooler":{"total": 0.35, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.04, "cnt": 32}, "forward-send":{"total": 4.85, "avg": 2.43, "max": 0.98, "min": 3.87, "cnt": 2}, "forward-send-backward-recv":{"total": 241.25, "avg": 8.04, "max": 1.11, "min": 125.18, "cnt": 30}, "backward-compute":{"total": 1754.65, "avg": 54.83, "max": 52.97, "min": 57.36, "cnt": 32}, "MoE_L3_bwd":{"total": 394.78, "avg": 12.34, "max": 11.36, "min": 15.23, "cnt": 32}, "MoE_L2_bwd":{"total": 350.96, "avg": 10.97, "max": 10.28, "min": 11.60, "cnt": 32}, "MoE_L1_bwd":{"total": 366.95, "avg": 11.47, "max": 10.77, "min": 12.69, "cnt": 32}, "MoE_L0_bwd":{"total": 424.16, "avg": 13.25, "max": 12.66, "min": 13.97, "cnt": 32}, "backward-send-forward-recv":{"total": 888.95, "avg": 30.65, "max": 2.32, "min": 147.00, "cnt": 29}, "backward-send":{"total": 2.42, "avg": 0.81, "max": 0.61, "min": 1.18, "cnt": 3}, "backward-recv":{"total": 132.20, "avg": 66.10, "max": 63.02, "min": 69.18, "cnt": 2}, "backward-params-all-reduce":{"total": 486.83, "avg": 486.83, "max": 486.83, "min": 486.83, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 240.39, "avg": 240.39, "max": 240.39, "min": 240.39, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 200.63, "avg": 200.63, "max": 200.63, "min": 200.63, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.50, "avg": 3.50, "max": 3.50, "min": 3.50, "cnt": 1}}}
{"type":"time", "iteration": 192, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 80.42, "avg": 26.81, "max": 1.08, "min": 78.04, "cnt": 3}, "forward-compute":{"total": 1914.88, "avg": 59.84, "max": 52.90, "min": 67.67, "cnt": 32}, "fwd-compute":{"total": 1911.10, "avg": 59.72, "max": 52.81, "min": 67.54, "cnt": 32}, "batch-generator":{"total": 47.20, "avg": 1.48, "max": 0.70, "min": 2.56, "cnt": 32}, "fwd-embedding":{"total": 0.84, "avg": 0.03, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1850.28, "avg": 57.82, "max": 51.70, "min": 65.51, "cnt": 32}, "fwd-layernorm":{"total": 11.29, "avg": 0.09, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 115.00, "avg": 0.90, "max": 0.74, "min": 1.51, "cnt": 128}, "fwd-misc":{"total": 24.05, "avg": 0.19, "max": 0.12, "min": 0.56, "cnt": 128}, "fwd-MLP":{"total": 1677.00, "avg": 13.10, "max": 10.80, "min": 19.19, "cnt": 128}, "MoE_L0_fwd":{"total": 509.61, "avg": 15.93, "max": 12.25, "min": 19.11, "cnt": 32}, "MoEMLP":{"total": 1658.84, "avg": 12.96, "max": 10.69, "min": 19.06, "cnt": 128}, "MoE_L1_fwd":{"total": 419.02, "avg": 13.09, "max": 11.69, "min": 19.04, "cnt": 32}, "MoE_L2_fwd":{"total": 371.61, "avg": 11.61, "max": 10.86, "min": 13.54, "cnt": 32}, "MoE_L3_fwd":{"total": 365.23, "avg": 11.41, "max": 10.73, "min": 15.76, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 8.96, "avg": 4.48, "max": 0.96, "min": 7.99, "cnt": 2}, "forward-send-backward-recv":{"total": 356.30, "avg": 11.88, "max": 1.34, "min": 172.81, "cnt": 30}, "backward-compute":{"total": 1749.11, "avg": 54.66, "max": 52.02, "min": 59.34, "cnt": 32}, "MoE_L3_bwd":{"total": 398.44, "avg": 12.45, "max": 11.81, "min": 14.26, "cnt": 32}, "MoE_L2_bwd":{"total": 342.94, "avg": 10.72, "max": 9.89, "min": 14.04, "cnt": 32}, "MoE_L1_bwd":{"total": 376.50, "avg": 11.77, "max": 11.10, "min": 14.85, "cnt": 32}, "MoE_L0_bwd":{"total": 415.46, "avg": 12.98, "max": 12.37, "min": 13.54, "cnt": 32}, "backward-send-forward-recv":{"total": 691.08, "avg": 23.83, "max": 1.86, "min": 223.33, "cnt": 29}, "backward-send":{"total": 1.76, "avg": 0.59, "max": 0.45, "min": 0.79, "cnt": 3}, "backward-recv":{"total": 142.75, "avg": 71.38, "max": 66.09, "min": 76.67, "cnt": 2}, "backward-params-all-reduce":{"total": 487.55, "avg": 487.55, "max": 487.55, "min": 487.55, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 237.86, "avg": 237.86, "max": 237.86, "min": 237.86, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.36, "avg": 3.36, "max": 3.36, "min": 3.36, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 198.19, "avg": 198.19, "max": 198.19, "min": 198.19, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.40, "avg": 3.40, "max": 3.40, "min": 3.40, "cnt": 1}}}
{"type":"time", "iteration": 193, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 78.99, "avg": 26.33, "max": 1.18, "min": 76.44, "cnt": 3}, "forward-compute":{"total": 1844.80, "avg": 57.65, "max": 52.49, "min": 66.70, "cnt": 32}, "fwd-compute":{"total": 1841.78, "avg": 57.56, "max": 52.42, "min": 66.62, "cnt": 32}, "batch-generator":{"total": 35.33, "avg": 1.10, "max": 0.71, "min": 1.89, "cnt": 32}, "fwd-embedding":{"total": 0.54, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1794.59, "avg": 56.08, "max": 51.39, "min": 64.75, "cnt": 32}, "fwd-layernorm":{"total": 9.27, "avg": 0.07, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 103.40, "avg": 0.81, "max": 0.74, "min": 1.44, "cnt": 128}, "fwd-misc":{"total": 20.27, "avg": 0.16, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1641.63, "avg": 12.83, "max": 10.59, "min": 24.82, "cnt": 128}, "MoE_L0_fwd":{"total": 481.51, "avg": 15.05, "max": 12.35, "min": 24.75, "cnt": 32}, "MoEMLP":{"total": 1625.63, "avg": 12.70, "max": 10.48, "min": 24.70, "cnt": 128}, "MoE_L1_fwd":{"total": 410.26, "avg": 12.82, "max": 11.28, "min": 19.78, "cnt": 32}, "MoE_L2_fwd":{"total": 373.41, "avg": 11.67, "max": 10.73, "min": 16.23, "cnt": 32}, "MoE_L3_fwd":{"total": 366.42, "avg": 11.45, "max": 10.52, "min": 16.27, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 3.11, "avg": 1.55, "max": 0.91, "min": 2.20, "cnt": 2}, "forward-send-backward-recv":{"total": 206.97, "avg": 6.90, "max": 1.58, "min": 116.01, "cnt": 30}, "backward-compute":{"total": 1755.26, "avg": 54.85, "max": 53.11, "min": 56.42, "cnt": 32}, "MoE_L3_bwd":{"total": 392.35, "avg": 12.26, "max": 11.58, "min": 13.31, "cnt": 32}, "MoE_L2_bwd":{"total": 347.67, "avg": 10.86, "max": 10.35, "min": 11.36, "cnt": 32}, "MoE_L1_bwd":{"total": 383.79, "avg": 11.99, "max": 11.20, "min": 13.58, "cnt": 32}, "MoE_L0_bwd":{"total": 418.17, "avg": 13.07, "max": 12.46, "min": 13.54, "cnt": 32}, "backward-send-forward-recv":{"total": 3287.46, "avg": 113.36, "max": 2.26, "min": 562.07, "cnt": 29}, "backward-send":{"total": 3.16, "avg": 1.05, "max": 0.96, "min": 1.12, "cnt": 3}, "backward-recv":{"total": 128.24, "avg": 64.12, "max": 59.59, "min": 68.65, "cnt": 2}, "backward-params-all-reduce":{"total": 485.28, "avg": 485.28, "max": 485.28, "min": 485.28, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 245.06, "avg": 245.06, "max": 245.06, "min": 245.06, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.36, "avg": 3.36, "max": 3.36, "min": 3.36, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 205.29, "avg": 205.29, "max": 205.29, "min": 205.29, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.40, "avg": 3.40, "max": 3.40, "min": 3.40, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 194, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 80.48, "avg": 26.83, "max": 1.63, "min": 77.20, "cnt": 3}, "forward-compute":{"total": 1889.25, "avg": 59.04, "max": 52.45, "min": 64.70, "cnt": 32}, "fwd-compute":{"total": 1885.40, "avg": 58.92, "max": 52.37, "min": 64.57, "cnt": 32}, "batch-generator":{"total": 48.42, "avg": 1.51, "max": 0.68, "min": 2.81, "cnt": 32}, "fwd-embedding":{"total": 0.89, "avg": 0.03, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1822.75, "avg": 56.96, "max": 51.35, "min": 62.22, "cnt": 32}, "fwd-layernorm":{"total": 11.42, "avg": 0.09, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 117.13, "avg": 0.92, "max": 0.74, "min": 1.48, "cnt": 128}, "fwd-misc":{"total": 23.52, "avg": 0.18, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1647.10, "avg": 12.87, "max": 10.69, "min": 18.82, "cnt": 128}, "MoE_L0_fwd":{"total": 496.83, "avg": 15.53, "max": 12.44, "min": 18.74, "cnt": 32}, "MoEMLP":{"total": 1628.38, "avg": 12.72, "max": 10.58, "min": 18.69, "cnt": 128}, "MoE_L1_fwd":{"total": 407.72, "avg": 12.74, "max": 11.64, "min": 14.01, "cnt": 32}, "MoE_L2_fwd":{"total": 369.11, "avg": 11.53, "max": 10.62, "min": 13.42, "cnt": 32}, "MoE_L3_fwd":{"total": 361.47, "avg": 11.30, "max": 10.67, "min": 13.70, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 12.09, "avg": 6.05, "max": 0.93, "min": 11.16, "cnt": 2}, "forward-send-backward-recv":{"total": 1126.57, "avg": 37.55, "max": 1.99, "min": 160.12, "cnt": 30}, "backward-compute":{"total": 1749.32, "avg": 54.67, "max": 52.08, "min": 57.31, "cnt": 32}, "MoE_L3_bwd":{"total": 396.38, "avg": 12.39, "max": 11.01, "min": 13.97, "cnt": 32}, "MoE_L2_bwd":{"total": 343.96, "avg": 10.75, "max": 10.00, "min": 11.39, "cnt": 32}, "MoE_L1_bwd":{"total": 378.87, "avg": 11.84, "max": 11.36, "min": 12.78, "cnt": 32}, "MoE_L0_bwd":{"total": 416.80, "avg": 13.03, "max": 12.71, "min": 13.46, "cnt": 32}, "backward-send-forward-recv":{"total": 353.23, "avg": 12.18, "max": 1.65, "min": 142.23, "cnt": 29}, "backward-send":{"total": 3.19, "avg": 1.06, "max": 1.03, "min": 1.09, "cnt": 3}, "backward-recv":{"total": 140.78, "avg": 70.39, "max": 69.76, "min": 71.03, "cnt": 2}, "backward-params-all-reduce":{"total": 492.38, "avg": 492.38, "max": 492.38, "min": 492.38, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 238.51, "avg": 238.51, "max": 238.51, "min": 238.51, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.36, "avg": 3.36, "max": 3.36, "min": 3.36, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 198.75, "avg": 198.75, "max": 198.75, "min": 198.75, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.47, "avg": 3.47, "max": 3.47, "min": 3.47, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 195, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 78.86, "avg": 26.29, "max": 0.78, "min": 75.75, "cnt": 3}, "forward-compute":{"total": 1885.75, "avg": 58.93, "max": 52.41, "min": 65.17, "cnt": 32}, "fwd-compute":{"total": 1882.24, "avg": 58.82, "max": 52.35, "min": 65.10, "cnt": 32}, "batch-generator":{"total": 40.27, "avg": 1.26, "max": 0.68, "min": 1.69, "cnt": 32}, "fwd-embedding":{"total": 0.72, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1828.46, "avg": 57.14, "max": 51.35, "min": 63.84, "cnt": 32}, "fwd-layernorm":{"total": 10.48, "avg": 0.08, "max": 0.05, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 113.15, "avg": 0.88, "max": 0.74, "min": 2.49, "cnt": 128}, "fwd-misc":{"total": 22.44, "avg": 0.18, "max": 0.11, "min": 0.38, "cnt": 128}, "fwd-MLP":{"total": 1660.09, "avg": 12.97, "max": 10.42, "min": 18.30, "cnt": 128}, "MoE_L0_fwd":{"total": 501.53, "avg": 15.67, "max": 12.55, "min": 18.22, "cnt": 32}, "MoEMLP":{"total": 1642.16, "avg": 12.83, "max": 10.32, "min": 18.17, "cnt": 128}, "MoE_L1_fwd":{"total": 411.82, "avg": 12.87, "max": 11.72, "min": 17.07, "cnt": 32}, "MoE_L2_fwd":{"total": 373.43, "avg": 11.67, "max": 10.78, "min": 14.61, "cnt": 32}, "MoE_L3_fwd":{"total": 361.92, "avg": 11.31, "max": 10.36, "min": 12.76, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 3.42, "avg": 1.71, "max": 0.92, "min": 2.51, "cnt": 2}, "forward-send-backward-recv":{"total": 861.47, "avg": 28.72, "max": 1.82, "min": 401.84, "cnt": 30}, "backward-compute":{"total": 1750.18, "avg": 54.69, "max": 52.98, "min": 57.75, "cnt": 32}, "MoE_L3_bwd":{"total": 390.02, "avg": 12.19, "max": 10.88, "min": 13.67, "cnt": 32}, "MoE_L2_bwd":{"total": 341.29, "avg": 10.67, "max": 10.07, "min": 11.77, "cnt": 32}, "MoE_L1_bwd":{"total": 376.11, "avg": 11.75, "max": 11.12, "min": 14.18, "cnt": 32}, "MoE_L0_bwd":{"total": 425.85, "avg": 13.31, "max": 12.84, "min": 14.07, "cnt": 32}, "backward-send-forward-recv":{"total": 1038.21, "avg": 35.80, "max": 1.03, "min": 367.36, "cnt": 29}, "backward-send":{"total": 3.50, "avg": 1.17, "max": 1.09, "min": 1.27, "cnt": 3}, "backward-recv":{"total": 136.76, "avg": 68.38, "max": 68.26, "min": 68.50, "cnt": 2}, "backward-params-all-reduce":{"total": 487.73, "avg": 487.73, "max": 487.73, "min": 487.73, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 239.17, "avg": 239.17, "max": 239.17, "min": 239.17, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.36, "avg": 3.36, "max": 3.36, "min": 3.36, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 198.93, "avg": 198.93, "max": 198.93, "min": 198.93, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.81, "avg": 3.81, "max": 3.81, "min": 3.81, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.43, "avg": 3.43, "max": 3.43, "min": 3.43, "cnt": 1}}}
{"type":"time", "iteration": 196, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 100.11, "avg": 33.37, "max": 7.37, "min": 83.27, "cnt": 3}, "forward-compute":{"total": 1895.77, "avg": 59.24, "max": 53.12, "min": 65.61, "cnt": 32}, "fwd-compute":{"total": 1892.08, "avg": 59.13, "max": 53.05, "min": 65.48, "cnt": 32}, "batch-generator":{"total": 42.00, "avg": 1.31, "max": 0.66, "min": 1.96, "cnt": 32}, "fwd-embedding":{"total": 0.79, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1836.22, "avg": 57.38, "max": 51.93, "min": 63.48, "cnt": 32}, "fwd-layernorm":{"total": 10.89, "avg": 0.09, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 116.21, "avg": 0.91, "max": 0.74, "min": 1.50, "cnt": 128}, "fwd-misc":{"total": 22.84, "avg": 0.18, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1663.02, "avg": 12.99, "max": 10.45, "min": 18.51, "cnt": 128}, "MoE_L0_fwd":{"total": 500.58, "avg": 15.64, "max": 12.62, "min": 18.40, "cnt": 32}, "MoEMLP":{"total": 1644.82, "avg": 12.85, "max": 10.34, "min": 18.33, "cnt": 128}, "MoE_L1_fwd":{"total": 400.63, "avg": 12.52, "max": 11.45, "min": 14.76, "cnt": 32}, "MoE_L2_fwd":{"total": 372.46, "avg": 11.64, "max": 11.21, "min": 12.42, "cnt": 32}, "MoE_L3_fwd":{"total": 377.69, "avg": 11.80, "max": 10.38, "min": 16.47, "cnt": 32}, "fwd-pooler":{"total": 0.36, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.60, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 3.44, "avg": 1.72, "max": 0.91, "min": 2.52, "cnt": 2}, "forward-send-backward-recv":{"total": 350.50, "avg": 11.68, "max": 1.34, "min": 110.26, "cnt": 30}, "backward-compute":{"total": 1759.97, "avg": 55.00, "max": 53.20, "min": 56.73, "cnt": 32}, "MoE_L3_bwd":{"total": 392.59, "avg": 12.27, "max": 11.22, "min": 14.48, "cnt": 32}, "MoE_L2_bwd":{"total": 353.71, "avg": 11.05, "max": 10.36, "min": 12.18, "cnt": 32}, "MoE_L1_bwd":{"total": 369.13, "avg": 11.54, "max": 11.08, "min": 12.28, "cnt": 32}, "MoE_L0_bwd":{"total": 429.61, "avg": 13.43, "max": 12.68, "min": 14.70, "cnt": 32}, "backward-send-forward-recv":{"total": 518.80, "avg": 17.89, "max": 1.07, "min": 195.11, "cnt": 29}, "backward-send":{"total": 3.21, "avg": 1.07, "max": 0.95, "min": 1.17, "cnt": 3}, "backward-recv":{"total": 149.43, "avg": 74.72, "max": 67.28, "min": 82.15, "cnt": 2}, "backward-params-all-reduce":{"total": 487.62, "avg": 487.62, "max": 487.62, "min": 487.62, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 238.21, "avg": 238.21, "max": 238.21, "min": 238.21, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 198.49, "avg": 198.49, "max": 198.49, "min": 198.49, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.36, "avg": 3.36, "max": 3.36, "min": 3.36, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.42, "avg": 3.42, "max": 3.42, "min": 3.42, "cnt": 1}}}
{"type":"time", "iteration": 197, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.10, "avg": 0.10, "max": 0.10, "min": 0.10, "cnt": 1}, "forward-recv":{"total": 85.50, "avg": 28.50, "max": 1.10, "min": 82.08, "cnt": 3}, "forward-compute":{"total": 1975.43, "avg": 61.73, "max": 57.51, "min": 69.15, "cnt": 32}, "fwd-compute":{"total": 1971.57, "avg": 61.61, "max": 57.42, "min": 69.02, "cnt": 32}, "batch-generator":{"total": 45.15, "avg": 1.41, "max": 0.69, "min": 1.75, "cnt": 32}, "fwd-embedding":{"total": 0.86, "avg": 0.03, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1912.34, "avg": 59.76, "max": 56.43, "min": 66.89, "cnt": 32}, "fwd-layernorm":{"total": 11.52, "avg": 0.09, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 119.28, "avg": 0.93, "max": 0.74, "min": 1.55, "cnt": 128}, "fwd-misc":{"total": 24.38, "avg": 0.19, "max": 0.12, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1732.72, "avg": 13.54, "max": 10.63, "min": 18.58, "cnt": 128}, "MoE_L0_fwd":{"total": 534.95, "avg": 16.72, "max": 13.31, "min": 18.50, "cnt": 32}, "MoEMLP":{"total": 1713.56, "avg": 13.39, "max": 10.53, "min": 18.45, "cnt": 128}, "MoE_L1_fwd":{"total": 424.26, "avg": 13.26, "max": 11.93, "min": 17.48, "cnt": 32}, "MoE_L2_fwd":{"total": 387.77, "avg": 12.12, "max": 11.15, "min": 16.10, "cnt": 32}, "MoE_L3_fwd":{"total": 373.57, "avg": 11.67, "max": 10.57, "min": 15.61, "cnt": 32}, "fwd-pooler":{"total": 0.36, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.59, "avg": 0.02, "max": 0.02, "min": 0.04, "cnt": 32}, "forward-send":{"total": 2.33, "avg": 1.17, "max": 1.11, "min": 1.22, "cnt": 2}, "forward-send-backward-recv":{"total": 538.73, "avg": 17.96, "max": 1.19, "min": 117.74, "cnt": 30}, "backward-compute":{"total": 1757.39, "avg": 54.92, "max": 53.64, "min": 58.66, "cnt": 32}, "MoE_L3_bwd":{"total": 398.89, "avg": 12.47, "max": 11.34, "min": 14.72, "cnt": 32}, "MoE_L2_bwd":{"total": 345.41, "avg": 10.79, "max": 9.73, "min": 12.92, "cnt": 32}, "MoE_L1_bwd":{"total": 364.33, "avg": 11.39, "max": 10.93, "min": 11.73, "cnt": 32}, "MoE_L0_bwd":{"total": 431.09, "avg": 13.47, "max": 12.66, "min": 14.23, "cnt": 32}, "backward-send-forward-recv":{"total": 142.02, "avg": 4.90, "max": 1.07, "min": 56.08, "cnt": 29}, "backward-send":{"total": 3.37, "avg": 1.12, "max": 1.01, "min": 1.21, "cnt": 3}, "backward-recv":{"total": 135.62, "avg": 67.81, "max": 66.97, "min": 68.65, "cnt": 2}, "backward-params-all-reduce":{"total": 512.57, "avg": 512.57, "max": 512.57, "min": 512.57, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 241.67, "avg": 241.67, "max": 241.67, "min": 241.67, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 197.40, "avg": 197.40, "max": 197.40, "min": 197.40, "cnt": 1}, "optimizer-clip-main-grad":{"total": 6.98, "avg": 6.98, "max": 6.98, "min": 6.98, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.44, "avg": 3.44, "max": 3.44, "min": 3.44, "cnt": 1}}}
{"type":"time", "iteration": 198, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 76.94, "avg": 25.65, "max": 0.78, "min": 74.90, "cnt": 3}, "forward-compute":{"total": 1917.04, "avg": 59.91, "max": 52.05, "min": 67.39, "cnt": 32}, "fwd-compute":{"total": 1913.43, "avg": 59.79, "max": 51.98, "min": 67.25, "cnt": 32}, "batch-generator":{"total": 49.08, "avg": 1.53, "max": 0.69, "min": 4.33, "cnt": 32}, "fwd-embedding":{"total": 0.81, "avg": 0.03, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1850.63, "avg": 57.83, "max": 50.78, "min": 64.79, "cnt": 32}, "fwd-layernorm":{"total": 11.46, "avg": 0.09, "max": 0.06, "min": 0.28, "cnt": 128}, "fwd-attn":{"total": 118.23, "avg": 0.92, "max": 0.74, "min": 2.10, "cnt": 128}, "fwd-misc":{"total": 23.39, "avg": 0.18, "max": 0.11, "min": 0.38, "cnt": 128}, "fwd-MLP":{"total": 1673.70, "avg": 13.08, "max": 10.31, "min": 18.35, "cnt": 128}, "MoE_L0_fwd":{"total": 506.50, "avg": 15.83, "max": 12.55, "min": 17.44, "cnt": 32}, "MoEMLP":{"total": 1655.00, "avg": 12.93, "max": 10.21, "min": 18.24, "cnt": 128}, "MoE_L1_fwd":{"total": 400.52, "avg": 12.52, "max": 11.31, "min": 15.93, "cnt": 32}, "MoE_L2_fwd":{"total": 389.65, "avg": 12.18, "max": 10.71, "min": 18.28, "cnt": 32}, "MoE_L3_fwd":{"total": 365.08, "avg": 11.41, "max": 10.25, "min": 16.20, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.58, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 4.08, "avg": 2.04, "max": 1.01, "min": 3.08, "cnt": 2}, "forward-send-backward-recv":{"total": 807.80, "avg": 26.93, "max": 1.74, "min": 188.00, "cnt": 30}, "backward-compute":{"total": 1750.28, "avg": 54.70, "max": 52.30, "min": 56.40, "cnt": 32}, "MoE_L3_bwd":{"total": 398.30, "avg": 12.45, "max": 11.33, "min": 14.45, "cnt": 32}, "MoE_L2_bwd":{"total": 349.87, "avg": 10.93, "max": 10.05, "min": 12.37, "cnt": 32}, "MoE_L1_bwd":{"total": 360.44, "avg": 11.26, "max": 10.82, "min": 11.72, "cnt": 32}, "MoE_L0_bwd":{"total": 424.81, "avg": 13.28, "max": 12.56, "min": 13.70, "cnt": 32}, "backward-send-forward-recv":{"total": 767.09, "avg": 26.45, "max": 1.74, "min": 244.82, "cnt": 29}, "backward-send":{"total": 2.55, "avg": 0.85, "max": 0.68, "min": 1.08, "cnt": 3}, "backward-recv":{"total": 309.18, "avg": 154.59, "max": 66.42, "min": 242.76, "cnt": 2}, "backward-params-all-reduce":{"total": 487.24, "avg": 487.24, "max": 487.24, "min": 487.24, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 242.76, "avg": 242.76, "max": 242.76, "min": 242.76, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.37, "avg": 3.37, "max": 3.37, "min": 3.37, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 202.92, "avg": 202.92, "max": 202.92, "min": 202.92, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.36, "avg": 3.36, "max": 3.36, "min": 3.36, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 199, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.08, "avg": 0.08, "max": 0.08, "min": 0.08, "cnt": 1}, "forward-recv":{"total": 77.33, "avg": 25.78, "max": 2.15, "min": 70.14, "cnt": 3}, "forward-compute":{"total": 1966.56, "avg": 61.45, "max": 52.33, "min": 155.68, "cnt": 32}, "fwd-compute":{"total": 1963.20, "avg": 61.35, "max": 52.26, "min": 155.55, "cnt": 32}, "batch-generator":{"total": 37.99, "avg": 1.19, "max": 0.67, "min": 1.64, "cnt": 32}, "fwd-embedding":{"total": 0.66, "avg": 0.02, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 1912.71, "avg": 59.77, "max": 51.21, "min": 153.50, "cnt": 32}, "fwd-layernorm":{"total": 10.13, "avg": 0.08, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 110.78, "avg": 0.87, "max": 0.74, "min": 1.68, "cnt": 128}, "fwd-misc":{"total": 21.79, "avg": 0.17, "max": 0.11, "min": 0.35, "cnt": 128}, "fwd-MLP":{"total": 1748.62, "avg": 13.66, "max": 10.53, "min": 113.73, "cnt": 128}, "MoE_L0_fwd":{"total": 613.25, "avg": 19.16, "max": 12.53, "min": 113.59, "cnt": 32}, "MoEMLP":{"total": 1731.61, "avg": 13.53, "max": 10.43, "min": 113.50, "cnt": 128}, "MoE_L1_fwd":{"total": 389.11, "avg": 12.16, "max": 11.11, "min": 13.06, "cnt": 32}, "MoE_L2_fwd":{"total": 372.73, "avg": 11.65, "max": 11.00, "min": 14.36, "cnt": 32}, "MoE_L3_fwd":{"total": 362.84, "avg": 11.34, "max": 10.47, "min": 15.07, "cnt": 32}, "fwd-pooler":{"total": 0.34, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd-loss-func":{"total": 0.57, "avg": 0.02, "max": 0.02, "min": 0.03, "cnt": 32}, "forward-send":{"total": 1.72, "avg": 0.86, "max": 0.79, "min": 0.93, "cnt": 2}, "forward-send-backward-recv":{"total": 663.47, "avg": 22.12, "max": 1.31, "min": 201.43, "cnt": 30}, "backward-compute":{"total": 1750.33, "avg": 54.70, "max": 52.70, "min": 61.87, "cnt": 32}, "MoE_L3_bwd":{"total": 397.78, "avg": 12.43, "max": 11.30, "min": 17.78, "cnt": 32}, "MoE_L2_bwd":{"total": 349.32, "avg": 10.92, "max": 10.22, "min": 11.99, "cnt": 32}, "MoE_L1_bwd":{"total": 363.59, "avg": 11.36, "max": 10.65, "min": 14.28, "cnt": 32}, "MoE_L0_bwd":{"total": 428.28, "avg": 13.38, "max": 13.01, "min": 13.70, "cnt": 32}, "backward-send-forward-recv":{"total": 1607.93, "avg": 55.45, "max": 1.20, "min": 595.01, "cnt": 29}, "backward-send":{"total": 2.90, "avg": 0.97, "max": 0.75, "min": 1.09, "cnt": 3}, "backward-recv":{"total": 211.90, "avg": 105.95, "max": 72.46, "min": 139.44, "cnt": 2}, "backward-params-all-reduce":{"total": 483.64, "avg": 483.64, "max": 483.64, "min": 483.64, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.03, "avg": 0.03, "max": 0.03, "min": 0.03, "cnt": 1}, "optimizer":{"total": 238.50, "avg": 238.50, "max": 238.50, "min": 238.50, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.38, "avg": 3.38, "max": 3.38, "min": 3.38, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 198.41, "avg": 198.41, "max": 198.41, "min": 198.41, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.71, "avg": 3.71, "max": 3.71, "min": 3.71, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.46, "avg": 3.46, "max": 3.46, "min": 3.46, "cnt": 1}}}
{"type":"time", "iteration": 200, "rank": 31, "tp_rank": 0, "pp_rank": 1, "dp_rank": 15, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.07, "avg": 0.07, "max": 0.07, "min": 0.07, "cnt": 1}, "forward-recv":{"total": 84.21, "avg": 28.07, "max": 1.25, "min": 74.24, "cnt": 3}, "forward-compute":{"total": 1857.12, "avg": 58.04, "max": 51.55, "min": 66.51, "cnt": 32}, "fwd-compute":{"total": 1853.80, "avg": 57.93, "max": 51.48, "min": 66.43, "cnt": 32}, "batch-generator":{"total": 40.24, "avg": 1.26, "max": 0.64, "min": 2.45, "cnt": 32}, "fwd-embedding":{"total": 0.64, "avg": 0.02, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 1800.30, "avg": 56.26, "max": 50.50, "min": 64.75, "cnt": 32}, "fwd-layernorm":{"total": 9.66, "avg": 0.08, "max": 0.06, "min": 0.22, "cnt": 128}, "fwd-attn":{"total": 107.84, "avg": 0.84, "max": 0.74, "min": 1.48, "cnt": 128}, "fwd-misc":{"total": 20.94, "avg": 0.16, "max": 0.11, "min": 0.36, "cnt": 128}, "fwd-MLP":{"total": 1640.72, "avg": 12.82, "max": 10.42, "min": 24.33, "cnt": 128}, "MoE_L0_fwd":{"total": 506.53, "avg": 15.83, "max": 12.61, "min": 24.25, "cnt": 32}, "MoEMLP":{"total": 1624.07, "avg": 12.69, "max": 10.31, "min": 24.20, "cnt": 128}, "MoE_L1_fwd":{"total": 392.52, "avg": 12.27, "max": 11.37, "min": 13.65, "cnt": 32}, "MoE_L2_fwd":{"total": 375.00, "avg": 11.72, "max": 11.20, "min": 12.59, "cnt": 32}, "MoE_L3_fwd":{"total": 356.13, "avg": 11.13, "max": 10.35, "min": 12.54, "cnt": 32}, "fwd-pooler":{"total": 0.36, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-loss-func":{"total": 0.62, "avg": 0.02, "max": 0.02, "min": 0.05, "cnt": 32}, "forward-send":{"total": 1.46, "avg": 0.73, "max": 0.73, "min": 0.74, "cnt": 2}, "forward-send-backward-recv":{"total": 365.76, "avg": 12.19, "max": 1.34, "min": 105.61, "cnt": 30}, "backward-compute":{"total": 1763.03, "avg": 55.09, "max": 53.18, "min": 59.74, "cnt": 32}, "MoE_L3_bwd":{"total": 397.01, "avg": 12.41, "max": 10.82, "min": 17.43, "cnt": 32}, "MoE_L2_bwd":{"total": 359.81, "avg": 11.24, "max": 10.56, "min": 12.61, "cnt": 32}, "MoE_L1_bwd":{"total": 361.90, "avg": 11.31, "max": 10.81, "min": 11.73, "cnt": 32}, "MoE_L0_bwd":{"total": 426.72, "avg": 13.34, "max": 12.84, "min": 13.71, "cnt": 32}, "backward-send-forward-recv":{"total": 2664.41, "avg": 91.88, "max": 2.26, "min": 516.40, "cnt": 29}, "backward-send":{"total": 1.78, "avg": 0.59, "max": 0.54, "min": 0.68, "cnt": 3}, "backward-recv":{"total": 135.19, "avg": 67.60, "max": 67.26, "min": 67.93, "cnt": 2}, "backward-params-all-reduce":{"total": 482.81, "avg": 482.81, "max": 482.81, "min": 482.81, "cnt": 1}, "backward-embedding-all-reduce":{"total": 0.02, "avg": 0.02, "max": 0.02, "min": 0.02, "cnt": 1}, "optimizer":{"total": 250.69, "avg": 250.69, "max": 250.69, "min": 250.69, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 3.36, "avg": 3.36, "max": 3.36, "min": 3.36, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 210.97, "avg": 210.97, "max": 210.97, "min": 210.97, "cnt": 1}, "optimizer-clip-main-grad":{"total": 3.40, "avg": 3.40, "max": 3.40, "min": 3.40, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 3.41, "avg": 3.41, "max": 3.41, "min": 3.41, "cnt": 1}}}
