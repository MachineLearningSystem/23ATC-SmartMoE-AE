{"type":"time", "iteration": -1, "rank": 15, "tp_rank": 0, "pp_rank": 3, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 8316.27, "avg": 8316.27, "max": 8316.27, "min": 8316.27, "cnt": 1}, "train/valid/test-data-iterators-setup":{"total": 11317.49, "avg": 11317.49, "max": 11317.49, "min": 11317.49, "cnt": 1}}}
{"type":"time", "iteration": 1, "rank": 15, "tp_rank": 0, "pp_rank": 3, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.67, "avg": 0.67, "max": 0.67, "min": 0.67, "cnt": 1}, "forward-recv":{"total": 3309.93, "avg": 3309.93, "max": 3309.93, "min": 3309.93, "cnt": 1}, "forward-compute":{"total": 3541.45, "avg": 110.67, "max": 76.14, "min": 1116.91, "cnt": 32}, "fwd-compute":{"total": 3517.50, "avg": 109.92, "max": 75.70, "min": 1116.09, "cnt": 32}, "batch-generator":{"total": 60.24, "avg": 1.88, "max": 1.23, "min": 4.01, "cnt": 32}, "fwd-embedding":{"total": 0.85, "avg": 0.03, "max": 0.02, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 3161.49, "avg": 98.80, "max": 64.77, "min": 1101.31, "cnt": 32}, "fwd-layernorm":{"total": 13.13, "avg": 0.10, "max": 0.06, "min": 0.61, "cnt": 128}, "fwd-attn":{"total": 705.57, "avg": 5.51, "max": 1.44, "min": 500.31, "cnt": 128}, "fwd-misc":{"total": 69.38, "avg": 0.54, "max": 0.15, "min": 41.11, "cnt": 128}, "fwd-MLP":{"total": 2342.16, "avg": 18.30, "max": 12.84, "min": 488.38, "cnt": 128}, "MoE_L0_fwd":{"total": 1031.98, "avg": 32.25, "max": 16.14, "min": 488.21, "cnt": 32}, "MoEMLP":{"total": 2324.18, "avg": 18.16, "max": 12.74, "min": 488.13, "cnt": 128}, "MoE_L1_fwd":{"total": 432.62, "avg": 13.52, "max": 12.79, "min": 20.45, "cnt": 32}, "MoE_L2_fwd":{"total": 423.11, "avg": 13.22, "max": 12.78, "min": 17.09, "cnt": 32}, "MoE_L3_fwd":{"total": 442.80, "avg": 13.84, "max": 12.95, "min": 15.72, "cnt": 32}, "fwd-pooler":{"total": 0.26, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd_post_lm":{"total": 278.98, "avg": 8.72, "max": 8.63, "min": 9.95, "cnt": 32}, "fwd-loss-func":{"total": 20.28, "avg": 0.63, "max": 0.34, "min": 1.60, "cnt": 32}, "backward-compute":{"total": 2207.64, "avg": 68.99, "max": 67.62, "min": 71.52, "cnt": 32}, "MoE_L3_bwd":{"total": 419.42, "avg": 13.11, "max": 12.09, "min": 14.44, "cnt": 32}, "MoE_L2_bwd":{"total": 368.27, "avg": 11.51, "max": 11.18, "min": 11.78, "cnt": 32}, "MoE_L1_bwd":{"total": 366.33, "avg": 11.45, "max": 11.22, "min": 12.09, "cnt": 32}, "MoE_L0_bwd":{"total": 371.45, "avg": 11.61, "max": 11.42, "min": 11.88, "cnt": 32}, "backward-send-forward-recv":{"total": 120.29, "avg": 3.88, "max": 2.78, "min": 15.95, "cnt": 31}, "backward-send":{"total": 1.70, "avg": 1.70, "max": 1.70, "min": 1.70, "cnt": 1}, "backward-params-all-reduce":{"total": 247.60, "avg": 247.60, "max": 247.60, "min": 247.60, "cnt": 1}, "backward-embedding-all-reduce":{"total": 277.29, "avg": 277.29, "max": 277.29, "min": 277.29, "cnt": 1}, "optimizer":{"total": 334.51, "avg": 334.51, "max": 334.51, "min": 334.51, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 4.31, "avg": 4.31, "max": 4.31, "min": 4.31, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 174.61, "avg": 174.61, "max": 174.61, "min": 174.61, "cnt": 1}, "optimizer-clip-main-grad":{"total": 8.86, "avg": 8.86, "max": 8.86, "min": 8.86, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 4.64, "avg": 4.64, "max": 4.64, "min": 4.64, "cnt": 1}}}
{"type":"time", "iteration": 2, "rank": 15, "tp_rank": 0, "pp_rank": 3, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.22, "avg": 0.22, "max": 0.22, "min": 0.22, "cnt": 1}, "forward-recv":{"total": 247.89, "avg": 247.89, "max": 247.89, "min": 247.89, "cnt": 1}, "forward-compute":{"total": 2687.31, "avg": 83.98, "max": 79.91, "min": 87.53, "cnt": 32}, "fwd-compute":{"total": 2671.27, "avg": 83.48, "max": 79.36, "min": 87.04, "cnt": 32}, "batch-generator":{"total": 50.83, "avg": 1.59, "max": 0.93, "min": 1.82, "cnt": 32}, "fwd-embedding":{"total": 0.84, "avg": 0.03, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 2329.38, "avg": 72.79, "max": 69.44, "min": 76.33, "cnt": 32}, "fwd-layernorm":{"total": 12.45, "avg": 0.10, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 193.81, "avg": 1.51, "max": 1.45, "min": 1.82, "cnt": 128}, "fwd-misc":{"total": 29.30, "avg": 0.23, "max": 0.15, "min": 1.28, "cnt": 128}, "fwd-MLP":{"total": 2066.00, "avg": 16.14, "max": 14.08, "min": 21.33, "cnt": 128}, "MoE_L0_fwd":{"total": 605.60, "avg": 18.93, "max": 16.98, "min": 21.17, "cnt": 32}, "MoEMLP":{"total": 2048.70, "avg": 16.01, "max": 13.99, "min": 21.09, "cnt": 128}, "MoE_L1_fwd":{"total": 502.17, "avg": 15.69, "max": 15.06, "min": 16.66, "cnt": 32}, "MoE_L2_fwd":{"total": 459.08, "avg": 14.35, "max": 14.02, "min": 15.04, "cnt": 32}, "MoE_L3_fwd":{"total": 488.00, "avg": 15.25, "max": 14.38, "min": 15.89, "cnt": 32}, "fwd-pooler":{"total": 0.26, "avg": 0.01, "max": 0.01, "min": 0.02, "cnt": 32}, "fwd_post_lm":{"total": 276.58, "avg": 8.64, "max": 8.62, "min": 8.81, "cnt": 32}, "fwd-loss-func":{"total": 12.62, "avg": 0.39, "max": 0.33, "min": 0.61, "cnt": 32}, "backward-compute":{"total": 2707.97, "avg": 84.62, "max": 80.91, "min": 86.30, "cnt": 32}, "MoE_L3_bwd":{"total": 520.64, "avg": 16.27, "max": 15.17, "min": 16.86, "cnt": 32}, "MoE_L2_bwd":{"total": 477.73, "avg": 14.93, "max": 14.21, "min": 15.41, "cnt": 32}, "MoE_L1_bwd":{"total": 551.24, "avg": 17.23, "max": 16.61, "min": 17.48, "cnt": 32}, "MoE_L0_bwd":{"total": 479.86, "avg": 15.00, "max": 14.20, "min": 15.82, "cnt": 32}, "backward-send-forward-recv":{"total": 98.05, "avg": 3.16, "max": 2.81, "min": 6.22, "cnt": 31}, "backward-send":{"total": 1.59, "avg": 1.59, "max": 1.59, "min": 1.59, "cnt": 1}, "backward-params-all-reduce":{"total": 127.93, "avg": 127.93, "max": 127.93, "min": 127.93, "cnt": 1}, "backward-embedding-all-reduce":{"total": 326.82, "avg": 326.82, "max": 326.82, "min": 326.82, "cnt": 1}, "optimizer":{"total": 56.94, "avg": 56.94, "max": 56.94, "min": 56.94, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 4.29, "avg": 4.29, "max": 4.29, "min": 4.29, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 4.85, "avg": 4.85, "max": 4.85, "min": 4.85, "cnt": 1}, "optimizer-clip-main-grad":{"total": 7.62, "avg": 7.62, "max": 7.62, "min": 7.62, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 4.71, "avg": 4.71, "max": 4.71, "min": 4.71, "cnt": 1}}}
{"type":"time", "iteration": 3, "rank": 15, "tp_rank": 0, "pp_rank": 3, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.20, "avg": 0.20, "max": 0.20, "min": 0.20, "cnt": 1}, "forward-recv":{"total": 228.42, "avg": 228.42, "max": 228.42, "min": 228.42, "cnt": 1}, "forward-compute":{"total": 2699.79, "avg": 84.37, "max": 82.44, "min": 86.17, "cnt": 32}, "fwd-compute":{"total": 2683.17, "avg": 83.85, "max": 81.95, "min": 85.68, "cnt": 32}, "batch-generator":{"total": 55.71, "avg": 1.74, "max": 1.09, "min": 1.92, "cnt": 32}, "fwd-embedding":{"total": 0.84, "avg": 0.03, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 2335.77, "avg": 72.99, "max": 71.86, "min": 74.14, "cnt": 32}, "fwd-layernorm":{"total": 12.52, "avg": 0.10, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 201.39, "avg": 1.57, "max": 1.45, "min": 2.58, "cnt": 128}, "fwd-misc":{"total": 28.53, "avg": 0.22, "max": 0.15, "min": 0.53, "cnt": 128}, "fwd-MLP":{"total": 2065.35, "avg": 16.14, "max": 14.25, "min": 19.10, "cnt": 128}, "MoE_L0_fwd":{"total": 574.95, "avg": 17.97, "max": 16.58, "min": 18.96, "cnt": 32}, "MoEMLP":{"total": 2047.78, "avg": 16.00, "max": 14.15, "min": 18.87, "cnt": 128}, "MoE_L1_fwd":{"total": 560.75, "avg": 17.52, "max": 17.22, "min": 18.04, "cnt": 32}, "MoE_L2_fwd":{"total": 459.22, "avg": 14.35, "max": 14.18, "min": 14.90, "cnt": 32}, "MoE_L3_fwd":{"total": 459.12, "avg": 14.35, "max": 14.18, "min": 14.68, "cnt": 32}, "fwd-pooler":{"total": 0.25, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd_post_lm":{"total": 276.86, "avg": 8.65, "max": 8.63, "min": 9.14, "cnt": 32}, "fwd-loss-func":{"total": 13.25, "avg": 0.41, "max": 0.34, "min": 0.81, "cnt": 32}, "backward-compute":{"total": 2762.66, "avg": 86.33, "max": 83.84, "min": 87.03, "cnt": 32}, "MoE_L3_bwd":{"total": 498.25, "avg": 15.57, "max": 15.14, "min": 15.96, "cnt": 32}, "MoE_L2_bwd":{"total": 474.43, "avg": 14.83, "max": 14.13, "min": 15.05, "cnt": 32}, "MoE_L1_bwd":{"total": 640.70, "avg": 20.02, "max": 19.40, "min": 20.23, "cnt": 32}, "MoE_L0_bwd":{"total": 470.73, "avg": 14.71, "max": 14.06, "min": 14.87, "cnt": 32}, "backward-send-forward-recv":{"total": 88.90, "avg": 2.87, "max": 2.77, "min": 3.00, "cnt": 31}, "backward-send":{"total": 1.86, "avg": 1.86, "max": 1.86, "min": 1.86, "cnt": 1}, "backward-params-all-reduce":{"total": 124.74, "avg": 124.74, "max": 124.74, "min": 124.74, "cnt": 1}, "backward-embedding-all-reduce":{"total": 322.84, "avg": 322.84, "max": 322.84, "min": 322.84, "cnt": 1}, "optimizer":{"total": 55.46, "avg": 55.46, "max": 55.46, "min": 55.46, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 4.27, "avg": 4.27, "max": 4.27, "min": 4.27, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 4.78, "avg": 4.78, "max": 4.78, "min": 4.78, "cnt": 1}, "optimizer-clip-main-grad":{"total": 7.83, "avg": 7.83, "max": 7.83, "min": 7.83, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 4.69, "avg": 4.69, "max": 4.69, "min": 4.69, "cnt": 1}}}
{"type":"time", "iteration": 4, "rank": 15, "tp_rank": 0, "pp_rank": 3, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.19, "avg": 0.19, "max": 0.19, "min": 0.19, "cnt": 1}, "forward-recv":{"total": 233.66, "avg": 233.66, "max": 233.66, "min": 233.66, "cnt": 1}, "forward-compute":{"total": 2716.87, "avg": 84.90, "max": 82.15, "min": 89.76, "cnt": 32}, "fwd-compute":{"total": 2691.30, "avg": 84.10, "max": 81.37, "min": 89.02, "cnt": 32}, "batch-generator":{"total": 55.84, "avg": 1.74, "max": 1.13, "min": 2.03, "cnt": 32}, "fwd-embedding":{"total": 0.86, "avg": 0.03, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 2344.44, "avg": 73.26, "max": 71.24, "min": 78.19, "cnt": 32}, "fwd-layernorm":{"total": 12.50, "avg": 0.10, "max": 0.06, "min": 0.18, "cnt": 128}, "fwd-attn":{"total": 193.12, "avg": 1.51, "max": 1.45, "min": 1.61, "cnt": 128}, "fwd-misc":{"total": 28.63, "avg": 0.22, "max": 0.15, "min": 0.63, "cnt": 128}, "fwd-MLP":{"total": 2082.28, "avg": 16.27, "max": 12.23, "min": 25.25, "cnt": 128}, "MoE_L0_fwd":{"total": 611.46, "avg": 19.11, "max": 16.59, "min": 25.09, "cnt": 32}, "MoEMLP":{"total": 2065.00, "avg": 16.13, "max": 12.13, "min": 25.01, "cnt": 128}, "MoE_L1_fwd":{"total": 505.27, "avg": 15.79, "max": 15.36, "min": 16.57, "cnt": 32}, "MoE_L2_fwd":{"total": 407.09, "avg": 12.72, "max": 12.17, "min": 13.73, "cnt": 32}, "MoE_L3_fwd":{"total": 547.29, "avg": 17.10, "max": 16.62, "min": 17.51, "cnt": 32}, "fwd-pooler":{"total": 0.25, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd_post_lm":{"total": 276.39, "avg": 8.64, "max": 8.62, "min": 8.65, "cnt": 32}, "fwd-loss-func":{"total": 22.15, "avg": 0.69, "max": 0.60, "min": 0.83, "cnt": 32}, "backward-compute":{"total": 2757.75, "avg": 86.18, "max": 83.58, "min": 87.24, "cnt": 32}, "MoE_L3_bwd":{"total": 656.16, "avg": 20.50, "max": 19.69, "min": 20.93, "cnt": 32}, "MoE_L2_bwd":{"total": 421.12, "avg": 13.16, "max": 12.75, "min": 13.43, "cnt": 32}, "MoE_L1_bwd":{"total": 507.93, "avg": 15.87, "max": 15.39, "min": 16.24, "cnt": 32}, "MoE_L0_bwd":{"total": 495.66, "avg": 15.49, "max": 15.02, "min": 15.73, "cnt": 32}, "backward-send-forward-recv":{"total": 89.34, "avg": 2.88, "max": 2.81, "min": 2.99, "cnt": 31}, "backward-send":{"total": 1.53, "avg": 1.53, "max": 1.53, "min": 1.53, "cnt": 1}, "backward-params-all-reduce":{"total": 125.10, "avg": 125.10, "max": 125.10, "min": 125.10, "cnt": 1}, "backward-embedding-all-reduce":{"total": 325.65, "avg": 325.65, "max": 325.65, "min": 325.65, "cnt": 1}, "optimizer":{"total": 55.72, "avg": 55.72, "max": 55.72, "min": 55.72, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 4.24, "avg": 4.24, "max": 4.24, "min": 4.24, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 5.08, "avg": 5.08, "max": 5.08, "min": 5.08, "cnt": 1}, "optimizer-clip-main-grad":{"total": 7.77, "avg": 7.77, "max": 7.77, "min": 7.77, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 4.65, "avg": 4.65, "max": 4.65, "min": 4.65, "cnt": 1}}}
{"type":"time", "iteration": 5, "rank": 15, "tp_rank": 0, "pp_rank": 3, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.20, "avg": 0.20, "max": 0.20, "min": 0.20, "cnt": 1}, "forward-recv":{"total": 232.93, "avg": 232.93, "max": 232.93, "min": 232.93, "cnt": 1}, "forward-compute":{"total": 2604.82, "avg": 81.40, "max": 78.80, "min": 83.96, "cnt": 32}, "fwd-compute":{"total": 2589.13, "avg": 80.91, "max": 78.36, "min": 83.26, "cnt": 32}, "batch-generator":{"total": 54.11, "avg": 1.69, "max": 0.85, "min": 2.14, "cnt": 32}, "fwd-embedding":{"total": 0.83, "avg": 0.03, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 2243.57, "avg": 70.11, "max": 68.53, "min": 72.42, "cnt": 32}, "fwd-layernorm":{"total": 12.39, "avg": 0.10, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 193.36, "avg": 1.51, "max": 1.45, "min": 1.77, "cnt": 128}, "fwd-misc":{"total": 29.45, "avg": 0.23, "max": 0.15, "min": 0.74, "cnt": 128}, "fwd-MLP":{"total": 1980.81, "avg": 15.48, "max": 11.59, "min": 20.44, "cnt": 128}, "MoE_L0_fwd":{"total": 580.93, "avg": 18.15, "max": 16.58, "min": 20.30, "cnt": 32}, "MoEMLP":{"total": 1963.50, "avg": 15.34, "max": 11.49, "min": 20.22, "cnt": 128}, "MoE_L1_fwd":{"total": 560.21, "avg": 17.51, "max": 17.25, "min": 18.09, "cnt": 32}, "MoE_L2_fwd":{"total": 372.09, "avg": 11.63, "max": 11.52, "min": 12.15, "cnt": 32}, "MoE_L3_fwd":{"total": 456.32, "avg": 14.26, "max": 14.00, "min": 15.41, "cnt": 32}, "fwd-pooler":{"total": 0.25, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd_post_lm":{"total": 276.84, "avg": 8.65, "max": 8.63, "min": 8.68, "cnt": 32}, "fwd-loss-func":{"total": 12.29, "avg": 0.38, "max": 0.33, "min": 0.60, "cnt": 32}, "backward-compute":{"total": 2678.17, "avg": 83.69, "max": 81.09, "min": 84.79, "cnt": 32}, "MoE_L3_bwd":{"total": 497.71, "avg": 15.55, "max": 15.17, "min": 16.54, "cnt": 32}, "MoE_L2_bwd":{"total": 389.97, "avg": 12.19, "max": 11.40, "min": 12.34, "cnt": 32}, "MoE_L1_bwd":{"total": 641.34, "avg": 20.04, "max": 19.48, "min": 20.19, "cnt": 32}, "MoE_L0_bwd":{"total": 471.09, "avg": 14.72, "max": 14.22, "min": 14.90, "cnt": 32}, "backward-send-forward-recv":{"total": 90.26, "avg": 2.91, "max": 2.78, "min": 3.01, "cnt": 31}, "backward-send":{"total": 1.66, "avg": 1.66, "max": 1.66, "min": 1.66, "cnt": 1}, "backward-params-all-reduce":{"total": 125.45, "avg": 125.45, "max": 125.45, "min": 125.45, "cnt": 1}, "backward-embedding-all-reduce":{"total": 327.21, "avg": 327.21, "max": 327.21, "min": 327.21, "cnt": 1}, "optimizer":{"total": 55.47, "avg": 55.47, "max": 55.47, "min": 55.47, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 4.26, "avg": 4.26, "max": 4.26, "min": 4.26, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 4.81, "avg": 4.81, "max": 4.81, "min": 4.81, "cnt": 1}, "optimizer-clip-main-grad":{"total": 7.84, "avg": 7.84, "max": 7.84, "min": 7.84, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 4.71, "avg": 4.71, "max": 4.71, "min": 4.71, "cnt": 1}}}
{"type":"time", "iteration": 6, "rank": 15, "tp_rank": 0, "pp_rank": 3, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.19, "avg": 0.19, "max": 0.19, "min": 0.19, "cnt": 1}, "forward-recv":{"total": 281.64, "avg": 281.64, "max": 281.64, "min": 281.64, "cnt": 1}, "forward-compute":{"total": 2584.63, "avg": 80.77, "max": 78.31, "min": 83.69, "cnt": 32}, "fwd-compute":{"total": 2567.23, "avg": 80.23, "max": 77.83, "min": 83.24, "cnt": 32}, "batch-generator":{"total": 54.77, "avg": 1.71, "max": 0.91, "min": 2.47, "cnt": 32}, "fwd-embedding":{"total": 0.83, "avg": 0.03, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 2221.10, "avg": 69.41, "max": 67.43, "min": 72.33, "cnt": 32}, "fwd-layernorm":{"total": 12.43, "avg": 0.10, "max": 0.06, "min": 0.25, "cnt": 128}, "fwd-attn":{"total": 194.49, "avg": 1.52, "max": 1.45, "min": 2.20, "cnt": 128}, "fwd-misc":{"total": 29.68, "avg": 0.23, "max": 0.15, "min": 0.63, "cnt": 128}, "fwd-MLP":{"total": 1956.90, "avg": 15.29, "max": 12.77, "min": 18.67, "cnt": 128}, "MoE_L0_fwd":{"total": 558.41, "avg": 17.45, "max": 15.81, "min": 18.53, "cnt": 32}, "MoEMLP":{"total": 1939.96, "avg": 15.16, "max": 12.67, "min": 18.46, "cnt": 128}, "MoE_L1_fwd":{"total": 467.44, "avg": 14.61, "max": 13.98, "min": 15.75, "cnt": 32}, "MoE_L2_fwd":{"total": 419.14, "avg": 13.10, "max": 12.71, "min": 13.86, "cnt": 32}, "MoE_L3_fwd":{"total": 500.94, "avg": 15.65, "max": 14.82, "min": 16.41, "cnt": 32}, "fwd-pooler":{"total": 0.25, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd_post_lm":{"total": 276.77, "avg": 8.65, "max": 8.64, "min": 8.67, "cnt": 32}, "fwd-loss-func":{"total": 13.79, "avg": 0.43, "max": 0.33, "min": 0.70, "cnt": 32}, "backward-compute":{"total": 2558.30, "avg": 79.95, "max": 77.60, "min": 81.92, "cnt": 32}, "MoE_L3_bwd":{"total": 549.99, "avg": 17.19, "max": 16.25, "min": 18.33, "cnt": 32}, "MoE_L2_bwd":{"total": 422.96, "avg": 13.22, "max": 12.81, "min": 13.56, "cnt": 32}, "MoE_L1_bwd":{"total": 471.95, "avg": 14.75, "max": 13.44, "min": 16.35, "cnt": 32}, "MoE_L0_bwd":{"total": 434.70, "avg": 13.58, "max": 13.13, "min": 14.25, "cnt": 32}, "backward-send-forward-recv":{"total": 141.36, "avg": 4.56, "max": 2.79, "min": 12.61, "cnt": 31}, "backward-send":{"total": 1.66, "avg": 1.66, "max": 1.66, "min": 1.66, "cnt": 1}, "backward-params-all-reduce":{"total": 124.68, "avg": 124.68, "max": 124.68, "min": 124.68, "cnt": 1}, "backward-embedding-all-reduce":{"total": 329.32, "avg": 329.32, "max": 329.32, "min": 329.32, "cnt": 1}, "optimizer":{"total": 55.35, "avg": 55.35, "max": 55.35, "min": 55.35, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 4.23, "avg": 4.23, "max": 4.23, "min": 4.23, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 4.77, "avg": 4.77, "max": 4.77, "min": 4.77, "cnt": 1}, "optimizer-clip-main-grad":{"total": 7.38, "avg": 7.38, "max": 7.38, "min": 7.38, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 4.70, "avg": 4.70, "max": 4.70, "min": 4.70, "cnt": 1}}}
{"type":"time", "iteration": 7, "rank": 15, "tp_rank": 0, "pp_rank": 3, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.21, "avg": 0.21, "max": 0.21, "min": 0.21, "cnt": 1}, "forward-recv":{"total": 228.29, "avg": 228.29, "max": 228.29, "min": 228.29, "cnt": 1}, "forward-compute":{"total": 2697.11, "avg": 84.28, "max": 81.17, "min": 86.87, "cnt": 32}, "fwd-compute":{"total": 2681.04, "avg": 83.78, "max": 80.72, "min": 86.40, "cnt": 32}, "batch-generator":{"total": 58.73, "avg": 1.84, "max": 0.84, "min": 2.30, "cnt": 32}, "fwd-embedding":{"total": 0.87, "avg": 0.03, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 2330.45, "avg": 72.83, "max": 70.89, "min": 75.53, "cnt": 32}, "fwd-layernorm":{"total": 13.02, "avg": 0.10, "max": 0.06, "min": 0.29, "cnt": 128}, "fwd-attn":{"total": 202.22, "avg": 1.58, "max": 1.44, "min": 2.46, "cnt": 128}, "fwd-misc":{"total": 30.14, "avg": 0.24, "max": 0.15, "min": 0.74, "cnt": 128}, "fwd-MLP":{"total": 2056.68, "avg": 16.07, "max": 14.14, "min": 20.61, "cnt": 128}, "MoE_L0_fwd":{"total": 556.44, "avg": 17.39, "max": 15.86, "min": 20.48, "cnt": 32}, "MoEMLP":{"total": 2039.19, "avg": 15.93, "max": 14.04, "min": 20.40, "cnt": 128}, "MoE_L1_fwd":{"total": 563.93, "avg": 17.62, "max": 17.29, "min": 17.96, "cnt": 32}, "MoE_L2_fwd":{"total": 470.49, "avg": 14.70, "max": 14.55, "min": 15.27, "cnt": 32}, "MoE_L3_fwd":{"total": 454.45, "avg": 14.20, "max": 14.08, "min": 14.41, "cnt": 32}, "fwd-pooler":{"total": 0.25, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd_post_lm":{"total": 276.77, "avg": 8.65, "max": 8.64, "min": 8.68, "cnt": 32}, "fwd-loss-func":{"total": 12.64, "avg": 0.40, "max": 0.33, "min": 0.76, "cnt": 32}, "backward-compute":{"total": 2791.03, "avg": 87.22, "max": 84.82, "min": 88.25, "cnt": 32}, "MoE_L3_bwd":{"total": 504.78, "avg": 15.77, "max": 15.37, "min": 16.38, "cnt": 32}, "MoE_L2_bwd":{"total": 488.57, "avg": 15.27, "max": 14.59, "min": 15.42, "cnt": 32}, "MoE_L1_bwd":{"total": 645.60, "avg": 20.18, "max": 19.57, "min": 20.48, "cnt": 32}, "MoE_L0_bwd":{"total": 470.65, "avg": 14.71, "max": 14.06, "min": 14.85, "cnt": 32}, "backward-send-forward-recv":{"total": 89.82, "avg": 2.90, "max": 2.77, "min": 3.04, "cnt": 31}, "backward-send":{"total": 1.70, "avg": 1.70, "max": 1.70, "min": 1.70, "cnt": 1}, "backward-params-all-reduce":{"total": 125.38, "avg": 125.38, "max": 125.38, "min": 125.38, "cnt": 1}, "backward-embedding-all-reduce":{"total": 328.41, "avg": 328.41, "max": 328.41, "min": 328.41, "cnt": 1}, "optimizer":{"total": 55.52, "avg": 55.52, "max": 55.52, "min": 55.52, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 4.28, "avg": 4.28, "max": 4.28, "min": 4.28, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 4.79, "avg": 4.79, "max": 4.79, "min": 4.79, "cnt": 1}, "optimizer-clip-main-grad":{"total": 7.46, "avg": 7.46, "max": 7.46, "min": 7.46, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 4.73, "avg": 4.73, "max": 4.73, "min": 4.73, "cnt": 1}}}
{"type":"time", "iteration": 8, "rank": 15, "tp_rank": 0, "pp_rank": 3, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.18, "avg": 0.18, "max": 0.18, "min": 0.18, "cnt": 1}, "forward-recv":{"total": 231.22, "avg": 231.22, "max": 231.22, "min": 231.22, "cnt": 1}, "forward-compute":{"total": 2687.46, "avg": 83.98, "max": 80.80, "min": 86.95, "cnt": 32}, "fwd-compute":{"total": 2672.04, "avg": 83.50, "max": 80.33, "min": 86.47, "cnt": 32}, "batch-generator":{"total": 54.65, "avg": 1.71, "max": 1.17, "min": 1.93, "cnt": 32}, "fwd-embedding":{"total": 0.86, "avg": 0.03, "max": 0.01, "min": 0.05, "cnt": 32}, "fwd-encoder":{"total": 2325.89, "avg": 72.68, "max": 70.16, "min": 75.65, "cnt": 32}, "fwd-layernorm":{"total": 12.68, "avg": 0.10, "max": 0.06, "min": 0.27, "cnt": 128}, "fwd-attn":{"total": 199.76, "avg": 1.56, "max": 1.44, "min": 2.40, "cnt": 128}, "fwd-misc":{"total": 32.32, "avg": 0.25, "max": 0.15, "min": 2.91, "cnt": 128}, "fwd-MLP":{"total": 2053.25, "avg": 16.04, "max": 14.11, "min": 20.33, "cnt": 128}, "MoE_L0_fwd":{"total": 563.36, "avg": 17.61, "max": 15.39, "min": 20.19, "cnt": 32}, "MoEMLP":{"total": 2035.82, "avg": 15.90, "max": 14.01, "min": 20.12, "cnt": 128}, "MoE_L1_fwd":{"total": 561.11, "avg": 17.53, "max": 17.26, "min": 17.77, "cnt": 32}, "MoE_L2_fwd":{"total": 461.00, "avg": 14.41, "max": 14.04, "min": 14.94, "cnt": 32}, "MoE_L3_fwd":{"total": 456.43, "avg": 14.26, "max": 14.09, "min": 15.35, "cnt": 32}, "fwd-pooler":{"total": 0.25, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd_post_lm":{"total": 276.69, "avg": 8.65, "max": 8.63, "min": 8.66, "cnt": 32}, "fwd-loss-func":{"total": 11.92, "avg": 0.37, "max": 0.33, "min": 0.44, "cnt": 32}, "backward-compute":{"total": 2775.34, "avg": 86.73, "max": 83.74, "min": 87.60, "cnt": 32}, "MoE_L3_bwd":{"total": 500.38, "avg": 15.64, "max": 15.01, "min": 16.35, "cnt": 32}, "MoE_L2_bwd":{"total": 473.38, "avg": 14.79, "max": 14.13, "min": 15.03, "cnt": 32}, "MoE_L1_bwd":{"total": 646.91, "avg": 20.22, "max": 19.60, "min": 20.44, "cnt": 32}, "MoE_L0_bwd":{"total": 470.46, "avg": 14.70, "max": 14.18, "min": 15.04, "cnt": 32}, "backward-send-forward-recv":{"total": 91.33, "avg": 2.95, "max": 2.79, "min": 3.10, "cnt": 31}, "backward-send":{"total": 1.70, "avg": 1.70, "max": 1.70, "min": 1.70, "cnt": 1}, "backward-params-all-reduce":{"total": 125.53, "avg": 125.53, "max": 125.53, "min": 125.53, "cnt": 1}, "backward-embedding-all-reduce":{"total": 335.50, "avg": 335.50, "max": 335.50, "min": 335.50, "cnt": 1}, "optimizer":{"total": 55.32, "avg": 55.32, "max": 55.32, "min": 55.32, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 4.23, "avg": 4.23, "max": 4.23, "min": 4.23, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 4.85, "avg": 4.85, "max": 4.85, "min": 4.85, "cnt": 1}, "optimizer-clip-main-grad":{"total": 7.42, "avg": 7.42, "max": 7.42, "min": 7.42, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 4.64, "avg": 4.64, "max": 4.64, "min": 4.64, "cnt": 1}}}
{"type":"time", "iteration": 9, "rank": 15, "tp_rank": 0, "pp_rank": 3, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.20, "avg": 0.20, "max": 0.20, "min": 0.20, "cnt": 1}, "forward-recv":{"total": 239.22, "avg": 239.22, "max": 239.22, "min": 239.22, "cnt": 1}, "forward-compute":{"total": 2772.34, "avg": 86.64, "max": 81.52, "min": 88.40, "cnt": 32}, "fwd-compute":{"total": 2757.29, "avg": 86.17, "max": 81.12, "min": 87.95, "cnt": 32}, "batch-generator":{"total": 56.57, "avg": 1.77, "max": 0.87, "min": 2.11, "cnt": 32}, "fwd-embedding":{"total": 0.86, "avg": 0.03, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 2409.30, "avg": 75.29, "max": 71.26, "min": 77.02, "cnt": 32}, "fwd-layernorm":{"total": 12.44, "avg": 0.10, "max": 0.06, "min": 0.18, "cnt": 128}, "fwd-attn":{"total": 201.53, "avg": 1.57, "max": 1.44, "min": 2.71, "cnt": 128}, "fwd-misc":{"total": 30.62, "avg": 0.24, "max": 0.15, "min": 0.72, "cnt": 128}, "fwd-MLP":{"total": 2136.49, "avg": 16.69, "max": 14.09, "min": 20.02, "cnt": 128}, "MoE_L0_fwd":{"total": 600.79, "avg": 18.77, "max": 16.99, "min": 19.91, "cnt": 32}, "MoEMLP":{"total": 2119.08, "avg": 16.56, "max": 13.99, "min": 19.84, "cnt": 128}, "MoE_L1_fwd":{"total": 571.58, "avg": 17.86, "max": 17.24, "min": 18.43, "cnt": 32}, "MoE_L2_fwd":{"total": 468.66, "avg": 14.65, "max": 14.02, "min": 15.36, "cnt": 32}, "MoE_L3_fwd":{"total": 484.13, "avg": 15.13, "max": 14.20, "min": 16.10, "cnt": 32}, "fwd-pooler":{"total": 0.25, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd_post_lm":{"total": 276.65, "avg": 8.65, "max": 8.63, "min": 8.66, "cnt": 32}, "fwd-loss-func":{"total": 11.59, "avg": 0.36, "max": 0.32, "min": 0.45, "cnt": 32}, "backward-compute":{"total": 2861.27, "avg": 89.41, "max": 85.28, "min": 90.76, "cnt": 32}, "MoE_L3_bwd":{"total": 535.83, "avg": 16.74, "max": 15.17, "min": 18.00, "cnt": 32}, "MoE_L2_bwd":{"total": 481.50, "avg": 15.05, "max": 14.34, "min": 15.51, "cnt": 32}, "MoE_L1_bwd":{"total": 655.95, "avg": 20.50, "max": 19.67, "min": 20.77, "cnt": 32}, "MoE_L0_bwd":{"total": 509.20, "avg": 15.91, "max": 15.41, "min": 16.13, "cnt": 32}, "backward-send-forward-recv":{"total": 89.28, "avg": 2.88, "max": 2.79, "min": 3.04, "cnt": 31}, "backward-send":{"total": 1.67, "avg": 1.67, "max": 1.67, "min": 1.67, "cnt": 1}, "backward-params-all-reduce":{"total": 124.94, "avg": 124.94, "max": 124.94, "min": 124.94, "cnt": 1}, "backward-embedding-all-reduce":{"total": 332.87, "avg": 332.87, "max": 332.87, "min": 332.87, "cnt": 1}, "optimizer":{"total": 55.69, "avg": 55.69, "max": 55.69, "min": 55.69, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 4.25, "avg": 4.25, "max": 4.25, "min": 4.25, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 4.86, "avg": 4.86, "max": 4.86, "min": 4.86, "cnt": 1}, "optimizer-clip-main-grad":{"total": 7.50, "avg": 7.50, "max": 7.50, "min": 7.50, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 4.74, "avg": 4.74, "max": 4.74, "min": 4.74, "cnt": 1}}}
{"type":"time", "iteration": 10, "rank": 15, "tp_rank": 0, "pp_rank": 3, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.18, "avg": 0.18, "max": 0.18, "min": 0.18, "cnt": 1}, "forward-recv":{"total": 236.51, "avg": 236.51, "max": 236.51, "min": 236.51, "cnt": 1}, "forward-compute":{"total": 2678.21, "avg": 83.69, "max": 80.10, "min": 84.83, "cnt": 32}, "fwd-compute":{"total": 2663.20, "avg": 83.23, "max": 79.67, "min": 84.38, "cnt": 32}, "batch-generator":{"total": 55.25, "avg": 1.73, "max": 0.80, "min": 1.86, "cnt": 32}, "fwd-embedding":{"total": 0.84, "avg": 0.03, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 2316.64, "avg": 72.40, "max": 69.89, "min": 73.48, "cnt": 32}, "fwd-layernorm":{"total": 12.51, "avg": 0.10, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 193.67, "avg": 1.51, "max": 1.45, "min": 2.22, "cnt": 128}, "fwd-misc":{"total": 31.32, "avg": 0.24, "max": 0.15, "min": 0.67, "cnt": 128}, "fwd-MLP":{"total": 2051.31, "avg": 16.03, "max": 14.01, "min": 19.17, "cnt": 128}, "MoE_L0_fwd":{"total": 583.84, "avg": 18.25, "max": 16.26, "min": 19.03, "cnt": 32}, "MoEMLP":{"total": 2034.04, "avg": 15.89, "max": 13.91, "min": 18.96, "cnt": 128}, "MoE_L1_fwd":{"total": 546.75, "avg": 17.09, "max": 16.87, "min": 17.51, "cnt": 32}, "MoE_L2_fwd":{"total": 451.07, "avg": 14.10, "max": 13.94, "min": 14.26, "cnt": 32}, "MoE_L3_fwd":{"total": 458.50, "avg": 14.33, "max": 14.16, "min": 14.75, "cnt": 32}, "fwd-pooler":{"total": 0.25, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd_post_lm":{"total": 276.64, "avg": 8.65, "max": 8.63, "min": 8.66, "cnt": 32}, "fwd-loss-func":{"total": 11.60, "avg": 0.36, "max": 0.33, "min": 0.42, "cnt": 32}, "backward-compute":{"total": 2755.45, "avg": 86.11, "max": 84.27, "min": 87.10, "cnt": 32}, "MoE_L3_bwd":{"total": 489.06, "avg": 15.28, "max": 15.01, "min": 15.77, "cnt": 32}, "MoE_L2_bwd":{"total": 469.91, "avg": 14.68, "max": 14.16, "min": 14.88, "cnt": 32}, "MoE_L1_bwd":{"total": 622.03, "avg": 19.44, "max": 18.88, "min": 19.70, "cnt": 32}, "MoE_L0_bwd":{"total": 494.04, "avg": 15.44, "max": 14.86, "min": 15.66, "cnt": 32}, "backward-send-forward-recv":{"total": 89.34, "avg": 2.88, "max": 2.81, "min": 3.02, "cnt": 31}, "backward-send":{"total": 1.64, "avg": 1.64, "max": 1.64, "min": 1.64, "cnt": 1}, "backward-params-all-reduce":{"total": 125.27, "avg": 125.27, "max": 125.27, "min": 125.27, "cnt": 1}, "backward-embedding-all-reduce":{"total": 338.28, "avg": 338.28, "max": 338.28, "min": 338.28, "cnt": 1}, "optimizer":{"total": 55.36, "avg": 55.36, "max": 55.36, "min": 55.36, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 4.24, "avg": 4.24, "max": 4.24, "min": 4.24, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 4.79, "avg": 4.79, "max": 4.79, "min": 4.79, "cnt": 1}, "optimizer-clip-main-grad":{"total": 7.44, "avg": 7.44, "max": 7.44, "min": 7.44, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 4.70, "avg": 4.70, "max": 4.70, "min": 4.70, "cnt": 1}}}
{"type":"time", "iteration": 11, "rank": 15, "tp_rank": 0, "pp_rank": 3, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.20, "avg": 0.20, "max": 0.20, "min": 0.20, "cnt": 1}, "forward-recv":{"total": 248.30, "avg": 248.30, "max": 248.30, "min": 248.30, "cnt": 1}, "forward-compute":{"total": 2622.89, "avg": 81.97, "max": 78.62, "min": 83.02, "cnt": 32}, "fwd-compute":{"total": 2608.03, "avg": 81.50, "max": 78.21, "min": 82.44, "cnt": 32}, "batch-generator":{"total": 54.99, "avg": 1.72, "max": 0.76, "min": 1.83, "cnt": 32}, "fwd-embedding":{"total": 0.85, "avg": 0.03, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 2261.12, "avg": 70.66, "max": 68.45, "min": 71.58, "cnt": 32}, "fwd-layernorm":{"total": 12.71, "avg": 0.10, "max": 0.06, "min": 0.34, "cnt": 128}, "fwd-attn":{"total": 194.32, "avg": 1.52, "max": 1.45, "min": 2.14, "cnt": 128}, "fwd-misc":{"total": 33.88, "avg": 0.26, "max": 0.15, "min": 0.72, "cnt": 128}, "fwd-MLP":{"total": 1992.31, "avg": 15.56, "max": 13.98, "min": 19.37, "cnt": 128}, "MoE_L0_fwd":{"total": 577.52, "avg": 18.05, "max": 16.73, "min": 19.23, "cnt": 32}, "MoEMLP":{"total": 1974.94, "avg": 15.43, "max": 13.87, "min": 19.15, "cnt": 128}, "MoE_L1_fwd":{"total": 496.30, "avg": 15.51, "max": 15.24, "min": 15.92, "cnt": 32}, "MoE_L2_fwd":{"total": 449.57, "avg": 14.05, "max": 13.90, "min": 14.27, "cnt": 32}, "MoE_L3_fwd":{"total": 457.69, "avg": 14.30, "max": 14.13, "min": 14.48, "cnt": 32}, "fwd-pooler":{"total": 0.26, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd_post_lm":{"total": 276.81, "avg": 8.65, "max": 8.64, "min": 8.66, "cnt": 32}, "fwd-loss-func":{"total": 11.44, "avg": 0.36, "max": 0.33, "min": 0.46, "cnt": 32}, "backward-compute":{"total": 2667.54, "avg": 83.36, "max": 81.05, "min": 83.74, "cnt": 32}, "MoE_L3_bwd":{"total": 485.33, "avg": 15.17, "max": 14.88, "min": 15.43, "cnt": 32}, "MoE_L2_bwd":{"total": 469.09, "avg": 14.66, "max": 14.19, "min": 14.83, "cnt": 32}, "MoE_L1_bwd":{"total": 538.14, "avg": 16.82, "max": 16.28, "min": 17.01, "cnt": 32}, "MoE_L0_bwd":{"total": 492.02, "avg": 15.38, "max": 14.88, "min": 15.51, "cnt": 32}, "backward-send-forward-recv":{"total": 93.78, "avg": 3.03, "max": 2.82, "min": 7.06, "cnt": 31}, "backward-send":{"total": 1.72, "avg": 1.72, "max": 1.72, "min": 1.72, "cnt": 1}, "backward-params-all-reduce":{"total": 125.29, "avg": 125.29, "max": 125.29, "min": 125.29, "cnt": 1}, "backward-embedding-all-reduce":{"total": 337.01, "avg": 337.01, "max": 337.01, "min": 337.01, "cnt": 1}, "optimizer":{"total": 55.58, "avg": 55.58, "max": 55.58, "min": 55.58, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 4.23, "avg": 4.23, "max": 4.23, "min": 4.23, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 4.87, "avg": 4.87, "max": 4.87, "min": 4.87, "cnt": 1}, "optimizer-clip-main-grad":{"total": 7.92, "avg": 7.92, "max": 7.92, "min": 7.92, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 4.88, "avg": 4.88, "max": 4.88, "min": 4.88, "cnt": 1}}}
{"type":"time", "iteration": 12, "rank": 15, "tp_rank": 0, "pp_rank": 3, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.16, "avg": 0.16, "max": 0.16, "min": 0.16, "cnt": 1}, "forward-recv":{"total": 227.44, "avg": 227.44, "max": 227.44, "min": 227.44, "cnt": 1}, "forward-compute":{"total": 2687.27, "avg": 83.98, "max": 80.65, "min": 88.97, "cnt": 32}, "fwd-compute":{"total": 2672.41, "avg": 83.51, "max": 80.21, "min": 88.53, "cnt": 32}, "batch-generator":{"total": 50.77, "avg": 1.59, "max": 0.78, "min": 1.85, "cnt": 32}, "fwd-embedding":{"total": 0.76, "avg": 0.02, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 2330.54, "avg": 72.83, "max": 70.26, "min": 78.65, "cnt": 32}, "fwd-layernorm":{"total": 11.99, "avg": 0.09, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 194.04, "avg": 1.52, "max": 1.44, "min": 2.20, "cnt": 128}, "fwd-misc":{"total": 30.37, "avg": 0.24, "max": 0.15, "min": 0.69, "cnt": 128}, "fwd-MLP":{"total": 2067.09, "avg": 16.15, "max": 14.04, "min": 24.96, "cnt": 128}, "MoE_L0_fwd":{"total": 594.10, "avg": 18.57, "max": 16.28, "min": 24.89, "cnt": 32}, "MoEMLP":{"total": 2050.26, "avg": 16.02, "max": 13.95, "min": 24.86, "cnt": 128}, "MoE_L1_fwd":{"total": 553.73, "avg": 17.30, "max": 16.83, "min": 18.45, "cnt": 32}, "MoE_L2_fwd":{"total": 450.78, "avg": 14.09, "max": 13.98, "min": 14.23, "cnt": 32}, "MoE_L3_fwd":{"total": 457.52, "avg": 14.30, "max": 14.13, "min": 14.46, "cnt": 32}, "fwd-pooler":{"total": 0.25, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd_post_lm":{"total": 276.68, "avg": 8.65, "max": 8.64, "min": 8.66, "cnt": 32}, "fwd-loss-func":{"total": 11.68, "avg": 0.37, "max": 0.33, "min": 0.44, "cnt": 32}, "backward-compute":{"total": 2767.60, "avg": 86.49, "max": 84.41, "min": 86.89, "cnt": 32}, "MoE_L3_bwd":{"total": 494.50, "avg": 15.45, "max": 15.25, "min": 15.69, "cnt": 32}, "MoE_L2_bwd":{"total": 471.10, "avg": 14.72, "max": 14.07, "min": 14.90, "cnt": 32}, "MoE_L1_bwd":{"total": 630.43, "avg": 19.70, "max": 19.03, "min": 19.87, "cnt": 32}, "MoE_L0_bwd":{"total": 492.12, "avg": 15.38, "max": 14.77, "min": 15.53, "cnt": 32}, "backward-send-forward-recv":{"total": 86.44, "avg": 2.79, "max": 2.34, "min": 2.92, "cnt": 31}, "backward-send":{"total": 1.31, "avg": 1.31, "max": 1.31, "min": 1.31, "cnt": 1}, "backward-params-all-reduce":{"total": 126.26, "avg": 126.26, "max": 126.26, "min": 126.26, "cnt": 1}, "backward-embedding-all-reduce":{"total": 334.94, "avg": 334.94, "max": 334.94, "min": 334.94, "cnt": 1}, "optimizer":{"total": 55.49, "avg": 55.49, "max": 55.49, "min": 55.49, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 4.23, "avg": 4.23, "max": 4.23, "min": 4.23, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 4.87, "avg": 4.87, "max": 4.87, "min": 4.87, "cnt": 1}, "optimizer-clip-main-grad":{"total": 8.09, "avg": 8.09, "max": 8.09, "min": 8.09, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 4.65, "avg": 4.65, "max": 4.65, "min": 4.65, "cnt": 1}}}
{"type":"time", "iteration": 13, "rank": 15, "tp_rank": 0, "pp_rank": 3, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.20, "avg": 0.20, "max": 0.20, "min": 0.20, "cnt": 1}, "forward-recv":{"total": 234.43, "avg": 234.43, "max": 234.43, "min": 234.43, "cnt": 1}, "forward-compute":{"total": 2700.76, "avg": 84.40, "max": 80.69, "min": 86.77, "cnt": 32}, "fwd-compute":{"total": 2686.67, "avg": 83.96, "max": 80.26, "min": 86.37, "cnt": 32}, "batch-generator":{"total": 32.06, "avg": 1.00, "max": 0.74, "min": 2.20, "cnt": 32}, "fwd-embedding":{"total": 0.37, "avg": 0.01, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 2365.57, "avg": 73.92, "max": 69.98, "min": 76.52, "cnt": 32}, "fwd-layernorm":{"total": 9.61, "avg": 0.08, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 189.19, "avg": 1.48, "max": 1.44, "min": 1.85, "cnt": 128}, "fwd-misc":{"total": 23.16, "avg": 0.18, "max": 0.15, "min": 0.63, "cnt": 128}, "fwd-MLP":{"total": 2119.92, "avg": 16.56, "max": 14.04, "min": 21.80, "cnt": 128}, "MoE_L0_fwd":{"total": 643.55, "avg": 20.11, "max": 15.86, "min": 21.60, "cnt": 32}, "MoEMLP":{"total": 2103.52, "avg": 16.43, "max": 13.93, "min": 21.56, "cnt": 128}, "MoE_L1_fwd":{"total": 555.70, "avg": 17.37, "max": 17.11, "min": 18.96, "cnt": 32}, "MoE_L2_fwd":{"total": 450.80, "avg": 14.09, "max": 13.97, "min": 14.36, "cnt": 32}, "MoE_L3_fwd":{"total": 458.36, "avg": 14.32, "max": 14.19, "min": 14.56, "cnt": 32}, "fwd-pooler":{"total": 0.25, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd_post_lm":{"total": 276.69, "avg": 8.65, "max": 8.63, "min": 8.68, "cnt": 32}, "fwd-loss-func":{"total": 11.95, "avg": 0.37, "max": 0.33, "min": 0.54, "cnt": 32}, "backward-compute":{"total": 2781.87, "avg": 86.93, "max": 84.06, "min": 87.26, "cnt": 32}, "MoE_L3_bwd":{"total": 495.16, "avg": 15.47, "max": 14.66, "min": 15.65, "cnt": 32}, "MoE_L2_bwd":{"total": 471.48, "avg": 14.73, "max": 14.19, "min": 14.90, "cnt": 32}, "MoE_L1_bwd":{"total": 648.00, "avg": 20.25, "max": 19.58, "min": 20.42, "cnt": 32}, "MoE_L0_bwd":{"total": 491.03, "avg": 15.34, "max": 14.84, "min": 15.44, "cnt": 32}, "backward-send-forward-recv":{"total": 76.70, "avg": 2.47, "max": 2.33, "min": 3.08, "cnt": 31}, "backward-send":{"total": 1.70, "avg": 1.70, "max": 1.70, "min": 1.70, "cnt": 1}, "backward-params-all-reduce":{"total": 125.53, "avg": 125.53, "max": 125.53, "min": 125.53, "cnt": 1}, "backward-embedding-all-reduce":{"total": 329.89, "avg": 329.89, "max": 329.89, "min": 329.89, "cnt": 1}, "optimizer":{"total": 55.38, "avg": 55.38, "max": 55.38, "min": 55.38, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 4.23, "avg": 4.23, "max": 4.23, "min": 4.23, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 4.89, "avg": 4.89, "max": 4.89, "min": 4.89, "cnt": 1}, "optimizer-clip-main-grad":{"total": 7.31, "avg": 7.31, "max": 7.31, "min": 7.31, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 4.73, "avg": 4.73, "max": 4.73, "min": 4.73, "cnt": 1}}}
{"type":"time", "iteration": 14, "rank": 15, "tp_rank": 0, "pp_rank": 3, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.18, "avg": 0.18, "max": 0.18, "min": 0.18, "cnt": 1}, "forward-recv":{"total": 247.97, "avg": 247.97, "max": 247.97, "min": 247.97, "cnt": 1}, "forward-compute":{"total": 2700.13, "avg": 84.38, "max": 80.39, "min": 86.27, "cnt": 32}, "fwd-compute":{"total": 2684.80, "avg": 83.90, "max": 79.95, "min": 85.81, "cnt": 32}, "batch-generator":{"total": 55.58, "avg": 1.74, "max": 0.87, "min": 1.88, "cnt": 32}, "fwd-embedding":{"total": 0.84, "avg": 0.03, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 2337.33, "avg": 73.04, "max": 70.09, "min": 75.06, "cnt": 32}, "fwd-layernorm":{"total": 12.45, "avg": 0.10, "max": 0.06, "min": 0.18, "cnt": 128}, "fwd-attn":{"total": 194.59, "avg": 1.52, "max": 1.45, "min": 2.22, "cnt": 128}, "fwd-misc":{"total": 32.31, "avg": 0.25, "max": 0.15, "min": 0.63, "cnt": 128}, "fwd-MLP":{"total": 2070.21, "avg": 16.17, "max": 14.07, "min": 20.32, "cnt": 128}, "MoE_L0_fwd":{"total": 585.09, "avg": 18.28, "max": 16.37, "min": 20.19, "cnt": 32}, "MoEMLP":{"total": 2052.85, "avg": 16.04, "max": 13.97, "min": 20.11, "cnt": 128}, "MoE_L1_fwd":{"total": 560.41, "avg": 17.51, "max": 17.25, "min": 17.76, "cnt": 32}, "MoE_L2_fwd":{"total": 452.77, "avg": 14.15, "max": 14.00, "min": 14.44, "cnt": 32}, "MoE_L3_fwd":{"total": 460.71, "avg": 14.40, "max": 14.18, "min": 14.91, "cnt": 32}, "fwd-pooler":{"total": 0.25, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd_post_lm":{"total": 276.85, "avg": 8.65, "max": 8.64, "min": 8.66, "cnt": 32}, "fwd-loss-func":{"total": 11.92, "avg": 0.37, "max": 0.34, "min": 0.52, "cnt": 32}, "backward-compute":{"total": 2789.68, "avg": 87.18, "max": 85.18, "min": 88.31, "cnt": 32}, "MoE_L3_bwd":{"total": 498.26, "avg": 15.57, "max": 15.19, "min": 16.31, "cnt": 32}, "MoE_L2_bwd":{"total": 471.42, "avg": 14.73, "max": 14.07, "min": 14.96, "cnt": 32}, "MoE_L1_bwd":{"total": 650.81, "avg": 20.34, "max": 19.72, "min": 20.51, "cnt": 32}, "MoE_L0_bwd":{"total": 493.15, "avg": 15.41, "max": 14.82, "min": 15.57, "cnt": 32}, "backward-send-forward-recv":{"total": 89.65, "avg": 2.89, "max": 2.81, "min": 2.99, "cnt": 31}, "backward-send":{"total": 1.59, "avg": 1.59, "max": 1.59, "min": 1.59, "cnt": 1}, "backward-params-all-reduce":{"total": 125.16, "avg": 125.16, "max": 125.16, "min": 125.16, "cnt": 1}, "backward-embedding-all-reduce":{"total": 334.14, "avg": 334.14, "max": 334.14, "min": 334.14, "cnt": 1}, "optimizer":{"total": 55.38, "avg": 55.38, "max": 55.38, "min": 55.38, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 4.26, "avg": 4.26, "max": 4.26, "min": 4.26, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 4.76, "avg": 4.76, "max": 4.76, "min": 4.76, "cnt": 1}, "optimizer-clip-main-grad":{"total": 7.43, "avg": 7.43, "max": 7.43, "min": 7.43, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 4.71, "avg": 4.71, "max": 4.71, "min": 4.71, "cnt": 1}}}
{"type":"time", "iteration": 15, "rank": 15, "tp_rank": 0, "pp_rank": 3, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.21, "avg": 0.21, "max": 0.21, "min": 0.21, "cnt": 1}, "forward-recv":{"total": 237.22, "avg": 237.22, "max": 237.22, "min": 237.22, "cnt": 1}, "forward-compute":{"total": 2703.50, "avg": 84.48, "max": 81.43, "min": 86.42, "cnt": 32}, "fwd-compute":{"total": 2688.70, "avg": 84.02, "max": 81.00, "min": 85.93, "cnt": 32}, "batch-generator":{"total": 56.19, "avg": 1.76, "max": 1.34, "min": 1.85, "cnt": 32}, "fwd-embedding":{"total": 0.84, "avg": 0.03, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 2340.60, "avg": 73.14, "max": 70.68, "min": 75.07, "cnt": 32}, "fwd-layernorm":{"total": 12.56, "avg": 0.10, "max": 0.06, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 192.86, "avg": 1.51, "max": 1.45, "min": 1.63, "cnt": 128}, "fwd-misc":{"total": 31.48, "avg": 0.25, "max": 0.15, "min": 0.65, "cnt": 128}, "fwd-MLP":{"total": 2075.81, "avg": 16.22, "max": 14.02, "min": 20.64, "cnt": 128}, "MoE_L0_fwd":{"total": 594.81, "avg": 18.59, "max": 16.08, "min": 20.50, "cnt": 32}, "MoEMLP":{"total": 2058.51, "avg": 16.08, "max": 13.92, "min": 20.42, "cnt": 128}, "MoE_L1_fwd":{"total": 559.69, "avg": 17.49, "max": 17.19, "min": 18.44, "cnt": 32}, "MoE_L2_fwd":{"total": 451.08, "avg": 14.10, "max": 13.96, "min": 14.22, "cnt": 32}, "MoE_L3_fwd":{"total": 459.05, "avg": 14.35, "max": 14.18, "min": 14.55, "cnt": 32}, "fwd-pooler":{"total": 0.25, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd_post_lm":{"total": 276.83, "avg": 8.65, "max": 8.64, "min": 8.67, "cnt": 32}, "fwd-loss-func":{"total": 11.37, "avg": 0.36, "max": 0.33, "min": 0.38, "cnt": 32}, "backward-compute":{"total": 2798.86, "avg": 87.46, "max": 84.50, "min": 88.25, "cnt": 32}, "MoE_L3_bwd":{"total": 508.96, "avg": 15.91, "max": 15.23, "min": 16.49, "cnt": 32}, "MoE_L2_bwd":{"total": 473.41, "avg": 14.79, "max": 14.23, "min": 14.97, "cnt": 32}, "MoE_L1_bwd":{"total": 647.66, "avg": 20.24, "max": 19.54, "min": 20.42, "cnt": 32}, "MoE_L0_bwd":{"total": 492.60, "avg": 15.39, "max": 14.83, "min": 15.53, "cnt": 32}, "backward-send-forward-recv":{"total": 89.67, "avg": 2.89, "max": 2.82, "min": 2.95, "cnt": 31}, "backward-send":{"total": 1.65, "avg": 1.65, "max": 1.65, "min": 1.65, "cnt": 1}, "backward-params-all-reduce":{"total": 124.90, "avg": 124.90, "max": 124.90, "min": 124.90, "cnt": 1}, "backward-embedding-all-reduce":{"total": 334.95, "avg": 334.95, "max": 334.95, "min": 334.95, "cnt": 1}, "optimizer":{"total": 55.71, "avg": 55.71, "max": 55.71, "min": 55.71, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 4.30, "avg": 4.30, "max": 4.30, "min": 4.30, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 4.81, "avg": 4.81, "max": 4.81, "min": 4.81, "cnt": 1}, "optimizer-clip-main-grad":{"total": 7.52, "avg": 7.52, "max": 7.52, "min": 7.52, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 4.74, "avg": 4.74, "max": 4.74, "min": 4.74, "cnt": 1}}}
{"type":"time", "iteration": 16, "rank": 15, "tp_rank": 0, "pp_rank": 3, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.19, "avg": 0.19, "max": 0.19, "min": 0.19, "cnt": 1}, "forward-recv":{"total": 225.37, "avg": 225.37, "max": 225.37, "min": 225.37, "cnt": 1}, "forward-compute":{"total": 2693.84, "avg": 84.18, "max": 82.37, "min": 88.36, "cnt": 32}, "fwd-compute":{"total": 2678.52, "avg": 83.70, "max": 81.92, "min": 87.90, "cnt": 32}, "batch-generator":{"total": 57.24, "avg": 1.79, "max": 0.90, "min": 1.94, "cnt": 32}, "fwd-embedding":{"total": 0.86, "avg": 0.03, "max": 0.01, "min": 0.04, "cnt": 32}, "fwd-encoder":{"total": 2329.44, "avg": 72.80, "max": 71.99, "min": 77.04, "cnt": 32}, "fwd-layernorm":{"total": 12.51, "avg": 0.10, "max": 0.06, "min": 0.21, "cnt": 128}, "fwd-attn":{"total": 199.52, "avg": 1.56, "max": 1.44, "min": 2.23, "cnt": 128}, "fwd-misc":{"total": 31.42, "avg": 0.25, "max": 0.15, "min": 0.64, "cnt": 128}, "fwd-MLP":{"total": 2058.28, "avg": 16.08, "max": 14.04, "min": 22.34, "cnt": 128}, "MoE_L0_fwd":{"total": 580.24, "avg": 18.13, "max": 17.11, "min": 22.19, "cnt": 32}, "MoEMLP":{"total": 2040.89, "avg": 15.94, "max": 13.94, "min": 22.11, "cnt": 128}, "MoE_L1_fwd":{"total": 552.27, "avg": 17.26, "max": 16.99, "min": 17.63, "cnt": 32}, "MoE_L2_fwd":{"total": 452.56, "avg": 14.14, "max": 13.98, "min": 14.33, "cnt": 32}, "MoE_L3_fwd":{"total": 461.92, "avg": 14.44, "max": 14.22, "min": 14.62, "cnt": 32}, "fwd-pooler":{"total": 0.25, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd_post_lm":{"total": 276.57, "avg": 8.64, "max": 8.62, "min": 8.65, "cnt": 32}, "fwd-loss-func":{"total": 11.85, "avg": 0.37, "max": 0.34, "min": 0.48, "cnt": 32}, "backward-compute":{"total": 2784.06, "avg": 87.00, "max": 84.83, "min": 87.73, "cnt": 32}, "MoE_L3_bwd":{"total": 513.29, "avg": 16.04, "max": 15.58, "min": 16.61, "cnt": 32}, "MoE_L2_bwd":{"total": 472.51, "avg": 14.77, "max": 14.19, "min": 14.92, "cnt": 32}, "MoE_L1_bwd":{"total": 629.32, "avg": 19.67, "max": 19.00, "min": 19.87, "cnt": 32}, "MoE_L0_bwd":{"total": 492.92, "avg": 15.40, "max": 15.00, "min": 15.59, "cnt": 32}, "backward-send-forward-recv":{"total": 89.60, "avg": 2.89, "max": 2.79, "min": 2.98, "cnt": 31}, "backward-send":{"total": 1.72, "avg": 1.72, "max": 1.72, "min": 1.72, "cnt": 1}, "backward-params-all-reduce":{"total": 125.44, "avg": 125.44, "max": 125.44, "min": 125.44, "cnt": 1}, "backward-embedding-all-reduce":{"total": 327.28, "avg": 327.28, "max": 327.28, "min": 327.28, "cnt": 1}, "optimizer":{"total": 55.50, "avg": 55.50, "max": 55.50, "min": 55.50, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 4.24, "avg": 4.24, "max": 4.24, "min": 4.24, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 4.80, "avg": 4.80, "max": 4.80, "min": 4.80, "cnt": 1}, "optimizer-clip-main-grad":{"total": 7.58, "avg": 7.58, "max": 7.58, "min": 7.58, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 4.64, "avg": 4.64, "max": 4.64, "min": 4.64, "cnt": 1}}}
{"type":"time", "iteration": 17, "rank": 15, "tp_rank": 0, "pp_rank": 3, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.18, "avg": 0.18, "max": 0.18, "min": 0.18, "cnt": 1}, "forward-recv":{"total": 250.44, "avg": 250.44, "max": 250.44, "min": 250.44, "cnt": 1}, "forward-compute":{"total": 2693.56, "avg": 84.17, "max": 80.72, "min": 85.26, "cnt": 32}, "fwd-compute":{"total": 2678.48, "avg": 83.70, "max": 80.31, "min": 84.75, "cnt": 32}, "batch-generator":{"total": 57.61, "avg": 1.80, "max": 0.84, "min": 2.27, "cnt": 32}, "fwd-embedding":{"total": 0.84, "avg": 0.03, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 2329.03, "avg": 72.78, "max": 70.48, "min": 73.81, "cnt": 32}, "fwd-layernorm":{"total": 12.54, "avg": 0.10, "max": 0.06, "min": 0.19, "cnt": 128}, "fwd-attn":{"total": 201.72, "avg": 1.58, "max": 1.45, "min": 2.27, "cnt": 128}, "fwd-misc":{"total": 31.50, "avg": 0.25, "max": 0.15, "min": 0.64, "cnt": 128}, "fwd-MLP":{"total": 2055.37, "avg": 16.06, "max": 14.01, "min": 19.56, "cnt": 128}, "MoE_L0_fwd":{"total": 570.08, "avg": 17.82, "max": 16.11, "min": 19.42, "cnt": 32}, "MoEMLP":{"total": 2037.78, "avg": 15.92, "max": 13.91, "min": 19.35, "cnt": 128}, "MoE_L1_fwd":{"total": 559.82, "avg": 17.49, "max": 17.22, "min": 17.90, "cnt": 32}, "MoE_L2_fwd":{"total": 452.09, "avg": 14.13, "max": 13.95, "min": 14.86, "cnt": 32}, "MoE_L3_fwd":{"total": 461.99, "avg": 14.44, "max": 14.25, "min": 14.67, "cnt": 32}, "fwd-pooler":{"total": 0.25, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd_post_lm":{"total": 276.71, "avg": 8.65, "max": 8.63, "min": 8.66, "cnt": 32}, "fwd-loss-func":{"total": 11.60, "avg": 0.36, "max": 0.34, "min": 0.45, "cnt": 32}, "backward-compute":{"total": 2795.11, "avg": 87.35, "max": 84.93, "min": 88.23, "cnt": 32}, "MoE_L3_bwd":{"total": 507.17, "avg": 15.85, "max": 15.52, "min": 16.53, "cnt": 32}, "MoE_L2_bwd":{"total": 472.89, "avg": 14.78, "max": 14.20, "min": 14.94, "cnt": 32}, "MoE_L1_bwd":{"total": 646.52, "avg": 20.20, "max": 19.52, "min": 20.52, "cnt": 32}, "MoE_L0_bwd":{"total": 492.91, "avg": 15.40, "max": 14.77, "min": 15.67, "cnt": 32}, "backward-send-forward-recv":{"total": 89.82, "avg": 2.90, "max": 2.83, "min": 3.01, "cnt": 31}, "backward-send":{"total": 1.63, "avg": 1.63, "max": 1.63, "min": 1.63, "cnt": 1}, "backward-params-all-reduce":{"total": 124.56, "avg": 124.56, "max": 124.56, "min": 124.56, "cnt": 1}, "backward-embedding-all-reduce":{"total": 336.74, "avg": 336.74, "max": 336.74, "min": 336.74, "cnt": 1}, "optimizer":{"total": 55.47, "avg": 55.47, "max": 55.47, "min": 55.47, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 4.24, "avg": 4.24, "max": 4.24, "min": 4.24, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 4.77, "avg": 4.77, "max": 4.77, "min": 4.77, "cnt": 1}, "optimizer-clip-main-grad":{"total": 8.05, "avg": 8.05, "max": 8.05, "min": 8.05, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 4.71, "avg": 4.71, "max": 4.71, "min": 4.71, "cnt": 1}}}
{"type":"time", "iteration": 18, "rank": 15, "tp_rank": 0, "pp_rank": 3, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.16, "avg": 0.16, "max": 0.16, "min": 0.16, "cnt": 1}, "forward-recv":{"total": 232.33, "avg": 232.33, "max": 232.33, "min": 232.33, "cnt": 1}, "forward-compute":{"total": 2693.55, "avg": 84.17, "max": 80.87, "min": 86.16, "cnt": 32}, "fwd-compute":{"total": 2678.10, "avg": 83.69, "max": 80.44, "min": 85.62, "cnt": 32}, "batch-generator":{"total": 57.10, "avg": 1.78, "max": 0.80, "min": 1.90, "cnt": 32}, "fwd-embedding":{"total": 0.84, "avg": 0.03, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 2329.51, "avg": 72.80, "max": 70.65, "min": 74.73, "cnt": 32}, "fwd-layernorm":{"total": 12.44, "avg": 0.10, "max": 0.06, "min": 0.18, "cnt": 128}, "fwd-attn":{"total": 202.29, "avg": 1.58, "max": 1.44, "min": 2.42, "cnt": 128}, "fwd-misc":{"total": 31.11, "avg": 0.24, "max": 0.15, "min": 0.64, "cnt": 128}, "fwd-MLP":{"total": 2055.56, "avg": 16.06, "max": 13.98, "min": 20.24, "cnt": 128}, "MoE_L0_fwd":{"total": 572.60, "avg": 17.89, "max": 16.68, "min": 20.11, "cnt": 32}, "MoEMLP":{"total": 2038.04, "avg": 15.92, "max": 13.88, "min": 20.03, "cnt": 128}, "MoE_L1_fwd":{"total": 560.03, "avg": 17.50, "max": 17.20, "min": 17.88, "cnt": 32}, "MoE_L2_fwd":{"total": 451.22, "avg": 14.10, "max": 13.92, "min": 14.53, "cnt": 32}, "MoE_L3_fwd":{"total": 460.42, "avg": 14.39, "max": 14.22, "min": 14.57, "cnt": 32}, "fwd-pooler":{"total": 0.25, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd_post_lm":{"total": 276.80, "avg": 8.65, "max": 8.64, "min": 8.68, "cnt": 32}, "fwd-loss-func":{"total": 12.02, "avg": 0.38, "max": 0.34, "min": 0.50, "cnt": 32}, "backward-compute":{"total": 2794.03, "avg": 87.31, "max": 84.60, "min": 88.19, "cnt": 32}, "MoE_L3_bwd":{"total": 506.58, "avg": 15.83, "max": 15.27, "min": 16.62, "cnt": 32}, "MoE_L2_bwd":{"total": 472.40, "avg": 14.76, "max": 14.17, "min": 14.89, "cnt": 32}, "MoE_L1_bwd":{"total": 646.96, "avg": 20.22, "max": 19.61, "min": 20.38, "cnt": 32}, "MoE_L0_bwd":{"total": 491.88, "avg": 15.37, "max": 14.85, "min": 15.53, "cnt": 32}, "backward-send-forward-recv":{"total": 89.42, "avg": 2.88, "max": 2.80, "min": 2.94, "cnt": 31}, "backward-send":{"total": 1.59, "avg": 1.59, "max": 1.59, "min": 1.59, "cnt": 1}, "backward-params-all-reduce":{"total": 125.59, "avg": 125.59, "max": 125.59, "min": 125.59, "cnt": 1}, "backward-embedding-all-reduce":{"total": 328.26, "avg": 328.26, "max": 328.26, "min": 328.26, "cnt": 1}, "optimizer":{"total": 55.54, "avg": 55.54, "max": 55.54, "min": 55.54, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 4.23, "avg": 4.23, "max": 4.23, "min": 4.23, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 4.91, "avg": 4.91, "max": 4.91, "min": 4.91, "cnt": 1}, "optimizer-clip-main-grad":{"total": 7.47, "avg": 7.47, "max": 7.47, "min": 7.47, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 4.73, "avg": 4.73, "max": 4.73, "min": 4.73, "cnt": 1}}}
{"type":"time", "iteration": 19, "rank": 15, "tp_rank": 0, "pp_rank": 3, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.20, "avg": 0.20, "max": 0.20, "min": 0.20, "cnt": 1}, "forward-recv":{"total": 227.74, "avg": 227.74, "max": 227.74, "min": 227.74, "cnt": 1}, "forward-compute":{"total": 2689.57, "avg": 84.05, "max": 80.81, "min": 84.88, "cnt": 32}, "fwd-compute":{"total": 2674.08, "avg": 83.57, "max": 80.39, "min": 84.36, "cnt": 32}, "batch-generator":{"total": 58.20, "avg": 1.82, "max": 0.77, "min": 2.18, "cnt": 32}, "fwd-embedding":{"total": 0.84, "avg": 0.03, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 2324.41, "avg": 72.64, "max": 70.65, "min": 73.40, "cnt": 32}, "fwd-layernorm":{"total": 12.57, "avg": 0.10, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 207.68, "avg": 1.62, "max": 1.45, "min": 2.55, "cnt": 128}, "fwd-misc":{"total": 28.63, "avg": 0.22, "max": 0.15, "min": 0.62, "cnt": 128}, "fwd-MLP":{"total": 2047.61, "avg": 16.00, "max": 14.04, "min": 18.90, "cnt": 128}, "MoE_L0_fwd":{"total": 563.66, "avg": 17.61, "max": 16.68, "min": 18.75, "cnt": 32}, "MoEMLP":{"total": 2029.79, "avg": 15.86, "max": 13.94, "min": 18.66, "cnt": 128}, "MoE_L1_fwd":{"total": 559.34, "avg": 17.48, "max": 17.29, "min": 17.67, "cnt": 32}, "MoE_L2_fwd":{"total": 451.73, "avg": 14.12, "max": 13.98, "min": 14.52, "cnt": 32}, "MoE_L3_fwd":{"total": 461.20, "avg": 14.41, "max": 14.28, "min": 14.60, "cnt": 32}, "fwd-pooler":{"total": 0.25, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd_post_lm":{"total": 276.70, "avg": 8.65, "max": 8.64, "min": 8.66, "cnt": 32}, "fwd-loss-func":{"total": 12.02, "avg": 0.38, "max": 0.33, "min": 0.45, "cnt": 32}, "backward-compute":{"total": 2792.65, "avg": 87.27, "max": 84.22, "min": 88.13, "cnt": 32}, "MoE_L3_bwd":{"total": 504.32, "avg": 15.76, "max": 15.09, "min": 16.31, "cnt": 32}, "MoE_L2_bwd":{"total": 472.49, "avg": 14.77, "max": 13.95, "min": 14.93, "cnt": 32}, "MoE_L1_bwd":{"total": 647.20, "avg": 20.22, "max": 19.65, "min": 20.38, "cnt": 32}, "MoE_L0_bwd":{"total": 492.67, "avg": 15.40, "max": 14.78, "min": 15.55, "cnt": 32}, "backward-send-forward-recv":{"total": 89.26, "avg": 2.88, "max": 2.78, "min": 2.96, "cnt": 31}, "backward-send":{"total": 1.65, "avg": 1.65, "max": 1.65, "min": 1.65, "cnt": 1}, "backward-params-all-reduce":{"total": 125.13, "avg": 125.13, "max": 125.13, "min": 125.13, "cnt": 1}, "backward-embedding-all-reduce":{"total": 328.11, "avg": 328.11, "max": 328.11, "min": 328.11, "cnt": 1}, "optimizer":{"total": 55.23, "avg": 55.23, "max": 55.23, "min": 55.23, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 4.23, "avg": 4.23, "max": 4.23, "min": 4.23, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 4.75, "avg": 4.75, "max": 4.75, "min": 4.75, "cnt": 1}, "optimizer-clip-main-grad":{"total": 7.41, "avg": 7.41, "max": 7.41, "min": 7.41, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 4.71, "avg": 4.71, "max": 4.71, "min": 4.71, "cnt": 1}}}
{"type":"time", "iteration": 20, "rank": 15, "tp_rank": 0, "pp_rank": 3, "dp_rank": 3, "perf": {"model-and-optimizer-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "train/valid/test-data-iterators-setup":{"total": 0.00, "avg": 0.00, "max": 0.00, "min": 0.00, "cnt": 0}, "interval-time":{"total": 0.18, "avg": 0.18, "max": 0.18, "min": 0.18, "cnt": 1}, "forward-recv":{"total": 235.14, "avg": 235.14, "max": 235.14, "min": 235.14, "cnt": 1}, "forward-compute":{"total": 2699.29, "avg": 84.35, "max": 81.15, "min": 88.48, "cnt": 32}, "fwd-compute":{"total": 2683.95, "avg": 83.87, "max": 80.72, "min": 87.95, "cnt": 32}, "batch-generator":{"total": 57.51, "avg": 1.80, "max": 0.81, "min": 1.96, "cnt": 32}, "fwd-embedding":{"total": 0.83, "avg": 0.03, "max": 0.01, "min": 0.03, "cnt": 32}, "fwd-encoder":{"total": 2335.06, "avg": 72.97, "max": 70.91, "min": 77.13, "cnt": 32}, "fwd-layernorm":{"total": 12.53, "avg": 0.10, "max": 0.06, "min": 0.20, "cnt": 128}, "fwd-attn":{"total": 193.35, "avg": 1.51, "max": 1.45, "min": 1.79, "cnt": 128}, "fwd-misc":{"total": 32.45, "avg": 0.25, "max": 0.15, "min": 0.63, "cnt": 128}, "fwd-MLP":{"total": 2068.65, "avg": 16.16, "max": 14.06, "min": 22.50, "cnt": 128}, "MoE_L0_fwd":{"total": 584.68, "avg": 18.27, "max": 16.82, "min": 22.37, "cnt": 32}, "MoEMLP":{"total": 2051.27, "avg": 16.03, "max": 13.95, "min": 22.29, "cnt": 128}, "MoE_L1_fwd":{"total": 559.01, "avg": 17.47, "max": 17.21, "min": 17.86, "cnt": 32}, "MoE_L2_fwd":{"total": 450.57, "avg": 14.08, "max": 13.99, "min": 14.22, "cnt": 32}, "MoE_L3_fwd":{"total": 463.14, "avg": 14.47, "max": 14.27, "min": 15.07, "cnt": 32}, "fwd-pooler":{"total": 0.25, "avg": 0.01, "max": 0.01, "min": 0.01, "cnt": 32}, "fwd_post_lm":{"total": 276.76, "avg": 8.65, "max": 8.63, "min": 8.66, "cnt": 32}, "fwd-loss-func":{"total": 11.93, "avg": 0.37, "max": 0.34, "min": 0.44, "cnt": 32}, "backward-compute":{"total": 2794.91, "avg": 87.34, "max": 84.77, "min": 87.92, "cnt": 32}, "MoE_L3_bwd":{"total": 507.55, "avg": 15.86, "max": 15.32, "min": 16.31, "cnt": 32}, "MoE_L2_bwd":{"total": 472.27, "avg": 14.76, "max": 14.34, "min": 14.93, "cnt": 32}, "MoE_L1_bwd":{"total": 646.14, "avg": 20.19, "max": 19.60, "min": 20.37, "cnt": 32}, "MoE_L0_bwd":{"total": 493.00, "avg": 15.41, "max": 14.80, "min": 15.57, "cnt": 32}, "backward-send-forward-recv":{"total": 88.86, "avg": 2.87, "max": 2.78, "min": 2.94, "cnt": 31}, "backward-send":{"total": 1.65, "avg": 1.65, "max": 1.65, "min": 1.65, "cnt": 1}, "backward-params-all-reduce":{"total": 125.05, "avg": 125.05, "max": 125.05, "min": 125.05, "cnt": 1}, "backward-embedding-all-reduce":{"total": 335.51, "avg": 335.51, "max": 335.51, "min": 335.51, "cnt": 1}, "optimizer":{"total": 55.39, "avg": 55.39, "max": 55.39, "min": 55.39, "cnt": 1}, "optimizer-copy-to-main-grad":{"total": 4.27, "avg": 4.27, "max": 4.27, "min": 4.27, "cnt": 1}, "optimizer-unscale-and-check-inf":{"total": 4.75, "avg": 4.75, "max": 4.75, "min": 4.75, "cnt": 1}, "optimizer-clip-main-grad":{"total": 7.53, "avg": 7.53, "max": 7.53, "min": 7.53, "cnt": 1}, "optimizer-copy-main-to-model-params":{"total": 4.63, "avg": 4.63, "max": 4.63, "min": 4.63, "cnt": 1}}}
